/*! For license information please see views-3d-interactive-editingTools.js.LICENSE.txt */
(self.webpackChunkdefra=self.webpackChunkdefra||[]).push([[907,4602,5418,6479],{54140:function(t){function e(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}e.keys=function(){return[]},e.resolve=e,e.id=54140,t.exports=e},54038:function(t,e,i){"use strict";i.d(e,{i:function(){return r}});var n=i(3102);const r=()=>n.L2.isBrowser&&"undefined"!=typeof navigator&&"undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document},67646:function(t,e,i){"use strict";i.d(e,{f:function(){return s},s:function(){return l}});var n=i(3102);const r=globalThis.calciteConfig,s=r?.focusTrapStack||[],o=(n.L2.isTesting&&n.L2.isBrowser,"2.13.2"),a="2024-10-24",h="e38e2977d";function l(){if(r&&r.version)return;console.info(`Using Calcite Components ${o} [Date: ${a}, Revision: ${h}]`);const t=r||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:o,writable:!1}),globalThis.calciteConfig=t}},96367:function(t,e,i){"use strict";i.d(e,{C:function(){return s},D:function(){return o},a:function(){return n},d:function(){return r}});const n="calcite-mode-auto",r="calcite-mode-dark",s={autoMode:n,darkMode:r,lightMode:"calcite-mode-light",rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"},o={filter:250,nextTick:0,resize:150,reposition:100}},3102:function(t,e,i){"use strict";i.d(e,{L2:function(){return o},FK:function(){return Ee},wt:function(){return A},xr:function(){return nt},lh:function(){return ut},$x:function(){return ee},OX:function(){return B},h:function(){return et},w$:function(){return Se},gv:function(){return F},Qu:function(){return G}});var n={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},r="app",s=Object.defineProperty,o={isDev:!!n.isDev,isBrowser:!0,isServer:!1,isTesting:!!n.isTesting},a=n.hotModuleReplacement?window.__STENCIL_HOSTREFS__||(window.__STENCIL_HOSTREFS__=new WeakMap):new WeakMap,h=t=>a.get(t),l=(t,e)=>e in t,c=(t,e)=>(0,console.error)(t,e),u=n.isTesting?["STENCIL:"]:["%cstencil","color: white;background:#4c47ff;font-weight: bold; font-size:10px; padding:2px 6px; border-radius: 5px"],d=(...t)=>console.error(...u,...t),f=(...t)=>console.warn(...u,...t),p=new Map,g=new Map,v=[],m="s-id",y="sty-id",_="c-id",b="http://www.w3.org/1999/xlink",w=["formAssociatedCallback","formResetCallback","formDisabledCallback","formStateRestoreCallback"],x="undefined"!=typeof window?window:{},T=x.document||{head:{}},A=x.HTMLElement||class{},M={$flags$:0,$resourcesUrl$:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,n)=>t.addEventListener(e,i,n),rel:(t,e,i,n)=>t.removeEventListener(e,i,n),ce:(t,e)=>new CustomEvent(t,e)},S=n.shadowDom,E=(()=>{let t=!1;try{T.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch(t){}return t})(),C=!!n.constructableCSS&&(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(t){}return!1})(),O=0,R=!1,I=[],P=[],N=[],D=(t,e)=>i=>{t.push(i),R||(R=!0,e&&4&M.$flags$?k(j):M.raf(j))},L=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(t){c(t)}t.length=0},z=(t,e)=>{let i=0,n=0;for(;i<t.length&&(n=performance.now())<e;)try{t[i++](n)}catch(t){c(t)}i===t.length?t.length=0:0!==i&&t.splice(0,i)},j=()=>{if(n.asyncQueue&&O++,L(I),n.asyncQueue){const t=2==(6&M.$flags$)?performance.now()+14*Math.ceil(.1*O):1/0;z(P,t),z(N,t),P.length>0&&(N.push(...P),P.length=0),(R=I.length+P.length+N.length>0)?M.raf(j):O=0}else L(P),(R=I.length>0)&&M.raf(j)},k=t=>Promise.resolve(void 0).then(t),F=D(I,!1),H=D(P,!0),B=t=>{const e=new URL(t,M.$resourcesUrl$);return e.origin!==x.location.origin?e.href:e.pathname},G=t=>M.$resourcesUrl$=t,V={},U=t=>"object"==(t=typeof t)||"function"===t;((t,e)=>{for(var i in e)s(t,i,{get:e[i],enumerable:!0})})({},{err:()=>W,map:()=>q,ok:()=>$,unwrap:()=>K,unwrapErr:()=>J});var $=t=>({isOk:!0,isErr:!1,value:t}),W=t=>({isOk:!1,isErr:!0,value:t});function q(t,e){if(t.isOk){const i=e(t.value);return i instanceof Promise?i.then((t=>$(t))):$(i)}if(t.isErr){const e=t.value;return W(e)}throw"should never get here"}var Z,Y,X,K=t=>{if(t.isOk)return t.value;throw t.value},J=t=>{if(t.isErr)return t.value;throw t.value},Q=0,tt=(t,e="")=>{if(n.profile&&performance.mark){const i=`st:${t}:${e}:${Q++}`;return performance.mark(i),()=>performance.measure(`[Stencil] ${t}() <${e}>`,i)}return()=>{}},et=(t,e,...i)=>{let r=null,s=null,o=null,a=!1,h=!1;const l=[],c=e=>{for(let i=0;i<e.length;i++)r=e[i],Array.isArray(r)?c(r):null!=r&&"boolean"!=typeof r&&((a="function"!=typeof t&&!U(r))?r=String(r):n.isDev&&"function"!=typeof t&&void 0===r.$flags$&&d("vNode passed as children has unexpected type.\nMake sure it's using the correct h() function.\nEmpty objects can also be the cause, look for JSX comments that became objects."),a&&h?l[l.length-1].$text$+=r:l.push(a?it(null,r):r),h=a)};if(c(i),e&&(n.isDev&&"input"===t&&ht(e),n.vdomKey&&e.key&&(s=e.key),n.slotRelocation&&e.name&&(o=e.name),n.vdomClass)){const t=e.className||e.class;t&&(e.class="object"!=typeof t?t:Object.keys(t).filter((e=>t[e])).join(" "))}if(n.isDev&&l.some(rt)&&d("The <Host> must be the single root component. Make sure:\n- You are NOT using hostData() and <Host> in the same component.\n- <Host> is used once, and it's the single root component of the render() function."),n.vdomFunctional&&"function"==typeof t)return t(null===e?{}:e,l,st);const u=it(t,null);return u.$attrs$=e,l.length>0&&(u.$children$=l),n.vdomKey&&(u.$key$=s),n.slotRelocation&&(u.$name$=o),u},it=(t,e)=>{const i={$flags$:0,$tag$:t,$text$:e,$elm$:null,$children$:null};return n.vdomAttribute&&(i.$attrs$=null),n.vdomKey&&(i.$key$=null),n.slotRelocation&&(i.$name$=null),i},nt={},rt=t=>t&&t.$tag$===nt,st={forEach:(t,e)=>t.map(ot).forEach(e),map:(t,e)=>t.map(ot).map(e).map(at)},ot=t=>({vattrs:t.$attrs$,vchildren:t.$children$,vkey:t.$key$,vname:t.$name$,vtag:t.$tag$,vtext:t.$text$}),at=t=>{if("function"==typeof t.vtag){const e={...t.vattrs};return t.vkey&&(e.key=t.vkey),t.vname&&(e.name=t.vname),et(t.vtag,e,...t.vchildren||[])}const e=it(t.vtag,t.vtext);return e.$attrs$=t.vattrs,e.$children$=t.vchildren,e.$key$=t.vkey,e.$name$=t.vname,e},ht=t=>{const e=Object.keys(t),i=e.indexOf("value");if(-1===i)return;const n=e.indexOf("type"),r=e.indexOf("min"),s=e.indexOf("max"),o=e.indexOf("step");(i<n||i<r||i<s||i<o)&&f('The "value" prop of <input> should be set after "min", "max", "type" and "step"')},lt=(t,e,i,r,s,o,a)=>{let h,l,c,u;if(1===o.nodeType){if(h=o.getAttribute(_),h&&(l=h.split("."),l[0]!==a&&"0"!==l[0]||(c={$flags$:0,$hostId$:l[0],$nodeId$:l[1],$depth$:l[2],$index$:l[3],$tag$:o.tagName.toLowerCase(),$elm$:o,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},e.push(c),o.removeAttribute(_),t.$children$||(t.$children$=[]),t.$children$[c.$index$]=c,t=c,r&&"0"===c.$depth$&&(r[c.$index$]=c.$elm$))),o.shadowRoot)for(u=o.shadowRoot.childNodes.length-1;u>=0;u--)lt(t,e,i,r,s,o.shadowRoot.childNodes[u],a);for(u=o.childNodes.length-1;u>=0;u--)lt(t,e,i,r,s,o.childNodes[u],a)}else if(8===o.nodeType)l=o.nodeValue.split("."),l[1]!==a&&"0"!==l[1]||(h=l[0],c={$flags$:0,$hostId$:l[1],$nodeId$:l[2],$depth$:l[3],$index$:l[4],$elm$:o,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===h?(c.$elm$=o.nextSibling,c.$elm$&&3===c.$elm$.nodeType&&(c.$text$=c.$elm$.textContent,e.push(c),o.remove(),t.$children$||(t.$children$=[]),t.$children$[c.$index$]=c,r&&"0"===c.$depth$&&(r[c.$index$]=c.$elm$))):c.$hostId$===a&&("s"===h?(c.$tag$="slot",l[5]?o["s-sn"]=c.$name$=l[5]:o["s-sn"]="",o["s-sr"]=!0,n.shadowDom&&r&&(c.$elm$=T.createElement(c.$tag$),c.$name$&&c.$elm$.setAttribute("name",c.$name$),o.parentNode.insertBefore(c.$elm$,o),o.remove(),"0"===c.$depth$&&(r[c.$index$]=c.$elm$)),i.push(c),t.$children$||(t.$children$=[]),t.$children$[c.$index$]=c):"r"===h&&(n.shadowDom&&r?o.remove():n.slotRelocation&&(s["s-cr"]=o,o["s-cn"]=!0))));else if(t&&"style"===t.$tag$){const e=it(null,o.textContent);e.$elm$=o,e.$index$="0",t.$children$=[e]}},ct=(t,e)=>{if(1===t.nodeType){let i=0;if(t.shadowRoot)for(;i<t.shadowRoot.childNodes.length;i++)ct(t.shadowRoot.childNodes[i],e);for(i=0;i<t.childNodes.length;i++)ct(t.childNodes[i],e)}else if(8===t.nodeType){const i=t.nodeValue.split(".");"o"===i[0]&&(e.set(i[1]+"."+i[2],t),t.nodeValue="",t["s-en"]=i[3])}},ut=(t,e,i)=>{const r=(t=>n.lazyLoad?h(t).$hostElement$:t)(t);return{emit:t=>(n.isDev&&!r.isConnected&&f(`The "${e}" event was emitted, but the dispatcher node is no longer connected to the dom.`),dt(r,e,{bubbles:!!(4&i),composed:!!(2&i),cancelable:!!(1&i),detail:t}))}},dt=(t,e,i)=>{const n=M.ce(e,i);return t.dispatchEvent(n),n},ft=new WeakMap,pt=(t,e,i)=>{var r;const s=gt(e,i),o=g.get(s);if(!n.attachStyles)return s;if(t=11===t.nodeType?t:T,o)if("string"==typeof o){t=t.head||t;let i,a=ft.get(t);if(a||ft.set(t,a=new Set),!a.has(s)){if(n.hydrateClientSide&&t.host&&(i=t.querySelector(`[${y}="${s}"]`)))i.innerHTML=o;else{i=T.createElement("style"),i.innerHTML=o;const a=null!=(r=M.$nonce$)?r:function(t){var e,i,n;return null!=(n=null==(i=null==(e=t.head)?void 0:e.querySelector('meta[name="csp-nonce"]'))?void 0:i.getAttribute("content"))?n:void 0}(T);null!=a&&i.setAttribute("nonce",a),(n.hydrateServerSide||n.hotModuleReplacement)&&2&e.$flags$&&i.setAttribute(y,s),(!(1&e.$flags$)||1&e.$flags$&&"HEAD"!==t.nodeName)&&t.insertBefore(i,t.querySelector("link"))}4&e.$flags$&&(i.innerHTML+="slot-fb{display:contents}slot-fb[hidden]{display:none}"),a&&a.add(s)}}else n.constructableCSS&&!t.adoptedStyleSheets.includes(o)&&(t.adoptedStyleSheets=[...t.adoptedStyleSheets,o]);return s},gt=(t,e)=>"sc-"+(n.mode&&e&&32&t.$flags$?t.$tagName$+"-"+e:t.$tagName$),vt=(t,e,i,r,s,o)=>{if(i!==r){let a=l(t,e),h=e.toLowerCase();if(n.vdomClass&&"class"===e){const e=t.classList,n=yt(i),s=yt(r);e.remove(...n.filter((t=>t&&!s.includes(t)))),e.add(...s.filter((t=>t&&!n.includes(t))))}else if(n.vdomStyle&&"style"===e){if(n.updatable)for(const e in i)r&&null!=r[e]||(!n.hydrateServerSide&&e.includes("-")?t.style.removeProperty(e):t.style[e]="");for(const e in r)i&&r[e]===i[e]||(!n.hydrateServerSide&&e.includes("-")?t.style.setProperty(e,r[e]):t.style[e]=r[e])}else if(n.vdomKey&&"key"===e);else if(n.vdomRef&&"ref"===e)r&&r(t);else if(!n.vdomListener||(n.lazyLoad?a:t.__lookupSetter__(e))||"o"!==e[0]||"n"!==e[1]){if(n.vdomPropOrAttr){const l=U(r);if((a||l&&null!==r)&&!s)try{if(t.tagName.includes("-"))t[e]=r;else{const n=null==r?"":r;"list"===e?a=!1:null!=i&&t[e]==n||(t[e]=n)}}catch(t){}let c=!1;n.vdomXlink&&h!==(h=h.replace(/^xlink\:?/,""))&&(e=h,c=!0),null==r||!1===r?!1===r&&""!==t.getAttribute(e)||(n.vdomXlink&&c?t.removeAttributeNS(b,e):t.removeAttribute(e)):(!a||4&o||s)&&!l&&(r=!0===r?"":r,n.vdomXlink&&c?t.setAttributeNS(b,e,r):t.setAttribute(e,r))}}else if(e="-"===e[2]?e.slice(3):l(x,h)?h.slice(2):h[2]+e.slice(3),i||r){const n=e.endsWith(_t);e=e.replace(bt,""),i&&M.rel(t,e,i,n),r&&M.ael(t,e,r,n)}}},mt=/\s/,yt=t=>t?t.split(mt):[],_t="Capture",bt=new RegExp(_t+"$"),wt=(t,e,i)=>{const r=11===e.$elm$.nodeType&&e.$elm$.host?e.$elm$.host:e.$elm$,s=t&&t.$attrs$||V,o=e.$attrs$||V;if(n.updatable)for(const t of xt(Object.keys(s)))t in o||vt(r,t,s[t],void 0,i,e.$flags$);for(const t of xt(Object.keys(o)))vt(r,t,s[t],o[t],i,e.$flags$)};function xt(t){return t.includes("ref")?[...t.filter((t=>"ref"!==t)),"ref"]:t}var Tt=!1,At=!1,Mt=!1,St=!1,Et=(t,e,i,r)=>{var s;const o=e.$children$[i];let a,h,l,c=0;if(n.slotRelocation&&!Tt&&(Mt=!0,"slot"===o.$tag$&&(Z&&r.classList.add(Z+"-s"),o.$flags$|=o.$children$?2:1)),n.isDev&&o.$elm$&&d(`The JSX ${null!==o.$text$?`"${o.$text$}" text`:`"${o.$tag$}" element`} node should not be shared within the same renderer. The renderer caches element lookups in order to improve performance. However, a side effect from this is that the exact same JSX node should not be reused. For more information please see https://stenciljs.com/docs/templating-jsx#avoid-shared-jsx-nodes`),n.vdomText&&null!==o.$text$)a=o.$elm$=T.createTextNode(o.$text$);else if(n.slotRelocation&&1&o.$flags$)a=o.$elm$=n.isDebug||n.hydrateServerSide?$t(o):T.createTextNode("");else{if(n.svg&&!St&&(St="svg"===o.$tag$),a=o.$elm$=n.svg?T.createElementNS(St?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",!Tt&&n.slotRelocation&&2&o.$flags$?"slot-fb":o.$tag$):T.createElement(!Tt&&n.slotRelocation&&2&o.$flags$?"slot-fb":o.$tag$),n.svg&&St&&"foreignObject"===o.$tag$&&(St=!1),n.vdomAttribute&&wt(null,o,St),!!a.getRootNode().querySelector("body")&&n.scoped&&null!=Z&&a["s-si"]!==Z&&a.classList.add(a["s-si"]=Z),n.scoped&&Vt(a,r),o.$children$)for(c=0;c<o.$children$.length;++c)h=Et(t,o,c,a),h&&a.appendChild(h);n.svg&&("svg"===o.$tag$?St=!1:"foreignObject"===a.tagName&&(St=!0))}return a["s-hn"]=X,n.slotRelocation&&3&o.$flags$&&(a["s-sr"]=!0,a["s-cr"]=Y,a["s-sn"]=o.$name$||"",a["s-rf"]=null==(s=o.$attrs$)?void 0:s.ref,l=t&&t.$children$&&t.$children$[i],l&&l.$tag$===o.$tag$&&t.$elm$&&(n.experimentalSlotFixes?Ct(t.$elm$):Ot(t.$elm$,!1))),a},Ct=t=>{M.$flags$|=1;const e=t.closest(X.toLowerCase());if(null!=e){const i=Array.from(e.childNodes).find((t=>t["s-cr"])),n=Array.from(t.childNodes);for(const t of i?n.reverse():n)null!=t["s-sh"]&&(Bt(e,t,null!=i?i:null),t["s-sh"]=void 0,Mt=!0)}M.$flags$&=-2},Ot=(t,e)=>{M.$flags$|=1;const i=Array.from(t.childNodes);if(t["s-sr"]&&n.experimentalSlotFixes){let e=t;for(;e=e.nextSibling;)e&&e["s-sn"]===t["s-sn"]&&e["s-sh"]===X&&i.push(e)}for(let t=i.length-1;t>=0;t--){const n=i[t];n["s-hn"]!==X&&n["s-ol"]&&(Bt(Dt(n),n,Nt(n)),n["s-ol"].remove(),n["s-ol"]=void 0,n["s-sh"]=void 0,Mt=!0),e&&Ot(n,e)}M.$flags$&=-2},Rt=(t,e,i,r,s,o)=>{let a,h=n.slotRelocation&&t["s-cr"]&&t["s-cr"].parentNode||t;for(n.shadowDom&&h.shadowRoot&&h.tagName===X&&(h=h.shadowRoot);s<=o;++s)r[s]&&(a=Et(null,i,s,t),a&&(r[s].$elm$=a,Bt(h,a,n.slotRelocation?Nt(e):e)))},It=(t,e,i)=>{for(let r=e;r<=i;++r){const e=t[r];if(e){const t=e.$elm$;Ht(e),t&&(n.slotRelocation&&(At=!0,t["s-ol"]?t["s-ol"].remove():Ot(t,!0)),t.remove())}}},Pt=(t,e,i=!1)=>!(t.$tag$!==e.$tag$||(n.slotRelocation&&"slot"===t.$tag$?"$nodeId$"in t&&i&&8!==t.$elm$.nodeType||t.$name$!==e.$name$:n.vdomKey&&!i&&t.$key$!==e.$key$)),Nt=t=>t&&t["s-ol"]||t,Dt=t=>(t["s-ol"]?t["s-ol"]:t).parentNode,Lt=(t,e,i=!1)=>{const r=e.$elm$=t.$elm$,s=t.$children$,o=e.$children$,a=e.$tag$,h=e.$text$;let l;n.vdomText&&null!==h?n.vdomText&&n.slotRelocation&&(l=r["s-cr"])?l.parentNode.textContent=h:n.vdomText&&t.$text$!==h&&(r.data=h):(n.svg&&(St="svg"===a||"foreignObject"!==a&&St),(n.vdomAttribute||n.reflect)&&(n.slot&&"slot"===a&&!Tt?n.experimentalSlotFixes&&t.$name$!==e.$name$&&(e.$elm$["s-sn"]=e.$name$||"",Ct(e.$elm$.parentElement)):wt(t,e,St)),n.updatable&&null!==s&&null!==o?((t,e,i,r,s=!1)=>{let o,a,h=0,l=0,c=0,u=0,d=e.length-1,f=e[0],p=e[d],g=r.length-1,v=r[0],m=r[g];for(;h<=d&&l<=g;)if(null==f)f=e[++h];else if(null==p)p=e[--d];else if(null==v)v=r[++l];else if(null==m)m=r[--g];else if(Pt(f,v,s))Lt(f,v,s),f=e[++h],v=r[++l];else if(Pt(p,m,s))Lt(p,m,s),p=e[--d],m=r[--g];else if(Pt(f,m,s))!n.slotRelocation||"slot"!==f.$tag$&&"slot"!==m.$tag$||Ot(f.$elm$.parentNode,!1),Lt(f,m,s),Bt(t,f.$elm$,p.$elm$.nextSibling),f=e[++h],m=r[--g];else if(Pt(p,v,s))!n.slotRelocation||"slot"!==f.$tag$&&"slot"!==m.$tag$||Ot(p.$elm$.parentNode,!1),Lt(p,v,s),Bt(t,p.$elm$,f.$elm$),p=e[--d],v=r[++l];else{if(c=-1,n.vdomKey)for(u=h;u<=d;++u)if(e[u]&&null!==e[u].$key$&&e[u].$key$===v.$key$){c=u;break}n.vdomKey&&c>=0?(a=e[c],a.$tag$!==v.$tag$?o=Et(e&&e[l],i,c,t):(Lt(a,v,s),e[c]=void 0,o=a.$elm$),v=r[++l]):(o=Et(e&&e[l],i,l,t),v=r[++l]),o&&(n.slotRelocation?Bt(Dt(f.$elm$),o,Nt(f.$elm$)):Bt(f.$elm$.parentNode,o,f.$elm$))}h>d?Rt(t,null==r[g+1]?null:r[g+1].$elm$,i,r,l,g):n.updatable&&l>g&&It(e,h,d)})(r,s,e,o,i):null!==o?(n.updatable&&n.vdomText&&null!==t.$text$&&(r.textContent=""),Rt(r,null,e,o,0,o.length-1)):!i&&n.updatable&&null!==s&&It(s,0,s.length-1),n.svg&&St&&"svg"===a&&(St=!1))},zt=t=>{const e=t.childNodes;for(const t of e)if(1===t.nodeType){if(t["s-sr"]){const i=t["s-sn"];t.hidden=!1;for(const n of e)if(n!==t)if(n["s-hn"]!==t["s-hn"]||""!==i){if(1===n.nodeType&&(i===n.getAttribute("slot")||i===n["s-sn"])||3===n.nodeType&&i===n["s-sn"]){t.hidden=!0;break}}else if(1===n.nodeType||3===n.nodeType&&""!==n.textContent.trim()){t.hidden=!0;break}}zt(t)}},jt=[],kt=t=>{let e,i,r;for(const s of t.childNodes){if(s["s-sr"]&&(e=s["s-cr"])&&e.parentNode){i=e.parentNode.childNodes;const t=s["s-sn"];for(r=i.length-1;r>=0;r--)if(e=i[r],!(e["s-cn"]||e["s-nr"]||e["s-hn"]===s["s-hn"]||n.experimentalSlotFixes&&e["s-sh"]&&e["s-sh"]===s["s-hn"]))if(Ft(e,t)){let i=jt.find((t=>t.$nodeToRelocate$===e));At=!0,e["s-sn"]=e["s-sn"]||t,i?(i.$nodeToRelocate$["s-sh"]=s["s-hn"],i.$slotRefNode$=s):(e["s-sh"]=s["s-hn"],jt.push({$slotRefNode$:s,$nodeToRelocate$:e})),e["s-sr"]&&jt.map((t=>{Ft(t.$nodeToRelocate$,e["s-sn"])&&(i=jt.find((t=>t.$nodeToRelocate$===e)),i&&!t.$slotRefNode$&&(t.$slotRefNode$=i.$slotRefNode$))}))}else jt.some((t=>t.$nodeToRelocate$===e))||jt.push({$nodeToRelocate$:e})}1===s.nodeType&&kt(s)}},Ft=(t,e)=>1===t.nodeType?null===t.getAttribute("slot")&&""===e||t.getAttribute("slot")===e:t["s-sn"]===e||""===e,Ht=t=>{n.vdomRef&&(t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(Ht))},Bt=(t,e,i)=>{const r=null==t?void 0:t.insertBefore(e,i);return n.scoped&&Vt(e,t),r},Gt=t=>{const e=[];return t&&e.push(...t["s-scs"]||[],t["s-si"],t["s-sc"],...Gt(t.parentElement)),e},Vt=(t,e,i=!1)=>{var n;if(t&&e&&1===t.nodeType){const r=new Set(Gt(e).filter(Boolean));if(r.size&&(null==(n=t.classList)||n.add(...t["s-scs"]=[...r]),t["s-ol"]||i))for(const e of Array.from(t.childNodes))Vt(e,t,!0)}},Ut=(t,e,i=!1)=>{var r,s,o,a,h;const l=t.$hostElement$,c=t.$cmpMeta$,u=t.$vnode$||it(null,null),d=rt(e)?e:et(null,null,e);if(X=l.tagName,n.isDev&&Array.isArray(e)&&e.some(rt))throw new Error(`The <Host> must be the single root component.\nLooks like the render() function of "${X.toLowerCase()}" is returning an array that contains the <Host>.\n\nThe render() function should look like this instead:\n\nrender() {\n  // Do not return an array\n  return (\n    <Host>{content}</Host>\n  );\n}\n  `);if(n.reflect&&c.$attrsToReflect$&&(d.$attrs$=d.$attrs$||{},c.$attrsToReflect$.map((([t,e])=>d.$attrs$[e]=l[t]))),i&&d.$attrs$)for(const t of Object.keys(d.$attrs$))l.hasAttribute(t)&&!["key","ref","style","class"].includes(t)&&(d.$attrs$[t]=l[t]);if(d.$tag$=null,d.$flags$|=4,t.$vnode$=d,d.$elm$=u.$elm$=n.shadowDom&&l.shadowRoot||l,(n.scoped||n.shadowDom)&&(Z=l["s-sc"]),Tt=S&&!!(1&c.$flags$),n.slotRelocation&&(Y=l["s-cr"],At=!1),Lt(u,d,i),n.slotRelocation){if(M.$flags$|=1,Mt){kt(d.$elm$);for(const t of jt){const e=t.$nodeToRelocate$;if(!e["s-ol"]){const t=n.isDebug||n.hydrateServerSide?Wt(e):T.createTextNode("");t["s-nr"]=e,Bt(e.parentNode,e["s-ol"]=t,e)}}for(const t of jt){const e=t.$nodeToRelocate$,h=t.$slotRefNode$;if(h){const t=h.parentNode;let i=h.nextSibling;if(!n.experimentalSlotFixes||i&&1===i.nodeType){let n=null==(r=e["s-ol"])?void 0:r.previousSibling;for(;n;){let r=null!=(s=n["s-nr"])?s:null;if(r&&r["s-sn"]===e["s-sn"]&&t===r.parentNode){for(r=r.nextSibling;r===e||(null==r?void 0:r["s-sr"]);)r=null==r?void 0:r.nextSibling;if(!r||!r["s-nr"]){i=r;break}}n=n.previousSibling}}(!i&&t!==e.parentNode||e.nextSibling!==i)&&e!==i&&(n.experimentalSlotFixes||e["s-hn"]||!e["s-ol"]||(e["s-hn"]=e["s-ol"].parentNode.nodeName),Bt(t,e,i),1===e.nodeType&&(e.hidden=null!=(o=e["s-ih"])&&o)),e&&"function"==typeof h["s-rf"]&&h["s-rf"](e)}else 1===e.nodeType&&(i&&(e["s-ih"]=null!=(a=e.hidden)&&a),e.hidden=!0)}}At&&zt(d.$elm$),M.$flags$&=-2,jt.length=0}if(n.experimentalScopedSlotChanges&&2&c.$flags$)for(const t of d.$elm$.childNodes)t["s-hn"]===X||t["s-sh"]||(i&&null==t["s-ih"]&&(t["s-ih"]=null!=(h=t.hidden)&&h),t.hidden=!0);Y=void 0},$t=t=>T.createComment(`<slot${t.$name$?' name="'+t.$name$+'"':""}> (host=${X.toLowerCase()})`),Wt=t=>T.createComment("org-location for "+(t.localName?`<${t.localName}> (host=${t["s-hn"]})`:`[${t.textContent}]`)),qt=(t,e)=>{n.asyncLoading&&e&&!t.$onRenderResolve$&&e["s-p"]&&e["s-p"].push(new Promise((e=>t.$onRenderResolve$=e)))},Zt=(t,e)=>{if(n.taskQueue&&n.updatable&&(t.$flags$|=16),n.asyncLoading&&4&t.$flags$)return void(t.$flags$|=512);qt(t,t.$ancestorComponent$);const i=()=>Yt(t,e);return n.taskQueue?H(i):i()},Yt=(t,e)=>{const i=t.$hostElement$,r=tt("scheduleUpdate",t.$cmpMeta$.$tagName$),s=n.lazyLoad?t.$lazyInstance$:i;if(!s)throw new Error(`Can't render component <${i.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let o;return e?(n.lazyLoad&&n.hostListener&&(t.$flags$|=256,t.$queuedListeners$&&(t.$queuedListeners$.map((([t,e])=>ne(s,t,e))),t.$queuedListeners$=void 0)),re(i,"componentWillLoad"),n.cmpWillLoad&&(o=ne(s,"componentWillLoad"))):(re(i,"componentWillUpdate"),n.cmpWillUpdate&&(o=ne(s,"componentWillUpdate"))),re(i,"componentWillRender"),n.cmpWillRender&&(o=Xt(o,(()=>ne(s,"componentWillRender")))),r(),Xt(o,(()=>Jt(t,s,e)))},Xt=(t,e)=>Kt(t)?t.then(e).catch((t=>{console.error(t),e()})):e(),Kt=t=>t instanceof Promise||t&&t.then&&"function"==typeof t.then,Jt=async(t,e,i)=>{var r;const s=t.$hostElement$,o=tt("update",t.$cmpMeta$.$tagName$),a=s["s-rc"];n.style&&i&&(t=>{const e=t.$cmpMeta$,i=t.$hostElement$,r=e.$flags$,s=tt("attachStyles",e.$tagName$),o=pt(n.shadowDom&&S&&i.shadowRoot?i.shadowRoot:i.getRootNode(),e,t.$modeName$);(n.shadowDom||n.scoped)&&n.cssAnnotations&&10&r&&2&r&&(i["s-sc"]=o,i.classList.add(o+"-h"),n.scoped&&2&r&&i.classList.add(o+"-s")),s()})(t);const h=tt("render",t.$cmpMeta$.$tagName$);if(n.isDev&&(t.$flags$|=1024),n.hydrateServerSide?await Qt(t,e,s,i):Qt(t,e,s,i),n.isDev&&(t.$renderCount$=void 0===t.$renderCount$?1:t.$renderCount$+1,t.$flags$&=-1025),n.hydrateServerSide)try{oe(s),i&&(1&t.$cmpMeta$.$flags$?s["s-en"]="":2&t.$cmpMeta$.$flags$&&(s["s-en"]="c"))}catch(t){c(t,s)}if(n.asyncLoading&&a&&(a.map((t=>t())),s["s-rc"]=void 0),h(),o(),n.asyncLoading){const e=null!=(r=s["s-p"])?r:[],i=()=>te(t);0===e.length?i():(Promise.all(e).then(i),t.$flags$|=4,e.length=0)}else te(t)},Qt=(t,e,i,r)=>{const s=!!n.allRenderFn,o=!!n.lazyLoad,a=!!n.taskQueue,h=!!n.updatable;try{if(e=(s||e.render)&&e.render(),h&&a&&(t.$flags$&=-17),(h||o)&&(t.$flags$|=2),n.hasRenderFn||n.reflect)if(n.vdomRender||n.reflect){if(n.hydrateServerSide)return Promise.resolve(e).then((e=>Ut(t,e,r)));Ut(t,e,r)}else{const n=i.shadowRoot;1&t.$cmpMeta$.$flags$?n.textContent=e:i.textContent=e}}catch(e){c(e,t.$hostElement$)}return null},te=t=>{const e=t.$cmpMeta$.$tagName$,i=t.$hostElement$,r=tt("postUpdate",e),s=n.lazyLoad?t.$lazyInstance$:i,o=t.$ancestorComponent$;n.cmpDidRender&&(n.isDev&&(t.$flags$|=1024),ne(s,"componentDidRender"),n.isDev&&(t.$flags$&=-1025)),re(i,"componentDidRender"),64&t.$flags$?(n.cmpDidUpdate&&(n.isDev&&(t.$flags$|=1024),ne(s,"componentDidUpdate"),n.isDev&&(t.$flags$&=-1025)),re(i,"componentDidUpdate"),r()):(t.$flags$|=64,n.asyncLoading&&n.cssAnnotations&&se(i),n.cmpDidLoad&&(n.isDev&&(t.$flags$|=2048),ne(s,"componentDidLoad"),n.isDev&&(t.$flags$&=-2049)),re(i,"componentDidLoad"),r(),n.asyncLoading&&(t.$onReadyResolve$(i),o||ie(e))),n.method&&n.lazyLoad&&t.$onInstanceResolve$(i),n.asyncLoading&&(t.$onRenderResolve$&&(t.$onRenderResolve$(),t.$onRenderResolve$=void 0),512&t.$flags$&&k((()=>Zt(t,!1))),t.$flags$&=-517)},ee=t=>{if(n.updatable&&(o.isBrowser||o.isTesting)){const e=h(t),i=e.$hostElement$.isConnected;return i&&2==(18&e.$flags$)&&Zt(e,!1),i}return!1},ie=t=>{n.cssAnnotations&&se(T.documentElement),n.asyncQueue&&(M.$flags$|=2),k((()=>dt(x,"appload",{detail:{namespace:r}}))),n.profile&&performance.measure&&performance.measure(`[Stencil] ${r} initial load (by ${t})`,"st:app:start")},ne=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(t){c(t)}},re=(t,e)=>{n.lifecycleDOMEvents&&dt(t,"stencil_"+e,{bubbles:!0,composed:!0,detail:{namespace:r}})},se=t=>{var e,i;return n.hydratedClass?t.classList.add(null!=(e=n.hydratedSelectorName)?e:"hydrated"):n.hydratedAttribute?t.setAttribute(null!=(i=n.hydratedSelectorName)?i:"hydrated",""):void 0},oe=t=>{const e=t.children;if(null!=e)for(let t=0,i=e.length;t<i;t++){const i=e[t];"function"==typeof i.connectedCallback&&i.connectedCallback(),oe(i)}},ae=(t,e,i)=>{var r,s;const o=t.prototype;if(n.formAssociated&&64&e.$flags$&&1&i&&w.forEach((t=>Object.defineProperty(o,t,{value(...e){const i=h(this),r=n.lazyLoad?i.$hostElement$:this,s=n.lazyLoad?i.$lazyInstance$:r;if(s){const i=s[t];"function"==typeof i&&i.call(s,...e)}else i.$onReadyPromise$.then((i=>{const n=i[t];"function"==typeof n&&n.call(i,...e)}))}}))),n.member&&e.$members$||n.watchCallback&&(e.$watchers$||t.watchers)){n.watchCallback&&t.watchers&&!e.$watchers$&&(e.$watchers$=t.watchers);const a=Object.entries(null!=(r=e.$members$)?r:{});if(a.map((([t,[r]])=>{(n.prop||n.state)&&(31&r||(!n.lazyLoad||2&i)&&32&r)?Object.defineProperty(o,t,{get(){return e=t,h(this).$instanceValues$.get(e);var e},set(s){if(n.isDev){const n=h(this);1&i||0!==(n&&8&n.$flags$)||!(31&r)||1024&r||f(`@Prop() "${t}" on <${e.$tagName$}> is immutable but was modified from within the component.\nMore information: https://stenciljs.com/docs/properties#prop-mutability`)}((t,e,i,r)=>{const s=h(t);if(n.lazyLoad&&!s)throw new Error(`Couldn't find host element for "${r.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/ionic-team/stencil/issues/5457).`);const o=n.lazyLoad?s.$hostElement$:t,a=s.$instanceValues$.get(e),l=s.$flags$,u=n.lazyLoad?s.$lazyInstance$:o;var d,p;d=i,p=r.$members$[e][0],i=null==d||U(d)?d:n.propBoolean&&4&p?"false"!==d&&(""===d||!!d):n.propNumber&&2&p?parseFloat(d):n.propString&&1&p?String(d):d;const g=Number.isNaN(a)&&Number.isNaN(i);if((!n.lazyLoad||!(8&l)||void 0===a)&&i!==a&&!g&&(s.$instanceValues$.set(e,i),n.isDev&&(1024&s.$flags$?f(`The state/prop "${e}" changed during rendering. This can potentially lead to infinite-loops and other bugs.`,"\nElement",o,"\nNew value",i,"\nOld value",a):2048&s.$flags$&&f(`The state/prop "${e}" changed during "componentDidLoad()", this triggers extra re-renders, try to setup on "componentWillLoad()"`,"\nElement",o,"\nNew value",i,"\nOld value",a)),!n.lazyLoad||u)){if(n.watchCallback&&r.$watchers$&&128&l){const t=r.$watchers$[e];t&&t.map((t=>{try{u[t](i,a,e)}catch(t){c(t,o)}}))}if(n.updatable&&2==(18&l)){if(n.cmpShouldUpdate&&u.componentShouldUpdate&&!1===u.componentShouldUpdate(i,a,e))return;Zt(s,!1)}}})(this,t,s,e)},configurable:!0,enumerable:!0}):n.lazyLoad&&n.method&&1&i&&64&r&&Object.defineProperty(o,t,{value(...e){var i;const n=h(this);return null==(i=null==n?void 0:n.$onInstancePromise$)?void 0:i.then((()=>{var i;return null==(i=n.$lazyInstance$)?void 0:i[t](...e)}))}})})),n.observeAttribute&&(!n.lazyLoad||1&i)){const i=new Map;o.attributeChangedCallback=function(t,r,s){M.jmp((()=>{var a;const l=i.get(t);if(this.hasOwnProperty(l))s=this[l],delete this[l];else{if(o.hasOwnProperty(l)&&"number"==typeof this[l]&&this[l]==s)return;if(null==l){const i=h(this),o=null==i?void 0:i.$flags$;if(o&&!(8&o)&&128&o&&s!==r){const o=n.lazyLoad?i.$hostElement$:this,h=n.lazyLoad?i.$lazyInstance$:o,l=null==(a=e.$watchers$)?void 0:a[t];null==l||l.forEach((e=>{null!=h[e]&&h[e].call(h,s,r,t)}))}return}}this[l]=(null!==s||"boolean"!=typeof this[l])&&s}))},t.observedAttributes=Array.from(new Set([...Object.keys(null!=(s=e.$watchers$)?s:{}),...a.filter((([t,e])=>15&e[0])).map((([t,r])=>{var s;const o=r[1]||t;return i.set(o,t),n.reflect&&512&r[0]&&(null==(s=e.$attrsToReflect$)||s.push([t,o])),o}))]))}}return t},he=async(t,e,r,s)=>{let o;if(!(32&e.$flags$)){e.$flags$|=32;const l=r.$lazyBundleId$;if((n.lazyLoad||n.hydrateClientSide)&&l){const t=((t,e,r)=>{const s=t.$tagName$.replace(/-/g,"_"),o=t.$lazyBundleId$;if(n.isDev&&"string"!=typeof o)return void d(`Trying to lazily load component <${t.$tagName$}> with style mode "${e.$modeName$}", but it does not exist.`);if(!o)return;const a=!n.hotModuleReplacement&&p.get(o);return a?a[s]:i(54140)(`./${o}.entry.js${n.hotModuleReplacement&&r?"?s-hmr="+r:""}`).then((t=>(n.hotModuleReplacement||p.set(o,t),t[s])),c)})(r,e,s);if(t&&"then"in t){const i=(a=`st:load:${r.$tagName$}:${e.$modeName$}`,h=`[Stencil] Load module for <${r.$tagName$}>`,n.profile&&performance.mark?(0===performance.getEntriesByName(a,"mark").length&&performance.mark(a),()=>{0===performance.getEntriesByName(h,"measure").length&&performance.measure(h,a)}):()=>{});o=await t,i()}else o=t;if(!o)throw new Error(`Constructor for "${r.$tagName$}#${e.$modeName$}" was not found`);n.member&&!o.isProxied&&(n.watchCallback&&(r.$watchers$=o.watchers),ae(o,r,2),o.isProxied=!0);const l=tt("createInstance",r.$tagName$);n.member&&(e.$flags$|=8);try{new o(e)}catch(t){c(t)}n.member&&(e.$flags$&=-9),n.watchCallback&&(e.$flags$|=128),l(),le(e.$lazyInstance$)}else{o=t.constructor;const i=t.localName;customElements.whenDefined(i).then((()=>e.$flags$|=128))}if(n.style&&o&&o.style){let s;"string"==typeof o.style?s=o.style:n.mode&&"string"!=typeof o.style&&(e.$modeName$=(t=>v.map((e=>e(t))).find((t=>!!t)))(t),e.$modeName$&&(s=o.style[e.$modeName$]),n.hydrateServerSide&&e.$modeName$&&t.setAttribute("s-mode",e.$modeName$));const a=gt(r,e.$modeName$);if(!g.has(a)){const t=tt("registerStyles",r.$tagName$);!n.hydrateServerSide&&n.shadowDom&&n.shadowDomShim&&8&r.$flags$&&(s=await i.e(4060).then(i.bind(i,64060)).then((t=>t.scopeCss(s,a)))),((t,e,i)=>{let n=g.get(t);C&&i?(n=n||new CSSStyleSheet,"string"==typeof n?n=e:n.replaceSync(e)):n=e,g.set(t,n)})(a,s,!!(1&r.$flags$)),t()}}}var a,h;const l=e.$ancestorComponent$,u=()=>Zt(e,!0);n.asyncLoading&&l&&l["s-rc"]?l["s-rc"].push(u):u()},le=t=>{n.lazyLoad&&n.connectedCallback&&ne(t,"connectedCallback")},ce=t=>{const e=t["s-cr"]=T.createComment(n.isDebug?`content-ref (host=${t.localName})`:"");e["s-cn"]=!0,Bt(t,e,t.firstChild)},ue=t=>{n.lazyLoad&&n.disconnectedCallback&&ne(t,"disconnectedCallback"),n.cmpDidUnload&&ne(t,"componentDidUnload")},de=t=>{const e=t.cloneNode;t.cloneNode=function(t){const i=this,r=!!n.shadowDom&&i.shadowRoot&&S,s=e.call(i,!!r&&t);if(n.slot&&!r&&t){let t,e,r=0;const o=["s-id","s-cr","s-lr","s-rc","s-sc","s-p","s-cn","s-sr","s-sn","s-hn","s-ol","s-nr","s-si","s-rf","s-scs"];for(;r<i.childNodes.length;r++)t=i.childNodes[r]["s-nr"],e=o.every((t=>!i.childNodes[r][t])),t&&(n.appendChildSlotFix&&s.__appendChild?s.__appendChild(t.cloneNode(!0)):s.appendChild(t.cloneNode(!0))),e&&s.appendChild(i.childNodes[r].cloneNode(!0))}return s}},fe=t=>{t.__appendChild=t.appendChild,t.appendChild=function(t){const e=t["s-sn"]=Te(t),i=Ae(this.childNodes,e,this.tagName);if(i){const n=Me(i,e),r=n[n.length-1],s=Bt(r.parentNode,t,r.nextSibling);return zt(this),s}return this.__appendChild(t)}},pe=t=>{t.__removeChild=t.removeChild,t.removeChild=function(t){if(t&&void 0!==t["s-sn"]){const e=Ae(this.childNodes,t["s-sn"],this.tagName);if(e){const i=Me(e,t["s-sn"]).find((e=>e===t));if(i)return i.remove(),void zt(this)}}return this.__removeChild(t)}},ge=t=>{const e=t.prepend;t.prepend=function(...t){t.forEach((t=>{"string"==typeof t&&(t=this.ownerDocument.createTextNode(t));const i=t["s-sn"]=Te(t),n=Ae(this.childNodes,i,this.tagName);if(n){const e=document.createTextNode("");e["s-nr"]=t,n["s-cr"].parentNode.__appendChild(e),t["s-ol"]=e;const r=Me(n,i)[0];return Bt(r.parentNode,t,r.nextSibling)}return 1===t.nodeType&&t.getAttribute("slot")&&(t.hidden=!0),e.call(this,t)}))}},ve=t=>{t.append=function(...t){t.forEach((t=>{"string"==typeof t&&(t=this.ownerDocument.createTextNode(t)),this.appendChild(t)}))}},me=t=>{const e=t.insertAdjacentHTML;t.insertAdjacentHTML=function(t,i){if("afterbegin"!==t&&"beforeend"!==t)return e.call(this,t,i);const n=this.ownerDocument.createElement("_");let r;if(n.innerHTML=i,"afterbegin"===t)for(;r=n.firstChild;)this.prepend(r);else if("beforeend"===t)for(;r=n.firstChild;)this.append(r)}},ye=t=>{t.insertAdjacentText=function(t,e){this.insertAdjacentHTML(t,e)}},_e=t=>{const e=t.insertAdjacentElement;t.insertAdjacentElement=function(t,i){return"afterbegin"!==t&&"beforeend"!==t?e.call(this,t,i):"afterbegin"===t?(this.prepend(i),i):"beforeend"===t?(this.append(i),i):i}},be=t=>{const e=Object.getOwnPropertyDescriptor(Node.prototype,"textContent");Object.defineProperty(t,"__textContent",e),n.experimentalScopedSlotChanges?Object.defineProperty(t,"textContent",{get(){return" "+xe(this.childNodes).map((t=>{var e,i;const n=[];let r=t.nextSibling;for(;r&&r["s-sn"]===t["s-sn"];)3!==r.nodeType&&1!==r.nodeType||n.push(null!=(i=null==(e=r.textContent)?void 0:e.trim())?i:""),r=r.nextSibling;return n.filter((t=>""!==t)).join(" ")})).filter((t=>""!==t)).join(" ")+" "},set(t){xe(this.childNodes).forEach((e=>{let i=e.nextSibling;for(;i&&i["s-sn"]===e["s-sn"];){const t=i;i=i.nextSibling,t.remove()}if(""===e["s-sn"]){const i=this.ownerDocument.createTextNode(t);i["s-sn"]="",Bt(e.parentElement,i,e.nextSibling)}else e.remove()}))}}):Object.defineProperty(t,"textContent",{get(){var t;const e=Ae(this.childNodes,"",this.tagName);return 3===(null==(t=null==e?void 0:e.nextSibling)?void 0:t.nodeType)?e.nextSibling.textContent:e?e.textContent:this.__textContent},set(t){var e;const i=Ae(this.childNodes,"",this.tagName);if(3===(null==(e=null==i?void 0:i.nextSibling)?void 0:e.nodeType))i.nextSibling.textContent=t;else if(i)i.textContent=t;else{this.__textContent=t;const e=this["s-cr"];e&&Bt(this,e,this.firstChild)}}})},we=(t,e)=>{class i extends Array{item(t){return this[t]}}if(8&e.$flags$){const e=t.__lookupGetter__("childNodes");Object.defineProperty(t,"children",{get(){return this.childNodes.map((t=>1===t.nodeType))}}),Object.defineProperty(t,"childElementCount",{get(){return t.children.length}}),Object.defineProperty(t,"childNodes",{get(){const t=e.call(this);if(!(1&M.$flags$)&&2&h(this).$flags$){const e=new i;for(let i=0;i<t.length;i++){const n=t[i]["s-nr"];n&&e.push(n)}return e}return i.from(t)}})}},xe=t=>{const e=[];for(const i of Array.from(t))i["s-sr"]&&e.push(i),e.push(...xe(i.childNodes));return e},Te=t=>t["s-sn"]||1===t.nodeType&&t.getAttribute("slot")||"",Ae=(t,e,i)=>{let n,r=0;for(;r<t.length;r++){if(n=t[r],n["s-sr"]&&n["s-sn"]===e&&n["s-hn"]===i)return n;if(n=Ae(n.childNodes,e,i),n)return n}return null},Me=(t,e)=>{const i=[t];for(;(t=t.nextSibling)&&t["s-sn"]===e;)i.push(t);return i},Se=(t,e)=>{const i={$flags$:e[0],$tagName$:e[1]};var r,s;n.member&&(i.$members$=e[2]),n.hostListener&&(i.$listeners$=e[3]),n.watchCallback&&(i.$watchers$=t.$watchers$),n.reflect&&(i.$attrsToReflect$=[]),n.shadowDom&&!S&&1&i.$flags$&&(i.$flags$|=8),n.experimentalSlotFixes?n.scoped&&2&i.$flags$&&(r=t.prototype,s=i,de(r),fe(r),ve(r),ge(r),_e(r),me(r),ye(r),be(r),we(r,s),pe(r)):(n.slotChildNodesFix&&we(t.prototype,i),n.cloneNodeFix&&de(t.prototype),n.appendChildSlotFix&&fe(t.prototype),n.scopedSlotTextContentFix&&2&i.$flags$&&be(t.prototype));const o=t.prototype.connectedCallback,l=t.prototype.disconnectedCallback;return Object.assign(t.prototype,{__registerHost(){((t,e)=>{const i={$flags$:0,$hostElement$:t,$cmpMeta$:e,$instanceValues$:new Map};n.isDev&&(i.$renderCount$=0),n.method&&n.lazyLoad&&(i.$onInstancePromise$=new Promise((t=>i.$onInstanceResolve$=t))),n.asyncLoading&&(i.$onReadyPromise$=new Promise((t=>i.$onReadyResolve$=t)),t["s-p"]=[],t["s-rc"]=[]),a.set(t,i)})(this,i)},connectedCallback(){const t=h(this);Ce(this,t,i.$listeners$,!1),(t=>{if(!(1&M.$flags$)){const e=h(t),i=e.$cmpMeta$,r=tt("connectedCallback",i.$tagName$);if(n.hostListenerTargetParent&&Ce(t,e,i.$listeners$,!0),1&e.$flags$)Ce(t,e,i.$listeners$,!1),(null==e?void 0:e.$lazyInstance$)?le(e.$lazyInstance$):(null==e?void 0:e.$onReadyPromise$)&&e.$onReadyPromise$.then((()=>le(e.$lazyInstance$)));else{let r;if(e.$flags$|=1,n.hydrateClientSide&&(r=t.getAttribute(m),r)){if(n.shadowDom&&S&&1&i.$flags$){const e=n.mode?pt(t.shadowRoot,i,t.getAttribute("s-mode")):pt(t.shadowRoot,i);t.classList.remove(e+"-h",e+"-s")}((t,e,i,r)=>{const s=tt("hydrateClient",e),o=t.shadowRoot,a=[],h=n.shadowDom&&o?[]:null,l=r.$vnode$=it(e,null);M.$orgLocNodes$||ct(T.body,M.$orgLocNodes$=new Map),t[m]=i,t.removeAttribute(m),lt(l,a,[],h,t,t,i),a.map((t=>{const i=t.$hostId$+"."+t.$nodeId$,n=M.$orgLocNodes$.get(i),r=t.$elm$;n&&S&&""===n["s-en"]&&n.parentNode.insertBefore(r,n.nextSibling),o||(r["s-hn"]=e,n&&(r["s-ol"]=n,r["s-ol"]["s-nr"]=r)),M.$orgLocNodes$.delete(i)})),n.shadowDom&&o&&h.map((t=>{t&&o.appendChild(t)})),s()})(t,i.$tagName$,r,e)}if(n.slotRelocation&&!r&&(n.hydrateServerSide||(n.slot||n.shadowDom)&&12&i.$flags$)&&ce(t),n.asyncLoading){let i=t;for(;i=i.parentNode||i.host;)if(n.hydrateClientSide&&1===i.nodeType&&i.hasAttribute("s-id")&&i["s-p"]||i["s-p"]){qt(e,e.$ancestorComponent$=i);break}}n.prop&&!n.hydrateServerSide&&i.$members$&&Object.entries(i.$members$).map((([e,[i]])=>{if(31&i&&t.hasOwnProperty(e)){const i=t[e];delete t[e],t[e]=i}})),n.initializeNextTick?k((()=>he(t,e,i))):he(t,e,i)}r()}})(this),n.connectedCallback&&o&&o.call(this)},disconnectedCallback(){(async t=>{if(!(1&M.$flags$)){const e=h(t);n.hostListener&&e.$rmListeners$&&(e.$rmListeners$.map((t=>t())),e.$rmListeners$=void 0),n.lazyLoad?(null==e?void 0:e.$lazyInstance$)?ue(e.$lazyInstance$):(null==e?void 0:e.$onReadyPromise$)&&e.$onReadyPromise$.then((()=>ue(e.$lazyInstance$))):ue(t)}})(this),n.disconnectedCallback&&l&&l.call(this)},__attachShadow(){if(S)if(this.shadowRoot){if("open"!==this.shadowRoot.mode)throw new Error(`Unable to re-use existing shadow root for ${i.$tagName$}! Mode is set to ${this.shadowRoot.mode} but Stencil only supports open shadow roots.`)}else n.shadowDelegatesFocus?this.attachShadow({mode:"open",delegatesFocus:!!(16&i.$flags$)}):this.attachShadow({mode:"open"});else this.shadowRoot=this}}),t.is=i.$tagName$,ae(t,i,3)},Ee=(t,e)=>e,Ce=(t,e,i,r)=>{n.hostListener&&i&&(n.hostListenerTargetParent&&(i=r?i.filter((([t])=>32&t)):i.filter((([t])=>!(32&t)))),i.map((([i,r,s])=>{const o=n.hostListenerTarget?Re(t,i):t,a=Oe(e,s),h=Ie(i);M.ael(o,r,a,h),(e.$rmListeners$=e.$rmListeners$||[]).push((()=>M.rel(o,r,a,h)))})))},Oe=(t,e)=>i=>{var r;try{n.lazyLoad?256&t.$flags$?null==(r=t.$lazyInstance$)||r[e](i):(t.$queuedListeners$=t.$queuedListeners$||[]).push([e,i]):t.$hostElement$[e](i)}catch(t){c(t)}},Re=(t,e)=>n.hostListenerTargetDocument&&4&e?T:n.hostListenerTargetWindow&&8&e?x:n.hostListenerTargetBody&&16&e?T.body:n.hostListenerTargetParent&&32&e&&t.parentElement?t.parentElement:t,Ie=t=>E?{passive:!!(1&t),capture:!!(2&t)}:!!(2&t)},38474:function(t,e,i){"use strict";i.d(e,{C:function(){return y},b:function(){return m}});var n=i(27264),r=i(13668),s=i(34178),o=i(27271),a=i(85709),h=i(77771),l=i(58766),c=i(23864),u=i(20830),d=i(38917),f=i(39506),p=i(62988),g=i(65839),v=i(25124);function m(t){const e=new p.N5,{vertex:i,fragment:m,attributes:y,varyings:_}=e;(0,u.NB)(i,t),e.include(s.d,t),e.include(a.c,t),e.include(l.A,t),e.include(o.g,t),e.include(r.HQ,t),e.include(v.z,t),y.add(g.r.POSITION,"vec3"),t.vvColor&&y.add(g.r.COLORFEATUREATTRIBUTE,"float"),_.add("vColor","vec4"),_.add("vpos","vec3");const b=t.terrainDepthTest&&t.output===n.V.Color;return b&&_.add("depth","float"),i.uniforms.add(new d.E("eColor",(t=>t.color))),i.main.add(f.H`
      vpos = position;
      forwardNormalizedVertexColor();
      forwardObjectAndLayerIdColor();

      ${t.hasVertexColors?"vColor *= eColor;":t.vvColor?"vColor = eColor * interpolateVVColor(colorFeatureAttribute);":"vColor = eColor;"}
      ${b?"depth = (view * vec4(vpos, 1.0)).z;":""}
      gl_Position = transformPosition(proj, view, vpos);`),e.include(r.HQ,t),b&&e.include(h.Z,t),m.include(c.a),m.main.add(f.H`
    discardBySlice(vpos);
    ${b?"terrainDepthTest(depth);":""}
    vec4 fColor = vColor;
    outputColorHighlightOID(fColor, vpos);`),e}const y=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:"Module"}))},1092:function(t,e,i){"use strict";i.d(e,{C:function(){return d},a:function(){return p},b:function(){return f}});var n=i(77423),r=i(23397),s=i(52766),o=i(11687),a=i(14543),h=i(39506),l=i(62988),c=i(39838),u=i(54204);class d extends h.Y{constructor(){super(...arguments),this.opacity=1}}function f(t){const e=new l.N5;e.include(n.c),e.fragment.uniforms.add(new c.N("tex",(t=>t.texture))),t.hasOpacityFactor&&e.fragment.uniforms.add(new a.m("opacity",(t=>t.opacity)));const i=t.blitMode===u.d.Depth;return i&&(e.fragment.uniforms.add(new o.G("nearFar",((t,e)=>e.camera.nearFar))),e.fragment.include(r.E),e.fragment.include(s.W)),e.fragment.main.add(h.H`
    ${i?h.H`
          float normalizedLinearDepth = (-linearDepthFromTexture(tex, uv) - nearFar[0]) / (nearFar[1] - nearFar[0]);
          fragColor = float2rgba(normalizedLinearDepth);`:h.H`
          fragColor = texture(tex, uv) ${t.hasOpacityFactor?"* opacity":""};`}`),e}const p=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:d,build:f},Symbol.toStringTag,{value:"Module"}))},88008:function(t,e,i){"use strict";i.d(e,{H:function(){return L},b:function(){return I},c:function(){return N},s:function(){return R}});var n=i(13786),r=i(1932),s=i(41546),o=i(43587),a=i(27264),h=i(13668),l=i(27271),c=i(10155),u=i(1143),d=i(50399),f=i(80231),p=i(84435),g=i(58766),v=i(28686),m=i(23864),y=i(52766),_=i(19202),b=i(20830),w=i(11687),x=i(41356),T=i(38917),A=i(14543),M=i(39506),S=i(62988),E=i(39838),C=i(54840),O=i(65839);const R={occludedFadeFactor:.6};function I(t){const e=new S.N5,i=t.signedDistanceFieldEnabled;if(e.include(u.Q,t),e.include(h.HQ,t),t.occlusionPass)return e.include(d.I,t),e;const{vertex:r,fragment:I}=e;e.include(_.Y6),e.include(g.A,t),e.include(l.g,t),e.include(f.y),I.include(y.W),I.include(m.a),e.varyings.add("vcolor","vec4"),e.varyings.add("vtc","vec2"),e.varyings.add("vsize","vec2"),e.varyings.add("voccluded","float"),r.uniforms.add(new T.E("viewport",((t,e)=>e.camera.fullViewport)),new w.G("screenOffset",((t,e)=>(0,n.hZ)(D,2*t.screenOffset[0]*e.camera.pixelRatio,2*t.screenOffset[1]*e.camera.pixelRatio))),new w.G("anchorPosition",(t=>N(t))),new T.E("materialColor",(t=>t.color)),new A.m("materialRotation",(t=>t.rotation))),(0,b.Nz)(r),i&&(r.uniforms.add(new T.E("outlineColor",(t=>t.outlineColor))),I.uniforms.add(new T.E("outlineColor",(t=>P(t)?t.outlineColor:s.uY)),new A.m("outlineSize",(t=>P(t)?t.outlineSize:0)))),t.horizonCullingEnabled&&r.uniforms.add(new x.V("pointDistanceSphere",((t,e)=>{const i=e.camera.eye,n=t.origin;return(0,s.fA)(n[0]-i[0],n[1]-i[1],n[2]-i[2],o.$O.radius)}))),t.pixelSnappingEnabled&&r.include(c.K),t.hasScreenSizePerspective&&((0,_.pM)(r),(0,_.OH)(r)),t.debugDrawLabelBorder&&e.varyings.add("debugBorderCoords","vec4"),e.attributes.add(O.r.UV0,"vec2"),e.attributes.add(O.r.COLOR,"vec4"),e.attributes.add(O.r.SIZE,"vec2"),e.attributes.add(O.r.ROTATION,"float"),e.attributes.add(O.r.FEATUREATTRIBUTE,"vec4"),r.code.add(t.horizonCullingEnabled?M.H`bool behindHorizon(vec3 posModel) {
vec3 camToEarthCenter = pointDistanceSphere.xyz - localOrigin;
vec3 camToPos = pointDistanceSphere.xyz + posModel;
float earthRadius = pointDistanceSphere.w;
float a = dot(camToPos, camToPos);
float b = dot(camToPos, camToEarthCenter);
float c = dot(camToEarthCenter, camToEarthCenter) - earthRadius * earthRadius;
return  b > 0.0 && b < a && b * b  > a * c;
}`:M.H`bool behindHorizon(vec3 posModel) { return false; }`),r.main.add(M.H`
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);
      forwardObjectAndLayerIdColor();

      if (rejectBySlice(projectAux.posModel)) {
        // Project outside of clip plane
        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
        return;
      }

      if (behindHorizon(projectAux.posModel)) {
        // Project outside of clip plane
        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
        return;
      }

      vec2 inputSize;
      ${(0,M.If)(t.hasScreenSizePerspective,M.H`
          inputSize = screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);
          vec2 screenOffsetScaled = screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);`,M.H`
          inputSize = size;
          vec2 screenOffsetScaled = screenOffset;`)}
      ${(0,M.If)(t.vvSize,M.H`inputSize *= vvScale(featureAttribute).xx;`)}

      vec2 combinedSize = inputSize * pixelRatio;
      vec4 quadOffset = vec4(0.0);
      bool visible = testHUDVisibility(posProj);
      voccluded = visible ? 0.0 : 1.0;
    `);const L=M.H`
      vec2 uv01 = floor(uv0);
      vec2 uv = uv0 - uv01;
      quadOffset.xy = (uv01 - anchorPosition) * 2.0 * combinedSize;

      ${(0,M.If)(t.hasRotation,M.H`
          float angle = radians(materialRotation + rotation);
          float cosAngle = cos(angle);
          float sinAngle = sin(angle);
          mat2 rotate = mat2(cosAngle, -sinAngle, sinAngle,  cosAngle);

          quadOffset.xy = rotate * quadOffset.xy;
        `)}

      quadOffset.xy = (quadOffset.xy + screenOffsetScaled) / viewport.zw * posProj.w;
  `,z=t.pixelSnappingEnabled?i?M.H`posProj = alignToPixelOrigin(posProj, viewport.zw) + quadOffset;`:M.H`posProj += quadOffset;
if (inputSize.x == size.x) {
posProj = alignToPixelOrigin(posProj, viewport.zw);
}`:M.H`posProj += quadOffset;`;r.main.add(M.H`
    ${(0,M.If)(t.occlusionTestEnabled,M.H`
      if (!visible) {
        vtc = vec2(0.0);
        ${(0,M.If)(t.debugDrawLabelBorder,"debugBorderCoords = vec4(0.5, 0.5, 1.5 / combinedSize);")}
        return;
      }`)}
    ${L}
    ${t.vvColor?"vcolor = interpolateVVColor(featureAttribute.y) * materialColor;":"vcolor = color / 255.0 * materialColor;"}

    ${(0,M.If)(t.output===a.V.ObjectAndLayerIdColor,M.H`vcolor.a = 1.0;`)}

    bool alphaDiscard = vcolor.a < ${M.H.float(v.Q)};
    ${(0,M.If)(i,`alphaDiscard = alphaDiscard && outlineColor.a < ${M.H.float(v.Q)};`)}
    if (alphaDiscard) {
      // "early discard" if both symbol color (= fill) and outline color (if applicable) are transparent
      gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
      return;
    } else {
      ${z}
      gl_Position = posProj;
    }

    vtc = uv;

    ${(0,M.If)(t.debugDrawLabelBorder,M.H`debugBorderCoords = vec4(uv01, 1.5 / combinedSize);`)}
    vsize = inputSize;
  `),I.uniforms.add(new E.N("tex",(t=>t.texture))),t.occludedFragmentFade&&(I.uniforms.add(new E.N("depthMap",((t,e)=>e.mainDepth))),I.uniforms.add(new A.m("fadeFactor",(()=>R.occludedFadeFactor))));const j=t.debugDrawLabelBorder?M.H`(isBorder > 0.0 ? 0.0 : ${M.H.float(v.Q)})`:M.H.float(v.Q),k=t.output===a.V.Highlight,F=M.H`
    ${(0,M.If)(t.debugDrawLabelBorder,M.H`float isBorder = float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));`)}

    ${(0,M.If)(t.sampleSignedDistanceFieldTexelCenter,M.H`
      float txSize = float(textureSize(tex, 0).x);
      float texelSize = 1.0 / txSize;

      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel
      vec2 scaleFactor = (vsize - txSize) * texelSize;
      vec2 samplePos = vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;`,M.H`vec2 samplePos = vtc;`)}

    ${i?M.H`
      vec4 fillPixelColor = vcolor;

      // Get distance and map it into [-0.5, 0.5]
      float d = rgba2float(texture(tex, samplePos)) - 0.5;

      // Distance in output units (i.e. pixels)
      float dist = d * vsize.x;

      // Create smooth transition from the icon into its outline
      float fillAlphaFactor = clamp(0.5 - dist, 0.0, 1.0);
      fillPixelColor.a *= fillAlphaFactor;

      if (outlineSize > 0.25) {
        vec4 outlinePixelColor = outlineColor;
        float clampedOutlineSize = min(outlineSize, 0.5*vsize.x);

        // Create smooth transition around outline
        float outlineAlphaFactor = clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);
        outlinePixelColor.a *= outlineAlphaFactor;

        if (
          outlineAlphaFactor + fillAlphaFactor < ${j} ||
          fillPixelColor.a + outlinePixelColor.a < ${M.H.float(v.Q)}
        ) {
          discard;
        }

        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)
        float compositeAlpha = outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);
        vec3 compositeColor = vec3(outlinePixelColor) * outlinePixelColor.a +
          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);

        ${(0,M.If)(!k,M.H`fragColor = vec4(compositeColor, compositeAlpha);`)}
      } else {
        if (fillAlphaFactor < ${j}) {
          discard;
        }

        ${(0,M.If)(!k,M.H`fragColor = premultiplyAlpha(fillPixelColor);`)}
      }

      // visualize SDF:
      // fragColor = vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);
      `:M.H`
          vec4 texColor = texture(tex, vtc, -0.5);
          if (texColor.a < ${j}) {
            discard;
          }
          ${(0,M.If)(!k,M.H`fragColor = texColor * premultiplyAlpha(vcolor);`)}
          `}

    ${(0,M.If)(t.occludedFragmentFade&&!k,M.H`
        float zSample = texelFetch(depthMap, ivec2(gl_FragCoord.xy), 0).x;
        if (zSample < gl_FragCoord.z) {
          fragColor *= fadeFactor;
        }
        `)}

    ${(0,M.If)(!k&&t.debugDrawLabelBorder,M.H`fragColor = mix(fragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder * 0.5);`)}
  `;switch(t.output){case a.V.Color:t.oitPass===C.Y.ColorAlpha&&(e.outputs.add("fragColor","vec4",0),e.outputs.add("fragAlpha","float",1)),I.main.add(M.H`
        ${F}
        ${(0,M.If)(t.oitPass===C.Y.FrontFace,M.H`fragColor.rgb /= fragColor.a;`)}
        ${(0,M.If)(t.oitPass===C.Y.ColorAlpha,M.H`fragAlpha = fragColor.a;`)}`);break;case a.V.ObjectAndLayerIdColor:I.main.add(M.H`
        ${F}
        outputObjectAndLayerIdColor();`);break;case a.V.Highlight:e.include(p.Q,t),I.main.add(M.H`
        ${F}
        outputHighlight(voccluded == 1.0);`)}return e}function P(t){return t.outlineColor[3]>0&&t.outlineSize>0}function N(t,e=D){return t.textureIsSignedDistanceField?function(t,e,i){null!=e?(0,n.hZ)(i,t[0]*(e[2]-e[0])+e[0],t[1]*(e[3]-e[1])+e[1]):(0,n.hZ)(i,0,0)}(t.anchorPosition,t.distanceFieldBoundingBox,e):(0,n.C)(e,t.anchorPosition),e}const D=(0,r.vt)(),L=Object.freeze(Object.defineProperty({__proto__:null,build:I,calculateAnchorPosForRendering:N,shaderSettings:R},Symbol.toStringTag,{value:"Module"}))},82186:function(t,e,i){"use strict";i.d(e,{H:function(){return u},b:function(){return c}});var n=i(28721),r=i(74571),s=i(14543),o=i(50295),a=i(39506),h=i(62988),l=i(39838);function c(){const t=new h.N5;t.include(n.Q);const{fragment:e}=t;return e.uniforms.add(new l.N("highlightTexture",(t=>t.highlightTexture)),new l.N("highlightOptionsTexture",(t=>t.highlightOptionsTexture)),new s.m("pixelRatio",(t=>t.pixelRatio)),new s.m("occludedIntensityFactor",(t=>t.occludedFactor)),new o.c("maxHighlightLevel",(t=>t.maxHighlightLevel))),e.constants.add("pixelSampleScale","float",1),t.include(r.y),e.code.add(a.H`const float pascal17[9] = float[9](12870.0, 11440.0, 8008.0, 4368.0, 1820.0, 560.0, 120.0, 16.0, 1.0);
const float denom17 =  65536.0;
float colorWeight[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
float colorOcclusion[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
float weights[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);
void applyTexel(vec2 texel, float weight) {
if (texel != vec2(0.0)){
int maxChannel = (maxHighlightLevel >> 2) & 1;
for (int channelIndex = 0; channelIndex <= maxChannel; ++channelIndex){
uint channel = readChannel(texel, channelIndex << 2);
int firstIndex = channelIndex << 2;
int maxIndex  = min(firstIndex + 3, maxHighlightLevel);
for (int highlightIndex = firstIndex; highlightIndex <= maxIndex; ++highlightIndex ) {
uint v = readChannelBits(channel, highlightIndex);
if ((v & 1u) == 1u){
colorWeight[highlightIndex] += weight;
if ((v & 2u) == 2u){
colorOcclusion[highlightIndex] += weight;
}
}
}
}
}
}
vec2 readTexel(ivec2 iuv, int du, int dv) {
return texelFetch(highlightTexture, iuv + ivec2(du, dv), 0).rg;
}
void readAndApplyTexel(ivec2 iuv, int du, int dv, float weight) {
vec2 texel = readTexel(iuv, du, dv);
applyTexel(texel, weight);
}
void readAndApply2TexelsU(ivec2 iuv, int du, int dv, float weight) {
readAndApplyTexel(iuv, -du, dv, weight);
readAndApplyTexel(iuv, +du, dv, weight);
}
float getWeight(int pixelDistance) {
float scaledDistance = float(pixelDistance) * pixelSampleScale / pixelRatio;
float d0f = floor(scaledDistance);
int d0 = int(d0f);
if (d0 >= 8){
return 0.0;
}
float w0 = pascal17[d0];
float w1 = pascal17[d0+1];
float f =  scaledDistance - d0f;
return mix(w0, w1, f);
}`),e.main.add(a.H`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));
ivec2 iuv = ivec2(sUV * highlightTextureSize);
vec2 centerTexel = texelFetch(highlightTexture, iuv, 0).rg;
bool outlinePossible = false;
if (vOutlinePossible > 0.0){
for (int highlightLevel=0; highlightLevel<= maxHighlightLevel; ++highlightLevel) {
if ((readLevelBits(centerTexel,highlightLevel) & 1u) == 0u) {
outlinePossible = true;
break;
}
}
}
if (outlinePossible) {
int maxPixelDistance = clamp(int(8.0 * pixelRatio / pixelSampleScale), 2, 16);
float weightSum = 0.0;
for(int y = 0; y <= maxPixelDistance; ++y) {
float w = getWeight(y);
weights[y] = w;
weightSum += w * (y == 0 ? 1.0 : 2.0);
}
for(int y = 0; y <= maxPixelDistance; ++y) {
weights[y] = weights[y] / weightSum;
}
float weight0 = weights[0];
applyTexel(centerTexel, weight0 * weight0);
for(int y = 0; y <= maxPixelDistance; y += 1) {
float yFactor = weights[y];
if (y != 0) {
float xFactor = weight0;
float weight = xFactor * yFactor;
if (weight > 0.0) {
readAndApplyTexel(iuv, 0, +y, weight);
readAndApplyTexel(iuv, 0, -y, weight);
}
}
for(int x = 1; x <= maxPixelDistance; x += 1) {
float xFactor = weights[x];
float weight = xFactor * yFactor;
if (weight > 0.0) {
readAndApply2TexelsU(iuv, x, +y, weight);
if (y != 0){
readAndApply2TexelsU(iuv, x, -y, weight);
}
}
}
}
} else {
applyTexel(centerTexel, 1.0);
}
int frontColorIndex = 999;
int maxColorIndex = 0;
for (int i = 0; i <= maxHighlightLevel; ++i) {
if (colorWeight[i] > 0.0){
frontColorIndex = min(frontColorIndex, i);
maxColorIndex = max(maxColorIndex, i);
}
}
if (frontColorIndex == 999){
fragColor = vec4(0.0);
return;
}
vec4 accumulatedColor = vec4(0.0);
for (int curColorIndex = frontColorIndex; curColorIndex <= maxColorIndex; ++curColorIndex) {
float curColorWeight = colorWeight[curColorIndex];
if (curColorWeight <= 0.01){
continue;
}
uint vc = readLevelBits(centerTexel, curColorIndex);
bool centerFilled = (vc & 1u) == 1u;
bool centerOccluded = (vc & 3u) == 3u;
float curColorOcclusion = colorOcclusion[curColorIndex];
bool occluded = centerFilled ? centerOccluded : curColorOcclusion > 0.5 * curColorWeight;
int colorChannel = centerFilled ? 0 : 1;
vec4 colorBase = texelFetch(highlightOptionsTexture, ivec2(curColorIndex, colorChannel), 0);
float occlusionFactor = occluded ? occludedIntensityFactor : 1.0;
float outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, 0.03, curColorWeight);
float intensity = colorBase.a * occlusionFactor * outlineFactor;
vec3 currentColor = colorBase.rgb;
float a0 = accumulatedColor.a;
float a1 = intensity;
float alpha = clamp(a0 + a1 - a0 * a1, 0.0, 1.0);
if (alpha > 0.001){
vec3 blendedColor = ((1.0 - a1) * a0 * accumulatedColor.rgb + a1 * currentColor) / alpha;
accumulatedColor = vec4(blendedColor, alpha);
}
}
fragColor = accumulatedColor;`),t}const u=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}))},40434:function(t,e,i){"use strict";i.d(e,{H:function(){return a},a:function(){return d},b:function(){return u},c:function(){return h},g:function(){return l},o:function(){return c}});var n=i(77423),r=i(39506),s=i(62988),o=i(40075);class a extends r.Y{}function h(){const t=new s.N5,{outputs:e,fragment:i}=t;return t.include(n.c),i.uniforms.add(new o.o("textureInput",(t=>t.input))),i.constants.add("outlineWidth","int",Math.ceil(c)),i.constants.add("cellSize","int",l),e.add("fragGrid","vec2"),i.main.add(r.H`vec2 inputTextureSize = vec2(textureSize(textureInput, 0));
vec2 cellBottomLeftCornerInput = floor(gl_FragCoord.xy) * vec2(cellSize);
vec2 coordMid =  (cellBottomLeftCornerInput + 0.5 * vec2(cellSize)) / inputTextureSize;
vec2 commonValue = texture(textureInput, coordMid).rg;
int margin = outlineWidth;
float marginSquare = float(margin*margin);
for(int y = -margin; y <= cellSize + margin; y+=2) {
int dy = y < 0 ? -y : y > cellSize ? y-cellSize : 0;
int xMargin = dy > 0 ? int(ceil(sqrt(marginSquare - float(dy*dy)))) : margin;
for(int x = -xMargin; x <= cellSize + xMargin; x+=2) {
vec2 coord = (cellBottomLeftCornerInput + vec2(x, y)) / inputTextureSize;
vec2 value = texture(textureInput, coord).rg;
if (value != commonValue){
fragGrid = vec2(1.0, 1.0);
return;
}
}
}
bool hasAny = commonValue != vec2(0.0);
fragGrid = vec2(hasAny ? 1.0 : 0.0, 0.0);`),t}const l=32,c=9,u=.4,d=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:a,blurSize:u,build:h,gridCellPixelSize:l,outlineSize:c},Symbol.toStringTag,{value:"Module"}))},46655:function(t,e,i){"use strict";i.d(e,{H:function(){return c},b:function(){return l}});var n=i(28721),r=i(74571),s=i(50295),o=i(39506),a=i(62988),h=i(39838);function l(){const t=new a.N5;t.include(n.Q),t.include(r.y);const{fragment:e}=t;return t.outputs.add("fragSingleHighlight","vec2",0),e.uniforms.add(new h.N("highlightTexture",(t=>t.highlightTexture)),new s.c("maxHighlightLevel",(t=>t.maxHighlightLevel)),new s.c("highlightLevel",(t=>t.highlightLevel))),t.include(r.y),e.main.add(o.H`ivec2 iuv = ivec2(gl_FragCoord.xy);
vec2 inputTexel = texelFetch(highlightTexture, iuv, 0).rg;
uint bits = readLevelBits(inputTexel, highlightLevel);
bool hasHighlight = (bits & 1u) == 1u;
bool hasOccluded  = (bits & 2u) == 2u;
fragSingleHighlight = vec2(hasHighlight ? 1.0 : 0.0, hasOccluded ? 1.0 : 0.0);`),t}const c=Object.freeze(Object.defineProperty({__proto__:null,build:l},Symbol.toStringTag,{value:"Module"}))},72468:function(t,e,i){"use strict";i.d(e,{I:function(){return m},b:function(){return v}});var n=i(27264),r=i(13668),s=i(34178),o=i(27271),a=i(77771),h=i(23864),l=i(20830),c=i(14543),u=i(39506),d=i(62988),f=i(39838),p=i(65839),g=i(25124);function v(t){const e=new d.N5,{vertex:i,fragment:v}=e;return(0,l.NB)(i,t),e.include(s.d,t),e.include(a.Z,t),e.include(r.HQ,t),e.include(o.g,t),e.include(g.z,t),e.attributes.add(p.r.POSITION,"vec3"),e.attributes.add(p.r.UV0,"vec2"),t.perspectiveInterpolation&&e.attributes.add(p.r.PERSPECTIVEDIVIDE,"float"),e.varyings.add("vpos","vec3"),t.terrainDepthTest&&e.varyings.add("depth","float"),i.main.add(u.H`
    vpos = position;
    ${t.terrainDepthTest?"depth = (view * vec4(vpos, 1.0)).z;":""}
    vTexCoord = uv0;
    gl_Position = transformPosition(proj, view, vpos);
    ${t.perspectiveInterpolation?"gl_Position *= perspectiveDivide;":""}`),v.uniforms.add(new f.N("tex",(t=>t.texture)),new c.m("opacity",(t=>t.opacity))),e.varyings.add("vTexCoord","vec2"),v.include(h.a),v.main.add(u.H`
    discardBySlice(vpos);
    ${t.terrainDepthTest?"terrainDepthTest(depth);":""}
    ${t.output===n.V.ObjectAndLayerIdColor?"fragColor = vec4(0, 0, 0, 1);\n           return;":""}
    vec4 finalColor = texture(tex, vTexCoord) * opacity;
    outputColorHighlightOID(finalColor, vpos);`),e}const m=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}))},58054:function(t,e,i){"use strict";i.d(e,{L:function(){return m},b:function(){return p}});var n=i(73364),r=i(39714),s=i(13786),o=i(1932),a=i(68561),h=i(11687),l=i(14543),c=i(39506),u=i(70340),d=i(62988),f=i(65839);function p(t){const e=new d.N5;e.include(a.K,t);const{vertex:i,fragment:r}=e;i.uniforms.add(new u.X("modelView",((t,{camera:e})=>(0,n.Tl)(v,e.viewMatrix,t.origin))),new u.X("proj",((t,{camera:e})=>e.projectionMatrix)),new l.m("glowWidth",((t,{camera:e})=>t.glowWidth*e.pixelRatio)),new h.G("pixelToNDC",((t,{camera:e})=>(0,s.hZ)(g,2/e.fullViewport[2],2/e.fullViewport[3])))),e.attributes.add(f.r.START,"vec3"),e.attributes.add(f.r.END,"vec3"),t.spherical&&(e.attributes.add(f.r.START_UP,"vec3"),e.attributes.add(f.r.END_UP,"vec3")),e.attributes.add(f.r.EXTRUDE,"vec2"),e.varyings.add("uv","vec2"),e.varyings.add("vViewStart","vec3"),e.varyings.add("vViewEnd","vec3"),e.varyings.add("vViewSegmentNormal","vec3"),e.varyings.add("vViewStartNormal","vec3"),e.varyings.add("vViewEndNormal","vec3");const o=!t.spherical;return i.main.add(c.H`
    vec3 pos = mix(start, end, extrude.x);

    vec4 viewPos = modelView * vec4(pos, 1);
    vec4 projPos = proj * viewPos;
    vec2 ndcPos = projPos.xy / projPos.w;

    // in planar we hardcode the up vectors to be Z-up */
    ${(0,c.If)(o,c.H`vec3 startUp = vec3(0, 0, 1);`)}
    ${(0,c.If)(o,c.H`vec3 endUp = vec3(0, 0, 1);`)}

    // up vector corresponding to the location of the vertex, selecting either startUp or endUp */
    vec3 up = extrude.y * mix(startUp, endUp, extrude.x);
    vec3 viewUp = (modelView * vec4(up, 0)).xyz;

    vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
    vec2 projUp = normalize(projPosUp.xy / projPosUp.w - ndcPos);

    // extrude ndcPos along projUp to the edge of the screen
    vec2 lxy = abs(sign(projUp) - ndcPos);
    ndcPos += length(lxy) * projUp;

    vViewStart = (modelView * vec4(start, 1)).xyz;
    vViewEnd = (modelView * vec4(end, 1)).xyz;

    vec3 viewStartEndDir = vViewEnd - vViewStart;

    vec3 viewStartUp = (modelView * vec4(startUp, 0)).xyz;

    // the normal of the plane that aligns with the segment and the up vector
    vViewSegmentNormal = normalize(cross(viewStartUp, viewStartEndDir));

    // the normal orthogonal to the segment normal and the start up vector
    vViewStartNormal = -normalize(cross(vViewSegmentNormal, viewStartUp));

    // the normal orthogonal to the segment normal and the end up vector
    vec3 viewEndUp = (modelView * vec4(endUp, 0)).xyz;
    vViewEndNormal = normalize(cross(vViewSegmentNormal, viewEndUp));

    // Add enough padding in the X screen space direction for "glow"
    float xPaddingPixels = sign(dot(vViewSegmentNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
    ndcPos.x += xPaddingPixels * pixelToNDC.x;

    // uv is used to read back depth to reconstruct the position at the fragment
    uv = ndcPos * 0.5 + 0.5;

    gl_Position = vec4(ndcPos, 0, 1);
  `),r.uniforms.add(new l.m("perScreenPixelRatio",((t,e)=>e.camera.perScreenPixelRatio))),r.code.add(c.H`float planeDistance(vec3 planeNormal, vec3 planeOrigin, vec3 pos) {
return dot(planeNormal, pos - planeOrigin);
}
float segmentDistancePixels(vec3 segmentNormal, vec3 startNormal, vec3 endNormal, vec3 pos, vec3 start, vec3 end) {
float distSegmentPlane = planeDistance(segmentNormal, start, pos);
float distStartPlane = planeDistance(startNormal, start, pos);
float distEndPlane = planeDistance(endNormal, end, pos);
float dist = max(max(distStartPlane, distEndPlane), abs(distSegmentPlane));
float width = fwidth(distSegmentPlane);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}`),r.main.add(c.H`fragColor = vec4(0.0);
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
return;
}
vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
return;
}
float distance = segmentDistancePixels(
vViewSegmentNormal,
vViewStartNormal,
vViewEndNormal,
pos,
vViewStart,
vViewEnd
);
vec4 color = laserlineProfile(distance);
float alpha = (1.0 - smoothstep(0.995 - angleCutoffAdjust, 0.999 - angleCutoffAdjust, abs(dot(normal, vViewSegmentNormal))));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);`),e}const g=(0,o.vt)(),v=(0,r.vt)(),m=Object.freeze(Object.defineProperty({__proto__:null,build:p},Symbol.toStringTag,{value:"Module"}))},96500:function(t,e,i){"use strict";i.d(e,{L:function(){return N},b:function(){return x},d:function(){return w}});var n=i(15774),r=i(13786),s=i(1932),o=i(20551),a=i(32501),h=i(33400),l=i(41546),c=i(73313),u=i(5596),d=i(13794),f=i(68561),p=i(77423),g=i(11687),v=i(82598),m=i(38917),y=i(14543),_=i(39506),b=i(62988);const w=(0,n.kU)(6);function x(t){const e=new b.N5;e.include(p.c),e.include(f.K,t);const i=e.fragment;if(t.lineVerticalPlaneEnabled||t.heightManifoldEnabled)if(i.uniforms.add(new y.m("maxPixelDistance",((e,i)=>t.heightManifoldEnabled?2*i.camera.computeScreenPixelSizeAt(e.heightManifoldTarget):2*i.camera.computeScreenPixelSizeAt(e.lineVerticalPlaneSegment.origin)))),i.code.add(_.H`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),t.spherical){const t=(t,e,i)=>(0,o.t)(t,e.heightManifoldTarget,i.camera.viewMatrix),e=(t,e)=>(0,o.t)(t,[0,0,0],e.camera.viewMatrix);i.uniforms.add(new m.E("heightManifoldOrigin",((i,n)=>(t(S,i,n),e(O,n),(0,o.d)(O,O,S),(0,o.n)(E,O),E[3]=(0,o.l)(O),E))),new v.t("globalOrigin",((t,i)=>e(S,i))),new y.m("cosSphericalAngleThreshold",((t,e)=>1-Math.max(2,(0,o.j)(e.camera.eye,t.heightManifoldTarget)*e.camera.perRenderPixelRatio)/(0,o.l)(t.heightManifoldTarget)))),i.code.add(_.H`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)}else i.code.add(_.H`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);if(t.pointDistanceEnabled&&(i.uniforms.add(new y.m("maxPixelDistance",((t,e)=>2*e.camera.computeScreenPixelSizeAt(t.pointDistanceTarget)))),i.code.add(_.H`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`)),t.intersectsLineEnabled&&(i.uniforms.add(new y.m("perScreenPixelRatio",((t,e)=>e.camera.perScreenPixelRatio))),i.code.add(_.H`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`)),(t.lineVerticalPlaneEnabled||t.intersectsLineEnabled)&&i.code.add(_.H`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`),i.main.add(_.H`vec3 pos;
vec3 normal;
float angleCutoffAdjust;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, angleCutoffAdjust, depthDiscontinuityAlpha)) {
fragColor = vec4(0.0);
return;
}
vec4 color = vec4(0.0);`),t.heightManifoldEnabled){i.uniforms.add(new g.G("angleCutoff",(t=>T(t))),new m.E("heightPlane",((t,e)=>A(t.heightManifoldTarget,t.renderCoordsHelper.worldUpAtPosition(t.heightManifoldTarget,S),e.camera.viewMatrix))));const e=t.spherical?_.H`normalize(globalOrigin - pos)`:_.H`heightPlane.xyz`;i.main.add(_.H`
      vec2 angleCutoffAdjusted = angleCutoff - angleCutoffAdjust;
      // Fade out laserlines on flat surfaces
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoffAdjusted.x, angleCutoffAdjusted.y, abs(dot(normal, ${e})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);`)}return t.pointDistanceEnabled&&(i.uniforms.add(new g.G("angleCutoff",(t=>T(t))),new m.E("pointDistanceSphere",((t,e)=>function(t,e){return(0,o.t)((0,d.a)(P),t.pointDistanceOrigin,e.camera.viewMatrix),P[3]=(0,o.j)(t.pointDistanceOrigin,t.pointDistanceTarget),P}(t,e)))),i.main.add(_.H`float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);`)),t.lineVerticalPlaneEnabled&&(i.uniforms.add(new g.G("angleCutoff",(t=>T(t))),new m.E("lineVerticalPlane",((t,e)=>function(t,e){const i=(0,c.sd)(t.lineVerticalPlaneSegment,.5,S),n=t.renderCoordsHelper.worldUpAtPosition(i,C),r=(0,o.n)(O,t.lineVerticalPlaneSegment.vector),s=(0,o.e)(S,n,r);return(0,o.n)(s,s),A(t.lineVerticalPlaneSegment.origin,s,e.camera.viewMatrix)}(t,e))),new v.t("lineVerticalStart",((t,e)=>function(t,e){const i=(0,o.c)(S,t.lineVerticalPlaneSegment.origin);return t.renderCoordsHelper.setAltitude(i,0),(0,o.t)(i,i,e.camera.viewMatrix)}(t,e))),new v.t("lineVerticalEnd",((t,e)=>function(t,e){const i=(0,o.g)(S,t.lineVerticalPlaneSegment.origin,t.lineVerticalPlaneSegment.vector);return t.renderCoordsHelper.setAltitude(i,0),(0,o.t)(i,i,e.camera.viewMatrix)}(t,e)))),i.main.add(_.H`if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}`)),t.intersectsLineEnabled&&(i.uniforms.add(new g.G("angleCutoff",(t=>T(t))),new v.t("intersectsLineStart",((t,e)=>(0,o.t)(S,t.lineStartWorld,e.camera.viewMatrix))),new v.t("intersectsLineEnd",((t,e)=>(0,o.t)(S,t.lineEndWorld,e.camera.viewMatrix))),new v.t("intersectsLineDirection",((t,e)=>((0,o.c)(E,t.intersectsLineSegment.vector),E[3]=0,(0,o.n)(S,(0,h.t)(E,E,e.camera.viewMatrix))))),new y.m("intersectsLineRadius",(t=>t.intersectsLineRadius))),i.main.add(_.H`if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}`)),i.main.add(_.H`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);`),e}function T(t){return(0,r.hZ)(M,Math.cos(t.angleCutoff),Math.cos(Math.max(0,t.angleCutoff-(0,n.kU)(2))))}function A(t,e,i){return(0,o.t)(R,t,i),(0,o.c)(E,e),E[3]=0,(0,h.t)(E,E,i),(0,u.O_)(R,E,I)}const M=(0,s.vt)(),S=(0,a.vt)(),E=(0,l.vt)(),C=(0,a.vt)(),O=(0,a.vt)(),R=(0,a.vt)(),I=(0,u.vt)(),P=(0,d.c)(),N=Object.freeze(Object.defineProperty({__proto__:null,build:x,defaultAngleCutoff:w},Symbol.toStringTag,{value:"Module"}))},94010:function(t,e,i){"use strict";i.d(e,{O:function(){return c},a:function(){return d},b:function(){return u}});var n=i(86398),r=i(77423),s=i(14543),o=i(50295),a=i(39506),h=i(62988),l=i(39838);class c extends a.Y{constructor(){super(...arguments),this.overlayIndex=n.vr.INNER,this.opacity=1}}function u(){const t=new h.N5;return t.include(r.c),t.fragment.uniforms.add(new l.N("tex",(t=>t.texture))),t.fragment.uniforms.add(new o.c("overlayIdx",(t=>t.overlayIndex))),t.fragment.uniforms.add(new s.m("opacity",(t=>t.opacity))),t.fragment.main.add(a.H`vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);
fragColor = texture(tex, overlayUV) * opacity;`),t}const d=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:c,build:u},Symbol.toStringTag,{value:"Module"}))},35904:function(t,e,i){"use strict";i.d(e,{R:function(){return S},b:function(){return M},r:function(){return A}});var n=i(27264),r=i(13668),s=i(27271),o=i(55123),a=i(31166),h=i(91981),l=i(61629),c=i(77771),u=i(28686),d=i(23864),f=i(20830),p=i(11687),g=i(38917),v=i(14543),m=i(39506),y=i(70340),_=i(62988),b=i(65839),w=i(50678),x=i(25124),T=i(95736);const A=1;function M(t){const e=new _.N5,{attributes:i,varyings:M,vertex:S,fragment:E}=e,{applyMarkerOffset:C,draped:O,output:R,capType:I,stippleEnabled:P,falloffEnabled:N,roundJoins:D,wireframe:L,innerColorEnabled:z}=t;e.include(l.p),e.include(o.s,t),e.include(a.q,t),e.include(s.g,t);const j=C&&!O;j&&(S.uniforms.add(new v.m("markerScale",(t=>t.markerScale))),e.include(h.r,{space:w.lM.World})),(0,f.NB)(S,t),S.uniforms.add(new y.X("inverseProjectionMatrix",((t,e)=>e.camera.inverseProjectionMatrix)),new p.G("nearFar",((t,e)=>e.camera.nearFar)),new v.m("miterLimit",(t=>"miter"!==t.join?0:t.miterLimit)),new g.E("viewport",((t,e)=>e.camera.fullViewport))),S.constants.add("LARGE_HALF_FLOAT","float",65500),i.add(b.r.POSITION,"vec3"),i.add(b.r.PREVPOSITION,"vec3"),i.add(b.r.NEXTPOSITION,"vec3"),i.add(b.r.SUBDIVISIONFACTOR,"float"),i.add(b.r.UV0,"vec2"),M.add("vColor","vec4"),M.add("vpos","vec3"),M.add("vLineDistance","float"),M.add("vLineWidth","float");const k=t.terrainDepthTest&&R===n.V.Color;k&&M.add("depth","float");const F=P;F&&M.add("vLineSizeInv","float");const H=I===T.x.ROUND,B=P&&H,G=N||B;G&&M.add("vLineDistanceNorm","float"),H&&(M.add("vSegmentSDF","float"),M.add("vReverseSegmentSDF","float")),S.code.add(m.H`#define PERPENDICULAR(v) vec2(v.y, -v.x);
float interp(float ncp, vec4 a, vec4 b) {
return (-ncp - a.z) / (b.z - a.z);
}
vec2 rotate(vec2 v, float a) {
float s = sin(a);
float c = cos(a);
mat2 m = mat2(c, -s, s, c);
return m * v;
}`),S.code.add(m.H`vec4 projectAndScale(vec4 pos) {
vec4 posNdc = proj * pos;
posNdc.xy *= viewport.zw / posNdc.w;
return posNdc;
}`),S.code.add(m.H`
    void clipAndTransform(inout vec4 pos, inout vec4 prev, inout vec4 next, in bool isStartVertex) {
      float vnp = nearFar[0] * 0.99;

      if(pos.z > -nearFar[0]) {
        //current pos behind ncp --> we need to clip
        if (!isStartVertex) {
          if(prev.z < -nearFar[0]) {
            //previous in front of ncp
            pos = mix(prev, pos, interp(vnp, prev, pos));
            next = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        } else {
          if(next.z < -nearFar[0]) {
            //next in front of ncp
            pos = mix(pos, next, interp(vnp, pos, next));
            prev = pos;
          } else {
            pos = vec4(0.0, 0.0, 0.0, 1.0);
          }
        }
      } else {
        //current position visible
        if (prev.z > -nearFar[0]) {
          //previous behind ncp
          prev = mix(pos, prev, interp(vnp, pos, prev));
        }
        if (next.z > -nearFar[0]) {
          //next behind ncp
          next = mix(next, pos, interp(vnp, next, pos));
        }
      }

      ${k?"depth = pos.z;":""}

      pos = projectAndScale(pos);
      next = projectAndScale(next);
      prev = projectAndScale(prev);
    }
  `),(0,f.Nz)(S),S.constants.add("aaWidth","float",P?0:1).main.add(m.H`
    // unpack values from uv0.y
    bool isStartVertex = abs(abs(uv0.y)-3.0) == 1.0;

    float coverage = 1.0;

    // Check for special value of uv0.y which is used by the Renderer when graphics
    // are removed before the VBO is recompacted. If this is the case, then we just
    // project outside of clip space.
    if (uv0.y == 0.0) {
      // Project out of clip space
      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);
    }
    else {
      bool isJoin = abs(uv0.y) < 3.0;
      float lineSize = getSize();

      if (lineSize < 1.0) {
        coverage = lineSize; // convert sub-pixel coverage to alpha
        lineSize = 1.0;
      }
      lineSize += aaWidth;

      float lineWidth = lineSize * pixelRatio;
      vLineWidth = lineWidth;
      ${F?m.H`vLineSizeInv = 1.0 / lineSize;`:""}

      vec4 pos  = view * vec4(position, 1.0);
      vec4 prev = view * vec4(prevPosition, 1.0);
      vec4 next = view * vec4(nextPosition, 1.0);
  `),j&&S.main.add(m.H`vec4 other = isStartVertex ? next : prev;
bool markersHidden = areWorldMarkersHidden(pos, other);
if(!isJoin && !markersHidden) {
pos.xyz += normalize(other.xyz - pos.xyz) * getWorldMarkerSize(pos) * 0.5;
}`),S.main.add(m.H`clipAndTransform(pos, prev, next, isStartVertex);
vec2 left = (pos.xy - prev.xy);
vec2 right = (next.xy - pos.xy);
float leftLen = length(left);
float rightLen = length(right);`),(P||H)&&S.main.add(m.H`
      float isEndVertex = float(!isStartVertex);
      vec2 segmentOrigin = mix(pos.xy, prev.xy, isEndVertex);
      vec2 segment = mix(right, left, isEndVertex);
      ${H?m.H`vec2 segmentEnd = mix(next.xy, pos.xy, isEndVertex);`:""}
    `),S.main.add(m.H`left = (leftLen > 0.001) ? left/leftLen : vec2(0.0, 0.0);
right = (rightLen > 0.001) ? right/rightLen : vec2(0.0, 0.0);
vec2 capDisplacementDir = vec2(0, 0);
vec2 joinDisplacementDir = vec2(0, 0);
float displacementLen = lineWidth;
if (isJoin) {
bool isOutside = (left.x * right.y - left.y * right.x) * uv0.y > 0.0;
joinDisplacementDir = normalize(left + right);
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);
if (leftLen > 0.001 && rightLen > 0.001) {
float nDotSeg = dot(joinDisplacementDir, left);
displacementLen /= length(nDotSeg * left - joinDisplacementDir);
if (!isOutside) {
displacementLen = min(displacementLen, min(leftLen, rightLen)/abs(nDotSeg));
}
}
if (isOutside && (displacementLen > miterLimit * lineWidth)) {`),D?S.main.add(m.H`
        vec2 startDir = leftLen < 0.001 ? right : left;
        startDir = PERPENDICULAR(startDir);

        vec2 endDir = rightLen < 0.001 ? left : right;
        endDir = PERPENDICULAR(endDir);

        float factor = ${P?m.H`min(1.0, subdivisionFactor * ${m.H.float((A+2)/(A+1))})`:m.H`subdivisionFactor`};

        float rotationAngle = acos(clamp(dot(startDir, endDir), -1.0, 1.0));
        joinDisplacementDir = rotate(startDir, -sign(uv0.y) * factor * rotationAngle);
      `):S.main.add(m.H`if (leftLen < 0.001) {
joinDisplacementDir = right;
}
else if (rightLen < 0.001) {
joinDisplacementDir = left;
}
else {
joinDisplacementDir = (isStartVertex || subdivisionFactor > 0.0) ? right : left;
}
joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);`);const V=I!==T.x.BUTT;return S.main.add(m.H`
        displacementLen = lineWidth;
      }
    } else {
      // CAP handling ---------------------------------------------------
      joinDisplacementDir = isStartVertex ? right : left;
      joinDisplacementDir = PERPENDICULAR(joinDisplacementDir);

      ${V?m.H`capDisplacementDir = isStartVertex ? -right : left;`:""}
    }
  `),S.main.add(m.H`
    // Displacement (in pixels) caused by join/or cap
    vec2 dpos = joinDisplacementDir * sign(uv0.y) * displacementLen + capDisplacementDir * displacementLen;
    float lineDistNorm = sign(uv0.y) * pos.w;

    vLineDistance =  lineWidth * lineDistNorm;
    ${G?m.H`vLineDistanceNorm = lineDistNorm;`:""}

    pos.xy += dpos;
  `),H&&S.main.add(m.H`vec2 segmentDir = normalize(segment);
vSegmentSDF = (isJoin && isStartVertex) ? LARGE_HALF_FLOAT : (dot(pos.xy - segmentOrigin, segmentDir) * pos.w) ;
vReverseSegmentSDF = (isJoin && !isStartVertex) ? LARGE_HALF_FLOAT : (dot(pos.xy - segmentEnd, -segmentDir) * pos.w);`),P&&(O?S.uniforms.add(new v.m("worldToScreenRatio",((t,e)=>1/e.screenToPCSRatio))):S.main.add(m.H`vec3 segmentCenter = mix((nextPosition + position) * 0.5, (position + prevPosition) * 0.5, isEndVertex);
float worldToScreenRatio = computeWorldToScreenRatio(segmentCenter);`),S.main.add(m.H`float segmentLengthScreenDouble = length(segment);
float segmentLengthScreen = segmentLengthScreenDouble * 0.5;
float discreteWorldToScreenRatio = discretizeWorldToScreenRatio(worldToScreenRatio);
float segmentLengthRender = length(mix(nextPosition - position, position - prevPosition, isEndVertex));
vStipplePatternStretch = worldToScreenRatio / discreteWorldToScreenRatio;`),O?S.main.add(m.H`float segmentLengthPseudoScreen = segmentLengthScreen / pixelRatio * discreteWorldToScreenRatio / worldToScreenRatio;
float startPseudoScreen = uv0.x * discreteWorldToScreenRatio - mix(0.0, segmentLengthPseudoScreen, isEndVertex);`):S.main.add(m.H`float startPseudoScreen = mix(uv0.x, uv0.x - segmentLengthRender, isEndVertex) * discreteWorldToScreenRatio;
float segmentLengthPseudoScreen = segmentLengthRender * discreteWorldToScreenRatio;`),S.uniforms.add(new v.m("stipplePatternPixelSize",(t=>(0,a.h)(t)))),S.main.add(m.H`float patternLength = lineSize * stipplePatternPixelSize;
vStippleDistanceLimits = computeStippleDistanceLimits(startPseudoScreen, segmentLengthPseudoScreen, segmentLengthScreen, patternLength);
vStippleDistance = mix(vStippleDistanceLimits.x, vStippleDistanceLimits.y, isEndVertex);
if (segmentLengthScreenDouble >= 0.001) {
vec2 stippleDisplacement = pos.xy - segmentOrigin;
float stippleDisplacementFactor = dot(segment, stippleDisplacement) / (segmentLengthScreenDouble * segmentLengthScreenDouble);
vStippleDistance += (stippleDisplacementFactor - isEndVertex) * (vStippleDistanceLimits.y - vStippleDistanceLimits.x);
}
vStippleDistanceLimits *= pos.w;
vStippleDistance *= pos.w;
vStippleDistanceLimits = isJoin ?
vStippleDistanceLimits :
isStartVertex ?
vec2(-1e34, vStippleDistanceLimits.y) :
vec2(vStippleDistanceLimits.x, 1e34);`)),S.main.add(m.H`
      // Convert back into NDC
      pos.xy = (pos.xy / viewport.zw) * pos.w;

      vColor = getColor();
      vColor.a *= coverage;

      ${L&&!O?"pos.z -= 0.001 * pos.w;":""}

      // transform final position to camera space for slicing
      vpos = (inverseProjectionMatrix * pos).xyz;
      gl_Position = pos;
      forwardObjectAndLayerIdColor();
    }`),k&&e.include(c.Z,t),e.include(r.HQ,t),e.include(x.z,t),E.include(d.a),E.main.add(m.H`
    discardBySlice(vpos);
    ${k?"terrainDepthTest(depth);":""}
  `),L?E.main.add(m.H`vec4 finalColor = vec4(1.0, 0.0, 1.0, 1.0);`):(H&&E.main.add(m.H`
        float sdf = min(vSegmentSDF, vReverseSegmentSDF);
        vec2 fragmentPosition = vec2(
          min(sdf, 0.0),
          vLineDistance
        ) * gl_FragCoord.w;

        float fragmentRadius = length(fragmentPosition);
        float fragmentCapSDF = (fragmentRadius - vLineWidth) * 0.5; // Divide by 2 to transform from double pixel scale
        float capCoverage = clamp(0.5 - fragmentCapSDF, 0.0, 1.0);

        if (capCoverage < ${m.H.float(u.Q)}) {
          discard;
        }
      `),B?E.main.add(m.H`
      vec2 stipplePosition = vec2(
        min(getStippleSDF() * 2.0 - 1.0, 0.0),
        vLineDistanceNorm * gl_FragCoord.w
      );
      float stippleRadius = length(stipplePosition * vLineWidth);
      float stippleCapSDF = (stippleRadius - vLineWidth) * 0.5; // Divide by 2 to transform from double pixel scale
      float stippleCoverage = clamp(0.5 - stippleCapSDF, 0.0, 1.0);
      float stippleAlpha = step(${m.H.float(u.Q)}, stippleCoverage);
      `):E.main.add(m.H`float stippleAlpha = getStippleAlpha();`),R!==n.V.ObjectAndLayerIdColor&&E.main.add(m.H`discardByStippleAlpha(stippleAlpha, ${m.H.float(u.Q)});`),E.uniforms.add(new g.E("intrinsicColor",(t=>t.color))),E.main.add(m.H`vec4 color = intrinsicColor * vColor;`),z&&(E.uniforms.add(new g.E("innerColor",(t=>t.innerColor??t.color)),new v.m("innerWidth",((t,e)=>t.innerWidth*e.camera.pixelRatio))),E.main.add(m.H`float distToInner = abs(vLineDistance * gl_FragCoord.w) - innerWidth;
float innerAA = clamp(0.5 - distToInner, 0.0, 1.0);
float innerAlpha = innerColor.a + color.a * (1.0 - innerColor.a);
color = mix(color, vec4(innerColor.rgb, innerAlpha), innerAA);`)),E.main.add(m.H`vec4 finalColor = blendStipple(color, stippleAlpha);`),N&&(E.uniforms.add(new v.m("falloff",(t=>t.falloff))),E.main.add(m.H`finalColor.a *= pow(max(0.0, 1.0 - abs(vLineDistanceNorm * gl_FragCoord.w)), falloff);`)),P||E.main.add(m.H`float featherStartDistance = max(vLineWidth - 2.0, 0.0);
float value = abs(vLineDistance) * gl_FragCoord.w;
float feather = (value - featherStartDistance) / (vLineWidth - featherStartDistance);
finalColor.a *= 1.0 - clamp(feather, 0.0, 1.0);`)),E.main.add(m.H`outputColorHighlightOID(finalColor, vpos);`),e}const S=Object.freeze(Object.defineProperty({__proto__:null,build:M,ribbonlineNumRoundJoinSubdivisions:A},Symbol.toStringTag,{value:"Module"}))},60593:function(t,e,i){"use strict";i.d(e,{S:function(){return b},b:function(){return m}});var n=i(41546),r=i(88416),s=i(27264),o=i(13668),a=i(34178),h=i(77771),l=i(23864),c=i(20830),u=i(82598),d=i(38917),f=i(39506),p=i(62988),g=i(65839),v=i(25124);function m(t){const e=new p.N5,i=t.terrainDepthTest&&t.output===s.V.Color;e.include(a.d,t),e.include(r.L,t),e.include(o.HQ,t),e.include(v.z,t);const{vertex:n,fragment:m}=e;return m.include(l.a),(0,c.NB)(n,t),m.uniforms.add(new d.E("uColor",(t=>t.color))),e.attributes.add(g.r.POSITION,"vec3"),e.varyings.add("vWorldPosition","vec3"),i&&e.varyings.add("depth","float"),t.screenSizeEnabled&&e.attributes.add(g.r.OFFSET,"vec3"),t.shadingEnabled&&((0,c.S7)(n),e.attributes.add(g.r.NORMAL,"vec3"),e.varyings.add("vViewNormal","vec3"),m.uniforms.add(new u.t("shadingDirection",(t=>t.shadingDirection))),m.uniforms.add(new d.E("shadedColor",(t=>y(t.shadingTint,t.color))))),n.main.add(f.H`
      vWorldPosition = ${t.screenSizeEnabled?f.H`screenSizeScaling(offset, position)`:f.H`position`};
      ${t.shadingEnabled?f.H`vec3 worldNormal = normal;
                 vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`:""}
      ${i?f.H`depth = (view * vec4(vWorldPosition, 1.0)).z;`:""}
      gl_Position = transformPosition(proj, view, vWorldPosition);
  `),i&&e.include(h.Z,t),m.main.add(f.H`
      discardBySlice(vWorldPosition);
      ${i?f.H`terrainDepthTest(depth);`:""}
      ${t.shadingEnabled?f.H`vec3 viewNormalNorm = normalize(vViewNormal);
             float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
             vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`:f.H`vec4 finalColor = uColor;`}
      outputColorHighlightOID(finalColor, vWorldPosition);`),e}function y(t,e){const i=1-t[3],n=t[3]+e[3]*i;return 0===n?(_[3]=n,_):(_[0]=(t[0]*t[3]+e[0]*e[3]*i)/n,_[1]=(t[1]*t[3]+e[1]*e[3]*i)/n,_[2]=(t[2]*t[3]+e[2]*e[3]*i)/n,_[3]=e[3],_)}const _=(0,n.vt)(),b=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:"Module"}))},966:function(t,e,i){"use strict";i.d(e,{S:function(){return f},b:function(){return d}});var n=i(28721),r=i(74571),s=i(30262),o=i(14543),a=i(50295),h=i(39506),l=i(62988),c=i(39838),u=i(40434);function d(){const t=new l.N5;t.include(n.Q);const{fragment:e}=t;return e.uniforms.add(new c.N("blurInput",(t=>t.singleHighlightBlurTexture)),new s.t("blurSize",(t=>t.blurSize)),new c.N("highlightTexture",(t=>t.highlightTexture)),new c.N("highlightOptionsTexture",(t=>t.highlightOptionsTexture)),new a.c("highlightLevel",(t=>t.highlightLevel)),new o.m("occludedIntensityFactor",(t=>t.occludedFactor))),e.constants.add("inner","float",1-(u.o-u.b)/u.o),t.include(r.y),e.main.add(h.H`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));
vec2 uv = sUV;
vec2 center = texture(blurInput, uv).rg;
vec2 blurredHighlightValue = (vOutlinePossible == 0.0)
? center
: center * 0.204164
+ texture(blurInput, uv + blurSize * 1.407333).rg * 0.304005
+ texture(blurInput, uv - blurSize * 1.407333).rg * 0.304005
+ texture(blurInput, uv + blurSize * 3.294215).rg * 0.093913
+ texture(blurInput, uv - blurSize * 3.294215).rg * 0.093913;
float highlightIntensity = blurredHighlightValue.r;
float occlusionWeight = blurredHighlightValue.g;
if (highlightIntensity <= 0.01) {
discard;
}
vec4 fillColor    = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 0), 0);
vec4 outlineColor = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 1), 0);
vec2 centerTexel = texelFetch(highlightTexture, ivec2(uv * highlightTextureSize), 0).rg;
uint centerBits = readLevelBits(centerTexel, highlightLevel);
bool centerFilled = (centerBits & 1u) == 1u;
bool centerOccluded = (centerBits & 3u) == 3u;
bool occluded = centerOccluded || (0.5 * highlightIntensity < occlusionWeight);
float occlusionFactor = occluded ? occludedIntensityFactor : 1.0;
float outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, inner, highlightIntensity);
float fillFactor = centerFilled ? 1.0 : 0.0;
vec4 baseColor = mix(outlineColor, fillColor, fillFactor);
float intensity = baseColor.a * occlusionFactor * outlineFactor;
fragColor = vec4(baseColor.rgb, intensity);`),t}const f=Object.freeze(Object.defineProperty({__proto__:null,build:d},Symbol.toStringTag,{value:"Module"}))},2963:function(t,e,i){"use strict";i.d(e,{S:function(){return l},a:function(){return u},b:function(){return c}});var n=i(1932),r=i(28721),s=i(30262),o=i(39506),a=i(62988),h=i(40075);class l extends o.Y{constructor(){super(...arguments),this.blurSize=(0,n.vt)()}}function c(){const t=new a.N5;return t.include(r.Q),t.fragment.uniforms.add(new s.t("blurSize",(t=>t.blurSize)),new h.o("blurInput",(t=>t.blurInput))),t.outputs.add("fragSingleHighlight","vec2",0),t.fragment.main.add(o.H`vec2 highlightTextureSize = vec2(textureSize(blurInput,0));
vec2 uv = sUV;
vec2 center = texture(blurInput, uv).rg;
if (vOutlinePossible == 0.0) {
fragSingleHighlight = center;
} else {
vec2 sum = center * 0.204164;
sum += texture(blurInput, uv + blurSize * 1.407333).rg * 0.304005;
sum += texture(blurInput, uv - blurSize * 1.407333).rg * 0.304005;
sum += texture(blurInput, uv + blurSize * 3.294215).rg * 0.093913;
sum += texture(blurInput, uv - blurSize * 3.294215).rg * 0.093913;
fragSingleHighlight = sum;
}`),t}const u=Object.freeze(Object.defineProperty({__proto__:null,SingleHighlightBlurDrawParameters:l,build:c},Symbol.toStringTag,{value:"Module"}))},29829:function(t,e,i){"use strict";i.d(e,{S:function(){return c},b:function(){return l}});var n=i(20830),r=i(38917),s=i(14543),o=i(39506),a=i(62988),h=i(65839);function l(t){const e=new a.N5,{vertex:i,fragment:l,attributes:c,varyings:u}=e;return(0,n.NB)(i,t),c.add(h.r.POSITION,"vec3"),c.add(h.r.UV0,"vec2"),u.add("vUV","vec2"),i.main.add(o.H`vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);`),l.uniforms.add(new r.E("backgroundColor",(t=>t.backgroundColor)),new r.E("gridColor",(t=>t.gridColor)),new s.m("gridWidth",(t=>t.gridWidth))).main.add(o.H`const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;`),e}const c=Object.freeze(Object.defineProperty({__proto__:null,build:l},Symbol.toStringTag,{value:"Module"}))},55747:function(t,e,i){"use strict";i.d(e,{T:function(){return l},a:function(){return u},b:function(){return c}});var n=i(32501),r=i(77423),s=i(82598),o=i(39506),a=i(62988),h=i(39838);class l extends o.Y{constructor(){super(...arguments),this.color=(0,n.fA)(1,1,1)}}function c(){const t=new a.N5;return t.include(r.c),t.fragment.uniforms.add(new h.N("tex",(t=>t.texture)),new s.t("uColor",(t=>t.color))),t.fragment.main.add(o.H`vec4 texColor = texture(tex, uv);
fragColor = texColor * vec4(uColor, 1.0);`),t}const u=Object.freeze(Object.defineProperty({__proto__:null,TextureOnlyPassParameters:l,build:c},Symbol.toStringTag,{value:"Module"}))},32150:function(t,e,i){"use strict";i.d(e,{c:function(){return n},g:function(){return r}});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}},2075:function(t,e,i){"use strict";i.d(e,{a:function(){return y},b:function(){return $},c:function(){return _},f:function(){return b},g:function(){return T},h:function(){return R},u:function(){return w}}),i(58941);var n=i(40633),r=i(15774),s=i(89736),o=i(73364),a=i(39714),h=i(20551),l=i(32501),c=i(87416),u=i(72485),d=i(73313),f=i(5596),p=i(79578),g=i(29531),v=i(50973);const m=()=>n.A.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");function y(t=j){return{plane:(0,f.vt)(t.plane),origin:(0,l.o8)(t.origin),basis1:(0,l.o8)(t.basis1),basis2:(0,l.o8)(t.basis2)}}function _(t,e=y()){return b(t.origin,t.basis1,t.basis2,e)}function b(t,e,i,n=y()){return(0,h.c)(n.origin,t),(0,h.c)(n.basis1,e),(0,h.c)(n.basis2,i),w(n),function(t,e){Math.abs((0,h.f)(t.basis1,t.basis2)/((0,h.l)(t.basis1)*(0,h.l)(t.basis2)))>1e-6&&m().warn(e,"Provided basis vectors are not perpendicular"),Math.abs((0,h.f)(t.basis1,P(t)))>1e-6&&m().warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,h.f)(P(t),t.origin)-t.plane[3])>1e-6&&m().warn(e,"Plane offset is not consistent with plane origin")}(n,"fromValues()"),n}function w(t){(0,f.mR)(t.basis2,t.basis1,t.origin,t.plane)}function x(t,e,i){t!==i&&_(t,i);const n=(0,h.h)(v.rq.get(),P(t),e);return(0,h.g)(i.origin,i.origin,n),i.plane[3]-=e,i}function T(t,e=y()){const i=(t[2]-t[0])/2,n=(t[3]-t[1])/2;return(0,h.i)(e.origin,t[0]+i,t[1]+n,0),(0,h.i)(e.basis1,i,0,0),(0,h.i)(e.basis2,0,n,0),(0,f.fA)(0,0,1,0,e.plane),e}function A(t,e,i){return!!(0,f.Ui)(t.plane,e,i)&&N(t,i)}function M(t,e,i){const n=k.get();z(t,e,n,k.get());let s=Number.POSITIVE_INFINITY;for(const o of G){const a=L(t,o,F.get()),l=v.rq.get();if((0,f.T7)(n,a,l)){const t=(0,h.o)(v.rq.get(),e.origin,l),n=Math.abs((0,r.XM)((0,h.f)(e.direction,t)));n<s&&(s=n,(0,h.c)(i,l))}}return s===Number.POSITIVE_INFINITY?S(t,e,i):i}function S(t,e,i){if(A(t,e,i))return i;const n=k.get(),r=k.get();z(t,e,n,r);let s=Number.POSITIVE_INFINITY;for(const o of G){const a=L(t,o,F.get()),l=v.rq.get();if((0,f.gv)(n,a,l)){const t=(0,p.kb)(e,l);if(!(0,f.Tj)(r,l))continue;t<s&&(s=t,(0,h.c)(i,l))}}return O(t,e.origin)<s&&E(t,e.origin,i),i}function E(t,e,i){const n=(0,f._I)(t.plane,e,v.rq.get()),r=(0,d.H6)(D(t,t.basis1),n,-1,1,v.rq.get()),s=(0,d.H6)(D(t,t.basis2),n,-1,1,v.rq.get());return(0,h.d)(i,(0,h.g)(v.rq.get(),r,s),t.origin),i}function C(t,e,i){const{origin:n,basis1:r,basis2:s}=t,o=(0,h.d)(v.rq.get(),e,n),a=(0,g.gr)(r,o),l=(0,g.gr)(s,o),c=(0,g.gr)(P(t),o);return(0,h.i)(i,a,l,c)}function O(t,e){const i=C(t,e,v.rq.get()),{basis1:n,basis2:r}=t,s=(0,h.l)(n),o=(0,h.l)(r),a=Math.max(Math.abs(i[0])-s,0),l=Math.max(Math.abs(i[1])-o,0),c=i[2];return a*a+l*l+c*c}function R(t,e){return Math.sqrt(O(t,e))}function I(t,e){const i=-t.plane[3];return(0,g.gr)(P(t),e)-i}function P(t){return(0,f.Qj)(t.plane)}function N(t,e){const i=(0,h.d)(v.rq.get(),e,t.origin),n=(0,h.k)(t.basis1),r=(0,h.k)(t.basis2),s=(0,h.f)(t.basis1,i),o=(0,h.f)(t.basis2,i);return-s-n<0&&s-n<0&&-o-r<0&&o-r<0}function D(t,e){const i=F.get();return(0,h.c)(i.origin,t.origin),(0,h.c)(i.vector,e),i}function L(t,e,i){const{basis1:n,basis2:r,origin:s}=t,o=(0,h.h)(v.rq.get(),n,e.origin[0]),a=(0,h.h)(v.rq.get(),r,e.origin[1]);(0,h.g)(i.origin,o,a),(0,h.g)(i.origin,i.origin,s);const l=(0,h.h)(v.rq.get(),n,e.direction[0]),c=(0,h.h)(v.rq.get(),r,e.direction[1]);return(0,h.h)(i.vector,(0,h.g)(l,l,c),2),i}function z(t,e,i,n){const r=P(t);(0,f.mR)(r,e.direction,e.origin,i),(0,f.mR)((0,f.Qj)(i),r,e.origin,n)}const j={plane:(0,f.vt)(),origin:(0,l.fA)(0,0,0),basis1:(0,l.fA)(1,0,0),basis2:(0,l.fA)(0,1,0)},k=new s.I(f.vt),F=new s.I(d.vt),H=(0,l.vt)(),B=new s.I((()=>y())),G=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],V=(0,a.vt)(),U=(0,a.vt)(),$=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:class{constructor(){this.plane=(0,f.vt)(),this.origin=(0,l.vt)(),this.basis1=(0,l.vt)(),this.basis2=(0,l.vt)()}},altitudeAt:I,axisAt:function(t,e,i,n){return function(t,e,i){switch(e){case u._.X:(0,h.c)(i,t.basis1),(0,h.n)(i,i);break;case u._.Y:(0,h.c)(i,t.basis2),(0,h.n)(i,i);break;case u._.Z:(0,h.c)(i,P(t))}return i}(t,i,n)},cameraFrustumCoverage:function(t,e){return(e-t)/e},closestPoint:S,closestPointOnSilhouette:M,copy:_,copyWithoutVerify:function(t,e){(0,h.c)(e.origin,t.origin),(0,h.c)(e.basis1,t.basis1),(0,h.c)(e.basis2,t.basis2),(0,f.C)(e.plane,t.plane)},create:y,distance:R,distance2:O,distanceToSilhouette:function(t,e){let i=Number.NEGATIVE_INFINITY;for(const n of G){const r=L(t,n,F.get()),s=(0,d.kb)(r,e);s>i&&(i=s)}return Math.sqrt(i)},elevate:x,equals:function(t,e){return(0,h.p)(t.basis1,e.basis1)&&(0,h.p)(t.basis2,e.basis2)&&(0,h.p)(t.origin,e.origin)},extrusionContainsPoint:function(t,e){return(0,f.Tj)(t.plane,e)&&N(t,e)},fromAABoundingRect:T,fromValues:b,getExtent:function(t,e){const i=t.basis1[0],n=t.basis2[1],[r,s]=t.origin;return(0,c.fA)(r-i,s-n,r+i,s+n,e)},intersectRay:A,intersectRayClosestSilhouette:function(t,e,i){if(A(t,e,i))return i;const n=M(t,e,v.rq.get());return(0,h.g)(i,e.origin,(0,h.h)(v.rq.get(),e.direction,(0,h.j)(e.origin,n)/(0,h.l)(e.direction))),i},normal:P,projectPoint:E,projectPointLocal:C,rotate:function(t,e,i,n){return t!==n&&_(t,n),(0,o.$0)(U,e,i),(0,h.t)(n.basis1,t.basis1,U),(0,h.t)(n.basis2,t.basis2,U),w(n),n},setAltitudeAt:function(t,e,i,n){const r=I(t,e),s=(0,h.h)(H,P(t),i-r);return(0,h.g)(n,e,s),n},setExtent:function(t,e,i){return T(e,i),x(i,I(t,t.origin),i),i},transform:function(t,e,i){return t!==i&&_(t,i),(0,o.B8)(V,e),(0,o.mg)(V,V),(0,h.t)(i.basis1,t.basis1,V),(0,h.t)(i.basis2,t.basis2,V),(0,h.t)((0,f.Qj)(i.plane),(0,f.Qj)(t.plane),V),(0,h.t)(i.origin,t.origin,e),(0,f.mP)(i.plane,i.plane,i.origin),i},up:j,updateUnboundedPlane:w,wrap:function(t,e,i){const n=B.get();return n.origin=t,n.basis1=e,n.basis2=i,n.plane=(0,f.LV)(0,0,0,0),w(n),n}},Symbol.toStringTag,{value:"Module"}))},59122:function(t,e,i){"use strict";function n(t,e,i){i=i||2;var n,s,a,h,l,c,d,f=e&&e.length,p=f?e[0]*i:t.length,g=r(t,0,p,i,!0),v=[];if(!g||g.next===g.prev)return v;if(f&&(g=u(t,e,g,i)),t.length>80*i){n=a=t[0],s=h=t[1];for(var m=i;m<p;m+=i)(l=t[m])<n&&(n=l),(c=t[m+1])<s&&(s=c),l>a&&(a=l),c>h&&(h=c);d=0!==(d=Math.max(a-n,h-s))?1/d:0}return o(g,v,i,n,s,d),v}function r(t,e,i,n,r){var s,o;if(r===I(t,e,i,n)>0)for(s=e;s<i;s+=n)o=C(s,t[s],t[s+1],o);else for(s=i-n;s>=e;s-=n)o=C(s,t[s],t[s+1],o);if(o&&x(o,o.next)){var a=o.next;O(o),o=a}return o}function s(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!x(n,n.next)&&0!==w(n.prev,n,n.next))n=n.next;else{var r=n.prev;if(O(n),(n=e=r)===n.next)break;i=!0}}while(i||n!==e);return e}function o(t,e,i,n,r,u,d){if(t){!d&&u&&v(t,n,r,u);for(var f,p,g=t;t.prev!==t.next;)if(f=t.prev,p=t.next,u?h(t,n,r,u):a(t))e.push(f.i/i),e.push(t.i/i),e.push(p.i/i),O(t),t=p.next,g=p.next;else if((t=p)===g){d?1===d?o(t=l(s(t),e,i),e,i,n,r,u,2):2===d&&c(t,e,i,n,r,u):o(s(t),e,i,n,r,u,1);break}}}function a(t){var e=t.prev,i=t,n=t.next;if(w(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(_(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&w(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function h(t,e,i,n){var r=t.prev,s=t,o=t.next;if(w(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,h=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,l=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,u=m(a,h,e,i,n),d=m(l,c,e,i,n),f=t.prevZ,p=t.nextZ;f&&f.z>=u&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=u;){if(f!==t.prev&&f!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function l(t,e,i){var n=t;do{var r=n.prev,o=n.next.next;!x(r,o)&&T(r,n,n.next,o)&&S(r,o)&&S(o,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(o.i/i),O(n),O(n.next),n=t=o),n=n.next}while(n!==t);return s(n)}function c(t,e,i,n,r,a){var h=t;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&b(h,l)){var c=E(h,l);return h=s(h,h.next),c=s(c,c.next),o(h,e,i,n,r,a),void o(c,e,i,n,r,a)}l=l.next}h=h.next}while(h!==t)}function u(t,e,i,n){var o,a,h,l=[];for(o=0,a=e.length;o<a;o++)(h=r(t,e[o]*n,o<a-1?e[o+1]*n:t.length,n,!1))===h.next&&(h.steiner=!0),l.push(y(h));for(l.sort(d),o=0;o<l.length;o++)i=s(i=p(l[o],i),i.next);return i}function d(t,e){return t.x-e.x}function f(t){if(t.next.prev===t)return t;let e=t;for(;;){const i=e.next;if(i.prev===e||i===e||i===t)break;e=i}return e}function p(t,e){var i=function(t,e){var i,n=e,r=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o){if(o=a,a===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===o)return i;var h,l=i,c=i.x,u=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=c&&r!==n.x&&_(s<u?r:o,s,c,u,s<u?o:r,s,n.x,n.y)&&(h=Math.abs(s-n.y)/(r-n.x),S(n,t)&&(h<d||h===d&&(n.x>i.x||n.x===i.x&&g(i,n)))&&(i=n,d=h)),n=n.next}while(n!==l);return i}(t,e);if(!i)return e;var n=E(i,t),r=s(i,i.next);let o=f(n);return s(o,o.next),r=f(r),f(e===i?r:e)}function g(t,e){return w(t.prev,t,e.prev)<0&&w(e.next,t,t.next)<0}function v(t,e,i,n){var r=t;do{null===r.z&&(r.z=m(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,s,o,a,h,l=1;do{for(i=t,t=null,s=null,o=0;i;){for(o++,n=i,a=0,e=0;e<l&&(a++,n=n.nextZ);e++);for(h=l;a>0||h>0&&n;)0!==a&&(0===h||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,h--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=n}s.nextZ=null,l*=2}while(o>1)}(r)}function m(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function y(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function _(t,e,i,n,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(n-a)-(i-o)*(e-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function b(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&T(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(S(t,e)&&S(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)&&(w(t.prev,t,e.prev)||w(t,e.prev,e))||x(t,e)&&w(t.prev,t,t.next)>0&&w(e.prev,e,e.next)>0)}function w(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function x(t,e){return t.x===e.x&&t.y===e.y}function T(t,e,i,n){var r=M(w(t,e,i)),s=M(w(t,e,n)),o=M(w(i,n,t)),a=M(w(i,n,e));return r!==s&&o!==a||!(0!==r||!A(t,i,e))||!(0!==s||!A(t,n,e))||!(0!==o||!A(i,t,n))||!(0!==a||!A(i,e,n))}function A(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function M(t){return t>0?1:t<0?-1:0}function S(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function E(t,e){var i=new R(t.i,t.x,t.y),n=new R(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function C(t,e,i,n){var r=new R(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function O(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function R(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,i,n){for(var r=0,s=e,o=i-n;s<i;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}i.d(e,{e:function(){return n}}),n.deviation=function(t,e,i,n){var r=e&&e.length,s=r?e[0]*i:t.length,o=Math.abs(I(t,0,s,i));if(r)for(var a=0,h=e.length;a<h;a++){var l=e[a]*i,c=a<h-1?e[a+1]*i:t.length;o-=Math.abs(I(t,l,c,i))}var u=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,f=n[a+1]*i,p=n[a+2]*i;u+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},n.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)i.vertices.push(t[r][s][o]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}},56901:function(t,e,i){"use strict";i.r(e),i.d(e,{G:function(){return a},g:function(){return h}});var n,r=i(32150),s={exports:{}},o=(n||(n=1,function(t){var e=function(){function t(t){if("number"==typeof t)return X.Tc.Zg(t);if(null==t)return null;if(null!=st[t])return X.Tc.Zg(st[t]);throw Error("Unrecognised Unit Type")}function e(t){if("number"==typeof t)return X.Tc.Zg(t);if(null==t)return null;if(null!=ot[t])return X.Tc.Zg(ot[t]);throw Error("Unrecognised Unit Type")}function i(t){if(t)switch(t){case"loxodrome":return 1;case"great-elliptic":return 2;case"normal-section":return 3;case"shape-preserving":return 4}return 0}function n(t,e,i,n){if(null==i||i.B())return null;switch(i.getType()){case X.qn.Point:return t.exportPoint(e,i,n);case X.qn.Polygon:return t.exportPolygon(e,i,n);case X.qn.Polyline:return t.exportPolyline(e,i,n);case X.qn.MultiPoint:return t.exportMultipoint(e,i,n);case X.qn.Envelope:return t.exportExtent(e,i,n)}return null}function r(t,e,i,n){if(i.getType()!==X.qn.Point)throw Error("Geometry not Point");return t.exportPoint(e,i,n)}function s(t,e,i){return t.convertToGEGeometry(e,i)}function o(t){var e=t.wkid;t=t.wkt2||t.wkt;var i=at.get(e||t);return null==i&&(-1!==e&&null!=e?(i=X.Eg.create(e),at.set(e,i)):t&&(i=X.Eg.qP(t),at.set(t,i)),lt.has(e||t)&&i.VW(lt.get(e||t))),i}function a(t){var e,i,n;if(null==t)return null;var r=o(t);return t=r.Hd(),r=r.Kn(),(e={}).tolerance=r,e.unitType=null==t?-1:t.od,e.unitID=null==t?-1:t.Ec(),e.unitBaseFactor=null==t?0:t.ai,e.unitSquareDerivative=null==t?0:null!==(n=null===(i=X.Tc.aG(t))||void 0===i?void 0:i.Ec())&&void 0!==n?n:0,e}function h(t,e,i,r){return null==i?null:(i=X.$b.clip(s(t,ht,i),s(t,ht,r),o(e)),n(t,ht,i,e))}function l(t,e,i,r){i=X.$b.dl(s(t,ht,i),s(t,ht,r),o(e)),r=[];for(var a=0;a<i.length;a++)r.push(n(t,ht,i[a],e));return r}function c(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.contains(s(t,ht,i),s(t,ht,n),o(e))}function u(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.BP(s(t,ht,i),s(t,ht,n),o(e))}function d(e,i,n,r,a){if(null==n||null==r)throw Error("Illegal Argument Exception");return X.$b.tb(s(e,ht,n),s(e,ht,r),o(i),t(a))}function f(t,e,i,n){return!(null==i&&null!=n||null==n&&null!=i)&&X.$b.Nb(s(t,ht,i),s(t,ht,n),o(e))}function p(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.TS(s(t,ht,i),s(t,ht,n),o(e))}function g(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.touches(s(t,ht,i),s(t,ht,n),o(e))}function v(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.qY(s(t,ht,i),s(t,ht,n),o(e))}function m(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.TP(s(t,ht,i),s(t,ht,n),o(e))}function y(t,e,i,n){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.DU(s(t,ht,i),s(t,ht,n),o(e))}function _(t,e,i,n,r){if(null==i||null==n)throw Error("Illegal Argument Exception");return X.$b.yB(s(t,ht,i),s(t,ht,n),o(e),r)}function b(t,e,i){if(null==i)throw Error("Illegal Argument Exception");return X.$b.dT(s(t,ht,i),o(e))}function w(t,e,i){if(null==i)throw Error("Illegal Argument Exception");return i=X.$b.eC(s(t,ht,i),o(e)),n(t,ht,i,e)}function x(t,e,i,r){if(void 0===r&&(r=!1),null==i)throw Error("Illegal Argument Exception");if(Array.isArray(i)){var a=r,h=[];for(r=0;r<i.length;r++)h.push(s(t,ht,i[r]));for(i=X.$b.jP(h,a),a=Array(i.length),r=0;r<i.length;r++)a[r]=n(t,ht,i[r],e);return a}return r=X.$b.iP(s(t,ht,i),o(e)),n(t,ht,r,e)}function T(t,e,i,r){if(null==i||null==r)throw Error("Illegal Argument Exception");if(Array.isArray(i)){for(var a=[],h=0;h<i.length;h++)a.push(s(t,ht,i[h]));for(i=X.$b.QP(a,s(t,ht,r),o(e)),r=Array(i.length),h=0;h<i.length;h++)r[h]=n(t,ht,i[h],e);return r}return h=X.$b.im(s(t,ht,i),s(t,ht,r),o(e)),n(t,ht,h,e)}function A(t,e,i,r){if(null==i||null==r)throw Error("Illegal Argument Exception");if(Array.isArray(i)){for(var a=[],h=0;h<i.length;h++)a.push(s(t,ht,i[h]));for(i=X.$b.VX(a,s(t,ht,r),o(e)),r=Array(i.length),h=0;h<i.length;h++)r[h]=n(t,ht,i[h],e);return r}return h=X.$b.ep(s(t,ht,i),s(t,ht,r),o(e)),n(t,ht,h,e)}function M(t,e,i,r){if(null==i||null==r)throw Error("Illegal Argument Exception");if(Array.isArray(i)){for(var a=[],h=0;h<i.length;h++)a.push(s(t,ht,i[h]));for(i=X.$b.RS(a,s(t,ht,r),o(e)),r=Array(i.length),h=0;h<i.length;h++)r[h]=n(t,ht,i[h],e);return r}return h=X.$b.Ea(s(t,ht,i),s(t,ht,r),o(e)),n(t,ht,h,e)}function S(t,e,i,r){if(null==i)return null;var a=[];if(Array.isArray(i)){if(0===i.length)return null;for(r=0;r<i.length;r++)a.push(s(t,ht,i[r]))}else a.push(s(t,ht,i)),null!=r&&a.push(s(t,ht,r));return n(t,ht,X.$b.jY(a,o(e)),e)}function E(e,i,r,a,h,l,c,u){var d=0;if(null!=l)switch(l){case"round":d=0;break;case"bevel":d=1;break;case"miter":d=2;break;case"square":d=3}if(Array.isArray(r)){if(null==r)e=null;else if(0===r.length)e=[];else{var f=[];for(l=0;l<r.length;l++)f.push(s(e,ht,r[l]));for(r=X.$b.BU(f,o(i),a,d,c,u,t(h)),a=Array(r.length),l=0;l<r.length;l++)a[l]=n(e,ht,r[l],i);e=a}return e}return r=X.$b.offset(s(e,ht,r),o(i),a,d,c,u,t(h)),n(e,ht,r,i)}function C(e,i,r,a,h,l){if(void 0===l&&(l=!1),Array.isArray(r)){if(!Array.isArray(a)){for(var c=[],u=0;u<r.length;u++)c.push(a);a=c}if(a.length!=r.length){if(0==a.length)throw Error("Illegal Argument Exception");c=[];var d=0;for(u=0;u<r.length;u++)void 0===a[u]?c.push(d):(c.push(a[u]),d=a[u]);a=c}return R(e,i,r,a,h,!1,l,"geodesic",NaN)}return r=X.$b.buffer(s(e,ht,r),o(i),a,t(h),!1,0,NaN),n(e,ht,r,i)}function O(e,r,a,h,l,c,u,d){if(Array.isArray(a)){if(!Array.isArray(h)){for(var f=[],p=0;p<a.length;p++)f.push(h);h=f}if(h.length!==a.length){if(0===h.length)throw Error("Illegal Argument Exception");f=[];var g=0;for(p=0;p<a.length;p++)void 0===h[p]?f.push(g):(f.push(h[p]),g=h[p]);h=f}return R(e,r,a,h,l,!0,c,u,d)}return void 0===u&&(u=NaN),a=X.$b.buffer(s(e,ht,a),o(r),h,t(l),!0,i(c),u),n(e,ht,a,r)}function R(e,r,a,h,l,c,u,d,f){if(void 0===f&&(f=NaN),null==a)return null;if(0===a.length)return[];for(var p=[],g=0;g<a.length;g++)p.push(s(e,ht,a[g]));for(a=X.$b.MN(p,o(r),h,t(l),c,u,i(d),f),h=Array(a.length),g=0;g<a.length;g++)h[g]=n(e,ht,a[g],r);return h}function I(t,e,i,n,o){var a;return void 0===o&&(o=!0),i=X.$b.nz(s(t,ht,i),s(t,ht,n),o),(a={}).coordinate=r(t,ht,i.fz(),e),a.distance=i.hz(),a.isRightSide=i.Sz(),a.vertexIndex=i.Ua(),a.isEmpty=i.B(),a}function P(t,e,i,n){var o;return i=X.$b.oz(s(t,ht,i),s(t,ht,n)),(o={}).coordinate=r(t,ht,i.fz(),e),o.distance=i.hz(),o.isRightSide=i.Sz(),o.vertexIndex=i.Ua(),o.isEmpty=i.B(),o}function N(t,e,i,n,o,a){var h;for(i=X.$b.pz(s(t,ht,i),s(t,ht,n),o,a),n=[],o=0;o<i.length;o++)!1===i[o].B()&&n.push(((h={}).coordinate=r(t,ht,i[o].fz(),e),h.distance=i[o].hz(),h.isRightSide=i[o].Sz(),h.vertexIndex=i[o].Ua(),h.isEmpty=i[o].B(),h));return n}function D(e,i,r,a,h,l){return r=X.$b.QQ(s(e,ht,r),o(i),a,h,t(l)),n(e,ht,r,i)}function L(e,i,r,a,h){return r=X.$b.Qr(s(e,ht,r),o(i),a,t(h)),n(e,ht,r,i)}function z(e,i,r,a,h,l){return void 0===l&&(l=0),r=X.$b.Wy(s(e,ht,r),o(i),a,t(h),l),n(e,ht,r,i)}function j(t,i,n,r){if(null==n)throw Error("Illegal Argument Exception");return X.$b.JU(s(t,ht,n),o(i),e(r))}function k(e,i,n,r){if(null==n)throw Error("Illegal Argument Exception");return X.$b.KU(s(e,ht,n),o(i),t(r))}function F(t,n,r,a,h){if(null==r)throw Error("Illegal Argument Exception");return X.$b.WQ(s(t,ht,r),o(n),e(a),i(h))}function H(e,n,r,a,h){if(null==r)throw Error("Illegal Argument Exception");return X.$b.ZQ(s(e,ht,r),o(n),t(a),i(h))}function B(t){X.NL.bind(t)}function G(t,e,i,n,r){var a=null,h=null;if(n){if(!r)throw X.i.N("AOI missing Spatial Reference");a=s(t,ht,n),h=o(r).fh()}return null!==(t=X.gu.XR(o(e).fh(),o(i).fh(),a,h))?t:null}function V(t,e,i,n,r){var a=null,h=null;if(n){if(!r)throw X.i.N("AOI missing Spatial Reference");a=s(t,ht,n),h=o(r).fh()}return X.gu.YR(o(e).fh(),o(i).fh(),a,h)}function U(t,e,i,n,r,s){if(void 0===r&&(r=null),void 0===s&&(s=null),s){var a=new X.yC;a.Vu=s.densificationStep,a.Jr=s.centralMeridianOfOutputGCS,s.clipWithInputHorizon&&a.PW(s.clipWithInputHorizon),s.clipWithOutputHorizon&&a.QW(s.clipWithOutputHorizon)}if(!1===this.KY)throw Error("Projection Engine must be enabled using enableProjection");if(0===e.length)return[];if(r){if(!(s=r.getCachedGeTransformation(i,n)))t:{if(s=r,r=null,s){var h=s.getGTListEntry();if(null!==h){r=new X.wC(null);for(var l=0,c=h.steps;l<c.length;l++){h=c[l];var u=new X.Dx(h.geogtran);h.isInverse&&u.Qz(),r.add(u)}a=X.vr.Nr(o(i).fh(),o(n).fh(),r,a),s.assignCachedGe(i,n,a),s=a;break t}}if(null===r&&s&&s.steps&&0<s.steps.length){for(r=new X.wC(null),l=0,c=s.steps;l<c.length;l++)-1!=(h=c[l]).wkid&&null!=h.wkid?r.add(X.Dx.create(h.wkid,h.isInverse)):r.add(X.Dx.uP(h.wkt,h.isInverse));a=X.vr.Nr(o(i).fh(),o(n).fh(),r,a),s.assignCachedGe(i,n,a),s=a}else s=X.vr.Nr(o(i).fh(),o(n).fh(),r,a)}for(i=[],r=0;r<e.length;r++)a=e[r],i.push($(t,a,n,s))}else for(s=X.vr.Nr(o(i).fh(),o(n).fh(),null),i=[],r=0;r<e.length;r++)a=e[r],i.push($(t,a,n,s));return i}function $(t,e,i,r){return e=X.$b.zh(s(t,ht,e),r),n(t,ht,e,i)}function W(t,e){null!=t&&(t=t.wkid||t.wkt2||t.wkt,lt.has(t),lt.set(t,e),at.has(t)&&at.delete(t))}function q(t){null!=t&&(t=t.wkid||t.wkt2||t.wkt,lt.has(t)&&(lt.delete(t),at.has(t)&&at.delete(t)))}function Z(t,e,i,r){if(null==i||null==r)return[];var a=[],h=0;for(i=X.$b.QS(s(t,ht,i),s(t,ht,r),o(e))||[];h<i.length;h++)a.push(n(t,ht,i[h],e));return a}var Y,X,K,J,Q=this&&this.__extends||function(){function t(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)}return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){var e;(e=t.qn||(t.qn={}))[e.Unknown=0]="Unknown",e[e.Point=33]="Point",e[e.Line=322]="Line",e[e.Envelope=197]="Envelope",e[e.MultiPoint=550]="MultiPoint",e[e.Polyline=1607]="Polyline",e[e.Polygon=1736]="Polygon",function(t){t[t.enumMild=0]="enumMild",t[t.enumMedium=1]="enumMedium",t[t.enumHot=2]="enumHot"}(t.YK||(t.YK={}));var i=function(){function e(){this.description=null,this.VA=0}return e.prototype.getType=function(){return 0},e.prototype.Db=function(){return-1},e.prototype.Nf=function(t){this.vc(),t!=this.description&&this.sn(t)},e.prototype.sn=function(){},e.prototype.Jl=function(e){this.vc(),e!=this.description&&(e=t.ee.CR(this.description,e))!=this.description&&this.sn(e)},e.prototype.hasAttribute=function(t){return this.description.hasAttribute(t)},e.prototype.re=function(e){this.vc(),this.description.hasAttribute(e)||(e=t.ee.BR(this.description,e),this.sn(e))},e.prototype.Tg=function(){return null},e.prototype.bn=function(){},e.prototype.A=function(){},e.prototype.Qo=function(){},e.prototype.xc=function(t){this.A(t)},e.prototype.B=function(){return!0},e.prototype.Oa=function(){},e.prototype.Oc=function(){},e.prototype.Ia=function(){return null},e.prototype.copyTo=function(){},e.prototype.Ke=function(){return 0},e.prototype.Qb=function(){return 0},e.prototype.iG=function(){return this.hasAttribute(1)},e.tf=function(t){return 1+((192&t)>>6)>>1},e.Rn=function(t){return!!(32&t)},e.US=function(t){return!!(128&t)},e.yd=function(t){return!!(256&t)},e.xj=function(t){return!!(512&t)},e.Hc=function(t){return!!(1024&t)},e.prototype.Of=function(){var t=this.Ia();return this.copyTo(t),t},e.prototype.mg=function(){return null},e.jg=function(t){var e=t.Ia();return t.copyTo(e),e},e.prototype.vc=function(){0<=this.VA&&(this.VA+=2147483649)},e.Ax=function(i){var n=i.getType();if(e.xj(n))return i.I();if(i.B())return 0;if(197==n)return 4;if(33==n)return 1;if(e.yd(n))return 2;throw t.i.fa("missing type")},e}();t.aa=i}(X||(X={})),K=X||(X={}),J=function(){function t(){this.y=this.x=0}return t.construct=function(e,i){var n=new t;return n.x=e,n.y=i,n},t.al=function(e){var i=new t;return i.x=e.x,i.y=e.y,i},t.prototype.ma=function(t,e){this.x=t,this.y=e},t.prototype.L=function(t){this.x=t.x,this.y=t.y},t.prototype.fq=function(t,e){return this.x===t&&this.y===e},t.prototype.Rz=function(t){return 2220446049250313e-31>=Math.abs(this.x-t.x)&&2220446049250313e-31>=Math.abs(this.y-t.y)},t.prototype.qb=function(t){return this.x===t.x&&this.y===t.y},t.prototype.Nb=function(e){return e==this||e instanceof t&&this.x==e.x&&this.y==e.y},t.prototype.sub=function(t){this.x-=t.x,this.y-=t.y},t.prototype.uc=function(t,e){this.x=t.x-e.x,this.y=t.y-e.y},t.prototype.add=function(t,e){void 0!==e?(this.x=t.x+e.x,this.y=t.y+e.y):(this.x+=t.x,this.y+=t.y)},t.prototype.Sq=function(){this.x=-this.x,this.y=-this.y},t.prototype.mt=function(t){this.x=-t.x,this.y=-t.y},t.prototype.NS=function(t,e,i){this.x=t.x*(1-i)+e.x*i,this.y=t.y*(1-i)+e.y*i},t.prototype.Ct=function(t,e){this.x=this.x*t+e.x,this.y=this.y*t+e.y},t.prototype.HW=function(t,e,i){this.x=e.x*t+i.x,this.y=e.y*t+i.y},t.prototype.scale=function(t){this.x*=t,this.y*=t},t.prototype.compare=function(t){return this.y<t.y?-1:this.y>t.y?1:this.x<t.x?-1:this.x>t.x?1:0},t.prototype.normalize=function(){var t=this.length();0==t&&(this.x=1,this.y=0),this.x/=t,this.y/=t},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.Sk=function(){return this.x*this.x+this.y*this.y},t.tb=function(t,e){return Math.sqrt(this.yc(t,e))},t.Oy=function(t,e,i,n){return t-=i,e-=n,Math.sqrt(t*t+e*e)},t.prototype.Qh=function(t){return this.x*t.x+this.y*t.y},t.prototype.fD=function(t){return Math.abs(this.x*t.x)+Math.abs(this.y*t.y)},t.prototype.wi=function(t){return this.x*t.y-this.y*t.x},t.prototype.Bt=function(t,e){var i=-this.x*e+this.y*t;this.x=this.x*t+this.y*e,this.y=i},t.prototype.Hv=function(){var t=this.x;this.x=-this.y,this.y=t},t.prototype.MG=function(t){this.x=-t.y,this.y=t.x},t.prototype.ar=function(){var t=this.x;this.x=this.y,this.y=-t},t.prototype.qu=function(){return 0<this.x?0<=this.y?1:4:0<this.y?2:0==this.x?4:3},t.nu=function(t,e){var i=t.qu(),n=e.qu();return n==i?0>(t=t.wi(e))?1:0<t?-1:0:i<n?-1:1},t.yc=function(t,e){var i=t.x-e.x;return i*i+(t=t.y-e.y)*t},t.prototype.toString=function(){return"("+this.x+" , "+this.y+")"},t.prototype.Rc=function(){this.y=this.x=NaN},t.prototype.isNaN=function(){return isNaN(this.x)||isNaN(this.y)},t.prototype.offset=function(e,i){var n=t.tb(e,i),r=t.construct(this.x,this.y);if(0==n)return t.tb(r,e);var s=new t;return s.L(i),s.sub(e),r.sub(e),r.wi(s)/n},t.Uq=function(t,e,i){var n=new K.Wb;n.set(e.x),n.sub(t.x);var r=new K.Wb;r.set(i.y),r.sub(t.y);var s=new K.Wb;s.set(e.y),s.sub(t.y);var o=new K.Wb;return o.set(i.x),o.sub(t.x),n.Ag(r),s.Ag(o),n.sub(s),n.ps()?(n=new K.hp(e.x),r=new K.hp(t.x),s=new K.hp(t.y),n=n.jt(r),t=(t=new K.hp(i.y)).jt(s),e=(e=new K.hp(e.y)).jt(s),i=(i=new K.hp(i.x)).jt(r),n=n.lr(t),e=e.lr(i),(n=n.lr(e)).nT()?-1:n.fS()?1:0):0>(i=n.value())?-1:0<i?1:0},t.prototype.cc=function(){return K.O.uj(K.O.uj())},t}(),K.h=J,function(t){var e=function(){function t(t){this.Fy=this.Mt=0,this.OX=t}return t.prototype.reset=function(){this.Fy=this.Mt=0},t.prototype.add=function(t){t-=this.Fy;var e=this.Mt+t;this.Fy=e-this.Mt-t,this.Mt=e},t.prototype.sub=function(t){this.add(-t)},t.prototype.rm=function(){return this.OX+this.Mt},t}();t.Fx=e,t.lc=function(){function t(){}return t.Cn=function(t,e){return 0<=e?Math.abs(t):-Math.abs(t)},t.sign=function(t){return 0>t?-1:0<t?1:0},t.RK=function(t){return t-360*Math.floor(t/360)},t.round=function(t){return Math.floor(t+.5)},t.ox=function(t){return t*t},t.hq=function(t,e,i){return.5>=i?t+(e-t)*i:e-(e-t)*(1-i)},t.OG=function(t,e,i,n){.5>=i?(n.x=t.x+(e.x-t.x)*i,n.y=t.y+(e.y-t.y)*i):(n.x=e.x-(e.x-t.x)*(1-i),n.y=e.y-(e.y-t.y)*(1-i))},t.lT=function(t,e,i,n,r,s){.5>=r?(s.x=t+(i-t)*r,s.y=e+(n-e)*r):(s.x=i-(i-t)*(1-r),s.y=n-(n-e)*(1-r))},t}()}(X||(X={})),function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.sa=0,t.na=0,t.pa=0,t.la=0,t.ka=null,t}return Q(i,e),i.prototype.ac=function(){return t.h.construct(this.sa,this.na)},i.prototype.Yp=function(t){t.x=this.sa,t.y=this.na},i.prototype.Dc=function(t){this.em(0,t)},i.prototype.ZB=function(e,i){this.em(0,t.h.construct(e,i))},i.prototype.To=function(t){this.hD(0,t)},i.prototype.setStart=function(t){this.uD(0,t)},i.prototype.wv=function(t,e){return this.Od(0,t,e)},i.prototype.YB=function(t,e,i){this.tn(0,t,e,i)},i.prototype.wc=function(){return t.h.construct(this.pa,this.la)},i.prototype.Tr=function(t){t.x=this.pa,t.y=this.la},i.prototype.Qc=function(t){this.em(1,t)},i.prototype.Ql=function(e,i){this.em(1,t.h.construct(e,i))},i.prototype.Po=function(t){this.hD(1,t)},i.prototype.setEnd=function(t){this.uD(1,t)},i.prototype.gv=function(t,e){return this.Od(1,t,e)},i.prototype.OB=function(t,e,i){this.tn(1,t,e,i)},i.prototype.Db=function(){return 1},i.prototype.B=function(){return this.Ac()},i.prototype.Oa=function(){},i.prototype.Ke=function(){return 0},i.prototype.Ea=function(t,e,i,n,r){return this.KM(t,e,i,n,r)},i.prototype.isIntersecting=function(t,e){return 0!=this.zr(t,e,!1)},i.prototype.qs=function(t,e){return this.ru(t,e,!1)},i.prototype.ru=function(){return null},i.prototype.Ac=function(){return!1},i.prototype.ay=function(e){if(this.vc(),null==this.ka&&0<e)this.ka=t.O.lg(2*e);else if(null!=this.ka&&this.ka.length<2*e){for(var i=this.ka.slice(0),n=this.ka.length;n<2*e;n++)i[n]=0;this.ka=i}},i.gM=function(t,e,i){if(0<i)var n=0;for(var r=0;r<i;r++)e[0+n]=t[0],n++},i.prototype.em=function(t,e){0!=t?(this.pa=e.x,this.la=e.y):(this.sa=e.x,this.na=e.y)},i.prototype.sn=function(e){if(null!=this.ka){for(var n=t.ee.Iw(e,this.description),r=[],s=i.Gg(this.description,0),o=i.Gg(this.description,1),a=i.Gg(e,0),h=i.Gg(e,1),l=0,c=1,u=e.Aa;c<u;c++){var d=e.kd(c),f=t.ra.Va(d);if(-1==n[c]){var p=t.ra.se(d);for(d=0;d<f;d++)r[a+l]=p,r[h+l]=p,l++}else for(p=this.description.$j(n[c])-2,d=0;d<f;d++)r[a+l]=this.ka[s+p],r[h+l]=this.ka[o+p],l++,p++}this.ka=r}this.description=e},i.prototype.hD=function(e,i){if(this.Ac())throw t.i.fa("empty geometry");i.Nf(this.description),i.Ac()&&i.un();for(var n=0;n<this.description.Aa;n++)for(var r=this.description.Ed(n),s=0,o=t.ra.Va(r);s<o;s++){var a=this.Od(e,r,s);i.setAttribute(r,s,a)}},i.prototype.uD=function(e,i){if(this.vc(),i.Ac())throw t.i.fa("empty geometry");for(var n=i.description,r=0,s=n.Aa;r<s;r++)for(var o=n.Ed(r),a=t.ra.Va(o),h=0;h<a;h++){var l=i.Uc(o,h);this.tn(e,o,h,l)}},i.prototype.Od=function(e,n,r){if(this.Ac())throw t.i.fa("This operation was performed on an Empty Geometry.");if(0==n)return 0!=e?0!=r?this.la:this.pa:0!=r?this.na:this.sa;if(r>=t.ra.Va(n))throw t.i.ce();var s=this.description.Pf(n);return 0<=s?(null!=this.ka&&this.ay(this.description.Ae.length-2),this.ka[i.Gg(this.description,e)+this.description.$j(s)-2+r]):t.ra.se(n)},i.prototype.tn=function(e,n,r,s){if(this.vc(),r>=t.ra.Va(n))throw t.i.ce();var o=this.description.Pf(n);0>o&&(this.re(n),o=this.description.Pf(n)),0==n?0!=e?0!=r?this.la=s:this.pa=s:0!=r?this.na=s:this.sa=s:(null==this.ka&&this.ay(this.description.Ae.length-2),this.ka[i.Gg(this.description,e)+this.description.$j(o)-2+r]=s)},i.prototype.copyTo=function(e){if(e.getType()!=this.getType())throw t.i.N();e.description=this.description,e.ay(this.description.Ae.length-2),i.gM(this.ka,e.ka,2*(this.description.Ae.length-2)),e.sa=this.sa,e.na=this.na,e.pa=this.pa,e.la=this.la,e.vc(),this.op(e)},i.prototype.Tg=function(e,i){var n=new t.Nc;return this.Ac()?(n.Oa(),n):(n.oa=this.Od(0,e,i),n.va=n.oa,n.Lk(this.Od(1,e,i)),n)},i.prototype.ZI=function(t){this.Ac()?t.Oa():(t.oa=this.Od(0,0,0),t.va=t.oa,t.Lk(this.Od(1,0,0)))},i.prototype.Tw=function(e,i){i.Nf(this.description),i.Cb(this.hc(e));for(var n=1,r=this.description.Aa;n<r;n++)for(var s=this.description.Ed(n),o=t.ra.Va(s),a=0;a<o;a++){var h=this.Uc(e,s,a);i.setAttribute(s,a,h)}},i.prototype.FM=function(t){if(this.description!=t.description||this.sa!=t.sa||this.pa!=t.pa||this.na!=t.na||this.la!=t.la)return!1;for(var e=0;e<2*(this.description.Ae.length-2);e++)if(this.ka[e]!=t.ka[e])return!1;return!0},i.prototype.BG=function(){return this.sa==this.pa&&this.na==this.la},i.prototype.reverse=function(){var e=this.sa;this.sa=this.pa,this.pa=e,e=this.na,this.na=this.la,this.la=e,e=1;for(var i=this.description.Aa;e<i;e++)for(var n=this.description.kd(e),r=0,s=t.ra.Va(n);r<s;r++){var o=this.Od(0,n,r),a=this.Od(1,n,r);this.tn(0,n,r,a),this.tn(1,n,r,o)}},i.prototype.zr=function(e,i,n){var r=this.getType(),s=e.getType();if(322===r){if(322==s)return t.yb.OM(this,e,i,n);throw t.i.Qa()}throw t.i.Qa()},i.prototype.KM=function(e,i,n,r,s){var o=this.getType(),a=e.getType();if(322===o){if(322==a)return t.yb.Zx(this,e,i,n,r,s);throw t.i.Qa()}throw t.i.Qa()},i.prototype.Tx=function(){return null},i.Gg=function(t,e){return e*(t.Ae.length-2)},i.prototype.hc=function(e,i){if(void 0===i)return i=new t.h,this.hc(e,i),i;t.lc.lT(this.sa,this.na,this.pa,this.la,e,i)},i.prototype.fe=function(){return null},i.prototype.eG=function(){return null},i.prototype.cq=function(){return null},i.prototype.Bi=function(){return null},i.prototype.Pn=function(){return null},i.prototype.kg=function(){return null},i.prototype.Ux=function(t,e){return void 0!==e?this.vx(e)-this.vx(t):this.vx(t)},i.prototype.op=function(){},i.prototype.dl=function(){return null},i.prototype.ah=function(){},i.prototype.Uc=function(){return null},i.prototype.Pe=function(){return null},i.prototype.vx=function(){return null},i.prototype.NG=function(){return null},i.prototype.tb=function(t,e){if(!e&&0!=this.zr(t,0,!1))return 0;e=17976931348623157e292;var i=this.ac(),n=t.fe(i,!1);return i.sub(t.hc(n)),(i=i.length())<e&&(e=i),i=this.wc(),n=t.fe(i,!1),i.sub(t.hc(n)),(i=i.length())<e&&(e=i),i=t.ac(),n=this.fe(i,!1),i.sub(this.hc(n)),(i=i.length())<e&&(e=i),i=t.wc(),n=this.fe(i,!1),i.sub(this.hc(n)),(i=i.length())<e&&(e=i),e},i.prototype.mg=function(){return t.pi.gm(this,null)},i}(t.aa);t.SC=e}(X||(X={})),new X.h,function(t){var e;(e=t.$K||(t.$K={}))[e.Unknown=-1]="Unknown",e[e.Not=0]="Not",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong",function(t){t[t.DirtyIsKnownSimple=1]="DirtyIsKnownSimple",t[t.IsWeakSimple=2]="IsWeakSimple",t[t.IsStrongSimple=4]="IsStrongSimple",t[t.DirtyOGCFlags=8]="DirtyOGCFlags",t[t.DirtyVerifiedStreams=32]="DirtyVerifiedStreams",t[t.DirtyExactIntervals=64]="DirtyExactIntervals",t[t.DirtyLooseIntervals=128]="DirtyLooseIntervals",t[t.DirtyIntervals=192]="DirtyIntervals",t[t.DirtyIsEnvelope=256]="DirtyIsEnvelope",t[t.DirtyLength2D=512]="DirtyLength2D",t[t.DirtyRingAreas2D=1024]="DirtyRingAreas2D",t[t.DirtyCoordinates=1993]="DirtyCoordinates",t[t.DirtyAllInternal=65535]="DirtyAllInternal",t[t.DirtyAll=16777215]="DirtyAll"}(t.MK||(t.MK={}));var i=function(e){function i(){var t=e.call(this)||this;return t.Hm=65535,t.wa=0,t.Pg=-1,t.Bb=null,t}return Q(i,e),i.prototype.op=function(){},i.prototype.$x=function(){},i.prototype.iy=function(){},i.prototype.I=function(){return this.wa},i.prototype.B=function(){return this.Ac()},i.prototype.Ac=function(){return 0==this.wa},i.prototype.ak=function(t){return!!(this.Hm&t)},i.prototype.Lf=function(t,e){this.Hm=e?this.Hm|t:this.Hm&~t},i.prototype.mc=function(){this.ak(32)&&this.bN()},i.prototype.wx=function(){if(this.Ac())throw t.i.fa("This operation was performed on an Empty Geometry.")},i.prototype.ve=function(e,i){if(0>e||e>=this.wa)throw t.i.fa("index out of bounds");this.mc(),i.Nf(this.description),i.B()&&i.un();for(var n=0;n<this.description.Aa;n++)for(var r=this.description.Ed(n),s=0,o=t.ra.Va(r);s<o;s++){var a=this.za[n].eg(o*e+s);i.setAttribute(r,s,a)}},i.prototype.Ht=function(e,i){this.mc();for(var n=i.description,r=0;r<n.Aa;r++)for(var s=n.Ed(r),o=t.ra.Va(s),a=0;a<o;a++){var h=i.Uc(s,a);this.setAttribute(s,e,a,h)}},i.prototype.D=function(e,i){if(0>e||e>=this.I())throw t.i.ce();this.mc(),this.za[0].tc(2*e,i)},i.prototype.Na=function(e){var i=new t.h;return this.D(e,i),i},i.prototype.Gc=function(t,e){this.za[0].tc(2*t,e)},i.prototype.Cb=function(e,i,n){if(0>e||e>=this.wa)throw t.i.ce();this.mc();var r=this.za[0];void 0!==n?(r.write(2*e,i),r.write(2*e+1,n)):r.Tt(2*e,i),this.Pc(1993)},i.prototype.Cz=function(){if(void 0>=this.I())throw t.i.ce();this.mc();var e=this.za[0],i=new t.Nd;return i.x=e.read(NaN),i.y=e.read(NaN),i.z=this.hasAttribute(1)?this.za[1].eg():t.ra.se(1),i},i.prototype.dC=function(e){if(0>e||e>=this.I())throw t.i.ce();this.re(1),this.mc(),this.Pc(1993);var i=this.za[0];i.write(2*e,(void 0).x),i.write(2*e+1,(void 0).y),this.za[1].pr(e,(void 0).z)},i.prototype.Uc=function(e,i,n){if(0>i||i>=this.wa)throw t.i.ce();var r=t.ra.Va(e);if(n>=r)throw t.i.ce();this.mc();var s=this.description.Pf(e);return 0<=s?this.za[s].eg(i*r+n):t.ra.se(e)},i.prototype.yF=function(t,e){return this.Uc(t,e)},i.prototype.setAttribute=function(e,i,n,r){if(0>i||i>=this.wa)throw t.i.ce();var s=t.ra.Va(e);if(n>=s)throw t.i.ce();this.re(e),this.mc(),e=this.description.Pf(e),this.Pc(1993),this.za[e].pr(i*s+n,r)},i.prototype.ub=function(t){return this.wx(),this.re(t),this.mc(),this.za[this.description.Pf(t)]},i.prototype.hn=function(e,i){if(null!=i&&t.ra.Tp(e)!=i.Tp())throw t.i.N();this.re(e),e=this.description.Pf(e),null==this.za&&(this.za=t.Yc.qI(this.description.Aa)),this.za[e]=i,this.Pc(16777215)},i.prototype.sn=function(e){var i=null;if(null!=this.za){var n=t.ee.Iw(e,this.description);i=[];for(var r=0,s=e.Aa;r<s;r++)-1!=n[r]&&(i[r]=this.za[n[r]])}this.description=e,this.za=i,this.Pg=-1,this.Pc(16777215)},i.prototype.AD=function(e){this.wu(!0),e instanceof t.l?this.$.A(e):this.$.Qo(e)},i.prototype.aN=function(e){this.wu(!1),e instanceof t.l?this.$.A(e):this.$.Qo(e)},i.prototype.bn=function(t){this.wu(!0),this.$.copyTo(t)},i.prototype.A=function(t){this.AD(t)},i.prototype.Qo=function(t){this.AD(t)},i.prototype.xc=function(t){this.aN(t)},i.prototype.Tg=function(e,i){var n=new t.Nc;return this.Ac()?(n.Oa(),n):(this.wu(!0),this.$.Tg(e,i))},i.prototype.cc=function(){var e=this.description.cc();if(!this.Ac())for(var i=this.I(),n=0,r=this.description.Aa;n<r;n++)e=this.za[n].An(e,0,i*t.ra.Va(this.description.Ed(n)));return e},i.prototype.Nb=function(e){if(e==this)return!0;if(!(e instanceof i&&this.description.Nb(e.description))||this.Ac()!=e.Ac())return!1;if(this.Ac())return!0;var n=this.I();if(n!=e.I())return!1;for(var r=0;r<this.description.Aa;r++){var s=this.description.kd(r),o=this.ub(s),a=e.ub(s);if(!o.Nb(a,0,n*t.ra.Va(s)))return!1}return!0},i.prototype.copyTo=function(e){if(e.getType()!=this.getType())throw t.i.N();this.dD(e)},i.prototype.dD=function(e){this.mc(),e.description=this.description,e.za=null;var i=this.description.Aa,n=null;if(null!=this.za){n=[];for(var r=0;r<i;r++)null!=this.za[r]&&(n[r]=this.za[r].GB(this.I()*t.ra.Va(this.description.Ed(r))))}null!=this.$?(e.$=this.$.Ia(),this.$.copyTo(e.$)):e.$=null,e.wa=this.wa,e.Hm=this.Hm,e.za=n;try{this.op(e)}catch(i){throw e.Oa(),t.i.fu()}},i.prototype.wD=function(){this.wa=0,this.Pg=-1,this.za=null,this.Pc(16777215)},i.prototype.Pc=function(t){16777215==t&&(this.Pg=-1,this.$x()),this.Hm|=t,this.lM(),this.vc()},i.prototype.wu=function(e){if(this.mc(),this.ak(192))if(null==this.$?this.$=new t.Fh(this.description):this.$.Nf(this.description),this.B())this.$.Oa();else{this.hy(e);for(var i=1;i<this.description.Aa;i++)for(var n=this.description.Ed(i),r=t.ra.Va(n),s=this.za[i],o=0;o<r;o++){var a=new t.Nc;a.Oa();for(var h=0;h<this.wa;h++){var l=s.eg(h*r+o);a.Zb(l)}this.$.setInterval(n,o,a)}e&&this.Lf(192,!1)}},i.prototype.hy=function(){this.$.Oa();for(var e=this.za[0],i=new t.h,n=0;n<this.wa;n++)e.tc(2*n,i),this.$.Zb(i)},i.prototype.yp=function(e){e.Oa();for(var i=this.za[0],n=new t.h,r=0;r<this.wa;r++)i.tc(2*r,n),e.Zb(n)},i.prototype.bN=function(){if(this.Pg<this.wa){null==this.za&&(this.za=t.Yc.qI(this.description.Aa)),this.Pg=2147483647;for(var e=0;e<this.description.Aa;e++){var i=this.description.Ed(e);if(null!=this.za[e]){var n=t.ra.Va(i),r=t.O.truncate(this.za[e].size/n);r<this.wa&&(r=t.O.truncate(this.Pg>this.wa+5?(5*this.wa+3)/4:this.wa),this.za[e].resize(r*n,t.ra.se(i))),r<this.Pg&&(this.Pg=r)}else this.za[e]=t.Yc.YE(i,this.wa),this.Pg=this.wa}}this.iy(),this.Lf(32,!1)},i.prototype.dm=function(e){if(0>e)throw t.i.N();e!=this.wa&&(this.wa=e,this.Pc(65535))},i.prototype.om=function(t){if(!this.ak(1)){if(!this.ak(2))return 0;if(this.QT>=t)return this.ak(8)?1:2}return-1},i.prototype.Ch=function(e,i){if(this.QT=i,-1==e)this.Lf(1,!0),this.Lf(8,!0);else if(this.Lf(1,!1),this.Lf(8,!0),0==e)this.Lf(2,!1),this.Lf(4,!1);else if(1==e)this.Lf(2,!0),this.Lf(4,!1);else{if(2!=e)throw t.i.fa("internal error.");this.Lf(2,!0),this.Lf(4,!0)}},i.prototype.lM=function(){null!=this.Bb&&(this.Bb=null)},i.prototype.kD=function(e,i,n,r){if(0>e||e>=this.wa)throw t.i.fa("index out of bounds");if(0>i||i>=this.wa)throw t.i.fa("index out of bounds");this.mc(),r.Nf(this.description),r.B()&&r.un();for(var s=0;s<this.description.Aa;s++)for(var o=this.description.Ed(s),a=0,h=t.ra.Va(o);a<h;a++){var l=this.za[s].eg(h*e+a),c=this.za[s].eg(h*i+a);r.setAttribute(o,a,t.lc.hq(l,c,n))}},i.prototype.yr=function(t,e){var i=this.za[0].o,n=i[2*t]-i[2*e];return t=i[2*t+1]-i[2*e+1],Math.sqrt(n*n+t*t)},i.prototype.KR=function(e){if(0>e||e>=this.wa)throw t.i.ce();this.mc();var i=new t.Sa;i.Nf(this.description),i.B()&&i.un();for(var n=0;n<this.description.Aa;n++)for(var r=this.description.kd(n),s=0,o=t.ra.Va(r);s<o;s++){var a=this.za[n].eg(o*e+s);i.setAttribute(r,s,a)}return i},i.prototype.Dh=function(e,i){if(0>e||e>=this.wa)throw t.i.ce();if(i.B())throw t.i.N();this.mc();for(var n=i.description,r=0;r<n.Aa;r++)for(var s=n.kd(r),o=t.ra.Va(s),a=0;a<o;a++){var h=i.Uc(s,a);this.setAttribute(s,e,a,h)}},i.prototype.lu=function(){return null},i.prototype.fj=function(){return null},i}(t.aa);t.Gx=i}(X||(X={})),function(t){var e=function(){function e(){this.ob=this.Zn=null,this.Tm=124234251,this.Rv=!0,this.Qe=-1,this.ob=new t.$c(7),this.Zn=null}return e.prototype.Vo=function(t){this.Zn=t},e.prototype.RP=function(){this.Rv=!1},e.prototype.De=function(t){this.ob.De(t)},e.prototype.Pr=function(t){var e=this.ob.Ce();return this.rX(e),this.uX(t,e),e},e.prototype.MP=function(t){this.ob.jd(t)},e.prototype.addElement=function(t,e){return-1==e&&(-1==this.Qe&&(this.Qe=this.Pr(-1)),e=this.Qe),this.FD(t,0,e)},e.prototype.KD=function(t){return-1==this.Qe&&(this.Qe=this.Pr(-1)),this.FD(t,1,this.Qe)},e.prototype.xn=function(t){-1==this.Qe&&(this.Qe=this.Pr(-1));var e=this.Qe,i=this.ob.o;if(-1==e||-1==i[7*e])return t=this.ob.Ll([-1,-1,-1,t,this.gl(),-1,-1]),(i=this.ob.o)[7*e]=t,this.vp(-1,t,e,i),t;var n=-1==e?-1:i[7*e+2];return t=this.ob.Ll([-1,-1,n,t,this.gl(),-1,-1]),(i=this.ob.o)[7*n+1]=t,this.oy(t,i),-1===i[7*t+2]&&(i[7*e]=t),this.vp(-1,t,e,i),t},e.prototype.zu=function(e,i,n,r){var s=-1;-1==s&&(-1==this.Qe&&(this.Qe=this.Pr(-1)),s=this.Qe);var o=this.ob.o;if(-1==s||-1==o[7*s])return n=this.ob.Ll([-1,-1,-1,n,this.gl(),-1,-1]),(o=this.ob.o)[7*s]=n,this.vp(-1,n,s,o),n;if(r){r=-1!=i?this.Zn.compare(this,n,i):-1;var a=-1!=e?this.Zn.compare(this,n,e):1}else r=-1,a=1;if(0==r||0==a)return o[7*s+3]=0==r?i:e,-1;for((-1!=i&&-1!=e?this.Tm>t.O.bB(this.Tm)>>1:-1!=i)?e=i:r=a,i=!0;;){if(0>r){if(-1==(a=o[7*e])){r=e,n=this.ob.Ll([-1,-1,e,n,this.gl(),-1,-1]),(o=this.ob.o)[7*e]=n;break}e=a}else{if(-1==(a=o[7*e+1])){r=o[7*e+6],n=this.ob.Ll([-1,-1,e,n,this.gl(),-1,-1]),(o=this.ob.o)[7*e+1]=n;break}e=a}i&&(r*=-1,i=!1)}return this.oy(n,o),-1===o[7*n+2]&&(o[7*s]=n),this.vp(r,n,s,o),n},e.prototype.FF=function(){return this.iR(this.Qe)},e.prototype.vd=function(t,e){e=-1==e?this.Qe:e,this.Rv?this.LP(t,e):this.iY(t,e)},e.prototype.search=function(t,e){for(e=this.sv(e);-1!=e;){var i=this.Zn.compare(this,t,e);if(0==i)return e;e=0>i?this.ll(e):this.Xp(e)}return-1},e.prototype.IW=function(t){for(var e=this.sv(-1),i=-1;-1!=e;){var n=t.compare(this,e);if(0==n)return e;0>n?e=this.ll(e):(i=e,e=this.Xp(e))}return i},e.prototype.uJ=function(t){for(var e=this.sv(-1),i=-1;-1!=e;){var n=t.compare(this,e);if(0==n)return e;0>n?(i=e,e=this.ll(e)):e=this.Xp(e)}return i},e.prototype.ja=function(t){return this.ob.T(t,3)},e.prototype.ll=function(t){return this.ob.T(t,0)},e.prototype.Xp=function(t){return this.ob.T(t,1)},e.prototype.getParent=function(t){return this.ob.T(t,2)},e.prototype.lb=function(t){return this.ob.T(t,6)},e.prototype.we=function(t){return this.ob.T(t,5)},e.prototype.rc=function(t){return-1==t?this.kl(this.Qe):this.kl(t)},e.prototype.Fc=function(t){return-1==t?this.Zr(this.Qe):this.Zr(t)},e.prototype.ZR=function(t){return-1==t?this.bG(this.Qe):this.bG(t)},e.prototype.Sj=function(t,e){this.NB(t,e)},e.prototype.sv=function(t){return-1==t?this.YF(this.Qe):this.YF(t)},e.prototype.clear=function(){this.ob.mj(!1),this.Qe=-1},e.prototype.size=function(t){return-1==t?this.$F(this.Qe):this.$F(t)},e.prototype.KN=function(t,e){for(var i=e[7*t],n=e[7*t+1],r=e[7*t+4];-1!=i||-1!=n;){var s=-1!=i?e[7*i+4]:2147483647;if(n=-1!=n?e[7*n+4]:2147483647,r<=Math.min(s,n))break;s<=n?this.sJ(i,e):this.rJ(t,e),i=e[7*t],n=e[7*t+1]}},e.prototype.oy=function(t,e){if(this.Rv)for(var i=e[7*t+4],n=e[7*t+2];-1!=n&&e[7*n+4]>i;)e[7*n]==t?this.sJ(t,e):this.rJ(n,e),n=e[7*t+2]},e.prototype.rJ=function(t,e){var i=e[7*t+1];e[7*i+2]=e[7*t+2],e[7*t+2]=i;var n=e[7*i];e[7*t+1]=n,-1!=n&&(e[7*n+2]=t),e[7*i]=t,-1!=(n=e[7*i+2])&&(e[7*n]==t?e[7*n]=i:e[7*n+1]=i)},e.prototype.sJ=function(t,e){var i=e[7*t+2];e[7*t+2]=e[7*i+2],e[7*i+2]=t;var n=e[7*t+1];e[7*i]=n,-1!=n&&(e[7*n+2]=i),e[7*t+1]=i,-1!=(n=e[7*t+2])&&(e[7*n]===i?e[7*n]=t:e[7*n+1]=t)},e.prototype.Pk=function(t,e){this.ob.S(t,2,e)},e.prototype.TB=function(t,e){this.ob.S(t,0,e)},e.prototype.XB=function(t,e){this.ob.S(t,1,e)},e.prototype.WB=function(t,e){this.ob.S(t,5,e)},e.prototype.ex=function(t,e){this.ob.S(t,6,e)},e.prototype.XJ=function(t,e){this.ob.S(e,0,t)},e.prototype.rX=function(t){this.ob.S(t,4,0)},e.prototype.uX=function(t,e){this.ob.S(e,5,t)},e.prototype.YF=function(t){return-1==t?-1:this.ob.T(t,0)},e.prototype.kl=function(t){return-1==t?-1:this.ob.T(t,1)},e.prototype.Zr=function(t){return-1==t?-1:this.ob.T(t,2)},e.prototype.iR=function(t){return-1==t?-1:this.ob.T(t,3)},e.prototype.$F=function(t){return-1==t?0:this.ob.T(t,4)},e.prototype.bG=function(t){return this.ob.T(t,5)},e.prototype.Pw=function(){return this.ob.Ll([-1,-1,-1,void 0,this.gl(),-1,-1])},e.prototype.fl=function(t){-1!=t&&this.ob.jd(t)},e.prototype.gl=function(){return this.Tm=t.O.bB(this.Tm),1073741823&this.Tm},e.prototype.FD=function(t,e,i){var n=this.ob.o;if(-1==i||-1==n[7*i])return t=this.ob.Ll([-1,-1,-1,t,this.gl(),-1,-1]),(n=this.ob.o)[7*i]=t,this.vp(-1,t,i,n),t;for(var r=-1==i?-1:n[7*i];;){var s=-1==e?1:this.Zn.compare(this,t,r);if(0>s){if(-1==(s=this.ll(r))){e=r,t=this.ob.Ll([-1,-1,r,t,this.gl(),-1,-1]),(n=this.ob.o)[7*r]=t;break}r=s}else{if(1==e&&0==s)return n[7*i+3]=r,-1;if(-1==(s=n[7*r+1])){e=n[7*r+6],t=this.ob.Ll([-1,-1,r,t,this.gl(),-1,-1]),(n=this.ob.o)[7*r+1]=t;break}r=s}}return this.oy(t,n),-1===n[7*t+2]&&(n[7*i]=t),this.vp(e,t,i,n),t},e.prototype.vp=function(t,e,i,n){if(-1!=t){var r=n[7*t+5];n[7*t+5]=e}else r=-1==i?-1:n[7*i+2];n[7*e+5]=r,-1!=r&&(n[7*r+6]=e),n[7*e+6]=t,t==(-1==i?-1:n[7*i+1])&&(n[7*i+1]=e),-1==t&&(n[7*i+2]=e),n[7*i+4]=(-1==i?0:n[7*i+4])+1},e.prototype.AB=function(t,e){var i=this.ob.o,n=i[7*t+5];t=i[7*t+6],-1!=n?i[7*n+6]=t:i[7*e+1]=t,-1!=t?i[7*t+5]=n:i[7*e+2]=n,i[7*e+4]=-1===e?-1:i[7*e+4]-1},e.prototype.iY=function(e,i){this.AB(e,i);var n=this.ll(e),r=this.Xp(e),s=this.getParent(e),o=e;if(-1!=n&&-1!=r){this.Tm=t.O.bB(this.Tm);var a=1073741823<this.Tm?this.lb(e):this.we(e),h=this.getParent(a)==e;this.ob.gC(e,a,0),this.ob.gC(e,a,1),this.ob.gC(e,a,2),-1!=s?this.ll(s)==e?this.TB(s,a):this.XB(s,a):this.XJ(a,i),h?(n==a?(this.TB(a,e),this.Pk(r,a)):r==a&&(this.XB(a,e),this.Pk(n,a)),this.Pk(e,a),s=a):(this.Pk(n,a),this.Pk(r,a),s=this.getParent(e),o=a),n=this.ll(e),r=this.Xp(e),-1!=n&&this.Pk(n,e),-1!=r&&this.Pk(r,e)}n=-1!=n?n:r,-1==s?this.XJ(n,i):this.ll(s)==o?this.TB(s,n):this.XB(s,n),-1!=n&&this.Pk(n,s),this.fl(e)},e.prototype.LP=function(t,e){var i=this.ob.o;i[7*t+4]=2147483647;var n=-1,r=-1,s=-1===e?-1:i[7*e],o=s==t;if(o&&(n=i[7*s],r=i[7*s+1],-1==n&&-1==r))return this.AB(s,e),this.fl(s),void(i[7*e]=-1);this.KN(t,i),-1!=(s=i[7*t+2])&&(i[7*s]==t?i[7*s]=-1:i[7*s+1]=-1),this.AB(t,e),this.fl(t),o&&(i[7*e]=-1==n||-1!=i[7*n+2]?r:n)},e.prototype.NB=function(t,e){this.ob.S(t,3,e)},e}();t.Yj=e}(X||(X={})),function(t){var e=function(){function e(t,e){void 0!==t&&this.K(t,e)}return e.prototype.K=function(t,e){this.oa=t,this.va=e,this.normalize()},e.prototype.isIntersecting=function(t){return this.oa<=t.oa?this.va>=t.oa:t.va>=this.oa},e.prototype.move=function(t){this.B()||(this.oa+=t,this.va+=t)},e.prototype.normalize=function(){if(!isNaN(this.oa)){if(this.oa>this.va){var t=this.oa;this.oa=this.va,this.va=t}isNaN(this.va)&&this.Oa()}},e.prototype.Oa=function(){this.va=this.oa=NaN},e.prototype.B=function(){return isNaN(this.oa)},e.prototype.Zb=function(t){"number"==typeof t?this.B()?this.va=this.oa=t:this.Lk(t):t.B()||(this.B()?(this.oa=t.oa,this.va=t.va):(this.oa>t.oa&&(this.oa=t.oa),this.va<t.va&&(this.va=t.va),this.oa>this.va&&this.Oa()))},e.prototype.Lk=function(t){t<this.oa?this.oa=t:t>this.va&&(this.va=t)},e.prototype.contains=function(t){return"number"==typeof t?t>=this.oa&&t<=this.va:t.oa>=this.oa&&t.va<=this.va},e.prototype.Ea=function(t){this.B()||t.B()?this.Oa():(this.oa<t.oa&&(this.oa=t.oa),this.va>t.va&&(this.va=t.va),this.oa>this.va&&this.Oa())},e.prototype.W=function(t){this.B()||(this.oa-=t,this.va+=t,this.va<this.oa&&this.Oa())},e.prototype.xr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.oa)+Math.abs(this.va)+1)},e.prototype.KB=function(t,e){t>e?(this.oa=e,this.va=t):(this.oa=t,this.va=e)},e.prototype.It=function(e){return t.O.Rk(e,this.oa,this.va)},e.prototype.R=function(){return this.va-this.oa},e.prototype.sf=function(){return.5*(this.oa+this.va)},e.prototype.Nb=function(t){return t==this||t instanceof e&&(!(!this.B()||!t.B())||this.oa==t.oa&&this.va==t.va)},e.prototype.cc=function(){return t.O.uj(t.O.uj())},e}();t.Nc=e}(X||(X={})),function(t){var e=new t.Nc,i=new t.Nc,n=function(){this.ne=null,this.pb=-1,this.sb=new t.yb,this.qA=55555555,this.Tv=this.Vv=!1,this.Uf=new t.Nc,this.Uf.KB(0,0)};t.IY=n;var r=function(){function r(e,i,r){this.g=e,this.Hk=NaN,this.NH=this.Kq=0,this.OH=NaN,this.qa=i,this.Nq=10*i,this.PH=this.QH=NaN,this.rg=!1,this.Dm=this.gt=this.Lo=this.Xs=this.Ws=-1,this.gA=r,this.TA=new n,this.YH=new n,t.O.truncate(3*e.fd/2)}return r.prototype.mG=function(t,e,i,n){t.ne=null===n?null:n[i[5*e]],t.Tv=null!=t.ne,t.Tv||(-1!==(n=i[5*e+2])&&this.g.mW(i[5*e],i[5*n],t.sb),t.ne=t.sb,t.Uf.KB(t.sb.sa,t.sb.pa),t.Uf.va+=this.qa,t.sb.rI(),t.Vv=t.sb.la==t.sb.na,t.Vv||(t.qA=(t.sb.pa-t.sb.sa)/(t.sb.la-t.sb.na)))},r.prototype.OO=function(t,e){var i=t.zr(e,this.qa,!0);return 0!=i?2==i?this.Qy():this.xi():(t.Yp(et),t.Tr(it),e.Yp(nt),e.Tr(rt),tt.ma(this.Kq,this.Hk),et.qb(nt)&&this.Hk==et.y?0>it.compare(rt)?tt.L(it):tt.L(rt):et.qb(rt)&&this.Hk==et.y?0>it.compare(nt)?tt.L(it):tt.L(nt):nt.qb(it)&&this.Hk==nt.y?0>et.compare(rt)?tt.L(et):tt.L(rt):it.qb(rt)&&this.Hk==it.y&&(0>et.compare(nt)?tt.L(et):tt.L(nt)),t.Pe(tt.y,tt.x)<e.Pe(tt.y,tt.x)?-1:1)},r.prototype.MO=function(t,e){if(t.sb.na==e.sb.na&&t.sb.sa==e.sb.sa)return t.sb.la==e.sb.la&&t.sb.pa==e.sb.pa?this.gA?this.Qy():0:this.PE(t,e);if(t.sb.la==e.sb.la&&t.sb.pa==e.sb.pa)return this.OE(t,e);var i=this.OE(t,e);return t=this.PE(t,e),0>i&&0>t?-1:0<i&&0<t?1:this.xi()},r.prototype.IO=function(t,e){if(t.pa>e.pa){if(e.pa>e.sa&&e.la-e.na<2*this.qa&&t.vi(e.pa,e.la,this.qa))return this.xi()}else if((e.la-e.na)/(e.pa-e.sa)*(t.pa-t.sa)<this.Nq&&e.vi(t.pa,t.la,this.qa))return this.xi();return 1},r.prototype.JO=function(t,e){if(t.sa<e.sa){if(e.pa>e.sa&&e.la-e.na<2*this.qa&&t.vi(e.pa,e.la,this.qa))return this.xi()}else if((e.la-e.na)/(e.pa-e.sa)*(t.sa-t.pa)<this.Nq&&e.vi(t.sa,t.na,this.qa))return this.xi();return-1},r.prototype.KO=function(e,i){var n=new t.h;n.uc(i.wc(),i.ac()),n.ar(),n.normalize();var r=new t.h;r.uc(e.ac(),i.ac());var s=new t.h;s.uc(e.wc(),i.ac()),r=r.Qh(n),n=s.Qh(n),s=Math.abs(r);var o=Math.abs(n);if(s<o){if(s<this.Nq&&i.vi(e.sa,e.na,this.qa))return this.xi()}else if(o<this.Nq&&i.vi(e.pa,e.la,this.qa))return this.xi();return 0>r&&0>n?-1:0<r&&0<n?1:this.xi()},r.prototype.NE=function(t,e){return t.na==e.na&&t.sa==e.sa?this.IO(t,e):t.la==e.la&&t.pa==e.pa?this.JO(t,e):this.KO(t,e)},r.prototype.LO=function(t,e){return t.la==e.la&&t.pa==e.pa&&t.na==e.na&&t.sa==e.sa?this.gA?this.Qy():0:this.xi()},r.prototype.OE=function(t,e){var i=1;if(t.sb.na<e.sb.na){i=-1;var n=t;t=e,e=n}t=t.sb,n=e.sb;var r=t.sa-n.sa;e=e.qA*(t.na-n.na);var s=this.Nq;return r<e-s?-i:r>e+s?i:n.vi(t.sa,t.na,this.qa)?this.xi():r<e?-i:i},r.prototype.PE=function(t,e){var i=1;if(e.sb.la<t.sb.la){i=-1;var n=t;t=e,e=n}t=t.sb,n=e.sb;var r=t.pa-n.sa;e=e.qA*(t.la-n.na);var s=this.Nq;return r<e-s?-i:r>e+s?i:n.vi(t.pa,t.la,this.qa)?this.xi():r<e?-i:i},r.prototype.Qy=function(){return this.rg=!0,this.Ni=new t.Md(5,this.Lo,this.gt),-1},r.prototype.xi=function(){return this.rg=!0,this.gA?this.Ni=new t.Md(4,this.Lo,this.gt):this.gt=this.Lo=this.Xs=this.Ws=-1,-1},r.prototype.NO=function(t,n,r,s){if(this.rg)return-1;var o=this.OH==this.Hk&&this.NH==this.Kq;if(o&&t==this.Ws)var a=this.PH;else a=NaN,this.Ws=-1;return o&&n==this.Xs?o=this.QH:(o=NaN,this.Xs=-1),r.ne.ZI(e),s.ne.ZI(i),e.va<i.oa?-1:i.va<e.oa?1:(this.OH=this.Hk,this.NH=this.Kq,isNaN(a)&&(this.Ws=t,this.PH=a=t=r.ne.Pe(this.Hk,this.Kq)),isNaN(o)&&(this.Xs=n,this.QH=o=t=s.ne.Pe(this.Hk,this.Kq)),Math.abs(a-o)<=this.qa?this.OO(r.ne,s.ne):a<o?-1:a>o?1:0)},r.prototype.Kr=function(){this.rg=!1},r.prototype.rm=function(){return this.Ni},r.prototype.$J=function(t,e){this.Hk=t,this.Kq=e,this.gt=this.Lo=this.Xs=this.Ws=-1},r.prototype.compare=function(t,e,i){return this.rg?-1:(t=t.ja(i),this.Dm=i,this.RE(e,e,t,t))},r.prototype.RE=function(t,e,i,n){if(this.Lo==e)var r=this.TA;else this.Lo=e,r=this.TA,this.TA.pb=t,this.mG(r,e,this.g.td.o,this.g.We);if(null==s){this.gt=n;var s=this.YH;this.YH.pb=i,this.mG(s,n,this.g.td.o,this.g.We)}return r.Tv||s.Tv?this.NO(e,n,r,s):r.Uf.va<s.Uf.oa?-1:s.Uf.va<r.Uf.oa?1:(t=r.Vv?1:0,0==(t|=s.Vv?2:0)?this.MO(r,s):1==t?this.NE(r.sb,s.sb):2==t?-1*this.NE(s.sb,r.sb):this.LO(r.sb,s.sb))},r}();t.UC=r}(X||(X={})),function(t){var e=function(){function e(e,i){this.g=e,this.qa=i,this.rg=!1,this.Lo=-1,this.Uf=new t.Nc,this.Gq=new t.h,this.Gq.Rc(),this.ie=new t.yb,this.Dm=-1,this.BA=17976931348623157e292}return e.prototype.Kr=function(){this.rg=!1,this.BA=17976931348623157e292},e.prototype.Dh=function(t){this.Gq.L(t)},e.prototype.compare=function(t,e){return this.SE(e,t.ja(e))},e.prototype.SE=function(e,i){var n=null!=this.g.bc(i);if(n||(this.g.ed(i,this.ie),this.Uf.KB(this.ie.sa,this.ie.pa)),n)throw t.i.fa("not implemented");if(this.Gq.x+this.qa<this.Uf.oa)return-1;if(this.Gq.x-this.qa>this.Uf.va)return 1;if(this.ie.na==this.ie.la)return this.Dm=e,this.rg=!0,0;this.ie.rI(),n=this.ie.ac(),(i=new t.h).uc(this.ie.wc(),n),i.ar();var r=new t.h;return r.uc(this.Gq,n),n=i.Qh(r),(n/=i.length())<10*-this.qa?-1:n>10*this.qa?1:this.ie.qs(this.Gq,this.qa)&&((i=Math.abs(n))<this.BA&&(this.Dm=e,this.BA=i),this.rg=!0,i<.25*this.qa)?0:0>n?-1:1},e}();t.aM=e}(X||(X={})),function(t){function e(t,e,i,n){i=new Float64Array(t.subarray(i,n)),t.set(i,e)}var i=function(){function i(t){this.Pb=this.pk=!1,this.o=null;var e=t;2>e&&(e=2),this.o=new Float64Array(e),this.size=t}return i.prototype.rotate=function(e,i,n){if(this.Pb)throw t.i.fa("invalid_call");if(i<e||i>n||e>n)throw t.i.N();e!=i&&n!=i&&(this.ni(e,i-e,1),this.ni(i,n-i,1),this.ni(e,n-e,1))},i.qf=function(t,e){var n=new i(t),r=n.o;if(2>t&&(t=2),0!==e)for(var s=0;s<t;s++)r[s]=e;return n},i.Bn=function(t){var e=new i(0);return e.o=new Float64Array(t.o),e.size=t.size,e},i.Lr=function(t,e){var n=new i(0);return n.size=t.size,n.size>e&&(n.size=e),2>(e=n.size)&&(e=2),n.o=new Float64Array(e),n.o.set(t.o.length<=e?t.o:t.o.subarray(0,e),0),n},i.prototype.Jb=function(t){0>=t||(null==this.o?this.o=new Float64Array(t):t<=this.o.length||(0<this.o.length?((t=new Float64Array(t)).set(this.o),this.o=t):this.o=new Float64Array(t)))},i.prototype.read=function(t){return this.o[t]},i.prototype.tc=function(t,e){e.x=this.o[t],e.y=this.o[t+1]},i.prototype.get=function(t){return this.o[t]},i.prototype.write=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.set=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.Tt=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i.x,this.o[e+1]=i.y},i.prototype.add=function(t){this.resize(this.size+1),this.o[this.size-1]=t},i.prototype.GB=function(t){return i.Lr(this,t)},i.prototype.eg=function(t){return this.read(t)},i.prototype.resize=function(e,i){if(void 0===i&&(i=0),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.o.length&&5*e/4<this.o.length){var n=new Float64Array(this.o,0,e);this.o=n}}else{e>this.o.length&&(n=t.O.truncate(64>e?Math.max(2*e,4):5*e/4),(n=new Float64Array(n)).set(this.o),this.o=n),n=this.o;for(var r=this.size;r<e;r++)n[r]=i}this.size=e},i.prototype.Bh=function(e){if((null==this.o||e>this.o.length)&&this.resize(e),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e},i.prototype.pr=function(t,e){this.write(t,e)},i.prototype.An=function(e,i,n){for(var r=this.size;i<r&&i<n;i++)e=t.O.uj(this.read(i));return e},i.prototype.Nb=function(t,e,n){if(null==t||!(t instanceof i))return!1;var r=this.size,s=t.size;if(n>r||n>s&&r!=s)return!1;for(n>r&&(n=r);e<n;e++)if(this.read(e)!=t.read(e))return!1;return!0},i.prototype.addRange=function(e,i,n,r,s){if(this.Pb)throw t.i.Hb();if(!r&&(1>s||0!=n%s))throw t.i.N();var o=this.size;if(this.resize(o+n),r)this.o.set(e.o.subarray(i,i+n),o);else{r=n;for(var a=0;a<n;a+=s){r-=s;for(var h=0;h<s;h++)this.o[o+a+h]=e.o[i+r+h]}}},i.prototype.Mn=function(i,n,r,s,o,a,h){if(this.Pb)throw t.i.Hb();if(!o&&(1>a||0!=s%a))throw t.i.N();var l=this.size-h;if(l<s&&this.resize(this.size+s-l),e(this.o,i+s,i,i+(h-i)),this.o==n.o&&i<r&&(r+=s),o)this.o.set(n.o.subarray(r,r+s),i);else for(o=s,h=0;h<s;h+=a)for(o-=a,l=0;l<a;l++)this.o[i+h+l]=n.o[r+o+l]},i.prototype.Iz=function(i,n,r,s,o,a){if(this.Pb)throw t.i.Hb();if(0>a&&(a=this.size),this.size+2*s>this.o.length?this.resize(this.size+2*s):this.size+=2*s,e(this.o,i+2*s,i,i+(a-i)),o)for(o=0;o<s;o++)a=n[r++],this.o[i++]=a.x,this.o[i++]=a.y;else{o=0;for(var h=s-1;o<s;++o)a=n[r+h],this.o[i++]=a.x,this.o[i++]=a.y,h--}},i.prototype.Ln=function(i,n,r,s){if(this.Pb)throw t.i.Hb();for(s-=i,e(this.o,i+s,i,i+s),s=0;s<r;s++)this.o[i+s]=n},i.prototype.vj=function(i,n,r){if(this.Pb)throw t.i.Hb();e(this.o,i+2,i,i+(r-i)),this.o[i]=n.x,this.o[i+1]=n.y},i.prototype.Ut=function(e,i,n,r,s,o){if(0>e||0>i||0>r)throw t.i.N();if(!s&&(0>=o||0!=i%o))throw t.i.N();if(n.size<r+i)throw t.i.N();if(0!=i)if(this.size<i+e&&this.resize(i+e),n==this)this.Ar(e,i,r,s,o);else if(s)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r++;else if(r=r+i-o,1==o)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r--;else for(s=0,i=t.O.truncate(i/o);s<i;s++){for(var a=0;a<o;a++)this.o[e+a]=n.o[r+a];e+=o,r-=o}},i.prototype.En=function(i,n,r){if(this.Pb)throw t.i.Hb();if(i+n>this.size)throw t.i.Hb();0<r-(i+n)&&e(this.o,i,i+n,i+(r-(i+n))+n),this.size-=n},i.prototype.ni=function(e,i,n){if(this.Pb)throw t.i.Hb();if(1>n||0!=i%n)throw t.i.Hb();for(var r=i>>1,s=0;s<r;s+=n){i-=n;for(var o=0;o<n;o++){var a=this.o[e+s+o];this.o[e+s+o]=this.o[e+i+o],this.o[e+i+o]=a}}},i.prototype.Wj=function(e,i,n){if(0>i||0>n||0>i||n+i>this.size)throw t.i.N();for(var r=i;r<i+n;r++)this.o[r]=e},i.prototype.Ar=function(e,i,n,r,s){if(!(r&&e==n||(this.o.set(this.o.subarray(n,n+i),e),r)))for(n=e,e=e+i-s,r=0,i=t.O.truncate(i/2);r<i;r++){for(var o=0;o<s;o++){var a=this.o[n+o];this.o[n+o]=this.o[e+o],this.o[e+o]=a}n+=s,e-=s}},i.prototype.vC=function(e,i,n,r,s){if(0>e||0>i||0>r)throw t.i.N();if(0!=i)for(this.size<(i<<1)+e&&this.resize((i<<1)+e),s||(e+=i-1<<1),s=s?2:-2,i+=r;r<i;r++)this.o[e]=n[r].x,this.o[e+1]=n[r].y,e+=s},i.prototype.uC=function(e,i,n){if(0>e||0>i)throw t.i.N();if(0!=i){this.size<(i<<1)+e&&this.resize((i<<1)+e),i+=0;for(var r=0;r<i;r++)this.o[e]=n[r][0],this.o[e+1]=n[r][1],e+=2}},i.prototype.Vw=function(e,i,n,r,s){if(0>e||0>i||0>r||this.size<i+e)throw t.i.N();if(s)for(s=0;s<i;s++)n[r+s]=this.o[e+s];else for(r=r+i-1;e<i;e++)n[r]=this.o[e],r--},i.prototype.uB=function(e,i,n){if(0>e||0>i||this.size<(i>>1)+e)throw t.i.N();if(0!=i){i=0+i;for(var r=0;r<i;r++)n[r][0]=this.o[e],n[r][1]=this.o[e+1],e+=2}},i.prototype.clear=function(t){t?this.resize(0):this.Bh(0)},i.prototype.ix=function(){this.pk=this.Pb=!0},i.prototype.Vd=function(t,e,i){Array.prototype.sort.call(this.o.subarray(t,e),i)},i.prototype.Tp=function(){return 1},i}();t.be=i}(X||(X={})),function(t){function e(t,e,i,n){i=new Int32Array(t.subarray(i,n)),t.set(i,e)}t.rY=function(){this.random=1973};var i=function(){function i(t){this.Pb=this.pk=!1,this.o=null;var e=t;2>e&&(e=2),this.o=new Int32Array(e),this.size=t}return i.prototype.rotate=function(e,i,n){if(this.Pb)throw t.i.fa("invalid_call");if(i<e||i>n||e>n)throw t.i.N();e!=i&&n!=i&&(this.ni(e,i-e,1),this.ni(i,n-i,1),this.ni(e,n-e,1))},i.qf=function(t,e){var n=new i(t),r=n.o;if(2>t&&(t=2),0!==e)for(var s=0;s<t;s++)r[s]=e;return n},i.Bn=function(t){var e=new i(0);return e.o=new Int32Array(t.o),e.size=t.size,e},i.Lr=function(t,e){var n=new i(0);return n.size=t.size,n.size>e&&(n.size=e),2>(e=n.size)&&(e=2),n.o=new Int32Array(e),n.o.set(t.o.length<=e?t.o:t.o.subarray(0,e),0),n},i.prototype.Jb=function(t){0>=t||(null==this.o?this.o=new Int32Array(t):t<=this.o.length||(0<this.o.length?((t=new Int32Array(t)).set(this.o),this.o=t):this.o=new Int32Array(t)))},i.prototype.read=function(t){return this.o[t]},i.prototype.tc=function(t,e){e.x=this.o[t],e.y=this.o[t+1]},i.prototype.get=function(t){return this.o[t]},i.prototype.write=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.set=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.Tt=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i.x,this.o[e+1]=i.y},i.prototype.add=function(t){this.resize(this.size+1),this.o[this.size-1]=t},i.prototype.GB=function(t){return i.Lr(this,t)},i.prototype.eg=function(t){return this.read(t)},i.prototype.resize=function(e,i){if(void 0===i&&(i=0),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.o.length&&5*e/4<this.o.length){var n=new Int32Array(this.o,0,e);this.o=n}}else{e>this.o.length&&(n=t.O.truncate(64>e?Math.max(2*e,4):5*e/4),(n=new Int32Array(n)).set(this.o),this.o=n),n=this.o;for(var r=this.size;r<e;r++)n[r]=i}this.size=e},i.prototype.Bh=function(e){if((null==this.o||e>this.o.length)&&this.resize(e),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e},i.prototype.pr=function(t,e){this.write(t,e)},i.prototype.An=function(e,i,n){for(var r=this.size;i<r&&i<n;i++)e=t.O.Th(this.read(i),e);return e},i.prototype.Nb=function(t,e,n){if(null==t||!(t instanceof i))return!1;var r=this.size,s=t.size;if(n>r||n>s&&r!=s)return!1;for(n>r&&(n=r);e<n;e++)if(this.read(e)!=t.read(e))return!1;return!0},i.prototype.addRange=function(e,i,n,r,s){if(this.Pb)throw t.i.Hb();if(!r&&(1>s||0!=n%s))throw t.i.N();var o=this.size;if(this.resize(o+n),r)this.o.set(e.o.subarray(i,i+n),o);else{r=n;for(var a=0;a<n;a+=s){r-=s;for(var h=0;h<s;h++)this.o[o+a+h]=e.o[i+r+h]}}},i.prototype.Mn=function(i,n,r,s,o,a,h){if(this.Pb)throw t.i.Hb();if(!o&&(1>a||0!=s%a))throw t.i.N();if(e(this.o,i+s,i,i+(h-i)),this.o==n.o&&i<r&&(r+=s),o)this.o.set(n.o.subarray(r,r+s),i);else for(o=s,h=0;h<s;h+=a){o-=a;for(var l=0;l<a;l++)this.o[i+h+l]=n.o[r+o+l]}},i.prototype.Iz=function(i,n,r,s,o,a){if(this.Pb)throw t.i.Hb();if(0>a&&(a=this.size),this.size+2*s>this.o.length?this.resize(this.size+2*s):this.size+=2*s,e(this.o,i+2*s,i,i+(a-i)),o)for(o=0;o<s;o++)a=n[r++],this.o[i++]=a.x,this.o[i++]=a.y;else{o=0;for(var h=s-1;o<s;++o)a=n[r+h],this.o[i++]=a.x,this.o[i++]=a.y,h--}},i.prototype.Ln=function(i,n,r,s){if(this.Pb)throw t.i.Hb();for(s-=i,e(this.o,i+s,i,i+s),s=0;s<r;s++)this.o[i+s]=n},i.prototype.vj=function(i,n,r){if(this.Pb)throw t.i.Hb();e(this.o,i+2,i,i+(r-i)),this.o[i]=n.x,this.o[i+1]=n.y},i.prototype.Ut=function(e,i,n,r,s,o){if(0>e||0>i||0>r)throw t.i.N();if(!s&&(0>=o||0!=i%o))throw t.i.N();if(n.size<r+i)throw t.i.N();if(0!=i)if(this.size<i+e&&this.resize(i+e),n==this)this.Ar(e,i,r,s,o);else if(s)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r++;else if(r=r+i-o,1==o)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r--;else for(s=0,i=t.O.truncate(i/o);s<i;s++){for(var a=0;a<o;a++)this.o[e+a]=n.o[r+a];e+=o,r-=o}},i.prototype.En=function(i,n,r){if(this.Pb)throw t.i.Hb();if(i+n>this.size)throw t.i.Hb();0<r-(i+n)&&e(this.o,i,i+n,i+(r-(i+n))+n),this.size-=n},i.prototype.ni=function(e,i,n){if(this.Pb)throw t.i.Hb();if(1>n||0!=i%n)throw t.i.Hb();for(var r=i>>1,s=0;s<r;s+=n){i-=n;for(var o=0;o<n;o++){var a=this.o[e+s+o];this.o[e+s+o]=this.o[e+i+o],this.o[e+i+o]=a}}},i.prototype.Wj=function(e,i,n){if(0>i||0>n||0>i||n+i>this.size)throw t.i.N();for(var r=i;r<i+n;r++)this.o[r]=e},i.prototype.Ar=function(e,i,n,r,s){if(!(r&&e==n||(this.o.set(this.o.subarray(n,n+i),e),r)))for(n=e,e=e+i-s,r=0,i=t.O.truncate(i/2);r<i;r++){for(var o=0;o<s;o++){var a=this.o[n+o];this.o[n+o]=this.o[e+o],this.o[e+o]=a}n+=s,e-=s}},i.prototype.vC=function(e,i,n,r,s){if(0>e||0>i||0>r)throw t.i.N();if(0!=i)for(this.size<(i<<1)+e&&this.resize((i<<1)+e),s||(e+=i-1<<1),s=s?2:-2,i+=r;r<i;r++)this.o[e]=n[r].x,this.o[e+1]=n[r].y,e+=s},i.prototype.Vw=function(e,i,n,r,s){if(0>e||0>i||0>r||this.size<i+e)throw t.i.N();if(s)for(s=0;s<i;s++)n[r+s]=this.o[e+s];else for(r=r+i-1;e<i;e++)n[r]=this.o[e],r--},i.prototype.clear=function(t){t?this.resize(0):this.Bh(0)},i.prototype.ix=function(){this.pk=this.Pb=!0},i.prototype.Vd=function(t,e,n){10>e-t?i.rG(this.o,t,e,n):i.qB(this.o,t,e-1,n)},i.prototype.Tp=function(){return 2},i.prototype.Fc=function(){return this.o[this.size-1]},i.prototype.If=function(){this.resize(this.size-1)},i.prototype.bX=function(t){this.o[this.size-1]=t},i.prototype.SV=function(t){t<this.size-1&&(this.o[t]=this.o[this.size-1]),this.resize(this.size-1)},i.prototype.lF=function(t){for(var e=0,i=this.size;e<i;e++)if(this.o[e]==t)return e;return-1},i.prototype.hG=function(t){return 0<=this.lF(t)},i.rG=function(t,e,i,n){for(var r=e;r<i;r++){for(var s=t[r],o=r-1;o>=e&&0<n(t[o],s);)t[o+1]=t[o],o--;t[o+1]=s}},i.tx=function(t,e,i){var n=t[i];t[i]=t[e],t[e]=n},i.qB=function(t,e,n,r){if(!(e>=n))for(;;){if(9>n-e){i.rG(t,e,n+1,r);break}var s=t[e];i.tx(t,e,n);for(var o=e,a=e;a<n;a++)0>=r(t[a],s)&&(i.tx(t,o,a),o+=1);i.tx(t,o,n),o-e<n-o?(i.qB(t,e,o-1,r),e=o+1):(i.qB(t,o+1,n,r),n=o-1)}},i}();t.ia=i}(X||(X={})),function(t){function e(t,e,i,n){i=new Int8Array(t.subarray(i,n)),t.set(i,e)}var i=function(){function i(t){this.o=null;var e=t;2>e&&(e=2),this.o=new Int8Array(e),this.size=t}return i.prototype.rotate=function(e,i,n){if(this.Pb)throw t.i.fa("invalid_call");if(i<e||i>n||e>n)throw t.i.N();e!=i&&n!=i&&(this.ni(e,i-e,1),this.ni(i,n-i,1),this.ni(e,n-e,1))},i.qf=function(t,e){var n=new i(t),r=n.o;if(2>t&&(t=2),0!==e)for(var s=0;s<t;s++)r[s]=e;return n},i.Bn=function(t){var e=new i(0);return e.o=new Int8Array(t.o),e.size=t.size,e},i.Lr=function(t,e){var n=new i(0);return n.size=t.size,n.size>e&&(n.size=e),2>(e=n.size)&&(e=2),n.o=new Int8Array(e),n.o.set(t.o.length<=e?t.o:t.o.subarray(0,e),0),n},i.prototype.Jb=function(t){0>=t||(null==this.o?this.o=new Int8Array(t):t<=this.o.length||(0<this.o.length?((t=new Int8Array(t)).set(this.o),this.o=t):this.o=new Int8Array(t)))},i.prototype.read=function(t){return this.o[t]},i.prototype.tc=function(t,e){e.x=this.o[t],e.y=this.o[t+1]},i.prototype.get=function(t){return this.o[t]},i.prototype.write=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.set=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i},i.prototype.Tt=function(e,i){if(this.Pb)throw t.i.Hb();this.o[e]=i.x,this.o[e+1]=i.y},i.prototype.add=function(t){this.resize(this.size+1),this.o[this.size-1]=t},i.prototype.GB=function(t){return i.Lr(this,t)},i.prototype.eg=function(t){return this.read(t)},i.prototype.resize=function(e,i){if(void 0===i&&(i=0),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");if(e<=this.size){if(30<this.o.length&&5*e/4<this.o.length){var n=new Int8Array(this.o,0,e);this.o=n}}else{e>this.o.length&&(n=t.O.truncate(64>e?Math.max(2*e,4):5*e/4),(n=new Int8Array(n)).set(this.o),this.o=n),n=this.o;for(var r=this.size;r<e;r++)n[r]=i}this.size=e},i.prototype.Bh=function(e){if((null==this.o||e>this.o.length)&&this.resize(e),this.pk)throw t.i.fa("invalid call. Attribute Stream is locked and cannot be resized.");this.size=e},i.prototype.pr=function(t,e){this.write(t,e)},i.prototype.An=function(e,i,n){for(var r=this.size;i<r&&i<n;i++)e=t.O.Th(this.read(i),e);return e},i.prototype.Nb=function(t,e,n){if(null==t||!(t instanceof i))return!1;var r=this.size,s=t.size;if(n>r||n>s&&r!=s)return!1;for(n>r&&(n=r);e<n;e++)if(this.read(e)!=t.read(e))return!1;return!0},i.prototype.addRange=function(e,i,n,r,s){if(this.Pb)throw t.i.Hb();if(!r&&(1>s||0!=n%s))throw t.i.N();var o=this.size;if(this.resize(o+n),r)this.o.set(e.o.subarray(i,i+n),o);else{r=n;for(var a=0;a<n;a+=s){r-=s;for(var h=0;h<s;h++)this.o[o+a+h]=e.o[i+r+h]}}},i.prototype.Mn=function(i,n,r,s,o,a,h){if(this.Pb)throw t.i.Hb();if(!o&&(1>a||0!=s%a))throw t.i.N();if(e(this.o,i+s,i,i+(h-i)),this.o==n.o&&i<r&&(r+=s),o)this.o.set(n.o.subarray(r,r+s),i);else for(o=s,h=0;h<s;h+=a){o-=a;for(var l=0;l<a;l++)this.o[i+h+l]=n.o[r+o+l]}},i.prototype.Ln=function(i,n,r,s){if(this.Pb)throw t.i.Hb();for(s-=i,e(this.o,i+s,i,i+s),s=0;s<r;s++)this.o[i+s]=n},i.prototype.Iz=function(i,n,r,s,o,a){if(this.Pb)throw t.i.Hb();if(0>a&&(a=this.size),this.size+2*s>this.o.length?this.resize(this.size+2*s):this.size+=2*s,e(this.o,i+2*s,i,i+(a-i)),o)for(o=0;o<s;o++)a=n[r++],this.o[i++]=a.x,this.o[i++]=a.y;else{o=0;for(var h=s-1;o<s;++o)a=n[r+h],this.o[i++]=a.x,this.o[i++]=a.y,h--}},i.prototype.vj=function(i,n,r){if(this.Pb)throw t.i.Hb();e(this.o,i+2,i,i+(r-i)),this.o[i]=n.x,this.o[i+1]=n.y},i.prototype.Ut=function(e,i,n,r,s,o){if(0>e||0>i||0>r)throw t.i.N();if(!s&&(0>=o||0!=i%o))throw t.i.N();if(n.size<r+i)throw t.i.N();if(0!=i)if(this.size<i+e&&this.resize(i+e),n==this)this.Ar(e,i,r,s,o);else if(s)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r++;else if(r=r+i-o,1==o)for(s=0;s<i;s++)this.o[e]=n.o[r],e++,r--;else for(s=0,i=t.O.truncate(i/o);s<i;s++){for(var a=0;a<o;a++)this.o[e+a]=n.o[r+a];e+=o,r-=o}},i.prototype.En=function(i,n,r){if(this.Pb)throw t.i.Hb();if(i+n>this.size)throw t.i.Hb();0<r-(i+n)&&e(this.o,i,i+n,i+(r-(i+n))+n),this.size-=n},i.prototype.ni=function(e,i,n){if(this.Pb)throw t.i.Hb();if(1>n||0!=i%n)throw t.i.Hb();for(var r=i>>1,s=0;s<r;s+=n){i-=n;for(var o=0;o<n;o++){var a=this.o[e+s+o];this.o[e+s+o]=this.o[e+i+o],this.o[e+i+o]=a}}},i.prototype.Wj=function(e,i,n){if(0>i||0>n||0>i||n+i>this.size)throw t.i.N();for(var r=i;r<i+n;r++)this.o[r]=e},i.prototype.Ar=function(e,i,n,r,s){if(!(r&&e==n||(this.o.set(this.o.subarray(n,n+i),e),r)))for(n=e,e=e+i-s,r=0,i=t.O.truncate(i/2);r<i;r++){for(var o=0;o<s;o++){var a=this.o[n+o];this.o[n+o]=this.o[e+o],this.o[e+o]=a}n+=s,e-=s}},i.prototype.vC=function(e,i,n,r,s){if(0>e||0>i||0>r)throw t.i.N();if(0!=i)for(this.size<(i<<1)+e&&this.resize((i<<1)+e),s||(e+=i-1<<1),s=s?2:-2,i+=r;r<i;r++)this.o[e]=n[r].x,this.o[e+1]=n[r].y,e+=s},i.prototype.Vw=function(e,i,n,r,s){if(0>e||0>i||0>r||this.size<i+e)throw t.i.N();if(s)for(s=0;s<i;s++)n[r+s]=this.o[e+s];else for(r=r+i-1;e<i;e++)n[r]=this.o[e],r--},i.prototype.clear=function(t){t?this.resize(0):this.Bh(0)},i.prototype.ix=function(){this.pk=this.Pb=!0},i.prototype.Vd=function(t,e,i){e=this.o.subarray(t,e),Array.prototype.sort.call(e,i),this.o.set(e,t)},i.prototype.zJ=function(e,i){if(this.Pb)throw t.i.fa("invalid call. Attribute Stream is read only.");this.o[e]|=i},i.prototype.KE=function(e,i){if(this.Pb)throw t.i.fa("invalid call. Attribute Stream is read only.");this.o[e]&=~i},i.prototype.Tp=function(){return 1},i}();t.pn=i}(X||(X={})),function(t){t.Yc=function(){function e(){}return e.Mr=function(e,i){return t.pn.qf(e,i)},e.Dn=function(e,i){return t.be.qf(e,i)},e.pP=function(e,i,n){switch(e){case 1:e=t.be.qf(i,n);break;case 2:e=t.ia.qf(i,n);break;case 4:e=t.pn.qf(i,n);break;default:throw t.i.Qa()}return e},e.YE=function(i,n){return e.pP(t.ra.Tp(i),n*t.ra.Va(i),t.ra.se(i))},e.Oh=function(e,i){return t.ia.qf(e,i)},e.qI=function(t){var e,i=[];for(e=0;e<t;e++)i.push(null);return i},e}()}(X||(X={})),function(t){t.ga=function(t){void 0===t&&(t=0),this.u=t}}(X||(X={})),function(t){t.NL=function(){function e(){}return e.bind=function(e){t.Sc=e.PeDefs,t.pf=e.PeFactory,t.NC=e.PeVertcs,t.ej=e.PeCSTransformations,t.MC=e.PeGTTransformations,t.LL=e.PeGeogtran,t.KL=e.PeFactoryCodechange,t.LC=e.PeGCSExtent,t.Cg=e.PePCSInfo,t.ML=e.PeHorizon,t.JL=e.PeCoordsys,t.lp=e.PeGTlistExtended,t.lp.PE_GTLIST_OPTS_USE_DEFAULT=128,t.pf.initialize(null),t.Mx=e.PeGTlistExtendedEntry,t.pf.fromString(t.Sc.PE_TYPE_UNIT,'UNIT["Meter",1.0]')},e}(),t.pf=null,t.NC=null,t.JL=null,t.ML=null,t.Cg=null,t.lp=null,t.Mx=null,t.LC=null,t.KL=null,t.LL=null,t.Sc=null,t.MC=null,t.ej=null}(X||(X={})),function(t){var e=function(){function t(){}return t.Mb=function(e,i){return 0<=i?t.P(e):-t.P(e)},t.P=function(t){return 0>t?-t:t},t.ti=function(t){return 3552713678800501e-30>t},t.KC=function(e,i,n){return t.P(e-i)<=n*(1+(t.P(e)+t.P(i))/2)},t.Y=function(e,i){return t.KC(e,i,3552713678800501e-30)},t.FL=function(e){return 3552713678800501e-30>=t.P(e)},t.Cd=function(e){return t.FL(e)},t}();t.s=e,t.F=function(){function i(){}return i.gp=function(t,i){var n=0;return 0!=(t=e.P(t))+(i=e.P(i))&&(t>i?(n=i/t,n=t*Math.sqrt(1+n*n)):(n=t/i,n=i*Math.sqrt(1+n*n))),n},i.Wq=function(t,n,r,s,o){for(var a=[0,0,0],h=[0,0,0],l=0;2>=l;l++)n[l]-=t[l],r[l]-=n[l];r=a[1]*h[2]-a[2]*h[1],n=a[2]*h[0]-a[0]*h[2],a=a[0]*h[1]-a[1]*h[0],t=-1*(r*t[0]+n*t[1]+a*t[2]),s[0]=r,s[1]=n,s[2]=a,s[3]=t,h=i.on(s),s[0]/=h,s[1]/=h,s[2]/=h,s[3]/=h,0!=o&&(h=e.Cd(a)?e.Cd(t)?e.Mb(1,n):-e.Mb(1,t):e.Mb(1,a),h*=e.Mb(1,o),s[0]*=h,s[1]*=h,s[2]*=h,s[3]*=h)},i.zx=function(t,e,i){i[0]=t[1]*e[2]-e[1]*t[2],i[1]=t[2]*e[0]-e[2]*t[0],i[2]=t[0]*e[1]-e[0]*t[1]},i.St=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.on=function(t){return i.gp(i.gp(t[0],t[1]),t[2])},i.cl=function(t,e,n,r,s,o,a,h){t=i.n(t,e,n);var l=Math.cos(n);o.u=(t+s)*l*Math.cos(r),a.u=(t+s)*l*Math.sin(r),h.u=(t*(1-e)+s)*Math.sin(n)},i.jO=function(t,n,r,s,o,a,h){var l=i.gp(n,r),c=1*Math.sqrt(1-t),u=c/1;if(e.Y(l,0))a.u=0,o.u=e.Mb(1.570796326794897,s),h.u=e.P(s)-c;else{a.u=Math.atan2(r,n),r=Math.atan2(1*s,c*l),a=Math.cos(r);var d=Math.sin(r);n=c*t/(1-t),t*=1,r=Math.atan2(s+n*d*d*d,l-t*a*a*a),3.141592653589793<e.P(r)&&(r=e.Mb(3.141592653589793,r)-r),r=Math.atan(u*Math.tan(r)),d=Math.sin(r),a=Math.cos(r),o.u=Math.atan2(s+n*d*d*d,l-t*a*a*a),1.570796326794897<e.P(o.u)&&(o.u=e.Mb(3.141592653589793,o.u)-o.u),r=Math.atan(u*Math.tan(o.u)),d=Math.sin(r),a=Math.cos(r),h.u=(s-c*d)*Math.sin(o.u)+(l-1*a)*Math.cos(o.u)}},i.n=function(t,e,i){return i=Math.sin(i),t/Math.sqrt(1-e*i*i)},i.ot=function(t,e){return Math.atan2(Math.sin(e)*(1-t),Math.cos(e))},i.Qj=function(t,e){return Math.atan2(Math.sin(e),Math.cos(e)*(1-t))},i.Rq=function(t,n){if(e.ti(t)||0==n||e.Y(e.P(n),1.570796326794897))return n;if(.006884661117170036>t){var r=Math.sqrt(1-t),s=(1-r)/(1+r),o=s*s,a=s*o,h=s*a,l=s*h,c=s*l,u=s*c,d=1.572916666666667*a-3.2578125*l+4.295068359375*u;t=2.142578125*h-6.071484375*c,r=3.129296875*l-11.249837239583334*u;var f=4.775276692708333*c,p=7.958636765252976*u,g=Math.cos(2*n);return n+Math.sin(2*n)*(1.5*s-.84375*a+.525390625*l-.2688395182291667*u-d+r-p+g*(2*(1.3125*o-1.71875*h+1.650146484375*c)-4*t+6*f+g*(4*d-12*r+24*p+g*(8*t-32*f+g*(16*r-80*p+g*(32*f+64*g*p))))))}for(r=1-t,s=t/2,a=(o=e.P(n))*i.Zu(t)/(1.570796326794897*r),h=9999,c=o,o=0;1e-16<h&&50>o;o++)u=i.w(t,c),l=c-(d=(l=(i.kG(c,t)-s*Math.sin(2*c)/u)/r-a)/(u=1/(u*u*u))),h=e.P(d),c=l;return 0<=n?c:-c},i.qW=function(t,n){return e.ti(n)?t:t*i.Zu(n)/1.570796326794897},i.ba=function(t){return 0>(t=i.pF(t,6.283185307179586))?t+6.283185307179586:3.141592653589793>e.P(t)||e.Y(e.P(t),3.141592653589793)?t:t-6.283185307179586},i.pF=function(t,e){return t-Math.floor(t/e)*e},i.Ah=function(t,e){if(.006884661117170036>e){var n=(e=(1-(e=Math.sqrt(1-e)))/(1+e))*e,r=n*n;return t/(1+e)*(1+.25*n+.015625*r+.00390625*n*r)*1.570796326794897}return t*i.Zu(e)},i.Vq=function(t,n){var r=e.Mb(1,Math.sin(n));return n=1.570796326794897>=(n=e.P(i.pF(n,3.141592653589793)))?n:3.141592653589793-n,(e.Y(n,1.570796326794897)?n:Math.atan(Math.sqrt(1-t)*Math.tan(n)))*r},i.q=function(t,e,n){if(.006884661117170036>e){var r=(e=(1-(e=Math.sqrt(1-e)))/(1+e))*e,s=e*r,o=e*s,a=e*o,h=e*a,l=e*h,c=-.7291666666666666*s+.2278645833333333*a+.03987630208333334*l,u=.615234375*o-.21533203125*h,d=-.54140625*a+.20302734375*l,f=.48876953125*h,p=-.4488699776785715*l,g=Math.cos(2*n);return t/(1+e)*((1+.25*r+.015625*o+.00390625*h)*n+Math.sin(2*n)*(-1.5*e+.1875*s+.0234375*a+.00732421875*l-c+d-p+g*(2*(.9375*r-.234375*o-.03662109375*h)-4*u+6*f+g*(4*c-12*d+24*p+g*(8*u-32*f+g*(16*d-80*p+g*(32*f+64*g*p)))))))}return t*(i.kG(n,e)-.5*e*Math.sin(2*n)/i.w(e,n))},i.w=function(t,e){return e=Math.sin(e),Math.sqrt(1-t*e*e)},i.Zu=function(t){return e.KC(t,1,2220446049250313e-31)?1:1>t?i.Xw(0,1-t)-t/3*i.Uw(0,1-t):NaN},i.kG=function(n,r){var s=e.Mb(1,n);n=e.P(n);var o=Math.floor(n/1.570796326794897);if(1<r)r=0==n?0:NaN;else if(e.Cd(o))r=(n=i.sin(n))*i.Xw(1-n*n,1-r*n*n)-r/3*n*n*n*i.Uw(1-n*n,1-r*n*n);else{var a=t.O.truncate(o%2),h=i.Zu(r);0<a?(n=1.570796326794897*(o+1)-n,r=h*(o+1)-(r=(n=Math.sin(n))*i.Xw(1-n*n,1-r*n*n)-r/3*n*n*n*i.Uw(1-n*n,1-r*n*n))):(n-=1.570796326794897*o,r=h*o+(r=(n=Math.sin(n))*i.Xw(1-n*n,1-r*n*n)-r/3*n*n*n*i.Uw(1-n*n,1-r*n*n)))}return r*s},i.sin=function(t){t=i.ba(t);var n=e.Mb(1,t);return t=e.P(t),e.Y(t,3.141592653589793)?0:e.Y(t,1.570796326794897)?1*n:Math.sin(t)*n},i.Uw=function(t,i){var n,r,s,o,a=t,h=i,l=1;for(i=0,t=1;r=((n=.2*(a+h+3*l))-a)/n,s=(n-h)/n,o=(n-l)/n,!(1e-4>e.P(r)&&1e-4>e.P(s)&&1e-4>e.P(o));)o=Math.sqrt(h),i+=t/((n=Math.sqrt(l))*(l+(o=Math.sqrt(a)*(o+n)+o*n))),t*=.25,a=.25*(a+o),h=.25*(h+o),l=.25*(l+o);return h=(a=r*s)-(l=o*o),3*i+t*(1+(l=a-6*l)*(.10227272727272728*l-.2142857142857143-.1730769230769231*o*(r=l+h+h))+o*(.1666666666666667*r+o*(-.4090909090909091*h+.1153846153846154*o*a)))/(n*Math.sqrt(n))},i.Xw=function(t,i){for(var n,r,s,o,a=1;r=2-((n=(t+i+a)/3)+t)/n,s=2-(n+i)/n,o=2-(n+a)/n,!(1e-4>e.P(r)&&1e-4>e.P(s)&&1e-4>e.P(o));a=.25*(a+n))n=Math.sqrt(i),r=Math.sqrt(a),t=.25*(t+(n=Math.sqrt(t)*(n+r)+n*r)),i=.25*(i+n);return(1+(.04166666666666666*(t=r*s-o*o)-.1-.06818181818181818*(i=r*s*o))*t+.07142857142857142*i)/Math.sqrt(n)},i.Qw=function(t,i){if(e.ti(t)||0==i||e.Y(e.P(i),1.570796326794897))return i;if(.006884661117170036>t){var n=t*t,r=t*n,s=t*r,o=t*s,a=t*o,h=t*a,l=-(.02708333333333333*r+.03430059523809524*s+.03149181547619048*o+.02634359154541446*a+.02156896735835538*h),c=.007669890873015873*s+.01299603174603175*o+.0148051353064374*a+.01454454953803912*h,u=-(.002275545634920635*o+.004830845032667949*a+.006558395368616723*h),d=.0006957236677288761*a+.001775193002406544*h,f=-.000217324089394402*h,p=Math.cos(2*i);return i+Math.sin(2*i)*(-(.5*t+.2083333333333333*n+.09375*r+.04878472222222222*s+.02916666666666667*o+.01938905423280423*a+.01388255931712963*h)-l+u-f+p*(2*(.1041666666666667*n+.0875*r+.06050347222222222*s+.04151785714285714*o+.02958958540013228*a+.02203667534722222*h)-4*c+6*d+p*(4*l-12*u+24*f+p*(8*c-32*d+p*(16*u-80*f+p*(32*d+64*p*f))))))}return 0==i||e.Y(e.P(i),1.570796326794897)?n=i:(s=(r=Math.sqrt(t))*Math.sin(i),n=Math.tan(.7853981633974483+i/2)*Math.pow((1-s)/(1+s),r/2),n=2*Math.atan(n)-1.570796326794897),n},i.yO=function(t,i){if(e.ti(t)||0==i||e.Y(e.P(i),1.570796326794897))return i;if(.006884661117170036>t){var n=t*(d=t*(u=t*(p=t*t))),r=t*(f=t*n),s=.05833333333333333*u+.07232142857142858*d+.05634300595238095*n+.0355325796406526*f+.020235546186067*r,o=.02653149801587302*d+.04379960317460317*n+.0429211791776896*f+.03255384637546096*r,a=.01294022817460318*n+.02668104344536636*f+.03155651254609588*r,h=.00659454790965208*f+.0163075268674227*r,l=.003463473736911237*r,c=Math.cos(2*i);return i+Math.sin(2*i)*(.5*t+.2083333333333333*p+.08333333333333333*u+.03611111111111111*d+.01875*n+.01195601851851852*f+.008863673941798942*r-s+a-l+c*(2*(.1458333333333333*p+.1208333333333333*u+.07039930555555556*d+.03616071428571429*n+.01839451058201058*f+.01017113095238095*r)-4*o+6*h+c*(4*s-12*a+24*l+c*(8*o-32*h+c*(16*a-80*l+c*(32*h+64*c*l))))))}var u=Math.sqrt(t),d=u/2,f=Math.tan(.7853981633974483+i/2);t=0,s=1;for(var p=i;0!=s;p=r)n=u*Math.sin(p),r=f*Math.pow((1+n)/(1-n),d),r=2*Math.atan(r)-1.570796326794897,t++,(e.Y(r,p)||3e4<t)&&(s=0);return p},i}()}(X||(X={})),function(t){var e=function(){function e(e){this.ul=this.Us=null,this.Iv=!1,this.GA=this.HA=0,this.HH=new t.h,this.XH=new t.h,this.KA=!1,this.vq=new t.l,this.wH=this.sw=0,this.tw=null,this.zl=!1,this.Eo=null,this.bA=0,this.Ue=e,this.As=t.zb.xv(this.Ue,0,!0),this.HH.Rc(),this.XH.Rc(),this.RH=NaN;var i=e.getCode();0<i?(this.Kk=i,t.pf.getCode(e)):this.Kk=t.pf.getCode(e),0>this.Kk&&(this.Kk=0);var n=this.Ue.getType();if(this.jH=n==t.Sc.PE_TYPE_PROJCS?2:1,n==t.Sc.PE_TYPE_PROJCS&&!e.loadConstants())throw t.i.N("PeProjcs.loadConstants failed");i=n==t.Sc.PE_TYPE_GEOGCS?this.Ue:this.Ue.getGeogcs(),n!=t.Sc.PE_TYPE_GEOGCS&&t.pf.getCode(i),this.Eo=e.getUnit(),this.RH=i.getPrimem().getLongitude(),this.wH=e=i.getUnit().getUnitFactor(),e=Math.PI/(180*e),1e-10>Math.abs(e-1)&&(e=1),this.GA=e,n&t.Sc.PE_TYPE_PROJCS?(i=this.Ue,this.HA=1/i.getUnit().getUnitFactor(),this.sw=.001/this.Ue.getUnit().getUnitFactor(),this.tw=t.Cg.generate(i,t.Cg.PE_PCSINFO_OPTION_NONE),this.zl=this.tw.isPannableRectangle(),this.bA=t.zb.qN(this.tw.getCentralMeridian(),this.GA)):(this.KA=this.zl=!0,this.HA=0,n=1/i.getUnit().getUnitFactor(),this.sw=.001/i.getDatum().getSpheroid().getAxis()*n,this.bA=0),this.zl&&(this.xx(),this.DK(),this.nY(),this.CK(),this.lY(),this.mY())}return e.prototype.$r=function(){return this.Kk},e.prototype.kk=function(){return this.tw},e.Py=function(t,e){return t==e||null!=t&&null!=e&&0==t.Kk&&0==e.Kk&&t.As===e.As},e.prototype.Wc=function(){return this.zl},e.prototype.gh=function(t){t.K(this.so)},e.prototype.pv=function(){return this.so.v},e.prototype.ov=function(){return this.so.C},e.prototype.GR=function(t){t.K(this.uw)},e.prototype.lY=function(){var e=this.Ue.getType();if(e==t.Sc.PE_TYPE_PROJCS){e=this.Ue;var i=this.kk().getCentralMeridian(),n=e.getGeogcs();if(null==n)throw t.i.fa("internal error");i=[[i+(n=1/n.getUnit().getUnitFactor()*Math.PI),0]],t.ej.geogToProj(e,1,i),i=i[0][0],n=e.getParameters()[t.Sc.PE_PARM_X0].getValue();var r=this.ml();e=new t.l,r.A(e),i=(r=Math.abs(i-n))+n,n=-1*r+n,r=e.H,e=e.G;var s=new t.l;s.K(n,e,i,r),null==this.so&&(this.so=s)}else{if(e!=t.Sc.PE_TYPE_GEOGCS)throw t.i.fa("internal error");n=1/this.Ue.getUnit().getUnitFactor()*Math.PI,(e=new t.l).K(-n,-n/2,n,n/2),null==this.so&&(this.so=e)}},e.prototype.mY=function(){var e=this.Ue.getType();if(e==t.Sc.PE_TYPE_PROJCS){var i=this.Ue;if(e=this.kk().getCentralMeridian(),null==(i=i.getGeogcs()))throw t.i.fa("internal error");i=1/i.getUnit().getUnitFactor()*Math.PI;var n=this.Vr(),r=new t.l;n.A(r),(n=new t.l).K(e-i,r.G,e+i,r.H),null==this.uw&&(this.uw=n)}else{if(e!=t.Sc.PE_TYPE_GEOGCS)throw t.i.fa("internal error");i=1/this.Ue.getUnit().getUnitFactor()*Math.PI,(e=new t.l).K(-i,-i/2,i,i/2),null==this.uw&&(this.uw=e)}},e.prototype.bf=function(){return this.GA},e.prototype.pm=function(){return this.HA},e.prototype.Vr=function(){if(this.zl)return this.ul;var t=this.ul;return null!=t?t:(this.xx(),this.ul)},e.prototype.Wr=function(){return this.zl?null:(null!=this.ul||this.xx(),this.YG)},e.prototype.xx=function(){if(this.Ue.getType()==t.Sc.PE_TYPE_PROJCS){var e=this.Ue,i=e.getGeogcs(),n=e.horizonGcsGenerate();if(null!=n){var r=n[0].getNump(),s=n[0].getKind();e=0<n[0].getInclusive();var o=this.bf(),a=90*o,h=360*o,l=370*o,c=180*o*t.Sc.PE_HORIZON_DELTA/Math.PI,u=new t.l,d=null;if(1<r)for(var f=1;f<r;f++)if(n[f].getKind()==t.Sc.PE_HORIZON_LINE){null==d&&(d=new t.Ta);var p=n[f].getCoord();d.sx(p[0][0],p[0][1]),d.yj(p[1][0],p[1][1])}if(s==t.Sc.PE_HORIZON_RECT)n=n[0].getCoord(),u.K(n[0][0],n[0][1]),u.Zb(n[1][0],n[1][1]),Math.abs(u.H-a)<1e-7*c&&(u.H=a),Math.abs(u.G+a)<1e-7*c&&(u.G=-a),u.R()>l&&(n=-400*o,u.K(n,u.G,n+5*h,u.H)),n=new t.Fh(u),null==this.ul&&(this.ul=n,this.Iv=e);else{if(l=new t.Da,h=this.kk().isGcsHorizonMultiOverlap(),u=t.gu.bF(i,t.hu.Integer64),h){for(l=new t.gL,c=t.Gh.local().V(l,u,null),f=0;f<r;f++)if(n[f].getKind()==t.Sc.PE_HORIZON_POLY){for(i=n[f].getSize(),o=n[f].getCoord(),s=[],a=0;a<i;a++)s[a]=t.h.construct(o[a][0],o[a][1]);n[f].getInclusive(),h&&((o=new t.Da).Yk(s,i-1),l.ZX(o),c.qe())}l=c.next()}else for(f=0;f<r;f++)if(n[f].getKind()==t.Sc.PE_HORIZON_POLY){for(i=n[f].getSize(),o=n[f].getCoord(),h=[],a=0;a<i;a++)h[a]=t.h.construct(o[a][0],o[a][1]);n[f].getInclusive(),l.Yk(h,i-1)}e?t.Xj.local().wn(l,u,1):t.kp.local().wn(l,u,1),t.dj.local().wn(l,u,1),null==this.ul&&(this.ul=l,this.Iv=e,this.YG=d)}}}},e.prototype.hv=function(){return this.zl||null==this.ul&&this.xx(),this.Iv},e.prototype.DK=function(){if(2==this.jH){var e=this.Ue.horizonPcsGenerate();if(null!=e){var i=e[0].getKind();e[0].getInclusive();var n=e[0].getNump(),r=!1;if(i==t.Sc.PE_HORIZON_RECT)e=e[0].getCoord(),(n=new t.l).K(e[0][0],e[0][1]),n.Zb(e[1][0],e[1][1]),e=new t.Fh(n);else{for(i=-1,r=0;r<n;r++)e[r].getKind()==t.Sc.PE_HORIZON_POLY&&(i=r);for(r=e[i].getSize()-1,e=e[i].getCoord(),n=[],i=0;i<r;i++)n[i]=t.h.construct(e[i][0],e[i][1]);e=i=new t.Da,i.Yk(n,r),r=!0}this.kk().isDensificationNeeded()&&(n=1e5*this.pm(),e=t.Xl.local().V(e,n,null)),r&&(r=new t.Fh,e.bn(r),e.Ke(),e.Qb(),e.qR(),t.Xj.local().wn(e,null,1)),null==this.Us&&(this.Us=e)}}},e.prototype.ml=function(){if(this.zl)return this.Us;var t=this.Us;return null!=t?t:(this.DK(),this.Us)},e.prototype.nY=function(){if(this.Ue.getType()==t.Sc.PE_TYPE_PROJCS){var e=90*this.bf();e=[[0,e],[0,-e]],t.ej.geogToProj(this.Ue,2,e);var i=this.kk(),n=i.getNorthPoleLocation()!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY;i=i.getSouthPoleLocation()!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY,this.KA||(n&&this.HH.ma(e[0][0],e[0][1]),i&&this.XH.ma(e[1][0],e[1][1]))}this.KA=!0},e.prototype.CK=function(){if(1==this.jH){var e=400*this.bf();this.vq.K(-e,-e,e,e)}else e=t.Cg.generate(this.Ue,t.Cg.PE_PCSINFO_OPTION_DOMAIN),e=t.l.construct(e.getDomainMinx(),e.getDomainMiny(),e.getDomainMaxx(),e.getDomainMaxy()),this.vq.B()&&this.vq.K(e)},e.prototype.hR=function(t){this.zl&&t.K(this.vq),this.vq.B()&&this.CK(),t.K(this.vq)},e.prototype.Up=function(){return this.RH},e.prototype.zi=function(){return this.bA},e.prototype.Hd=function(){return this.Eo},e.prototype.Xr=function(){return this.wH},e}();t.OC=e}(X||(X={})),function(t){var e=function(){function e(e){this.KT=e,this.As=t.zb.xv(e,0,!0);var i=e.getCode();this.ss=0<i?i:t.pf.getCode(e),0>this.ss&&(this.ss=0),this.Eo=i=this.KT.getUnit(),this.IH=1/i.getUnitFactor(),t.pf.getCode(e)}return e.Py=function(t,e){return t==e||null!=t&&null!=e&&0==t.ss&&0==e.ss&&t.As===e.As},e.prototype.$r=function(){return this.ss},e}();t.PL=e}(X||(X={})),function(t){t.Yg=function(){function e(){}return e.tb=function(e,i,n,r,s,o,a,h){if(null!=o||null!=a||null!=h){r=t.F.ba(r),i=t.F.ba(i),n=t.F.ba(n),s=t.F.ba(s),1.570796326794897<t.s.P(n)&&(n=t.s.Mb(3.141592653589793,n)-n,i=t.F.ba(i+3.141592653589793)),1.570796326794897<t.s.P(s)&&(s=t.s.Mb(3.141592653589793,s)-s,r=t.F.ba(r+3.141592653589793));var l=t.F.ba(r-i);if(t.s.Y(n,s)&&(t.s.Y(i,r)||t.s.Y(t.s.P(n),1.570796326794897)))null!=o&&(o.u=0),null!=a&&(a.u=0),null!=h&&(h.u=0);else{if(t.s.Y(n,-s)){if(t.s.Y(t.s.P(n),1.570796326794897))return null!=o&&(o.u=3.141592653589793*e),null!=a&&(a.u=0<n?t.F.ba(3.141592653589793-t.F.ba(r)):t.F.ba(r)),void(null!=h&&(h.u=0<n?t.F.ba(r):t.F.ba(3.141592653589793-t.F.ba(r))));if(t.s.Y(t.s.P(l),3.141592653589793))return null!=o&&(o.u=3.141592653589793*e),null!=a&&(a.u=0),void(null!=h&&(h.u=0))}var c=1.570796326794897==t.s.P(n)?0:Math.cos(n),u=Math.sin(n),d=1.570796326794897==t.s.P(s)?0:Math.cos(s),f=Math.sin(s),p=1.570796326794897==t.s.P(l)?0:Math.cos(l),g=3.141592653589793==t.s.P(l)?0:Math.sin(l);if(null!=o){var v=Math.sin((s-n)/2);l=Math.sin(l/2),o.u=2*Math.asin(Math.sqrt(v*v+c*d*l*l))*e}null!=a&&(a.u=t.s.Y(t.s.P(n),1.570796326794897)?0>n?r:t.F.ba(3.141592653589793-r):Math.atan2(d*g,c*f-u*d*p)),null!=h&&(t.s.Y(t.s.P(s),1.570796326794897)?h.u=0>s?i:t.F.ba(3.141592653589793-i):(h.u=Math.atan2(c*g,f*c*p-d*u),h.u=t.F.ba(h.u+3.141592653589793)))}}},e.rf=function(e,i,n,r,s,o,a){if(null!=o||null!=a){i=t.F.ba(i),n=t.F.ba(n),1.570796326794897<t.s.P(n)&&(n=t.s.Mb(3.141592653589793,n)-n,i=t.F.ba(i+3.141592653589793)),t.s.Y(t.s.P(n),1.570796326794897)&&(i=0),s=t.F.ba(s);var h=t.s.Y(t.s.P(s),1.570796326794897)?0:Math.cos(s),l=t.s.Y(t.s.P(s),3.141592653589793)?0:Math.sin(s),c=t.s.Y(t.s.P(n),1.570796326794897)?0:Math.cos(n),u=Math.sin(n);e=r/e,r=t.s.Y(t.s.P(e),1.570796326794897)?0:Math.cos(e);var d=t.s.Y(t.s.P(e),3.141592653589793)?0:Math.sin(e),f=Math.asin(u*r+c*d*h);null!=a&&(a.u=f),null!=o&&(o.u=t.s.Y(t.s.P(f),1.570796326794897)?t.s.Y(n,-f)?0>f?s:t.F.ba(3.141592653589793-s):i:t.s.Y(t.s.P(n),1.570796326794897)&&t.s.Y(e,3.141592653589793)?0>n?s:t.F.ba(3.141592653589793-s):t.F.ba(i+Math.atan2(d*l,c*r-u*d*h)))}},e}()}(X||(X={})),function(t){t.Wk=function(){function e(){}return e.tb=function(e,i,n,r,s,o,a,h,l){var c=new t.ga(0),u=new t.ga(0),d=[0,0,0],f=[0,0,0],p=[0,0,0],g=new t.ga(0),v=new t.ga(0),m=new t.ga(0),y=new t.ga(0),_=new t.ga(0);if(null!=a||null!=h||null!=l)if(t.s.ti(i))t.Yg.tb(e,n,r,s,o,a,h,l);else{s=t.F.ba(s),n=t.F.ba(n);var b=t.F.ba(s-n);if(t.s.Y(r,o)&&(t.s.Y(n,s)||t.s.Y(t.s.P(r),1.570796326794897)))null!=a&&(a.u=0),null!=h&&(h.u=0),null!=l&&(l.u=0);else{if(t.s.Y(r,-o)){if(t.s.Y(t.s.P(r),1.570796326794897))return null!=a&&(a.u=2*t.F.Ah(e,i)),null!=h&&(h.u=0<r?t.F.ba(3.141592653589793-t.F.ba(s)):t.F.ba(s)),void(null!=l&&(l.u=0<r?t.F.ba(s):t.F.ba(3.141592653589793-t.F.ba(s))));t.s.Y(t.s.P(b),3.141592653589793)&&(null!=a&&(a.u=2*t.F.Ah(e,i)),null!=h&&(h.u=0),null!=l&&(l.u=0))}else(t.s.Y(t.s.P(r),1.570796326794897)||t.s.Y(t.s.P(o),1.570796326794897))&&(t.s.Y(t.s.P(r),1.570796326794897)?n=s:s=n);var w=0;if(0>b){w=1;var x=n;n=s,s=x,x=r,r=o,o=x}b=t.F.ot(i,r);var T=t.F.ot(i,o);null==h&&null==l||(t.Yg.tb(e,n,b,s,T,null,c,u),c=Math.atan2(Math.sin(c.u)*Math.cos(r-b),Math.cos(c.u)),u=Math.atan2(Math.sin(u.u)*Math.cos(o-T),Math.cos(u.u)),0!=w&&(x=c,c=u,u=x),null!=h&&(h.u=c),null!=l&&(l.u=u)),null!=a&&(t.F.cl(1,i,r,n,0,m,y,_),d[0]=m.u,d[1]=y.u,d[2]=_.u,t.F.cl(1,i,o,s,0,m,y,_),f[0]=m.u,f[1]=y.u,f[2]=_.u,p[0]=d[1]*f[2]-f[1]*d[2],p[1]=-(d[0]*f[2]-f[0]*d[2]),p[2]=d[0]*f[1]-f[0]*d[1],i=1-t.F.w(i,t.F.Vq(i,t.F.Qj(i,Math.acos(p[2]/Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2]))))),i*=2-i,h=Math.atan2(-p[1],-p[0]),p=t.F.ba(h-1.570796326794897),h=t.F.ba(h+1.570796326794897),p=t.s.P(t.F.ba(n-p))<=t.s.P(t.F.ba(n-h))?p:h,t.Yg.tb(1,p,0,n,b,g,null,null),t.Yg.tb(1,p,0,s,T,v,null,null),3.141592653589793<g.u+v.u&&(p=t.F.ba(p+3.141592653589793),t.Yg.tb(1,p,0,n,b,g,null,null),t.Yg.tb(1,p,0,s,T,v,null,null)),g.u*=t.s.Mb(1,r),v.u*=t.s.Mb(1,o),g.u=t.F.Qj(i,g.u),v.u=t.F.Qj(i,v.u),n=t.F.q(e,i,g.u),e=t.F.q(e,i,v.u),a.u=t.s.P(e-n))}}},e.rf=function(e,i,n,r,s,o,a,h){var l=0,c=new t.ga(0),u=new t.ga(0),d=[0,0,0],f=[0,0,0],p=new t.ga(0),g=new t.ga(0),v=new t.ga(0);if(null!=a||null!=h)if(t.s.ti(i))t.Yg.rf(e,n,r,s,o,a,h);else if(t.s.Cd(s))null!=a&&(a.u=n),null!=h&&(h.u=r);else if(o=t.F.ba(o),0>s&&(s=t.s.P(s),o=t.F.ba(o+3.141592653589793)),n=t.F.ba(n),r=t.F.ba(r),1.570796326794897<t.s.P(r)&&(n=t.F.ba(n+3.141592653589793),r=t.s.Mb(3.141592653589793,r)-r),t.s.Y(t.s.P(r),1.570796326794897)&&(n=0),t.s.Cd(r)){var m=t.s.P(1.570796326794897-t.s.P(o));m=t.F.Qj(i,m),m=1-t.F.w(i,t.F.Vq(i,m)),m*=2-m,e=s/t.F.Ah(e,m)*1.570796326794897,e=t.F.Rq(m,e),e=t.F.ot(m,e),t.Yg.rf(1,n,r,e,o,a,c),null!=h&&(l=c.u),null!=h&&(h.u=t.F.Qj(i,l))}else if(t.s.Y(t.s.P(r),1.570796326794897))c=2*(l=t.F.Ah(e,i)),o=0<(e=t.s.Mb(1.570796326794897,r))?t.F.ba(3.141592653589793-o):o,r=l-s,t.s.P(r)<=l?null!=a&&(a.u=o):(r=Math.floor(s/c),0==t.O.truncate(r%2)?(null!=a&&(a.u=o),s-=r*c):(null!=a&&(a.u=t.F.ba(o+3.141592653589793)),s=(r+1)*c-s),r=l-s),null!=h&&(h.u=t.F.Rq(i,r/l*e));else{m=t.F.ot(i,r),o=Math.atan2(Math.sin(o),Math.cos(o)*Math.cos(r-m));var y=t.O.truncate(t.s.Mb(1,m))*(1.570796326794897>=t.s.P(o)?1:-1);o=t.F.ba(n+Math.atan(Math.tan(o)*-Math.sin(m))),t.Yg.tb(e,o,0,n,m,null,u,null),m=t.s.P(1.570796326794897-t.s.P(u.u)),m=t.F.Qj(i,m),m=1-t.F.w(i,t.F.Vq(i,m)),m*=2-m,t.F.cl(1,i,0,o,0,p,g,v),d[0]=p.u,d[1]=g.u,d[2]=v.u,t.F.cl(1,i,r,n,0,p,g,v),f[0]=p.u,f[1]=g.u,f[2]=v.u,r=Math.acos((d[0]*f[0]+d[1]*f[1]+d[2]*f[2])/Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2])),r=t.F.Qj(m,r),s=0<(r=t.F.q(e,m,r)+s*y)?u.u:t.F.ba(u.u+3.141592653589793),e=t.s.P(r)/t.F.Ah(e,m)*1.570796326794897,e=t.F.Rq(m,e),e=t.F.ot(m,e),t.Yg.rf(1,o,0,e,s,a,c),null!=h&&(l=c.u),null!=h&&(h.u=t.F.Qj(i,l))}},e}()}(X||(X={})),function(t){t.cu=function(){function e(){}return e.tb=function(e,i,n,r,s,o,a,h,l){var c=0,u=0,d=0;if(null!=a||null!=h||null!=l)if(t.s.ti(i))t.Yg.tb(e,n,r,s,o,a,h,l);else{var f=t.F.ba(s-n);if(t.s.Y(r,o)&&(t.s.Cd(f)||t.s.Y(t.s.P(r),1.570796326794897)))null!=a&&(a.u=0),null!=h&&(h.u=0),null!=l&&(l.u=0);else{if(t.s.Y(r,-o)){if(t.s.Y(t.s.P(r),1.570796326794897))return null!=a&&(a.u=2*t.F.Ah(e,i)),null!=h&&(h.u=0<r?t.F.ba(3.141592653589793-t.F.ba(s)):t.F.ba(s)),void(null!=l&&(l.u=0<r?t.F.ba(s):t.F.ba(3.141592653589793-t.F.ba(s))));t.s.Y(t.s.P(f),3.141592653589793)&&(null!=a&&(a.u=2*t.F.Ah(e,i)),null!=h&&(h.u=0),null!=l&&(l.u=0))}else{if(t.s.Y(t.s.P(r),1.570796326794897)||t.s.Y(t.s.P(o),1.570796326794897))return void t.Wk.tb(e,i,n,r,s,o,a,h,l);if(t.s.Cd(f)||t.s.Y(t.s.P(f),3.141592653589793))return void t.Wk.tb(e,i,n,r,s,o,a,h,l)}var p=1-Math.sqrt(1-i),g=i/(1-i),v=e*(1-p);e=t.F.Vq(i,r);var m=t.F.Vq(i,o);i=1.570796326794897==t.s.P(e)?0:Math.cos(e);var y=Math.sin(e),_=1.570796326794897==t.s.P(m)?0:Math.cos(m),b=Math.sin(m),w=f,x=Math.cos(w),T=Math.sin(w),A=1,M=0;do{var S=w,E=Math.sqrt(Math.pow(_*T,2)+Math.pow(i*b-y*_*x,2)),C=y*b+i*_*x,O=Math.atan2(E,C);if(0==E){A=0;break}var R=i*_*T/E;if(c=Math.cos(Math.asin(R)),u=C-2*y*b/(c*=c),1<t.s.P(u)&&(u=t.s.Mb(1,u)),w=f+(1-(w=p/16*c*(4+p*(4-3*c))))*p*R*(O+w*E*(u+w*C*(2*(d=u*u)-1))),x=Math.cos(w),T=Math.sin(w),M++,3.141592653589793<t.s.P(w)&&30<M){A=0;break}}while(5e3>=M&&!t.s.Y(S,w));if(0!=A)p=(g*=c)*(256+g*(g*(74-47*g)-128))/1024,null!=a&&(a.u=v*(1+g*(4096+g*(g*(320-175*g)-768))/16384)*(O-p*E*(u+p/4*(C*(2*d-1)-p/6*u*(4*E*E-3)*(4*d-3))))),null!=h&&(h.u=t.s.Y(t.s.P(r),1.570796326794897)?0>r?s:t.F.ba(3.141592653589793-s):Math.atan2(_*T,i*b-y*_*x)),null!=l&&(t.s.Y(t.s.P(o),1.570796326794897)?l.u=0>o?n:t.F.ba(3.141592653589793-n):(l.u=Math.atan2(i*T,i*b*x-y*_),l.u=t.F.ba(l.u+3.141592653589793)));else{w=t.s.Mb(3.141592653589793,f),C=y*b-i*_,O=Math.acos(C),E=Math.sin(O),c=1,M=R=0;do{d=R,x=1-.25*(R=p*(c*=c)*(1+p+p*p))+.1875*(u=p*p*(x=c*c)*(1+2.25*p))-.1953125*(A=p*p*p*x*c),R=.25*R-.25*u+.29296875*A,T=.03125*u-.05859375*A,A*=.00651041666666667,u=C-2*y*b/c,1<t.s.P(u)&&(u=t.s.Mb(1,u)),c=Math.acos(u),C=Math.cos(2*c),S=Math.cos(3*c),T=(R=t.s.Y(r,-o)?t.F.ba(3.141592653589793-f)/(3.141592653589793*p*x):t.F.ba(w-f)/(p*(x*O+R*E*u+T*Math.sin(2*O)*C+A*Math.sin(3*O)*S)))*E/(i*_),w=1.570796326794897<t.s.P(f)?t.s.Mb(3.141592653589793,T)-Math.asin(T):Math.asin(T),x=Math.cos(w),E=Math.sqrt(Math.pow(_*T,2)+Math.pow(i*b-y*_*x,2)),O=3.141592653589793-Math.asin(t.s.P(E)),C=Math.cos(O),c=Math.cos(Math.asin(R)),M++}while(70>=M&&!t.s.Y(d,R));null!=a&&(x=1+(g*=c*=c)*(4096+g*(g*(320-175*g)-768))/16384,t.s.Y(r,-o)?a.u=3.141592653589793*v*x:(u=C-2*y*b/c,c=Math.acos(u),C=Math.cos(2*c),S=Math.cos(3*c),a.u=v*(x*O+g*(g*(128+g*(35*g-60))-512)/2048*E*u+g*(5*g-4)/6144*g*g*Math.sin(2*O)*C+A*Math.sin(3*O)*S+-762939453125e-16*g*g*g*g*Math.sin(4*O)*Math.cos(4*c)))),null!=h&&(t.s.Cd(r)&&t.s.Cd(o)?(c=Math.sqrt(1-R*R),h.u=Math.acos(c),0>f&&(h.u*=-1)):t.s.Y(t.s.P(r),1.570796326794897)?h.u=0>r?s:t.F.ba(3.141592653589793-s):(a=R/i,v=Math.sqrt(1-a*a),0>i*b-y*_*Math.cos(w)&&(v*=-1),h.u=Math.atan2(a,v),t.s.Y(r,-o)&&t.s.P(t.F.ba(n-s))>3.141592653589793*(1-p*Math.cos(r))&&(0<r&&1.570796326794897>t.s.P(h.u)||0>r&&1.570796326794897<t.s.P(h.u))&&(h.u=t.s.Mb(3.141592653589793,h.u)-h.u))),null!=l&&(t.s.Cd(r)&&t.s.Cd(o)?(c=Math.sqrt(1-R*R),l.u=Math.acos(c),0<=f&&(l.u*=-1)):t.s.Y(t.s.P(o),1.570796326794897)?l.u=0>o?n:t.F.ba(3.141592653589793-n):(f=R/_,a=Math.sqrt(1-f*f),v=Math.sin(w/2),0>Math.sin(m-e)-2*i*b*v*v&&(a*=-1),l.u=Math.atan2(f,a),l.u=t.F.ba(l.u+3.141592653589793),t.s.Y(r,-o)&&!t.s.Cd(r)&&!t.s.Y(t.s.P(r),1.570796326794897)&&t.s.P(t.F.ba(n-s))>3.141592653589793*(1-p*Math.cos(r))&&(null!=h?v=h.u:(a=R/i,v=Math.sqrt(1-a*a),0>i*b-y*_*Math.cos(w)&&(v*=-1),v=Math.atan2(a,v),t.s.Y(r,-o)&&t.s.P(t.F.ba(n-s))>3.141592653589793*(1-p*Math.cos(r))&&(0<r&&1.570796326794897>t.s.P(v)||0>r&&1.570796326794897<t.s.P(v))&&(v=t.s.Mb(3.141592653589793,v)-v)),1.570796326794897>=t.s.P(v)&&1.570796326794897<t.s.P(l.u)||1.570796326794897<=t.s.P(v)&&1.570796326794897>t.s.P(l.u))&&(l.u=-1*t.F.ba(l.u+3.141592653589793))))}}}},e.rf=function(e,i,n,r,s,o,a,h){if(null!=a||null!=h)if(t.s.ti(i))t.Yg.rf(e,n,r,s,o,a,h);else if(o=t.F.ba(o),t.s.Y(t.s.P(r),1.570796326794897)||t.s.Cd(o)||t.s.Y(t.s.P(o),3.141592653589793))t.Wk.rf(e,i,n,r,s,o,a,h);else{var l=1.570796326794897==t.s.P(o)?0:Math.cos(o),c=3.141592653589793==t.s.P(o)?0:Math.sin(o);t.s.Y(t.s.P(r),1.570796326794897)&&(n=0),o=1-Math.sqrt(1-i);var u=t.F.Vq(i,r);r=1.570796326794897==t.s.P(u)?0:Math.cos(u);var d=Math.sin(u);u=Math.atan2(Math.tan(u),l);var f=r*c,p=f*f,g=1-p,v=i/(1-i)*g,m=(i=v*(256+v*(v*(74-47*v)-128))/1024)/4,y=i/6,_=s/(e*(1-o)*(1+v*(4096+v*(v*(320-175*v)-768))/16384)),b=_;do{var w=b;s=1.570796326794897==t.s.P(b)?0:Math.cos(b);var x=(v=3.141592653589793==t.s.P(b)?0:Math.sin(b))*v;b=i*v*((e=Math.cos(2*u+b))+m*(s*(2*(b=e*e)-1)-y*e*(4*x-3)*(4*b-3)))+_}while(!t.s.Y(w,b));s=1.570796326794897==t.s.P(b)?0:Math.cos(b),v=3.141592653589793==t.s.P(b)?0:Math.sin(b),null!=a&&(c=Math.atan2(v*c,r*s-d*v*l),g=o/16*g*(4+o*(4-3*g)),e=Math.cos(2*u+b),a.u=t.F.ba(n+(c-(1-g)*o*f*(b+g*v*(e+g*s*(2*e*e-1)))))),null!=h&&(g=d*v-r*s*l,g=(1-o)*Math.sqrt(p+g*g),h.u=Math.atan2(d*s+r*v*l,g))}},e}()}(X||(X={})),function(t){t.PC=function(){function e(){}return e.tb=function(e,i,n,r,s,o,a,h,l){var c=t.F.ba(s-n),u=t.s.Y(t.s.P(r),1.570796326794897),d=t.s.Y(t.s.P(o),1.570796326794897);if(t.s.Y(r,o)&&(t.s.Cd(c)||u))null!=a&&(a.u=0),null!=h&&(h.u=0),null!=l&&(l.u=0);else{if(t.s.ti(i)){var f=Math.sin(r),p=Math.sin(o);f=Math.sqrt((1+f)/(1-f)),p=Math.sqrt((1+p)/(1-p)),f=Math.log(p)-Math.log(f),f=Math.atan2(c,f),null!=a&&(a.u=t.s.Y(r,o)?t.s.P(e*Math.cos(r)*c):t.s.P((e*o-e*r)/Math.cos(f)))}else p=t.F.Qw(i,o),f=Math.sin(t.F.Qw(i,r)),p=Math.sin(p),f=Math.sqrt((1+f)/(1-f)),p=Math.sqrt((1+p)/(1-p)),f=Math.log(p)-Math.log(f),f=Math.atan2(c,f),null!=a&&(t.s.Y(r,o)?a.u=t.s.P(e*c*Math.cos(r)/t.F.w(i,r)):(c=t.F.q(e,i,r),e=t.F.q(e,i,o),a.u=t.s.P((e-c)/Math.cos(f))));null==h&&null==l||(a=t.F.ba(f+3.141592653589793),u&&d||!u&&!d||(u?f=0>r?s:t.F.ba(3.141592653589793-s):d&&(a=0>o?n:t.F.ba(3.141592653589793-n))),null!=h&&(h.u=f),null!=l&&(l.u=a))}},e.rf=function(e,i,n,r,s,o,a,h){o=t.F.ba(o),0>s&&(s=t.s.P(s),o=t.F.ba(o+3.141592653589793)),t.s.ti(i)?t.s.Y(t.s.P(r),1.570796326794897)?(n=0>r?o:t.F.ba(3.141592653589793-o),3.141592653589793>=(o=s/e%6.283185307179586)?e=r-t.s.Mb(o,r):(n=t.F.ba(n+3.141592653589793),e=-r+t.s.Mb(o-3.141592653589793,r))):t.s.Y(t.s.P(o),1.570796326794897)?(n=t.F.ba(n+t.s.Mb(s,o)/(e*Math.cos(r))),e=r):(e=r+s*Math.cos(o)/e,1.570796326794897<t.s.P(e)&&(e=1.570796326794897),t.s.Y(t.s.P(e),1.570796326794897)&&(t.s.Cd(o)||t.s.Y(t.s.P(o),3.141592653589793))||(1.570796316258184<t.s.P(e)&&(e=t.s.Mb(1.570796316258184,e)),i=Math.sin(r),r=Math.sin(e),i=Math.sqrt((1+i)/(1-i)),r=Math.sqrt((1+r)/(1-r)),i=Math.log(r)-Math.log(i),n=t.F.ba(n+Math.tan(o)*i))):t.s.Y(t.s.P(r),1.570796326794897)?(n=0>r?o:t.F.ba(3.141592653589793-o),o=s/t.F.qW(e,i),3.141592653589793>=(o%=6.283185307179586)?e=r-t.s.Mb(o,r):(n=t.F.ba(n+3.141592653589793),e=-r+t.s.Mb(o-3.141592653589793,r)),e=t.F.Rq(i,e)):t.s.Y(t.s.P(o),1.570796326794897)?(n=t.F.ba(n+t.s.Mb(s,o)*t.F.w(i,r)/(e*Math.cos(r))),e=r):(e=1.570796326794897*(s*Math.cos(o)+t.F.q(e,i,r))/t.F.Ah(e,i),1.570796326794897<t.s.P(e)&&(e=t.s.Mb(1.570796326794897,e)),e=t.F.Rq(i,e),t.s.Y(t.s.P(e),1.570796326794897)&&(t.s.Cd(o)||t.s.Y(t.s.P(o),3.141592653589793))||(s=t.F.Qw(i,r),r=t.F.Qw(i,e),1.570796316258184<t.s.P(r)&&(r=t.s.Mb(1.570796316258184,e),e=t.F.yO(i,r)),i=Math.sin(s),r=Math.sin(r),i=Math.sqrt((1+i)/(1-i)),r=Math.sqrt((1+r)/(1-r)),i=Math.log(r)-Math.log(i),n=t.F.ba(n+Math.tan(o)*i))),null!=a&&(a.u=n),null!=h&&(h.u=e)},e}()}(X||(X={})),function(t){t.kb=function(){function e(){}return e.Xy=function(e,i,n,r,s,o,a){t.cu.tb(e,i,n,r,s,o,null,a,null)},e.yi=function(e,i,n,r,s,o,a,h){t.cu.rf(e,i,n,r,s,o,a,h)},e.wd=function(e,i,n,r,s,o,a,h,l,c){switch(c){case 2:t.Wk.tb(e,i,n,r,s,o,a,h,l);break;case 3:t.QC.tb(e,i,n,r,s,o,a,h,l);break;case 1:t.PC.tb(e,i,n,r,s,o,a,h,l);break;default:t.cu.tb(e,i,n,r,s,o,a,h,l)}},e.oj=function(e,i,n,r,s,o,a,h,l){switch(l){case 2:t.Wk.rf(e,i,n,r,s,o,a,h);break;case 3:t.QC.rf(e,i,n,r,s,o,a,h);break;case 1:t.PC.rf(e,i,n,r,s,o,a,h);break;default:t.cu.rf(e,i,n,r,s,o,a,h)}},e}()}(X||(X={})),function(t){var e=function(){function e(){this.y=this.x=null}return e.construct=function(i){var n=new e;return n.x=new t.Wb,n.x.set(i.x),n.y=new t.Wb,n.y.set(i.y),n},e.VE=function(i,n){var r=new e;return r.x=new t.Wb,r.x.set(i),r.y=new t.Wb,r.y.set(n),r},e.prototype.qg=function(){return this.x.qg()&&this.y.qg()},e.prototype.value=function(){return t.h.construct(this.x.value(),this.y.value())},e}();t.vY=e;var i=function(){function e(){this.z=this.y=this.x=null}return e.construct=function(i){var n=new e;return n.x=new t.Wb,n.x.set(i.x),n.y=new t.Wb,n.y.set(i.y),n.z=new t.Wb,n.z.set(i.z),n},e.VE=function(i,n,r){var s=new e;return s.x=new t.Wb,s.x.set(i),s.y=new t.Wb,s.y.set(n),s.z=new t.Wb,s.z.set(r),s},e.prototype.qg=function(){return this.x.qg()&&this.y.qg()&&this.z.qg()},e.prototype.value=function(){return new t.Nd(this.x.value(),this.y.value(),this.z.value())},e.prototype.Qh=function(e){var i=new t.Wb,n=new t.Wb,r=new t.Wb;return i.Kl(this.x,e.x),n.Kl(this.y,e.y),r.Kl(this.z,e.z),(e=new t.Wb).dN(i,n),e.add(r),e},e.prototype.cF=function(i){var n=new e;n.x.Kl(this.y,i.z),n.y.Kl(this.z,i.x),n.z.Kl(this.x,i.y);var r=new t.Wb,s=new t.Wb,o=new t.Wb;return r.Kl(this.z,i.y),s.Kl(this.x,i.z),o.Kl(this.y,i.x),n.x.sub(r),n.y.sub(s),n.z.sub(o),n},e}();t.wY=i,t.Ox=function(){function n(){}return n.EP=function(t,e,i){var r=e.x;e=e.y,n.cl(1,t,Math.cos(r),Math.sin(r),Math.cos(e),Math.sin(e),i)},n.DP=function(e,i){var r=new t.Nd;return n.EP(e,i,r),r},n.cl=function(t,e,i,n,r,s,o){t/=Math.sqrt(1-e*s*s),o.K(t*r*i,t*r*n,t*(1-e)*s)},n.Yu=function(e,n){var r=new t.Wb,s=new t.Wb,o=new t.Wb,a=new t.Wb;r.cos(n.x),s.sin(n.x),o.cos(n.y),a.sin(n.y);var h=new t.Wb;return h.set(a),h.Ag(a),h.No(e),h.No(-1),h.kN(),h.sqrt(),(n=new t.Wb).set(1),n.jm(h),(h=new t.Wb).set(n),h.Ag(o),h.Ag(r),(r=new t.Wb).set(n),r.Ag(o),r.Ag(s),(s=new t.Wb).set(n),s.No(1-e),s.Ag(a),i.VE(h,r,s)},n.SS=function(i,r,s,o){if(Math.abs(r.x-s.x)>Math.PI||Math.abs(r.y)>.5*Math.PI||Math.abs(s.y)>.5*Math.PI||(Math.abs(r.y)==.5*Math.PI||Math.abs(s.y)==.5*Math.PI)&&r.x!=s.x)return NaN;if(o=n.cB(o,Math.min(r.x,s.x),Math.max(r.x,s.x)),!new t.Nc(r.x,s.x).contains(o))return NaN;var a=e.construct(r);if(s=e.construct(s),a=n.Yu(i,a),s=n.Yu(i,s),(s=a.cF(s)).z.qg())return r.y;var h=new t.Wb;h.set(s.x),h.jm(s.z),h.No(-1);var l=new t.Wb;l.set(s.y),l.jm(s.z),l.No(-1);var c=new t.Wb;return c.set(l),c.Ag(l),(a=new t.Wb).set(h),a.Ag(h),a.add(c),a.sqrt(),a.qg()||h.qg()&&l.qg()?r.y:(r=Math.atan2(l.value(),h.value()),r=Math.atan2(a.value()*Math.cos(r-o),1-i),o=n.DP(i,t.h.construct(o,r)),i=new t.Nd(o.x,o.y,-o.z),o=s.value().Qh(o),i=s.value().Qh(i),Math.abs(i)<Math.abs(o)&&(r=-r),r)},n.Oz=function(i,r,s,o,a){if(a[0]=NaN,a[1]=NaN,Math.abs(r.x-s.x)>Math.PI||Math.abs(r.y)>.5*Math.PI||Math.abs(s.y)>.5*Math.PI||(Math.abs(r.y)==.5*Math.PI||Math.abs(s.y)==.5*Math.PI)&&r.x!=s.x||Math.abs(o)>=.5*Math.PI||0<r.y&&0<s.y&&r.y>o&&s.y>o||0>r.y&&0>s.y&&r.y<o&&s.y<o)return 0;var h=e.construct(r),l=e.construct(s);h=n.Yu(i,h),l=n.Yu(i,l);var c=h.cF(l);if(c.z.qg())return new t.Nc(r.y,s.y).contains(o)?(a[0]=r.x,1):0;(l=new t.Wb).set(c.x),l.jm(c.z),l.No(-1),(h=new t.Wb).set(c.y),h.jm(c.z),h.No(-1),(c=new t.Wb).set(h),c.Ag(h);var u=new t.Wb;return u.set(l),u.Ag(l),u.add(c),u.sqrt(),u.qg()||l.qg()&&h.qg()?0==o?(a[0]=r.x,a[1]=s.x,2):0:(i=(1-i)*Math.tan(o)/u.value(),1<Math.abs(i)?0:(i=Math.acos(i),c=Math.atan2(h.value(),l.value()),l=Math.min(r.x,s.x),h=Math.max(r.x,s.x),s=n.cB(c-i,l,h),i=0!=o?n.cB(c+i,l,h):s,o=0,l<=s&&s<=h&&(a[o]=s,o++),i!=s&&l<=i&&i<=h&&(a[o]=i,2==++o&&Math.abs(a[0]-r.x)>Math.abs(a[1]-r.x)&&(r=a[0],a[0]=a[1],a[1]=r)),o))},n.cB=function(t,e,i){return t>i?t-=2*(e=Math.ceil((t-i)/(2*Math.PI)))*Math.PI:t<e&&(t+=2*(e=Math.ceil((e-t)/(2*Math.PI)))*Math.PI),t},n}()}(X||(X={})),function(t){t.XK=function(){function e(){}return e.$X=function(i,n){var r=[0,0,0,0],s=new t.h;s.L(n),s.scale(9102==t.cb.sc(i).Hd().Ec()?1:t.cb.sc(i).Hd().ai/3.141592653589793*180),-180>s.x?(s.x-=s.x%360,-180>s.x&&(s.x+=360)):180<s.x&&(s.x-=s.x%360,180<s.x&&(s.x-=360)),90<s.y&&(s.y=90),-90>s.y&&(s.y=-90);for(var o=-180,a=180,h=(i=40)-1,l=(n=(i+31)/32)-1;0<=l;l--)for(var c=h-32*l,u=Math.min(32,i-32*l),d=1;d<u;d+=2){var f=.5*(a+o);s.x>=f?(r[l]|=1<<c,o=f):a=f,c-=2,h-=2}for(o=-90,a=90,h=i-2,l=n-1;0<=l;l--)for(c=h-32*l,u=Math.min(32,i-32*l),d=0;d<u;d+=2)f=.5*(a+o),s.y>=f?(r[l]|=1<<c,o=f):a=f,c-=2,h-=2;return e.$P(r,8,8)},e.$P=function(t,e,i){for(var n=[],r=0;r<e;r++)n[r]="";for(var s=r=0,o=0;o<e;o++){var a=t[r]>>s&31;if(31<(s+=5)){var h=37-s;a&=(1<<h)-1,s-=32,a|=(t[++r]&(1<<s)-1)<<h}n[e-1-o]="0123456789bcdefghjkmnpqrstuvwxyz".split("")[a]}if(i>e)for(o=0;o<i-e;o++)n.push("0");else i<e&&(n.length=i);return n.join("")},e}()}(X||(X={})),function(t){var e={gcstol:[0,2e-9,1,2.241706620489156e-9,2,2.313672246530541e-9,3,8.98240164660333e-9,4,8.982433838020134e-9,5,8.982439417325895e-9,6,8.982466029667677e-9,7,8.982476760268133e-9,8,8.982492642167149e-9,9,8.98251968292634e-9,10,8.98253685210448e-9,11,8.982546725256576e-9,12,8.982557456049832e-9,13,8.98257333682596e-9,14,8.982575482995276e-9,15,8.982578488197342e-9,16,8.982579775336987e-9,17,8.9825840676828e-9,18,8.982599090925448e-9,19,8.982605529473397e-9,20,8.982609220517402e-9,21,8.982611968030573e-9,22,8.982616260407152e-9,23,8.982620552787834e-9,24,8.982633429954492e-9,25,8.982637722351582e-9,26,8.98264416095491e-9,27,8.982646307158072e-9,28,8.982654891980968e-9,29,8.982667769246082e-9,30,8.982674207892485e-9,31,8.982680646548117e-9,32,8.982682792768713e-9,33,8.982685798042582e-9,34,8.982689231436652e-9,35,8.98269137766135e-9,36,8.98269266624163e-9,37,8.982705114087017e-9,38,8.982706830791106e-9,39,8.982711958374661e-9,40,8.982712839964735e-9,41,8.982717991496125e-9,42,8.982721424914803e-9,43,8.982723571154887e-9,44,8.982727863638127e-9,45,8.982730868942154e-9,46,8.982734302370678e-9,47,8.982745033612112e-9,48,8.982751472369276e-9,49,8.982755764879183e-9,50,8.982762203651733e-9,51,8.982764776628385e-9,52,8.982766496171896e-9,53,8.98277722749025e-9,54,8.98278152002477e-9,55,8.98279933943848e-9,56,8.9829143024805e-9,57,8.982922161948598e-9,58,8.98292327314211e-9,59,8.982925667349601e-9,60,8.982932222965576e-9,61,8.982961298941316e-9,62,8.982965524049989e-9,63,8.982994818246099e-9,64,8.982994895706967e-9,65,8.98299489597736e-9,66,8.983000733443498e-9,67,8.983055097289157e-9,68,8.983064111047368e-9,69,8.983111996941178e-9,70,8.983120447446023e-9,71,8.98312748954554e-9,72,8.983134531656096e-9,73,8.983141573777694e-9,74,8.983148615910332e-9,75,8.983152841195215e-9,76,8.983153545409748e-9,77,8.983153827095593e-9,78,8.98315396793852e-9,79,8.983154249624393e-9,80,8.983155658054012e-9,81,8.983960794340072e-9,82,8.984061344391998e-9,83,8.984072829255685e-9,84,8.984194981201908e-9,85,8.984275233099427e-9,86,8.984326127007554e-9,87,8.984330099816539e-9,88,8.98433275258421e-9,89,8.984333047023206e-9,90,8.984333885258723e-9,91,8.984337959508212e-9,92,8.984365176209457e-9,93,8.984727360418079e-9,94,8.984901041679577e-9,95,8.98542662091587e-9,96,8.98610024130669e-9,97,8.992894229037531e-9,98,8.993203677616635e-9,99,8.993206178094346e-9,100,8.993216059187305e-9,101,8.99322029394808e-9,102,8.994627867045891e-9,103,9.467559984315793e-9,104,9.46881168618118e-9,105,9.980888154931644e-9,106,9.981105353606775e-9,107,9.983807356573187e-9,108,1.687060485811522e-8,109,1.688447560354875e-8,110,2.176606011487185e-8,111,2.225078816042032e-8,112,2.348476432064694e-8,113,2.348765250187846e-8,114,2.378108974103778e-8,115,3.14559636297708e-8,116,3.297788621680806e-8,117,3.667892343788279e-8,118,4.235973644320739e-8,119,4.794625900676345e-8,120,7.262742998235812e-8,121,7.499447580246377e-8,122,7.525056410964318e-8,123,7.979913581209237e-8,124,9.662020153976783e-8,125,9.799175562353741e-8,126,9.897353517547472e-8,127,1.02313891987647e-7,128,1.081460541960784e-7,129,1.21905913857622e-7,130,2.246893314238523e-7,131,2.297344808062643e-7,132,2.42984645941825e-7,133,2.754604784282804e-7,134,2.884548130346993e-7,135,3.370339971357784e-7,136,4.307953346848296e-7,137,5.208707228462029e-7,138,5.509209568565608e-7,139,6.452227422644406e-7,140,6.740679942715567e-7,141,6.861770001566745e-7,142,7.252630318111686e-7,143,7.441010326374328e-7,144,7.742672907173287e-7,145,9.629542775307953e-7,146,1061032953945969e-21,147,1143628333594458e-21,148,1162186197019925e-21,149,136418522650196e-20,150,1367441038498385e-21,151,1432394487827058e-21,152,1736235742820677e-21,153,1848250952034914e-21,154,1909859317102744e-21,155,1975716534933873e-21,156,2122065907891938e-21,157,272837045300392e-20,158,3183098861837907e-21,159,3580986219567645e-21,160,3819718634205488e-21,161,409255567950588e-20,162,4407367654852486e-21,163,4774648292756861e-21,164,5161781938115525e-21,165,520870722846203e-20,166,5729577951308232e-21,167,6031134685587613e-21,168,6987290184522236e-21,169,9241254760174569e-21,170,1145915590261646e-20],pcstol:[0,6.666666666666667e-9,1,2e-8,2,4970973863636364e-20,3,4970978156565657e-20,4,4970980410559237e-20,5,.001,6,.001093615055555556,7,.001093615194444445,8,.001093619003239988,9,.001093623110088878,10,.003280833333333333,11,.003280839895013123,12,.003280843014596366,13,.003280845583333334,14,.003280869330266636,15,.00497101413676763],newtoold:[2154,102110,2195,102200,2204,32036,2205,26979,2225,102641,2226,102642,2227,102643,2228,102644,2229,102645,2230,102646,2231,102653,2232,102654,2233,102655,2234,102656,2235,102657,2236,102658,2237,102659,2238,102660,2239,102666,2240,102667,2241,102668,2242,102669,2243,102670,2246,102679,2247,102680,2248,102685,2249,102686,2250,102687,2254,102694,2255,102695,2257,102712,2258,102713,2259,102714,2260,102715,2261,102716,2262,102717,2263,102718,2264,102719,2267,102724,2268,102725,2271,102728,2272,102729,2274,102736,2275,102737,2276,102738,2277,102739,2278,102740,2279,102741,2283,102746,2284,102747,2285,102748,2286,102749,2287,102752,2288,102753,2289,102754,2312,23433,2326,102140,2395,2091,2396,2092,2397,2166,2398,2167,2399,2168,2759,102229,2760,102230,2761,102248,2762,102249,2763,102250,2764,102251,2765,102252,2766,102241,2767,102242,2768,102243,2769,102244,2770,102245,2771,102246,2772,102253,2773,102254,2774,102255,2775,102256,2776,102257,2777,102258,2778,102259,2779,102260,2780,102266,2781,102267,2782,102261,2783,102262,2784,102263,2785,102264,2786,102265,2787,102268,2788,102269,2789,102270,2790,102271,2791,102272,2792,102273,2793,102274,2794,102275,2795,102276,2796,102277,2797,102278,2798,102279,2799,102280,2800,102281,2801,102282,2802,102283,2803,102284,2804,102285,2805,102286,2806,102287,2807,102288,2808,102289,2809,102290,2810,102291,2811,102292,2812,102293,2813,102294,2814,102295,2815,102296,2816,102297,2817,102298,2818,102300,2819,102304,2820,102307,2821,102308,2822,102309,2823,102310,2824,102311,2825,102312,2826,102313,2827,102314,2828,102315,2829,102316,2830,102317,2831,102318,2832,102320,2833,102321,2834,102322,2835,102323,2836,102324,2837,102325,2838,102326,2839,102327,2840,102330,2841,102334,2842,102335,2843,102336,2844,102337,2845,102338,2846,102339,2847,102340,2848,102341,2849,102342,2850,102343,2851,102344,2852,102345,2853,102346,2854,102347,2855,102348,2856,102349,2857,102350,2858,102351,2859,102352,2860,102353,2861,102354,2862,102355,2863,102356,2864,102357,2865,102358,2866,102361,2942,102167,2943,102169,2944,2139,2945,2140,2946,2141,2947,2142,2948,2143,2949,2144,2950,2145,2951,2146,2952,2147,2953,2036,2954,2291,2955,2153,2956,2152,2957,2151,2958,2150,2959,2149,2960,2037,2961,2038,2962,2148,2965,2244,2966,2245,3003,102091,3004,102092,3005,102190,3060,2982,3067,102139,3072,102606,3074,102608,3075,102208,3077,102210,3078,102123,3080,102119,3081,102603,3082,102602,3083,102601,3088,65163,3089,102763,3090,102363,3092,102151,3093,102152,3094,102153,3095,102154,3096,102155,3097,102145,3098,102146,3099,102147,3100,102148,3101,102149,3102,2155,3107,102172,3110,102170,3111,102171,3119,2214,3158,102234,3159,102235,3160,102236,3336,2979,3338,102006,3346,2600,3370,102126,3371,102127,3372,102130,3373,102131,3389,2577,3390,2694,3400,102184,3401,102185,3404,3359,3407,3366,3417,102675,3418,102676,3419,102677,3420,102678,3421,102707,3422,102708,3423,102709,3424,102711,3433,102651,3434,102652,3435,102671,3436,102672,3437,102710,3438,102730,3448,102095,3451,102681,3452,102682,3455,102735,3461,2063,3462,2064,3463,3073,3464,3076,3560,102742,3566,102743,3567,102744,3734,102722,3735,102723,3736,102755,3737,102756,3738,102757,3739,102758,3741,102205,3742,102206,3743,102207,3748,102211,3750,102202,3751,102203,3759,102663,3760,102463,3764,102112,3770,102090,3771,102180,3772,102181,3773,102182,3775,102186,3776,102187,3777,102188,3800,102183,3801,102189,3812,102199,3814,102609,3815,102469,3819,104990,3821,104136,3824,104137,3825,102444,3826,102443,3827,102442,3828,102441,3857,102100,3889,104991,3906,104992,4048,103201,4049,103202,4050,103203,4051,103204,4056,103205,4057,103206,4058,103207,4059,103208,4060,103209,4061,103210,4062,103211,4063,103212,4071,103213,4082,103214,4083,103215,4093,103216,4094,103217,4095,103218,4096,103219,4167,104108,4169,37252,4171,104107,4189,104110,4197,4234,4223,37223,4304,104304,4414,102201,4415,102762,4417,102764,4434,102765,4437,102647,4455,32029,4456,32018,4457,3454,4462,102439,4463,4466,4470,4469,4484,103794,4485,103795,4486,103796,4487,103797,4488,103798,4489,103799,4611,104104,4612,104111,4613,37255,4615,37247,4616,37250,4617,4140,4618,4291,4620,37211,4626,37235,4647,102362,4658,37204,4668,37201,4669,4126,4672,37217,4673,104125,4675,37220,4684,37232,4698,4631,4707,37213,4708,37231,4709,37212,4710,37238,4711,37214,4712,37237,4713,37208,4714,37215,4715,37253,4716,37216,4717,37239,4719,37219,4722,37242,4724,37233,4725,37222,4727,37224,4728,37246,4729,37226,4730,37227,4731,37228,4732,37229,4733,37230,4734,37251,4735,37259,4736,37254,4739,37205,4758,104133,4760,37001,4762,104114,4826,102214,5013,104142,5014,102331,5015,102332,5016,102333,5173,102085,5174,102086,5175,102087,5176,102088,5177,102089,5178,102040,5179,102080,5185,102081,5186,102082,5187,102083,5188,102084,5221,102066,5246,104100,5247,102490,5324,104144,5325,102420,5329,2934,5365,104143,5367,102305,5451,104132,5513,102065,5514,102067,5519,102111,5520,31461,5646,102745,5839,5388,5858,5532,5879,4474,6207,104256,6244,102769,6245,102790,6246,102770,6247,102771,6248,102793,6249,102796,6250,102772,6251,102788,6252,102775,6253,102795,6254,102781,6255,102767,6256,102774,6257,102768,6258,102797,6259,102789,6260,102780,6261,102783,6262,102787,6263,102791,6264,102777,6265,102798,6266,102779,6267,102784,6268,102792,6269,102782,6270,102785,6271,102794,6272,102773,6273,102778,6274,102786,6275,102776,6311,104141,6318,104145,6322,104287,6325,104286,6328,102046,6329,102047,6330,102048,6331,102049,6332,102050,6333,102051,6334,102052,6335,102053,6336,102054,6337,102055,6338,102056,6339,102057,6340,102058,6341,102059,6342,102382,6343,102383,6344,102384,6345,102385,6346,102386,6347,102387,6348,102388,6350,102965,6355,102975,6356,102976,6391,6141,6393,102966,6394,102977,6395,102978,6396,102979,6397,102980,6398,102981,6399,102982,6400,102983,6401,102984,6402,102985,6403,102986,6404,102988,6405,102991,6406,102987,6407,102990,6408,102989,6409,102992,6410,102993,6411,102995,6412,102994,6413,102996,6414,102962,6415,102997,6416,103003,6417,102998,6418,103004,6419,102999,6420,103005,6421,103e3,6422,103006,6423,103001,6424,103007,6425,103002,6426,103008,6427,103010,6428,103013,6429,103009,6430,103012,6431,103011,6432,103014,6433,103015,6434,103016,6435,103017,6436,103018,6437,103019,6438,103022,6439,102967,6440,103021,6441,103024,6442,103020,6443,103023,6444,103025,6445,103027,6446,103026,6447,103028,6448,103030,6449,103033,6450,103029,6451,103032,6452,103031,6453,103034,6454,103035,6455,103037,6456,103036,6457,103038,6458,103039,6459,103041,6460,103040,6461,103042,6462,103043,6463,103045,6464,103044,6465,103046,6466,103047,6467,103049,6468,103048,6469,103050,6470,103051,6471,103052,6472,103053,6473,103054,6474,103055,6475,103056,6476,103057,6477,103059,6478,103058,6479,103060,6480,103066,6481,103065,6482,103067,6483,103061,6484,103063,6485,103062,6486,103064,6487,103068,6488,103069,6489,103071,6490,103073,6491,103070,6492,103072,6493,103075,6494,103078,6495,103074,6496,103077,6497,102968,6498,103076,6499,103079,6500,103081,6501,103084,6502,103080,6503,103083,6504,103082,6505,103085,6506,103086,6507,103088,6508,102963,6509,103087,6510,103089,6511,103091,6512,103090,6513,103092,6514,103093,6515,103094,6516,103095,6518,103098,6519,103101,6520,103097,6521,103100,6522,103099,6523,103102,6524,103103,6525,103104,6526,103105,6527,103106,6528,103108,6529,103111,6530,103107,6531,103110,6532,103109,6533,103112,6534,103114,6535,103118,6536,103113,6537,103117,6538,103116,6539,103120,6540,103115,6541,103119,6542,103121,6543,103122,6544,103123,6545,103125,6546,103124,6547,103126,6548,103127,6549,103129,6550,103128,6551,103130,6552,103131,6553,103133,6554,103132,6555,103134,6556,102969,6557,102970,6558,103135,6559,103137,6560,103136,6561,103138,6562,103139,6563,103140,6564,103141,6565,103142,6566,103200,6567,103143,6568,103144,6569,103145,6570,103146,6571,103147,6572,103149,6573,103148,6574,103150,6575,103151,6576,103152,6577,103155,6578,103160,6579,102971,6580,102972,6581,103153,6582,103158,6583,103154,6584,103159,6585,103157,6586,103162,6587,103156,6588,103161,6589,103172,6590,103173,6592,103174,6593,103176,6594,103175,6595,103177,6596,103178,6597,103180,6598,103179,6599,103181,6600,103182,6601,103184,6602,103183,6603,103185,6605,103190,6606,103186,6607,103189,6608,103188,6609,103191,6610,102973,6611,103192,6612,103196,6613,103193,6614,103197,6615,103195,6616,103199,6617,103194,6618,103198,6619,103164,6620,103163,6621,103165,6625,103170,6626,103169,6627,103171,6628,102520,6629,102521,6630,102522,6631,102523,6632,102524,6633,102527,6634,102493,6635,102494,6636,102496,6637,102495,6668,104020,6669,102610,6670,102611,6671,102612,6672,102613,6673,102614,6674,102615,6675,102616,6676,102617,6677,102618,6678,102619,6679,102620,6680,102621,6681,102622,6682,102623,6683,102624,6684,102625,6685,102626,6686,102627,6687,102628,6688,102593,6689,102594,6690,102595,6691,102596,6692,102597,6783,104223,6784,102530,6785,102500,6788,102532,6789,102502,6792,102533,6793,102503,6796,102531,6797,102501,6800,102534,6801,102504,6804,102535,6805,102505,6808,102536,6809,102506,6812,102537,6813,102507,6816,102538,6817,102508,6820,102539,6821,102509,6824,102540,6825,102510,6828,102541,6829,102511,6832,102542,6833,102512,6836,102543,6837,102513,6840,102544,6841,102514,6844,102546,6845,102516,6848,102545,6849,102515,6852,102547,6853,102517,6856,102548,6857,102518,6860,102549,6861,102519,6867,102380,6868,102381,6879,103187,6880,103096,6884,102376,6885,102378,6886,102377,6887,102379,7136,6980,7139,6987,7142,102706,7692,102557,7693,102558,7694,102559,7695,102560,7696,102561,8090,103318,8091,103418,8092,103317,8093,103417,8095,103371,8096,103471,8097,103369,8098,103469,8099,103368,8100,103468,8101,103367,8102,103467,8103,103366,8104,103466,8105,103365,8106,103465,8107,103364,8108,103464,8109,103363,8110,103463,8111,103362,8112,103462,8113,103361,8114,103461,8115,103360,8116,103460,8117,103359,8118,103459,8119,103357,8120,103457,8121,103356,8122,103456,8123,103355,8124,103455,8125,103354,8126,103454,8127,103353,8128,103453,8129,103352,8130,103452,8131,103350,8132,103450,8133,103349,8134,103449,8135,103348,8136,103448,8139,103343,8140,103443,8141,103342,8142,103442,8143,103341,8144,103441,8145,103339,8146,103439,8147,103337,8148,103437,8149,103336,8150,103436,8151,103334,8152,103434,8153,103333,8154,103433,8155,103331,8156,103431,8161,103326,8162,103426,8163,103325,8164,103425,8165,103324,8166,103424,8171,103321,8172,103421,8173,103320,8177,103420,8179,103316,8180,103416,8181,103315,8182,103415,8184,103314,8185,103414,8191,103312,8193,103412,8196,103311,8197,103411,8198,103310,8200,103410,8201,103309,8202,103409,8203,103308,8204,103408,8207,103306,8208,103406,8209,103305,8210,103405,8212,103304,8213,103404,8214,103303,8216,103403,8218,103302,8220,103402,8222,103301,8224,103401,8431,104248,8441,102590,8693,102449,8826,102605,8857,54035,8858,54036,8859,54037,8860,8449,8988,104115,8989,104116,8990,104117,8991,104118,8992,104119,8993,104120,8994,104121,8995,104122,8996,104123,8997,104124,8998,104896,8999,104257,9e3,104019,9014,104010,9019,104021,9053,104011,9054,104012,9055,104013,9056,104014,9057,104015,9059,104258,9060,104179,9061,104180,9062,104181,9063,104182,9064,104183,9065,104184,9066,104185,9067,104186,21896,21891,21897,21892,21898,21893,21899,21894,26701,102124,26702,102125,26799,26747,26847,102683,26848,102684,26849,102691,26850,102692,26851,102693,26852,102704,26853,102750,26854,102751,26857,102466,26858,102467,26859,102468,26901,102128,26902,102129,27493,27492,29101,29100,29168,29118,29169,29119,29170,29120,29171,29121,29172,29122,29187,29177,29188,29178,29189,29179,29190,29180,29191,29181,29192,29182,29193,29183,29194,29184,29195,29185,29902,29900,31279,31278,31281,31291,31282,31292,31283,31293,31284,31294,31285,31295,31286,31296,31287,31297,31466,31462,31467,31463,31468,31464,31469,31465,31986,31917,31987,31918,31988,31919,31989,31920,31990,31921,31991,31922,32064,32074,32065,32075,32066,32076,32067,32077,102550,2181,102551,2182,102552,2183,102553,2184,102554,2185,102555,2186,102556,2187],pcsid:[2066,15,2136,12,2155,10,2157,5,2158,5,2159,12,2160,12,2219,5,2220,5,2244,10,2245,10,2256,11,2265,11,2266,11,2269,11,2270,11,2273,11,2290,5,2291,5,2294,5,2295,5,2313,5,2314,14,2899,10,2900,10,2901,11,2909,11,2910,11,2911,10,2912,10,2913,11,2914,11,2964,10,2967,10,2968,10,2991,5,2992,11,2993,5,2994,11,3073,5,3076,5,3079,5,3091,10,3106,5,3108,5,3109,5,3141,5,3142,5,3167,4,3337,5,3347,5,3348,5,3359,10,3360,5,3361,11,3362,5,3363,10,3364,5,3365,10,3366,14,3402,5,3403,5,3405,5,3406,5,3439,5,3440,5,3447,5,3449,5,3450,5,3453,10,3454,10,3460,5,3479,11,3480,5,3481,11,3482,5,3483,11,3484,5,3485,10,3486,5,3487,10,3488,5,3489,5,3490,10,3491,5,3492,10,3493,5,3494,10,3495,5,3496,10,3497,5,3498,10,3499,5,3500,10,3501,5,3502,10,3503,5,3504,10,3505,5,3506,10,3507,5,3508,10,3509,5,3510,10,3511,5,3512,10,3513,5,3514,5,3515,10,3516,5,3517,10,3518,5,3519,10,3520,5,3521,10,3522,5,3523,10,3524,5,3525,10,3526,5,3527,10,3528,5,3529,10,3530,5,3531,10,3532,5,3533,10,3534,5,3535,10,3536,5,3537,10,3538,5,3539,10,3540,5,3541,10,3542,5,3543,10,3544,5,3545,10,3546,5,3547,10,3548,5,3549,10,3550,5,3551,10,3552,5,3553,10,3582,10,3583,5,3584,10,3585,5,3586,10,3587,5,3588,11,3589,5,3590,11,3591,5,3592,5,3593,11,3598,10,3599,5,3600,10,3605,11,3606,5,3607,5,3608,10,3609,5,3610,10,3611,5,3612,10,3613,5,3614,10,3615,5,3616,10,3617,5,3618,10,3619,5,3620,10,3621,5,3622,10,3623,5,3624,10,3625,5,3626,10,3627,5,3628,10,3629,5,3630,10,3631,5,3632,10,3633,5,3634,11,3635,5,3636,11,3640,10,3641,5,3642,10,3643,5,3644,11,3645,5,3646,11,3647,5,3648,11,3649,5,3650,10,3651,5,3652,10,3653,5,3654,10,3655,5,3656,11,3657,5,3658,10,3659,5,3660,10,3661,5,3662,10,3663,5,3664,10,3668,10,3669,5,3670,10,3671,5,3672,10,3673,5,3674,10,3675,5,3676,11,3677,10,3678,5,3679,11,3680,10,3681,5,3682,11,3683,10,3684,5,3685,5,3686,10,3687,5,3688,10,3689,5,3690,10,3691,5,3692,10,3696,10,3697,5,3698,10,3699,5,3700,10,3740,5,3749,5,3783,5,3784,5,3793,5,3794,5,3802,5,3816,5,3829,5,3854,5,3911,5,3912,5,3920,5,3978,5,3979,5,3991,10,3992,10,4026,5,4037,5,4038,5,4087,5,4088,5,4217,10,4438,10,4439,10,4467,5,4471,5,4474,5,4559,5,4822,5,4839,5,5018,5,5048,5,5167,5,5168,5,5223,5,5234,5,5235,5,5243,5,5266,5,5316,5,5320,5,5321,5,5330,5,5331,5,5337,5,5361,5,5362,5,5382,5,5383,5,5396,5,5456,5,5457,5,5469,5,5472,9,5490,5,5518,5,5523,5,5559,5,5588,11,5589,14,5596,5,5627,5,5629,5,5641,5,5643,5,5644,5,5654,10,5655,10,5659,5,5700,5,5825,5,5836,5,5837,5,5842,5,5844,5,5880,5,5887,5,5890,5,6128,11,6129,11,6141,11,6204,5,6210,5,6211,5,6307,5,6312,5,6316,5,6362,5,6591,5,6646,5,6703,5,6786,5,6787,11,6790,5,6791,11,6794,5,6795,11,6798,5,6799,11,6802,5,6803,11,6806,5,6807,11,6810,5,6811,11,6814,5,6815,11,6818,5,6819,11,6822,5,6823,11,6826,5,6827,11,6830,5,6831,11,6834,5,6835,11,6838,5,6839,11,6842,5,6843,11,6846,5,6847,11,6850,5,6851,11,6854,5,6855,11,6858,5,6859,11,6862,5,6863,11,6870,5,6875,5,6876,5,6915,5,6922,5,6923,10,6924,5,6925,10,6962,5,6984,5,6991,5,7128,10,7131,5,7132,10,7257,5,7258,10,7259,5,7260,10,7261,5,7262,10,7263,5,7264,10,7265,5,7266,10,7267,5,7268,10,7269,5,7270,10,7271,5,7272,10,7273,5,7274,10,7275,5,7276,10,7277,5,7278,10,7279,5,7280,10,7281,5,7282,10,7283,5,7284,10,7285,5,7286,10,7287,5,7288,10,7289,5,7290,10,7291,5,7292,10,7293,5,7294,10,7295,5,7296,10,7297,5,7298,10,7299,5,7300,10,7301,5,7302,10,7303,5,7304,10,7305,5,7306,10,7307,5,7308,10,7309,5,7310,10,7311,5,7312,10,7313,5,7314,10,7315,5,7316,10,7317,5,7318,10,7319,5,7320,10,7321,5,7322,10,7323,5,7324,10,7325,5,7326,10,7327,5,7328,10,7329,5,7330,10,7331,5,7332,10,7333,5,7334,10,7335,5,7336,10,7337,5,7338,10,7339,5,7340,10,7341,5,7342,10,7343,5,7344,10,7345,5,7346,10,7347,5,7348,10,7349,5,7350,10,7351,5,7352,10,7353,5,7354,10,7355,5,7356,10,7357,5,7358,10,7359,5,7360,10,7361,5,7362,10,7363,5,7364,10,7365,5,7366,10,7367,5,7368,10,7369,5,7370,10,7877,5,7878,5,7882,5,7883,5,7887,5,7899,5,7991,5,7992,5,8035,10,8036,10,8058,5,8059,5,8082,5,8083,5,8088,5,8137,5,8138,10,8157,5,8158,10,8159,5,8160,10,8167,5,8168,10,8169,5,8170,10,8187,5,8189,10,8205,5,8206,10,8225,5,8226,10,8311,5,8312,11,8313,5,8314,11,8315,5,8316,11,8317,5,8318,11,8319,5,8320,11,8321,5,8322,11,8323,5,8324,11,8325,5,8326,11,8327,5,8328,11,8329,5,8330,11,8331,5,8332,11,8333,5,8334,11,8335,5,8336,11,8337,5,8338,11,8339,5,8340,11,8341,5,8342,11,8343,5,8344,11,8345,5,8346,11,8347,5,8348,11,8352,5,8353,5,8379,5,8380,10,8381,5,8382,10,8383,5,8384,10,8385,5,8387,10,8391,5,8395,5,8433,5,8455,5,8456,5,8531,10,8682,5,8687,5,8692,5,8903,5,8950,5,8951,5,9039,5,9040,5,9141,5,9149,5,9150,5,9191,5,9221,5,9222,5,20499,5,20538,5,20539,5,20790,5,20791,5,21291,5,21292,5,21500,5,21817,5,21818,5,22032,5,22033,5,22091,5,22092,5,22332,5,22391,5,22392,5,22700,5,22770,5,22780,5,22832,5,23090,5,23095,5,23239,5,23240,5,23433,5,23700,5,24047,5,24048,5,24100,14,24200,5,24305,5,24306,5,24382,6,24383,5,24500,5,24547,5,24548,5,24571,2,24600,5,25e3,5,25231,5,25884,5,25932,5,26237,5,26331,5,26332,5,26591,5,26592,5,26632,5,26692,5,26855,10,26856,10,27120,5,27200,5,27291,7,27292,7,27429,5,27492,5,27500,5,27700,5,28232,5,28600,5,28991,5,28992,5,29100,5,29220,5,29221,5,29333,5,29635,5,29636,5,29701,5,29738,5,29739,5,29849,5,29850,5,29871,3,29872,13,29873,5,29900,5,29901,5,29903,5,30200,15,30339,5,30340,5,30791,5,30792,5,31028,5,31121,5,31154,5,31170,5,31171,5,31370,5,31528,5,31529,5,31600,5,31700,5,31838,5,31839,5,31901,5,32061,5,32062,5,32098,5,32099,10,32100,5,32104,5,32161,5,32766,5,53048,5,53049,5,54090,5,54091,5,65061,10,65062,10,65161,5,65163,5,102041,10,102064,8,102068,1,102069,0,102118,10,102119,11,102120,10,102121,10,102217,10,102218,5,102219,10,102220,10,102378,11,102379,11,102380,5,102381,11,102498,5,102499,5,102589,10,102590,5,102599,10,102600,10,102604,10,102605,5,102606,5,102647,5,102704,10,102705,10,102706,5,102733,10,102761,10,102762,5,102763,10,102764,5,102765,5,102766,10,102962,5,102963,5,102970,11,102974,10,102993,5,102994,5,102995,10,102996,10,103015,5,103016,10,103017,5,103018,10,103025,5,103026,5,103027,10,103028,10,103035,5,103036,5,103037,10,103038,10,103039,5,103040,5,103041,10,103042,10,103043,5,103044,5,103045,10,103046,10,103047,5,103048,5,103049,10,103050,10,103051,5,103052,10,103053,5,103054,10,103055,5,103056,10,103057,5,103058,5,103059,10,103060,10,103061,5,103062,5,103063,10,103064,10,103069,10,103070,5,103071,5,103072,10,103073,10,103086,5,103087,5,103088,10,103089,10,103094,11,103095,5,103096,10,103103,5,103104,10,103105,5,103106,10,103121,5,103122,10,103123,5,103124,5,103125,11,103126,11,103127,5,103128,5,103129,10,103130,10,103131,5,103132,5,103133,10,103134,10,103135,5,103136,5,103137,11,103138,11,103139,5,103140,10,103141,5,103142,10,103143,5,103144,10,103145,5,103146,11,103147,5,103148,5,103149,10,103150,10,103151,5,103152,10,103172,5,103173,10,103174,5,103175,5,103176,10,103177,10,103178,5,103179,5,103180,10,103181,10,103182,5,103183,5,103184,10,103185,10,103228,5,103229,5,103230,10,103231,10,103250,5,103251,10,103252,5,103253,10,103260,5,103261,5,103262,10,103263,10,103270,5,103271,5,103272,10,103273,10,103274,5,103275,5,103276,10,103277,10,103278,5,103279,5,103280,10,103281,10,103282,5,103283,5,103284,10,103285,10,103286,5,103287,10,103288,5,103289,10,103290,5,103291,10,103292,5,103293,5,103294,10,103295,10,103296,5,103297,5,103298,10,103299,10,103376,10,103377,5,103378,5,103379,10,103380,10,103393,5,103394,5,103395,10,103396,10,103472,5,103473,11,103474,5,103475,10,103482,5,103483,10,103484,5,103485,10,103500,5,103501,10,103502,5,103503,5,103504,11,103505,11,103506,5,103507,5,103508,10,103509,10,103510,5,103511,5,103512,10,103513,10,103514,5,103515,10,103516,5,103517,10,103518,5,103519,10,103520,5,103521,11,103522,5,103523,5,103524,10,103525,10,103526,5,103527,10,103561,10,103562,10,103563,5,103564,5,103565,10,103566,10,103567,5,103568,5,103569,10,103570,10,103585,10,103586,5,103587,10,103588,11,103589,5,103590,10,103591,11,103592,5,103593,10,103594,11,103695,10,103846,5,103946,10],pcsidc:[[2e3,2045,5],[2056,2065,5],[2067,2135,5],[2137,2153,5],[2161,2170,5],[2172,2193,5],[2196,2198,5],[2200,2203,5],[2206,2217,5],[2222,2224,11],[2251,2253,11],[2280,2282,11],[2308,2311,5],[2315,2325,5],[2327,2394,5],[2400,2491,5],[2494,2758,5],[2867,2869,11],[2870,2888,10],[2891,2895,10],[2896,2898,11],[2902,2908,10],[2915,2920,10],[2921,2923,11],[2924,2930,10],[2931,2941,5],[2969,2973,5],[2975,2982,5],[2984,2988,5],[2995,3002,5],[3006,3051,5],[3054,3059,5],[3061,3066,5],[3068,3071,5],[3084,3087,5],[3112,3118,5],[3120,3138,5],[3146,3151,5],[3153,3157,5],[3161,3166,5],[3168,3172,5],[3174,3203,5],[3294,3313,5],[3315,3335,5],[3339,3345,5],[3350,3358,5],[3367,3369,5],[3374,3388,5],[3391,3399,5],[3408,3416,5],[3425,3432,10],[3441,3446,10],[3456,3459,10],[3465,3478,5],[3554,3559,5],[3561,3565,10],[3568,3570,10],[3571,3581,5],[3594,3597,5],[3601,3604,5],[3637,3639,5],[3665,3667,5],[3693,3695,5],[3701,3727,5],[3728,3733,10],[3744,3747,5],[3753,3758,10],[3761,3763,5],[3765,3769,5],[3779,3781,5],[3788,3791,5],[3797,3799,5],[3832,3841,5],[3844,3852,5],[3873,3885,5],[3890,3893,5],[3942,3950,5],[3968,3970,5],[3973,3976,5],[3986,3989,5],[3994,3997,5],[4390,4398,5],[4399,4413,10],[4418,4433,10],[4491,4554,5],[4568,4589,5],[4652,4656,5],[4766,4800,5],[5069,5072,5],[5105,5130,5],[5180,5184,5],[5253,5259,5],[5269,5275,5],[5292,5311,5],[5343,5349,5],[5355,5357,5],[5387,5389,5],[5459,5463,5],[5479,5482,5],[5530,5539,5],[5550,5552,5],[5562,5583,5],[5623,5625,10],[5631,5639,5],[5649,5653,5],[5663,5680,5],[5682,5685,5],[5875,5877,5],[5896,5899,5],[5921,5940,5],[6050,6125,5],[6351,6354,5],[6366,6372,5],[6381,6387,5],[6622,6624,5],[6707,6709,5],[6720,6723,5],[6732,6738,5],[6931,6933,5],[7005,7007,5],[7057,7070,10],[7074,7082,5],[7109,7118,5],[7119,7127,11],[7374,7376,5],[7528,7586,5],[7587,7645,10],[7755,7787,5],[7791,7795,5],[7799,7801,5],[7803,7805,5],[7825,7831,5],[7845,7859,5],[8013,8032,5],[8065,8068,11],[8518,8529,10],[8533,8536,10],[8538,8540,10],[8677,8679,5],[8836,8840,5],[8908,8910,5],[9154,9159,5],[9205,9218,5],[20002,20032,5],[20062,20092,5],[20135,20138,5],[20248,20258,5],[20348,20358,5],[20436,20440,5],[20822,20824,5],[20934,20936,5],[21035,21037,5],[21095,21097,5],[21148,21150,5],[21413,21423,5],[21473,21483,5],[21780,21782,5],[21891,21894,5],[22171,22177,5],[22181,22187,5],[22191,22197,5],[22234,22236,5],[22521,22525,5],[22991,22994,5],[23028,23038,5],[23830,23853,5],[23866,23872,5],[23877,23884,5],[23886,23894,5],[23946,23948,5],[24311,24313,5],[24342,24347,5],[24370,24374,6],[24375,24381,5],[24718,24721,5],[24817,24821,5],[24877,24882,5],[24891,24893,5],[25391,25395,5],[25828,25838,5],[26191,26195,5],[26391,26393,5],[26703,26722,5],[26729,26760,10],[26766,26798,10],[26860,26870,10],[26891,26899,5],[26903,26923,5],[26929,26946,5],[26948,26998,5],[27037,27040,5],[27205,27232,5],[27258,27260,5],[27391,27398,5],[27561,27564,5],[27571,27574,5],[27581,27584,5],[27591,27594,5],[28191,28193,5],[28348,28358,5],[28402,28432,5],[28462,28492,5],[29118,29122,5],[29177,29185,5],[30161,30179,5],[30491,30494,5],[30729,30732,5],[31251,31259,5],[31265,31268,5],[31275,31278,5],[31288,31297,5],[31461,31465,5],[31491,31495,5],[31917,31922,5],[31965,31985,5],[31992,32e3,5],[32001,32003,10],[32005,32031,10],[32033,32060,10],[32074,32077,10],[32081,32086,5],[32107,32130,5],[32133,32158,5],[32164,32167,10],[32180,32199,5],[32201,32260,5],[32301,32360,5],[32601,32662,5],[32664,32667,10],[32701,32761,5],[53001,53004,5],[53008,53019,5],[53021,53032,5],[53034,53037,5],[53042,53046,5],[53074,53080,5],[54001,54004,5],[54008,54019,5],[54021,54032,5],[54034,54037,5],[54042,54046,5],[54048,54053,5],[54074,54080,5],[54098,54101,5],[102001,102040,5],[102042,102063,5],[102065,102067,5],[102070,102112,5],[102114,102117,5],[102122,102208,5],[102210,102216,5],[102221,102300,5],[102304,102377,5],[102382,102388,5],[102389,102398,10],[102399,102444,5],[102445,102447,10],[102448,102458,5],[102459,102468,10],[102469,102496,5],[102500,102519,11],[102520,102524,5],[102525,102529,10],[102530,102549,5],[102557,102588,5],[102593,102598,5],[102601,102603,5],[102608,102628,5],[102629,102646,10],[102648,102672,10],[102675,102700,10],[102701,102703,5],[102707,102730,10],[102735,102758,10],[102767,102900,5],[102965,102969,5],[102971,102973,5],[102975,102989,5],[102990,102992,11],[102997,103002,5],[103003,103008,10],[103009,103011,5],[103012,103014,10],[103019,103021,5],[103022,103024,10],[103029,103031,5],[103032,103034,10],[103065,103068,5],[103074,103076,5],[103077,103079,11],[103080,103082,5],[103083,103085,10],[103090,103093,5],[103097,103099,5],[103100,103102,10],[103107,103109,5],[103110,103112,10],[103113,103116,5],[103117,103120,10],[103153,103157,5],[103158,103162,10],[103163,103165,5],[103166,103168,11],[103169,103171,10],[103186,103188,5],[103189,103191,10],[103192,103195,5],[103196,103199,10],[103200,103224,5],[103225,103227,11],[103232,103237,5],[103238,103243,10],[103244,103246,5],[103247,103249,10],[103254,103256,5],[103257,103259,10],[103264,103266,5],[103267,103269,10],[103300,103375,5],[103381,103383,5],[103384,103386,11],[103387,103389,5],[103390,103392,10],[103397,103399,5],[103400,103471,10],[103476,103478,5],[103479,103481,10],[103486,103488,5],[103489,103491,10],[103492,103495,5],[103496,103499,10],[103539,103543,5],[103544,103548,10],[103549,103551,5],[103552,103554,11],[103555,103557,10],[103558,103560,5],[103571,103573,5],[103574,103576,10],[103577,103580,5],[103581,103583,10],[103595,103597,5],[103600,103694,5],[103696,103698,5],[103700,103793,10],[103794,103799,5]],gcsid:[4001,81,4002,85,4003,70,4004,84,4005,82,4006,83,4007,60,4008,67,4009,39,4010,57,4011,63,4012,64,4013,64,4014,63,4015,92,4016,90,4018,86,4019,75,4020,68,4021,70,4022,55,4023,75,4024,66,4025,73,4027,95,4028,59,4029,58,4031,75,4032,78,4033,77,4034,65,4035,100,4036,70,4042,88,4044,87,4045,89,4046,75,4047,99,4052,101,4053,97,4054,61,4075,75,4081,75,4120,84,4121,75,4122,80,4123,55,4124,84,4126,75,4130,75,4131,92,4132,64,4133,75,4134,64,4140,75,4141,75,4142,64,4143,64,4144,92,4145,87,4146,89,4147,66,4148,75,4149,84,4150,84,4151,75,4152,75,4153,55,4154,55,4155,63,4156,84,4157,60,4162,84,4163,75,4164,66,4165,55,4166,75,4168,58,4170,75,4172,75,4173,75,4174,58,4175,64,4176,75,4178,66,4179,66,4180,75,4188,81,4190,75,4191,66,4192,55,4193,63,4198,64,4199,55,4200,66,4201,64,4202,70,4203,70,4204,55,4205,66,4206,63,4207,55,4208,55,4209,64,4210,64,4211,84,4212,64,4213,63,4214,66,4215,55,4216,67,4218,55,4219,84,4220,64,4221,55,4222,64,4224,55,4225,55,4229,68,4230,55,4231,55,4232,64,4234,64,4235,55,4236,55,4237,70,4238,70,4239,92,4240,92,4241,65,4242,67,4243,88,4244,92,4245,86,4246,64,4250,64,4251,64,4252,63,4253,67,4254,55,4255,55,4256,64,4257,84,4258,75,4259,55,4260,64,4261,106,4262,84,4263,64,4265,55,4266,63,4267,67,4269,75,4270,64,4271,55,4272,55,4273,82,4274,55,4275,63,4276,73,4280,84,4281,57,4282,63,4283,75,4284,66,4285,55,4286,68,4288,55,4289,84,4291,70,4292,55,4293,83,4294,84,4295,84,4296,63,4297,55,4298,90,4299,85,4300,85,4301,84,4302,60,4303,68,4306,84,4307,64,4308,84,4309,55,4310,63,4311,55,4312,84,4313,55,4314,84,4315,63,4316,55,4317,66,4318,75,4319,75,4322,80,4324,80,4326,75,4466,75,4469,75,4475,55,4483,75,4490,75,4555,66,4558,75,4608,67,4609,67,4610,74,4614,55,4619,75,4624,75,4625,55,4627,75,4636,55,4637,55,4638,67,4639,55,4657,93,4659,75,4660,55,4661,75,4666,84,4667,75,4670,75,4671,63,4674,75,4679,64,4680,64,4682,92,4683,67,4686,75,4687,75,4693,75,4694,75,4695,67,4696,64,4697,64,4702,75,4703,64,4704,55,4705,55,4706,68,4718,55,4720,80,4721,55,4723,67,4726,67,4737,75,4738,60,4740,79,4741,55,4742,75,4743,64,4744,64,4745,84,4746,84,4747,75,4748,56,4749,75,4750,75,4751,91,4752,56,4753,55,4754,55,4759,75,4761,75,4801,84,4802,55,4803,55,4804,84,4805,84,4806,55,4807,106,4808,84,4809,55,4810,105,4811,106,4816,106,4817,82,4818,84,4820,84,4821,106,4823,55,4824,55,4901,107,4902,107,4903,59,4904,84,5228,84,5229,84,5233,92,5252,75,5264,75,5340,75,5354,75,5360,75,5371,75,5373,75,5381,75,5393,75,5464,60,5467,67,5489,75,5524,55,5527,70,5546,75,5561,66,5593,75,5681,84,5886,75,6135,75,6365,75,6706,75,6881,64,6882,64,6883,55,6892,64,6894,64,6980,75,6983,75,6987,75,6990,75,7035,75,7037,75,7039,75,7041,75,7073,75,7084,75,7086,75,7133,75,7373,75,7683,76,7798,75,7844,75,7881,75,7886,75,8042,96,8043,96,8086,75,8232,75,8237,75,8240,75,8246,75,8249,75,8252,75,8255,75,8351,84,8427,75,8428,55,8449,75,8545,75,8685,75,8694,64,8699,75,8818,75,8888,75,8900,75,8902,75,8907,75,8949,75,9003,75,9006,75,9009,75,9012,75,9017,75,9068,75,9069,75,9140,75,9148,75,9153,75,37001,73,37002,69,37003,72,37004,71,37005,62,37006,91,37007,94,37008,101,37201,55,37202,92,37203,87,37204,55,37205,55,37206,64,37207,71,37208,64,37211,64,37220,67,37221,55,37222,55,37223,63,37224,55,37225,106,37226,55,37227,55,37228,64,37229,62,37230,55,37231,70,37232,55,37233,55,37235,55,37237,55,37238,55,37239,67,37240,64,37241,55,37242,55,37243,67,37252,67,37253,55,37254,64,37255,84,37257,66,37259,55,37260,67,104017,79,104018,79,104024,75,104027,75,104047,98,104050,75,104100,75,104101,84,104102,84,104103,64,104104,55,104105,84,104106,55,104107,75,104108,75,104109,67,104110,75,104111,75,104112,67,104113,67,104128,102,104129,75,104130,55,104131,84,104132,67,104133,75,104134,75,104135,66,104136,70,104137,75,104138,55,104139,106,104140,106,104223,75,104248,55,104256,92,104261,63,104286,75,104287,75,104304,63,104700,49,104701,9,104702,24,104703,15,104704,28,104705,32,104706,53,104707,46,104708,37,104709,54,104710,11,104711,14,104712,30,104713,52,104714,4,104715,4,104716,23,104717,14,104718,48,104719,29,104720,22,104721,21,104722,35,104723,21,104724,46,104725,22,104726,49,104727,45,104728,52,104729,10,104730,10,104731,21,104732,31,104733,26,104734,40,104735,19,104736,30,104737,34,104738,27,104739,46,104740,5,104741,12,104742,50,104743,9,104744,43,104745,21,104746,26,104747,25,104748,21,104749,7,104750,53,104751,6,104752,33,104753,29,104754,19,104755,41,104756,31,104757,3,104758,41,104759,25,104760,49,104761,41,104762,44,104763,50,104764,46,104765,6,104766,40,104767,16,104768,8,104769,17,104770,48,104771,42,104772,50,104773,25,104774,29,104775,25,104776,32,104777,13,104778,36,104779,47,104780,14,104781,29,104782,23,104783,38,104784,42,104785,18,104786,20,104808,51,104896,75,104900,112,104901,104,104902,103,104903,116,104904,109,104905,108,104906,169,104907,164,104908,0,104909,168,104910,141,104911,166,104912,114,104913,160,104914,151,104915,117,104916,110,104917,140,104918,115,104919,170,104920,163,104921,154,104922,158,104923,161,104924,148,104925,0,104926,159,104927,167,104928,127,104929,131,104930,145,104931,159,104932,136,104933,123,104934,139,104935,134,104936,166,104937,150,104938,137,104939,147,104940,121,104941,165,104942,128,104943,111,104944,1,104945,126,104946,152,104947,157,104948,162,104949,153,104950,156,104951,149,104952,132,104953,122,104954,160,104955,146,104956,143,104957,156,104958,120,104959,125,104960,2,104961,144,104962,142,104963,138,104964,155,104965,135,104966,133,104967,151,104968,118,104969,119,104970,124,104971,108,104972,129,104973,130,104974,113,104975,0,104990,84,104991,75,104992,84],gcsidc:[[4127,4129,67],[4135,4139,67],[4158,4161,55],[4181,4185,55],[4194,4196,55],[4226,4228,63],[4247,4249,55],[4277,4279,81],[4600,4607,64],[4621,4623,55],[4628,4633,55],[4641,4646,55],[4662,4665,55],[4676,4678,66],[4688,4692,55],[4699,4701,64],[4755,4757,75],[4763,4765,75],[4813,4815,84],[8972,8987,75],[37212,37219,55],[37245,37247,55],[37249,37251,55],[104009,104015,75],[104019,104022,75],[104114,104124,75],[104125,104127,55],[104141,104145,75],[104179,104186,75],[104257,104260,75]]},i={c:[[2e3,2035,9001],[2039,2045,9001],[2056,2062,9001],[2067,2090,9001],[2093,2135,9001],[2161,2165,9001],[2172,2180,9001],[2188,2193,9001],[2195,2198,9001],[2200,2203,9001],[2205,2213,9001],[2215,2217,9001],[2222,2224,9002],[2225,2243,9003],[2246,2250,9003],[2251,2253,9002],[2257,2264,9003],[2274,2279,9003],[2280,2282,9002],[2283,2289,9003],[2308,2313,9001],[2315,2491,9001],[2494,2576,9001],[2578,2599,9001],[2601,2693,9001],[2695,2866,9001],[2867,2869,9002],[2870,2888,9003],[2891,2895,9003],[2896,2898,9002],[2902,2908,9003],[2915,2920,9003],[2921,2923,9002],[2924,2930,9003],[2931,2933,9001],[2935,2962,9001],[2964,2968,9003],[2969,2973,9001],[2975,2978,9001],[2984,2988,9001],[2995,3051,9001],[3054,3072,9001],[3077,3079,9001],[3081,3088,9001],[3092,3101,9001],[3106,3138,9001],[3146,3151,9001],[3153,3166,9001],[3168,3172,9001],[3174,3203,9001],[3294,3313,9001],[3315,3348,9001],[3350,3358,9001],[3367,3403,9001],[3408,3416,9001],[3417,3438,9003],[3441,3446,9003],[3447,3450,9001],[3451,3453,9003],[3455,3459,9003],[3460,3478,9001],[3554,3559,9001],[3560,3570,9003],[3571,3581,9001],[3594,3597,9001],[3601,3604,9001],[3637,3639,9001],[3665,3667,9001],[3693,3695,9001],[3701,3727,9001],[3728,3739,9003],[3740,3751,9001],[3753,3760,9003],[3761,3773,9001],[3775,3777,9001],[3779,3781,9001],[3788,3791,9001],[3797,3802,9001],[3814,3816,9001],[3825,3829,9001],[3832,3841,9001],[3844,3852,9001],[3873,3885,9001],[3890,3893,9001],[3942,3950,9001],[3968,3970,9001],[3973,3976,9001],[3986,3989,9001],[3994,3997,9001],[4001,4016,9102],[4018,4025,9102],[4027,4029,9102],[4031,4036,9102],[4044,4047,9102],[4048,4051,9001],[4052,4054,9102],[4056,4063,9001],[4093,4096,9001],[4120,4124,9102],[4127,4139,9102],[4141,4176,9102],[4178,4185,9102],[4188,4216,9102],[4218,4232,9102],[4235,4260,9102],[4265,4267,9102],[4269,4286,9102],[4292,4304,9102],[4306,4319,9102],[4390,4398,9001],[4399,4413,9003],[4418,4433,9003],[4455,4457,9003],[4484,4489,9001],[4491,4554,9001],[4568,4589,9001],[4600,4630,9102],[4636,4639,9102],[4641,4646,9102],[4652,4656,9001],[4657,4680,9102],[4682,4684,9102],[4686,4765,9102],[4766,4800,9001],[4801,4806,9102],[4813,4815,9102],[5014,5016,9001],[5069,5072,9001],[5105,5130,9001],[5173,5188,9001],[5253,5259,9001],[5269,5275,9001],[5292,5311,9001],[5329,5331,9001],[5343,5349,9001],[5355,5357,9001],[5459,5463,9001],[5479,5482,9001],[5518,5520,9001],[5533,5539,9001],[5550,5552,9001],[5562,5583,9001],[5623,5625,9003],[5631,5639,9001],[5649,5653,9001],[5663,5680,9001],[5682,5685,9001],[5875,5877,9001],[5896,5899,9001],[5921,5940,9001],[6050,6125,9001],[6244,6275,9001],[6328,6348,9001],[6350,6356,9001],[6366,6372,9001],[6381,6387,9001],[6393,6404,9001],[6480,6483,9001],[6511,6514,9001],[6579,6581,9001],[6619,6624,9001],[6625,6627,9003],[6628,6632,9001],[6634,6637,9001],[6669,6692,9001],[6707,6709,9001],[6720,6723,9001],[6732,6738,9001],[6881,6883,9102],[6931,6933,9001],[7005,7007,9001],[7057,7070,9003],[7074,7082,9001],[7109,7118,9001],[7119,7127,9002],[7374,7376,9001],[7528,7586,9001],[7587,7645,9003],[7692,7696,9001],[7755,7787,9001],[7791,7795,9001],[7799,7801,9001],[7803,7805,9001],[7825,7831,9001],[7845,7859,9001],[8013,8032,9001],[8065,8068,9002],[8518,8529,9003],[8533,8536,9003],[8538,8540,9003],[8677,8679,9001],[8836,8840,9001],[8857,8859,9001],[8908,8910,9001],[8972,9e3,9102],[9053,9057,9102],[9059,9069,9102],[9154,9159,9001],[9205,9218,9001],[20002,20032,9001],[20062,20092,9001],[20135,20138,9001],[20248,20258,9001],[20348,20358,9001],[20436,20440,9001],[20822,20824,9001],[20934,20936,9001],[21035,21037,9001],[21095,21097,9001],[21148,21150,9001],[21413,21423,9001],[21473,21483,9001],[21780,21782,9001],[21896,21899,9001],[22171,22177,9001],[22181,22187,9001],[22191,22197,9001],[22234,22236,9001],[22521,22525,9001],[22991,22994,9001],[23028,23038,9001],[23830,23853,9001],[23866,23872,9001],[23877,23884,9001],[23886,23894,9001],[23946,23948,9001],[24311,24313,9001],[24342,24347,9001],[24370,24374,9084],[24375,24381,9001],[24718,24721,9001],[24817,24821,9001],[24877,24882,9001],[24891,24893,9001],[25391,25395,9001],[25828,25838,9001],[26191,26195,9001],[26391,26393,9001],[26701,26722,9001],[26729,26746,9003],[26748,26760,9003],[26766,26799,9003],[26847,26870,9003],[26891,26899,9001],[26901,26923,9001],[26929,26946,9001],[26948,26978,9001],[26980,26998,9001],[27037,27040,9001],[27205,27232,9001],[27258,27260,9001],[27391,27398,9001],[27561,27564,9001],[27571,27574,9001],[27581,27584,9001],[27591,27594,9001],[28191,28193,9001],[28348,28358,9001],[28402,28432,9001],[28462,28492,9001],[29168,29172,9001],[29187,29195,9001],[29901,29903,9001],[30161,30179,9001],[30491,30494,9001],[30729,30732,9001],[31251,31259,9001],[31265,31268,9001],[31275,31277,9001],[31281,31290,9001],[31466,31469,9001],[31491,31495,9001],[31965,32e3,9001],[32001,32003,9003],[32005,32017,9003],[32019,32028,9003],[32033,32035,9003],[32037,32060,9003],[32064,32067,9003],[32081,32086,9001],[32107,32130,9001],[32133,32158,9001],[32164,32167,9003],[32180,32199,9001],[32201,32260,9001],[32301,32360,9001],[32601,32662,9001],[32664,32667,9003],[32701,32761,9001],[37002,37008,9102],[53001,53004,9001],[53008,53019,9001],[53021,53032,9001],[53034,53037,9001],[53042,53046,9001],[53074,53080,9001],[54001,54004,9001],[54008,54019,9001],[54021,54032,9001],[54042,54046,9001],[54048,54053,9001],[54074,54080,9001],[54098,54101,9001],[102001,102005,9001],[102007,102039,9001],[102042,102045,9001],[102060,102063,9001],[102070,102079,9001],[102096,102099,9001],[102101,102109,9001],[102114,102117,9001],[102132,102138,9001],[102141,102144,9001],[102156,102166,9001],[102173,102179,9001],[102191,102198,9001],[102221,102228,9001],[102231,102233,9001],[102237,102240,9001],[102364,102375,9001],[102389,102398,9003],[102399,102419,9001],[102421,102438,9001],[102445,102447,9003],[102450,102458,9001],[102459,102462,9003],[102470,102489,9001],[102550,102556,9001],[102562,102588,9001],[102629,102640,9003],[102648,102650,9003],[102688,102690,9003],[102696,102700,9003],[102701,102703,9001],[102799,102900,9001],[103166,103168,9002],[103220,103224,9001],[103225,103227,9002],[103232,103237,9001],[103238,103243,9003],[103244,103246,9001],[103247,103249,9003],[103254,103256,9001],[103257,103259,9003],[103264,103266,9001],[103267,103269,9003],[103327,103330,9001],[103344,103347,9001],[103372,103375,9001],[103381,103383,9001],[103384,103386,9002],[103387,103389,9001],[103390,103392,9003],[103397,103399,9001],[103427,103430,9003],[103444,103447,9003],[103476,103478,9001],[103479,103481,9003],[103486,103488,9001],[103489,103491,9003],[103492,103495,9001],[103496,103499,9003],[103539,103543,9001],[103544,103548,9003],[103549,103551,9001],[103552,103554,9002],[103555,103557,9003],[103558,103560,9001],[103571,103573,9001],[103574,103576,9003],[103577,103580,9001],[103581,103583,9003],[103595,103597,9001],[103600,103694,9001],[103696,103698,9001],[103700,103793,9003],[104101,104103,9102],[104126,104131,9102],[104259,104261,9102],[104700,104786,9102],[104900,104975,9102]],nc:[2065,9001,2066,9039,2136,9094,2137,9001,2138,9001,2154,9001,2157,9001,2158,9001,2159,9094,2160,9094,2169,9001,2170,9001,2204,9003,2219,9001,2220,9001,2254,9003,2255,9003,2256,9002,2265,9002,2266,9002,2267,9003,2268,9003,2269,9002,2270,9002,2271,9003,2272,9003,2273,9002,2290,9001,2294,9001,2295,9001,2314,9005,2899,9003,2900,9003,2901,9002,2909,9002,2910,9002,2911,9003,2912,9003,2913,9002,2914,9002,2980,9001,2981,9001,2991,9001,2992,9002,2993,9001,2994,9002,3074,9001,3075,9001,3080,9002,3089,9003,3090,9001,3091,9003,3102,9003,3141,9001,3142,9001,3167,9301,3360,9001,3361,9002,3362,9001,3363,9003,3364,9001,3365,9003,3404,9003,3405,9001,3406,9001,3407,9005,3439,9001,3440,9001,3479,9002,3480,9001,3481,9002,3482,9001,3483,9002,3484,9001,3485,9003,3486,9001,3487,9003,3488,9001,3489,9001,3490,9003,3491,9001,3492,9003,3493,9001,3494,9003,3495,9001,3496,9003,3497,9001,3498,9003,3499,9001,3500,9003,3501,9001,3502,9003,3503,9001,3504,9003,3505,9001,3506,9003,3507,9001,3508,9003,3509,9001,3510,9003,3511,9001,3512,9003,3513,9001,3514,9001,3515,9003,3516,9001,3517,9003,3518,9001,3519,9003,3520,9001,3521,9003,3522,9001,3523,9003,3524,9001,3525,9003,3526,9001,3527,9003,3528,9001,3529,9003,3530,9001,3531,9003,3532,9001,3533,9003,3534,9001,3535,9003,3536,9001,3537,9003,3538,9001,3539,9003,3540,9001,3541,9003,3542,9001,3543,9003,3544,9001,3545,9003,3546,9001,3547,9003,3548,9001,3549,9003,3550,9001,3551,9003,3552,9001,3553,9003,3582,9003,3583,9001,3584,9003,3585,9001,3586,9003,3587,9001,3588,9002,3589,9001,3590,9002,3591,9001,3592,9001,3593,9002,3598,9003,3599,9001,3600,9003,3605,9002,3606,9001,3607,9001,3608,9003,3609,9001,3610,9003,3611,9001,3612,9003,3613,9001,3614,9003,3615,9001,3616,9003,3617,9001,3618,9003,3619,9001,3620,9003,3621,9001,3622,9003,3623,9001,3624,9003,3625,9001,3626,9003,3627,9001,3628,9003,3629,9001,3630,9003,3631,9001,3632,9003,3633,9001,3634,9002,3635,9001,3636,9002,3640,9003,3641,9001,3642,9003,3643,9001,3644,9002,3645,9001,3646,9002,3647,9001,3648,9002,3649,9001,3650,9003,3651,9001,3652,9003,3653,9001,3654,9003,3655,9001,3656,9002,3657,9001,3658,9003,3659,9001,3660,9003,3661,9001,3662,9003,3663,9001,3664,9003,3668,9003,3669,9001,3670,9003,3671,9001,3672,9003,3673,9001,3674,9003,3675,9001,3676,9002,3677,9003,3678,9001,3679,9002,3680,9003,3681,9001,3682,9002,3683,9003,3684,9001,3685,9001,3686,9003,3687,9001,3688,9003,3689,9001,3690,9003,3691,9001,3692,9003,3696,9003,3697,9001,3698,9003,3699,9001,3700,9003,3783,9001,3784,9001,3793,9001,3794,9001,3812,9001,3819,9102,3821,9102,3824,9102,3854,9001,3857,9001,3889,9102,3906,9102,3911,9001,3912,9001,3920,9001,3978,9001,3979,9001,3991,9003,3992,9003,4026,9001,4037,9001,4038,9001,4042,9102,4071,9001,4075,9102,4081,9102,4082,9001,4083,9001,4087,9001,4088,9001,4217,9003,4261,9105,4262,9102,4263,9102,4288,9102,4289,9102,4322,9102,4324,9102,4326,9102,4414,9001,4415,9001,4417,9001,4434,9001,4437,9001,4438,9003,4439,9003,4462,9001,4463,9102,4467,9001,4470,9102,4471,9001,4475,9102,4483,9102,4490,9102,4555,9102,4558,9102,4559,9001,4632,9102,4633,9102,4647,9001,4807,9105,4808,9102,4809,9102,4810,9105,4811,9105,4816,9105,4817,9102,4818,9102,4820,9102,4821,9105,4822,9001,4823,9102,4824,9102,4826,9001,4839,9001,4901,9105,4902,9105,4903,9102,4904,9102,5013,9102,5018,9001,5048,9001,5167,9001,5168,9001,5221,9001,5223,9001,5228,9102,5229,9102,5233,9102,5234,9001,5235,9001,5243,9001,5246,9102,5247,9001,5252,9102,5264,9102,5266,9001,5316,9001,5320,9001,5321,9001,5324,9102,5325,9001,5337,9001,5340,9102,5354,9102,5360,9102,5361,9001,5362,9001,5365,9102,5367,9001,5371,9102,5373,9102,5381,9102,5382,9001,5383,9001,5387,9001,5389,9001,5393,9102,5396,9001,5451,9102,5456,9001,5457,9001,5464,9102,5467,9102,5469,9001,5472,9037,5489,9102,5490,9001,5513,9001,5514,9001,5523,9001,5524,9102,5527,9102,5530,9001,5531,9001,5546,9102,5559,9001,5561,9102,5588,9002,5589,9005,5593,9102,5596,9001,5627,9001,5629,9001,5641,9001,5643,9001,5644,9001,5646,9003,5654,9003,5655,9003,5659,9001,5681,9102,5700,9001,5825,9001,5836,9001,5837,9001,5839,9001,5842,9001,5844,9001,5858,9001,5879,9001,5880,9001,5886,9102,5887,9001,5890,9001,6128,9002,6129,9002,6135,9102,6204,9001,6207,9102,6210,9001,6211,9001,6307,9001,6311,9102,6312,9001,6316,9001,6318,9102,6322,9102,6325,9102,6362,9001,6365,9102,6391,9002,6405,9002,6406,9001,6407,9002,6408,9001,6409,9002,6410,9001,6411,9003,6412,9001,6413,9003,6414,9001,6415,9001,6416,9003,6417,9001,6418,9003,6419,9001,6420,9003,6421,9001,6422,9003,6423,9001,6424,9003,6425,9001,6426,9003,6427,9001,6428,9003,6429,9001,6430,9003,6431,9001,6432,9003,6433,9001,6434,9003,6435,9001,6436,9003,6437,9001,6438,9003,6439,9001,6440,9001,6441,9003,6442,9001,6443,9003,6444,9001,6445,9003,6446,9001,6447,9003,6448,9001,6449,9003,6450,9001,6451,9003,6452,9001,6453,9003,6454,9001,6455,9003,6456,9001,6457,9003,6458,9001,6459,9003,6460,9001,6461,9003,6462,9001,6463,9003,6464,9001,6465,9003,6466,9001,6467,9003,6468,9001,6469,9003,6470,9001,6471,9003,6472,9001,6473,9003,6474,9001,6475,9003,6476,9001,6477,9003,6478,9001,6479,9003,6484,9003,6485,9001,6486,9003,6487,9001,6488,9003,6489,9001,6490,9003,6491,9001,6492,9003,6493,9001,6494,9002,6495,9001,6496,9002,6497,9001,6498,9001,6499,9002,6500,9001,6501,9003,6502,9001,6503,9003,6504,9001,6505,9003,6506,9001,6507,9003,6508,9001,6509,9001,6510,9003,6515,9002,6516,9001,6518,9001,6519,9003,6520,9001,6521,9003,6522,9001,6523,9003,6524,9001,6525,9003,6526,9001,6527,9003,6528,9001,6529,9003,6530,9001,6531,9003,6532,9001,6533,9003,6534,9001,6535,9003,6536,9001,6537,9003,6538,9001,6539,9003,6540,9001,6541,9003,6542,9001,6543,9003,6544,9001,6545,9002,6546,9001,6547,9002,6548,9001,6549,9003,6550,9001,6551,9003,6552,9001,6553,9003,6554,9001,6555,9003,6556,9001,6557,9002,6558,9001,6559,9002,6560,9001,6561,9002,6562,9001,6563,9003,6564,9001,6565,9003,6566,9001,6567,9001,6568,9003,6569,9001,6570,9002,6571,9001,6572,9003,6573,9001,6574,9003,6575,9001,6576,9003,6577,9001,6578,9003,6582,9003,6583,9001,6584,9003,6585,9001,6586,9003,6587,9001,6588,9003,6589,9001,6590,9003,6591,9001,6592,9001,6593,9003,6594,9001,6595,9003,6596,9001,6597,9003,6598,9001,6599,9003,6600,9001,6601,9003,6602,9001,6603,9003,6605,9003,6606,9001,6607,9003,6608,9001,6609,9003,6610,9001,6611,9001,6612,9003,6613,9001,6614,9003,6615,9001,6616,9003,6617,9001,6618,9003,6633,9003,6646,9001,6668,9102,6703,9001,6706,9102,6783,9102,6784,9001,6785,9002,6786,9001,6787,9002,6788,9001,6789,9002,6790,9001,6791,9002,6792,9001,6793,9002,6794,9001,6795,9002,6796,9001,6797,9002,6798,9001,6799,9002,6800,9001,6801,9002,6802,9001,6803,9002,6804,9001,6805,9002,6806,9001,6807,9002,6808,9001,6809,9002,6810,9001,6811,9002,6812,9001,6813,9002,6814,9001,6815,9002,6816,9001,6817,9002,6818,9001,6819,9002,6820,9001,6821,9002,6822,9001,6823,9002,6824,9001,6825,9002,6826,9001,6827,9002,6828,9001,6829,9002,6830,9001,6831,9002,6832,9001,6833,9002,6834,9001,6835,9002,6836,9001,6837,9002,6838,9001,6839,9002,6840,9001,6841,9002,6842,9001,6843,9002,6844,9001,6845,9002,6846,9001,6847,9002,6848,9001,6849,9002,6850,9001,6851,9002,6852,9001,6853,9002,6854,9001,6855,9002,6856,9001,6857,9002,6858,9001,6859,9002,6860,9001,6861,9002,6862,9001,6863,9002,6867,9001,6868,9002,6870,9001,6875,9001,6876,9001,6879,9001,6880,9003,6884,9001,6885,9002,6886,9001,6887,9002,6892,9102,6894,9102,6915,9001,6922,9001,6923,9003,6924,9001,6925,9003,6962,9001,6983,9102,6984,9001,6990,9102,6991,9001,7035,9102,7037,9102,7039,9102,7041,9102,7073,9102,7084,9102,7086,9102,7128,9003,7131,9001,7132,9003,7133,9102,7136,9102,7139,9102,7142,9001,7257,9001,7258,9003,7259,9001,7260,9003,7261,9001,7262,9003,7263,9001,7264,9003,7265,9001,7266,9003,7267,9001,7268,9003,7269,9001,7270,9003,7271,9001,7272,9003,7273,9001,7274,9003,7275,9001,7276,9003,7277,9001,7278,9003,7279,9001,7280,9003,7281,9001,7282,9003,7283,9001,7284,9003,7285,9001,7286,9003,7287,9001,7288,9003,7289,9001,7290,9003,7291,9001,7292,9003,7293,9001,7294,9003,7295,9001,7296,9003,7297,9001,7298,9003,7299,9001,7300,9003,7301,9001,7302,9003,7303,9001,7304,9003,7305,9001,7306,9003,7307,9001,7308,9003,7309,9001,7310,9003,7311,9001,7312,9003,7313,9001,7314,9003,7315,9001,7316,9003,7317,9001,7318,9003,7319,9001,7320,9003,7321,9001,7322,9003,7323,9001,7324,9003,7325,9001,7326,9003,7327,9001,7328,9003,7329,9001,7330,9003,7331,9001,7332,9003,7333,9001,7334,9003,7335,9001,7336,9003,7337,9001,7338,9003,7339,9001,7340,9003,7341,9001,7342,9003,7343,9001,7344,9003,7345,9001,7346,9003,7347,9001,7348,9003,7349,9001,7350,9003,7351,9001,7352,9003,7353,9001,7354,9003,7355,9001,7356,9003,7357,9001,7358,9003,7359,9001,7360,9003,7361,9001,7362,9003,7363,9001,7364,9003,7365,9001,7366,9003,7367,9001,7368,9003,7369,9001,7370,9003,7373,9102,7683,9102,7798,9102,7844,9102,7877,9001,7878,9001,7881,9102,7882,9001,7883,9001,7886,9102,7887,9001,7899,9001,7991,9001,7992,9001,8035,9003,8036,9003,8042,9102,8043,9102,8058,9001,8059,9001,8082,9001,8083,9001,8086,9102,8088,9001,8090,9001,8091,9003,8092,9001,8093,9003,8095,9001,8096,9003,8097,9001,8098,9003,8099,9001,8100,9003,8101,9001,8102,9003,8103,9001,8104,9003,8105,9001,8106,9003,8107,9001,8108,9003,8109,9001,8110,9003,8111,9001,8112,9003,8113,9001,8114,9003,8115,9001,8116,9003,8117,9001,8118,9003,8119,9001,8120,9003,8121,9001,8122,9003,8123,9001,8124,9003,8125,9001,8126,9003,8127,9001,8128,9003,8129,9001,8130,9003,8131,9001,8132,9003,8133,9001,8134,9003,8135,9001,8136,9003,8137,9001,8138,9003,8139,9001,8140,9003,8141,9001,8142,9003,8143,9001,8144,9003,8145,9001,8146,9003,8147,9001,8148,9003,8149,9001,8150,9003,8151,9001,8152,9003,8153,9001,8154,9003,8155,9001,8156,9003,8157,9001,8158,9003,8159,9001,8160,9003,8161,9001,8162,9003,8163,9001,8164,9003,8165,9001,8166,9003,8167,9001,8168,9003,8169,9001,8170,9003,8171,9001,8172,9003,8173,9001,8177,9003,8179,9001,8180,9003,8181,9001,8182,9003,8184,9001,8185,9003,8187,9001,8189,9003,8191,9001,8193,9003,8196,9001,8197,9003,8198,9001,8200,9003,8201,9001,8202,9003,8203,9001,8204,9003,8205,9001,8206,9003,8207,9001,8208,9003,8209,9001,8210,9003,8212,9001,8213,9003,8214,9001,8216,9003,8218,9001,8220,9003,8222,9001,8224,9003,8225,9001,8226,9003,8232,9102,8237,9102,8240,9102,8246,9102,8249,9102,8252,9102,8255,9102,8311,9001,8312,9002,8313,9001,8314,9002,8315,9001,8316,9002,8317,9001,8318,9002,8319,9001,8320,9002,8321,9001,8322,9002,8323,9001,8324,9002,8325,9001,8326,9002,8327,9001,8328,9002,8329,9001,8330,9002,8331,9001,8332,9002,8333,9001,8334,9002,8335,9001,8336,9002,8337,9001,8338,9002,8339,9001,8340,9002,8341,9001,8342,9002,8343,9001,8344,9002,8345,9001,8346,9002,8347,9001,8348,9002,8351,9102,8352,9001,8353,9001,8379,9001,8380,9003,8381,9001,8382,9003,8383,9001,8384,9003,8385,9001,8387,9003,8391,9001,8395,9001,8427,9102,8428,9102,8431,9102,8433,9001,8441,9001,8455,9001,8456,9001,8531,9003,8545,9102,8682,9001,8685,9102,8687,9001,8692,9001,8693,9001,8694,9102,8699,9102,8818,9102,8826,9001,8860,9102,8888,9102,8900,9102,8902,9102,8903,9001,8907,9102,8949,9102,8950,9001,8951,9001,9003,9102,9006,9102,9009,9102,9012,9102,9014,9102,9017,9102,9019,9102,9039,9001,9040,9001,9140,9102,9141,9001,9148,9102,9149,9001,9150,9001,9153,9102,9191,9001,9221,9001,9222,9001,20499,9001,20538,9001,20539,9001,20790,9001,20791,9001,21291,9001,21292,9001,21500,9001,21817,9001,21818,9001,22032,9001,22033,9001,22091,9001,22092,9001,22332,9001,22391,9001,22392,9001,22700,9001,22770,9001,22780,9001,22832,9001,23090,9001,23095,9001,23239,9001,23240,9001,23700,9001,24047,9001,24048,9001,24100,9005,24200,9001,24305,9001,24306,9001,24382,9084,24383,9001,24500,9001,24547,9001,24548,9001,24571,9062,24600,9001,25e3,9001,25231,9001,25884,9001,25932,9001,26237,9001,26331,9001,26332,9001,26591,9001,26592,9001,26632,9001,26692,9001,27120,9001,27200,9001,27291,9040,27292,9040,27429,9001,27493,9001,27500,9001,27700,9001,28232,9001,28600,9001,28991,9001,28992,9001,29101,9001,29220,9001,29221,9001,29333,9001,29635,9001,29636,9001,29701,9001,29738,9001,29739,9001,29849,9001,29850,9001,29871,9042,29872,9041,29873,9001,30200,9039,30339,9001,30340,9001,30791,9001,30792,9001,31028,9001,31121,9001,31154,9001,31170,9001,31171,9001,31279,9001,31370,9001,31528,9001,31529,9001,31600,9001,31700,9001,31838,9001,31839,9001,31901,9001,32030,9003,32031,9003,32061,9001,32062,9001,32098,9001,32099,9003,32100,9001,32104,9001,32161,9001,32766,9001,37202,9102,37203,9102,37206,9102,37207,9102,37218,9102,37221,9102,37225,9105,37240,9102,37241,9102,37243,9102,37245,9102,37249,9102,37257,9102,37260,9102,53048,9001,53049,9001,54034,9001,54090,9001,54091,9001,65061,9003,65062,9003,65161,9001,102041,9003,102064,9085,102068,109030,102069,109031,102093,9001,102094,9001,102118,9003,102120,9003,102121,9003,102122,9001,102150,9001,102168,9001,102204,9001,102212,9001,102213,9001,102215,9001,102216,9001,102217,9003,102218,9001,102219,9003,102220,9003,102247,9001,102299,9001,102306,9001,102319,9001,102328,9001,102329,9001,102359,9001,102360,9001,102440,9001,102448,9001,102464,9003,102465,9003,102491,9001,102492,9001,102498,9001,102499,9001,102525,9003,102526,9003,102528,9003,102529,9003,102589,9003,102598,9001,102599,9003,102600,9003,102604,9003,102661,9003,102662,9003,102664,9003,102665,9003,102705,9003,102720,9003,102721,9003,102726,9003,102727,9003,102733,9003,102761,9003,102766,9003,102974,9003,103228,9001,103229,9001,103230,9003,103231,9003,103250,9001,103251,9003,103252,9001,103253,9003,103260,9001,103261,9001,103262,9003,103263,9003,103270,9001,103271,9001,103272,9003,103273,9003,103274,9001,103275,9001,103276,9003,103277,9003,103278,9001,103279,9001,103280,9003,103281,9003,103282,9001,103283,9001,103284,9003,103285,9003,103286,9001,103287,9003,103288,9001,103289,9003,103290,9001,103291,9003,103292,9001,103293,9001,103294,9003,103295,9003,103296,9001,103297,9001,103298,9003,103299,9003,103300,9001,103307,9001,103313,9001,103319,9001,103322,9001,103323,9001,103332,9001,103335,9001,103338,9001,103340,9001,103351,9001,103358,9001,103370,9001,103376,9003,103377,9001,103378,9001,103379,9003,103380,9003,103393,9001,103394,9001,103395,9003,103396,9003,103400,9003,103407,9003,103413,9003,103419,9003,103422,9003,103423,9003,103432,9003,103435,9003,103438,9003,103440,9003,103451,9003,103458,9003,103470,9003,103472,9001,103473,9002,103474,9001,103475,9003,103482,9001,103483,9003,103484,9001,103485,9003,103500,9001,103501,9003,103502,9001,103503,9001,103504,9002,103505,9002,103506,9001,103507,9001,103508,9003,103509,9003,103510,9001,103511,9001,103512,9003,103513,9003,103514,9001,103515,9003,103516,9001,103517,9003,103518,9001,103519,9003,103520,9001,103521,9002,103522,9001,103523,9001,103524,9003,103525,9003,103526,9001,103527,9003,103561,9003,103562,9003,103563,9001,103564,9001,103565,9003,103566,9003,103567,9001,103568,9001,103569,9003,103570,9003,103585,9003,103586,9001,103587,9003,103588,9002,103589,9001,103590,9003,103591,9002,103592,9001,103593,9003,103594,9002,103695,9003,103846,9001,103946,9003,104009,9102,104017,9102,104018,9102,104022,9102,104024,9102,104027,9102,104047,9102,104050,9102,104105,9102,104106,9102,104109,9102,104112,9102,104113,9102,104134,9102,104135,9102,104138,9102,104139,9105,104140,9105,104808,9102]};t.wr=function(){function t(){}return t.Sy=function(e){!1===t.xp&&t.yt();var i=t.FQ(e);if(-1==i){var n=t.Bx(e);n!=e&&(i=t.Sy(n))}return-1==i&&(n=t.FK(e))!=e&&(i=t.Sy(n)),i},t.FQ=function(e){return void 0!==t.Fw[e]?t.Fw[e]:-1},t.CQ=function(e){!1===t.xp&&t.yt();var i=t.nF(e);if(1e38==i){var n=t.Bx(e);if(n!=e&&(i=t.nF(n)),1e38==i)return 1e-10}return i},t.ZS=function(e){if(void 0!==t.Is[e])return!0;var i=t.Bx(e);return i!=e&&void 0!==t.Is[i]},t.aT=function(e){if(void 0!==t.xo[e])return!0;var i=t.Bx(e);return i!=e&&void 0!==t.xo[i]},t.nF=function(e){return!1===t.xp&&t.yt(),void 0!==t.Is[e]?t.Is[e]:void 0!==t.xo[e]?t.xo[e]:1e38},t.FK=function(e){return!1===t.xp&&t.yt(),void 0!==t.WA[e]?t.WA[e]:e},t.Bx=function(e){return!1===t.xp&&t.yt(),void 0!==t.XA[e]?t.XA[e]:e},t.yt=function(){for(var n,r=e,s=0;s<r.pcsid.length;s+=2)t.xo[r.pcsid[s]]=r.pcstol[2*r.pcsid[s+1]+1];for(s=0;s<r.pcsidc.length;s+=1)for(var o=(n=r.pcsidc[s])[0];o<=n[1];o++)t.xo[o]=r.pcstol[2*n[2]+1];for(s=0;s<r.gcsid.length;s+=2)t.Is[r.gcsid[s]]=r.gcstol[2*r.gcsid[s+1]+1];for(s=0;s<r.gcsidc.length;s+=1)for(o=(n=r.gcsidc[s])[0];o<=n[1];o++)t.xo[o]=r.gcstol[2*n[2]+1];for(s=0;s<i.c.length;s+=1)for(o=(n=i.c[s])[0];o<=n[1];o++)t.Fw[o]=n[2];for(s=0;s<i.nc.length;s+=2)t.Fw[i.nc[s]]=i.nc[s+1];for(i=null,s=0;s<r.newtoold.length;s+=2)t.WA[r.newtoold[s+1]]=r.newtoold[s],t.XA[r.newtoold[s]]=r.newtoold[s+1];e=null,t.xp=!0},t.xp=!1,t.Is=[],t.xo=[],t.WA=[],t.XA=[],t.Fw=[],t}()}(X||(X={})),function(t){function e(t){return 0===t.length?'""':'"'==t[0]||"."==t[0]||"0"<=t[0]&&"9">=t[0]?t:'"'+t.trim()+'"'}var i=[];t.XC=function(){function n(){}return n.EQ=function(r){try{for(var s=0;s<i.length;s++)if(i[s].wkttext===r)return i[s].unit;for(var o,a=s="",h=!1,l=0;l<r.length;l++){var c=r[l];!0===h?'"'==c?'"'==r[l+1]?s+=c:h=h=!1:s+=c:/[\s]/.test(c)||(","==c?(a=""!==s?a+(e(s)+","):a+",",s=""):")"==c||"]"==c?(a=""!==s?a+(e(s)+"]}"):a+"]}",s=""):"("==c||"["==c?(a+='{ "entity": "'+s.toUpperCase().trim()+'", "values":[',s=""):'"'==c?(h=!0,s=""):s+=c)}o=JSON.parse(a);var u=n.mF(o);if(null===u)return null;for(o=null,c=0;c<u.values.length;c++)if("object"==typeof u.values[c]&&("UNIT"===u.values[c].entity||"ANGLEUNIT"===u.values[c].entity||"LENGTHUNIT"===u.values[c].entity)){o=u.values[c];break}if(null===o)return null;var d=t.Tc.ZO("GEOGCS"===u.entity||"GEOGCRS"===u.entity?1:0,o.values[1],o.values[2]);return i.push({wkttext:r,unit:d}),10<i.length&&i.shift(),d}catch(t){return null}},n.mF=function(t){if(null===t)return null;switch(t.entity){case"GEOGCRS":case"GEOGCS":case"PROJCRS":case"PROJCS":return t}for(var e=[],i=0;i<t.values.length;i++)if("object"==typeof t.values[i]&&void 0!==t.values[i].entity)switch(t.values[i].entity){case"GEOGCRS":case"GEOGCS":case"PROJCRS":case"PROJCS":return t.values[i];default:e.push(t.values[i])}for(t=0;t<e.length;t++)if(null!==(i=n.mF(e[t])))return i;return null},n.DQ=function(t){var e=-1;if(null!=t&&0<t.length){var i=t.search(/PROJCR?S/);if(0<=i){var n=0;if(0<=(i=t.lastIndexOf("UNIT"))&&0<(i=t.indexOf(",",i+4))){i++;var r=t.indexOf("]",i+1);if(0<r)try{n=parseFloat(t.substring(i,r))}catch(t){n=0}}0<n&&(e=.001/n)}else if(0<=(i=t.search(/GEOGCR?S/))){var s=0;if(n=0,-1===(i=t.indexOf("SPHEROID",i+6))&&(i=t.indexOf("ELLIPSOID",i+7)),0<i&&0<(i=t.indexOf(",",i+8))){if(i++,0<(r=t.indexOf(",",i+1)))try{s=parseFloat(t.substring(i,r))}catch(t){s=0}if(0<s&&(-1===(i=t.lastIndexOf("ANGLEUNIT",r+1))&&(i=t.lastIndexOf("UNIT",r+1)),0<=i&&0<(i=t.indexOf(",",i+4))&&(i++,0<(r=t.indexOf("]",i+1)))))try{n=parseFloat(t.substring(i,r))}catch(t){n=0}}0<s&&0<n&&(e=.001/(s*n))}}return e},n}()}(X||(X={})),function(t){var e;(e=t.eL||(t.eL={}))[e.NONE=0]="NONE",e[e.LINEAR=1]="LINEAR",e[e.ANGULAR=2]="ANGULAR",function(t){t[t.enumFloat=0]="enumFloat",t[t.enumDouble=1]="enumDouble",t[t.enumInt32=2]="enumInt32",t[t.enumInt64=3]="enumInt64",t[t.enumInt8=4]="enumInt8",t[t.enumInt16=5]="enumInt16"}(t.QL||(t.QL={})),function(t){t[t.POSITION=0]="POSITION",t[t.Z=1]="Z",t[t.M=2]="M",t[t.ID=3]="ID",t[t.NORMAL=4]="NORMAL",t[t.TEXTURE1D=5]="TEXTURE1D",t[t.TEXTURE2D=6]="TEXTURE2D",t[t.TEXTURE3D=7]="TEXTURE3D",t[t.ID2=8]="ID2",t[t.MAXSEMANTICS=10]="MAXSEMANTICS"}(t.Ih||(t.Ih={}));var i=function(){function e(t,i){if(this.Vs=this.Ae=null,this.Oq=this.Aa=0,this.uh=this.bg=null,this.wl=0,void 0!==i){for(this.Aa=i.Aa,this.Oq=i.Oq,this.bg=i.bg.slice(0),this.uh=i.uh.slice(0),this.wl=i.wl,this.Vs=[],t=i=0;t<this.Aa;t++)this.Vs[t]=i,i+=e.Va(this.bg[t]);for(this.Oq=i,this.Ae=[],t=0;t<this.Aa;t++){i=e.Va(this.kd(t));for(var n=e.se(this.kd(t)),r=0;r<i;r++)this.Ae[this.Vs[t]+r]=n}}else this.Oq=this.Aa=0}return e.prototype.kd=function(e){if(0>e||e>this.Aa)throw t.i.N();return this.bg[e]},e.prototype.Pf=function(t){return this.uh[t]},e.lz=function(t){return e.JM[t]},e.Tp=function(t){return e.SM[t]},e.Va=function(t){return e.rM[t]},e.prototype.hasAttribute=function(t){return 0<=this.uh[t]},e.prototype.iG=function(){return this.hasAttribute(1)},e.se=function(t){return e.eD[t]},e.prototype.LR=function(t){return this.Vs[t]},e.DG=function(t,i){return e.eD[t]===i},e.prototype.Nb=function(t){return this===t},e.prototype.An=function(){for(var e=t.O.Th(this.bg[0]),i=1;i<this.Aa;i++)e=t.O.Th(this.bg[i],e);return e},e.prototype.$j=function(t){return this.Vs[t]},e.prototype.cc=function(){return this.wl},e.prototype.Ed=function(t){return this.bg[t]},e.eD=[0,0,NaN,0,0,0,0,0,0],e.JM=[1,1,1,0,2,1,1,1,0],e.SM=[1,1,1,2,0,0,0,0,2],e.rM=[2,1,1,1,3,1,2,3,2],e}();t.ra=i}(X||(X={})),function(t){function e(t,e,n){var s=e-(t=new a(t)).e,o=t.c;for(o.length>++e&&i(t,s,a.eu),o[0]?n?s=e:(o=t.c,s=t.e+s+1):++s;o.length<s;o.push(0));return s=t.e,1===n||n&&(e<=s||s<=r)?(0>t.Bd&&o[0]?"-":"")+(1<o.length?o[0]+"."+o.join("").slice(1):o[0])+(0>s?"e":"e+")+s:t.toString()}function i(t,e,i,r){var s=t.c,o=t.e+e+1;if(1===i?r=5<=s[o]:2===i?r=5<s[o]||5==s[o]&&(r||0>o||void 0!==s[o+1]||1&s[o-1]):3===i?r=r||void 0!==s[o]||0>o:(r=!1,0!==i&&n("!Big.RM!")),1>o||!s[0])r?(t.e=-e,t.c=[1]):t.c=[t.e=0];else{if(s.length=o--,r)for(;9<++s[o];)s[o]=0,o--||(++t.e,s.unshift(1));for(o=s.length;!s[--o];s.pop());}return t}function n(t){throw(t=Error(t)).name="BigError",t}var r=-7,s=21,o=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,a=function(){function t(e){if(e instanceof t)this.Bd=e.Bd,this.e=e.e,this.c=e.c.slice();else{var i,r,s;for(0===e&&0>1/e?e="-0":o.test(e+="")||n(NaN),this.Bd="-"==e.charAt(0)?(e=e.slice(1),-1):1,-1<(i=e.indexOf("."))&&(e=e.replace(".","")),0<(r=e.search(/e/i))?(0>i&&(i=r),i+=+e.slice(r+1),e=e.substring(0,r)):0>i&&(i=e.length),r=0;"0"==e.charAt(r);r++);if(r==(s=e.length))this.c=[this.e=0];else{for(;"0"==e.charAt(--s););for(this.e=i-r-1,this.c=[],i=0;r<=s;this.c[i++]=+e.charAt(r++));}}}return t.prototype.abs=function(){var e=new t(this);return e.Bd=1,e},t.prototype.cmp=function(e){var i=this.c,n=(e=new t(e)).c,r=this.Bd,s=e.Bd,o=this.e,a=e.e;if(!i[0]||!n[0])return i[0]?r:n[0]?-s:0;if(r!=s)return r;if(e=0>r,o!=a)return o>(a^e)?1:-1;for(r=-1,s=(o=i.length)<(a=n.length)?o:a;++r<s;)if(i[r]!=n[r])return i[r]>(n[r]^e)?1:-1;return o==a?0:o>(a^e)?1:-1},t.prototype.jm=function(e){var r=this.c,s=(e=new t(e)).c,o=this.Bd==e.Bd?1:-1,a=t.rr;if((a!==~~a||0>a||1e6<a)&&n("!Big.DP!"),!r[0]||!s[0])return r[0]==s[0]&&n(NaN),s[0]||n(o/0),new t(0*o);var h,l,c=s.slice(),u=h=s.length,d=r.length,f=r.slice(0,h),p=f.length,g=e,v=g.c=[],m=0,y=a+(g.e=this.e-e.e)+1;for(g.Bd=o,o=0>y?0:y,c.unshift(0);p++<h;f.push(0));do{for(l=0;10>l;l++){if(h!=(p=f.length))var _=h>p?1:-1;else{var b=-1;for(_=0;++b<h;)if(s[b]!=f[b]){_=s[b]>f[b]?1:-1;break}}if(!(0>_))break;for(e=p==h?s:c;p;){if(f[--p]<e[p]){for(b=p;b&&!f[--b];f[b]=9);--f[b],f[p]+=10}f[p]-=e[p]}for(;!f[0];f.shift());}v[m++]=_?l:++l,f[0]&&_?f[p]=r[u]||0:f=[r[u]]}while((u++<d||void 0!==f[0])&&o--);return v[0]||1==m||(v.shift(),g.e--),m>y&&i(g,a,t.eu,void 0!==f[0]),g},t.prototype.fS=function(){return 0<this.cmp(0)},t.prototype.nT=function(){return 0>this.cmp(0)},t.prototype.jt=function(e){var i,n=this.Bd,r=(e=new t(e)).Bd;if(n!=r)return e.Bd=-r,this.tI(e);var s=this.c.slice(),o=this.e,a=e.c,h=e.e;if(!s[0]||!a[0])return a[0]?(e.Bd=-r,e):new t(s[0]?this:0);if(n=o-h){for((i=0>n)?(n=-n,o=s):(h=o,o=a),o.reverse(),r=n;r--;o.push(0));o.reverse()}else for(o=((i=s.length<a.length)?s:a).length,n=r=0;r<o;r++)if(s[r]!=a[r]){i=s[r]<a[r];break}if(i&&(o=s,s=a,a=o,e.Bd=-e.Bd),0<(r=(o=a.length)-(i=s.length)))for(;r--;s[i++]=0);for(r=i;o>n;){if(s[--o]<a[o]){for(i=o;i&&!s[--i];s[i]=9);--s[i],s[o]+=10}s[o]-=a[o]}for(;0==s[--r];s.pop());for(;0==s[0];)s.shift(),--h;return s[0]||(e.Bd=1,s=[h=0]),e.c=s,e.e=h,e},t.prototype.tI=function(e){var i=this.Bd,n=(e=new t(e)).Bd;if(i!=n)return e.Bd=-n,this.jt(e);n=this.e;var r=this.c,s=e.e,o=e.c;if(!r[0]||!o[0])return o[0]?e:new t(r[0]?this:0*i);if(r=r.slice(),i=n-s){for(0<i?(s=n,n=o):(i=-i,n=r),n.reverse();i--;n.push(0));n.reverse()}for(0>r.length-o.length&&(n=o,o=r,r=n),i=o.length,n=0;i;)n=(r[--i]=r[i]+o[i]+n)/10|0,r[i]%=10;for(n&&(r.unshift(n),++s),i=r.length;0==r[--i];r.pop());return e.c=r,e.e=s,e},t.prototype.pow=function(e){var i=this,r=new t(1),s=r,o=0>e;for((e!==~~e||-1e6>e||1e6<e)&&n("!pow!"),e=o?-e:e;1&e&&(s=s.lr(i)),e>>=1;)i=i.lr(i);return o?r.jm(s):s},t.prototype.round=function(e,r){var s=this;return null==e?e=0:(e!==~~e||0>e||1e6<e)&&n("!round!"),i(s=new t(s),e,r??t.eu),s},t.prototype.sqrt=function(){var e=this.c,r=this.Bd,s=this.e,o=new t("0.5");if(!e[0])return new t(this);0>r&&n(NaN),0==(r=Math.sqrt(this.toString()))||r==1/0?((r=e.join("")).length+s&1||(r+="0"),(e=new t(Math.sqrt(r).toString())).e=((s+1)/2|0)-(0>s||1&s)):e=new t(r.toString()),r=e.e+(t.rr+=4);do{s=e,e=o.lr(s.tI(this.jm(s)))}while(s.c.slice(0,r).join("")!==e.c.slice(0,r).join(""));return i(e,t.rr-=4,t.eu),e},t.prototype.lr=function(e){var i=this.c,n=(e=new t(e)).c,r=i.length,s=n.length,o=this.e,a=e.e;if(e.Bd=this.Bd==e.Bd?1:-1,!i[0]||!n[0])return new t(0*e.Bd);if(e.e=o+a,r<s){var h=i;i=n,n=h,a=r,r=s,s=a}for(h=Array(a=r+s);a--;h[a]=0);for(o=s;o--;){for(s=0,a=r+o;a>o;)s=h[a]+n[o]*i[a-o-1]+s,h[a--]=s%10,s=s/10|0;h[a]=(h[a]+s)%10}for(s&&++e.e,h[0]||h.shift(),o=h.length;!h[--o];h.pop());return e.c=h,e},t.prototype.toString=function(){var t=this.e,e=this.c.join(""),i=e.length;if(t<=r||t>=s)e=e.charAt(0)+(1<i?"."+e.slice(1):"")+(0>t?"e":"e+")+t;else if(0>t){for(;++t;e="0"+e);e="0."+e}else if(0<t)if(++t>i)for(t-=i;t--;e+="0");else t<i&&(e=e.slice(0,t)+"."+e.slice(t));else 1<i&&(e=e.charAt(0)+"."+e.slice(1));return 0>this.Bd&&this.c[0]?"-"+e:e},t.prototype.toExponential=function(t){return null==t?t=this.c.length-1:(t!==~~t||0>t||1e6<t)&&n("!toExp!"),e(this,t,1)},t.prototype.toFixed=function(t){var i=r,o=s;if(r=-(s=1/0),null==t)var a=this.toString();else t===~~t&&0<=t&&1e6>=t&&(a=e(this,this.e+t),0>this.Bd&&this.c[0]&&0>a.indexOf("-")&&(a="-"+a));return r=i,s=o,a||n("!toFix!"),a},t.prototype.toPrecision=function(t){return null==t?this.toString():((t!==~~t||1>t||1e6<t)&&n("!toPre!"),e(this,t-1,2))},t.rr=20,t.eu=1,t}();t.hp=a}(X||(X={})),function(t){var e=function(){function e(t){this.lf=t}return e.prototype.nr=function(e,i,n){var r=new t.h,s=new t.h,o=this.lf;n.Vd(e,i,(function(t,e){return o.tc(2*t,r),o.tc(2*e,s),r.compare(s)}))},e.prototype.$p=function(t){return this.lf.read(2*t+1)},e}();t.pi=function(){function i(){}return i.aq=function(e){if(e.B())return!1;var n=e.getType();return 1736==n?0!=e.Ke():1607==n?(n=[!1],i.sE(e,!0,n),n[0]):!(197!=n&&(!t.aa.yd(n)||e.BG()))},i.gm=function(e){var n=e.getType();if(1736==n)return n=new t.Ta(e.description),e.B()||e.dD(n),n;if(1607==n)return i.sE(e,!1,null);if(197==n)return n=new t.Ta(e.description),e.B()||n.ad(e,!1),n;if(t.aa.yd(n)){if(n=new t.de(e.description),!e.B()&&!e.BG()){var r=new t.Sa;e.To(r),n.add(r),e.Po(r),n.add(r)}return n}if(t.aa.Rn(n))return null;throw t.i.N()},i.sE=function(i,n,r){null!=r&&(r[0]=!1);var s=null;if(n||(s=new t.de(i.description)),!i.B()){var o=new t.ia(0);o.Jb(2*i.da());for(var a=0,h=i.da();a<h;a++)if(0<i.Ja(a)&&!i.Nn(a)){var l=i.Ba(a);o.add(l),l=i.Vc(a)-1,o.add(l)}if(0<o.size){h=new t.Xt,a=i.ub(0),h.sort(o,0,o.size,new e(a)),h=new t.h,a.tc(2*o.get(0),h),l=0;for(var c=1,u=new t.Sa,d=new t.h,f=1,p=o.size;f<p;f++)if(a.tc(2*o.get(f),d),d.qb(h))o.get(l)>o.get(f)?(o.set(l,2147483647),l=f):o.set(f,2147483647),c++;else{if(1&c){if(n)return null!=r&&(r[0]=!0),null}else o.set(l,2147483647);h.L(d),l=f,c=1}if(1&c){if(n)return null!=r&&(r[0]=!0),null}else o.set(l,2147483647);if(!n)for(o.Vd(0,o.size,(function(t,e){return t-e})),f=0,p=o.size;f<p&&2147483647!=o.get(f);f++)i.ve(o.get(f),u),s.add(u)}}return n?null:s},i}()}(X||(X={})),function(t){var e=function(){function e(){this.yf=new t.ia(0),this.ys=new t.ia(0),this.EH=1,this.Es=NaN}return e.prototype.sort=function(t,e,i,n){if(32>i-e)n.nr(e,i,t);else{var r=!0;try{for(var s=1/0,o=-1/0,a=e;a<i;a++){var h=n.$p(t.get(a));h<s&&(s=h),h>o&&(o=h)}if(this.reset(i-e,s,o,i-e)){for(a=e;a<i;a++){var l=t.get(a);h=n.$p(l);var c=this.zF(h);this.yf.set(c,this.yf.get(c)+1),this.ys.write(a-e,l)}var u=this.yf.get(0);this.yf.set(0,0),a=1;for(var d=this.yf.size;a<d;a++){var f=this.yf.get(a);this.yf.set(a,u),u+=f}for(a=e;a<i;a++){l=this.ys.read(a-e),h=n.$p(l),c=this.zF(h);var p=this.yf.get(c);t.set(p+e,l),this.yf.set(c,p+1)}r=!1}}catch(t){this.yf.resize(0),this.ys.resize(0)}if(r)n.nr(e,i,t);else{for(a=i=0,d=this.yf.size;a<d;a++)r=i,(i=this.yf.get(a))>r&&n.nr(e+r,e+i,t);100<this.yf.size&&(this.yf.resize(0),this.ys.resize(0))}}},e.prototype.reset=function(t,i,n,r){return!(2>t||n==i||(t=Math.min(e.hL,t),this.yf.Jb(t),this.yf.resize(t),this.yf.Wj(0,0,this.yf.size),this.EH=i,this.ys.resize(r),this.Es=(n-i)/(t-1),0))},e.prototype.zF=function(e){return t.O.truncate((e-this.EH)/this.Es)},e.hL=65536,e}();t.Xt=e}(X||(X={})),function(t){var e,i;(i=e||(e={}))[i.enum_line=1]="enum_line",i[i.enum_arc=2]="enum_arc",i[i.enum_dummy=4]="enum_dummy",i[i.enum_concave_dip=8]="enum_concave_dip",i[i.enum_connection=3]="enum_connection";var n=function(){function e(){}return e.Qu=function(i,n,r,s,o,a){var h=new e;return h.Im=new t.h,h.Vm=new t.h,h.aw=new t.h,h.Im.L(i),h.Vm.L(n),h.aw.L(r),h.Co=s,h.qh=o,h.sh=a,h},e.construct=function(i,n,r,s){var o=new e;return o.Im=new t.h,o.Vm=new t.h,o.aw=new t.h,o.Im.L(i),o.Vm.L(n),o.aw.Rc(),o.Co=4,o.qh=r,o.sh=s,o},e}(),r=function(){function e(t,e,i,n,r,s){this.Yv=null,this.ya=0,this.EA=t,this.bI=this.$H=0,this.Ka=e,this.Mj=i,this.vk=n,this.Dq=r,this.Ub=s}return e.prototype.next=function(){for(var e=new t.Sa;;){if(this.ya==this.EA.I())return null;if(this.EA.ve(this.ya,e),this.ya++,!e.B())break}var i=!1;if(null==this.Yv&&(this.$H=e.Lg(),this.bI=e.ih(),this.Yv=a.buffer(e,this.Ka,this.Mj,this.vk,this.Dq,this.Ub),i=!0),this.ya<this.EA.I()){var n=new t.Da;this.Yv.copyTo(n)}else n=this.Yv;if(!i){i=new t.Dd;var r=e.Lg()-this.$H;e=e.ih()-this.bI,i.gg(r,e),n.Oc(i)}return n},e.prototype.La=function(){return 0},e.prototype.qe=function(){},e}(),s=function(){function e(t,e){this.Wa=t,this.ya=0,this.oq=e}return e.prototype.next=function(){var e=this.Wa.X;if(this.ya<e.da()){var i=this.ya;if(this.ya++,!e.Nn(i))for(var n=e.Na(e.Vc(i)-1);this.ya<e.da();){var r=e.Na(e.Ba(this.ya));if(e.Nn(this.ya))break;if(r!=n)break;n=e.Na(e.Vc(this.ya)-1),this.ya++}if(1==this.ya-i)return this.Wa.kE(this.Wa.X,i,this.oq);for((n=new t.Ta(this.Wa.X.description)).addPath(this.Wa.X,i,!0),i+=1;i<this.ya;i++)n.Dr(this.Wa.X,i,0,e.rv(i),!1);return this.Wa.kE(n,0,this.oq)}return null},e.prototype.La=function(){return 0},e.prototype.qe=function(){},e}(),o=function(){function t(t){this.Wa=t,this.ya=0}return t.prototype.next=function(){var t=this.Wa.X;if(this.ya<t.da()){var e=this.ya;for(t.Ir(this.ya),this.ya++;this.ya<t.da()&&!(0<t.Ir(this.ya));)this.ya++;return 0==e&&this.ya==t.da()?this.Wa.py(t,0,t.da()):this.Wa.py(t,e,this.ya)}return null},t.prototype.La=function(){return 0},t.prototype.qe=function(){},t}(),a=function(){function e(t){this.Ks=this.lw=this.Ls=this.Id=null,this.Zd=[],this.Ub=t,this.rb=this.Kv=this.JT=this.Ka=this.tA=this.ct=this.qa=0,this.oA=this.vk=-1,this.oq=!0}return e.buffer=function(i,n,r,s,o,a){if(null==i)throw t.i.N();if(0>s)throw t.i.N();if(i.B())return new t.Da(i.description);var h=new t.l;return i.xc(h),0<n&&h.W(n,n),(a=new e(a)).Mj=r,a.X=i,a.qa=t.ta.Wd(r,h,!0),a.ct=t.ta.Wd(null,h,!0),a.Ka=n,a.JT=i.getType(),0>=o&&(o=96),a.rb=Math.abs(a.Ka),a.Kv=0!=a.rb?1/a.rb:0,isNaN(s)||0==s?s=1e-5*a.rb:s>.5*a.rb&&(s=.5*a.rb),12>o&&(o=12),(i=Math.abs(n)*(1-Math.cos(Math.PI/o)))>s?s=i:(i=Math.PI/Math.acos(1-s/Math.abs(n)))<o-1&&12>(o=t.O.truncate(i))&&(o=12,s=Math.abs(n)*(1-Math.cos(Math.PI/o))),a.vk=s,a.Dq=o,a.tA=Math.min(a.ct,.25*s),a.lE()},e.prototype.cv=function(){if(null==this.Id)this.Id=[];else if(0!==this.Id.length)return;var e=this.qE();e=t.O.truncate((e+3)/4);var i=.5*Math.PI/e;this.oA=i;for(var n=0;n<4*e;n++)this.Id.push(null);var r=Math.cos(i);i=Math.sin(i);var s=t.h.construct(0,1);for(n=0;n<e;n++)this.Id[n+0*e]=t.h.construct(s.y,-s.x),this.Id[n+1*e]=t.h.construct(-s.x,-s.y),this.Id[n+2*e]=t.h.construct(-s.y,s.x),this.Id[n+3*e]=s,(s=t.h.construct(s.x,s.y)).Bt(r,i)},e.prototype.lE=function(){var e=this.X.getType();if(t.aa.yd(e))return(e=new t.Ta(this.X.description)).oc(this.X,!0),this.X=e,this.lE();if(this.Ka<=this.qa){if(!t.aa.US(e))return new t.Da(this.X.description);if(0>=this.Ka&&(e=new t.l,this.X.A(e),e.R()<=2*-this.Ka||e.ca()<=2*this.Ka))return new t.Da(this.X.description)}switch(this.X.getType()){case 33:return this.PN();case 550:return this.ON();case 1607:return this.RN();case 1736:return this.QN();case 197:return this.LN();default:throw t.i.Qa()}},e.prototype.RN=function(){if(this.EG(this.X)){var e=new t.Sa;this.X.ve(0,e);var i=new t.l;return this.X.A(i),e.Cb(i.sf()),this.Gu(e)}return this.X=this.WV(this.X),e=new s(this,this.oq),t.Gh.local().V(e,this.Mj,this.Ub).next()},e.prototype.QN=function(){if(0==this.Ka)return this.X;var e=t.Yl.local();if(this.cv(),this.X=e.V(this.X,null,!1,this.Ub),0>this.Ka){var i=this.X;return i=this.py(i,0,i.da()),e.V(i,this.Mj,!1,this.Ub)}return this.EG(this.X)?(e=new t.Sa,this.X.ve(0,e),i=new t.l,this.X.A(i),e.Cb(i.sf()),this.Gu(e)):(e=new o(this),t.Gh.local().V(e,this.Mj,this.Ub).next())},e.prototype.py=function(i,n,r){for(var s=new t.Da(i.description);n<r;n++)if(!(1>i.Ja(n))){var o=i.Ir(n),a=new t.l;if(i.Rj(n,a),0<this.Ka){if(0<o)if(this.FG(i,n))o=new t.Sa,i.ve(i.Ba(n),o),o.Cb(a.sf()),this.yu(s,o);else{var h=o=new t.Ta(i.description);h=t.Zt.JG(this.X,n)||2==this.zn(this.X,n,h,!0,1)?this.jE(i,n):this.yn(o),s.add(h,!1)}else if(!(a.R()+this.qa<=2*this.rb||a.ca()+this.qa<=2*this.rb||(h=o=new t.Ta(i.description),this.zn(this.X,n,h,!0,1),o.B()))){var l=new t.l;for(l.K(a),l.W(this.rb,this.rb),h.tp(l),a=1,o=(h=this.yn(o)).da();a<o;a++)s.addPath(h,a,!0)}}else if(0<o){if(!(a.R()+this.qa<=2*this.rb||a.ca()+this.qa<=2*this.rb||(h=o=new t.Ta(i.description),this.zn(this.X,n,h,!0,-1),o.B())))for(l=new t.l,h.xc(l),l.W(this.rb,this.rb),h.tp(l),a=1,o=(h=this.yn(o)).da();a<o;a++)s.addPath(h,a,!0)}else for(h=o=new t.Ta(i.description),this.zn(this.X,n,h,!0,-1),a=0,o=(h=this.yn(o)).da();a<o;a++)s.addPath(h,a,!0)}if(0<this.Ka)return 1<s.da()?s=this.yn(s):e.kx(s);if(i=new t.l,s.xc(i),s.B())return e.kx(s);for(i.W(this.rb,this.rb),s.tp(i),s=this.yn(s),i=new t.Da(s.description),a=1,o=s.da();a<o;a++)i.addPath(s,a,!1);return e.kx(i)},e.prototype.PN=function(){return this.Gu(this.X)},e.prototype.Gu=function(e){var i=new t.Da(this.X.description);return this.yu(i,e),this.sX(i)},e.prototype.ON=function(){var e=new r(this.X,this.Ka,this.Mj,this.vk,this.Dq,this.Ub);return t.Gh.local().V(e,this.Mj,this.Ub).next()},e.prototype.LN=function(){var e=new t.Da(this.X.description);if(0>=this.Ka){if(0==this.Ka)e.ad(this.X,!1);else{var i=new t.Fh;this.X.bn(i),i.W(this.Ka,this.Ka),e.ad(i,!1)}return e}return e.ad(this.X,!1),this.X=e,this.jE(e,0)},e.prototype.jE=function(i,n){this.cv();var r=new t.Da(i.description),s=new t.h,o=new t.h,a=new t.h,h=new t.h,l=new t.h,c=new t.h,u=new t.h,d=new t.h,f=i.Ja(n),p=i.Ba(n),g=0;for(n=i.Ja(n);g<n;g++){if(i.D(p+g,o),i.D(p+(g+1)%f,h),i.D(p+(g+2)%f,c),u.uc(h,o),0==u.length())throw t.i.Qa();if(u.Hv(),u.normalize(),u.scale(this.rb),s.add(u,o),a.add(u,h),0==g?r.Lt(s):r.Ci(s),r.Ci(a),d.uc(c,h),0==d.length())throw t.i.Qa();d.Hv(),d.normalize(),d.scale(this.rb),l.add(d,h),this.GD(r,h,a,l,!1)}return e.kx(r)},e.prototype.kE=function(e,i,n){if(this.cv(),1>e.Ja(i))return null;if(this.FG(e,i)&&0<this.Ka){n=new t.Sa,e.ve(e.Ba(i),n);var r=new t.l;return e.Rj(i,r),n.Cb(r.sf()),this.Gu(n)}if(r=new t.Ta(e.description),e.Nn(i))this.zn(e,i,r,n,1),this.zn(e,i,r,n,-1);else{var s=new t.Ta(e.description);s.addPath(e,i,!1),s.Dr(e,i,0,e.rv(i),!1),this.zn(s,0,r,n,1)}return this.yn(r)},e.prototype.Xq=function(){if(this.Ys++,0==this.Ys%1024&&null!=this.Ub&&!this.Ub.progress(-1,-1))throw t.i.fu("user_canceled")},e.prototype.yn=function(e){return t.Fg.Mk(e,this.ct,!0,!0,this.Ub)},e.prototype.qE=function(){if(0==this.vk)return this.Dq;var e=1-this.vk*Math.abs(this.Kv);return 4>(e=-1>e?4:2*Math.PI/Math.acos(e)+.5)?e=4:e>this.Dq&&(e=this.Dq),t.O.truncate(e)},e.prototype.GD=function(e,i,n,r,s){this.cv();var o=new t.h;o.uc(n,i),o.scale(this.Kv);var a=new t.h;a.uc(r,i),a.scale(this.Kv),0>(o=Math.atan2(o.y,o.x)/this.oA)&&(o=this.Id.length+o),o=this.Id.length-o,0>(a=Math.atan2(a.y,a.x)/this.oA)&&(a=this.Id.length+a),(a=this.Id.length-a)<o&&(a+=this.Id.length);var h=t.O.truncate(a);a=t.O.truncate(Math.ceil(o)),(o=new t.h).L(this.Id[a%this.Id.length]),o.Ct(this.rb,i);var l=10*this.qa;for(o.sub(n),o.length()<l&&(a+=1),o.L(this.Id[h%this.Id.length]),o.Ct(this.rb,i),o.sub(r),o.length()<l&&--h,n=h-a,n++,h=0,a%=this.Id.length;h<n;h++,a=(a+1)%this.Id.length)o.L(this.Id[a]),o.Ct(this.rb,i),e.Ci(o),this.Xq();s&&e.Ci(r)},e.prototype.zn=function(e,i,r,s,o){var a=new t.gd,h=a.mN(e,i);if(a.Gp(this.tA,!1,!1),2>a.I(h))return 0>o||(o=e,a=new t.Sa,o.ve(o.Ba(i),a),this.yu(r,a)),1;var l=a.Na(a.Xa(a.Ob(h))),c=new t.Dd;if(c.gg(-l.x,-l.y),a.Oc(c),s&&(this.tQ(a,h,o),2>a.I(h)))return 0>o||(o=e,a=new t.Sa,o.ve(o.Ba(i),a),this.yu(r,a)),1;this.Zd.length=0;var u=a.Ob(h);i=a.Xa(u);var d=1==o?a.Ma(i):a.U(i);e=1==o?a.U(i):a.Ma(i);var f=!0;s=new t.h,h=new t.h;var p=new t.h,g=new t.h,v=new t.h,m=new t.h,y=new t.h,_=new t.h,b=new t.h,w=new t.h,x=this.rb;u=a.Ja(u);for(var T=0;T<u;T++)a.D(e,h),f&&(a.D(i,s),a.D(d,p),_.uc(s,p),_.normalize(),w.MG(_),w.scale(x),g.add(w,s)),y.uc(h,s),y.normalize(),b.MG(y),b.scale(x),v.add(s,b),d=_.wi(y),f=_.Qh(y),0>d||0>f&&0==d?this.Zd.push(n.Qu(g,v,s,2,this.Zd.length+1,this.Zd.length-1)):g.qb(v)||(this.Zd.push(n.construct(g,s,this.Zd.length+1,this.Zd.length-1,"dummy")),this.Zd.push(n.construct(s,v,this.Zd.length+1,this.Zd.length-1,"dummy"))),m.add(h,b),this.Zd.push(n.Qu(v,m,s,1,this.Zd.length+1,this.Zd.length-1)),g.L(m),w.L(b),p.L(s),s.L(h),_.L(y),d=i,i=e,f=!1,e=1==o?a.U(i):a.Ma(i);return this.Zd[this.Zd.length-1].qh=0,this.Zd[0].sh=this.Zd.length-1,this.YV(r),c.gg(l.x,l.y),r.YD(c,r.da()-1),1},e.prototype.YV=function(t){for(var e=this.zO(),i=!0,n=e+1,r=e;n!=e;r=n){var s=this.Zd[r];n=-1!=s.qh?s.qh:(r+1)%this.Zd.length,0!=s.Co&&(i&&t.Lt(s.Im),2==s.Co?this.GD(t,s.aw,s.Im,s.Vm,!0):t.Ci(s.Vm),i=!1)}},e.prototype.zO=function(){null==this.Ks&&(this.Ks=[null,null,null,null,null,null,null,null,null]);for(var e=0,i=0,n=this.Zd.length;i<n;){var r=this.Zd[i];if(3&r.Co){e=i;break}i=r.qh}for(n=e+1,i=e;n!=e;i=n){n=(r=this.Zd[i]).qh;for(var s=1,o=null;n!=i&&!(3&(o=this.Zd[n]).Co);)n=o.qh,s++;1!=s&&1==(r.Co&o.Co)&&(null==this.Ls&&(this.Ls=new t.yb,this.lw=new t.yb),this.Ls.Dc(r.Im),this.Ls.Qc(r.Vm),this.lw.Dc(o.Im),this.lw.Qc(o.Vm),1==this.Ls.Ea(this.lw,this.Ks,null,null,this.ct)&&(r.Vm.L(this.Ks[0]),o.Im.L(this.Ks[0]),r.qh=n,o.sh=i))}return e},e.prototype.Fv=function(e,i,n){var r=new t.h;if(r.uc(n,e),n=r.length(),0<(n=this.rb*this.rb-n*n*.25)){n=Math.sqrt(n),r.normalize(),r.ar();var s=new t.h;if(s.uc(i,e),s.Qh(r)+n>=this.rb)return!0}return!1},e.prototype.tQ=function(e,i,n){for(var r=0;1>r;r++){var s=!1,o=e.Ob(i),a=e.Ja(o);if(0==a)break;var h=a;if(3>a)break;!e.dc(o)&&(h=a-1),o=e.Xa(o),a=0<n?e.Ma(o):e.U(o);for(var l=0<n?e.U(o):e.Ma(o),c=a,u=!0,d=new t.h,f=new t.h,p=new t.h,g=new t.h,v=new t.h,m=t.h.construct(0,0),y=new t.h,_=new t.h,b=new t.h,w=new t.h,x=this.rb,T=0,A=0;A<h&&(e.D(l,f),u&&(e.D(o,d),e.D(a,p),c=a),_.uc(d,p),_.normalize(),y.uc(f,d),y.normalize(),c!=l);){var M=_.wi(y),S=_.Qh(y),E=!0;if(0>M||0>S&&0==M||!this.Fv(p,d,f)||(m.L(f),E=!1,++T,s=!0),E){if(0<T)for(;(M=0<n?e.Ma(c):e.U(c))!=o;){if(e.D(M,g),!this.Fv(g,p,m)){M!=l&&this.Fv(g,p,f)&&this.Fv(g,d,f)&&(p.L(g),c=M,E=!1,++T);break}p.L(g),c=M,E=!1,++T}if(!E)continue;if(0<T){for(c=0<n?e.Ma(a):e.U(a),u=1;u<T;u++)E=0<n?e.Ma(c):e.U(c),e.pd(c,!0),c=E;b.uc(d,p),T=x*x-(T=b.length())*T*.25,x-(T=Math.sqrt(T))>.5*this.vk?(v.add(p,d),v.scale(.5),b.normalize(),b.ar(),w.L(b),w.scale(x-T),v.add(w),e.mf(a,v)):e.pd(a,!0),T=0}p.L(d),c=o}d.L(f),a=o,o=l,l=0<n?e.U(o):e.Ma(o),A++,u=!1}if(0<T){for(c=0<n?e.Ma(a):e.U(a),u=1;u<T;u++)E=0<n?e.Ma(c):e.U(c),e.pd(c,!0),c=E;v.add(p,d),v.scale(.5),b.uc(d,p),T=x*x-(T=b.length())*T*.25,T=Math.sqrt(T),b.normalize(),b.ar(),w.L(b),w.scale(x-T),v.add(w),e.mf(a,v)}if(e.Gp(this.tA,!1,!1),!s)break}},e.prototype.FG=function(e,i){if(1==e.Ja(i))return!0;var n=new t.l;return e.Rj(i,n),Math.max(n.R(),n.ca())<.5*this.vk},e.prototype.EG=function(e){var i=new t.l;return e.A(i),Math.max(i.R(),i.ca())<.5*this.vk},e.prototype.WV=function(e){for(var i=0,n=0,r=(e=t.EC.local().V(e,.25*this.vk,!1,this.Ub)).da();n<r;n++)i=Math.max(e.Ja(n),i);return 32>i?(this.oq=!1,e):(this.oq=!0,t.Fg.Mk(e,this.ct,!1,!0,this.Ub))},e.prototype.yu=function(e,i){if(i=i.D(),null!=this.Id&&0!==this.Id.length){var n=new t.h;n.L(this.Id[0]),n.Ct(this.rb,i),e.Lt(n);for(var r=1,s=this.Id.length;r<s;r++)n.L(this.Id[r]),n.Ct(this.rb,i),e.Ci(n)}else{r=this.qE(),n=t.O.truncate((r+3)/4),r=.5*Math.PI/n,s=Math.cos(r);for(var o=Math.sin(r),a=new t.h,h=3;0<=h;h--){switch(a.ma(0,this.rb),h){case 0:for(r=0;r<n;r++)e.yj(a.x+i.x,a.y+i.y),a.Bt(s,o);break;case 1:for(r=0;r<n;r++)e.yj(-a.y+i.x,a.x+i.y),a.Bt(s,o);break;case 2:for(r=0;r<n;r++)e.yj(-a.x+i.x,-a.y+i.y),a.Bt(s,o);break;default:for(e.sx(a.y+i.x,-a.x+i.y),r=1;r<n;r++)a.Bt(s,o),e.yj(a.y+i.x,-a.x+i.y)}this.Xq()}}},e.kx=function(t){return t.Ch(1,0),t},e.prototype.sX=function(t){return t.Ch(2,this.qa),t.fm(),t},e}();t.HK=a}(X||(X={})),function(t){var e=function(){function e(e){this.Ca=e,this.g=new t.gd,this.dd=new t.ia(0)}return e.prototype.Lh=function(t,e,i){switch(e){case 0:if(t.v<i&&t.C<=i)break;return t.v>=i?1:-1;case 1:if(t.G<i&&t.H<=i)break;return t.G>=i?1:-1;case 2:if(t.v>=i&&t.C>i)break;return t.C<=i?1:-1;case 3:if(!(t.G>=i&&t.H>i))return t.H<=i?1:-1}return 0},e.prototype.Ay=function(t,e){return 1736==t.getType()?this.Cy(t,e):this.Dy(t)},e.prototype.Cy=function(e,i){if(0==this.Ca.R()||0==this.Ca.ca())return e.Ia();var n=new t.l;e.xc(n),this.X=this.g.Ib(e);var r=new t.l,s=new t.l,o=new t.h,a=new t.h,h=[0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0];new t.ig;var c=new t.yb,u=new t.ia(0);u.Jb(Math.min(100,e.I()));for(var d=!1,f=0;!d&&4>f;f++){var p=!1,g=!!(1&f),v=0;switch(f){case 0:v=this.Ca.v,p=n.v<=v&&n.C>=v;break;case 1:v=this.Ca.G,p=n.G<=v&&n.H>=v;break;case 2:v=this.Ca.C,p=n.v<=v&&n.C>=v;break;case 3:v=this.Ca.H,p=n.G<=v&&n.H>=v}if(p)for(d=!0,p=this.g.Ob(this.X);-1!=p;){var m=-1,y=-1,_=this.g.Xa(p),b=_;do{var w=this.g.bc(b);null==w&&(w=c,this.g.D(b,o),w.Dc(o),this.g.D(this.g.U(b),a),w.Qc(a)),w.A(r);var x=this.Lh(r,f,v),T=0,A=-1;if(-1==x){T=0<(w=w.cq(g,v,h,l))?this.g.Ul(b,l,w):0,T+=1;var M=b,S=this.g.U(M);for(w=0;w<T;w++){if(this.g.D(M,o),this.g.D(S,a),null==(A=this.g.bc(M))&&((A=c).Dc(o),A.Qc(a)),A.A(s),-1==(A=this.Lh(s,f,v))){if(g)(A=Math.abs(o.y-v))<(E=Math.abs(a.y-v))?(o.y=v,this.g.mf(M,o)):(a.y=v,this.g.mf(S,a));else{A=Math.abs(o.x-v);var E=Math.abs(a.x-v);A<E?(o.x=v,this.g.mf(M,o)):(a.x=v,this.g.mf(S,a))}null==(A=this.g.bc(M))&&((A=c).Dc(o),A.Qc(a)),A.A(s),A=this.Lh(s,f,v)}E=m,m=A,-1==y&&(y=m),0==E&&1==m||1==E&&0==m||0!=E||0!=m||u.add(M),1==m&&(d=!1),A=M=S,S=this.g.U(S)}}0==T&&(E=m,m=x,-1==y&&(y=m),0==E&&1==m||1==E&&0==m||0!=E||0!=m||u.add(b),1==m&&(d=!1),A=this.g.U(b)),b=A}while(b!=_);for(0==y&&0==m&&u.add(_),w=0,m=u.size;w<m;w++)y=u.get(w),this.g.pd(y,!1);u.clear(!1),p=3>this.g.Ja(p)?this.g.Zq(p):this.g.Rb(p)}}return d?e.Ia():(this.FB(),0<i&&this.My(i),this.g.Ne(this.X))},e.prototype.Dy=function(e){var i=new t.l,n=new t.l,r=[0,0,0,0,0,0,0,0,0],s=[0,0,0,0,0,0,0,0,0],o=new t.ig,a=e,h=new t.l;e.xc(h);for(var l=0;4>l;l++){var c=!1,u=!!(1&l),d=0;switch(l){case 0:d=this.Ca.v,c=h.v<=d&&h.C>=d;break;case 1:d=this.Ca.G,c=h.G<=d&&h.H>=d;break;case 2:d=this.Ca.C,c=h.v<=d&&h.C>=d;break;case 3:d=this.Ca.H,c=h.G<=d&&h.H>=d}if(c){c=a,a=e.Ia(),(c=c.Ga()).Zi();for(var f,p=new t.h;c.$a();)for(var g,v=!0;c.Ha();){var m=c.ha();m.A(i);var y=this.Lh(i,l,d);if(-1==y){if(0<(y=m.cq(u,d,r,s))){var _=0;f=m.ac();for(var b=0;b<=y;b++)if(_!=(g=b<y?s[b]:1)){m.ah(_,g,o);var w=o.get();w.Dc(f),b<y&&(u?(p.x=r[b],p.y=d):(p.x=d,p.y=r[b]),w.Qc(p)),w.A(n);var x=this.Lh(n,l,d);if(-1==x){if(f=w.ac(),_=w.wc(),u)(x=Math.abs(f.y-d))<(T=Math.abs(_.y-d))?(f.y=d,w.Dc(f)):(_.y=d,w.Qc(_));else{x=Math.abs(f.x-d);var T=Math.abs(_.x-d);x<T?(f.x=d,w.Dc(f)):(_.x=d,w.Qc(_))}w.A(n),x=this.Lh(n,l,d)}f=w.wc(),_=g,1==(g=x)?(a.oc(w,v),v=!1):v=!0}}}else 1==(g=y)?(a.oc(m,v),v=!1):v=!0}}}return a},e.prototype.FB=function(){this.ji=-1,this.Vl(!1,this.Ca.v),this.Vl(!1,this.Ca.C),this.Vl(!0,this.Ca.G),this.Vl(!0,this.Ca.H),this.dd.resize(0),this.dd.Jb(100),this.ji=this.g.Gd();for(var e=new t.h,i=this.g.Ob(this.X);-1!=i;i=this.g.Rb(i))for(var n=this.g.Xa(i),r=0,s=this.g.Ja(i);r<s;r++,n=this.g.U(n))this.g.D(n,e),(this.Ca.v==e.x||this.Ca.C==e.x||this.Ca.G==e.y||this.Ca.H==e.y)&&(this.g.Ra(n,this.ji,this.dd.size),this.dd.add(n));this.Nl(!1,this.Ca.v),this.Nl(!1,this.Ca.C),this.Nl(!0,this.Ca.G),this.Nl(!0,this.Ca.H),this.Ty()},e.prototype.My=function(e){for(var i=new t.h,n=new t.h,r=t.O.lg(2048,0),s=this.g.Ob(this.X);-1!=s;s=this.g.Rb(s)){var o=this.g.Xa(s),a=o;do{var h=this.g.U(a);this.g.D(a,i);var l=-1;if(i.x==this.Ca.v?(this.g.D(h,n),n.x==this.Ca.v&&(l=1)):i.x==this.Ca.C&&(this.g.D(h,n),n.x==this.Ca.C&&(l=1)),i.y==this.Ca.G?(this.g.D(h,n),n.y==this.Ca.G&&(l=0)):i.y==this.Ca.H&&(this.g.D(h,n),n.y==this.Ca.H&&(l=0)),-1!=l&&(l=t.h.tb(i,n),!(1>=(l=t.O.truncate(Math.min(Math.ceil(l/e),2048)))))){for(var c=1;c<l;c++)r[c-1]=1*c/l;this.g.Ul(a,r,l-1)}a=h}while(a!=o)}},e.prototype.Vl=function(e,i){var n=this.g.Gd(),r=new t.h,s=new t.ia(0);s.Jb(100);for(var o=this.g.Ob(this.X);-1!=o;o=this.g.Rb(o))for(var a=this.g.Xa(o),h=0,l=this.g.Ja(o);h<l;h++){var c=this.g.U(a);this.g.D(a,r),(e?r.y==i:r.x==i)&&(this.g.D(c,r),(e?r.y==i:r.x==i)&&(1!=this.g.Pa(a,n)&&(s.add(a),this.g.Ra(a,n,1)),1!=this.g.Pa(c,n)&&(s.add(c),this.g.Ra(c,n,1)))),a=c}if(this.g.Td(n),!(3>s.size)){var u=this;s.Vd(0,s.size,(function(t,e){return u.Mh(t,e)})),n=new t.h,o=new t.h,a=new t.h,o.Rc();var d=-1;h=new t.ia(0),l=new t.ia(0),c=this.g.Gd();for(var f=this.g.Gd(),p=0,g=s.size;p<g;p++){var v=s.get(p);if(this.g.D(v,r),!r.qb(o)){if(-1!=d){for(var m=d;m<p;m++){d=s.get(m);var y=this.g.U(d);v=this.g.Ma(d);var _=!1;0>this.Mh(d,y)&&(this.g.D(y,n),e?n.y==i:n.x==i)&&(h.add(d),_=!0,this.g.Ra(d,f,1)),0>this.Mh(d,v)&&(this.g.D(v,n),e?n.y==i:n.x==i)&&(_||h.add(d),this.g.Ra(d,c,1))}for(m=0,_=h.size;m<_;m++){if(d=h.get(m),v=this.g.Pa(d,c),y=this.g.Pa(d,f),1==v){v=this.g.Ma(d),this.g.D(v,a);var b=[0];if(b[0]=0,!a.qb(r)){var w=t.h.tb(o,a);b[0]=t.h.tb(a,r)/w,0==b[0]?b[0]=2220446049250313e-31:1==b[0]&&(b[0]=.9999999999999998),this.g.Ul(v,b,1),v=this.g.Ma(d),this.g.mf(v,r),l.add(v),this.g.Ra(v,c,1),this.g.Ra(v,f,-1)}}1==y&&(y=this.g.U(d),this.g.D(y,a),(b=[0])[0]=0,a.qb(r)||(w=t.h.tb(o,a),b[0]=t.h.tb(o,r)/w,0==b[0]?b[0]=2220446049250313e-31:1==b[0]&&(b[0]=.9999999999999998),this.g.Ul(d,b,1),v=this.g.U(d),this.g.mf(v,r),l.add(v),this.g.Ra(v,c,-1),this.g.Ra(v,f,1)))}d=h,h=l,(l=d).clear(!1)}d=p,o.L(r)}}this.g.Td(c),this.g.Td(f)}},e.prototype.Nl=function(e,i){var n=new t.h,r=new t.ia(0);r.Jb(100);for(var s=this.g.Gd(),o=0,a=this.dd.size;o<a;o++){var h=this.dd.get(o);if(-1!=h){var l=this.g.U(h);this.g.D(h,n),(e?n.y==i:n.x==i)&&(this.g.D(l,n),(e?n.y==i:n.x==i)&&(-2!=this.g.Pa(h,s)&&(r.add(h),this.g.Ra(h,s,-2)),-2!=this.g.Pa(l,s)&&(r.add(l),this.g.Ra(l,s,-2))))}}if(0!=r.size){var c=this;for(r.Vd(0,r.size,(function(t,e){return c.Mh(t,e)})),o=0,a=r.size;o<a;o++){var u=r.get(o);this.g.Ra(u,s,o)}h=new t.h,(l=new t.h).Rc();var d=-1;for(o=0,a=r.size;o<a;o++)if(-1!=(u=r.get(o))&&(this.g.D(u,n),!n.qb(l))){if(-1!=d)for(;;){u=!1;for(var f=1<o-d?o-1:o,p=d;p<f;p++){var g=r.get(p);if(-1!=g){var v=-1,m=this.g.U(g);0>this.Mh(g,m)&&(this.g.D(m,h),e?h.y==i:h.x==i)&&(v=m),m=-1;var y=this.g.Ma(g);if(0>this.Mh(g,y)&&(this.g.D(y,h),e?h.y==i:h.x==i)&&(m=y),-1!=v&&-1!=m)this.Kh(g,r,s),this.g.pd(g,!1),this.Kh(v,r,s),this.g.pd(v,!1),u=!0;else if(-1!=v||-1!=m){for(y=p+1;y<o;y++){var _=r.get(y);if(-1!=_){var b=this.g.U(_),w=-1;0>this.Mh(_,b)&&(this.g.D(b,h),e?h.y==i:h.x==i)&&(w=b),b=this.g.Ma(_);var x=-1;if(0>this.Mh(_,b)&&(this.g.D(b,h),e?h.y==i:h.x==i)&&(x=b),-1!=w&&-1!=x){this.Kh(_,r,s),this.g.pd(_,!1),this.Kh(w,r,s),this.g.pd(w,!1),u=!0;break}if(-1!=v&&-1!=x){this.zt(r,g,v,_,x,s),u=!0;break}if(-1!=m&&-1!=w){this.zt(r,_,w,g,m,s),u=!0;break}}}if(u)break}}}if(!u)break}d=o,l.L(n)}}this.g.Td(s)},e.prototype.Kh=function(t,e,i){i=this.g.Pa(t,i),e.set(i,-1),i=this.g.Pa(t,this.ji),this.dd.set(i,-1),-1!=(e=this.g.bd(t))&&this.g.Xa(e)==t&&(this.g.Jf(e,-1),this.g.Wg(e,-1))},e.prototype.zt=function(t,e,i,n,r,s){this.g.Bc(e,n),this.g.Cc(n,e),this.g.Cc(i,r),this.g.Bc(r,i),this.Kh(n,t,s),this.g.mi(n,!1),this.Kh(r,t,s),this.g.mi(r,!0)},e.prototype.Ty=function(){for(var t=0,e=this.dd.size;t<e;t++){var i=this.dd.get(t);-1!=i&&this.g.aj(i,-1)}for(var n=0,r=0,s=this.g.Ob(this.X);-1!=s;){var o=this.g.Xa(s);if(-1==o||s!=this.g.bd(o)){var a=s;s=this.g.Rb(s),this.g.Jf(a,-1),this.g.$q(a)}else{i=o,a=0;do{this.g.aj(i,s),a++,i=this.g.U(i)}while(i!=o);2>=a?(i=this.g.Pa(o,this.ji),this.dd.set(i,-1),o=this.g.pd(o,!1),2==a&&(i=this.g.Pa(o,this.ji),this.dd.set(i,-1),this.g.pd(o,!1)),a=s,s=this.g.Rb(s),this.g.Jf(a,-1),this.g.$q(a)):(this.g.cp(s,!1),this.g.Wg(s,this.g.Ma(o)),this.g.Vj(s,a),r+=a,n++,s=this.g.Rb(s))}}for(t=0,e=this.dd.size;t<e;t++)if(-1!=(i=this.dd.get(t))&&-1==(s=this.g.bd(i))){s=this.g.vf(this.X,-1),a=0,o=i;do{this.g.aj(i,s),a++,i=this.g.U(i)}while(i!=o);2>=a?(i=this.g.Pa(o,this.ji),this.dd.set(i,-1),o=this.g.pd(o,!1),2==a&&(0<=(i=this.g.Pa(o,this.ji))&&this.dd.set(i,-1),this.g.pd(o,!1)),a=s,this.g.Jf(a,-1),this.g.$q(a)):(this.g.kn(s,!0),this.g.Vj(s,a),this.g.Jf(s,o),this.g.Wg(s,this.g.Ma(o)),this.g.cp(s,!1),r+=a,n++)}for(this.g.Rl(this.X,n),this.g.Tj(this.X,r),t=0,e=this.g.ld;-1!=e;e=this.g.ue(e))t+=this.g.I(e);this.g.bC(t)},e.By=function(t,i,n){return new e(i).Ay(t,n)},e.clip=function(i,n,r,s){if(i.B())return i;if(n.B())return i.Ia();if(33==(r=i.getType()))return s=i.D(),n.contains(s)?i:i.Ia();if(197==r)return s=new t.l,i.A(s),s.Ea(n)?(n=new t.Fh,i.copyTo(n),n.Xo(s),n):i.Ia();var o=new t.l;if(i.xc(o),n.contains(o))return i;if(!n.isIntersecting(o))return i.Ia();if(null!=(o=i.Bb)&&null!=(o=o.Fk)){if(1==(o=o.Ro(n))){if(1736!=r)throw t.i.Qa();return(i=new t.Da(i.description)).tp(n),i}if(0==o)return i.Ia()}switch(r){case 550:r=null,o=i.I();for(var a=i.ub(0),h=0,l=0;l<o;l++)s=new t.h,a.tc(2*l,s),n.contains(s)||(0==h&&(r=i.Ia()),h<l&&r.Fd(i,h,l),h=l+1);return 0<h&&r.Fd(i,h,o),0==h?i:r;case 1736:case 1607:return e.By(i,n,s);default:throw t.i.Qa()}},e.prototype.Mh=function(e,i){var n=new t.h;return this.g.D(e,n),e=new t.h,this.g.D(i,e),n.compare(e)},e}();t.Ud=e}(X||(X={})),function(t){var e=function(){function e(e,i){this.Ca=e,this.g=new t.gd,this.dd=new t.ia(0),this.nd=i}return e.prototype.Lh=function(t,e,i){switch(e){case 0:if(t.v<i&&t.C<=i)break;return t.v>=i?1:-1;case 1:if(t.G<i&&t.H<=i)break;return t.G>=i?1:-1;case 2:if(t.v>=i&&t.C>i)break;return t.C<=i?1:-1;case 3:if(!(t.G>=i&&t.H>i))return t.H<=i?1:-1}return 0},e.prototype.Ay=function(t,e){return 1736==t.getType()?this.Cy(t,e):this.Dy(t)},e.prototype.Cy=function(e,i){if(0==this.Ca.R()||0==this.Ca.ca())return e.Ia();var n=new t.l;e.xc(n),this.X=this.g.Ib(e);var r=new t.l,s=new t.l,o=new t.h,a=new t.h,h=[0,0,0,0,0,0,0,0,0],l=[0,0,0,0,0,0,0,0,0],c=new t.yb,u=new t.ia(0);u.Jb(256);for(var d=!1,f=0;!d&&4>f;f++){var p=!1,g=!!(1&f),v=0;switch(f){case 0:v=this.Ca.v,p=n.v<=v&&n.C>=v;break;case 1:v=this.Ca.G,p=n.G<=v&&n.H>=v;break;case 2:v=this.Ca.C,p=n.v<=v&&n.C>=v;break;case 3:v=this.Ca.H,p=n.G<=v&&n.H>=v}if(p)for(d=!0,p=this.g.Ob(this.X);-1!=p;){var m=!0,y=-1,_=-1,b=this.g.Xa(p),w=b;do{var x=this.g.bc(w);null==x&&(x=c,this.g.D(w,o),x.Dc(o),this.g.D(this.g.U(w),a),x.Qc(a)),x.A(r);var T=this.Lh(r,f,v),A=0,M=-1;if(-1==T){A=0<(x=x.cq(g,v,h,l))?this.g.LX(w,l,x):0,A+=1;var S=w,E=this.g.U(S);for(x=0;x<A;x++){if(this.g.D(S,o),this.g.D(E,a),null==(M=this.g.bc(S))&&((M=c).Dc(o),M.Qc(a)),M.A(s),-1==(M=this.Lh(s,f,v))){if(g)(M=Math.abs(o.y-v))<(C=Math.abs(a.y-v))?(o.y=v,this.g.mf(S,o)):(a.y=v,this.g.mf(E,a));else{M=Math.abs(o.x-v);var C=Math.abs(a.x-v);M<C?(o.x=v,this.g.mf(S,o)):(a.x=v,this.g.mf(E,a))}null==(M=this.g.bc(S))&&((M=c).Dc(o),M.Qc(a)),M.A(s),M=this.Lh(s,f,v)}C=y,y=M,-1==_&&(_=y),0==C&&1==y||1==C&&0==y||0!=C||0!=y||u.add(S),1==y&&(m=d=!1),M=S=E,E=this.g.U(E)}}if(0==A&&(C=y,y=T,-1==_&&(_=y),0==C&&1==y||1==C&&0==y||0!=C||0!=y||u.add(w),1==y&&(m=d=!1),M=this.g.U(w)),w=M,256<=u.size){for(x=1,T=u.size-1;x<T;x++)A=u.get(x),this.g.pd(A,!1);u.set(1,u.Fc()),u.Bh(2)}}while(w!=b);if(!m)for(0==_&&0==y&&u.add(b),x=0,T=u.size;x<T;x++)A=u.get(x),this.g.pd(A,!1);u.clear(!1),p=m||0==this.g.Ja(p)?this.g.Zq(p):this.g.Rb(p)}}return d?e.Ia():(this.FB(),0<i&&this.My(i),this.g.Ne(this.X))},e.prototype.Dy=function(e){var i=new t.l,n=new t.l,r=[0,0,0,0,0,0,0,0,0],s=[0,0,0,0,0,0,0,0,0],o=new t.ig,a=e,h=new t.l;e.xc(h);for(var l=new t.h,c=new t.h,u=null,d=null,f=0;4>f;f++){var p=!1,g=!!(1&f),v=0;switch(f){case 0:v=this.Ca.v,p=h.v<=v&&h.C>=v;break;case 1:v=this.Ca.G,p=h.G<=v&&h.H>=v;break;case 2:v=this.Ca.C,p=h.v<=v&&h.C>=v;break;case 3:v=this.Ca.H,p=h.G<=v&&h.H>=v}if(p)for(p=a,a=e.Ia(),(p=p.Ga()).Zi();p.$a();)for(var m,y=!0;p.Ha();){var _=p.ha();_.A(i);var b=this.Lh(i,f,v);if(-1==b){if(0<(b=_.cq(g,v,r,s))){var w=0;_.Yp(l);for(var x=0;x<=b;x++)if(w!=(m=x<b?s[x]:1)){_.ah(w,m,o);var T=o.get();T.Dc(l),x<b&&(g?(c.x=r[x],c.y=v):(c.x=v,c.y=r[x]),T.Qc(c)),T.A(n);var A=this.Lh(n,f,v);-1==A&&(null==u&&(u=new t.h),null==d&&(d=new t.h),T.Yp(u),T.Tr(d),g?(w=Math.abs(u.y-v))<(A=Math.abs(d.y-v))?(u.y=v,T.Dc(u)):(d.y=v,T.Qc(d)):(w=Math.abs(u.x-v))<(A=Math.abs(d.x-v))?(u.x=v,T.Dc(u)):(d.x=v,T.Qc(d)),T.A(n),A=this.Lh(n,f,v)),T.Tr(l),w=m,1==(m=A)?(a.oc(T,y),y=!1):y=!0}}}else 1==(m=b)?(a.oc(_,y),y=!1):y=!0}}return a},e.prototype.FB=function(){this.ji=-1,this.Vl(!1,this.Ca.v),this.Vl(!1,this.Ca.C),this.Vl(!0,this.Ca.G),this.Vl(!0,this.Ca.H),this.dd.resize(0),this.dd.Jb(100),this.ji=this.g.Gd();for(var e=new t.h,i=this.g.Ob(this.X);-1!=i;i=this.g.Rb(i))for(var n=this.g.Xa(i),r=0,s=this.g.Ja(i);r<s;r++,n=this.g.U(n))this.g.D(n,e),(this.Ca.v==e.x||this.Ca.C==e.x||this.Ca.G==e.y||this.Ca.H==e.y)&&(this.g.Ra(n,this.ji,this.dd.size),this.dd.add(n));this.Nl(!1,this.Ca.v),this.Nl(!1,this.Ca.C),this.Nl(!0,this.Ca.G),this.Nl(!0,this.Ca.H),this.Ty()},e.prototype.My=function(e){for(var i=new t.h,n=new t.h,r=null,s=null,o=t.O.lg(2048,0),a=this.g.Ob(this.X);-1!=a;a=this.g.Rb(a)){var h=this.g.Xa(a),l=h;do{var c=this.g.U(l);this.g.D(l,i);var u=-1;if(i.x==this.Ca.v?(this.g.D(c,n),n.x==this.Ca.v&&(u=1)):i.x==this.Ca.C&&(this.g.D(c,n),n.x==this.Ca.C&&(u=1)),i.y==this.Ca.G?(this.g.D(c,n),n.y==this.Ca.G&&(u=0)):i.y==this.Ca.H&&(this.g.D(c,n),n.y==this.Ca.H&&(u=0)),-1!=u){if(null==r&&(r=new t.h),null==s&&(s=new t.h),r.L(i),s.ma(0,0),0==u){var d=i.x-this.Ca.v;s.x=t.lc.sign(n.x-i.x),r.x=e*t.lc.Cn(Math.floor(Math.abs(d/e)),d)+this.Ca.v,0>r.x&&(r.x+=e)}else d=i.y-this.Ca.G,s.y=t.lc.sign(n.y-i.y),r.y=e*t.lc.Cn(Math.floor(Math.abs(d/e)),d)+this.Ca.G,0>r.y&&(r.y+=e);d=0!=u?n.y-i.y:n.x-i.x;var f=Math.abs(d);if(65536<f/e)throw t.i.fa("internal error");if(0<f){f=t.O.truncate(f/e)+2,o.length<f&&(o=t.O.lg(f));for(var p=f=0;;p++){var g=new t.h;if(g.x=r.x+s.x*p*e,g.y=r.y+s.y*p*e,1<=(g=(0!=u?g.y-i.y:g.x-i.x)/d))break;0>=g||(o[f]=g,f++)}0!=f&&this.g.Ul(l,o,f)}}l=c}while(l!=h)}},e.prototype.Vl=function(e,i){for(var n=-1,r=new t.h,s=null,o=this.g.Ob(this.X);-1!=o;o=this.g.Rb(o))for(var a=this.g.Xa(o),h=0,l=this.g.Ja(o);h<l;h++){var c=this.g.U(a);this.g.D(a,r),(e?r.y==i:r.x==i)&&(this.g.D(c,r),(e?r.y==i:r.x==i)&&(-1==n&&(n=this.g.Gd()),null==s&&(s=new t.ia(0)).Jb(100),1!=this.g.Pa(a,n)&&(s.add(a),this.g.Ra(a,n,1)),1!=this.g.Pa(c,n)&&(s.add(c),this.g.Ra(c,n,1)))),a=c}if(-1!=n&&this.g.Td(n),!(null==s||3>s.size)){var u=this;s.Vd(0,s.size,(function(t,e){return u.Mh(t,e)})),n=new t.h,o=new t.h,a=new t.h,o.Rc();var d=-1;h=new t.ia(0),l=new t.ia(0),c=null;for(var f=this.g.Gd(),p=this.g.Gd(),g=0,v=s.size;g<v;g++){var m=s.get(g);if(this.g.D(m,r),!r.qb(o)){if(-1!=d){for(var y=d;y<g;y++){d=s.get(y);var _=this.g.U(d);m=this.g.Ma(d);var b=!1;this.g.D(_,n),0>o.compare(n)&&(e?n.y==i:n.x==i)&&(h.add(d),b=!0,this.g.Ra(d,p,1)),this.g.D(m,n),0>o.compare(n)&&(e?n.y==i:n.x==i)&&(b||h.add(d),this.g.Ra(d,f,1))}for(y=0,b=h.size;y<b;y++){if(d=h.get(y),m=this.g.Pa(d,f),_=this.g.Pa(d,p),1==m&&(m=this.g.Ma(d),this.g.D(m,a),!a.qb(r))){null==c&&(c=[]);var w=t.h.tb(o,a);c[0]=t.h.tb(a,r)/w,0==c[0]?c[0]=2220446049250313e-31:1==c[0]&&(c[0]=.9999999999999998),this.g.Ul(m,c,1),m=this.g.Ma(d),this.g.mf(m,r),l.add(m),this.g.Ra(m,f,1),this.g.Ra(m,p,-1)}1==_&&(_=this.g.U(d),this.g.D(_,a),a.qb(r)||(null==c&&(c=[]),w=t.h.tb(o,a),c[0]=t.h.tb(o,r)/w,0==c[0]?c[0]=2220446049250313e-31:1==c[0]&&(c[0]=.9999999999999998),this.g.Ul(d,c,1),m=this.g.U(d),this.g.mf(m,r),l.add(m),this.g.Ra(m,f,-1),this.g.Ra(m,p,1)))}d=h,h=l,(l=d).clear(!1)}d=g,o.L(r)}}this.g.Td(f),this.g.Td(p)}},e.prototype.Nl=function(e,i){for(var n=new t.h,r=null,s=-1,o=0,a=this.dd.size;o<a;o++){var h=this.dd.get(o);if(-1!=h){var l=this.g.U(h);this.g.D(h,n),(e?n.y==i:n.x==i)&&(this.g.D(l,n),(e?n.y==i:n.x==i)&&(-1==s&&(s=this.g.Gd()),null==r&&(r=new t.ia(0)).Jb(100),-2!=this.g.Pa(h,s)&&(r.add(h),this.g.Ra(h,s,-2)),-2!=this.g.Pa(l,s)&&(r.add(l),this.g.Ra(l,s,-2))))}}if(null==r)-1!=s&&this.g.Td(s);else{var c=this;for(r.Vd(0,r.size,(function(t,e){return c.Mh(t,e)})),o=0,a=r.size;o<a;o++){var u=r.get(o);this.g.Ra(u,s,o)}h=new t.h,(l=new t.h).Rc();var d=-1;for(o=0,a=r.size;o<a;o++)if(-1!=(u=r.get(o))&&(this.g.D(u,n),!n.qb(l))){if(-1!=d)for(;;){u=!1;for(var f=1<o-d?o-1:o,p=d;p<f;p++){var g=r.get(p);if(-1!=g){var v=-1,m=this.g.U(g);this.g.D(m,h),0>l.compare(h)&&(e?h.y==i:h.x==i)&&(v=m),m=-1;var y=this.g.Ma(g);if(this.g.D(y,h),0>l.compare(h)&&(e?h.y==i:h.x==i)&&(m=y),-1!=v&&-1!=m)this.Kh(g,r,s),this.g.pd(g,!1),this.Kh(v,r,s),this.g.pd(v,!1),u=!0;else if(-1!=v||-1!=m){for(y=p+1;y<o;y++){var _=r.get(y);if(-1!=_){var b=this.g.U(_),w=-1;this.g.D(b,h),0>l.compare(h)&&(e?h.y==i:h.x==i)&&(w=b),b=this.g.Ma(_);var x=-1;if(this.g.D(b,h),0>l.compare(h)&&(e?h.y==i:h.x==i)&&(x=b),-1!=w&&-1!=x){this.Kh(_,r,s),this.g.pd(_,!1),this.Kh(w,r,s),this.g.pd(w,!1),u=!0;break}if(-1!=v&&-1!=x){this.zt(r,g,v,_,x,s),u=!0;break}if(-1!=m&&-1!=w){this.zt(r,_,w,g,m,s),u=!0;break}}}if(u)break}}}if(!u)break}d=o,l.L(n)}this.g.Td(s)}},e.prototype.Kh=function(t,e,i){i=this.g.Pa(t,i),e.set(i,-1),i=this.g.Pa(t,this.ji),this.dd.set(i,-1),-1!=(e=this.g.bd(t))&&this.g.Xa(e)==t&&(this.g.Jf(e,-1),this.g.Wg(e,-1))},e.prototype.zt=function(t,e,i,n,r,s){this.g.Bc(e,n),this.g.Cc(n,e),this.g.Cc(i,r),this.g.Bc(r,i),this.Kh(n,t,s),this.g.mi(n,!1),this.Kh(r,t,s),this.g.mi(r,!0)},e.prototype.Ty=function(){for(var t=0,e=this.dd.size;t<e;t++){var i=this.dd.get(t);-1!=i&&this.g.aj(i,-1)}for(var n=0,r=0,s=this.g.Ob(this.X);-1!=s;){var o=this.g.Xa(s);if(-1==o||s!=this.g.bd(o)){var a=s;s=this.g.Rb(s),this.g.Jf(a,-1),this.g.$q(a)}else{i=o,a=0;do{this.g.aj(i,s),a++,i=this.g.U(i)}while(i!=o);this.g.cp(s,!1),this.g.Wg(s,this.g.Ma(o)),this.g.Vj(s,a),r+=a,n++,s=this.g.Rb(s)}}for(t=0,e=this.dd.size;t<e;t++)if(-1!=(i=this.dd.get(t))&&-1==(s=this.g.bd(i))){s=this.g.vf(this.X,-1),a=0,o=i;do{this.g.aj(i,s),a++,i=this.g.U(i)}while(i!=o);2>=a?(i=this.g.Pa(o,this.ji),this.dd.set(i,-1),o=this.g.pd(o,!1),2==a&&(0<=(i=this.g.Pa(o,this.ji))&&this.dd.set(i,-1),this.g.pd(o,!1)),a=s,this.g.Jf(a,-1),this.g.$q(a)):(this.g.kn(s,!0),this.g.Vj(s,a),this.g.Jf(s,o),this.g.Wg(s,this.g.Ma(o)),this.g.cp(s,!1),r+=a,n++)}for(this.g.Rl(this.X,n),this.g.Tj(this.X,r),t=0,e=this.g.ld;-1!=e;e=this.g.ue(e))t+=this.g.I(e);this.g.bC(t)},e.By=function(t,i,n,r){return new e(i,r).Ay(t,n)},e.clip=function(t,i,n,r,s){return e.Nu(t,i,null,n,r,s)},e.Nu=function(i,n,r,s,o,a){var h=i.getType();if(33==h)return o=i.D(),n.contains(o)?i:i.Ia();if(197==h)return o=new t.l,i.A(o),o.Ea(n)?(n=new t.Fh,i.copyTo(n),n.Xo(o),n):i.Ia();if(i.B())return i;if(n.B())return i.Ia();var l=new t.l;if(i.xc(l),n.contains(l))return i;if(!n.isIntersecting(l))return i.Ia();if((null!=r||isNaN(s))&&t.ta.ty(r,n,!1),!t.aa.xj(h))throw t.i.N();if(null!=(r=i.Bb)&&null!=(r=r.Fk)){if(1==(r=r.Ro(n))){if(1736!=h)throw t.i.fa("internal error");return(i=new t.Da(i.description)).tp(n),i}if(0==r)return i.Ia()}switch(h){case 550:for(a=null,h=i.I(),r=i.ub(0),s=0,o=new t.h,l=0;l<h;l++)r.tc(2*l,o),n.contains(o)||(0==s&&(a=i.Ia()),s<l&&a.Fd(i,s,l),s=l+1);return 0<s&&a.Fd(i,s,h),0==s?i:a;case 1736:case 1607:return e.By(i,n,o,a);default:throw t.i.fa("internal error")}},e.prototype.Mh=function(e,i){var n=new t.h;return this.g.D(e,n),e=new t.h,this.g.D(i,e),n.compare(e)},e}();t.ri=e}(X||(X={})),function(t){var e=new t.h,i=function(){function e(e,i,n,r,s){this.Pm=new t.h,this.Dk=new t.h,this.Pi=new t.h,this.g=e,this.Aw=n,this.no=r,this.Pm=i,this.yl=s,this.Dk.Rc(),this.Pi.Rc()}return e.prototype.xE=function(e){this.g.D(e,this.Dk),e=t.O.truncate((this.Dk.x-this.Pm.x)*this.no+.5);var i=t.O.truncate((this.Dk.y-this.Pm.y)*this.no+.5);return n.jG(e,i)},e.prototype.jz=function(t){return this.g.Pa(t,this.yl)},e.prototype.Py=function(t,e){return this.g.D(t,this.Dk),this.g.D(e,this.Pi),n.Cv(this.Dk.x,this.Dk.y,this.Pi.x,this.Pi.y,this.Aw)},e}();t.sY=function(){};var n=function(){function n(){this.Pm=new t.h,this.pq=[0,0,0,0],this.xs=[0,0,0,0],this.qo=this.yl=-1}return n.iQ=function(t,e){var i=new n;return i.g=t,i.qa=e,i.Aw=e*e,i.$v=2*e,i.no=1/i.$v,i.BO()},n.Cv=function(t,e,i,n,r){return(t-=i)*t+(e-=n)*e<=r},n.jG=function(e,i){return t.O.Th(i,t.O.Th(e))},n.prototype.DO=function(i,r){this.g.Gc(i,e);for(var s=(e.y-this.Pm.y)*this.no,o=t.O.truncate((e.x-this.Pm.x)*this.no),a=t.O.truncate(s),h=s=0;1>=h;h+=1)for(var l=0;1>=l;l+=1){var c=n.jG(o+h,a+l),u=this.xl.rR(c);-1!=u&&(this.pq[s]=u,this.xs[s]=c,s++)}for(o=s-1;1<=o;o--)for(u=this.pq[o],a=o-1;0<=a;a--)if(u==this.pq[a]){this.xs[a]=-1,o!=--s&&(this.xs[o]=this.xs[s],this.pq[o]=this.pq[s]);break}for(a=0;a<s;a++)this.EO(i,this.xs[a],e,this.pq[a],r)},n.prototype.EO=function(e,i,r,s,o){for(var a=new t.h;-1!=s;s=this.xl.ER(s)){var h=this.xl.ja(s);e==h||-1!=i&&this.g.Pa(h,this.yl)!=i||(this.g.Gc(h,a),n.Cv(r.x,r.y,a.x,a.y,this.Aw)&&o.add(s))}},n.prototype.Xm=function(t,e,i){var n=this.g.Pa(t,this.qo),r=this.g.Pa(e,this.qo);return-1==n&&(n=this.zd.Ph(),this.zd.addElement(n,t),this.g.Ra(t,this.qo,n)),-1==r?this.zd.addElement(n,e):this.zd.Hy(n,r),this.g.Ra(e,this.qo,-2),e=this.YT(t,e),i&&(i=this.kw.xE(t),this.g.Ra(t,this.yl,i)),e},n.WT=function(e,i,r){e.Nb(i),r=e;var s=new t.h;n.XT(e.D(),i.D(),s),r.Cb(s)},n.XT=function(t,e,i){var n=t.x;t.x!=e.x&&(n=(1*t.x+1*e.x)/2);var r=t.y;t.y!=e.y&&(r=(1*t.y+1*e.y)/2),i.ma(n,r)},n.prototype.YT=function(e,i){var n=new t.h;this.g.D(e,n);var r=new t.h;this.g.D(i,r);var s=this.g.cG(e),o=s+(i=this.g.cG(i)),a=0,h=n.x;n.x!=r.x&&(h=(n.x*s+r.x*i)/o,a++);var l=n.y;return n.y!=r.y&&(l=(n.y*s+r.y*i)/o,a++),0<a&&this.g.Cb(e,h,l),this.g.vX(e,o),0!=a},n.prototype.BO=function(){var e=this.g.fd,n=this.g.IF();for(this.Pm=n.mz(),n=Math.max(n.ca(),n.R())/2147483646,this.$v<n&&(this.$v=n,this.no=1/this.$v),this.zd=new t.au,this.zd.At(t.O.truncate(this.g.fd/3+1)),this.zd.fn(t.O.truncate(this.g.fd/3+1)),this.yl=this.g.Gd(),this.qo=this.g.Gd(),this.kw=new i(this.g,this.Pm,this.Aw,this.no,this.yl),this.xl=new t.dL(t.O.truncate(4*e/3),this.kw),this.xl.AW(this.g.fd),e=!1,n=this.g.ld;-1!=n;n=this.g.ue(n))for(var r=this.g.Ob(n);-1!=r;r=this.g.Rb(r))for(var s=this.g.Xa(r),o=0,a=this.g.Ja(r);o<a;o++){var h=this.kw.xE(s);this.g.Ra(s,this.yl,h),this.xl.addElement(s,h),s=this.g.U(s)}var l=new t.ia(0);for(l.Jb(10),n=this.g.ld;-1!=n;n=this.g.ue(n))for(r=this.g.Ob(n);-1!=r;r=this.g.Rb(r))for(s=this.g.Xa(r),o=0,a=this.g.Ja(r);o<a;o++){if(-2!=this.g.Pa(s,this.qo))for(h=this.g.Pa(s,this.yl),this.xl.jd(s,h);this.DO(s,l),0!=l.size;){h=!1;for(var c=0,u=l.size;c<u;c++){var d=l.get(c),f=this.xl.ja(d);this.xl.vd(d),h=this.Xm(s,f,c+1==u)||h}if(e=e||h,l.clear(!1),!h)break}s=this.g.U(s)}return e&&this.vN(),this.kw=this.xl=null,this.g.Td(this.yl),this.g.Td(this.qo),e},n.prototype.vN=function(){for(var e=new t.h,i=this.zd.je;-1!=i;i=this.zd.qz(i)){var n=this.zd.rc(i);for(this.g.D(this.zd.ja(n),e),n=this.zd.lb(n);-1!=n;n=this.zd.lb(n))this.g.mf(this.zd.ja(n),e)}},n}();t.Yt=n}(X||(X={})),function(t){var e=function(){function e(t){void 0===t&&(t=null),this.yg=null,this.Pb=!1,this.yg=null===t?[]:t}return e.prototype.copyTo=function(e){if(e.Pb)throw t.i.fa("CompositeGeographicTransformation is read-only");for(var i=0;i<this.yg.length;i++)e.yg.push(this.yg[i].Of())},e.prototype.count=function(){return this.yg.length},e.prototype.add=function(e){if(this.Pb)throw t.i.fa("CompositeGeographicTransformation is read-only");this.yg.push(e.Of())},e.prototype.clear=function(){if(this.Pb)throw t.i.fa("CompositeGeographicTransformation is read-only");this.yg.length=0},e.prototype.remove=function(e){if(this.Pb)throw t.i.fa("CompositeGeographicTransformation is read-only");this.yg.splice(e,1)},e.prototype.jg=function(){var t=new e;return this.copyTo(t),t},e.prototype.Of=function(){return this.jg()},e.prototype.transform=function(e,i,n,r){if(e.length<i)throw t.i.fa("invalid Argument");var s=n;for(n=0;n<this.yg.length;n++){var o=this.yg[n];if(null!=o.qm()){var a=o.Un,h=a?1:0,l=a?o.qm().getGeogcs2():o.qm().getGeogcs1();if(l=s/(l=l.getUnit().getUnitFactor()),3552713678800501e-30<Math.abs(l-1))for(s=0;s<i;s++)e[s][0]*=l,e[s][1]*=l;t.MC.geogToGeog(o.qm(),i,e,null,h),s=(a?o.qm().getGeogcs1():o.qm().getGeogcs2()).getUnit().getUnitFactor()}}if(l=s/r,3552713678800501e-30<Math.abs(l-1))for(s=0;s<i;s++)e[s][0]*=l,e[s][1]*=l;return i},e.prototype.Nb=function(t){if(t==this)return!0;if(!(t instanceof e)||this.yg.length!=t.yg.length)return!1;for(var i=0;i<this.yg.length;i++)if(!this.yg[i].Nb(t.yg[i]))return!1;return!0},e.prototype.ix=function(){this.Pb=!0},e.prototype.toString=function(){for(var t="CGT ("+this.count()+") ",e=0,i=this.count();e<i;++e)t+=this.yg[e].toString()+", ";return 200<t.length?t.substring(0,197)+"... ("+t.length.toString()+" characters)":t},e.create=function(){return new e},e}();t.wC=e}(X||(X={})),function(t){var e,i=Math.PI,n=2*Math.PI,r=Math.PI/2,s=function(){function t(){}return t.TO=function(e,i){var n=new t;return n.x=e,n.y=i,n.type=0,n.Uh=0,n},t.al=function(e){var i=new t;return i.x=e.x,i.y=e.y,i.type=0,i.Uh=0,i},t.SO=function(e){var i=new t;return i.x=e.x,i.y=e.y,i.type=e.type,i.Uh=e.Uh,i},t.Pd=function(e,i,n){var r=new t;return r.x=e.x+i*Math.cos(n),r.y=e.y+i*Math.sin(n),r.type=e.type,r.Uh=e.Uh,r},t.Pu=function(e,i){var n=new t;return n.x=.5*(e.x+i.x),n.y=.5*(e.y+i.y),n.type=e.type,n.Uh=e.Uh,n},t.TE=function(e,i){var n=new t;return n.x=e.x+.001*(i.x-e.x),n.y=e.y+.001*(i.y-e.y),n.type=e.type,n.Uh=e.Uh,n},t}(),o=function(){};(e=t.fL||(t.fL={}))[e.Round=0]="Round",e[e.Bevel=1]="Bevel",e[e.Miter=2]="Miter",e[e.Square=3]="Square";var a=function(){function e(t){this.NA=this.Yb=this.wg=null,this.nd=t}return e.V=function(i,n,r,s,o,a){if(null==i)throw t.i.N();if(1>i.Db())throw t.i.N();return 0==n||i.B()?i:((a=new e(a)).ko=i,a.Ka=n,a.qa=o,a.Ki=r,a.CA=s,a.Rx())},e.prototype.eM=function(){var e=this.ko,i=e.ac(),n=e.wc(),r=new t.h;return r.uc(n,i),r.normalize(),r.Hv(),r.scale(this.Ka),i.add(r),n.add(r),r=e.Ia(),e.Dc(i),e.Qc(n),r},e.prototype.dM=function(){var e=this.ko;if(0<this.Ka&&2!=this.Ki){var i=new t.Da;return i.ad(e,!1),this.ko=i,this.Rx()}return(e=new t.Fh(e.$)).W(this.Ka,this.Ka),e},e.prototype.tJ=function(t,e,i,n){return(e.x-t.x)*(n.x-i.x)+(e.y-t.y)*(n.y-i.y)},e.prototype.fc=function(t,e){if(void 0===e)this.Yb.push(t),this.gf++;else if(0==this.gf)this.fc(t);else{var i=this.Bw,n=this.wg[0==e?i-1:e-1],o=this.wg[e],a=this.tJ(n,o,this.Yb[this.gf-1],t);0<a?this.fc(t):0>a&&(0<this.tJ(n,o,o,this.Yb[this.gf-1])?(o=this.wg[0==e?i-2:1==e?i-1:e-2],i=s.Pd(n,this.Ka,Math.atan2(n.y-o.y,n.x-o.x)-r),this.Yb[this.gf-1]=i,1==this.Ki||2==this.Ki?(i=s.Pu(i,n),this.fc(i),i=s.Pd(n,this.Ka,this.Jv+r),(n=s.Pu(i,n)).type|=256,this.fc(n)):(i=s.Pd(n,this.Ka,this.Jv+r)).type|=256,this.fc(i),this.fc(t,e)):(i=s.Pd(o,this.Ka,this.Jv+r),this.fc(i),1==this.Ki||2==this.Ki?(i=s.Pu(i,o),this.fc(i),i=s.Pd(o,this.Ka,this.aA-r),(n=s.Pu(i,o)).type|=256,this.fc(n)):(i=s.Pd(o,this.Ka,this.aA-r)).type|=256,this.fc(i)))}},e.prototype.mE=function(){var e,o=this.Bw;this.gf=0;var a=.5*this.qa,h=0,l=0;for(e=0;e<o;e++){var c=this.wg[e],u=0==e?this.wg[o-1]:this.wg[e-1],d=e==o-1?this.wg[0]:this.wg[e+1],f=u.x-c.x,p=u.y-c.y,g=d.x-c.x,v=d.y-c.y,m=Math.atan2(p,f),y=Math.atan2(v,g);if(this.Jv=m,this.aA=y,0==e&&(h=m,l=y),f=f*v-g*p,p=y,y<m&&(y+=n),0<f*this.Ka)1==this.Ki||2==this.Ki?(m=s.Pd(c,this.Ka,m+r),this.fc(m),m=s.TE(c,m),this.fc(m),m=s.Pd(c,this.Ka,y-r),(c=s.TE(c,m)).type|=256,this.fc(c),this.fc(m)):(f=.5*(y-m),f=this.Ka/Math.abs(Math.sin(f)),m=s.Pd(c,f,.5*(m+y)),this.fc(m,e));else if(512&c.type){for(f=1-a/Math.abs(this.Ka),u=1,d=0>this.Ka?-i:i,-1<f&&1>f&&(.017453292519943295>(p=2*Math.acos(f))&&(p=.017453292519943295),1<(u=t.O.truncate(i/p+1.5))&&(d/=u)),p=m+r,m=s.Pd(c,this.Ka,p),0==e&&(m.type|=1024),this.fc(m,e),f=this.Ka/Math.cos(d/2),p+=d/2,(m=s.Pd(c,f,p)).type|=1024,this.fc(m);0<--u;)p+=d,(m=s.Pd(c,f,p)).type|=1024,this.fc(m);(m=s.Pd(c,this.Ka,y-r)).type|=1024,this.fc(m)}else if(1==this.Ki)m=s.Pd(c,this.Ka,m+r),this.fc(m,e),m=s.Pd(c,this.Ka,y-r),this.fc(m);else if(0==this.Ki)for(f=1-a/Math.abs(this.Ka),u=1,d=y-r-(m+r),-1<f&&1>f&&(.017453292519943295>(p=2*Math.acos(f))&&(p=.017453292519943295),1<(u=t.O.truncate(Math.abs(d)/p+1.5))&&(d/=u)),f=this.Ka/Math.cos(.5*d),p=m+r+.5*d,m=s.Pd(c,f,p),this.fc(m,e);0<--u;)p+=d,m=s.Pd(c,f,p),this.fc(m);else 2==this.Ki?(f=u.x-c.x,p=u.y-c.y,.99999999<(u=(f*(g=d.x-c.x)+p*(v=d.y-c.y))/Math.sqrt(f*f+p*p)/Math.sqrt(g*g+v*v))?(m=s.Pd(c,1.4142135623730951*this.Ka,y-.25*i),this.fc(m,e),m=s.Pd(c,1.4142135623730951*this.Ka,y+.25*i),this.fc(m)):(u=Math.abs(this.Ka/Math.sin(.5*Math.acos(u))))>(d=Math.abs(this.CA*this.Ka))?(f=.5*(y-m),f=this.Ka/Math.abs(Math.sin(f)),m=s.Pd(c,f,.5*(m+y)),y=t.h.construct(m.x,m.y),m=t.h.construct(c.x,c.y),(c=new t.h).uc(y,m),(y=new t.h).HW(d/c.length(),c,m),m=(u-d)*Math.abs(this.Ka)/Math.sqrt(u*u-this.Ka*this.Ka),0<this.Ka?c.Hv():c.ar(),c.scale(m/c.length()),(m=new t.h).add(y,c),(u=new t.h).uc(y,c),m=s.al(m),this.fc(m,e),m=s.al(u),this.fc(m)):(f=.5*(y-m),f=this.Ka/Math.abs(Math.sin(f)),m=s.Pd(c,f,.5*(m+y)),this.fc(m,e))):(y=p,0<this.Ka?(y>m&&(y-=n),u=m-y<r):(y<m&&(y+=n),u=y-m<r),u?(p=0>(f=1.4142135623730951*this.Ka)?m+.25*i:m+.75*i,m=s.Pd(c,f,p),this.fc(m,e),p=0>f?y-.25*i:y-.75*i,m=s.Pd(c,f,p),this.fc(m)):(f=.5*(y-m),f=this.Ka/Math.abs(Math.sin(f)),y<m&&(y+=n),m=s.Pd(c,f,(m+y)/2),this.fc(m,e)))}return this.Jv=h,this.aA=l,this.fc(this.Yb[0],0),c=s.SO(this.Yb[this.gf-1]),this.Yb[0]=c,this.wW()},e.prototype.Au=function(e,i){if(!(2>i))for(var n=0;n<i;n++){var r=this.Yb[e+n];0!=n?this.NA.Ci(t.h.construct(r.x,r.y)):this.NA.Lt(t.h.construct(r.x,r.y))}},e.prototype.fM=function(t,e,i){var n=t.Ba(e),r=t.Vc(e);if(this.Yb=[],this.NA=i,t.dc(e)){for(e=t.Na(n);t.Na(r-1).qb(e);)r--;if(2<=r-n){for(this.Bw=r-n,this.wg=[],e=n;e<r;e++)this.wg.push(s.al(t.Na(e)));this.mE()&&this.Au(0,this.gf-1)}}else{for(e=t.Na(n);n<r&&t.Na(n+1).qb(e);)n++;for(e=t.Na(r-1);n<r&&t.Na(r-2).qb(e);)r--;if(2<=r-n){for(this.Bw=2*(r-n)-2,this.wg=[],(i=s.al(t.Na(n))).type|=1536,this.wg.push(i),e=n+1;e<r-1;e++)i=s.al(t.Na(e)),this.wg.push(i);for((i=s.al(t.Na(r-1))).type|=512,this.wg.push(i),e=r-2;e>=n+1;e--)(i=s.al(t.Na(e))).type|=1024,this.wg.push(i);if(this.mE())if(2<=this.Yb.length){for(t=-1,(r=!!(1024&this.Yb[this.gf-1].type))||(t=0),e=1;e<this.gf;e++)(n=!!(1024&this.Yb[e].type))?r||1<(r=e-1)-t+1&&this.Au(t,r-t+1):r&&(t=e-1),r=n;r||1<(r=this.gf-1)-t+1&&this.Au(t,r-t+1)}else t=0,r=this.gf-1,0<=t&&1<=r-t&&this.Au(t,r-t+1)}}this.wg=null,this.Bw=0,this.Yb=null,this.gf=0},e.prototype.wW=function(){for(var t=!1,e=0;e<this.gf;e++){var i=this.Yb[e];i.qh=e+1,i.sh=e-1,this.Yb[e]=i}for((i=this.Yb[0]).sh=this.gf-2,this.Yb[0]=i,(i=this.Yb[this.gf-2]).qh=0,this.Yb[this.gf-2]=i,e=i=0;e<this.gf;e++)if(256&this.Yb[i].type){var n=this.GP(i);if(-1==n){t=!0;break}i=n}else i=this.Yb[i].qh;return!t&&(this.QO(i),!0)},e.prototype.GP=function(t){for(var e,i,n=this.gf-1,r=t,s=1;s<=n-2;s++){e=r=this.Yb[r].qh,i=t;for(var o=1;o<=s;o++){if(i=this.Yb[i].sh,!(256&this.Yb[i].type||256&this.Yb[e].type)){var a=this.gS(i,e);if(-1!=a)return a}e=this.Yb[e].sh}}return-1},e.prototype.gS=function(e,i){var n=this.Yb[this.Yb[e].sh],r=this.Yb[e],s=this.Yb[this.Yb[i].sh],a=this.Yb[i];if(!this.JW(n,r,s,a))return-1;var h=new o;return this.xQ(n,r,s,a,h)&&!h.bE&&t.O.bK((r.x-n.x)*(a.y-s.y)-(r.y-n.y)*(a.x-s.x))!=t.O.bK(this.Ka)?(n=this.Yb[e].sh,h.an.type=r.type,h.an.qh=i,h.an.sh=n,this.Yb[e]=h.an,h.an=this.Yb[i],h.an.sh=e,this.Yb[i]=h.an,i):-1},e.prototype.JW=function(t,e,i,n){return Math.max(t.x,e.x)>=Math.min(i.x,n.x)&&Math.max(i.x,n.x)>=Math.min(t.x,e.x)&&Math.max(t.y,e.y)>=Math.min(i.y,n.y)&&Math.max(i.y,n.y)>=Math.min(t.y,e.y)},e.prototype.xQ=function(t,e,i,n,r){r.bE=!1;var o=(e.y-t.y)*(n.x-i.x)-(e.x-t.x)*(n.y-i.y),a=(i.y-t.y)*(e.x-t.x)-(i.x-t.x)*(e.y-t.y);if(0<=(o=0==o?2:a/o)&&1>=o){var h=o;if(o=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y),a=(t.y-i.y)*(n.x-i.x)-(t.x-i.x)*(n.y-i.y),0<=(o=0==o?2:a/o)&&1>=o)return r.an=s.TO(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y)),r.an.Uh=i.Uh+h*(n.Uh-i.Uh),0!=h&&1!=h||0!=o&&1!=o||(r.bE=!0),r.VY=o,r.WY=h,!((0==h||1==h)&&0<o&&1>o||(0==o||1==o)&&0<h&&1>h)}return!1},e.prototype.QO=function(t){for(;this.Yb[t].sh<t;)t=this.Yb[t].sh;var e=0,i=t;do{i=this.Yb[i],this.Yb[e]=i,i=i.qh,e++}while(i!=t);this.Yb[e]=this.Yb[0],this.gf=e+1},e.prototype.$C=function(t){var e=this.ko,i=e.Ga();if(null!=i){i.Zi();for(var n=-1;i.$a();)n++,this.fM(e,n,t)}},e.prototype.Rx=function(){var e=this.ko.getType();return 322==e?this.eM():197==e?this.dM():t.aa.yd(e)?((e=new t.Ta).oc(this.ko,!0),this.ko=e,this.Rx()):1607==e?(e=new t.Ta,this.$C(e),e):1736==e?(e=new t.Da,this.$C(e),e):null},e}();t.IK=a}(X||(X={})),function(t){var e=function(){function t(t){this.qk=t}return t.prototype.D=function(t,e){this.qk.g.D(t,e)},t.prototype.vd=function(t){var e=this.qk.Fa.ja(t);this.qk.Fa.vd(t,-1),this.qk.g.pd(e,!1)},t}(),i=function(){function t(t){this.qk=t}return t.prototype.D=function(t,e){this.qk.IT.D(t,e)},t.prototype.vd=function(t){this.qk.Fa.vd(t,-1)},t}(),n=function(){function t(t){this.qk=t}return t.prototype.D=function(t,e){e.L(this.qk.LT[t])},t.prototype.vd=function(t){this.qk.Fa.vd(t,-1)},t}(),r=function(){function r(r){void 0===r?(this.Fa=new t.Yj,this.Fa.De(20),this.g=new t.gd,this.xT=this.g.Ig(550),this.Ss=this.g.vf(this.xT,-1),this.Xh=new e(this)):r instanceof Array?(this.Fa=new t.Yj,this.Fa.De(20),this.LT=r,this.Xh=new n(this)):(this.Fa=new t.Yj,this.Fa.De(20),this.IT=r,this.Xh=new i(this))}return r.prototype.Ib=function(e){var i=e.getType();if(t.Gx.xj(i))this.jN(e);else if(t.Vk.yd(i))this.oN(e);else if(197==i)this.gN(e);else{if(33!=i)throw t.i.N("invalid shape type");this.nN(e)}},r.prototype.cR=function(){var e=new t.Sa,i=this.Fa.rc(-1),n=new t.Da(this.g.ht);for(this.g.Vi(this.Fa.ja(i),e),n.nf(e),i=this.Fa.lb(i);-1!=i;i=this.Fa.lb(i))this.g.Vi(this.Fa.ja(i),e),n.lineTo(e);return n},r.RO=function(e){var i=new r(e),n=e.I(),s=1,o=new t.h,a=new t.h,h=new t.h;for(e.D(0,o);e.D(s,a),a.Rz(o)&&s<n-1;)s++;for(i.Fa.addElement(0,-1),i.Fa.xn(s),n=s+1;n<e.I();n++)e.D(n,h),-1!=(s=i.pC(h))&&i.Fa.Sj(s,n);for(h=new t.Sa,s=i.Fa.rc(-1),n=new t.Da(e.description),e.ve(i.Fa.ja(s),h),n.nf(h),s=i.Fa.lb(s);-1!=s;s=i.Fa.lb(s))e.ve(i.Fa.ja(s),h),n.lineTo(h);return n},r.construct=function(t,e,i){for(var n=new r(t),s=1,o=t[0];t[s].Rz(o)&&s<e-1;)s++;for(n.Fa.addElement(0,-1),n.Fa.xn(s),s+=1;s<e;s++)-1!=(o=n.pC(t[s]))&&n.Fa.Sj(o,s);for(t=0,e=n.Fa.rc(-1);-1!=e;e=n.Fa.lb(e))i[t++]=n.Fa.ja(e);return t},r.JG=function(e,i){var n=e.Ba(i),s=e.Vc(i);if(i=!e.dc(i)&&e.Nn(i),e=e.ub(0),s*=2,i&&(s-=2),6>s-(n*=2))return!0;i=new t.h;var o=new t.h,a=new t.h;e.tc(n,i),e.tc(n+2,o),e.tc(n+4,a);var h=r.Wu(o,a,i);if(h.ps()||!r.um(h.value()))return!1;var l=t.h.construct(o.x,o.y),c=new t.h;for(n+=6;n<s;n+=2){if(c.L(o),o.L(a),e.tc(n,a),(h=r.Wu(o,a,i)).ps()||!r.um(h.value()))return!1;if((h=r.Wu(l,a,i)).ps()||!r.um(h.value()))return!1;if((h=r.Wu(o,a,c)).ps()||!r.um(h.value()))return!1}return!0},r.prototype.jN=function(e){for(var i=new t.Sa,n=new t.h,r=0;r<e.I();r++){e.D(r,n);var s=this.Cr(n);if(-1!=s){e.ve(r,i);var o=this.g.fc(this.Ss,i);this.Fa.Sj(s,o)}}},r.prototype.gN=function(e){for(var i=new t.Sa,n=new t.h,r=0;4>r;r++){e.mB(r,n);var s=this.Cr(n);if(-1!=s){e.Hf(r,i);var o=this.g.fc(this.Ss,i);this.Fa.Sj(s,o)}}},r.prototype.oN=function(e){var i=new t.Sa,n=e.ac();if(-1!=(n=this.Cr(n))){e.To(i);var r=this.g.fc(this.Ss,i);this.Fa.Sj(n,r)}n=e.wc(),-1!=(n=this.Cr(n))&&(e.Po(i),e=this.g.fc(this.Ss,i),this.Fa.Sj(n,e))},r.prototype.nN=function(t){var e=t.D();-1!=(e=this.Cr(e))&&(t=this.g.fc(this.Ss,t),this.Fa.Sj(e,t))},r.prototype.Cr=function(t){var e=-1;if(0==this.Fa.size(-1))return this.Fa.addElement(-4,-1);if(1==this.Fa.size(-1)){var i=this.g.Na(this.Fa.ja(this.Fa.rc(-1)));return t.Rz(i)||(e=this.Fa.xn(-5)),e}return this.pC(t)},r.prototype.pC=function(e){var i=-1;do{var n=this.Fa.rc(-1),s=this.Fa.Fc(-1),o=this.Fa.ja(n),a=this.Fa.ja(s),h=new t.h,l=new t.h;if(this.Xh.D(o,h),this.Xh.D(a,l),o=t.h.Uq(l,e,h),r.um(o))i=this.Fa.xn(-1),(h=this.nC(e,s,n))!=n&&this.oC(e,n,this.Fa.we(h));else if(r.CG(o)){l=this.Fa.sv(-1);var c=this.Fa.rc(-1),u=this.Fa.Fc(-1);for(o=new t.h,a=new t.h;c!=this.Fa.we(u);){var d=this.Fa.ja(l);this.Xh.D(d,o),d=t.h.Uq(o,e,h),r.CG(d)?(u=l,l=this.Fa.ll(l)):(c=l,l=this.Fa.Xp(l))}if(l=u,h=c,d=this.Fa.ja(l),c=this.Fa.ja(h),this.Xh.D(d,o),this.Xh.D(c,a),h!=n&&(o=t.h.Uq(a,e,o),!r.um(o)))continue;i=this.Fa.zu(h,l,-2,!1),this.oC(e,l,s),this.nC(e,h,n)}else null==this.sb&&(this.sb=new t.yb),this.sb.Dc(l),this.sb.Qc(h),0>(h=this.sb.fe(e,!0))?(h=this.Fa.we(s),this.Fa.vd(s,-1),i=this.Fa.xn(-3),this.nC(e,h,n)):1<h&&(h=this.Fa.lb(n),this.Fa.vd(n,-1),i=this.Fa.zu(-1,h,-3,!1),this.oC(e,h,s))}while(0);return i},r.prototype.oC=function(e,i,n){if(i!=n){var s=this.Fa.ja(i),o=this.Fa.lb(i),a=new t.h,h=new t.h;for(this.Xh.D(s,a);i!=n&&2<this.Fa.size(-1)&&(this.Xh.D(this.Fa.ja(o),h),s=t.h.Uq(h,e,a),!r.um(s));)s=i,i=o,a.L(h),o=this.Fa.lb(i),this.Xh.vd(s)}},r.prototype.nC=function(e,i,n){if(i==n)return n;var s=this.Fa.ja(i),o=this.Fa.we(i),a=new t.h,h=new t.h;for(this.Xh.D(s,a);i!=n&&2<this.Fa.size(-1)&&(this.Xh.D(this.Fa.ja(o),h),s=t.h.Uq(a,e,h),!r.um(s));)s=i,i=o,a.L(h),o=this.Fa.we(i),this.Xh.vd(s);return i},r.Wu=function(e,i,n){var r=new t.Wb;r.set(i.x),r.sub(e.x);var s=new t.Wb;s.set(n.y),s.sub(e.y);var o=new t.Wb;return o.set(i.y),o.sub(e.y),(i=new t.Wb).set(n.x),i.sub(e.x),r.Ag(s),o.Ag(i),r.sub(o),r},r.um=function(t){return 0>t},r.CG=function(t){return 0<t},r}();t.Zt=r}(X||(X={})),function(t){var e=function(){function e(t){this.g=null,this.tH=!0,this.nd=t}return e.zU=function(e,i,n){return e=t.ta.Er(e),t.Yt.Cv(i.Lg(),i.ih(),n.Lg(),n.ih(),t.lc.ox(e))},e.CO=function(e,i){var n=new t.Sa;return t.Yt.WT(e,i,n),n},e.V=function(t,i,n,r){return(n=new e(n)).g=t,n.qa=i,n.tH=r,n.EM()},e.prototype.nM=function(e){return t.Yt.iQ(this.g,e)},e.prototype.sM=function(e){return t.$t.V(this.g,e,this.nd)},e.prototype.EM=function(){var e=this.qa,i=t.ta.Er(e),n=1.00001*(e=t.ta.rN(e));e*=1.000001;for(var r=!1,s=30<this.g.fd+10?1e3:(this.g.fd+10)*(this.g.fd+10),o=0,a=this.g.jS();;o++){if(o>s)throw t.i.fa("Internal Error: max number of iterations exceeded");var h=this.nM(i);if(r=r||h,this.tH&&(h=0!=this.g.Gp(i,!0,!1),r=r||h),h=!1,(0==o||a||t.$t.kI(!0,this.g,e,null,this.nd))&&(h=this.sM(n),r=r||h),!h)break;t.mp.zp(this.nd)}return r},e}();t.Tk=e}(X||(X={})),function(t){var e=function(){function e(t){this.$d=this.Mc=null,this.Ys=0,this.Ub=t,this.cA=!0}return e.prototype.uv=function(t,e){var i=this.g.bc(t);if(null==i){if(!this.g.ed(t,e))return null;i=e}return i},e.prototype.Xq=function(){var e;void 0===e&&(e=!1),this.Ys++,!e&&4095&this.Ys||(this.Ys=0,t.mp.zp(this.Ub))},e.prototype.nP=function(){var e=this.g.Yq(!1),i=!1,n=new t.yb,r=new t.yb,s=new t.l;s.Oa();var o=new t.l;o.Oa();for(var a=new t.Sa,h=new t.TC,l=e.next();-1!=l;l=e.next()){t.mp.zp(this.Ub);var c=null,u=!1;if(!t.aa.Rn(this.g.ic(e.ck))){if(null==(c=this.uv(l,n)))continue;if(c.A(s),s.W(this.qa,this.qa),c.Bi(this.qa)){if(!c.Bi(0))continue;u=!0,c=null}}var d=this.g.Yq(e),f=d.next();for(-1!=f&&(f=d.next());-1!=f;f=d.next()){var p=null,g=!1;if(!t.aa.Rn(this.g.ic(d.ck))){if(null==(p=this.uv(f,r)))continue;if(p.A(o),p.Bi(this.qa)){if(!p.Bi(0))continue;g=!0,p=null}}var v=0,m=0;if(null!=c&&null!=p)s.HG(o)&&(h.Oo(c),h.Oo(p),h.Ea(this.qa,!1),0<(v=h.ol(0))+(m=h.ol(1))&&(this.g.jr(l,h,0,!0),this.g.jr(f,h,1,!0)),h.clear());else if(null!=c){var y=new t.h;if(this.g.D(f,y),s.contains(y)){if(h.Oo(c),this.g.Vi(f,a),h.Kz(this.qa,a,!1),0<(v=h.ol(0)))if(this.g.jr(l,h,0,!0),g){for(g=-1,y=this.g.U(f);-1!=y&&y!=f&&(g=y,null!=(p=this.uv(y,r))&&p.Bi(0));y=this.g.U(y));for(y=f;-1!=y&&(this.g.Dh(y,h.Bf),y!=g);y=this.g.U(y));}else this.g.Dh(f,h.Bf);h.clear()}}else{if(null==p)continue;if(y=new t.h,this.g.D(l,y),o.W(this.qa,this.qa),o.contains(y)){if(h.Oo(p),this.g.Vi(l,a),h.Kz(this.qa,a,!1),0<(m=h.ol(0)))if(this.g.jr(f,h,0,!0),u){for(g=-1,y=this.g.U(l);-1!=y&&y!=l&&(g=y,null!=(p=this.uv(y,r))&&p.Bi(0));y=this.g.U(y));for(y=l;-1!=y&&(this.g.Dh(y,h.Bf),y!=g);y=this.g.U(y));}else this.g.Dh(l,h.Bf);h.clear()}}if(0!=v+m){if(0!=v){if(null==(c=this.g.bc(l))){if(!this.g.ed(l,n))continue;c=n,n.A(s)}else c.A(s);if(c.Bi(this.qa))break}i=!0}}}return i},e.prototype.oP=function(){return this.QU()},e.prototype.QU=function(){return(new t.RC).PX(this.g,this.qa)},e.prototype.lI=function(){var e=!1;null==this.Mc&&(this.Mc=new t.Yj);var i=new t.ia(0);i.Jb(this.g.fd+1);for(var n=this.g.Yq(),r=n.next();-1!=r;r=n.next())i.add(r);this.g.nx(i,i.size),i.add(-1),n=this.g.Gd(),r=this.g.Gd(),this.$d=new t.UC(this.g,this.qa,!this.cA),this.Mc.Vo(this.$d);var s=new t.ia(0),o=new t.ia(0),a=0;new t.h;var h=this.g.td;this.g.vb.mc();for(var l,c,u=this.g.vb.za[0].o,d=i.get(a++);-1!=d;){var f=l=u[2*(c=h.T(d,0))],p=c=u[2*c+1];do{var g=h.T(d,2),v=h.T(d,1);if(-1!=g){var m=h.T(g,0),y=u[2*m];0>(p<(m=u[2*m+1])?-1:p>m?1:f<y?-1:f>y?1:0)&&(o.add(d),o.add(g))}-1!=v&&(y=u[2*(m=h.T(v,0))],0>(p<(m=u[2*m+1])?-1:p>m?1:f<y?-1:f>y?1:0)&&(o.add(v),o.add(v))),-1!=(y=this.g.Pa(d,n))&&(s.add(y),this.g.Ra(d,n,-1)),-1!=(y=this.g.Pa(d,r))&&(s.add(y),this.g.Ra(d,r,-1)),-1!==(d=i.get(a++))&&(f=u[2*(p=h.T(d,0))],p=u[2*p+1])}while(-1!=d&&f===l&&p===c);for(f=1==s.size&&2==o.size,y=p=-1,g=0,v=s.size;g<v;g++){m=s.get(g);var _=this.Mc.we(m);if(-1==_||s.hG(_)||(p=_),-1==(m=this.Mc.lb(m))||s.hG(m)||(y=m),-1!=p&&-1!=y)break}for(this.$d.$J(c,l),g=0,v=s.size;g<v;g++)m=s.get(g),this.Mc.vd(m,-1);if(s.clear(!1),!f&&-1!=p&&-1!=y&&this.qO(p,y)){e=!0,this.Ni=this.$d.rm();break}for(g=0,v=o.size;g<v;g+=2){if(c=o.get(g),l=o.get(g+1),f?(c=this.Mc.zu(p,y,c,!0),f=!1):c=this.Mc.addElement(c,-1),this.$d.rg){this.Ni=this.$d.rm(),e=!0;break}-1==this.g.Pa(l,n)?this.g.Ra(l,n,c):this.g.Ra(l,r,c)}if(e)break;o.Bh(0)}return this.g.Td(n),this.g.Td(r),e},e.prototype.qO=function(t,e){return this.$d.compare(this.Mc,this.Mc.ja(t),e),t=this.$d.rg,this.$d.Kr(),t},e.yE=function(e){for(var i=e.ld;-1!=i;i=e.ue(i))if(t.aa.Hc(e.ic(i)))return!0;return!1},e.fQ=function(t,i,n,r){return!!e.yE(t)&&((i=new e(r)).g=t,i.qa=n,15>t.fd?t=i.nP():i.oP())},e.V=function(t,i,n){return e.fQ(t,t.IF(),i,n)},e.kI=function(i,n,r,s,o){if(!e.yE(n))return!1;var a=new e(o);if(a.g=n,a.qa=r,a.cA=i,a.lI())return null!=s&&s.Wt(a.Ni),!0;var h=new t.Dd;return h.$B(),n.Oc(h),(a=new e(o)).g=n,a.qa=r,a.cA=i,i=a.lI(),h.$B(),n.Oc(h),!!i&&(null!=s&&s.Wt(a.Ni),!0)},e.Ml=function(t,e){return!(16>(t=t.I()))&&2*t+Math.log(t)*Math.LOG10E/Math.log(2)*e<1*t*e},e.lP=function(i,n,r,s){var o=n.getType();if(t.aa.Hc(o))return new e(s).mP(i,n,r);throw t.i.fa("crack_A_with_B")},e.prototype.mP=function(n,r,s){var o=new t.l;n.xc(o);var a=new t.l;if(r.xc(a),a.W(s,s),!a.isIntersecting(o))return n;var h=n.Bb,l=null;null!=h&&(l=h.Fb),e.Ml(n,n.I())&&(l=t.ta.jj(n,a));var c=null!=l?l.getIterator():null,u=r.Ga();r=n.Ga();var d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(a=[];u.$a();)for(;u.Ha();){var f=u.ha();if(null!=l){for(c.Uo(f,s),h=c.next();-1!=h;h=c.next())if(this.Xq(),r.Vb(l.ja(h),-1),r.Ha()){var p=(h=r.ha()).Ea(f,null,d,null,s);for(h=0;h<p;++h){var g=d[h];if(0!=g&&1!=g){var v=r.wb(),m=new i;m.t=g,m.index=v,a.push(m)}}}}else{var y=new t.l;if(f.xc(y),y.W(s,s),o.isIntersecting(y))for(r.Zi();r.$a();)for(;r.Ha();)if(this.Xq(),h=r.ha(),g=new t.l,h.xc(g),g.isIntersecting(y))for(p=h.Ea(f,null,d,null,s),h=0;h<p;++h)0!=(g=d[h])&&1!=g&&(v=r.wb(),(m=new i).t=g,m.index=v,a.push(m))}}if(0==a.length)return n;for(a=a.sort(i.Ey),n=n.Ia(),r.Zi();r.$a()&&!r.Ha(););for(s=r.ha(),o=new t.ig,l=-1,h=0,c=a.length;h<c;){for(d=a[h].index,u=h+1;u<c&&a[u].index==d;)++u;for(;r.wb()<d;){if(this.Xq(),f=r.Ha(),g=r.gb,(y=f||!r.On()||r.Pn())&&n.oc(s,l!=g),l=g,!f)for(;r.$a()&&!r.Ha(););s=r.ha()}for(d=0;h<u;h++)(g=a[h].t)!=d&&(s.ah(d,g,o),d=g,g=r.gb,n.oc(o.get(),l!=g),l=g);if((y=(f=r.Ha())||!r.On()||r.Pn())&&(s.ah(d,1,o),n.oc(o.get(),!1)),f)s=r.ha();else{for(;r.$a()&&!r.Ha(););s=r.Ha()?r.ha():null}h=u}for(null!=s&&(g=r.gb,(y=(f=r.Ha())||!r.On()||r.Pn())&&n.oc(s,l!=g),l=g),f=r.Ha();;){if(!f){for(;r.$a()&&!(f=r.Ha()););if(!f)break}s=r.ha(),g=r.gb,(y=(f=r.Ha())||!r.On()||r.Pn())&&n.oc(s,l!=g),l=g}return n},e}();t.$t=e;var i=function(){function t(){}return t.Ey=function(t,e){return t.index==e.index?t.t>e.t?1:t.t<e.t?-1:0:t.index>e.index?1:-1},t}()}(X||(X={})),function(t){var e;(e=t.KK||(t.KK={}))[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Coincident=2]="Coincident",e[e.Undefined=3]="Undefined",e[e.Uncut=4]="Uncut";var i=function(t,e,i,n,r,s,o,a,h,l,c){this.X=t,this.bt=e,this.Ns=i,this.tg=n,this.Lm=l,this.Al=c};t.uY=i;var n=function(){function e(t,e){this.JH=t,this.Hi=e}return e.prototype.qM=function(e,i){var n=new t.h;this.Hi.D(e,n);var r=new t.h;return this.Hi.D(i,r),0!=(n=n.compare(r))?n:(e=this.Hi.Pa(e,this.JH))<(i=this.Hi.Pa(i,this.JH))?-1:e==i?0:1},e}(),r=function(t,e,i,n,r,s,o,a,h){this.tg=t,this.Ns=e,this.OA=i,this.UH=n,this.Ei=r,this.Al=s,this.Lm=o,this.VH=a,this.OT=h};t.tY=r,t.LK=function(){function e(){}return e.JK=function(n,r,s,o,a,h){if(r.B())n=new i(r,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),a.push(n);else if(s.B())n=new i(r,4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),a.push(n);else{var l=new t.gd;if(l.Ib(r),l.Ib(s),t.Tk.V(l,o,h,!0),0==l.fd)n=new i(r.Ia(),4,-1,-1,NaN,4,-1,-1,NaN,-1,-1,NaN,-1,-1,NaN),a.push(n);else{for(r=0,s=l.Gd(),o=l.ld;-1!=o;o=l.ue(o))for(h=l.Ob(o);-1!=h;h=l.Rb(h))for(var c=l.Xa(h),u=0,d=l.Ja(h);u<d;c=l.U(c),u++)l.Ra(c,s,r++);r=e.HM(s,l),e.cM(n,r,l,a)}}},e.HM=function(i,r){for(var s=r.fd,o=new t.ia(0),a=r.ld;-1!=a;a=r.ue(a))for(var h=r.Ob(a);-1!=h;h=r.Rb(h))for(var l=r.Xa(h),c=0,u=r.Ja(h);c<u;l=r.U(l),c++)o.add(l);var d=new n(i,r);o.Vd(0,s,(function(t,e){return d.qM(t,e)})),i=[];var f=[],p=r.Gd(),g=r.Gd();a=r.ld,h=r.ue(a),u=new t.h;var v=new t.h,m=o.get(0),y=r.bd(m),_=r.Qf(y);r.D(m,u);var b=1;for(l=0;b<s-1;){var w=!1;for(c=b;c<s;c++)if(c!=l){var x=o.get(c),T=r.bd(x),A=r.Qf(T);if(r.D(x,v),!u.qb(v))break;_==a&&A==h&&(w=e.uM(p,g,r,i,f,y,m,T,x))}if(w||l==b-1){if(w&&l==b-1&&b--,++l==s)break;m=o.get(l),y=r.bd(m),_=r.Qf(y),r.D(m,u)}w||(b=l+1)}for(s=[],a=r.ld;-1!=a;a=r.ue(a))for(h=r.Ob(a);-1!=h;h=r.Rb(h))for(o=r.Xa(h),c=0,u=r.Ja(h);c<u;o=r.U(o),c++){if(0<=(l=r.Pa(o,g)))for(;l<f.length&&f[l].tg==o;)s.push(f[l++]);if(0<=(l=r.Pa(o,p)))for(;l<i.length&&i[l].tg==o;)s.push(i[l++])}return r.Td(p),r.Td(g),s},e.uM=function(t,i,n,r,s,o,a,h,l){var c=n.rj(o),u=n.rj(h),d=n.Xa(o),f=n.Xa(h),p=n.Ma(a),g=n.Ma(l),v=!1,m=!1,y=!1,_=!1;return a!=d&&(l!=f&&(v=e.vM(t,n,r,o,p,h,g)),l!=u&&(m=e.wM(t,n,r,o,p,h,l))),a!=c&&(l!=f&&(y=e.xM(i,n,s,o,a,h,g,d)),l!=u&&(_=e.yM(i,n,s,o,a,h,l,d))),v&&m&&y?(t=r.length-1,2==s[_?s.length-2:s.length-1].Ei&&(r[t-1]=r[t],--r.length)):v&&m&&_&&2==s[s.length-1].Ei&&(s=r[r.length-1],--r.length,n.Pa(s.tg,t)==r.length&&n.Ra(s.tg,t,-1)),v||m||y||_},e.vM=function(e,i,n,s,o,a,h){var l=new t.yb,c=new t.yb,u=[0,0],d=[0,0],f=i.bc(o);return null==f&&(i.ed(o,l),f=l),null==(l=i.bc(h))&&(i.ed(h,c),l=c),2>(f=f.Ea(l,null,u,d,0))&&(s=new r(o,s,u[0],NaN,f,h,a,d[0],NaN),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1)),!0},e.wM=function(e,i,n,s,o,a,h){var l=new t.yb,c=new t.yb,u=[0,0],d=[0,0],f=i.bc(o);return null==f&&(i.ed(o,l),f=l),null==(l=i.bc(h))&&(i.ed(h,c),l=c),2>(f=f.Ea(l,null,u,d,0))&&(s=new r(o,s,u[0],NaN,f,h,a,d[0],NaN),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1),!0)},e.xM=function(e,i,n,s,o,a,h,l){var c=new t.yb,u=new t.yb,d=[0,0],f=[0,0],p=i.bc(o);return null==p&&(i.ed(o,c),p=c),null==(c=i.bc(h))&&(i.ed(h,u),c=u),2==(p=p.Ea(c,null,d,f,0))?(s=new r(o,s,d[0],d[1],p,h,a,f[0],f[1]),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1),!0):(u=!1,o==l&&(s=new r(o,s,d[0],NaN,p,h,a,f[0],NaN),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1),u=!0),u)},e.yM=function(e,i,n,s,o,a,h,l){var c=new t.yb,u=new t.yb,d=[0,0],f=[0,0],p=i.bc(o);return null==p&&(i.ed(o,c),p=c),null==(c=i.bc(h))&&(i.ed(h,u),c=u),2==(p=p.Ea(c,null,d,f,0))?(s=new r(o,s,d[0],d[1],p,h,a,f[0],f[1]),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1),!0):(u=!1,o==l&&(s=new r(o,s,d[0],NaN,p,h,a,f[0],NaN),n.push(s),0>(s=i.Pa(o,e))&&i.Ra(o,e,n.length-1),u=!0),u)},e.cM=function(n,r,s,o){var a=[];a[0]=new t.h,a[1]=new t.h,a[2]=new t.h,a[3]=new t.h;var h=new t.h,l=new t.h,c=new t.h,u=new t.h,d=null;null!=o&&(d=new t.ig).Or();var f=0,p=null,g=new t.yb;new t.yb;for(var v=s.Ob(s.ld);-1!=v;v=s.Rb(v)){for(var m=4,y=-1,_=-1,b=-1,w=-1,x=NaN,T=!0,A=!1,M=!0,S=!0,E=!0,C=0,O=v,R=0,I=s.Xa(v),P=s.Ja(v),N=0;N<P;I=s.U(I),N++){var D=s.bc(I);if(null==D){if(!s.ed(I,g))continue;D=g}-1==_&&(_=I);for(var L=0;f<r.length&&I==r[f].tg;){y=r[f].Ns;var z=r[f].tg,j=r[f].OA,k=r[f].Lm,F=r[f].Al,H=r[f].VH;if(2==r[f].Ei){if(A||(O=y,_=z,R=j,b=k,w=F,x=H,m=2,null!=o?p=new t.Ta:C=0,E=!1,S=!0),j=r[f].UH,H=r[f].OT,null!=o?(D.ah(L,r[f].UH,d),p.oc(d.get(),S)):C++,L=j,A=!0,S=T=!1,f+1==r.length||2!=r[f+1].Ei||r[f+1].tg==z&&r[f+1].OA!=L){if(null!=o){var B=new i(p,2,y,z,j,m,O,_,R,k,F,H,b,w,x);o.push(B)}else null.add(C);O=y,_=z,R=j,b=k,w=F,x=H,m=2,A=T=!1,S=E=!0}}else{var G=s.U(z);if(f<r.length-1&&r[f+1].tg==G&&r[f+1].Al==F&&2==r[f+1].Ei)j!=L&&(E&&(null!=o?p=new t.Ta:C=0),T=0<f&&r[f-1].Ns==y?1==m?0:0==m?1:3:3,null!=o?(D.ah(L,j,d),p.oc(d.get(),S),B=new i(p,T,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):(C++,null.add(C)),L=j,O=y,_=z,R=j,b=k,w=F,x=H,m=T,T=M=!1,S=E=!0);else if(!e.CM(n,s,r,f,h,l)){e.zM(s,r,f,v,I,c,u);var V=!1;if(G=!1,B=!0,!(h.qb(c)||l.qb(c)||h.qb(u)||l.qb(u))){a[0].L(h),a[1].L(l),a[2].L(c),a[3].L(u),a.sort(t.h.nu);var U=a[0],$=a[1],W=a[2],q=a[3];U.qb(h)?$.qb(l)?n?(G=V=!0,B=!1):V=!1:q.qb(l)?n?B=G=V=!0:V=!1:(V=!0,B=$.qb(c)):$.qb(h)?W.qb(l)?n?(G=V=!0,B=!1):V=!1:U.qb(l)?n?B=G=V=!0:V=!1:(V=!0,B=W.qb(c)):W.qb(h)?q.qb(l)?n?(G=V=!0,B=!1):V=!1:$.qb(l)?n?B=G=V=!0:V=!1:(V=!0,B=q.qb(c)):U.qb(l)?n?(G=V=!0,B=!1):V=!1:W.qb(l)?n?B=G=V=!0:V=!1:(V=!0,B=U.qb(c))}V&&(V=I==z,(j!=L||V&&0==L)&&(E&&(null!=o?p=new t.Ta:C=0),null!=o?(D.ah(L,j,d),p.oc(d.get(),S)):C++),B?1!=m?((j!=L||V&&0==L)&&(null!=o?(B=new i(p,1,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C)),G?(f>=r.length-2||r[f+2].Ns!=y)&&(m=0):m=1):((j!=L||V&&0==L)&&(null!=o?(B=new i(p,3,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C)),m=1):0!=m?((j!=L||V&&0==L)&&(null!=o?(B=new i(p,0,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C)),G?(f>=r.length-2||r[f+2].Ns!=y)&&(m=1):m=0):((j!=L||V&&0==L)&&(null!=o?(B=new i(p,3,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C)),m=0),(j!=L||V&&0==L)&&(L=j,O=y,_=z,R=j,b=k,w=F,x=H,T=M=!1,S=E=!0))}}f++}1!=L&&(E&&(null!=o?p=new t.Ta:C=0),null!=o?(D.ah(L,1,d),p.oc(d.get(),S)):C++,S=E=!1,M=!0)}M&&(j=1,z=s.rj(v),z=s.Ma(z),F=k=-1,H=NaN,T?null!=o?(B=new i(p,4,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C):(T=1==m?0:0==m?1:3,null!=o?(B=new i(p,T,y,z,j,m,O,_,R,k,F,H,b,w,x),o.push(B)):null.add(C)))}},e.CM=function(i,n,r,s,o,a){var h=r[s].VH;if(1==h)return e.AM(i,n,r,s,o,a);if(0==h)return e.BM(i,n,r,s,o,a);throw t.i.Qa()},e.AM=function(e,i,n,r,s,o){var a=new t.yb,h=n[r].tg,l=n[r].Lm,c=n[r].Al,u=-1,d=-1,f=-1,p=-1;if(!e&&0<r){var g=n[r-1];u=g.tg,d=g.Lm,f=g.Al,p=g.Ei}var v=-1,m=-1,y=-1,_=-1;r<n.length-1&&(v=(g=n[r+1]).tg,m=g.Lm,y=g.Al,_=g.Ei);var b=i.U(h);return g=i.U(c),e?r==n.length-1||v!=h||m!=l||y!=g||2==_?(null==(e=i.bc(c))&&(i.ed(c,a),e=a),o.L(e.kg()),s.mt(o),o.normalize(),s.normalize(),!1):(null==(e=i.bc(c))&&(i.ed(c,a),e=a),s.L(e.kg()),null==(e=i.bc(g))&&(i.ed(g,a),e=a),o.L(e.kg()),s.Sq(),o.normalize(),s.normalize(),!1):0<r&&u==h&&d==l&&f==g&&2==p||r<n.length-1&&v==b&&m==l&&y==g&&2==_?(null==(e=i.bc(c))&&(i.ed(c,a),e=a),o.L(e.kg()),s.mt(o),o.normalize(),s.normalize(),!1):!(r<n.length-1&&v==h&&m==l&&y==g&&(null==(e=i.bc(c))&&(i.ed(c,a),e=a),s.L(e.kg()),null==(e=i.bc(g))&&(i.ed(g,a),e=a),o.L(e.kg()),s.Sq(),o.normalize(),s.normalize(),1))},e.BM=function(e,i,n,r,s,o){var a=new t.yb,h=n[r].tg,l=n[r].Lm,c=n[r].Al,u=-1,d=-1,f=-1,p=-1;if(!e&&r<n.length-1){var g=n[r+1];u=g.tg,d=g.Lm,f=g.Al,p=g.Ei}var v=-1,m=-1,y=-1;g=-1,0<r&&(v=(g=n[r-1]).tg,m=g.Lm,y=g.Al,g=g.Ei);var _=i.U(h),b=i.Ma(c);return e?0!=r&&v==h&&m==l&&y==b&&2!=g||(null==(e=i.bc(c))&&(i.ed(c,a),e=a),o.L(e.kg()),s.mt(o),o.normalize(),s.normalize(),!1):!(0<r&&v==h&&m==l&&y==b&&2==g||r<n.length-1&&u==_&&d==l&&f==b&&2==p)||(null==(e=i.bc(c))&&(i.ed(c,a),e=a),o.L(e.kg()),s.mt(o),o.normalize(),s.normalize(),!1)},e.zM=function(e,i,n,r,s,o,a){var h=new t.yb,l=e.bc(s);if(null==l&&(e.ed(s,h),l=h),i=(n=i[n]).tg,n=n.OA,s=e.U(i),1==n)o.L(l.kg()),-1!=s&&s!=e.rj(r)?(null==(l=e.bc(s))&&(e.ed(s,h),l=h),a.L(l.kg()),null==(l=e.bc(i))&&e.ed(i,h)):a.L(o),o.Sq(),a.normalize(),o.normalize();else{if(0!=n)throw t.i.Qa();a.L(l.kg()),o.mt(a),a.normalize(),o.normalize()}},e}()}(X||(X={})),function(t){var e;(e=t.bM||(t.bM={}))[e.Linear=0]="Linear",e[e.Angular=1]="Angular",e[e.Area=2]="Area";var i=function(){function e(t,e,i){this.od=e,this.ai=i,this.vA=t}return e.prototype.Nb=function(t){return t instanceof e&&this.ai===t.ai},e.aG=function(t){return 0!==t.od?null:-1===t.vA?new e(-1,2,t.ai*t.ai):e.Zg(a[t.vA])},e.Zg=function(t){return void 0===(t=o[t])?null:t},e.ZO=function(t,i,n){var r=null;if(null!=n)try{"EPSG"===n.values[0]&&(r=e.Zg(parseInt(n.values[1])))}catch(t){}return null===r&&(r=new e(-1,t,i)),r},e.prototype.Ec=function(){return this.vA},e.prototype.CF=function(e){if(e.od!=this.od)throw t.i.Hb();return this.ai/e.ai},e.Nh=function(t,e,i){return e.CF(i)*t},e.XE=function(t,e,i,n,r){for(i=i.CF(n),n=0;n<e;n++)r[n]=t[n]*i},e}();t.Tc=i;for(var n=[109401,1e4,109402,4046.8564224,109403,4046.87260987425,109404,1,109405,.09290304,109406,.09290341161327487,109407,.09290137299531805,109408,3.34450944,109409,3429904,109410,1.000027193184865,109411,404.6872609874253,109412,.04046872609874253,109413,2589998.4703195216,109414,1e6,109415,.8361123569578626,109416,404.67838076760535,109417,.04046783807676053,109418,.8361244606523066,109419,.09290271785025629,109420,404.68423895571647,109421,.04046842389557164,109422,.83612589696064,109423,.0929028774400711,109424,404.6849341289498,109425,.04046849341289498,109426,.836125904805842,109427,.09290287831176021,109428,404.68493792602754,109429,.04046849379260275,109430,.09290354800069446,109431,.09290274144751023,109432,.09290207073852812,109433,.09290279616016,109434,.09290273520025,109435,.836124673027592,109436,.836118636646753,109437,.8361251654414399,109438,.83612461680225,109439,2589988.110336,109440,.09290286332673177,109441,.09290349665192114,109442,.83612736,109443,.8361307045194736,109444,404.68564224000005,109445,.04046856422400001,109446,.8361237024040001,109447,.0929026336004445,109448,404.683871963536,109449,.0404683871963536,109450,.01,109451,1e-4,109452,1e-6,109453,64516e-8,109454,.0006451625806477421,109455,25.292852640000003,109456,25.29295381171408,109457,3434528.1495040003,109458,3434290.937856,109459,2.89612324,109460,25e8,109461,225e8,109462,.7168473118308245,109463,100,109464,1.244521604938272e-7,109465,1e-12,109466,1e-18],r=[1031,4.84813681109536e-9,9101,1,9102,.0174532925199433,9103,.0002908882086657216,9104,484813681109536e-20,9105,.01570796326794897,9106,.01570796326794897,9109,1e-6,9112,.0001570796326794897,9113,1570796326794897e-21,9114,.0009817477042468104],s=[1025,.001,109452,1033,.01,109451,9001,1,109404,9002,.3048,109405,9003,.3048006096012192,109406,9005,.3047972654,109407,9014,1.8288,109408,9030,1852,109409,9031,1.0000135965,109410,9033,20.11684023368047,109411,9034,.2011684023368047,109412,9035,1609.3472186944375,109413,9036,1e3,109414,9037,.9143917962000001,109415,9038,20.1166195164,109416,9039,.201166195164,109417,9040,.9143984146160287,109418,9041,.304799471538676,109419,9042,20.116765121552632,109420,9043,.2011676512155263,109421,9050,.9143992,109422,9051,.3047997333333333,109423,9052,20.1167824,109424,9053,.201167824,109425,9060,.9143992042898124,109426,9061,.3047997347632708,109427,9062,20.116782494375872,109428,9063,.2011678249437587,109429,9070,.3048008333333334,109430,9080,.3047995102481469,109431,9081,.30479841,109432,9082,.3047996,109433,9083,.3047995,109434,9084,.9143985307444408,109435,9085,.91439523,109436,9086,.9143988,109437,9087,.9143985,109438,9093,1609.344,109439,9094,.3047997101815088,109440,9095,.3048007491,109441,9096,.9144,109442,9097,20.1168,109444,9098,.201168,109445,9099,.914398,109446,9300,.3047993333333334,109447,9301,20.116756,109448,9302,.20116756,109449,109001,.9144,109442,109002,.9144018288036576,109443,109003,20.1168,109444,109004,.201168,109445,109005,.1,109450,109006,.01,109451,109007,.001,109452,109008,.0254,109453,109009,.0254000508001016,109454,109010,5.0292,109455,109011,5.029210058420118,109456,109012,1853.248,109457,109013,1853.184,109458,109014,1.7018,109459,109015,.8466683600033867,109462,109016,.0003527777777777778,109464,109017,1e-6,109465,109018,1e-9,109466,109030,5e4,109460,109031,15e4,109461],o=[],a=[],h=0;h<n.length;h+=2)o[n[h]]=new i(n[h],2,n[h+1]);for(n=null,h=0;h<r.length;h+=2)o[r[h]]=new i(r[h],1,r[h+1]);for(r=null,h=0;h<s.length;h+=3)o[s[h]]=new i(s[h],0,s[h+1]),a[s[h]]=s[h+2];s=null}(X||(X={})),function(t){var e=function(){function t(){this.xb=this.pb=0}return t.prototype.set=function(t,e){void 0!==e?(this.pb=t,this.xb=e):"number"==typeof t?(this.pb=t,this.xb=0):(this.pb=t.pb,this.xb=t.xb)},t.prototype.value=function(){return this.pb},t.prototype.add=function(t){var e=this.pb+t.pb;t=this.xb+t.xb+2220446049250313e-31*Math.abs(e),this.pb=e,this.xb=t},t.prototype.kN=function(){var t=this.pb+1,e=this.xb+2220446049250313e-31*Math.abs(t);this.pb=t,this.xb=e},t.prototype.dN=function(t,e){this.pb=t.pb+e.pb,this.xb=t.xb+e.xb+2220446049250313e-31*Math.abs(this.pb)},t.prototype.sub=function(t){if("number"==typeof t){var e=this.pb-t;t=this.xb+2220446049250313e-31*Math.abs(e)}else e=this.pb-t.pb,t=this.xb+t.xb+2220446049250313e-31*Math.abs(e);this.pb=e,this.xb=t},t.prototype.Ag=function(t){var e=this.pb*t.pb;this.xb=this.xb*Math.abs(t.pb)+t.xb*Math.abs(this.pb)+this.xb*t.xb+2220446049250313e-31*Math.abs(e),this.pb=e},t.prototype.No=function(t){var e=this.pb*t;this.xb=this.xb*Math.abs(t)+2220446049250313e-31*Math.abs(e),this.pb=e},t.prototype.Kl=function(t,e){var i=Math.abs(t.pb)*Math.abs(e.pb);this.xb=t.xb*Math.abs(e.pb)+e.xb*Math.abs(t.pb)+t.xb*e.xb+2220446049250313e-31*Math.abs(i),this.pb=i},t.prototype.jm=function(t){var e=Math.abs(t.pb),i=this.pb/t.pb,n=(this.xb+Math.abs(i)*t.xb)/e;t.xb>.01*e&&(n*=1+(1+(t=t.xb/e))*t),this.pb=i,this.xb=n+2220446049250313e-31*Math.abs(i)},t.prototype.sqrt=function(){if(0<=this.pb){var t=Math.sqrt(this.pb),e=this.pb>10*this.xb?.5*this.xb/t:this.pb>this.xb?t-Math.sqrt(this.pb-this.xb):Math.max(t,Math.sqrt(this.pb+this.xb)-t);e+=2220446049250313e-31*Math.abs(t)}else this.pb<-1*this.xb?e=t=NaN:(t=0,e=Math.sqrt(this.xb));this.pb=t,this.xb=e},t.prototype.sin=function(t){var e=Math.sin(t.pb),i=Math.cos(t.pb);this.pb=e,e=Math.abs(e),this.xb=(Math.abs(i)+.5*e*t.xb)*t.xb+2220446049250313e-31*e},t.prototype.cos=function(t){var e=Math.sin(t.pb),i=Math.cos(t.pb);this.pb=i,i=Math.abs(i),this.xb=(Math.abs(e)+.5*i*t.xb)*t.xb+2220446049250313e-31*i},t.prototype.qg=function(){return Math.abs(this.pb)<=this.xb},t.prototype.ps=function(){return this.qg()&&0!=this.xb},t}();t.Wb=e}(X||(X={}));var tt=new X.h,et=new X.h,it=new X.h,nt=new X.h,rt=new X.h;!function(t){var e,i;(i=e||(e={}))[i.closedPath=1]="closedPath",i[i.exteriorPath=2]="exteriorPath",i[i.ringAreaValid=4]="ringAreaValid";var n=function(){function e(t,e,i,n,r,s,o){void 0!==e?(this.ib=t,this.ck=e,this.bl=i,this.ii=n,this.ya=s,this.hA=o,this.ew=r):(this.ib=t.ib,this.ck=t.ck,this.bl=t.bl,this.ii=t.ii,this.ya=t.ya,this.hA=t.hA,this.ew=t.ew),this.bH=!0}return e.prototype.next=function(){return this.bH?(this.bH=!1,this.ii):-1!=this.ii?(this.ii=this.ib.U(this.ii),this.ya++,-1!=this.ii&&this.ii!=this.ew?this.ii:this.$T()):-1},e.prototype.$T=function(){for(this.bl=this.ib.Rb(this.bl),this.ya=0;-1!=this.ck;){for(;-1!=this.bl;this.bl=this.ib.Rb(this.bl))if(this.ew=this.ii=this.ib.Xa(this.bl),-1!=this.ii)return this.ii;if(this.ck=this.ib.ue(this.ck),-1==this.ck)break;this.hA&&!t.aa.Hc(this.ib.ic(this.ck))||(this.bl=this.ib.Ob(this.ck))}return-1},e.AP=function(t,i,n,r,s,o,a){return new e(t,i,n,r,s,o,a)},e}();t.zY=n,e=function(){function e(){this.jo=this.Am=this.wk=this.cd=this.Ck=this.vo=this.Oi=this.md=this.bi=this.Sg=this.We=this.Il=null,this.qw=this.ld=-1,this.fd=0,this.fA=!1,this.ht=this.it=this.vb=null}return e.prototype.Sh=function(t){return null!=this.We?this.We[t]:null},e.prototype.Xg=function(t,e){if(null==this.We){if(null==e)return;this.We=[];for(var i=0,n=this.vb.I();i<n;i++)this.We.push(null)}this.We[t]=e},e.prototype.bp=function(t,e){this.md.S(t,1,e)},e.prototype.ap=function(t,e){this.md.S(t,2,e)},e.prototype.VB=function(t,e){this.md.S(t,6,e)},e.prototype.Sp=function(t){return this.md.T(t,6)},e.prototype.gx=function(t,e){this.md.S(t,7,e)},e.prototype.qv=function(t){return this.md.T(t,0)},e.prototype.OJ=function(t,e){this.cd.S(t,1,e)},e.prototype.SJ=function(t,e){this.cd.S(t,0,e)},e.prototype.JF=function(t){return this.cd.T(t,7)},e.prototype.Zo=function(t,e){this.cd.S(t,3,e)},e.prototype.$o=function(t,e){this.cd.S(t,4,e)},e.prototype.uU=function(e){null==this.cd&&(this.cd=new t.$c(8));var i=this.cd.Ce();return this.cd.S(i,2,e),this.cd.S(i,5,0),this.cd.S(i,6,0),this.cd.S(i,7,i),i},e.prototype.OQ=function(t){this.cd.jd(t)},e.prototype.wU=function(e){null==this.md&&(this.md=new t.$c(8),this.td=new t.$c(5),this.Oi=new t.be(0),this.vo=new t.be(0));var i=this.md.Ce();return this.md.S(i,0,i),this.md.S(i,3,0),this.md.S(i,6,0),this.gx(i,e),i>=this.Oi.size&&(e=16>i?16:t.O.truncate(3*i/2),this.Oi.resize(e),this.vo.resize(e)),this.Oi.set(i,0),this.vo.set(i,0),i},e.prototype.sF=function(t){this.md.jd(t)},e.prototype.Vy=function(t){this.td.jd(t),this.fd--},e.prototype.oI=function(e){null==this.md&&(this.md=new t.$c(8),this.td=new t.$c(5),this.Oi=new t.be(0),this.vo=new t.be(0));var i=this.td.Ce(),n=0<=e?e:i;if(this.td.S(i,0,n),0>e){if(n>=this.vb.I()){if(e=16>n?16:t.O.truncate(3*n/2),this.vb.resize(e),null!=this.We)for(var r=0;r<e;r++)this.We.push(null);null!=this.Sg&&this.Sg.resize(e),this.it=this.vb.ub(0)}this.vb.Cb(n,-1e38,-1e38),null!=this.We&&(this.We[n]=null),null!=this.Sg&&this.Sg.write(n,1)}return this.td.S(i,4,2*n),this.fd++,i},e.prototype.wj=function(t,e,i){var n=-1!=e?this.Ma(e):this.rj(t),r=-1!=n?this.U(n):-1,s=this.oI(null==i?this.fd:-1),o=this.Ua(s);return null!=i&&this.vb.Ht(o,i),this.aj(s,t),this.Bc(s,r),this.Cc(s,n),-1!=r&&this.Cc(r,s),-1!=n&&this.Bc(n,s),i=this.dc(t),n=this.Xa(t),-1==e&&this.Wg(t,s),e==n&&this.Jf(t,s),i&&-1==r&&(this.Bc(s,s),this.Cc(s,s)),this.Vj(t,this.Ja(t)+1),t=this.Qf(t),this.Tj(t,this.I(t)+1),s},e.prototype.nm=function(){return null==this.jo&&(this.jo=new t.Sa(this.vb.description)),this.jo},e.prototype.Yo=function(t,e){this.cd.S(t,2,-134217729&this.cd.T(t,2)||(1==e?134217728:0))},e.prototype.In=function(t){return 134217728&this.cd.T(t,2)?1:0},e.prototype.hN=function(t){var e=this.Ig(t.getType(),t.description);return 1736==t.getType()&&this.Yo(e,t.In()),this.UD(e,t),e},e.prototype.iN=function(t){var e=this.Ig(t.getType(),t.description);return this.VD(e,t),e},e.prototype.XV=function(e,i){null==this.md&&(this.md=new t.$c(8),this.td=new t.$c(5),this.Oi=new t.be(0),this.vo=new t.be(0)),this.md.De(this.md.Hg+e),this.td.De(this.td.Hg+i),this.Oi.Jb(this.Oi.size+e),this.vo.Jb(this.vo.size+e)},e.prototype.UD=function(e,i){this.XV(i.da(),i.I()),this.Il.Fd(i,0,i.I()),this.it=this.vb.ub(0);for(var n=null!=this.We&&null!=i.Ve,r=0,s=i.da();r<s;r++)if(!(2>i.Ja(r))){var o=this.vf(e,-1);this.kn(o,i.dc(r));for(var a=i.Ba(r),h=i.Vc(r);a<h;a++){var l=this.wj(o,-1,null);if(n)if(l=this.Ua(l),1&i.ZF(a))this.Xg(l,null);else{var c=new t.ig;i.bc(a,c,!0),this.Xg(l,c.get())}}}},e.prototype.VD=function(t,e){this.Il.Fd(e,0,e.I()),this.it=this.vb.ub(0),t=this.vf(t,-1);var i=0;for(e=e.I();i<e;i++)this.wj(t,-1,null)},e.prototype.NX=function(e,i,n){var r=this.U(e);if(-1==r)throw t.i.Qa();for(var s=this.nm(),o=this.bd(e),a=0,h=i.ol(n);a<h;a++){var l=this.Ua(e),c=this.U(e),u=i.Vp(n,a);0==a&&(u.To(s),this.Dh(e,s)),322==u.getType()?this.Xg(l,null):this.Xg(l,t.aa.jg(u)),u.Po(s),a<h-1?e=this.wj(o,c,s):this.Dh(r,s)}},e.prototype.MX=function(e,i,n){var r=this.U(e);if(-1==r)throw t.i.Qa();for(var s=this.nm(),o=this.bd(e),a=0,h=i.ol(n);a<h;a++){var l=this.Ua(e),c=this.U(e),u=i.Vp(n,h-a-1);0==a&&(u.Po(s),this.Dh(e,s)),322==u.getType()?this.Xg(l,null):this.Xg(l,t.aa.jg(u)),u.To(s),a<h-1?e=this.wj(o,c,s):this.Dh(r,s)}},e.prototype.IF=function(){var e=new t.l;e.Oa();for(var i=this.Yq(),n=new t.h,r=!0,s=i.next();-1!=s;s=i.next())this.D(s,n),r?e.Zb(n.x,n.y):e.Lk(n.x,n.y),r=!1;return e},e.prototype.Ib=function(e){var i=e.getType();if(t.aa.Hc(i))return this.hN(e);if(550==i)return this.iN(e);throw t.i.Qa()},e.prototype.uN=function(e,i){var n=i.getType();if(t.aa.Hc(n))this.UD(e,i);else{if(550!=n)throw t.i.Qa();this.VD(e,i)}},e.prototype.mN=function(e,i){var n=this.Ig(1736,e.description);if(2>e.Ja(i))return n;this.Il.Fd(e,e.Ba(i),e.Vc(i)),this.it=this.vb.ub(0);var r=this.vf(n,-1);this.kn(r,e.dc(i)||!0);var s=null!=this.We&&null!=e.Ve,o=e.Ba(i);for(i=e.Vc(i);o<i;o++){var a=this.wj(r,-1,null);if(s)if(a=this.Ua(a),1&e.ZF(o))this.Xg(a,null);else{var h=new t.ig;e.bc(o,h,!0),this.Xg(a,h.get())}}return n},e.prototype.Ne=function(e){var i=this.ic(e),n=t.ZK.Ig(i,this.Il.description),r=this.I(e);if(0==r)return n;if(t.aa.Hc(i)){i=this.da(e);for(var s=t.Yc.Oh(i+1),o=t.Yc.Mr(i+1,0),a=n.description,h=0,l=a.Aa;h<l;h++){for(var c=a.kd(h),u=t.ra.Va(c),d=t.Yc.YE(c,r),f=this.vb.ub(c),p=0,g=0,v=0,m=this.Ob(e);-1!=m;m=this.Rb(m)){var y=0;this.dc(m)&&(y|=1),this.YS(m)&&(y|=4),0!=y&&o.zJ(g,y);var _=this.Ja(m);if(s.write(g++,v),v+=_,0==c){_=f;var b=d,w=new t.h;for(y=this.Xa(m);p<v;y=this.U(y),p++){var x=this.Ua(y);_.tc(2*x,w),b.Tt(2*p,w)}}else for(y=this.Xa(m);p<v;y=this.U(y),p++)for(x=this.Ua(y),b=0;b<u;b++)w=f.eg(x*u+b),d.pr(p*u+b,w)}n.hn(c,d),s.write(i,r)}n.PJ(o),n.QJ(s),n.Pc(16777215)}else if(550==i){for(a=n.description,n.resize(r),h=0,l=a.Aa;h<l;h++){for(c=a.kd(h),u=t.ra.Va(c),d=n.ub(c),f=this.vb.ub(c),p=0,m=this.Ob(e),_=this.Ja(m),y=this.Xa(m);p<_;y=this.U(y),p++)for(x=this.Ua(y),b=0;b<u;b++)w=f.eg(x*u+b),d.pr(p*u+b,w);n.hn(c,d)}n.Pc(16777215)}return n},e.prototype.BB=function(t){for(var e=this.Ob(t);-1!=e;e=this.Zq(e));e=this.PR(t);var i=this.ue(t);-1!=e?this.OJ(e,i):this.ld=i,-1!=i?this.SJ(i,e):this.qw=e,this.OQ(t)},e.prototype.Ig=function(e,i){return void 0===i?this.$E(e,t.ee.og()):this.$E(e,i)},e.prototype.$E=function(e,i){return e=this.uU(e),null==this.vb?this.vb=this.Il=new t.de(i):this.Il.Jl(i),this.ht=this.Il.description,this.fA=1<this.ht.Aa,-1==this.ld?this.ld=e:(this.SJ(e,this.qw),this.OJ(this.qw,e)),this.qw=e},e.prototype.ue=function(t){return this.cd.T(t,1)},e.prototype.PR=function(t){return this.cd.T(t,0)},e.prototype.ic=function(t){return 2147483647&this.cd.T(t,2)},e.prototype.HJ=function(e,i,n){i=this.wk[i],(e=this.JF(e))>=i.size&&i.resize(Math.max(t.O.truncate(1.25*e),16),-1),i.write(e,n)},e.prototype.KF=function(t,e){return(t=this.JF(t))<(e=this.wk[e]).size?e.read(t):-1},e.prototype.aF=function(){null==this.wk&&(this.wk=[]);for(var e=0;e<this.wk.length;e++)if(null==this.wk[e])return this.wk[e]=t.Yc.Oh(0),e;return this.wk.push(t.Yc.Oh(0)),this.wk.length-1},e.prototype.xW=function(t){this.wk[t]=null},e.prototype.Ob=function(t){return this.cd.T(t,3)},e.prototype.kv=function(t){return this.cd.T(t,4)},e.prototype.I=function(t){return this.cd.T(t,5)},e.prototype.da=function(t){return this.cd.T(t,6)},e.prototype.Gp=function(e,i,n){for(var r=0,s=this.ld;-1!=s;s=this.ue(s)){var o=this.ic(s);if(t.aa.Hc(o)&&(!n||1736==o)){o=1736==this.ic(s);for(var a=this.Ob(s);-1!=a;){for(var h=0,l=this.Xa(a);h<t.O.truncate(this.Ja(a)/2);){var c=this.U(l);if(-1==c)break;var u=this.Ua(l),d=this.Sh(u);null!=d?u=d.Qb():(d=this.Ua(c),u=this.vb.yr(u,d)),u<=e?(0==u?0==r&&(r=-1):r=1,c!=this.rj(a)&&(this.lC(c,l),this.pd(c,!0))):l=this.U(l),h++}for(h=this.Xa(a),l=this.dc(a)?h:this.rj(a);0<this.Ja(a);){if(-1==(c=this.Ma(l))){this.pd(l,!0),0==r&&(r=-1);break}var f=this.Ua(c);if(null!=(d=this.Sh(f))?u=d.Qb():(u=this.Ua(l),u=this.vb.yr(u,f)),u<=e)0==u?0==r&&(r=-1):r=1,this.lC(c,l),this.pd(c,!1),h==c&&(h=this.Xa(a));else if((l=this.Ma(l))==h)break}l=this.Ja(a),i&&(o?3>l:2>l)?(a=this.Zq(a),r=0<l?1:0==r?-1:r):a=this.Rb(a)}}}return r},e.prototype.lC=function(t,e){var i=this.Ua(t),n=this.Ua(e);if(null!=this.Sg&&(i=this.Sg.read(i),this.Sg.write(n,i)),null!=this.bi)for(n=0,i=this.bi.length;n<i;n++)if(null!=this.bi[n]){var r=this.Pa(t,n);-1!=r&&this.Ra(e,n,r)}},e.prototype.Ul=function(e,i,n){var r=0,s=this.U(e);if(-1==s)throw t.i.Qa();for(var o=this.Ua(e),a=this.Ua(s),h=this.Sh(o),l=null==h?this.vb.yr(o,a):h.Qb(),c=0;c<n;c++){var u=i[c];if(0<u&&1>u){var d=u;null!=h&&(d=0<l?h.Ux(u)/l:0),this.vb.kD(o,a,d,this.nm());var f=this.wj(this.bd(e),s,this.nm());if(r++,null!=h){var p=h.dl(0,u);d=this.Ua(this.Ma(f)),this.Xg(d,p),this.mf(f,p.wc()),c!=n-1&&1!=i[c+1]||(u=h.dl(u,1),this.Xg(d,u))}}}return r},e.prototype.LX=function(e,i,n){var r=0,s=this.U(e);if(-1==s)throw t.i.fa("internal error");var o=this.Ua(e),a=this.Ua(s),h=this.Sh(o),l=null==h?this.vb.yr(o,a):h.Qb(),c=0;e=this.bd(e);for(var u=0;u<n;u++){var d=i[u];if(c<d&&1>d){var f=d;if(null!=h&&(f=0<l?h.Ux(d)/l:0),this.vb.kD(o,a,f,this.nm()),f=this.yS(e,s,this.nm()),r++,null!=h){c=h.dl(c,d);var p=this.Ua(this.Ma(f));this.Xg(p,c),this.Cb(f,c.pa,c.la),u!=n-1&&1!=i[u+1]||(c=h.dl(d,1),f=this.Ua(f),this.Xg(f,c))}}c=d}return r},e.prototype.yS=function(t,e,i){var n=-1!=e?this.Ma(e):this.rj(t),r=-1!=n?this.U(n):-1,s=this.oI(null==i?this.fd:-1),o=this.Ua(s);return null!=i&&this.vb.Ht(o,i),this.aj(s,t),this.Bc(s,r),this.Cc(s,n),-1!=r&&this.Cc(r,s),-1!=n&&this.Bc(n,s),i=this.dc(t),n=this.Xa(t),-1==e&&this.Wg(t,s),e==n&&(i&&-1!=n||this.Jf(t,s)),i&&-1==r&&(this.Bc(s,s),this.Cc(s,s)),this.Vj(t,this.Ja(t)+1),t=this.Qf(t),this.Tj(t,this.I(t)+1),s},e.prototype.uE=function(e,i,n){var r=this.Ua(i),s=this.Ua(n);if(0>r||s>this.fd-1)throw t.i.N("invalid call");if(r>s&&!this.dc(e))throw t.i.N("cannot iterate across an open path");for(e=0;i!=n;i=this.U(i))r=this.Ua(i),null!=(s=this.Sh(r))?e+=s.Qb():(s=this.Ua(this.U(i)),e+=this.vb.yr(r,s));return e},e.prototype.Dh=function(t,e){var i=this.Ua(t);this.vb.Ht(i,e),null!=(i=this.Sh(i))&&i.setStart(e),-1!=(t=this.Ma(t))&&(t=this.Ua(t),null!=this.Sh(t)&&i.setEnd(e))},e.prototype.Vi=function(t,e){t=this.Ua(t),this.vb.ve(t,e)},e.prototype.mf=function(t,e){this.Cb(t,e.x,e.y)},e.prototype.Cb=function(t,e,i){var n=this.Ua(t);this.vb.Cb(n,e,i),null!=(n=this.Sh(n))&&n.ZB(e,i),-1!=(t=this.Ma(t))&&(t=this.Ua(t),null!=this.Sh(t)&&n.Ql(e,i))},e.prototype.D=function(t,e){this.vb.D(this.td.T(t,0),e)},e.prototype.Gc=function(t,e){this.vb.za[0].tc(2*this.td.T(t,0),e)},e.prototype.Na=function(e){var i=new t.h;return this.vb.D(this.td.T(e,0),i),i},e.prototype.dG=function(t,e){this.it.tc(2*t,e)},e.prototype.Uc=function(t,e,i){return this.vb.Uc(t,this.Ua(e),i)},e.prototype.setAttribute=function(t,e,i,n){this.vb.setAttribute(t,this.Ua(e),i,n)},e.prototype.Ua=function(t){return this.td.T(t,0)},e.prototype.ih=function(){var e=new t.h;return this.D(void 0,e),e.y},e.prototype.fq=function(t,e){t=this.Ua(t),e=this.Ua(e);var i=this.vb.za[0].o;return i[2*t]===i[2*e]&&i[2*t+1]===i[2*e+1]},e.prototype.Dv=function(t,e){t=this.Ua(t);var i=this.vb.za[0].o;return i[2*t]===e.x&&i[2*t+1]===e.y},e.prototype.vX=function(e,i){if(1>i&&(i=1),null==this.Sg){if(1==i)return;this.Sg=t.Yc.Dn(this.vb.I(),1)}(e=this.Ua(e))>=this.Sg.size&&this.Sg.resize(e+1,1),this.Sg.write(e,i)},e.prototype.cG=function(t){return t=this.Ua(t),null==this.Sg||t>=this.Sg.size?1:this.Sg.read(t)},e.prototype.Ra=function(t,e,i){e=this.bi[e],t=this.Ua(t),e.size<this.vb.I()&&e.resize(this.vb.I(),-1),e.write(t,i)},e.prototype.Pa=function(t,e){return(t=this.Ua(t))<(e=this.bi[e]).size?e.read(t):-1},e.prototype.Gd=function(){null==this.bi&&(this.bi=[]);for(var e=0;e<this.bi.length;e++)if(null==this.bi[e])return this.bi[e]=t.Yc.Oh(0,-1),e;return this.bi.push(t.Yc.Oh(0,-1)),this.bi.length-1},e.prototype.Td=function(t){this.bi[t]=null},e.prototype.bc=function(t){return null!=this.We?(t=this.Ua(t),this.We[t]):null},e.prototype.ed=function(e,i){var n=this.td.T(e,2);if(-1==n)return!1;if(this.fA){var r=new t.Sa;this.Vi(e,r),i.setStart(r),this.Vi(n,r),i.setEnd(r)}else this.vb.Gc(this.td.T(e,0),tt),i.em(0,tt),this.vb.Gc(this.td.T(n,0),tt),i.em(1,tt);return!0},e.prototype.mW=function(e,i,n){if(this.fA){var r=new t.Sa;this.Vi(e,r),n.setStart(r),this.Vi(i,r),n.setEnd(r)}else this.vb.Gc(e,tt),n.em(0,tt),this.vb.Gc(i,tt),n.em(1,tt)},e.prototype.vf=function(e,i){if(-1!=i){if(e!=this.Qf(i))throw t.i.Qa();var n=this.cs(i)}else n=this.kv(e);var r=this.wU(e);return-1!=i&&this.bp(i,r),this.ap(r,i),this.bp(r,n),-1!=n?this.ap(n,r):this.Zo(e,r),-1==i&&this.$o(e,r),this.Rl(e,this.da(e)+1),r},e.prototype.nG=function(t,e,i,n){t=this.vf(t,-1);for(var r=0,s=e,o=!1;s==i&&(o=!0),this.aj(s,t),r++,(s=this.U(s))!=e;);return this.kn(t,!0),this.Vj(t,r),o&&(e=i),this.Jf(t,e),this.Wg(t,this.Ma(e)),this.cp(t,!1),null!=n&&(n[0]=o),t},e.prototype.Zq=function(t){var e=this.cs(t),i=this.Rb(t),n=this.Qf(t);return-1!=e?this.ap(e,i):this.Zo(n,i),-1!=i?this.bp(i,e):this.$o(n,e),this.AO(t),this.Rl(n,this.da(n)-1),this.sF(t),i},e.prototype.AO=function(t){var e=this.Xa(t);if(-1!=e){for(var i=0,n=this.Ja(t);i<n;i++){var r=e;e=this.U(e),this.Vy(r)}e=this.Qf(t),this.Tj(e,this.I(e)-this.Ja(t))}this.Vj(t,0)},e.prototype.Rb=function(t){return this.md.T(t,2)},e.prototype.cs=function(t){return this.md.T(t,1)},e.prototype.Ja=function(t){return this.md.T(t,3)},e.prototype.dc=function(t){return!!(1&this.Sp(t))},e.prototype.kn=function(t,e){if(this.dc(t)!=e){if(0<this.Ja(t)){var i=this.Xa(t),n=this.rj(t);e?(this.Bc(n,i),this.Cc(i,n),i=this.Ua(n)):(this.Bc(n,-1),this.Cc(i,-1),i=this.Ua(n)),this.Xg(i,null)}this.VB(t,(1|this.Sp(t))-1|(e?1:0))}},e.prototype.Qf=function(t){return this.md.T(t,7)},e.prototype.YS=function(t){return!!(2&this.Sp(t))},e.prototype.PB=function(t,e){this.VB(t,(2|this.Sp(t))-2|(e?2:0))},e.prototype.wz=function(e){if(this.cT(e))return this.Oi.get(this.qv(e));var i=new t.yb,n=this.Xa(e);if(-1==n)return 0;var r=new t.h;this.D(n,r);for(var s=0,o=0,a=this.Ja(e);o<a;o++,n=this.U(n)){var h=this.bc(n);if(null==h){if(!this.ed(n,i))continue;h=i}s+=h.Tx(r.x,r.y)}return this.cp(e,!0),this.Oi.set(this.qv(e),s),s},e.prototype.gr=function(t,e,i){e=this.Ck[e],t=this.qv(t),e.size<this.Oi.size&&e.resize(this.Oi.size,-1),e.write(t,i)},e.prototype.sj=function(t,e){return(t=this.qv(t))<(e=this.Ck[e]).size?e.read(t):-1},e.prototype.Ky=function(){null==this.Ck&&(this.Ck=[]);for(var e=0;e<this.Ck.length;e++)if(null==this.Ck[e])return this.Ck[e]=t.Yc.Oh(0),e;return this.Ck.push(t.Yc.Oh(0)),this.Ck.length-1},e.prototype.CB=function(t){this.Ck[t]=null},e.prototype.ZT=function(e,i,n){if(-1==n)throw t.i.N();if(i!=n){var r=this.Rb(n),s=this.cs(n),o=this.Qf(n);-1==s?this.Zo(o,r):this.ap(s,r),-1==r?this.$o(o,s):this.bp(r,s),this.Tj(o,this.I(o)-this.Ja(n)),this.Rl(o,this.da(o)-1),s=-1==i?this.kv(e):this.cs(i),this.bp(n,s),this.ap(n,i),-1==i?this.$o(e,n):this.bp(i,n),-1==s?this.Zo(e,n):this.ap(s,n),this.Tj(e,this.I(e)+this.Ja(n)),this.Rl(e,this.da(e)+1),this.gx(n,e)}},e.prototype.ij=function(t,e){this.vb.ve(this.Ua(e),this.nm()),this.wj(t,-1,this.nm())},e.prototype.pd=function(e,i){var n=this.bd(e),r=this.Ma(e),s=this.U(e);-1!=r&&this.Bc(r,s);var o=this.Ja(n);if(e==this.Xa(n)&&this.Jf(n,1<o?s:-1),-1!=s&&this.Cc(s,r),e==this.rj(n)&&this.Wg(n,1<o?r:-1),-1!=r&&-1!=s){r=this.Ua(r);var a=this.Ua(s);i?null!=(i=this.Sh(r))&&(r=new t.h,this.vb.D(a,r),i.Qc(r)):(a=this.Ua(e),i=this.Sh(a),this.Xg(r,i),null!=i&&(r=this.vb.Na(r),i.Dc(r)))}return this.Vj(n,o-1),n=this.Qf(n),this.Tj(n,this.I(n)-1),this.Vy(e),s},e.prototype.Xa=function(t){return this.md.T(t,4)},e.prototype.rj=function(t){return this.md.T(t,5)},e.prototype.U=function(t){return this.td.T(t,2)},e.prototype.Ma=function(t){return this.td.T(t,1)},e.prototype.bd=function(t){return this.td.T(t,3)},e.prototype.fc=function(t,e){return this.wj(t,-1,e)},e.prototype.Yq=function(e){if(void 0===e)return this.Yq(!1);if(e instanceof n)return new n(e);var i,r=-1,s=-1,o=-1,a=0,h=!1;for(i=this.ld;-1!=i;i=this.ue(i))if(!e||t.aa.Hc(this.ic(i))){for(r=this.Ob(i);-1!=r;r=this.Rb(r))if(o=s=this.Xa(r),a=0,-1!=s){h=!0;break}if(h)break}return n.AP(this,i,r,s,o,a,e)},e.prototype.Oc=function(t){if(this.Il.Oc(t),null!=this.We)for(var e=0,i=this.We.length;e<i;e++)null!=this.We[e]&&this.We[e].Oc(t)},e.prototype.jr=function(t,e,i,n){n?this.NX(t,e,i):this.MX(t,e,i)},e.prototype.Cc=function(t,e){this.td.S(t,1,e)},e.prototype.Bc=function(t,e){this.td.S(t,2,e)},e.prototype.aj=function(t,e){this.td.S(t,3,e)},e.prototype.Vj=function(t,e){this.md.S(t,3,e)},e.prototype.Jf=function(t,e){this.md.S(t,4,e)},e.prototype.Wg=function(t,e){this.md.S(t,5,e)},e.prototype.Rl=function(t,e){this.cd.S(t,6,e)},e.prototype.Tj=function(t,e){this.cd.S(t,5,e)},e.prototype.pJ=function(t){var e=t;do{var i=this.U(e);this.Bc(e,this.Ma(e)),this.Cc(e,i),e=i}while(e!=t)},e.prototype.bC=function(t){this.fd=t},e.prototype.$q=function(t){var e=this.cs(t),i=this.Rb(t),n=this.Qf(t);-1!=e?this.ap(e,i):this.Zo(n,i),-1!=i?this.bp(i,e):this.$o(n,e),this.Jf(t,-1),this.Wg(t,-1),this.sF(t)},e.prototype.mi=function(e,i){var n=this.Ma(e),r=this.U(e);if(-1!=n&&this.Bc(n,r),-1!=r&&this.Cc(r,n),-1!=n&&-1!=r)if(n=this.Ua(n),r=this.Ua(r),i){if(null!=(i=this.Sh(n))){var s=new t.h;this.vb.D(r,s),i.Qc(s)}}else i=this.Ua(e),i=this.Sh(i),this.Xg(n,i),null!=i&&(s=new t.h,this.vb.D(n,s),i.Dc(s));this.Vy(e)},e.prototype.cT=function(t){return!!(4&this.Sp(t))},e.prototype.cp=function(t,e){this.VB(t,(4|this.Sp(t))-4|(e?4:0))},e.prototype.nx=function(t,e){var i=this.td.o;this.vb.mc();var n=this.vb.za[0].o;t.Vd(0,e,(function(t,e){var r=i[5*t];t=i[5*e],e=n[2*r],r=n[2*r+1];var s=n[2*t];return r<(t=n[2*t+1])?-1:r>t?1:e<s?-1:e>s?1:0}))},e.prototype.jS=function(){for(var e=this.ld;-1!=e;e=this.ue(e))if(!t.aa.Hc(this.ic(e)))return!0;return!1},e.prototype.hC=function(t,e){for(var i=this.Ob(t),n=this.Ob(e),r=this.kv(t),s=this.kv(e),o=this.Ob(t);-1!=o;o=this.Rb(o))this.gx(o,e);for(o=this.Ob(e);-1!=o;o=this.Rb(o))this.gx(o,t);this.Zo(t,n),this.Zo(e,i),this.$o(t,s),this.$o(e,r),i=this.I(t),n=this.da(t),r=this.da(e),this.Tj(t,this.I(e)),this.Tj(e,i),this.Rl(t,r),this.Rl(e,n),i=this.cd.T(t,2),this.cd.S(t,2,this.cd.T(e,2)),this.cd.S(e,2,i)},e}(),t.gd=e}(X||(X={})),function(t){var e=function(e){function i(i,n,r,s){var o=e.call(this)||this;return o.$=new t.l,void 0===i?o.UE():"number"==typeof i?o.VO(i,n,r,s):i instanceof t.Sa?void 0!==n?o.Qu(i,n,r):o.WO(i):i instanceof t.ra?void 0!==n?o.YO(i,n):o.XO(i):i instanceof t.l?o.UO(i):o.UE(),o}return Q(i,e),i.prototype.Qu=function(e,i,n){this.description=t.ee.og(),this.$.Oa(),e.B()||this.tu(e,i,n)},i.prototype.UO=function(e){this.description=t.ee.og(),this.$.K(e),this.$.normalize()},i.prototype.XO=function(e){if(null==e)throw t.i.N();this.description=e,this.$.Oa()},i.prototype.YO=function(e,i){if(null==e)throw t.i.N();this.description=e,this.$.K(i),this.$.normalize()},i.prototype.UE=function(){this.description=t.ee.og(),this.$.Oa()},i.prototype.WO=function(e){this.description=t.ee.og(),this.$.Oa(),e.B()||this.tu(e)},i.prototype.VO=function(e,i,n,r){this.description=t.ee.og(),this.K(e,i,n,r)},i.prototype.K=function(t,e,i,n){if(this.vc(),"number"==typeof t)this.$.K(t,e,i,n);else for(this.Oa(),e=0,i=t.length;e<i;e++)this.Zb(t[e])},i.prototype.Xo=function(e){if(this.vc(),!e.fT())throw t.i.N();this.$.K(e)},i.prototype.Oa=function(){this.vc(),this.$.Oa()},i.prototype.B=function(){return this.$.B()},i.prototype.R=function(){return this.$.R()},i.prototype.ca=function(){return this.$.ca()},i.prototype.gk=function(){return this.$.gk()},i.prototype.Jp=function(){return this.$.Jp()},i.prototype.Ip=function(){return this.$.sf()},i.prototype.Zb=function(e){if(e instanceof t.h)this.vc(),this.$.Zb(e);else if(e instanceof t.l)this.vc(),this.$.Zb(e);else if(e instanceof t.Sa){if(this.vc(),!e.Ac()){var n=e.description;if(this.description!=n&&this.Jl(n),this.B())this.tu(e);else{this.$.Zb(e.D());for(var r=1,s=n.Aa;r<s;r++)for(var o=n.Ed(r),a=t.ra.Va(o),h=0;h<a;h++){var l=e.Uc(o,h),c=this.Tg(o,h);c.Zb(l),this.setInterval(o,h,c)}}}}else if(e instanceof i&&!e.B())for((n=e.description)!=this.description&&this.Jl(n),this.$.Zb(e.$),r=1,s=n.Aa;r<s;r++)for(o=n.kd(r),a=t.ra.Va(o),h=0;h<a;h++)l=e.Tg(o,h),(c=this.Tg(o,h)).Zb(l),this.setInterval(o,h,c)},i.prototype.tu=function(e,i,n){if(void 0!==i){this.$.K(e.D(),i,n),n=1;for(var r=(i=e.description).Aa;n<r;n++)for(var s=i.Ed(n),o=t.ra.Va(s),a=0;a<o;a++){var h=e.Uc(s,a);this.setInterval(s,a,h,h)}}else for(this.$.K(e.ka[0],e.ka[1]),n=1,r=(i=e.description).Aa;n<r;n++)for(s=i.Ed(n),o=t.ra.Va(s),a=0;a<o;a++)h=e.Uc(s,a),this.setInterval(s,a,h,h)},i.prototype.setInterval=function(e,i,n,r){if(n="number"==typeof n?new t.Nc(n,r):n,this.vc(),0==e)if(0==i)this.$.v=n.oa,this.$.C=n.va;else{if(1!=i)throw t.i.ce();this.$.G=n.oa,this.$.H=n.va}else this.vD(0,e,i,n.oa),this.vD(1,e,i,n.va)},i.prototype.W=function(t,e){this.vc(),this.$.W(t,e)},i.prototype.Oc=function(e){if(e instanceof t.Dd)this.vc(),e.mC(this.$);else if(this.vc(),!this.$.B()){var i=new t.OK;this.Qo(i),i.XS()?i.Oa():e.mC(i)}},i.prototype.copyTo=function(e){if(e.getType()!=this.getType())throw t.i.N();if(e.vc(),e.description=this.description,e.$.K(this.$),e.ka=null,null!=this.ka){e.ou();for(var i=0;i<2*(this.description.Ae.length-2);i++)e.ka[i]=this.ka[i]}},i.prototype.Ia=function(){return new i(this.description)},i.prototype.Ke=function(){return this.$.wF()},i.prototype.Qb=function(){return this.$.yR()},i.prototype.getType=function(){return 197},i.prototype.Db=function(){return 2},i.prototype.bn=function(t){this.copyTo(t)},i.prototype.A=function(t){t.v=this.$.v,t.G=this.$.G,t.C=this.$.C,t.H=this.$.H},i.prototype.Qo=function(t){t.v=this.$.v,t.G=this.$.G,t.C=this.$.C,t.H=this.$.H,t.K(this.$.v,this.$.G,this.Od(0,1,0),this.$.C,this.$.H,this.Od(1,1,0))},i.prototype.Tg=function(e,i){var n=new t.Nc;return n.K(this.Od(0,e,i),this.Od(1,e,i)),n},i.prototype.Hf=function(e,i){i.Nf(this.description);var n=this.description.Aa-1;switch(e){case 0:for(e=0;e<n;e++)for(var r=this.description.kd(e),s=t.ra.Va(r),o=0;o<s;o++)i.setAttribute(r,o,this.Od(0,r,o));i.Cb(this.$.v,this.$.G);break;case 1:for(e=0;e<n;e++)for(r=this.description.kd(e),s=t.ra.Va(r),o=0;o<s;o++)i.setAttribute(r,o,this.Od(1,r,o));i.Cb(this.$.v,this.$.H);break;case 2:for(e=0;e<n;e++)for(r=this.description.kd(e),s=t.ra.Va(r),o=0;o<s;o++)i.setAttribute(r,o,this.Od(0,r,o));i.Cb(this.$.C,this.$.H);break;case 3:for(e=0;e<n;e++)for(r=this.description.kd(e),s=t.ra.Va(r),o=0;o<s;o++)i.setAttribute(r,o,this.Od(1,r,o));i.Cb(this.$.C,this.$.G);break;default:throw t.i.ce()}},i.prototype.mB=function(t,e){t=this.$.mB(t),e.ma(t.x,t.y)},i.prototype.kR=function(t,e){return e*(t.Oq-2)},i.prototype.xF=function(e,i,n){if(this.$.B())throw t.i.fa("empty geometry");if(0==i)return 0!=e?0!=n?this.$.H:this.$.C:0!=n?this.$.G:this.$.v;if(n>=t.ra.Va(i))throw t.i.N();var r=this.description.Pf(i);return this.ou(),0<=r?this.ka[this.kR(this.description,e)+this.description.LR(r)-2+n]:t.ra.se(i)},i.prototype.ou=function(){if(this.vc(),null==this.ka&&2<this.description.Ae.length){this.ka=[];for(var e=i.Gg(this.description,0),n=i.Gg(this.description,1),r=0,s=1,o=this.description.Aa;s<o;s++){var a=this.description.kd(s),h=t.ra.Va(a);a=t.ra.se(a);for(var l=0;l<h;l++)this.ka[e+r]=a,this.ka[n+r]=a,r++}}},i.prototype.sn=function(e){if(null!=this.ka)if(2<e.Ae.length){for(var n=t.ee.Iw(e,this.description),r=[],s=i.Gg(this.description,0),o=i.Gg(this.description,1),a=i.Gg(e,0),h=i.Gg(e,1),l=0,c=1,u=e.Aa;c<u;c++){var d=e.kd(c),f=t.ra.Va(d);if(-1==n[c]){var p=t.ra.se(d);for(d=0;d<f;d++)r[a+l]=p,r[h+l]=p,l++}else for(p=this.description.$j(n[c])-2,d=0;d<f;d++)r[a+l]=this.ka[s+p],r[h+l]=this.ka[o+p],l++,p++}this.ka=r}else this.ka=null;this.description=e},i.prototype.Od=function(e,n,r){if(this.$.B())throw t.i.fa("This operation was performed on an Empty Geometry.");if(0==n)return 0!=e?0!=r?this.$.H:this.$.C:0!=r?this.$.G:this.$.v;if(r>=t.ra.Va(n))throw t.i.ce();var s=this.description.Pf(n);return 0<=s?(this.ou(),this.ka[i.Gg(this.description,e)+this.description.$j(s)-2+r]):t.ra.se(n)},i.prototype.vD=function(e,n,r,s){if(this.vc(),0==n)0!=e?0!=r?this.$.H=s:this.$.C=s:0!=r?this.$.G=s:this.$.v=s;else{if(r>=t.ra.Va(n))throw t.i.ce();if(!this.hasAttribute(n)){if(t.ra.DG(n,s))return;this.re(n)}n=this.description.Pf(n),this.ou(),this.ka[i.Gg(this.description,e)+this.description.$j(n)-2+r]=s}},i.Gg=function(t,e){return e*(t.Ae.length-2)},i.prototype.Ea=function(e){this.vc();var i=new t.l;return e.A(i),this.$.Ea(i)},i.prototype.isIntersecting=function(e){return e instanceof t.l?this.$.isIntersecting(e):this.$.isIntersecting(e.$)},i.prototype.Ju=function(t,e){this.vc(),t.B()?this.Oa():void 0!==e?this.tu(t,e):this.$.Ju(t.Lg(),t.ih())},i.prototype.offset=function(t,e){this.vc(),this.$.offset(t,e)},i.prototype.normalize=function(){this.vc(),this.$.normalize()},i.prototype.sf=function(e){if(void 0===e){if(e=new t.Sa(this.description),this.B())return e;for(i=this.description.Aa,n=1;n<i;n++)for(r=this.description.Ed(n),s=t.ra.Va(r),o=0;o<s;o++)a=.5*(this.Od(0,r,o)+this.Od(1,r,o)),e.setAttribute(r,o,a);return e.Cb(this.$.gk(),this.$.Jp()),e}if(e.Nf(this.description),this.B())e.Oa();else{for(var i=this.description.Aa,n=1;n<i;n++)for(var r=this.description.kd(n),s=t.ra.Va(r),o=0;o<s;o++){var a=.5*(this.xF(0,r,o)+this.xF(1,r,o));e.setAttribute(r,o,a)}e.Cb(this.$.sf())}},i.prototype.mz=function(){return new t.Sa(this.$.mz())},i.prototype.contains=function(e){return e instanceof t.Sa?!e.B()&&this.$.contains(e.Lg(),e.ih()):this.$.contains(e.$)},i.prototype.dP=function(t){return this.$.contains(t)},i.prototype.Nb=function(t){if(t==this)return!0;if(!(t instanceof i)||this.description!=t.description)return!1;if(this.B())return!!t.B();if(!this.$.Nb(t.$))return!1;for(var e=0,n=2*(this.description.Ae.length-2);e<n;e++)if(this.ka[e]!=t.ka[e])return!1;return!0},i.prototype.cc=function(){var e=this.description.cc();if(e=t.O.Th(e,this.$.cc()),!this.B()&&null!=this.ka)for(var i=0,n=2*(this.description.Ae.length-2);i<n;i++)e=t.O.Th(e,this.ka[i]);return e},i.prototype.es=function(){return this.$.v},i.prototype.gs=function(){return this.$.G},i.prototype.ds=function(){return this.$.C},i.prototype.fs=function(){return this.$.H},i.prototype.mg=function(){return t.pi.gm(this,null)},i.prototype.toString=function(){return this.B()?"Envelope: []":"Envelope: ["+this.$.v+", "+this.$.G+", "+this.$.C+", "+this.$.H+"]"},i}(t.aa);t.Fh=e}(X||(X={})),function(t){var e=function(){function e(t,e,i,n){void 0===t?this.Oa():(this.v=t,this.G=e,this.C=i,this.H=n)}return e.construct=function(t,i,n,r){var s=new e;return s.v=t,s.G=i,s.C=n,s.H=r,s},e.prototype.K=function(i,n,r,s){"number"==typeof i?void 0!==r?(this.v=i,this.G=n,this.C=r,this.H=s,this.normalize()):(this.v=i,this.G=n,this.C=i,this.H=n):i instanceof t.h?void 0!==n?(this.v=i.x-.5*n,this.C=this.v+n,this.G=i.y-.5*r,this.H=this.G+r,this.normalize()):(this.v=i.x,this.G=i.y,this.C=i.x,this.H=i.y):i instanceof e?this.K(i.v,i.G,i.C,i.H):i instanceof t.Nc&&(i.B()||n.B()?this.Oa():(this.v=i.oa,this.C=i.va,this.G=n.oa,this.H=n.va))},e.prototype.Zw=function(t,e){if(void 0!==e)if(0==e)this.Oa();else{this.v=t[0].x,this.G=t[0].y,this.C=this.v,this.H=this.G;for(var i=1;i<e;i++){var n=t[i];n.x<this.v?this.v=n.x:n.x>this.C&&(this.C=n.x),n.y<this.G?this.G=n.y:n.y>this.H&&(this.H=n.y)}}else if(null==t||0==t.length)this.Oa();else for(n=t[0],this.K(n.x,n.y),i=1;i<t.length;i++)e=t[i],this.Lk(e.x,e.y)},e.prototype.Oa=function(){this.H=this.C=this.G=this.v=NaN},e.prototype.B=function(){return isNaN(this.v)},e.prototype.Zb=function(i,n){"number"==typeof i?this.B()?(this.v=i,this.G=n,this.C=i,this.H=n):(this.v>i?this.v=i:this.C<i&&(this.C=i),this.G>n?this.G=n:this.H<n&&(this.H=n)):i instanceof t.h||i instanceof t.Nd?this.Zb(i.x,i.y):i instanceof e&&!i.B()&&(this.Zb(i.v,i.G),this.Zb(i.C,i.H))},e.prototype.Lk=function(t,e){this.v>t?this.v=t:this.C<t&&(this.C=t),this.G>e?this.G=e:this.H<e&&(this.H=e)},e.prototype.W=function(t,e){this.B()||(this.v-=t,this.C+=t,this.G-=e,this.H+=e,(this.v>this.C||this.G>this.H)&&this.Oa())},e.prototype.scale=function(t){0>t&&this.Oa(),this.B()||(this.v*=t,this.C*=t,this.G*=t,this.H*=t)},e.prototype.zoom=function(t,e){this.B()||this.K(this.sf(),t*this.R(),e*this.ca())},e.prototype.isIntersecting=function(t){return!this.B()&&!t.B()&&(this.v<=t.v?this.C>=t.v:t.C>=this.v)&&(this.G<=t.G?this.H>=t.G:t.H>=this.G)},e.prototype.HG=function(t){return(this.v<=t.v?this.C>=t.v:t.C>=this.v)&&(this.G<=t.G?this.H>=t.G:t.H>=this.G)},e.prototype.Ea=function(t){return!this.B()&&!t.B()&&(t.v>this.v&&(this.v=t.v),t.C<this.C&&(this.C=t.C),t.G>this.G&&(this.G=t.G),t.H<this.H&&(this.H=t.H),(t=this.v<=this.C&&this.G<=this.H)||this.Oa(),t)},e.prototype.mB=function(e){switch(e){case 0:return t.h.construct(this.v,this.G);case 1:return t.h.construct(this.v,this.H);case 2:return t.h.construct(this.C,this.H);case 3:return t.h.construct(this.C,this.G);default:throw t.i.ce()}},e.prototype.nB=function(e){if(null==e||4>e.length)throw t.i.N();null!=e[0]?e[0].ma(this.v,this.G):e[0]=t.h.construct(this.v,this.G),null!=e[1]?e[1].ma(this.v,this.H):e[1]=t.h.construct(this.v,this.H),null!=e[2]?e[2].ma(this.C,this.H):e[2]=t.h.construct(this.C,this.H),null!=e[3]?e[3].ma(this.C,this.G):e[3]=t.h.construct(this.C,this.G)},e.prototype.wF=function(){return this.B()?0:this.R()*this.ca()},e.prototype.yR=function(){return this.B()?0:2*(this.R()+this.ca())},e.prototype.gk=function(){return(this.C+this.v)/2},e.prototype.Jp=function(){return(this.H+this.G)/2},e.prototype.R=function(){return this.C-this.v},e.prototype.ca=function(){return this.H-this.G},e.prototype.move=function(t,e){this.B()||(this.v+=t,this.G+=e,this.C+=t,this.H+=e)},e.prototype.Ju=function(e,i){if(void 0!==i)this.move(e-this.gk(),i-this.Jp());else if(e instanceof t.h)this.Ju(e.x,e.y);else{if(!(e instanceof t.Sa))throw t.i.N();i=(this.C-this.v)/2;var n=(this.H-this.G)/2;this.v=e.Lg()-i,this.C=e.Lg()+i,this.G=e.ih()-n,this.H=e.ih()+n}},e.prototype.offset=function(t,e){this.v+=t,this.C+=t,this.G+=e,this.H+=e},e.prototype.normalize=function(){if(!this.B()){var t=Math.min(this.v,this.C),e=Math.max(this.v,this.C);this.v=t,this.C=e,t=Math.min(this.G,this.H),e=Math.max(this.G,this.H),this.G=t,this.H=e}},e.prototype.dn=function(t){t.ma(this.v,this.G)},e.prototype.$I=function(t){t.ma(this.C,this.G)},e.prototype.cJ=function(t){t.ma(this.v,this.H)},e.prototype.en=function(t){t.ma(this.C,this.H)},e.prototype.fT=function(){return this.B()||this.v<=this.C&&this.G<=this.H},e.prototype.sf=function(){return t.h.construct((this.C+this.v)/2,(this.H+this.G)/2)},e.prototype.mz=function(){return t.h.construct(this.v,this.G)},e.prototype.contains=function(i,n){if(void 0!==n)return i>=this.v&&i<=this.C&&n>=this.G&&n<=this.H;if(i instanceof t.Sa)return this.contains(i.Lg(),i.ih());if(i instanceof t.h)return this.contains(i.x,i.y);if(i instanceof e)return i.v>=this.v&&i.C<=this.C&&i.G>=this.G&&i.H<=this.H;throw t.i.N()},e.prototype.hm=function(i,n){if(void 0!==n)return i>this.v&&i<this.C&&n>this.G&&n<this.H;if(i instanceof t.h)return this.hm(i.x,i.y);if(i instanceof e)return i.v>this.v&&i.C<this.C&&i.G>this.G&&i.H<this.H;throw t.i.N()},e.prototype.Nb=function(t){return t==this||t instanceof e&&(!(!this.B()||!t.B())||this.v==t.v&&this.G==t.G&&this.C==t.C&&this.H==t.H)},e.prototype.cc=function(){var e=this.v;e=t.O.truncate(e^e>>>32);var i=t.O.Th(e);return e=this.C,e=t.O.truncate(e^e>>>32),i=t.O.Th(e,i),e=this.G,e=t.O.truncate(e^e>>>32),i=t.O.Th(e,i),e=this.H,e=t.O.truncate(e^e>>>32),t.O.Th(e,i)},e.prototype.xr=function(){return this.B()?2220446049250313e-29:2220446049250313e-29*(Math.abs(this.v)+Math.abs(this.C)+Math.abs(this.G)+Math.abs(this.H)+1)},e.prototype.zy=function(t,i){var n=this.Zj(t),r=this.Zj(i);if(n&r)return 0;if(!(n|r))return 4;var s=(0!=n?1:0)|(0!=r?2:0);do{var o=i.x-t.x,a=i.y-t.y;if(o>a?n&e.YC?(n&e.ju?(t.y+=a*(this.v-t.x)/o,t.x=this.v):(t.y+=a*(this.C-t.x)/o,t.x=this.C),n=this.Zj(t)):r&e.YC?(r&e.ju?(i.y+=a*(this.v-i.x)/o,i.x=this.v):(i.y+=a*(this.C-i.x)/o,i.x=this.C),r=this.Zj(i)):0!=n?(n&e.ku?(t.x+=o*(this.G-t.y)/a,t.y=this.G):(t.x+=o*(this.H-t.y)/a,t.y=this.H),n=this.Zj(t)):(r&e.ku?(i.x+=o*(this.G-i.y)/a,i.y=this.G):(i.x+=o*(this.H-i.y)/a,i.y=this.H),r=this.Zj(i)):n&e.ZC?(n&e.ku?(t.x+=o*(this.G-t.y)/a,t.y=this.G):(t.x+=o*(this.H-t.y)/a,t.y=this.H),n=this.Zj(t)):r&e.ZC?(r&e.ku?(i.x+=o*(this.G-i.y)/a,i.y=this.G):(i.x+=o*(this.H-i.y)/a,i.y=this.H),r=this.Zj(i)):0!=n?(n&e.ju?(t.y+=a*(this.v-t.x)/o,t.x=this.v):(t.y+=a*(this.C-t.x)/o,t.x=this.C),n=this.Zj(t)):(r&e.ju?(i.y+=a*(this.v-i.x)/o,i.x=this.v):(i.y+=a*(this.C-i.x)/o,i.x=this.C),r=this.Zj(i)),n&r)return 0}while(n|r);return s},e.prototype.Zj=function(t){return(t.x<this.v?1:0)|(t.x>this.C?1:0)<<1|(t.y<this.G?1:0)<<2|(t.y>this.H?1:0)<<3},e.prototype.Bi=function(t){return!this.B()&&(this.R()<=t||this.ca()<=t)},e.prototype.tb=function(e){return e instanceof t.h?Math.sqrt(this.iK(e)):Math.sqrt(this.px(e))},e.prototype.px=function(t){var e=0,i=0,n=this.v-t.C;return n>e&&(e=n),(n=this.G-t.H)>i&&(i=n),(n=t.v-this.C)>e&&(e=n),(n=t.G-this.H)>i&&(i=n),e*e+i*i},e.prototype.iK=function(t){var e=0,i=0,n=this.v-t.x;return n>e&&(e=n),(n=this.G-t.y)>i&&(i=n),(n=t.x-this.C)>e&&(e=n),(n=t.y-this.H)>i&&(i=n),e*e+i*i},e.prototype.cn=function(t){this.B()?t.Oa():t.K(this.v,this.C)},e.ju=1,e.ku=4,e.YC=3,e.ZC=12,e}();t.l=e}(X||(X={})),function(t){var e,i;(i=e||(e={}))[i.initialize=0]="initialize",i[i.initializeRed=1]="initializeRed",i[i.initializeBlue=2]="initializeBlue",i[i.initializeRedBlue=3]="initializeRedBlue",i[i.sweep=4]="sweep",i[i.sweepBruteForce=5]="sweepBruteForce",i[i.sweepRedBlueBruteForce=6]="sweepRedBlueBruteForce",i[i.sweepRedBlue=7]="sweepRedBlue",i[i.sweepRed=8]="sweepRed",i[i.sweepBlue=9]="sweepBlue",i[i.iterate=10]="iterate",i[i.iterateRed=11]="iterateRed",i[i.iterateBlue=12]="iterateBlue",i[i.iterateBruteForce=13]="iterateBruteForce",i[i.iterateRedBlueBruteForce=14]="iterateRedBlueBruteForce",i[i.resetRed=15]="resetRed",i[i.resetBlue=16]="resetBlue";var n=function(){function t(t,e){this.ci=t,this.dH=e}return t.prototype.nr=function(t,e,i){this.ci.JX(i,t,e,this.dH)},t.prototype.$p=function(t){return this.ci.Rr(t,this.dH)},t}();e=function(){function e(){this.ow=this.oo=this.ff=this.rd=null,this.wq=new t.l,this.Am=this.Hj=this.Ij=this.Ad=this.Ef=this.Ld=this.cw=this.fo=this.qd=this.Eb=null,this.Xb=-1,this.qa=0,this.Nk()}return e.prototype.kr=function(){this.Nk(),this.Pv=!0,null==this.Eb?(this.fo=new t.ia(0),this.Eb=[]):(this.fo.Bh(0),this.Eb.length=0)},e.prototype.ad=function(e,i){if(!this.Pv)throw t.i.Hb();var n=new t.l;n.K(i),this.fo.add(e),this.Eb.push(n)},e.prototype.Fp=function(){if(!this.Pv)throw t.i.Hb();this.Pv=!1,null!=this.Eb&&0<this.Eb.length&&(this.Xb=0,this.Ic=!1)},e.prototype.pK=function(){this.Nk(),this.Ov=!0,null==this.Eb?(this.fo=new t.ia(0),this.Eb=[]):(this.fo.Bh(0),this.Eb.length=0)},e.prototype.JD=function(e,i){if(!this.Ov)throw t.i.Hb();var n=new t.l;n.K(i),this.fo.add(e),this.Eb.push(n)},e.prototype.iF=function(){if(!this.Ov)throw t.i.Hb();this.Ov=!1,null!=this.Eb&&0<this.Eb.length&&null!=this.qd&&0<this.qd.length&&(-1==this.Xb||2==this.Xb?this.Xb=3:3!=this.Xb&&(this.Xb=1),this.Ic=!1)},e.prototype.oK=function(){this.Nk(),this.Nv=!0,null==this.qd?(this.cw=new t.ia(0),this.qd=[]):(this.cw.Bh(0),this.qd.length=0)},e.prototype.ED=function(e,i){if(!this.Nv)throw t.i.Hb();var n=new t.l;n.K(i),this.cw.add(e),this.qd.push(n)},e.prototype.hF=function(){if(!this.Nv)throw t.i.Hb();this.Nv=!1,null!=this.Eb&&0<this.Eb.length&&null!=this.qd&&0<this.qd.length&&(-1==this.Xb||1==this.Xb?this.Xb=3:3!=this.Xb&&(this.Xb=2),this.Ic=!1)},e.prototype.next=function(){if(this.Ic)return!1;for(var e=!0;e;)switch(this.Xb){case 0:e=this.Gz();break;case 1:e=this.rS();break;case 2:e=this.oS();break;case 3:e=this.qS();break;case 4:e=this.UX();break;case 5:e=this.QX();break;case 6:e=this.RX();break;case 7:e=this.SX();break;case 8:e=this.ux();break;case 9:e=this.iC();break;case 10:e=this.Uz();break;case 11:e=this.jT();break;case 12:e=this.gT();break;case 13:e=this.hT();break;case 14:e=this.iT();break;case 15:e=this.kJ();break;case 16:e=this.jJ();break;default:throw t.i.Qa()}return!this.Ic},e.prototype.aC=function(t){this.qa=t},e.prototype.uz=function(t){return this.Eb[t]},e.prototype.az=function(t){return this.qd[t]},e.prototype.nl=function(t){return this.fo.read(t)},e.prototype.hl=function(t){return this.cw.read(t)},e.Tz=function(t){return!(1&~t)},e.eq=function(t){return!(1&t)},e.prototype.Nk=function(){this.Pv=this.Nv=this.Ov=!1,this.Cf=this.Df=this.Rg=this.pe=-1,this.Ic=!0},e.prototype.Gz=function(){if(this.Af=this.Vf=-1,10>this.Eb.length)return this.pe=this.Eb.length,this.Xb=5,!0;null==this.rd&&(this.rd=new t.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new t.ia(0)),this.rd.kr();for(var e=0;e<this.Eb.length;e++){var i=this.Eb[e];this.rd.Br(i.v,i.C)}for(this.rd.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ld.resize(0),e=0;e<2*this.Eb.length;e++)this.Ld.add(e);return this.Kt(this.Ld,2*this.Eb.length,!0),this.pe=2*this.Eb.length,this.Xb=4,!0},e.prototype.rS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;null==this.rd&&(this.rd=new t.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new t.ia(0)),this.rd.kr();for(var e=0;e<this.Eb.length;e++){var i=this.Eb[e];this.rd.Br(i.v,i.C)}for(this.rd.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ld.resize(0),e=0;e<2*this.Eb.length;e++)this.Ld.add(e);return this.Kt(this.Ld,this.Ld.size,!0),this.pe=this.Ld.size,-1!=this.Df&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),this.Xb=7,this.jJ()},e.prototype.oS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;null==this.ff&&(this.ff=new t.sr(!0),this.ow=this.ff.getIterator(),this.Ef=new t.ia(0)),this.ff.kr();for(var e=0;e<this.qd.length;e++){var i=this.qd[e];this.ff.Br(i.v,i.C)}for(this.ff.Fp(),this.Ef.Jb(2*this.qd.length),this.Ef.resize(0),e=0;e<2*this.qd.length;e++)this.Ef.add(e);return this.Kt(this.Ef,this.Ef.size,!1),this.Rg=this.Ef.size,-1!=this.Cf&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Xb=7,this.kJ()},e.prototype.qS=function(){if(this.Af=this.Vf=-1,10>this.Eb.length||10>this.qd.length)return this.pe=this.Eb.length,this.Xb=6,!0;null==this.rd&&(this.rd=new t.sr(!0),this.oo=this.rd.getIterator(),this.Ld=new t.ia(0)),null==this.ff&&(this.ff=new t.sr(!0),this.ow=this.ff.getIterator(),this.Ef=new t.ia(0)),this.rd.kr();for(var e=0;e<this.Eb.length;e++){var i=this.Eb[e];this.rd.Br(i.v,i.C)}for(this.rd.Fp(),this.ff.kr(),e=0;e<this.qd.length;e++)i=this.qd[e],this.ff.Br(i.v,i.C);for(this.ff.Fp(),this.Ld.Jb(2*this.Eb.length),this.Ef.Jb(2*this.qd.length),this.Ld.resize(0),this.Ef.resize(0),e=0;e<2*this.Eb.length;e++)this.Ld.add(e);for(e=0;e<2*this.qd.length;e++)this.Ef.add(e);return this.Kt(this.Ld,this.Ld.size,!0),this.Kt(this.Ef,this.Ef.size,!1),this.pe=this.Ld.size,this.Rg=this.Ef.size,-1!=this.Df&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),-1!=this.Cf&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Xb=7,!0},e.prototype.UX=function(){var t=this.Ld.get(--this.pe),i=t>>1;return e.eq(t)?(this.rd.remove(i),0!=this.pe||(this.Af=this.Vf=-1,this.Ic=!0,!1)):(this.oo.EB(this.Eb[i].v,this.Eb[i].C,this.qa),this.Vf=i,this.Xb=10,!0)},e.prototype.QX=function(){return-1==--this.pe?(this.Af=this.Vf=-1,this.Ic=!0,!1):(this.Rg=this.Vf=this.pe,this.Xb=13,!0)},e.prototype.RX=function(){return-1==--this.pe?(this.Af=this.Vf=-1,this.Ic=!0,!1):(this.Vf=this.pe,this.Rg=this.qd.length,this.Xb=14,!0)},e.prototype.SX=function(){var t=this.Ld.get(this.pe-1),i=this.Ef.get(this.Rg-1),n=this.Rr(t,!0),r=this.Rr(i,!1);return n>r?this.ux():n<r?this.iC():e.Tz(t)?this.ux():e.Tz(i)?this.iC():this.ux()},e.prototype.ux=function(){var i=this.Ld.get(--this.pe),n=i>>1;if(e.eq(i))return-1!=this.Df&&-1!=this.Ij.get(n)?(this.Ad.jd(this.Df,this.Ij.get(n)),this.Ij.set(n,-1)):this.rd.remove(n),0!=this.pe||(this.Af=this.Vf=-1,this.Ic=!0,!1);if(-1!=this.Cf&&0<this.Ad.bs(this.Cf))for(i=this.Ad.rc(this.Cf);-1!=i;){var r=this.Ad.getData(i);this.ff.vj(r),this.Hj.set(r,-1),r=this.Ad.lb(i),this.Ad.jd(this.Cf,i),i=r}return 0<this.ff.size()?(this.ow.EB(this.Eb[n].v,this.Eb[n].C,this.qa),this.Vf=n,this.Xb=12):(-1==this.Df&&(null==this.Ad&&(this.Ad=new t.jp),this.Ij=new t.ia(0),this.Ij.resize(this.Eb.length,-1),this.Ij.Wj(-1,0,this.Eb.length),this.Df=this.Ad.Ph(1)),this.Ij.set(n,this.Ad.addElement(this.Df,n)),this.Xb=7),!0},e.prototype.iC=function(){var i=this.Ef.get(--this.Rg),n=i>>1;if(e.eq(i))return-1!=this.Cf&&-1!=this.Hj.get(n)?(this.Ad.jd(this.Cf,this.Hj.get(n)),this.Hj.set(n,-1)):this.ff.remove(n),0!=this.Rg||(this.Af=this.Vf=-1,this.Ic=!0,!1);if(-1!=this.Df&&0<this.Ad.bs(this.Df))for(i=this.Ad.rc(this.Df);-1!=i;){var r=this.Ad.getData(i);this.rd.vj(r),this.Ij.set(r,-1),r=this.Ad.lb(i),this.Ad.jd(this.Df,i),i=r}return 0<this.rd.size()?(this.oo.EB(this.qd[n].v,this.qd[n].C,this.qa),this.Af=n,this.Xb=11):(-1==this.Cf&&(null==this.Ad&&(this.Ad=new t.jp),this.Hj=new t.ia(0),this.Hj.resize(this.qd.length,-1),this.Hj.Wj(-1,0,this.qd.length),this.Cf=this.Ad.Ph(0)),this.Hj.set(n,this.Ad.addElement(this.Cf,n)),this.Xb=7),!0},e.prototype.Uz=function(){if(this.Af=this.oo.next(),-1!=this.Af)return!1;var t=this.Ld.get(this.pe)>>1;return this.rd.vj(t),this.Xb=4,!0},e.prototype.jT=function(){if(this.Vf=this.oo.next(),-1!=this.Vf)return!1;this.Af=this.Vf=-1;var t=this.Ef.get(this.Rg)>>1;return this.ff.vj(t),this.Xb=7,!0},e.prototype.gT=function(){if(this.Af=this.ow.next(),-1!=this.Af)return!1;var t=this.Ld.get(this.pe)>>1;return this.rd.vj(t),this.Xb=7,!0},e.prototype.hT=function(){if(-1==--this.Rg)return this.Xb=5,!0;this.wq.K(this.Eb[this.pe]);var t=this.Eb[this.Rg];return this.wq.W(this.qa,this.qa),!this.wq.isIntersecting(t)||(this.Af=this.Rg,!1)},e.prototype.iT=function(){if(-1==--this.Rg)return this.Xb=6,!0;this.wq.K(this.Eb[this.pe]);var t=this.qd[this.Rg];return this.wq.W(this.qa,this.qa),!this.wq.isIntersecting(t)||(this.Af=this.Rg,!1)},e.prototype.kJ=function(){return null==this.rd?(this.Ic=!0,!1):(this.pe=this.Ld.size,0<this.rd.size()&&this.rd.reset(),-1!=this.Df&&(this.Ad.bh(this.Df),this.Ij.resize(0),this.Df=-1),this.Ic=!1,!0)},e.prototype.jJ=function(){return null==this.ff?(this.Ic=!0,!1):(this.Rg=this.Ef.size,0<this.ff.size()&&this.ff.reset(),-1!=this.Cf&&(this.Ad.bh(this.Cf),this.Hj.resize(0),this.Cf=-1),this.Ic=!1,!0)},e.prototype.Kt=function(e,i,r){null==this.Am&&(this.Am=new t.Xt),r=new n(this,r),this.Am.sort(e,0,i,r)},e.prototype.JX=function(t,i,n,r){var s=this;t.Vd(i,n,(function(t,i){var n=s.Rr(t,r),o=s.Rr(i,r);return n<o||n==o&&e.eq(t)&&e.Tz(i)?-1:1}))},e.prototype.Rr=function(t,i){var n=.5*this.qa;return i?(i=this.Eb[t>>1],e.eq(t)?i.G-n:i.H+n):(i=this.qd[t>>1],e.eq(t)?i.G-n:i.H+n)},e}(),t.xC=e}(X||(X={})),function(t){var e=function(){function e(){}return e.construct=function(t,i,n,r,s,o){var a=new e;return a.v=t,a.G=i,a.Ye=n,a.C=r,a.H=s,a.Bg=o,a},e.prototype.Oa=function(){this.Ye=this.v=NaN},e.prototype.B=function(){return isNaN(this.v)},e.prototype.XS=function(){return isNaN(this.Ye)},e.prototype.K=function(t,e,i,n,r,s){void 0!==n?"number"==typeof t?(this.v=t,this.G=e,this.Ye=i,this.C=n,this.H=r,this.Bg=s):(this.v=t.x-.5*e,this.C=this.v+e,this.G=t.y-.5*i,this.H=this.G+i,this.Ye=t.z-.5*n,this.Bg=this.Ye+n):(this.v=t,this.G=e,this.Ye=i,this.C=t,this.H=e,this.Bg=i)},e.prototype.move=function(t){this.v+=t.x,this.G+=t.y,this.Ye+=t.z,this.C+=t.x,this.H+=t.y,this.Bg+=t.z},e.prototype.copyTo=function(t){t.v=this.v,t.G=this.G,t.C=this.C,t.H=this.H},e.prototype.Lk=function(t,e,i){this.v>t?this.v=t:this.C<t&&(this.C=t),this.G>e?this.G=e:this.H<e&&(this.H=e),0==isNaN(this.Ye)?this.Ye>i?this.Ye=i:this.Bg<i&&(this.Bg=i):this.Bg=this.Ye=i},e.prototype.Zb=function(i,n,r){if("number"==typeof i)this.B()?(this.v=i,this.G=n,this.Ye=r,this.C=i,this.H=n,this.Bg=r):this.Lk(i,n,r);else if(i instanceof t.Nd)this.Zb(i.x,i.y,i.z);else{if(!(i instanceof e))throw t.i.N();i.B()||(this.Zb(i.v,i.G,i.Ye),this.Zb(i.C,i.H,i.Bg))}},e.prototype.construct=function(t,e,i){t.B()||e.B()?this.Oa():(this.v=t.oa,this.C=t.va,this.G=e.oa,this.H=e.va,this.Ye=i.oa,this.Bg=i.va)},e.prototype.nB=function(e){if(null==e||8>e.length)throw t.i.N();e[0]=new t.Nd(this.v,this.G,this.Ye),e[1]=new t.Nd(this.v,this.H,this.Ye),e[2]=new t.Nd(this.C,this.H,this.Ye),e[3]=new t.Nd(this.C,this.G,this.Ye),e[4]=new t.Nd(this.v,this.G,this.Bg),e[5]=new t.Nd(this.v,this.H,this.Bg),e[6]=new t.Nd(this.C,this.H,this.Bg),e[7]=new t.Nd(this.C,this.G,this.Bg)},e.prototype.Zw=function(t){if(null==t||0==t.length)this.Oa();else{var e=t[0];for(this.K(e.x,e.y,e.z),e=1;e<t.length;e++){var i=t[e];this.Lk(i.x,i.y,i.z)}}},e}();t.OK=e}(X||(X={})),function(t){!function(t){t.Qa=function(){var t=Error();return t.message="Internal Error",t},t.Ie=function(){var t=Error();return t.message="Not Implemented",t},t.Xk=function(){var t=Error();return t.message="The input unit and the spatial reference unit are not of the same unit type.ie Linear vs.Angular",t},t.Hb=function(){var t=Error();return t.message="Invalid Call",t},t.N=function(t){var e=Error();return e.message="Illegal Argument Exception",void 0!==t&&(e.message+=": "+t),e},t.fu=function(t){var e=Error();return e.message=void 0!==t?"Runtime Exception: "+t:"Runtime Exception.",e},t.fa=function(t){var e=Error();return e.message="Geometry Exception: "+t,e},t.GK=function(){var t=Error();return t.message="Assert Failed Exception",t},t.ce=function(){var t=Error();return t.message="IndexOutOfBoundsException",t},t.WC=function(){var t=Error();return t.message="UserCancelException",t}}(t.i||(t.i={}))}(X||(X={})),function(t){(t=t.bm||(t.bm={}))[t.forward=0]="forward",t[t.reverse=1]="reverse"}(X||(X={})),function(t){var e=function(){function e(t,e){this.Wa=t,this.FH=e,this.LH=-1,this.sl=!1}return e.prototype.qe=function(){},e.prototype.next=function(){if(++this.LH==this.FH.I())return null;var e=this.FH.Na(this.LH);e.scale(this.Wa.ec);var i=new t.Da;return this.Wa.sy(e,this.sl,i),i},e.prototype.La=function(){return 0},e}(),i=function(){function e(e,i,n){this.Wa=e,this.rw=i,this.Xn=!1,this.co=n,this.bw=[0],this.sk=[0],this.Nj=[0],this.Gs=[0],this.sl=!1,this.qq=new t.Da,this.uk=[]}return e.prototype.qe=function(){},e.prototype.next=function(){if(this.Xn){this.Xn=!1,this.sd.ha();var e=t.aa.jg(this.qq);return t.Fg.Mk(e,this.Wa.Aq,!0,!0,this.Wa.Ub)}if(null==this.sd&&(this.sd=this.rw.Ga(),this.sd.$a(),null!=this.co&&this.co.Yk(null,0)),!this.sd.Ha()){if(!this.sd.$a())return null;null!=this.co&&this.co.Yk(null,0)}e=null,this.sk[0]=0,this.FA=this.bw[0]=0,this.di=NaN,this.Xn=!1;for(var i=this.uk.length=0,r=new t.h,s=new t.h,o=[0];this.sd.Ha()&&8>this.FA;){var a=this.sd.ha();if(r.L(a.ac()),s.L(a.wc()),r.scale(this.Wa.ec),s.scale(this.Wa.ec),t.cj.Mu(r,s)?r.x=s.x:t.cj.Ku(r,s)&&(s.x=r.x),this.uk.length=0,t.cj.tF(this.Wa.Tb,this.Wa.kc,this.Wa.ze,r,s,this.Wa.QA,this.Wa.Zs,o,this.Nj,this.Gs,this.uk,this.bw),null!=this.co&&(a=this.uk.slice(0),this.co.qG(this.co.da()-1,a,a.length-1)),t.cj.Lu(r,s)?(this.qq.Oa(),this.Wa.sy(r,this.sl,this.qq),this.Xn=!0):(this.qq.Oa(),this.Xn=this.xy(o[0],this.qq)),this.Xn){if(this.sd.li(),this.sd.Ez()){this.sd.li(),this.sd.ha();break}this.sd.DW();break}null==e&&(e=new t.Da).Yk(null,0),this.OD(e),i++}if(this.bw[0]=0,0<i){for(o=this.sd.wb();0<i;)this.sd.li(),r.L(this.rw.Na(this.sd.wb())),s.L(this.rw.Na(this.sd.ik())),r.scale(this.Wa.ec),s.scale(this.Wa.ec),this.sl&&(t.cj.Mu(r,s)?r.x=s.x:t.cj.Ku(r,s)&&(s.x=r.x)),this.uk.length=0,t.cj.tF(this.Wa.Tb,this.Wa.kc,this.Wa.ze,s,r,this.Wa.QA,this.Wa.Zs,null,this.Nj,this.Gs,this.uk,this.bw),this.OD(e),i--;return r.L(this.rw.Na(this.sd.wb())),r.scale(this.Wa.ec),n.Hr(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,r,this.di+1.570796326794897,this.di+4.71238898038469,this.Wa.ao,this.sl,this.sk,e,NaN,NaN),this.sd.Vb(o),this.sd.ha(),i=t.ta.kj(null,e,!0),t.Fg.Mk(e,i,!0,!0,this.Wa.Ub)}return this.Xn=!1,this.sd.ha(),e=t.aa.jg(this.qq),t.Fg.Mk(e,this.Wa.Aq,!0,!0,this.Wa.Ub)},e.prototype.OD=function(e){var i=this.uk[0],r=this.Nj[0]-1.570796326794897,s=this.Gs[0]+1.570796326794897;if(!isNaN(this.di)){if(this.di>=this.Nj[0]){var o=this.di+1.570796326794897;r=o+3.141592653589793-(this.di-this.Nj[0])}else r=(o=this.di+1.570796326794897)+3.141592653589793-(6.283185307179586-(this.Nj[0]-this.di));var a=!(this.di>=this.Nj[0]&&3.141592653589793>=this.di-this.Nj[0]||this.di<this.Nj[0]&&3.141592653589793<=this.Nj[0]-this.di),h=!1;if(Math.abs(r-o)<=.5*this.Wa.ao)if(a){var l=e.Na(e.I()-2);l.scale(this.Wa.ec);var c=new t.ga(0);for(t.kb.Xy(this.Wa.Tb,this.Wa.kc,i.x,i.y,l.x,l.y,c),l=c.u;l<=o;)l+=6.283185307179586;for(;l>o;)l-=6.283185307179586;l<r&&(h=!0)}else h=!0;h?(e.DB(0,e.I()-1),this.sl||((i=new t.h).L(e.Na(e.I()-1)),i.scale(this.Wa.ec),-3.141592653589793>i.x-this.sk[0]?this.sk[0]-=6.283185307179586:3.141592653589793<i.x-this.sk[0]&&(this.sk[0]+=6.283185307179586)),a||(r=.5*(r+o))):(a?((o=new t.h).L(i),o.scale(1/this.Wa.ec),e.wf(0,-1,o)):n.Hr(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,this.uk[0],o,r,this.Wa.ao,this.sl,this.sk,e,NaN,NaN),this.FA+=1)}n.qy(this.Wa.Tb,this.Wa.kc,this.Wa.ec,this.Wa.rb,this.Wa.ze,this.uk,r,s,this.sl,this.sk,e),this.di=this.Gs[0]},e.prototype.xy=function(t,e){return this.Wa.xy(this.uk,t,this.Nj[0],this.Gs[0],this.sl,e)},e.prototype.La=function(){return 0},e}(),n=function(){function n(){}return n.buffer=function(e,i,r,s,o,a){if(null==e)throw t.i.N("Geometry::Geodesic_bufferer::buffer");if(e.B())return new t.Da(e.description);var h=new n;h.Qg=i,h.Jc=t.cb.sc(i);var l=t.cb.vv(h.Jc);if(h.Ub=a,h.Tb=t.cb.ev(h.Jc),h.kc=l*(2-l),h.ec=h.Jc.Hd().ai,h.qa=h.Qg.Kn(),h.Aq=h.Jc.Kn(),h.Zs=h.Aq*h.ec,h.zq=1.570796326794897/h.ec,h.OY=3.141592653589793/h.ec,h.Js=6.283185307179586/h.ec,h.PY=h.Js/6,h.LA=0,h.NY=1.5707963267948966*h.Tb/h.LA,4==r?(h.ze=2,h.Wv=!0):(h.ze=r,h.Wv=!1),h.Ka=s,h.rb=Math.abs(s),isNaN(o)||.001>o?h.xX():h.$n=o,r=e.getType(),t.aa.yd(r)?((r=new t.Ta(e.description)).oc(e,!0),e=r,r=1607):197==r&&(r=new t.l,e.A(r),r.R()<=h.qa||r.ca()<=h.qa?((r=new t.Ta(e.description)).ad(e,!1),e=r,r=1607):((r=new t.Da(e.description)).ad(e,!1),e=r,r=1736)),h.yX(),t.aa.Rn(r)||h.zX(),h.rb<=.5*h.$n)return 1736!=r?new t.Da(e.description):h.Wv?e:t.cj.Qr(e,h.Qg,h.ze,h.QA,-1,a);if(0>h.Ka&&1736!=r)return new t.Da(e.description);if(h.Wv&&t.aa.Hc(r)?(i=t.cj.Qr(e,i,4,NaN,h.$n,a),e=t.cb.zh(i,h.Qg,h.Jc)):e=t.cb.zh(e,h.Qg,h.Jc),(e=t.Hh.lj(e,h.Jc)).B())return new t.Da(e.description);switch(!h.Wv&&t.aa.Hc(r)&&(e=t.cj.pI(h.ec,e)),e=n.KX(e,h.Jc),r){case 1736:i=h.UN(e);break;case 1607:i=h.VN(e);break;case 550:i=h.SN(e);break;case 33:i=h.TN(e);break;default:throw t.i.fa("corrupted_geometry")}return(h=t.cb.zh(i,h.Jc,h.Qg)).Jl(e.description),h},n.prototype.UN=function(e){var n=new t.Da;e=new i(this,e,n),e=t.Gh.local().V(e,this.Jc,this.Ub).next(),e=t.ip.nj(e,this.Jc,2);var r=new t.Dd;return r.scale(1/this.ec,1/this.ec),n.Oc(r),n=t.ip.nj(n,this.Jc,2),0<=this.Ka?t.Gh.local().V(n,e,this.Jc,this.Ub):t.kp.local().V(n,e,this.Jc,this.Ub)},n.prototype.VN=function(e){return e=new i(this,e,null),e=t.Gh.local().V(e,this.Jc,this.Ub).next(),t.ip.nj(e,this.Jc,2)},n.prototype.SN=function(i){return i=new e(this,i),i=t.Gh.local().V(i,this.Jc,this.Ub).next(),t.ip.nj(i,this.Jc,2)},n.prototype.TN=function(e){(e=e.D()).scale(this.ec);var i=new t.Da;return this.sy(e,!1,i),t.ip.nj(i,this.Jc,2)},n.prototype.xy=function(e,i,r,s,o,a){var h=e[0],l=e[e.length-1],c=h.y>l.y?h.y:l.y,u=t.F.q(this.Tb,this.kc,h.y<l.y?h.y:l.y);if(c=t.F.q(this.Tb,this.kc,c),.001<this.LA-(u+i+this.rb)&&.001<this.LA+(c-i-this.rb))return!1;u=(i=r-1.570796326794897)-3.141592653589793,c=i+3.141592653589793;var d=(r=s+1.570796326794897)+3.141592653589793,f=[NaN],p=[NaN],g=[NaN],v=[NaN];if(s=!1,n.dJ(this.Tb,this.kc,this.rb,h,i,u,l,r,f,p),n.dJ(this.Tb,this.kc,this.rb,l,d,r,h,u,g,v),(r<f[0]&&f[0]<d||r<p[0]&&p[0]<d)&&(s=!0),s||(u<g[0]&&g[0]<i||u<v[0]&&v[0]<i)&&(s=!0),!s&&o)return!1;for(var m=[],y=e.length-1;0<=y;y--)m.push(e[y]);return a.Oa(),a.Yk(null,0),y=[0],n.qy(this.Tb,this.kc,this.ec,this.rb,this.ze,e,i,r,o,y,a),n.Hr(this.Tb,this.kc,this.ec,this.rb,l,r,d,this.ao,o,y,a,f[0],p[0]),n.qy(this.Tb,this.kc,this.ec,this.rb,this.ze,m,d,c,o,y,a),n.Hr(this.Tb,this.kc,this.ec,this.rb,h,u,i,this.ao,o,y,a,g[0],v[0]),e=!1,o||(e=this.IE(this.ec,a)),s||e},n.prototype.sy=function(t,e,i){i.Oa(),i.Yk(null,0),n.Hr(this.Tb,this.kc,this.ec,this.rb,t,-this.ao,6.283185307179586,this.ao,e,[0],i,NaN,NaN),e||this.IE(this.ec,i)},n.prototype.IE=function(t,e){var i=this.vO(t,e);return t=this.wO(t,e),i||t},n.prototype.vO=function(e,i){var n=i.I(),r=!1,s=new t.l;if(i.A(s),!t.s.Y(s.H*e,1.570796326794897)&&!t.s.Y(s.G*e,-1.570796326794897))return!1;var o=new t.h;for(--n;0<=n;n--)i.D(n,o),(o.y==s.H&&t.s.Y(o.y*e,1.570796326794897)||o.y==s.G&&t.s.Y(o.y*e,-1.570796326794897))&&(r=!0,this.OI(o,n,i));return r},n.prototype.wO=function(t,e){var i=e.Na(0),n=e.Na(e.I()-1);return 3.141592653589793<Math.abs(i.x-n.x)*t?(this.VV(e),!0):this.uO(e)},n.prototype.uO=function(t){return 0>t.Ke()&&(this.UV(t),!0)},n.prototype.OI=function(e,i,n){var r=n.I(),s=0<i?i-1:r-1;if(r=n.Na(i<r-1?i+1:0),s=n.Na(s),!t.s.Y(r.y,e.y)&&!t.s.Y(r.x,e.x)){var o=new t.h;o.ma(r.x,e.y),n.Cb(i,o)}t.s.Y(s.y,e.y)||t.s.Y(s.x,e.x)||((r=new t.h).ma(s.x,e.y),n.wf(0,i,r))},n.prototype.VV=function(e){var i=new t.Da,n=new t.Da,r=new t.Dd,s=e.Na(0),o=e.Na(e.I()-1),a=new t.h;s.x>o.x?(o=this.zq,r.gg(-this.Js,0)):(o=-this.zq,r.gg(this.Js,0)),i.add(e,!1),e.Oa(),n.add(i,!1),n.Oc(r),s=new t.l,n.A(s),s.W((this.Js-s.R())/2,0),s.G=-this.zq,s.H=this.zq;for(var h=0;h<n.I();h++)n.D(h,a),i.wf(0,-1,a);for(n.Oc(r),h=0;h<n.I();h++)n.D(h,a),i.wf(0,-1,a);n=i.Na(0),r=i.Na(i.I()-1),a.ma(r.x,o),i.wf(0,-1,a),a.ma(.5*(r.x+n.x),o),i.wf(0,-1,a),a.ma(n.x,o),i.wf(0,-1,a),i=t.Hh.ks(i,this.Jc,2,!0,s.v),i=t.Hh.ks(i,this.Jc,2,!0,s.C),i=t.Ud.clip(i,s,this.Aq,NaN),e.add(i,!1)},n.prototype.UV=function(e){var i=new t.l;e.A(i),i.W((this.Js-i.R())/2,0),i.G=-this.zq,i.H=this.zq,e.Yk(null,0);var n=new t.h;n.ma(i.v,i.G),e.wf(1,-1,n),n.ma(i.v,i.H),e.wf(1,-1,n),n.ma(.5*(i.v+i.C),i.H),e.wf(1,-1,n),n.ma(i.C,i.H),e.wf(1,-1,n),n.ma(i.C,i.G),e.wf(1,-1,n),n.ma(.5*(i.v+i.C),i.G),e.wf(1,-1,n)},n.qy=function(e,i,r,s,o,a,h,l,c,u,d){var f=null;c||((f=new t.h).Rc(),0<d.I()&&(f.L(d.Na(d.I()-1)),f.scale(r)));var p=new t.ga(0),g=new t.ga(0),v=new t.ga(0),m=new t.h,y=new t.h,_=a[a.length-1];r=1/r;for(var b=0;b<a.length;b++){var w=a[b];if(0==b)var x=h;else b==a.length-1?x=l:(t.kb.wd(e,i,_.x,_.y,w.x,w.y,null,null,p,o),x=p.u-1.570796326794897);t.kb.yi(e,i,w.x,w.y,s,x,g,v),c?y.ma(g.u,v.u):(m.ma(g.u,v.u),n.gJ(w.x,m.x,f.x,u),y.ma(u[0]+m.x,m.y),f.L(y)),y.scale(r),d.wf(0,-1,y)}},n.Hr=function(e,i,r,s,o,a,h,l,c,u,d,f,p){if(!(h-a<l)){var g=new t.ga(0),v=new t.ga(0),m=new t.h,y=new t.h,_=null;c||((_=new t.h).Rc(),0<d.I()&&(_.L(d.Na(d.I()-1)),_.scale(r)));var b=t.O.truncate(Math.ceil(a/l)),w=b++*l;for(w==a&&(w=b++*l),r=1/r;w<h+l&&(a<f&&f<w?(w=f,b--):a<p&&p<w&&(w=p,b--),!(w>=h));)t.kb.yi(e,i,o.x,o.y,s,w,g,v),c?y.ma(g.u,v.u):(m.ma(g.u,v.u),n.gJ(o.x,m.x,_.x,u),y.ma(u[0]+m.x,m.y),_.L(y)),y.scale(r),d.wf(0,-1,y),a=w,w=b++*l}},n.dJ=function(e,i,n,r,s,o,a,h,l,c){var u=new t.h,d=new t.h,f=new t.ga(0),p=new t.ga(0);for(t.kb.yi(e,i,r.x,r.y,n,s,f,p),u.ma(f.u,p.u),t.kb.yi(e,i,r.x,r.y,n,o,f,p),d.ma(f.u,p.u),n=new t.ga(0),t.kb.Xy(e,i,a.x,a.y,u.x,u.y,n),l[0]=n.u,t.kb.Xy(e,i,a.x,a.y,d.x,d.y,n),c[0]=n.u;l[0]<=c[0];)l[0]+=6.283185307179586;for(;l[0]>c[0];)l[0]-=6.283185307179586;for(;l[0]>=h;)l[0]-=6.283185307179586,c[0]-=6.283185307179586;for(;l[0]<h;)l[0]+=6.283185307179586,c[0]+=6.283185307179586},n.gJ=function(t,e,i,n){if(isNaN(i)){for(;3.141592653589793<n[0]+e-t;)n[0]-=6.283185307179586;for(;3.141592653589793<t-(n[0]+e);)n[0]+=6.283185307179586}else 3.141592653589793<n[0]+e-i?n[0]-=6.283185307179586:3.141592653589793<i-(n[0]+e)&&(n[0]+=6.283185307179586)},n.KX=function(e,i){var n=e.getType(),r=t.aa.Hc(n)?e.da():550==n?e.I():1;if(1==r)return e;var s=new t.ia(0);s.resize(r);for(var o=[],a=new t.l,h=0;h<r;h++){if(s.write(h,h),t.aa.Hc(n)){e.Rj(h,a);var l=a.sf()}else l=e.Na(h);l=t.XK.$X(i,l),o[h]=l}for(s.Vd(0,s.size,(function(t,e){return o[t]<o[e]?-1:o[t]>o[e]?1:0})),i=e.Ia(),h=0;h<r;h++)a=s.read(h),t.aa.Hc(n)?i.addPath(e,a,!0):i.Fd(e,a,a+1);return i},n.prototype.yX=function(){var e=Math.min(3.141592653589793*this.Tb-this.rb,this.rb);e=Math.min(e,.39269908169872414*this.Tb);var i=new t.h;i.ma(0,10*this.ec);var n=45*this.ec,r=new t.ga(0),s=new t.ga(0),o=new t.ga(0),a=new t.ga(0),h=new t.ga(0),l=new t.ga(0),c=new t.ga(0),u=new t.ga(0),d=new t.h,f=new t.h,p=new t.h,g=new t.h;t.kb.yi(this.Tb,this.kc,i.x,i.y,e,0,r,s),d.ma(r.u,s.u),t.kb.yi(this.Tb,this.kc,i.x,i.y,e,n,o,a),f.ma(o.u,a.u),r=new t.ga(0),s=new t.ga(0);for(var v=new t.ga(0);t.kb.yi(this.Tb,this.kc,i.x,i.y,e,.5*(0+n),h,l),p.ma(h.u,l.u),t.kb.wd(this.Tb,this.kc,d.x,d.y,f.x,f.y,r,s,null,2),t.kb.oj(this.Tb,this.kc,d.x,d.y,.5*r.u,s.u,c,u,2),g.ma(c.u,u.u),t.kb.wd(this.Tb,this.kc,p.x,p.y,g.x,g.y,v,null,null,2),!(v.u<=this.$n);)n*=.9,t.kb.yi(this.Tb,this.kc,i.x,i.y,e,n,o,a),f.ma(o.u,a.u);this.ao=6.283185307179586/Math.ceil(6.283185307179586/(n-0))},n.prototype.zX=function(){var e=Math.min(3.141592653589793*this.Tb-this.rb,this.rb);e=Math.min(e,.39269908169872414*this.Tb);var i=new t.h,n=new t.h;i.ma(0,10*this.ec),n.ma(10*this.ec,10*this.ec);var r=new t.ga(0),s=new t.ga(0),o=new t.ga(0);t.kb.wd(this.Tb,this.kc,i.x,i.y,n.x,n.y,o,r,s,this.ze);var a=new t.ga(0),h=new t.ga(0),l=new t.ga(0),c=new t.ga(0),u=new t.h,d=new t.ga(0),f=new t.ga(0),p=new t.ga(0),g=new t.ga(0),v=new t.ga(0),m=new t.ga(0),y=new t.ga(0),_=new t.ga(0),b=new t.ga(0),w=new t.h,x=new t.h,T=new t.h,A=new t.h,M=1;r=r.u,s=s.u+1.570796326794897,o=o.u,t.kb.yi(this.Tb,this.kc,i.x,i.y,e,r-1.570796326794897,f,p),w.ma(f.u,p.u),t.kb.yi(this.Tb,this.kc,n.x,n.y,e,s,g,v),x.ma(g.u,v.u),f=new t.ga(0),p=new t.ga(0),s=new t.ga(0);for(var S=new t.ga(0);t.kb.oj(this.Tb,this.kc,i.x,i.y,.5*(0+M)*o,r,a,h,this.ze),u.ma(a.u,h.u),t.kb.wd(this.Tb,this.kc,i.x,i.y,u.x,u.y,null,null,d,this.ze),t.kb.yi(this.Tb,this.kc,u.x,u.y,e,d.u+1.570796326794897,m,y),T.ma(m.u,y.u),t.kb.wd(this.Tb,this.kc,w.x,w.y,x.x,x.y,f,p,null,2),t.kb.oj(this.Tb,this.kc,w.x,w.y,.5*f.u,p.u,_,b,2),A.ma(_.u,b.u),t.kb.wd(this.Tb,this.kc,T.x,T.y,A.x,A.y,s,null,null,2),!(s.u<=this.$n);)M*=.9,t.kb.oj(this.Tb,this.kc,i.x,i.y,M*o,r,l,c,this.ze),n.ma(l.u,c.u),t.kb.wd(this.Tb,this.kc,i.x,i.y,n.x,n.y,null,null,S,this.ze),t.kb.yi(this.Tb,this.kc,n.x,n.y,e,S.u+1.570796326794897,g,v),x.ma(g.u,v.u);1e5<(e=M*o)&&(e=1e5),this.QA=e},n.prototype.xX=function(){var t=5e4<this.rb?100:1e4<this.rb?10:1;500>this.rb/t&&(t=this.rb/500),.01>t&&(t=.01),this.$n=t},n}();t.VK=n}(X||(X={})),function(t){var e=function(){function e(){}return e.Mf=function(e,i){var n=new t.h;n.L(i),e.push(n)},e.up=function(t,e){t.add(e.x),t.add(e.y)},e.hB=function(t){t.Bh(t.size-2)},e.oB=function(t,e){e.ma(t.get(t.size-2),t.get(t.size-1))},e.Qr=function(i,n,r,s,o,a){if(null==i)throw t.i.N();var h=i.getType();if(i.B()||t.aa.Rn(h))return i;var l=new e;l.Qg=n,l.Jc=t.cb.sc(n);var c=t.cb.vv(l.Jc);if(l.Ub=a,l.Tb=t.cb.ev(l.Jc),l.kc=c*(2-c),l.ec=l.Jc.Hd().ai,l.Aq=l.Jc.Kn(),l.Zs=l.Aq*l.ec,l.AA=s,l.zA=o,l.ze=r,197==h?(r=new t.Da(i.description)).ad(i,!1):t.aa.yd(h)?(r=new t.Ta(i.description)).oc(i,!0):r=i,4!=l.ze){if((n=0==l.Qg.Nb(l.Jc)?t.cb.zh(r,l.Qg,l.Jc):t.Hh.lj(r,l.Jc)).B())return n;n=e.pI(l.ec,n),n=l.Zy(n),n=t.ip.nj(n,l.Jc,l.ze),l=t.cb.zh(n,l.Jc,l.Qg)}else{if(2==t.Eg.Sb(n)?(i=t.cb.ml(),(n=t.Xj.local().V(r,i,n,a))==i&&(n=new t.Da,i.copyTo(n))):n=t.Hh.lj(r,l.Jc),n.B())return n;l=l.CX(n)}return l},e.pI=function(i,n){var r=new t.l;if(n.xc(r),3.141592653589793>r.R()*i)return n;var s=!1;r=n.Ga();for(var o=new t.h,a=new t.h;r.$a();)for(;r.Ha();){var h=r.ha();if(o.L(h.ac()),a.L(h.wc()),o.scale(i),a.scale(i),3.141592653589793<Math.abs(o.x-a.x)){var l=e.Lu(o,a);if(!l){s=!0;break}if(6.283185307179586<Math.abs(o.x-a.x)){s=!0;break}}}if(!s)return n;s=n.Ia();var c=1<n.description.Aa,u=new t.h,d=new t.h,f=new t.h,p=new t.h,g=new t.Sa;for(r.Zi();r.$a();)for(var v=NaN,m=[0];r.Ha();){if(h=r.ha(),o.L(h.ac()),a.L(h.wc()),o.scale(i),a.scale(i),isNaN(v)?(e.Wi(o.x,NaN,m),d.L(o)):d.L(f),v=d.x,l=e.Lu(o,a)){if(6.283185307179586<a.x-o.x)for(;6.283185307179586<a.x-o.x;)a.x-=6.283185307179586;if(-6.283185307179586>a.x-o.x)for(;-6.283185307179586>a.x-o.x;)a.x+=6.283185307179586;e.Wi(a.x,NaN,m),f.L(a)}else u.L(a),e.AU(u),e.Wi(u.x,v,m),f.ma(m[0]+u.x,u.y);.5>Math.abs(f.x-a.x)&&f.L(a),c?(h.Tw(0,g),p.L(d),p.scale(1/i),g.Cb(p),(l=r.vm())?s.nf(g):s.lineTo(g),r.Qn()&&!n.dc(r.gb)&&(h.Tw(1,g),p.L(f),p.scale(1/i),g.Cb(p),s.lineTo(g))):((l=r.vm())&&s.Hz(null,0),h=s.da()-1,p.L(d),p.scale(1/i),s.wf(h,-1,p),r.Qn()&&!n.dc(r.gb)&&(p.L(f),p.scale(1/i),s.wf(h,-1,p)))}return s},e.tF=function(i,n,r,s,o,a,h,l,c,u,d,f){var p=new t.h,g=new t.h,v=0<s.compare(o);e.fJ(v,s,o,p,g),e.uF(i,n,r,p,g,a,NaN,h,l,c,u,null,d,f),v&&e.fC(c,u,null,d)},e.prototype.Zy=function(i){var n=i.Ia(),r=i.Ga(),s=[],o=null,a=null,h=1<i.description.Aa;h&&(o=new t.be(0),a=new t.ig);for(var l=[0],c=new t.h,u=new t.h,d=new t.h,f=new t.h;r.$a();)for(l[0]=0;r.Ha();){var p=r.ha();c.L(p.ac()),u.L(p.wc()),c.scale(this.ec),u.scale(this.ec);var g=0<c.compare(u);e.fJ(g,c,u,d,f),s.length=0,null!=o&&o.Bh(0),0<this.AA?e.uF(this.Tb,this.kc,this.ze,d,f,this.AA,this.zA,this.Zs,null,null,null,h?o:null,s,l):e.aR(this.Tb,this.kc,this.ze,d,f,this.zA,this.Zs,h?o:null,s,l),g&&e.fC(null,null,h?o:null,s),s[0].L(p.ac()),s[s.length-1].L(p.wc());for(var v=1;v<s.length-1;v++)s[v].scale(1/this.ec);h?(g=e.eJ(g,p,a),e.TD(r.vm(),r.Qn()&&!i.dc(r.gb),p,g,o,s,n)):e.SD(r.vm(),r.Qn()&&!i.dc(r.gb),s,n)}return n},e.prototype.CX=function(i){var n=i.Ia(),r=i.Ga(),s=[],o=null,a=new t.ig,h=1<i.description.Aa;for(h&&(o=new t.be(0));r.$a();)for(;r.Ha();){var l=r.ha(),c=l.ac(),u=l.wc();c=0<c.compare(u),u=e.eJ(c,l,a),s.length=0,null!=o&&o.Bh(0),e.BX(this.Tb,this.kc,this.ec,u,this.Qg,this.AA,this.zA,h?o:null,s),c&&e.fC(null,null,h?o:null,s),h?e.TD(r.vm(),r.Qn()&&!i.dc(r.gb),l,u,o,s,n):e.SD(r.vm(),r.Qn()&&!i.dc(r.gb),s,n)}return n},e.SD=function(t,e,i,n){t&&n.Hz(null,0),t=n.da()-1;var r=i.slice(0);n.qG(t,r,r.length-1),e&&n.wf(t,-1,i[i.length-1])},e.TD=function(e,i,n,r,s,o,a){var h=new t.Sa;if(n.To(h),e?a.nf(h):a.lineTo(h),2<o.length){e=r.Qb();for(var l=1;l<o.length-1;l++){var c=r.NG(s.get(l)*e);r.Tw(c,h),h.Cb(o[l]),a.lineTo(h)}}i&&(n.Po(h),a.lineTo(h))},e.uF=function(i,n,r,s,o,a,h,l,c,u,d,f,p,g){var v=new t.ga(0),m=new t.ga(0),y=new t.ga(0);t.kb.wd(i,n,s.x,s.y,o.x,o.y,y,v,m,r),y=y.u;var _=v=v.u;0>_&&(_+=6.283185307179586),0>(m=m.u)&&(m+=6.283185307179586),null!=c&&(c[0]=y),null!=u&&(u[0]=_),null!=d&&(d[0]=m),u=c=NaN,null!=f&&(c=((u=t.F.Ah(i,n))-(d=t.F.q(i,n,s.y)))/y,u=(u+d)/y),d=e.Mu(s,o),m=e.Ku(s,o),_=d||m;var b=e.FE(s,o,l),w=new t.ga(0),x=new t.ga(0),T=new t.h,A=new t.h,M=new t.h;e.Wi(s.x,NaN,g);var S=[g[0]];if(y<=a)e.Mf(p,s),e.Wi(o.x,NaN,g),null!=f&&f.add(0),_?(d&&e.kB(s,o,f,p),m&&e.iB(s,o,f,p)):b?e.jB(s,o,v,c,u,f,p):0<h&&(A.ma(s.x-S[0],s.y),T.ma(o.x-g[0],o.y),e.Yy(i,n,r,s,y,v,A,T,0,1,h,f,p,S)),e.Mf(p,o);else{var E=y/((a=1+t.O.truncate(Math.ceil(y/a)))-1),C=new t.h,O=0;e.Mf(p,s),C.L(s),A.ma(s.x-g[0],s.y),null!=f&&f.add(0);for(var R=1;R<a;R++){if(R<a-1){t.kb.oj(i,n,s.x,s.y,R*E,v,w,x,r),T.ma(w.u,x.u),e.Wi(T.x,C.x,g),M.ma(g[0]+T.x,T.y);var I=R/(a-1)}else e.Wi(o.x,NaN,g),T.ma(o.x-g[0],o.y),M.L(o),I=1;_?(1==R&&d&&e.kB(s,M,f,p),R==a-1&&m&&e.iB(C,o,f,p)):b?e.EE(C,M,l)&&(s.x<o.x?C.x>M.x&&(g[0]+=6.283185307179586,M.ma(g[0]+T.x,T.y)):C.x<M.x&&(g[0]-=6.283185307179586,M.ma(g[0]+T.x,T.y)),e.jB(C,M,v,c,u,f,p)):0<h&&e.Yy(i,n,r,s,y,v,A,T,O,I,h,f,p,S),e.Mf(p,M),null!=f&&f.add(I),C.L(M),A.L(T),S[0]=g[0],O=I}}},e.aR=function(i,n,r,s,o,a,h,l,c,u){var d=new t.ga(0),f=new t.ga(0),p=new t.ga(0);t.kb.wd(i,n,s.x,s.y,o.x,o.y,p,d,f,r),f=p.u,d=d.u;var g=p=NaN;if(null!=l){g=t.F.Ah(i,n);var v=t.F.q(i,n,s.y);p=(g-v)/f,g=(g+v)/f}v=e.Mu(s,o);var m=e.Ku(s,o),y=v||m;h=e.FE(s,o,h);var _=e.Lu(s,o);_=y||h||_,e.Wi(s.x,NaN,u);var b=new t.h;e.Mf(c,s),b.L(s),null!=l&&l.add(0),_?(y?(v&&e.kB(s,o,l,c),m&&e.iB(s,o,l,c)):h&&e.jB(s,o,d,p,g,l,c),e.Wi(o.x,NaN,u),e.Mf(c,o)):f<=a?(e.Wi(o.x,NaN,u),e.Mf(c,o)):(p=new t.h,h=new t.h,p.L(s),h.L(o),p.x-=u[0],h.x-=u[0],-3.141592653589793>h.x?h.x+=6.283185307179586:3.141592653589793<h.x&&(h.x-=6.283185307179586),e.Yy(i,n,r,s,f,d,p,h,0,1,a,l,c,u),e.Mf(c,o),e.Wi(o.x,NaN,u)),null!=l&&l.add(1)},e.Yy=function(i,n,r,s,o,a,h,l,c,u,d,f,p,g){var v=new t.h,m=new t.h;v.ma(h.x+g[0],h.y),new t.ga(0),new t.ga(0),new t.ga(0),new t.ga(0);var y=new t.ga(0),_=new t.ga(0),b=new t.ga(0),w=new t.h,x=new t.h,T=new t.h,A=new t.h;w.L(h),x.L(l),h=new t.be(0),l=new t.be(0),e.up(h,x),l.add(u);var M=new t.h,S=new t.yb,E=[];for(e.YJ(4,E);0<h.size;){for(var C,O=!1,R=NaN,I=0;3>I;I++)if(C=E[I]*u+(1-E[I])*c,t.kb.oj(i,n,s.x,s.y,C*o,a,y,_,r),T.ma(y.u,_.u),0==I&&(R=C,A.L(T)),e.WW(w,T,x,S),S.hc(S.fe(T,!0),M),t.kb.wd(i,n,T.x,T.y,M.x,M.y,b,null,null,2),b.u>d){O=!0;break}O?(x.L(A),u=R,e.up(h,x),l.add(u)):(e.hB(h),l.En(l.size-1,1,l.size-1),0<h.size&&(e.Wi(x.x,v.x,g),m.ma(g[0]+x.x,x.y),e.Mf(p,m),v.L(m),null!=f&&f.add(u),w.L(x),c=u,e.oB(h,x),u=l.get(l.size-1)))}},e.BX=function(i,n,r,s,o,a,h,l,c){var u=new t.h,d=new t.h,f=new t.h,p=new t.h,g=new t.h,v=new t.h,m=new t.h,y=new t.h,_=new t.h,b=new t.h,w=new t.ga(0),x=new t.ga(0),T=new t.h,A=[[],[]],M=1==t.Eg.Sb(o);o=o.Xd(0);var S=s.ac(),E=s.wc();M?(v.ma(S.x*r,S.y*r),m.ma(E.x*r,E.y*r)):(A[0][0]=S.x,A[0][1]=S.y,A[1][0]=E.x,A[1][1]=E.y,t.cb.vt(),v.x=A[0][0]*r,v.y=A[0][1]*r,m.x=A[1][0]*r,m.y=A[1][1]*r);var C=0,O=0,R=1,I=s.Pn();u.L(S),d.L(E),E=new t.be(0);var P=new t.be(0),N=new t.be(0);e.up(E,d),e.up(P,m),N.add(R),e.Mf(c,u),null!=l&&l.add(O);var D=[],L=0<h?I?5:3:I?5:1;e.YJ(L,D);for(var z=new t.ga(0),j=new t.ga(0),k=new t.ga(0),F=new t.ga(0),H=new t.ga(0),B=new t.ga(0),G=new t.ga(0);0<P.size;){var V=!1,U=NaN;for(t.kb.wd(i,n,v.x,v.y,m.x,m.y,z,j,null,2),S=0;S<L;S++){if(0==S){if(!I&&0>=h&&z.u<=a&&3.141592653589793>Math.abs(v.x-m.x))break;if(s.Ux(O,R)<=o)break}var $=D[S]*R+(1-D[S])*O;if(s.hc($,f),M?y.ma(f.x*r,f.y*r):(A[0][0]=f.x,A[0][1]=f.y,t.cb.vt(),y.x=A[0][0]*r,y.y=A[0][1]*r),0==S&&(U=$,g.L(f),b.L(y),0<a&&(z.u>a||3.141592653589793<=Math.abs(v.x-m.x)))){V=!0;break}if(I&&0<a){if(t.kb.wd(i,n,v.x,v.y,y.x,y.y,k,null,null,2),k.u>a||3.141592653589793<=Math.abs(v.x-y.x)){V=!0;break}}else if(0<h){if(I?(p.NS(u,d,D[S]),M?_.ma(p.x*r,p.y*r):(A[0][0]=p.x,A[0][1]=p.y,t.cb.vt(),_.x=A[0][0]*r,_.y=A[0][1]*r)):(p.L(f),_.L(y)),t.kb.wd(i,n,v.x,v.y,_.x,_.y,F,null,null,2),!(F.u<=z.u)){V=!0;break}if(t.kb.oj(i,n,v.x,v.y,F.u,j.u,w,x,2),T.ma(w.u,x.u),t.kb.wd(i,n,T.x,T.y,y.x,y.y,H,null,null,2),H.u>h){V=!0;break}if(I){if(t.kb.wd(i,n,T.x,T.y,_.x,_.y,B,null,null,2),B.u>h){V=!0;break}if(t.kb.wd(i,n,_.x,_.y,y.x,y.y,G,null,null,2),G.u>h){V=!0;break}}}}V?(d.L(g),m.L(b),R=U,e.up(E,d),e.up(P,m),N.add(R)):(e.hB(E),e.hB(P),N.En(N.size-1,1,N.size-1),e.Mf(c,d),C+=z.u,null!=l&&l.add(C),0<P.size&&(u.L(d),v.L(m),O=R,e.oB(E,d),e.oB(P,m),R=N.get(N.size-1)))}if(null!=l)for(i=1/C,S=0;S<l.size;S++)l.write(S,l.read(S)*i)},e.fC=function(t,e,i,n){n.reverse(),null!=i&&i.ni(0,i.size,1),i=null!=t?t[0]:NaN,n=null!=e?e[0]:NaN,null!=t&&(t[0]=n),null!=e&&(e[0]=i)},e.fJ=function(t,e,i,n,r){t?(n.L(i),r.L(e)):(n.L(e),r.L(i))},e.eJ=function(t,e,i){return t?(i.create(e.getType()),e.copyTo(i.get()),i.get().reverse(),i.get()):e},e.Wi=function(t,e,i){if(isNaN(e)){for(;3.141592653589793<i[0]-t;)i[0]-=6.283185307179586;for(;3.141592653589793<t-i[0];)i[0]+=6.283185307179586}else 3.141592653589793<i[0]+t-e?i[0]-=6.283185307179586:3.141592653589793<e-(i[0]+t)&&(i[0]+=6.283185307179586)},e.WW=function(t,e,i,n){3.141592653589793>Math.abs(e.x-t.x)?(n.Dc(t),3.141592653589793<=i.x-t.x?n.Ql(i.x-6.283185307179586,i.y):3.141592653589793<=t.x-i.x?n.Ql(i.x+6.283185307179586,i.y):n.Ql(i.x,i.y)):(n.Dc(i),3.141592653589793<=t.x-i.x?n.Ql(t.x-6.283185307179586,t.y):3.141592653589793<=i.x-t.x?n.Ql(t.x+6.283185307179586,t.y):n.Ql(t.x,t.y))},e.YJ=function(t,e){for(var i=0;i<t;i++){var n=Math.ceil(i/2)/(t+1);0!=i%2&&(n=-n),e[i]=.5+n}},e.Mu=function(e,i){return!!(t.s.Y(e.y,1.570796326794897)&&!t.s.Y(i.y,1.570796326794897)||t.s.Y(e.y,-1.570796326794897)&&!t.s.Y(i.y,-1.570796326794897))},e.Ku=function(e,i){return!!(t.s.Y(i.y,1.570796326794897)&&!t.s.Y(e.y,1.570796326794897)||t.s.Y(i.y,-1.570796326794897)&&!t.s.Y(e.y,-1.570796326794897))},e.FE=function(i,n,r){return!(!e.EE(i,n,r)||t.s.Y(i.y,1.570796326794897)||t.s.Y(i.y,-1.570796326794897)||t.s.Y(n.y,1.570796326794897)||t.s.Y(n.y,-1.570796326794897))},e.EE=function(t,e,i){return Math.abs(Math.abs(t.x-e.x)-3.141592653589793)<=i},e.Lu=function(e,i){return!!(t.s.Y(e.y,1.570796326794897)&&t.s.Y(i.y,1.570796326794897)||t.s.Y(e.y,-1.570796326794897)&&t.s.Y(i.y,-1.570796326794897))},e.kB=function(i,n,r,s){if(0<i.y){var o=new t.h;o.ma(n.x,1.570796326794897)}else(o=new t.h).ma(n.x,-1.570796326794897);t.s.Y(i.x,o.x)||t.s.Y(n.y,o.y)||(e.Mf(s,o),null!=r&&r.add(0))},e.iB=function(i,n,r,s){if(0<n.y){var o=new t.h;o.ma(i.x,1.570796326794897)}else(o=new t.h).ma(i.x,-1.570796326794897);t.s.Y(n.x,o.x)||t.s.Y(i.y,o.y)||(e.Mf(s,o),null!=r&&r.add(1))},e.jB=function(i,n,r,s,o,a,h){t.s.Cd(r)?(0<1.570796326794897-i.y&&((r=new t.h).ma(i.x,1.570796326794897),e.Mf(h,r),null!=a&&a.add(s)),0<1.570796326794897-n.y&&((r=new t.h).ma(n.x,1.570796326794897),e.Mf(h,r),null!=a&&a.add(s))):(0<1.570796326794897+i.y&&((r=new t.h).ma(i.x,-1.570796326794897),e.Mf(h,r),null!=a&&a.add(o)),0<1.570796326794897+n.y&&((r=new t.h).ma(n.x,-1.570796326794897),e.Mf(h,r),null!=a&&a.add(o)))},e.AU=function(t){if(-3.141592653589793>t.x)for(;-3.141592653589793>t.x;)t.x+=6.283185307179586;if(3.141592653589793<t.x)for(;3.141592653589793<t.x;)t.x-=6.283185307179586},e}();t.cj=e}(X||(X={})),function(t){t.ip=function(){function e(){}return e.nj=function(i,n,r){if(null==i||null==n||!t.cb.Wc(n))throw t.i.N();if(i.B())return i;var s=i,o=s.getType();if(t.aa.Hc(o)){s=t.Hh.lj(i,n),i=new t.l,s.A(i),o=t.ta.Wd(n,i,!1);for(var a=t.cb.gh(n),h=Math.floor((i.v-a.v)/a.R())*a.R()+a.v;h<i.C;)h>i.v+o&&h<i.C-o&&(s=t.Hh.ks(s,n,r,!0,h)),h+=a.R()}else{if(197==o)return(i=new t.Da(s.description)).ad(s,!1),e.nj(i,n,r);if(t.aa.yd(o))return(i=new t.Ta(s.description)).oc(s,!0),e.nj(i,n,r)}return e.Uy(s,n)},e.Uy=function(i,n){if(null==i||null==n||!t.cb.Wc(n))throw t.i.N();if(i.B())return i;var r=i.getType();return 197==r?(r=new t.Da(i.description)).ad(i,!1):t.aa.yd(r)?(r=new t.Ta(i.description)).oc(i,!0):r=i,(r=t.Hh.lj(r,n)).B()?r:1==t.Eg.Sb(n)?t.Hh.Fn(r,n,0,r!=i,0):e.NQ(r,n,r!=i)},e.NQ=function(e,i,n){if(!t.cb.Wc(i))throw t.i.N();if(e.B())return e;var r=t.cb.bf(i),s=-180*r;return r*=360,2==t.Eg.Sb(i)&&(r=(s=t.cb.gh(i)).C,r-=s=s.v),t.Hh.Hp(e,s,r,i,n,0,!0)},e}()}(X||(X={})),function(t){t.BY=function(){function t(){}return t.P=function(t){return 0>t?-t:t},t.Mb=function(e,i){return 0<=i?t.P(e):-t.P(e)},t.Y=function(e,i){return e==i||t.P(e-i)<=t.JC*(1+(t.P(e)+t.P(i))/2)},t.Cd=function(e){return 0==e||t.P(e)<=t.JC},t.Ah=function(e,i){var n=(i=(1-(i=Math.sqrt(1-i)))/(1+i))*i;return e/(1+i)*(1+n*(.25+n*(.015625+1/256*n)))*t.EL},t.EL=1.5707963267948966,t.JC=3552713678800501e-30,t}()}(X||(X={})),function(t){var e=function(t){this.Wf=t,this.Kk=this.Wf.getCode(),0>this.Kk&&(this.Kk=0)};t.DY=e;var i=function(){function i(t){void 0===t&&(t=null),this.Cj=null,this.Un=!1,null!==t&&(this.Cj=new e(t))}return i.prototype.Ec=function(){return null!=this.Cj?this.Cj.Kk:0},i.prototype.Of=function(){var t=new i;return this.copyTo(t),t},i.prototype.copyTo=function(t){t.Cj=this.Cj,t.Un=this.Un},i.prototype.Qz=function(){this.Un=!this.Un},i.prototype.qm=function(){return null!=this.Cj?this.Cj.Wf:null},i.prototype.LJ=function(i){if(0>=i)throw t.i.N();if(i!=this.Ec()){if(null==(i=t.pf.geogtran(i)))throw t.i.N("Geogtran not found.");this.Cj=new e(i)}},i.prototype.Bz=function(){return null==this.Cj?null:this.Cj.Wf.toString()},i.prototype.tX=function(i){if(null==i)throw t.i.N();var n=null;try{n=t.pf.fromString(t.Sc.PE_TYPE_GEOGTRAN,i)}catch(e){throw t.i.N()}this.Cj=new e(n)},i.prototype.Nb=function(t){return t==this||!(!(t instanceof i)||(0>=this.Ec()||this.Ec()!=t.Ec())&&!this.qm().isEqual(t.qm()))&&this.Un==t.Un},i.prototype.toString=function(){var t="GeographicTransformation: "+this.Bz();return 200<t.length?t.substring(0,197)+"... ("+t.length.toString()+" characters)":t},i.create=function(t,e){var n=new i;return n.LJ(t),e&&n.Qz(),n},i.uP=function(t,e){var n=new i;return n.tX(t),e&&n.Qz(),n},i}();t.Dx=i}(X||(X={})),function(t){var e=function(){function t(){}return t.construct=function(e,i,n,r){var s=new t;return s.hw=e,s.iw=i,s.QY=n,s.RY=r,s},t.Ey=function(t,e){return t.hw==e.hw?t.iw==e.iw?0:t.iw<e.iw?-1:1:t.hw<e.hw?-1:1},t}(),i=function(){function t(){this.yT=[],this.zT=[],this.qp()}return t.kz=function(){return null==t.jK&&(t.jK=new t),t.jK},t.prototype.qp=function(){this.iD(this.yT),this.iD(this.zT)},t.prototype.iD=function(t){try{var i=[];i=i.sort(e.Ey);for(var n=0;n<i.length;n++)t.push(i[n])}catch(t){}},t}();t.CY=i}(X||(X={})),function(t){var e=function(){function t(){}return t.prototype.yD=function(t){this.Fk=t},t.prototype.WM=function(t){this.Fb=t},t.prototype.xD=function(t){this.zo=t},t.CE=function(t){return!(t.B()||1607!=t.getType()&&1736!=t.getType())},t.AE=function(t){return!(t.B()||1607!=t.getType()&&1736!=t.getType()||20>t.I())},t.BE=function(t){return!(t.B()||1607!=t.getType()&&1736!=t.getType()||20>t.I())},t}();t.Uk=e}(X||(X={})),function(t){t.$b=function(){function e(){}return e.TT=function(e){var i=new t.Da;return i.sx(e.es(),e.gs()),i.yj(e.es(),e.fs()),i.yj(e.ds(),e.fs()),i.yj(e.ds(),e.gs()),i},e.zh=function(e,i){return null===e?null:t.Hx.local().V(e,i,null)},e.jY=function(e,i){var n=t.Gh.local();return e=new t.Zc(e),n.V(e,i,null).next()},e.im=function(e,i,n){return t.kp.local().V(e,i,n,null)},e.ep=function(e,i,n){return t.Kx.local().V(e,i,n,null)},e.VX=function(e,i,n){var r=t.Kx.local();for(e=new t.Zc(e),i=new t.Zc(i),n=r.V(e,i,n,null),r=[];null!=(i=n.next());)r.push(i);return r},e.Nb=function(e,i,n){return t.dj.local().V(3,e,i,n,null)},e.TP=function(e,i,n){return t.dj.local().V(4,e,i,n,null)},e.RS=function(e,i,n){var r=t.Xj.local();for(e=new t.Zc(e),i=new t.Zc(i),n=r.V(e,i,n,null),r=[];null!=(i=n.next());)r.push(i);return r},e.QP=function(e,i,n){var r=t.kp.local();for(e=new t.Zc(e),i=new t.Zc(i),n=r.V(e,i,n,null),r=[];null!=(i=n.next());)r.push(i);return r},e.Ea=function(e,i,n){return t.Xj.local().V(e,i,n,null)},e.QS=function(e,i,n){if(null===(e=t.Xj.local().V(e,i,n,null,1)))return[];if(550===e.getType()){for(i=[],n=0;n<e.wa;n++)i.push(e.KR(n));return i}return 33===e.getType()?[e]:[]},e.qY=function(e,i,n){return t.dj.local().V(2,e,i,n,null)},e.contains=function(e,i,n){return t.dj.local().V(1,e,i,n,null)},e.BP=function(e,i,n){return t.dj.local().V(16,e,i,n,null)},e.touches=function(e,i,n){return t.dj.local().V(8,e,i,n,null)},e.DU=function(e,i,n){return t.dj.local().V(32,e,i,n,null)},e.TS=function(e,i,n){return t.dj.local().V(1073741824,e,i,n,null)},e.yB=function(e,i,n,r){return t.zL.local().V(e,i,n,r,null)},e.tb=function(e,i,n,r){var s=null;if(null!=n){if(s=n.Hd(),null!=r&&s.Ec()!=r.Ec()&&s.od!=r.od)throw t.i.Xk()}else if(null!=r)throw t.i.N();return e=t.rL.local().V(e,i,null),null!==s&&null!==r&&(e=t.Tc.Nh(e,s,r)),e},e.clip=function(e,i,n){return t.kL.local().V(e,t.l.construct(i.es(),i.gs(),i.ds(),i.fs()),n,null)},e.dl=function(e,i,n){if(null==e||null==i)return null;for(e=t.mL.local().V(!0,e,i,n,null),i=[];null!=(n=e.next());)n.B()||i.push(n);return i.slice(0)},e.MN=function(i,n,r,s,o,a,h,l){if(!0===o)return e.NN(i,n,r,s,a,h,l);if(o=r,null!=n){if(h=n.Hd(),null!=s&&h.Ec()!=s.Ec()){if(h.od!=s.od)throw t.i.Xk();o=[],t.Tc.XE(r,r.length,s,h,o)}}else if(null!=s)throw t.i.N();if(r=t.AC.local(),a){for(i=new t.Zc(i),n=r.V(i,n,o,a,null),i=[];null!=(a=n.next());)i.push(a);a=i.slice(0)}else for(a=[],s=0;s<i.length;s++)a[s]=r.V(i[s],n,o[s],null);return a},e.NN=function(e,i,n,r,s,o,a){if(null===i)throw t.i.N();if(null==r&&(r=4326!==i.Ec()?i.Hd():t.Tc.Zg(9001)),0!==r.od)throw t.i.N();if(t.Tc.XE(n,n.length,r,t.Tc.Zg(9001),n),r=t.FC.local(),s){for(e=new t.Zc(e),i=r.V(e,i,o,n,a,!1,s,null),n=[];null!=(o=i.next());)n.push(o);s=n.slice(0)}else{s=[];for(var h=0;h<e.length;h++)s[h]=r.V(e[h],i,o,n[h],a,!1,null)}return s},e.buffer=function(e,i,n,r,s,o,a){var h=n;if(!1===s){if(null!=i){if(s=i.Hd(),null!=r&&s.Ec()!=r.Ec()){if(s.od!=r.od)throw t.i.Xk();h=t.Tc.Nh(n,r,s)}}else if(null!=r)throw t.i.N();e=t.AC.local().V(e,i,h,null)}else{if(null===i)throw t.i.N();if(null==r&&(r=4326!==i.Ec()?i.Hd():t.Tc.Zg(9001)),0!==r.od)throw t.i.N();h=t.Tc.Nh(n,r,t.Tc.Zg(9001)),e=t.FC.local().V(e,i,o,h,a,!1,null)}return e},e.BU=function(e,i,n,r,s,o,a){if(null!=i){var h=i.Hd();if(null!=a&&h.Ec()!=a.Ec()){if(h.od!=a.od)throw t.i.Xk();n=t.Tc.Nh(n,a,h)}}else if(null!=a)throw t.i.N();for(e=new t.Zc(e),i=t.IC.local().V(e,i,n,r,s,o,null),n=[];null!=(r=i.next());)n.push(r);return n.slice(0)},e.offset=function(e,i,n,r,s,o,a){if(null!=i){var h=i.Hd();if(null!=a&&h.Ec()!=a.Ec()){if(h.od!=a.od)throw t.i.Xk();n=t.Tc.Nh(n,a,h)}}else if(null!=a)throw t.i.N();return t.IC.local().V(e,i,n,r,s,o,null)},e.iP=function(e){return t.CC.local().V(e,null)},e.jP=function(e,i){var n=t.CC.local();for(e=new t.Zc(e),i=n.V(e,i,null),n=[];null!=(e=i.next());)n.push(e);return n},e.nz=function(e,i,n){return t.Ix.local().nz(e,i,n)},e.oz=function(e,i){return t.Ix.local().oz(e,i)},e.pz=function(e,i,n,r){return t.Ix.local().pz(e,i,n,r)},e.eC=function(e,i){return t.Yl.local().V(e,i,!1,null)},e.dT=function(e,i){return t.Yl.local().rs(e,i,null)},e.QQ=function(e,i,n,r,s){var o=t.EC.local();if(null!=i){if(i=i.Hd(),null!=s&&i.Ec()!=s.Ec()){if(i.od!=s.od)throw t.i.Xk();n=t.Tc.Nh(n,s,i)}}else if(null!=s)throw t.i.N();return o.V(e,n,r,null)},e.Qr=function(e,i,n,r){var s=t.Xl.local();if(null!=i){if(i=i.Hd(),null!=r&&i.Ec()!=r.Ec()){if(i.od!=r.od)throw t.i.Xk();n=t.Tc.Nh(n,r,i)}}else if(null!=r)throw t.i.N();return s.V(e,n,null)},e.Wy=function(e,i,n,r,s){void 0===s&&(s=0);var o=t.tL.local();if(4==s)throw t.i.Ie();if(0!==s)throw t.i.Ie();if(null!==r){if(0!==r.od)throw t.i.N("Unit must be a linear unit type");n=t.Tc.Nh(n,r,t.Tc.Zg(9001))}return o.V(e,n,i,s,null)},e.WQ=function(i,n,r,s){if(null===i)return 0;if(4==s)throw t.i.Ie();if(0!==s)throw t.i.Ie();if(197==i.getType())i=e.TT(i);else if(1736!=i.getType())return 0;if(s=t.cb.sc(n),i=t.cb.zh(i,n,s),i=t.UK.XQ([i])[0],null!==r){if(2!==r.od)throw t.i.N("Unit must be a area unit type");i=t.Tc.Nh(i,t.Tc.Zg(109404),r)}return i},e.ZQ=function(e,i,n,r){if(e=t.vL.local().V(e,i,r,null),null!==n){if(0!==n.od)throw t.i.N("Unit must be a linear unit type");e=t.Tc.Nh(e,t.Tc.Zg(9001),n)}return e},e.JU=function(e,i,n){if(null===e)return 0;var r=null;if(null!=i){if(0==(r=i.Hd()).od&&null==(r=t.Tc.aG(r))&&null!==n)throw t.i.N();if(null!=n&&r.Ec()!=n.Ec()&&r.od!=n.od)throw t.i.Xk()}else if(null!=n)throw t.i.N();return 1736==e.getType()||197==e.getType()?(e=e.Ke(),null!==n?t.Tc.Nh(e,r,n):e):0},e.KU=function(e,i,n){if(null===e||e.B()||1>e.Db())return 0;var r=null;if(null!=i){if(r=i.Hd(),null!=n&&r.Ec()!=n.Ec()&&r.od!=n.od)throw t.i.Xk()}else if(null!=n)throw t.i.N();1736==e.getType()||197==e.getType()?i=e.mg():t.aa.yd(e.getType())?(i=new t.Ta(e.description)).oc(e,!0):i=e,e=0,i=i.Ga();for(var s=new t.h,o=new t.h;i.$a();)for(;i.Ha();){var a=i.ha();a.Yp(s),a.Tr(o),e+=t.h.tb(s,o)}return null!==r&&null!==n&&(e=t.Tc.Nh(e,r,n)),e},e.fP=function(t){return void 0!==t.points?e.mS(t,void 0!==t.hasZ&&t.hasZ,void 0!==t.hasM&&t.hasM):void 0!==t.rings?e.lG(t.rings,void 0!==t.hasZ&&t.hasZ,void 0!==t.hasM&&t.hasM,"P"):void 0!==t.paths?e.lG(t.paths,void 0!==t.hasZ&&t.hasZ,void 0!==t.hasM&&t.hasM,"L"):void 0!==t.x?e.nS(t):void 0!==t.xmin?e.lS(t):null},e.nS=function(e){if(null==e.x||"NaN"==e.x)return new t.Sa;var i=new t.Sa(e.x,e.y);return void 0!==e.z&&null!==e.z&&i.wX(e.z),void 0!==e.m&&null!==e.m&&i.hX(e.m),i},e.lS=function(e){if(null==e.xmin||"NaN"==e.xmin)return new t.Fh;var i=new t.Fh(e.xmin,e.ymin,e.xmax,e.ymax);return void 0!==e.zmin&&null!==e.zmin&&i.setInterval(1,0,e.zmin,e.zmax),void 0!==e.mmin&&null!==e.mmin&&i.setInterval(2,0,e.mmin,e.mmax),i},e.mS=function(e,i,n){var r=0,s=new t.de,o=3*e.points.length;0!=o%2&&o++,2>o&&(o=2);var a=t.O.truncate(3*e.points.length/2);4>a?a=4:16>a&&(a=16),o=t.Yc.Dn(o,0);var h=t.Yc.Dn(a);a=t.Yc.Dn(a);for(var l=0;l<e.points.length;l++)o.write(2*l,e.points[l][0]),o.write(2*l+1,e.points[l][1]),h.write(l,i||n?e.points[l][2]:NaN),a.write(l,n&&i?e.points[l][3]:NaN),r++;return 0!=r&&(s.resize(r),s.hn(0,o)),i&&(s.re(1),s.hn(1,h)),n&&(s.re(2),s.hn(2,0==i?h:a)),s.Pc(16777215),s},e.lG=function(e,i,n,r){var s=0,o=2;if("P"==r){var a=new t.Da;s=1,o=3}else a=new t.Ta;for(var h=t.Yc.Oh(0),l=t.Yc.Mr(0),c=0,u=0,d=[],f=[],p=0;p<e.length;p++){var g=e[p].length;if(d[p]=!1,"P"===r&&e[p][0][0]===e[p][e[p].length-1][0]&&e[p][0][1]===e[p][e[p].length-1][1]){var v=0==n||e[p][0][3]===e[p][e[p].length-1][3]||void 0===e[p][0][3]&&void 0===e[p][e[p].length-1][3];(0==i||e[p][0][2]===e[p][e[p].length-1][2]||void 0===e[p][0][2]&&void 0===e[p][e[p].length-1][2])&&v&&(d[p]=!0,--g)}g>=o?(f[p]=!1,u+=1,h.add(c),l.add(s),c+=g):f[p]=!0}for(0!=(r=3*c)%2&&r++,2>r&&(r=2),4>(p=t.O.truncate(3*c/2))?p=4:16>p&&(p=16),r=t.Yc.Dn(r,0),s=t.Yc.Dn(p),o=t.Yc.Dn(p),p=g=0;p<e.length;p++)if(!1===f[p])for(v=0;v<e[p].length;v++){var m=!1;v===e[p].length-1&&!0===d[p]&&(m=!0),m||(r.write(2*g,e[p][v][0]),r.write(2*g+1,e[p][v][1]),s.write(g,i||n?e[p][v][2]:NaN),o.write(g,n&&i?e[p][v][3]:NaN),g++)}return 0!=c&&(e=a,h.resize(u),l.resize(u),0<c&&(h.add(c),l.add(0)),e.hn(0,r),e.PJ(l),e.QJ(h)),i&&(a.re(1),a.hn(1,s)),n&&(a.re(2),a.hn(2,0==i?s:o)),a.Pc(16777215),a},e}()}(X||(X={})),function(t){t.Ex=function(){function t(){}return t.br=function(t){var e,i=0,n=t.length,r=t[0];for(e=0;e<n-1;e++){var s=t[e+1];i+=(s[0]-r[0])*(s[1]+r[1]),r=s}return 0<=i},t.rotate=function(e,i,n){i=i*Math.PI/180;var r=Math.cos(i),s=Math.sin(i);if(void 0!==e.paths){i={paths:[]};for(var o=0;o<e.paths.length;o++){for(var a=e.paths[o],h=[],l=0;l<a.length;l++){var c=a[l].slice(0);h.push(c);var u=r*(a[l][0]-n.x)-s*(a[l][1]-n.y)+n.x,d=s*(a[l][0]-n.x)+r*(a[l][1]-n.y)+n.y;c[0]=u,c[1]=d}i.paths.push(h),void 0!==e.hasZ&&(i.hasZ=e.hasZ),void 0!==e.hasM&&(i.hasM=e.hasM)}return i}if(void 0!==e.rings){for(i={rings:[]},o=0;o<e.rings.length;o++){a=e.rings[o],h=[];var f=t.br(a);for(l=0;l<a.length;l++)c=a[l].slice(0),h.push(c),u=r*(a[l][0]-n.x)-s*(a[l][1]-n.y)+n.x,d=s*(a[l][0]-n.x)+r*(a[l][1]-n.y)+n.y,c[0]=u,c[1]=d;t.br(h)!==f&&h.reverse(),i.rings.push(h),void 0!==e.hasZ&&(i.hasZ=e.hasZ),void 0!==e.hasM&&(i.hasM=e.hasM)}return i}if(void 0!==e.x)return i={x:r*(e.x-n.x)-s*(e.y-n.y)+n.x,y:s*(e.x-n.x)+r*(e.y-n.y)+n.y},void 0!==e.z&&(i.z=e.z),void 0!==e.m&&(i.m=e.m),void 0!==e.hasZ&&(i.hasZ=e.hasZ),void 0!==e.hasM&&(i.hasM=e.hasM),i;if(void 0!==e.points){for(i={points:[]},o=e.points,l=0;l<o.length;l++)(a=o[l].slice(0))[0]=r*(o[l][0]-n.x)-s*(o[l][1]-n.y)+n.x,a[1]=s*(o[l][0]-n.x)+r*(o[l][1]-n.y)+n.y,i.points.push(a);return void 0!==e.hasZ&&(i.hasZ=e.hasZ),void 0!==e.hasM&&(i.hasM=e.hasM),i}return null},t.JQ=function(e,i){if(void 0!==e.paths){for(var n={paths:[]},r=0;r<e.paths.length;r++){for(var s=e.paths[r],o=[],a=0;a<s.length;a++){var h=s[a].slice(0);o.push(h);var l=i.x-s[a][0];h[0]=s[a][0]+2*l}n.paths.push(o)}return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}if(void 0!==e.rings){for(n={rings:[]},r=0;r<e.rings.length;r++){s=e.rings[r];var c=t.br(s);for(o=[],a=0;a<s.length;a++)h=s[a].slice(0),o.push(h),l=i.x-s[a][0],h[0]=s[a][0]+2*l;t.br(o)!==c&&o.reverse(),n.rings.push(o)}return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}if(void 0!==e.x)return l=i.x-e.x,n={x:e.x+2*l,y:e.y},void 0!==e.z&&(n.z=e.z),void 0!==e.m&&(n.m=e.m),void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n;if(void 0!==e.points){for(n={points:[]},r=e.points,a=0;a<r.length;a++)s=r[a].slice(0),l=i.x-s[0],s[0]+=2*l,n.points.push(s);return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}return void 0!==e.xmin?(n={v:e.xmin,G:e.ymin,C:e.xmax,H:e.ymax},void 0!==e.zmin&&(n.zmin=e.zmin,n.zmax=e.zmax),void 0!==e.mmin&&(n.mmin=e.mmin,n.mmax=e.mmax),l=i.x-e.xmin,n.xmax=e.xmin+2*l,l=i.x-e.xmax,n.xmin=e.xmax+2*l,void 0!==e.zmin&&(n.zmin=e.zmin),void 0!==e.zmax&&(n.zmax=e.zmax),void 0!==e.mmin&&(n.mmin=e.mmin),void 0!==e.mmax&&(n.mmax=e.mmax),void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n):null},t.KQ=function(e,i){if(void 0!==e.paths){for(var n={paths:[]},r=0;r<e.paths.length;r++){for(var s=e.paths[r],o=[],a=0;a<s.length;a++){var h=s[a].slice(0);o.push(h);var l=i.y-s[a][1];h[1]=s[a][1]+2*l}n.paths.push(o)}return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}if(void 0!==e.rings){for(n={rings:[]},r=0;r<e.rings.length;r++){s=e.rings[r];var c=t.br(s);for(o=[],a=0;a<s.length;a++)h=s[a].slice(0),o.push(h),l=i.y-s[a][1],h[1]=s[a][1]+2*l;t.br(o)!==c&&o.reverse(),n.rings.push(o)}return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}if(void 0!==e.x)return l=i.y-e.y,n={y:e.y+2*l,x:e.x},void 0!==e.z&&(n.z=e.z),void 0!==e.m&&(n.m=e.m),void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n;if(void 0!==e.points){for(n={points:[]},r=e.points,a=0;a<r.length;a++)s=r[a].slice(0),l=i.y-s[1],s[1]+=2*l,n.points.push(s);return void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n}return void 0!==e.xmin?(n={v:e.xmin,G:e.ymin,C:e.xmax,H:e.ymax},void 0!==e.zmin&&(n.zmin=e.zmin,n.zmax=e.zmax),void 0!==e.mmin&&(n.mmin=e.mmin,n.mmax=e.mmax),l=i.y-e.ymin,n.ymax=e.ymin+2*l,l=i.y-e.ymax,n.ymin=e.ymax+2*l,void 0!==e.zmin&&(n.zmin=e.zmin),void 0!==e.zmax&&(n.zmax=e.zmax),void 0!==e.mmin&&(n.mmin=e.mmin),void 0!==e.mmax&&(n.mmax=e.mmax),void 0!==e.hasZ&&(n.hasZ=e.hasZ),void 0!==e.hasM&&(n.hasM=e.hasM),n):null},t}()}(X||(X={})),function(t){t.ZK=function(){function e(){}return e.Ig=function(e,i){switch(null==i&&(i=t.ee.og()),e){case 33:return new t.Sa(i);case 322:return new t.yb(i);case 197:return new t.Fh(i);case 550:return new t.de(i);case 1607:return new t.Ta(i);case 1736:return new t.Da(i);default:throw t.i.fa("invalid argument.")}},e}()}(X||(X={})),function(t){var e=function(){function e(e,i){this.Te=t.ia.qf(e,-1),this.ua=new t.au,this.wl=i}return e.prototype.AW=function(t){this.ua.At(Math.min(this.Te.size,t)),this.ua.fn(t)},e.prototype.addElement=function(e,i){if(void 0===i)return this.eN(e);i=t.O.truncate(i%this.Te.size);var n=this.Te.get(i);return-1==n&&(n=this.ua.Ph(),this.Te.set(i,n)),this.ua.addElement(n,e)},e.prototype.eN=function(e){var i=this.wl.jz(e);i=t.O.truncate(i%this.Te.size);var n=this.Te.get(i);return-1==n&&(n=this.ua.Ph(),this.Te.set(i,n)),this.ua.addElement(n,e)},e.prototype.jd=function(e,i){if(void 0===i)this.KP(e);else{i=t.O.truncate(i%this.Te.size);var n=this.Te.get(i);if(-1==n)throw t.i.N();for(var r=this.ua.rc(n),s=-1;-1!=r;){var o=this.ua.lb(r);this.ua.ja(r)==e?(this.ua.jd(n,s,r),-1==this.ua.rc(n)&&(this.ua.bh(n),this.Te.set(i,-1))):s=r,r=o}}},e.prototype.KP=function(e){var i=this.wl.jz(e);i=t.O.truncate(i%this.Te.size);var n=this.Te.get(i);if(-1==n)throw t.i.N();for(var r=this.ua.rc(n),s=-1;-1!=r;){var o=this.ua.lb(r);this.ua.ja(r)==e?(this.ua.jd(n,s,r),-1==this.ua.rc(n)&&(this.ua.bh(n),this.Te.set(i,-1))):s=r,r=o}},e.prototype.rR=function(e){return e=t.O.truncate(e%this.Te.size),-1==(e=this.Te.get(e))?-1:this.ua.rc(e)},e.prototype.ER=function(t){return this.ua.lb(t)},e.prototype.vd=function(e){var i=this.wl.jz(this.ja(e));i=t.O.truncate(i%this.Te.size);var n=this.Te.get(i);if(-1==n)throw t.i.N();for(var r=this.ua.rc(n),s=-1;-1!=r;){if(r==e)return this.ua.jd(n,s,r),void(-1==this.ua.rc(n)&&(this.ua.bh(n),this.Te.set(i,-1)));s=r,r=this.ua.lb(r)}throw t.i.N()},e.prototype.ja=function(t){return this.ua.ja(t)},e.prototype.clear=function(){this.Te=t.ia.qf(this.Te.size,-1),this.ua.clear()},e.prototype.size=function(){return this.ua.TF()},e}();t.dL=e}(X||(X={})),function(t){var e=function(){function e(){this.Li=new t.$c(3),this.ua=new t.$c(6),this.sT=!1,this.je=-1}return e.prototype.fl=function(t){this.Li.jd(t)},e.prototype.Pw=function(){return this.Li.Ce()},e.prototype.bv=function(t){this.ua.jd(t)},e.prototype.$A=function(){return this.ua.Ce()},e.prototype.WB=function(t,e){this.Li.S(t,1,e)},e.prototype.ex=function(t,e){this.Li.S(t,2,e)},e.prototype.gX=function(t,e){this.Li.S(t,3,e)},e.prototype.UB=function(t,e){this.ua.S(t,4,e)},e.prototype.jX=function(t,e){this.ua.S(t,3,e)},e.prototype.TJ=function(t,e){this.ua.S(t,2,e)},e.prototype.Ph=function(t){var e=this.$A();return this.ua.S(e,3,this.je),this.ua.S(e,4,0),this.ua.S(e,5,t),-1!=this.je&&this.TJ(this.je,e),this.je=e},e.prototype.bh=function(t){this.LE(t);var e=this.ua.T(t,2),i=this.ua.T(t,3);return-1!=e?this.jX(e,i):this.je=i,-1!=i&&this.TJ(i,e),this.bv(t),i},e.prototype.At=function(t){this.ua.De(t)},e.prototype.PF=function(t){return this.ua.T(t,5)},e.prototype.fX=function(t,e){this.ua.S(t,5,e)},e.prototype.addElement=function(t,e){return this.tS(t,e)},e.prototype.tS=function(t,e){var i=this.Pw();this.ex(i,-1),-1==this.ua.T(t,0)&&this.ua.S(t,0,i);var n=this.ua.T(t,1);return this.WB(i,n),-1!=n&&this.ex(n,i),this.ua.S(t,1,i),this.setData(i,e),this.UB(t,this.bs(t)+1),this.sT&&this.gX(i,t),i},e.prototype.jd=function(t,e){var i=this.we(e),n=this.lb(e);return-1!=i?this.ex(i,n):this.ua.S(t,0,n),-1!=n?this.WB(n,i):this.ua.S(t,1,i),this.fl(e),this.UB(t,this.bs(t)-1),n},e.prototype.fn=function(t){this.Li.De(t)},e.prototype.getData=function(t){return this.Li.T(t,0)},e.prototype.setData=function(t,e){this.Li.S(t,0,e)},e.prototype.lb=function(t){return this.Li.T(t,2)},e.prototype.we=function(t){return this.Li.T(t,1)},e.prototype.rc=function(t){return this.ua.T(t,0)},e.prototype.Fc=function(t){return this.ua.T(t,1)},e.prototype.clear=function(){for(var t=this.je;-1!=t;)t=this.bh(t)},e.prototype.LE=function(t){for(var e=this.Fc(t);-1!=e;){var i=e;e=this.we(i),this.fl(i)}this.ua.S(t,0,-1),this.ua.S(t,1,-1),this.UB(t,0)},e.prototype.B=function(){return 0==this.Li.size},e.prototype.TF=function(){return this.Li.size},e.prototype.bs=function(t){return this.ua.T(t,4)},e.prototype.qz=function(t){return this.ua.T(t,3)},e}();t.jp=e}(X||(X={})),function(t){var e=function(){function e(e){void 0===e?(this.ug=new t.$c(2),this.ua=new t.$c(4),this.je=-1,this.Qv=!0):(this.ug=new t.$c(2),this.ua=new t.$c(e?4:2),this.je=-1,this.Qv=e)}return e.prototype.fl=function(t){this.ug.jd(t)},e.prototype.Pw=function(){return this.ug.Ce()},e.prototype.bv=function(t){this.ua.jd(t)},e.prototype.$A=function(){return this.ua.Ce()},e.prototype.Ph=function(){var t=this.$A();return this.Qv&&(this.ua.S(t,3,this.je),-1!=this.je&&this.ua.S(this.je,2,t),this.je=t),t},e.prototype.bh=function(t){for(var e=this.rc(t);-1!=e;){var i=e;e=this.lb(e),this.fl(i)}this.Qv&&(e=this.ua.T(t,2),i=this.ua.T(t,3),-1!=e?this.ua.S(e,3,i):this.je=i,-1!=i&&this.ua.S(i,2,e)),this.bv(t)},e.prototype.At=function(t){this.ua.De(t)},e.prototype.addElement=function(t,e){var i=this.ua.T(t,1),n=this.Pw();return-1!=i?this.ug.S(i,1,n):this.ua.S(t,0,n),this.ua.S(t,1,n),this.ug.S(n,0,e),n},e.prototype.fn=function(t){this.ug.De(t)},e.prototype.jd=function(t,e,i){-1!=e?(this.ug.S(e,1,this.ug.T(i,1)),this.ua.T(t,1)==i&&this.ua.S(t,1,e)):(this.ua.S(t,0,this.ug.T(i,1)),this.ua.T(t,1)==i&&this.ua.S(t,1,-1)),this.fl(i)},e.prototype.Hy=function(t,e){var i=this.ua.T(t,1),n=this.ua.T(e,0);-1!=n&&(-1!=i?this.ug.S(i,1,n):this.ua.S(t,0,n),this.ua.S(t,1,this.ua.T(e,1))),this.Qv&&(t=this.ua.T(e,2),i=this.ua.T(e,3),-1!=t?this.ua.S(t,3,i):this.je=i,-1!=i&&this.ua.S(i,2,t)),this.bv(e)},e.prototype.ja=function(t){return this.ug.T(t,0)},e.prototype.Sj=function(t,e){this.ug.S(t,0,e)},e.prototype.lb=function(t){return this.ug.T(t,1)},e.prototype.rc=function(t){return this.ua.T(t,0)},e.prototype.Jn=function(t){return this.ja(this.rc(t))},e.prototype.clear=function(){this.ug.mj(!0),this.ua.mj(!0),this.je=-1},e.prototype.B=function(){return 0==this.ug.size},e.prototype.TF=function(){return this.ug.size},e.prototype.qz=function(t){return this.ua.T(t,3)},e}();t.au=e}(X||(X={})),function(t){t.ta=function(){function e(){}return e.Wd=function(t,e,i){return e=e.xr(),t=null!=t&&void 0!==t.Xd?t.Xd(0):0,i&&(e*=4,t*=1.1),Math.max(t,e)},e.Er=function(t){return 2*Math.sqrt(2)*t},e.rN=function(t){return Math.sqrt(2)*t},e.kj=function(i,n,r){var s=new t.l;return n.A(s),e.Wd(i,s,r)},e.wE=function(t,e,i){return e=e.Tg(1,0).xr(),t=null!=t?t.Xd(1):0,i&&(e*=4,t*=1.1),Math.max(t,e)},e.mv=function(e,i){var n=new t.l;return e.xc(n),e=new t.l,i.xc(e),n.Zb(e),n},e.YN=function(e){var i=new t.l;if(e.xc(i),i.B())return null;var n=new t.du(i,8),r=-1,s=new t.l,o=!1;do{for(var a=0,h=e.da();a<h;a++){if(e.Rj(a,s),-1==(r=n.Jz(a,s,r))){if(o)throw t.i.fa("internal error");e.yp(i,!1),o=!0,n.reset(i,8);break}o=!1}}while(o);return n},e.nE=function(e){var i=new t.l;e.xc(i);for(var n=new t.du(i,8),r=-1,s=e.Ga(),o=new t.l,a=!1;s.$a();)for(;s.Ha();){var h=s.ha(),l=s.wb();if(h.A(o),-1==(r=n.Jz(l,o,r))){if(a)throw t.i.Qa();e.yp(i,!1),a=!0,n.reset(i,8),s.Zi();break}}return n},e.jj=function(e,i){var n=new t.l;e.xc(n);for(var r=new t.du(n,8),s=-1,o=new t.l,a=e.Ga(),h=!1;a.$a();)for(;a.Ha();){var l=a.ha(),c=a.wb();if(l.A(o),o.isIntersecting(i)&&-1==(s=r.Jz(c,o,s))){if(h)throw t.i.fa("internal error.");e.yp(n,!1),h=!0,r.reset(n,8),a.Zi();break}}return r},e.oE=function(e,i){for(var n=new t.du(i,8),r=new t.h,s=!1,o=new t.l,a=0;a<e.I();a++)if(e.D(a,r),i.contains(r)&&(o.K(r),-1==n.vj(a,o))){if(s)throw t.i.Qa();s=!0,a=new t.l,e.yp(a,!1),n.reset(a,8),a=-1}return n},e.lR=function(e,i,n){var r=new t.l,s=new t.l;e.xc(r),i.xc(s),r.W(n,n),s.W(n,n);var o=new t.l;o.K(r),o.Ea(s),e=e.Ga(),i=i.Ga();var a=new t.xC;a.aC(n);var h=!1;for(a.pK();e.$a();)for(;e.Ha();)e.ha().A(r),r.isIntersecting(o)&&(h=!0,(n=new t.l).K(r),a.JD(e.wb(),n));if(a.iF(),!h)return null;for(r=!1,a.oK();i.$a();)for(;i.Ha();)i.ha().A(s),s.isIntersecting(o)&&(r=!0,(n=new t.l).K(s),a.ED(i.wb(),n));return a.hF(),r?a:null},e.mR=function(e,i,n,r,s){var o=e.getType(),a=i.getType(),h=new t.l,l=new t.l;e.xc(h),i.xc(l),h.W(n,n),l.W(n,n);var c=new t.l;c.K(h),c.Ea(l);var u=new t.xC;u.aC(n);var d=!1;u.pK();var f=0;for(n=e.da();f<n;f++)r&&1736==o&&!e.Ev(f)||(e.Rj(f,h),h.isIntersecting(c)&&(d=!0,u.JD(f,h)));if(u.iF(),!d)return null;for(e=!1,u.oK(),r=0,n=i.da();r<n;r++)s&&1736==a&&!i.Ev(r)||(i.Rj(r,l),l.isIntersecting(c)&&(e=!0,u.ED(r,l)));return u.hF(),e?u:null},e.Ru=function(e,i,n){if(e!=i)for(var r=0;r<n;r++)null==e[r]?e[r]=t.h.al(i[r]):e[r].L(i[r])},e.Jy=function(t,e,i,n){var r=0;for(n+=0;r<n;i++,r++)null==t[r]&&(t[r]=[0,0]),t[r][0]=e[i].x,t[r][1]=e[i].y},e.Iy=function(e,i,n,r){var s=i,o=0;for(i=r+i;s<i;o++,s++)null==e[s]?e[s]=t.h.construct(n[o][0],n[o][1]):e[s].ma(n[o][0],n[o][1])},e.kP=function(e,i,n){if(e!=i)for(var r=0;r<n;r++)null==e[r]?e[r]=new t.Sa(i[r]):i[r].copyTo(e[r])},e.vE=function(t,e,i,n){var r=0;return null!=t&&(r=t.Xd(0),n&&!i||null==t||(r+=1.01*t.vz(0))),i&&(e*=4,r*=1.01),Math.max(r,e)},e.ty=function(t,i,n){return e.vE(t,i.xr(),n,!1)},e.gO=function(i,n){var r=new t.l;return n.A(r),e.ty(i,r,!0)},e.uy=function(t,i){return e.vE(t,i.xr(),!1,!0)},e.Hu=function(i,n){var r=new t.l;return n.A(r),e.uy(i,r)},e.AG=function(e,i,n,r){r*=r;var s=new t.h;if(s.uc(e,i),(e=new t.h).uc(n,i),i=s.Sk(),n=e.Sk(),i<=r&&n<=r)return!0;var o=t.lc.ox(s.wi(e));return(o<=r*i||o<=r*n)&&0<=s.Qh(e)},e.dK=function(e,i,n,r){for(var s=0;s<i;s++){var o=e[s].y,a=t.O.Rk(o,n,r);a!=o&&(e[s].y=a)}},e}()}(X||(X={})),function(t){var e,i,n=function(){function t(t){this.Ya=t}return t.prototype.compare=function(t,e,i){t=t.ja(i),i=this.Ya.nk(e);var n=this.Ya.nk(t);return i<n?-1:i==n?o.gq(e)&&o.Gv(t)?-1:o.gq(t)&&o.Gv(e)?1:0:1},t}(),r=function(){function t(t){this.Ya=t}return t.prototype.nr=function(t,e,i){this.Ya.GX(i,t,e)},t.prototype.$p=function(t){return this.Ya.nk(t)},t}();(i=e||(e={}))[i.initialize=0]="initialize",i[i.pIn=1]="pIn",i[i.pL=2]="pL",i[i.pR=3]="pR",i[i.pT=4]="pT",i[i.right=5]="right",i[i.left=6]="left",i[i.all=7]="all";var s=function(){function e(){this.Ya=null,this.Qi=new t.Nc,this.hi=new t.ia(0),this.sg=[0,0]}return e.prototype.Xi=function(t,e){this.Qi.oa=t.oa-e,this.Qi.va=t.va+e,this.hi.resize(0),this.he=0,this.sg[0]=0},e.prototype.EB=function(e,i,n){if(e>i)throw t.i.N();this.Qi.oa=e-n,this.Qi.va=i+n,this.hi.resize(0),this.he=0,this.sg[0]=0},e.prototype.Uo=function(t,e){this.Qi.oa=t-e,this.Qi.va=t+e,this.hi.resize(0),this.he=0,this.sg[0]=0},e.prototype.next=function(){if(!this.Ya.lq)throw t.i.Hb();if(0>this.he)return-1;for(var e=!0;e;)switch(this.sg[this.he]){case 1:e=this.FU();break;case 2:e=this.GU();break;case 3:e=this.HU();break;case 4:e=this.IU();break;case 5:e=this.GW();break;case 6:e=this.kT();break;case 7:e=this.tN();break;case 0:e=this.Gz();break;default:throw t.i.Qa()}return-1!=this.Og?this.Mp()>>1:-1},e.construct=function(t){var i=new e;return i.Ya=t,i.hi.Jb(20),i.he=-1,i},e.prototype.Gz=function(){return this.Og=this.vH=this.Mi=this.Lc=-1,null!=this.Ya.me&&0<this.Ya.me.size?(this.sg[0]=1,this.Mi=this.Ya.kf,!0):(this.he=-1,!1)},e.prototype.FU=function(){if(this.Lc=this.Mi,-1==this.Lc)return this.Og=this.he=-1,!1;var t=this.Ya.Np(this.Lc);return this.Qi.va<t?(t=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=6),!0):t<this.Qi.oa?(t=this.Ya.mk(this.Lc),this.Mi=this.Ya.lk(this.Lc),-1!=t&&(this.ei=this.Ya.Zr(t),this.sg[++this.he]=5),!0):(this.sg[this.he]=2,this.vH=this.Lc,t=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=7),!0)},e.prototype.GU=function(){if(this.Lc=this.Mi,-1==this.Lc)return this.sg[this.he]=3,this.Mi=this.Ya.lk(this.vH),!0;if(this.Ya.Np(this.Lc)<this.Qi.oa){var t=this.Ya.mk(this.Lc);return this.Mi=this.Ya.lk(this.Lc),-1!=t&&(this.ei=this.Ya.Zr(t),this.sg[++this.he]=5),!0}return t=this.Ya.mk(this.Lc),this.Mi=this.Ya.qj(this.Lc),-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=7),-1!=(t=this.Ya.lk(this.Lc))&&this.hi.add(t),!0},e.prototype.HU=function(){if(this.Lc=this.Mi,-1==this.Lc)return this.sg[this.he]=4,!0;if(this.Qi.va<this.Ya.Np(this.Lc)){var t=this.Ya.mk(this.Lc);return this.Mi=this.Ya.qj(this.Lc),-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=6),!0}return t=this.Ya.mk(this.Lc),this.Mi=this.Ya.lk(this.Lc),-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=7),-1!=(t=this.Ya.qj(this.Lc))&&this.hi.add(t),!0},e.prototype.IU=function(){if(0==this.hi.size)return this.Og=this.he=-1,!1;this.Lc=this.hi.get(this.hi.size-1),this.hi.resize(this.hi.size-1);var t=this.Ya.mk(this.Lc);return-1!=t&&(this.ei=this.Ya.kl(t),this.sg[++this.he]=7),-1!=this.Ya.qj(this.Lc)&&this.hi.add(this.Ya.qj(this.Lc)),-1!=this.Ya.lk(this.Lc)&&this.hi.add(this.Ya.lk(this.Lc)),!0},e.prototype.kT=function(){return this.Og=this.ei,-1!=this.Og&&o.gq(this.Mp())&&this.Ya.nk(this.Mp())<=this.Qi.va?(this.ei=this.SF(),!1):(this.he--,!0)},e.prototype.GW=function(){return this.Og=this.ei,-1!=this.Og&&o.Gv(this.Mp())&&this.Ya.nk(this.Mp())>=this.Qi.oa?(this.ei=this.QR(),!1):(this.he--,!0)},e.prototype.tN=function(){return this.Og=this.ei,-1!=this.Og&&o.gq(this.Mp())?(this.ei=this.SF(),!1):(this.he--,!0)},e.prototype.SF=function(){return this.Ya.Sf?this.Ya.$f.lb(this.Og):this.Ya.Ti.lb(this.Og)},e.prototype.QR=function(){return this.Ya.Sf?this.Ya.$f.we(this.Og):this.Ya.Ti.we(this.Og)},e.prototype.Mp=function(){return this.Ya.Sf?this.Ya.$f.ja(this.Og):this.Ya.Ti.getData(this.Og)},e}();t.EY=s;var o=function(){function e(t){this.Am=this.$h=this.$f=this.Ti=this.Km=this.Ej=this.me=this.Fj=null,this.Sf=t,this.lq=this.Sv=!1}return e.prototype.kr=function(){this.Nk(!0)},e.prototype.Br=function(e,i){if(!this.Sv)throw t.i.Hb();this.Fj.push(new t.Nc(e,i))},e.prototype.Fp=function(){if(!this.Sv)throw t.i.fa("invalid call");this.Sv=!1,this.lq=!0,this.Sf||(this.vS(),this.Zv=this.Fj.length)},e.prototype.vj=function(e){if(!this.Sf||!this.lq)throw t.i.N("invalid call");if(-1==this.kf){var i=this.Fj.length;if(this.iA){var n=new t.ia(0);n.Jb(2*i),this.bJ(n),this.$h.Jb(2*i),this.$h.resize(0),this.aJ(n),this.Km.resize(i,-1),this.Km.Wj(-1,0,i),this.iA=!1}else this.Km.Wj(-1,0,i);this.kf=this.Tu()}i=this.pG(e<<1,this.kf),n=this.$f.addElement(1+(e<<1),this.xz(i)),this.VJ(i,n),this.Km.set(e,i),this.Zv++},e.prototype.remove=function(e){if(!this.Sf||!this.lq)throw t.i.fa("invalid call");var i=this.Km.get(e);if(-1==i)throw t.i.N("the interval does not exist in the interval tree");this.Km.set(e,-1),this.Zv--;var n=this.xz(i),r=this.$f.ZR(n);this.$f.vd(this.wR(i),n),this.$f.vd(this.TR(i),n),0==(e=this.$f.size(n))&&(this.$f.MP(n),this.ZJ(r,-1)),this.Ej.jd(i),n=this.UF(r);var s=this.qj(r),o=this.lk(r);for(i=0;!(0<e||r==this.kf||-1!=s&&-1!=o);)r==this.qj(n)?-1!=s?(this.Ok(n,s),this.Uj(s,n),this.Ok(r,-1)):-1!=o?(this.Ok(n,o),this.Uj(o,n),this.Qk(r,-1)):this.Ok(n,-1):-1!=s?(this.Qk(n,s),this.Uj(s,n),this.Ok(r,-1)):-1!=o?(this.Qk(n,o),this.Uj(o,n),this.Qk(r,-1)):this.Qk(n,-1),this.Uj(r,-1),i++,r=n,e=-1!=(n=this.mk(r))?this.$f.size(n):0,s=this.qj(r),o=this.lk(r),n=this.UF(r)},e.prototype.reset=function(){if(!this.Sf||!this.lq)throw t.i.N("invalid call");this.Nk(!1)},e.prototype.size=function(){return this.Zv},e.prototype.getIterator=function(){return s.construct(this)},e.prototype.bJ=function(t){for(var e=this.Fj.length,i=0;i<2*e;i++)t.add(i);this.HX(t,2*e)},e.prototype.aJ=function(t){for(var e=NaN,i=0;i<t.size;i++){var n=t.get(i),r=this.nk(n);r!=e&&(this.$h.add(n),e=r)}},e.prototype.vS=function(){var e=this.Fj.length,i=new t.ia(0);i.Jb(2*e),this.bJ(i),this.$h.Jb(2*e),this.$h.resize(0),this.aJ(i),this.Ej.De(e),this.Ti.fn(2*e);var n=t.Yc.Oh(e);for(n.Wj(-1,0,e),this.kf=this.Tu(),e=0;e<i.size;e++){var r=i.get(e),s=n.get(r>>1);-1!=s?this.VJ(s,this.Ti.addElement(this.xz(s),r)):(s=this.pG(r,this.kf),n.set(r>>1,s))}},e.prototype.pG=function(e,i){var n=i,r=i,s=-1,o=0,a=this.$h.size-1,h=0,l=e>>1,c=NaN,u=NaN,d=!0,f=this.DR(l);for(l=this.AR(l);d;){o<a?(h=o+t.O.truncate((a-o)/2),-1==this.gz(n)&&this.FJ(n,this.$h.get(h),this.$h.get(h+1))):-1==this.gz(n)&&this.FJ(n,this.$h.get(o),this.$h.get(o));var p=this.Np(n);if(l<p)-1!=i&&(i==n?(r=n,c=p,u=-1!=(i=this.qj(n))?this.Np(i):NaN):u>p&&(p<c?this.Ok(r,n):this.Qk(r,n),this.Qk(n,i),this.Sf&&(this.Uj(n,r),this.Uj(i,n)),r=n,c=p,i=-1,u=NaN)),-1==(a=this.xR(n))&&(a=this.Tu(),this.dX(n,a)),n=a,a=h;else if(f>p)-1!=i&&(i==n?(r=n,c=p,u=-1!=(i=this.lk(n))?this.Np(i):NaN):u<p&&(p<c?this.Ok(r,n):this.Qk(r,n),this.Ok(n,i),this.Sf&&(this.Uj(n,r),this.Uj(i,n)),r=n,c=p,i=-1,u=NaN)),-1==(o=this.UR(n))&&(o=this.Tu(),this.oX(n,o)),n=o,o=h+1;else{-1==(d=this.mk(n))&&(d=this.zP(n),this.ZJ(n,d));var g=this.fN(d,e);s=this.xP(),this.qX(s,d),this.cX(s,g),n!=i&&(p<c?this.Ok(r,n):this.Qk(r,n),this.Sf&&this.Uj(n,r),-1!=i&&(u<p?this.Ok(n,i):this.Qk(n,i),this.Sf&&this.Uj(i,n))),d=!1}}return s},e.prototype.Tu=function(){return this.me.Ce()},e.prototype.zP=function(t){return this.Sf?this.$f.Pr(t):this.Ti.Ph(t)},e.prototype.xP=function(){return this.Ej.Ce()},e.prototype.Nk=function(e){e?(this.Sv=this.iA=!0,this.lq=!1,null==this.$h?this.$h=t.Yc.Oh(0):this.$h.resize(0),null==this.Fj?this.Fj=[]:this.Fj.length=0):this.iA=!1,this.Sf?null==this.Km?(this.Km=t.Yc.Oh(0),this.$f=new t.Yj,this.$f.Vo(new n(this))):this.$f.clear():null==this.Ti?this.Ti=new t.jp:this.Ti.clear(),null==this.me?(this.Ej=new t.$c(3),this.me=new t.$c(this.Sf?8:7)):(this.Ej.mj(!1),this.me.mj(!1)),this.kf=-1,this.Zv=0},e.prototype.FJ=function(t,e,i){this.XW(t,e),this.YW(t,i)},e.prototype.Np=function(t){var e=this.gz(t);return-1==e?NaN:(e=this.nk(e))==(t=this.nk(this.gR(t)))?e:.5*(e+t)},e.prototype.XW=function(t,e){this.me.S(t,0,e)},e.prototype.YW=function(t,e){this.me.S(t,1,e)},e.prototype.dX=function(t,e){this.me.S(t,3,e)},e.prototype.oX=function(t,e){this.me.S(t,4,e)},e.prototype.ZJ=function(t,e){this.me.S(t,2,e)},e.prototype.Ok=function(t,e){this.me.S(t,5,e)},e.prototype.Qk=function(t,e){this.me.S(t,6,e)},e.prototype.Uj=function(t,e){this.me.S(t,7,e)},e.prototype.qX=function(t,e){this.Ej.S(t,0,e)},e.prototype.fN=function(t,e){return this.Sf?this.$f.addElement(e,t):this.Ti.addElement(t,e)},e.prototype.cX=function(t,e){this.Ej.S(t,1,e)},e.prototype.VJ=function(t,e){this.Ej.S(t,2,e)},e.prototype.kl=function(t){return this.Sf?this.$f.rc(t):this.Ti.rc(t)},e.prototype.Zr=function(t){return this.Sf?this.$f.Fc(t):this.Ti.Fc(t)},e.gq=function(t){return!(1&t)},e.Gv=function(t){return!(1&~t)},e.prototype.gz=function(t){return this.me.T(t,0)},e.prototype.gR=function(t){return this.me.T(t,1)},e.prototype.mk=function(t){return this.me.T(t,2)},e.prototype.xR=function(t){return this.me.T(t,3)},e.prototype.UR=function(t){return this.me.T(t,4)},e.prototype.qj=function(t){return this.me.T(t,5)},e.prototype.lk=function(t){return this.me.T(t,6)},e.prototype.UF=function(t){return this.me.T(t,7)},e.prototype.xz=function(t){return this.Ej.T(t,0)},e.prototype.wR=function(t){return this.Ej.T(t,1)},e.prototype.TR=function(t){return this.Ej.T(t,2)},e.prototype.DR=function(t){return this.Fj[t].oa},e.prototype.AR=function(t){return this.Fj[t].va},e.prototype.HX=function(e,i){null==this.Am&&(this.Am=new t.Xt);var n=new r(this);this.Am.sort(e,0,i,n)},e.prototype.GX=function(t,i,n){var r=this;t.Vd(i,n,(function(t,i){var n=r.nk(t),s=r.nk(i);return n<s||n==s&&e.gq(t)&&e.Gv(i)?-1:1}))},e.prototype.nk=function(t){var i=this.Fj[t>>1];return e.gq(t)?i.oa:i.va},e}();t.sr=o}(X||(X={})),function(t){var e=function(){function e(e){if(null==e)throw t.i.fa("Invalid arguement");this.hf=e;var i=e.nR();i.hS()?e.ef.IG()?this.lo=t.si.PannableFold:this.lo=t.si.Clip:this.lo=t.si.DontClip,i.iS()?e.Yf.IG()?this.Qm=t.si.PannableFold:this.Qm=t.si.Clip:this.Qm=t.si.DontClip,this.Bm=i.Jr,this.mH=i.Vu,e=this.hf.sH,this.aH=e.hs(2147483648),this.Uv=e.hs(1073741824)}return e.zh=function(t,e,i){return e.ww.zh(t,i)},e.Rt=function(t,e,i,n){return t.ww.Rt(e,i,n)},e.Qt=function(t,e,i,n){if(i=0>i?e.length:i,(t=t.ww.Rt(e,i,n))==i)return t;for(var r=e=0;r<i;r++){var s=n[r];s.isNaN()||(e<r&&n[e].L(s),e++)}for(;e<i;e++)n[e].Rc();return t},e.transform=function(i,n,r,s,o){if(i.isIdentity())return t.ta.kP(s,n,r),r;for(var a=[],h=0,l=0;l<r;){for(var c=Math.min(a.length,r-l),u=l,d=0;u<c;u++,d++)null==a[d]?a[d]=n[u].D():n[u].D(a[d]);var f=o?e.Qt(i,a,c,a):e.Rt(i,a,c,a);for(d=u=0;u<f;u++,d++)null==s[l]&&(s[l]=new t.Sa(n[l])),s[l].Cb(a[d]);l+=c,h+=f}return h},e.prototype.Rt=function(e,i,n){if(this.hf.isIdentity())return e!=n&&t.ta.Ru(n,e,i),i;var r=this.hf.ef,s=this.hf.Yf,o=r.Sb(),a=s.Sb();if(0==o&&o===a){var h=r.Qp();return s=h/(s=s.Qp()),(h=new t.Dd).setScale(s,s),h.eY(e,i,n),i}if(h=t.O.Fu(Math.min(i,64)),3==o){var l=r.Ji;o=(r=l.fk()).Sb(),n!=e&&t.ta.Ru(n,e,i),t.zb.$k(l,n,i,!0),l.Qt(t.bm.forward,n,i),t.zb.Zk(l,n,i,!0)}if(3==o||3===a)throw t.i.fa("image: transform_in_place_");if(2==o)this.lo==t.si.Clip?(n!=e&&t.ta.Ru(n,e,i),e=r.ml(),t.zb.OS(e,r,n,i)):(n!=e&&t.ta.Ru(n,e,i),r.Wc()&&(o=r.Xd(0),l=r.Oe(),t.zb.EX(n,i,l,o),t.zb.qF(n,i,r,0))),t.zb.IL(r,n,i,h);else for(o=r.Xd(0),l=r.Oe(),r=0;r<i;r++)t.zb.FX(e[r],l,o,n[r]);for(t.zb.GL(this.hf,n,i,h),e=0,(a=2==a)?e=s.zi():isNaN(this.Bm)||(e=this.Bm),a&&this.Qm!=t.si.Clip||t.zb.qF(n,i,s.sc(),e),a&&(t.zb.yG(n,i,s,this.Qm),t.zb.HL(s,n,i,h)),e=i,r=0;r<i;++r)n[r].isNaN()&&e--;return e},e.prototype.zh=function(e,i){if(this.hf.isIdentity()||e.B())return e;if(33==e.getType())return this.XI(e);var n=this.hf.ef,r=this.hf.Yf,s=n.Sb(),o=r.Sb();if(0==s&&s==o)return i=n.Qp(),i/=r=r.Qp(),(r=new t.Dd).setScale(i,i),(e=t.aa.jg(e)).Oc(r),e;switch(e.getType()){case 1607:case 1736:e=this.VI(e,i);break;case 550:e=this.fW(e,i);break;case 197:e=this.eW(e,i);break;default:throw t.i.fa("")}return e},e.prototype.XI=function(e){var i=e.D(),n=[];return n[0]=i,this.Rt(n,1,n),(e=new t.Sa(e)).Cb(n[0]),e},e.prototype.VI=function(e,i){if(e.tm())throw t.i.fa("curves not supported");var n=e.getType();if(1736==n)return this.gW(e,i);if(1607==n)return this.hW(e,i);throw t.i.fa("projectMultiPath")},e.prototype.gW=function(i,n){var r=this.hf.ef,s=this.hf.Yf,o=r.Sb(),a=s.Sb(),h=t.O.Fu(Math.min(i.I(),64)),l=t.Da.jg(i);3==o&&(o=(r=(i=r.Ji).fk()).Sb(),l=i.$k(l,!0),this.wp(i,t.bm.forward,l),l=i.Zk(l,!0)),i=null,3==a&&(a=(s=(i=s.Ji).fk()).Sb());var c=2==o,u=2==a,d=u?s.sc():s,f=!u&&!this.Uv;a=!1;var p=l;if(c){if((p=t.zb.UI(p,r,this.lo,n)).B())return p}else{if(l=new t.l,p.xc(l),o=r.Oe(),l.G<o.G||l.H>o.H){var g=t.l.construct(l.v-1,o.G,l.C+1,o.H);if((p=t.ri.Nu(p,g,r,NaN,0,n)).B())return p}l.R()>2*o.R()&&(p=t.zb.Hp(p,-2*o.R(),2*o.R(),r,!0,0,!0,n))}l=this.mH,(o=!isNaN(l))&&(p=t.Xl.local().V(p,l,n)),g=u?s.kk():null;var v=NaN;c&&(v=r.zi());var m=null!=s.Wr();if(this.aH)c&&(t.zb.ur(r,v,p,h),o&&(c=r.hh(),l*=(v=r.sc().hh())/c)),t.zb.tr(this.hf,p,f,h),o&&(c=r.sc().hh(),l*=(v=s.sc().hh())/c),r=p;else{var y=new t.Ta(p.description);y.DD(p),c&&(t.zb.ur(r,v,y,h),o&&(c=r.hh(),l*=(v=r.sc().hh())/c)),t.zb.tr(this.hf,y,f,h),o&&(c=r.sc().pm(),l*=(v=s.sc().pm())/c),f=NaN,u?(g=s.kk(),f=s.zi()):isNaN(this.Bm)||(f=this.Bm),c=e.tv(r)|e.tv(s),v=10*d.Xd(0),this.Uv&&(c=3,v=0),r=t.zb.UQ(p,r,y,d,f,n,c,v)}return m&&(r=t.zb.XD(r,s,n)),u&&(a||(u=d.Oe().R(),r.Tg(0,0).R()>=u-d.Xd(0)&&(d=g.getNorthPoleLocation(),u=g.getSouthPoleLocation(),p=g.getNorthPoleGeometry(),g=g.getSouthPoleGeometry(),f=0,p==t.Cg.PE_POLE_POINT&&d!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(f=1),g==t.Cg.PE_POLE_POINT&&u!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(f|=2),0!==f&&(a=!0))),r=t.zb.Mz(r,s,this.Qm,n),o&&(r=t.Xl.local().V(r,l,n)),t.zb.Lx(s,r,h)),r.B()||(a&&(r=t.Yl.local().V(r,s,!1,n)),null!=i&&(r=i.Zk(r,!1),this.wp(i,t.bm.reverse,r),r=i.$k(r,!1))),r},e.tv=function(e){if(2!=e.Sb())return 0;var i=0,n=e.kk();e=n.getNorthPoleLocation();var r=n.getSouthPoleLocation(),s=n.getNorthPoleGeometry();return n=n.getSouthPoleGeometry(),s==t.Cg.PE_POLE_POINT&&e!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(i=1),n==t.Cg.PE_POLE_POINT&&r!=t.Cg.PE_POLE_OUTSIDE_BOUNDARY&&(i|=2),i},e.prototype.hW=function(i,n){var r=this.hf.ef,s=this.hf.Yf,o=r.Sb(),a=s.Sb(),h=t.O.Fu(Math.min(i.I(),64)),l=t.Ta.jg(i);3==o&&(o=(r=(i=r.Ji).fk()).Sb(),l=i.$k(l,!0),this.wp(i,t.bm.forward,l),l=i.Zk(l,!0)),i=null,3==a&&(a=(s=(i=s.Ji).fk()).Sb());var c=2==o;o=(a=2==a)?s.sc():s;var u=!a&&!this.Uv;if(c){if((l=t.zb.UI(l,r,this.lo,n)).B())return l}else{var d=new t.l;l.xc(d);var f=r.Oe();if((d.G<f.G||d.H>f.H)&&(d=t.l.construct(d.v-1,f.G,d.C+1,f.H),(l=t.ri.Nu(l,d,r,NaN,0,n)).B()))return l}var p=NaN;c&&(p=r.zi()),d=null!=s.Wr(),f=this.mH;var g=!isNaN(f);if(g&&(l=t.Xl.local().V(l,f,n)),this.aH)c&&t.zb.ur(r,p,l,h),g&&(c=r.hh(),f*=(p=r.sc().hh())/c),t.zb.tr(this.hf,l,u,h),g&&(c=r.sc().hh(),f*=(p=s.sc().hh())/c),r=l;else{var v=new t.Ta(l.description);v.DD(l),c&&(t.zb.ur(r,p,v,h),g&&(c=r.hh(),f*=(p=r.sc().hh())/c)),t.zb.tr(this.hf,v,u,h),g&&(c=r.sc().hh(),f*=(p=s.sc().hh())/c),u=NaN,a?u=s.zi():isNaN(this.Bm)||(u=this.Bm),c=e.tv(r)|e.tv(s),p=10*o.Xd(0),this.Uv&&(c=3,p=0),r=t.zb.VQ(l,r,v,o,u,n,c,p)}return d&&(r=t.zb.XD(r,s,n)),a&&(r=t.zb.Mz(r,s,this.Qm,n),g&&(r=t.Xl.local().V(r,f,n)),t.zb.Lx(s,r,h)),r.B()||null!=i&&(r=i.Zk(r,!1),this.wp(i,t.bm.reverse,r),r=i.$k(r,!1)),r},e.prototype.eW=function(e,i){var n=(e.ca()+e.R())/400;return 0!=n?(n=t.Xl.local().V(e,n,i),n=this.VI(n,i),i=e.Ia(),n.bn(i)):(i=new t.Sa(e.Ip()),n=this.XI(i),i=e.Ia(),n.B()?i.Oa():(e.copyTo(i),e=n.D(),i.K(e.x,e.y,e.x,e.y))),i},e.prototype.fW=function(e,i){e=t.aa.jg(e);var n=this.hf.ef,r=this.hf.Yf,s=n.Sb(),o=r.Sb(),a=t.O.Fu(Math.min(e.I(),64));if(3==s){var h=n.Ji;s=(n=h.fk()).Sb(),e=h.Zk(e,!0),this.wp(h,t.bm.forward,e),e=h.$k(e,!0)}if(2==s){if(this.lo==t.si.Clip?e=t.Xj.local().V(e,n.ml(),n,i):n.Wc()&&(s=new t.l,e.xc(s),n.Oe().contains(s)||(this.lo==t.si.PannableFold&&(e=t.zb.lj(e,n)),t.zb.Jt(e,n.Oe(),n.Xd(0),!0),e=t.zb.Fn(e,n,0,!0,0,i))),e.B())return e;t.zb.ur(n,0,e,a)}else t.zb.Jt(e,n.Oe(),n.Xd(0),!0);return t.zb.tr(this.hf,e,!1,a),n=0,s=!1,h=null,3==o&&(s=!0,o=(r=(h=r.Ji).fk()).Sb()),(o=2==o)?n=r.zi():isNaN(this.Bm)||(n=this.Bm),o&&this.Qm!=t.si.Clip||(e=t.zb.Fn(e,r.sc(),n,!1,0,i)),o&&(e=t.zb.Mz(e,r,this.Qm,i),t.zb.Lx(r,e,a),e.B())||s&&(e=h.Zk(e,!0),this.wp(h,t.bm.reverse,e),e=h.$k(e,!0)),e},e.prototype.wp=function(e,i,n){var r=n.I();if(0!=r){for(var s=n.ub(0),o=t.O.lg(200,0),a=[],h=0;h<r;){var l=Math.min(100,r-h);s.Vw(2*h,2*l,o,2,!0);for(var c=0;c<l;++c)a[c]=t.h.construct(o[2*h],o[2*h+1]);e.Qt(i,a,l),h+=l}n.Pc(1993)}},e.Uy=function(e,i,n){if(null==e||null==i||!i.Wc())throw t.i.fa("Invalid Arguement");if(e.B())return e;var r=e.getType();return 197==r?(r=new t.Da(e.description)).ad(e,!1):t.aa.yd(r)?(r=new t.Ta(e.description)).oc(e,!0):r=e,(r=t.zb.lj(r,i)).B()?r:t.zb.Fn(r,i,0,r!=e,0,n)},e.nj=function(i,n,r,s){if(null==i||null==n||!n.Wc())throw t.i.fa("Invalid Arguement");if(i.B())return i;var o=i.getType();if(t.aa.Hc(o)){i=t.zb.lj(i,n),o=new t.l,i.A(o);for(var a=t.ta.ty(n,o,!1),h=n.gh(),l=Math.floor((o.v-h.v)/h.R())*h.R()+h.v;l<o.C;)l>o.v+a&&l<o.C-a&&(i=t.zb.uS(i,n,r,l)),l+=h.R()}else{if(197==o)return(o=new t.Da(i.description)).ad(i,!1),e.nj(o,n,r,s);if(t.aa.yd(o))return(o=new t.Ta(i.description)).oc(i,!0),e.nj(o,n,r,s)}return e.Uy(i,n,s)},e}();t.bu=e}(X||(X={})),function(t){var e=function(e){function i(i,n,r,s){var o=e.call(this)||this;return void 0===i?o.description=t.ee.og():void 0===r?o.description=i:(o.description=t.ee.og(),o.ZB(i,n),o.Ql(r,s)),o}return Q(i,e),i.prototype.getType=function(){return 322},i.prototype.Qb=function(){var t=this.sa-this.pa,e=this.na-this.la;return Math.sqrt(t*t+e*e)},i.prototype.Bi=function(t){var e=this.sa-this.pa,i=this.na-this.la;return Math.sqrt(e*e+i*i)<=t},i.prototype.Pn=function(){return!1},i.prototype.kg=function(){var e=new t.h;return e.uc(this.wc(),this.ac()),e},i.cP=function(t,e){return new i(t.x,t.y,e.x,e.y)},i.prototype.bn=function(e){e.Oa(),e.Nf(this.description);var i=new t.l;this.A(i),e.Xo(i),i=1;for(var n=this.description.Aa;i<n;i++)for(var r=this.description.kd(i),s=t.ra.Va(r);i<s;i++){var o=this.Tg(r,0);e.setInterval(r,0,o)}},i.prototype.A=function(t){t.K(this.sa,this.na,this.pa,this.la),t.normalize()},i.prototype.Qo=function(t){t.Oa(),t.Zb(this.sa,this.na,this.Od(0,1,0)),t.Zb(this.pa,this.la,this.Od(1,1,0))},i.prototype.Oc=function(e){if(e instanceof t.Dd){this.vc();var i=new t.h;i.x=this.sa,i.y=this.na,e.Eh(i,i),this.sa=i.x,this.na=i.y,i.x=this.pa,i.y=this.la,e.Eh(i,i),this.pa=i.x,this.la=i.y}else this.vc(),(i=new t.Nd).x=this.sa,i.y=this.na,i.z=this.Od(0,1,0),i=e.fp(i),this.sa=i.x,this.na=i.y,this.tn(0,1,0,i.z),i.x=this.pa,i.y=this.la,i.z=this.Od(1,1,0),i=e.fp(i),this.pa=i.x,this.la=i.y,this.tn(1,1,0,i.z)},i.prototype.Ia=function(){return new i(this.description)},i.prototype.Tx=function(t,e){return(this.pa-t-(this.sa-t))*(this.la-e+(this.na-e))*.5},i.prototype.vx=function(t){return t*this.Qb()},i.prototype.NG=function(t){return t/this.Qb()},i.prototype.DF=function(e){return t.lc.hq(this.sa,this.pa,e)},i.prototype.fR=function(e){return t.lc.hq(this.na,this.la,e)},i.prototype.dl=function(e,i){var n=new t.ig;return this.ah(e,i,n),n.get()},i.prototype.ah=function(e,i,n){if(null==n)throw t.i.N();n.Or(),(n=n.get()).Nf(this.description);var r=new t.h;this.hc(e,r),n.ZB(r.x,r.y),this.hc(i,r),n.Ql(r.x,r.y),r=1;for(var s=this.description.Aa;r<s;r++)for(var o=this.description.Ed(r),a=t.ra.Va(o),h=0;h<a;h++){var l=this.Uc(e,o,h);n.YB(o,h,l),l=this.Uc(i,o,h),n.OB(o,h,l)}},i.prototype.Uc=function(e,i,n){if(0==i)return 0==n?this.hc(e).x:this.hc(e).y;switch(t.ra.lz(i)){case 0:return.5>e?this.wv(i,n):this.gv(i,n);case 1:var r=this.wv(i,n);return i=this.gv(i,n),t.lc.hq(r,i,e);case 2:throw t.i.fa("not implemented")}throw t.i.Qa()},i.prototype.fe=function(t,e){var i=this.pa-this.sa,n=this.la-this.na,r=i*i+n*n;return 0==r?.5:(t=((t.x-this.sa)*i+(t.y-this.na)*n)/r,e||(0>t?t=0:1<t&&(t=1)),t)},i.prototype.cq=function(t,e,i,n){if(t){if(0==(t=this.la-this.na))return e==this.la?-1:0;if(0>(e=(e-this.na)/t)||1<e)return 0;null!=i&&(i[0]=this.DF(e))}else{if(0==(t=this.pa-this.sa))return e==this.pa?-1:0;if(0>(e=(e-this.sa)/t)||1<e)return 0;null!=i&&(i[0]=this.fR(e))}return null!=n&&(n[0]=e),1},i.prototype.Pe=function(t,e){var i=this.la-this.na;return 0==i?t==this.la?e:NaN:(t=(t-this.na)/i,e=this.DF(t),1==t&&(e=this.pa),e)},i.prototype.ru=function(t,e,i){return 0<=this.rp(t.x,t.y,e,i)},i.prototype.vi=function(t,e,i){return 0<=this.rp(t,e,i,!0)},i.prototype.qs=function(t,e){return this.ru(t,e,!1)},i.prototype.rI=function(){if(this.la<this.na||this.la==this.na&&this.pa<this.sa){var t=this.sa;this.sa=this.pa,this.pa=t,t=this.na,this.na=this.la,this.la=t,t=0;for(var e=this.description.Oq-2;t<e;t++){var i=this.ka[t];this.ka[t]=this.ka[t+e],this.ka[t+e]=i}}},i.prototype.uu=function(e,i){(i=t.h.construct(e,i)).sub(this.ac());var n=new t.h;return n.uc(this.wc(),this.ac()),(e=n.wi(i))>(i=8881784197001252e-31*(Math.abs(n.x*i.y)+Math.abs(n.y*i.x)))?-1:e<-i?1:0},i.prototype.rp=function(e,i,n,r){var s=this.sa,o=this.na,a=e-s,h=i-o;if((a=Math.sqrt(a*a+h*h))<=Math.max(n,6661338147750939e-31*a))return r&&0==a?NaN:0;if(a=e-this.pa,h=i-this.la,(a=Math.sqrt(a*a+h*h))<=Math.max(n,6661338147750939e-31*a))return r&&0==a?NaN:1;if(a=this.pa-this.sa,h=this.la-this.na,0<(r=Math.sqrt(a*a+h*h))){var l=1/r,c=e-s,u=i-o,d=c*(a*=l)+u*(h*=l),f=17763568394002505e-31*(Math.abs(c*a)+Math.abs(u*h)),p=a;if(a=-h,h=p,d<-(f=Math.max(n,f))||d>r+f)return NaN;if(Math.abs(c*a+u*h)<=Math.max(n,17763568394002505e-31*(Math.abs(c*a)+Math.abs(u*h)))&&(.5>=(a=t.O.Rk(d*l,0,1))?(h=this.sa+(this.pa-this.sa)*a,r=this.na+(this.la-this.na)*a):(h=this.pa-(this.pa-this.sa)*(1-a),r=this.la-(this.la-this.na)*(1-a)),t.h.Oy(h,r,e,i)<=n)){if(.5>a){if(t.h.Oy(h,r,s,o)<=n)return 0}else if(t.h.Oy(h,r,this.pa,this.la)<=n)return 1;return a}}return NaN},i.prototype.Nb=function(t){return null!=t&&(t==this||t.constructor===this.constructor&&this.FM(t))},i.prototype.rD=function(e,i,n){var r=n?this.sa:this.pa;n=n?this.na:this.la;var s=new t.h;return s.x=e.pa-r,s.y=e.la-n,!(i.Qh(s)>6661338147750939e-31*i.fD(s))||(s.x=e.sa-r,s.y=e.na-n,i.Qh(s)<=6661338147750939e-31*i.fD(s))},i.prototype.qD=function(e){var i=new t.h;return i.x=this.pa-this.sa,i.y=this.la-this.na,!!this.rD(e,i,!1)&&(i.Sq(),!!this.rD(e,i,!0))},i.NM=function(t,e){var i=t.uu(e.sa,e.na),n=t.uu(e.pa,e.la);return!(0>i&&0>n||0<i&&0<n)&&(i=e.uu(t.sa,t.na),n=e.uu(t.pa,t.la),!(0>i&&0>n||0<i&&0<n)&&((i=t.Qb())>(n=e.Qb())?t.qD(e):e.qD(t)))},i.LM=function(e,i,n){var r=t.h.construct(NaN,NaN),s=e.pa-e.sa,o=e.la-e.na,a=i.pa-i.sa,h=i.la-i.na,l=a*o-s*h;if(0==l)return r;var c=8881784197001252e-31*(Math.abs(a*o)+Math.abs(s*h)),u=i.sa-e.sa,d=i.na-e.na,f=a*d-u*h,p=f/l,g=Math.abs(l);return p<-(a=(8881784197001252e-31*(Math.abs(a*d)+Math.abs(u*h))*g+c*Math.abs(f))/(l*l)+2220446049250313e-31*Math.abs(p))||p>1+a||(a=(h=s*d-u*o)/l)<-(s=(8881784197001252e-31*(Math.abs(s*d)+Math.abs(u*o))*g+c*Math.abs(h))/(l*l)+2220446049250313e-31*Math.abs(a))||a>1+s||(p=t.O.Rk(p,0,1),s=t.O.Rk(a,0,1),o=e.hc(p),l=i.hc(s),(c=new t.h).uc(o,l),c.length()>n&&(c.add(o,l),c.scale(.5),p=e.fe(c,!1),s=i.fe(c,!1),e=e.hc(p),i=i.hc(s),e.sub(i),e.length()>n)||r.ma(p,s)),r},i.OM=function(t,e,n,r){var s=0;if((t.sa==e.sa&&t.na==e.na||t.sa==e.pa&&t.na==e.la)&&(s++,!r))return 1;if(t.pa==e.sa&&t.la==e.na||t.pa==e.pa&&t.la==e.la){if(2==++s)return 2;if(!r)return 1}return e.vi(t.sa,t.na,n)||e.vi(t.pa,t.la,n)||t.vi(e.sa,e.na,n)||t.vi(e.pa,e.la,n)?1:r&&0!=s||0==i.NM(t,e)?0:1},i.Zx=function(e,n,r,s,o,a){var h=0,l=e.rp(n.sa,n.na,a,!1),c=e.rp(n.pa,n.la,a,!1),u=n.rp(e.sa,e.na,a,!1),d=n.rp(e.pa,e.la,a,!1);return isNaN(l)||(null!=s&&(s[h]=l),null!=o&&(o[h]=0),null!=r&&(r[h]=t.h.construct(n.sa,n.na)),h++),isNaN(c)||(null!=s&&(s[h]=c),null!=o&&(o[h]=1),null!=r&&(r[h]=t.h.construct(n.pa,n.la)),h++),2==h||isNaN(u)||0==l&&0==u||0==c&&1==u||(null!=s&&(s[h]=0),null!=o&&(o[h]=u),null!=r&&(r[h]=t.h.construct(e.sa,e.na)),h++),2==h||isNaN(d)||1==l&&0==d||1==c&&1==d||(null!=s&&(s[h]=1),null!=o&&(o[h]=d),null!=r&&(r[h]=t.h.construct(n.pa,n.la)),h++),0<h?(2==h&&null!=s&&s[0]>s[1]&&(e=s[0],s[0]=s[1],s[1]=e,null!=o&&(s=o[0],o[0]=o[1],o[1]=s),null!=r&&(o=t.h.construct(r[0].x,r[0].y),r[0]=r[1],r[1]=o)),h):(h=i.LM(e,n,a),isNaN(h.x)?0:(null!=r&&(r[0]=e.hc(h.x)),null!=s&&(s[0]=h.x),null!=o&&(o[0]=h.y),1))},i.prototype.eG=function(){return 0},i.prototype.op=function(){},i.prototype.toString=function(){return"Line: ["+this.sa.toString()+", "+this.na.toString()+", "+this.pa.toString()+", "+this.la.toString()+"]"},i}(t.SC);t.yb=e}(X||(X={})),function(t){var e=function(){function t(){this.Jm=[],this.ya=-1}return t.prototype.La=function(){return this.ya},t.prototype.next=function(){if(null!=this.Jm&&0!=this.Jm.length){this.ya++;var t=this.Jm[0];return this.Jm=1>=this.Jm.length?[]:this.Jm.slice(1),t}return this.Jm=null},t.prototype.ZX=function(t){this.Jm.push(t)},t.prototype.qe=function(){},t}();t.gL=e}(X||(X={})),function(t){var e;(e=t.SL||(t.SL={}))[e.enumFillRuleOddEven=0]="enumFillRuleOddEven",e[e.enumFillRuleWinding=1]="enumFillRuleWinding";var i=function(e){function i(i,n){var r=e.call(this)||this;if(r.xf=!1,r.Eq=null,r.sq=0,r.rq=0,r.Aj=null,r.Mg=!1,r.nb=null,r.mb=null,r.Ve=null,r.Lj=null,r.Sd=null,r.tq=0,r.gb=0,r.xq=0,void 0===n)r.xf=i,r.Mg=!1,r.tq=0,r.sq=0,r.rq=0,r.wa=0,r.description=t.ee.og();else{if(null==n)throw t.i.N();r.xf=i,r.Mg=!1,r.tq=0,r.sq=0,r.rq=0,r.wa=0,r.description=n}return r.Aj=null,r.gb=0,r}return Q(i,e),i.prototype.tm=function(){return 0<this.tq},i.prototype.Yx=function(){this.vc(),null==this.Eq?this.Eq=new t.Sa(this.description):this.Eq.Nf(this.description)},i.prototype.sx=function(e,i){var n=new t.h;n.x=e,n.y=i,this.Lt(n)},i.prototype.Lt=function(t){this.Yx(),this.Eq.Cb(t),this.Mg=!0},i.prototype.nf=function(e){if(e.B())throw t.i.N();this.Jl(e.description),this.Yx(),e.copyTo(this.Eq),this.Mg=!0},i.prototype.Sx=function(){var e=1;this.Mg&&(this.Yx(),null==this.nb?(this.nb=t.Yc.Oh(2),this.nb.write(0,0),this.mb=t.Yc.Mr(2,0)):(this.nb.resize(this.nb.size+1,0),this.mb.resize(this.mb.size+1,0)),this.xf&&this.mb.write(this.mb.size-2,1),e++);var i=this.wa;this.nb.write(this.nb.size-1,this.wa+e),this.dm(i+e),this.mb.write(this.nb.size-1,0),this.Mg&&(this.Ht(i,this.Eq),this.Mg=!1)},i.prototype.yj=function(t,e){this.Sx(),this.Cb(this.wa-1,t,e)},i.prototype.Ci=function(t){this.Sx(),this.Cb(this.wa-1,t)},i.prototype.lineTo=function(t){this.Sx(),this.Ht(this.wa-1,t)},i.prototype.CU=function(e){if(this.vc(),this.xf)throw t.i.Qa();var i=this.da();if(e>i)throw t.i.Qa();if(this.dc(e)){if(null==this.mb)throw t.i.Qa();var n=this.wa,r=this.Ba(e),s=this.Vc(e);this.dm(this.wa+1),this.mc();for(var o=0,a=this.description.Aa;o<a;o++)if(null!=this.za[o]){var h=t.ra.Va(this.description.Ed(o));this.za[o].Mn(h*s,this.za[o],h*r,h,!0,1,h*n)}for(;i>e;i--)n=this.nb.read(i),this.nb.write(i,n+1);this.mb.KE(e,1)}},i.prototype.Ap=function(){if(this.wx(),void 0===t){this.Mg=!1;var t=this.da()-1}var e=this.mb.read(t);this.mb.write(t,1|e),null!=this.Ve&&(t=this.Vc(t)-1,this.Ve.write(t,1),this.Lj.write(t,-1))},i.prototype.dc=function(t){return!!(1&this.mb.read(t))},i.prototype.Nn=function(t){if(this.dc(t))return!0;var e=this.Ba(t);return!(e>(t=this.Vc(t)-1))&&(e=this.Na(e),t=this.Na(t),e.qb(t))},i.prototype.yv=function(t){return!!(2&this.mb.read(t))},i.prototype.oc=function(e,i){if(this.Jl(e.description),322!=e.getType())throw t.i.Qa();var n=new t.Sa;(i||this.B())&&(e.To(n),this.nf(n)),e.Po(n),this.lineTo(n)},i.prototype.tp=function(t){var e=0==this.wa;this.sx(t.v,t.G),this.yj(t.v,t.H),this.yj(t.C,t.H),this.yj(t.C,t.G),this.Ap(),this.Mg=!1,e&&this.Lf(256,!1)},i.prototype.ad=function(e,i){if(!e.B()){for(var n=0==this.wa,r=new t.Sa(this.description),s=0;4>s;s++)e.Hf(i?4-s-1:s,r),0==s?this.nf(r):this.lineTo(r);this.Ap(),this.Mg=!1,n&&!i&&this.Lf(256,!1)}},i.prototype.add=function(t,e){for(var i=0;i<t.da();i++)this.addPath(t,i,!e)},i.prototype.addPath=function(t,e,i){this.vf(-1,t,e,i)},i.prototype.Yk=function(t,e){this.Hz(t,e)},i.prototype.Dr=function(e,i,n,r,s){if(s||0!=this.da()||(s=!0),0>i&&(i=e.da()-1),i>=e.da()||0>n||0>r||r>e.rv(i))throw t.i.fa("index out of bounds");if(0!=r){var o=e.dc(i)&&n+r==e.rv(i);if(!o||1!=r){if(this.Mg=!1,this.Jl(e.description),n=e.Ba(i)+n+1,s&&(r++,n--),o&&r--,o=this.wa,this.dm(this.wa+r),this.mc(),s){if(0==r)return;this.nb.add(this.wa),s=e.mb.read(i),s&=-5,this.xf&&(s|=1),this.mb.write(this.mb.size-1,s),this.mb.add(0)}else this.nb.write(this.mb.size-1,this.wa);s=0;for(var a=this.description.Aa;s<a;s++){var h=this.description.kd(s),l=t.ra.Va(h),c=e.description.Pf(h);0>c||null==e.za[c]?this.za[s].Ln(l*o,t.ra.se(h),r*l,l*o):this.za[s].Mn(l*o,e.za[c],l*n,r*l,!0,l,l*o)}if(this.tm())throw t.i.Qa();if(e.yv(i))throw t.i.Qa();this.Pc(1993)}}},i.prototype.oJ=function(){for(var t=0,e=this.da();t<e;t++)this.FW(t)},i.prototype.FW=function(e){if(this.mc(),e>=this.da())throw t.i.N();var i=this.Ba(e),n=this.Ja(e);e=this.dc(e)?1:0;for(var r=0,s=this.description.Aa;r<s;r++)if(null!=this.za[r]){var o=t.ra.Va(this.description.Ed(r));this.za[r].ni(o*(i+e),o*(n-e),o)}this.Pc(1993)},i.prototype.Zq=function(e){this.mc();var i=this.da();if(0>e&&(e=i-1),e>=i)throw t.i.N();for(var n=this.Ba(e),r=this.Ja(e),s=0,o=this.description.Aa;s<o;s++)if(null!=this.za[s]){var a=t.ra.Va(this.description.Ed(s));this.za[s].En(a*n,a*r,a*this.wa)}for(n=e+1;n<=i;n++)s=this.nb.read(n),this.nb.write(n-1,s-r);if(null==this.mb)for(n=e+1;n<=i;n++)e=this.mb.read(n),this.mb.write(n-1,e);this.nb.resize(i),this.mb.resize(i),this.wa-=r,this.Pg-=r,this.Pc(1993)},i.prototype.vf=function(e,i,n,r){if(i==this)throw t.i.N();if(n>=i.da())throw t.i.N();var s=this.da();if(e>s)throw t.i.N();0>e&&(e=s),0>n&&(n=i.da()-1),this.Mg=!1,this.Jl(i.description),i.mc();var o=i.Ba(n),a=i.Ja(n),h=this.wa,l=i.dc(n)&&!r?1:0;this.dm(this.wa+a),this.mc();for(var c=e<s?this.Ba(e):h,u=0,d=this.description.Aa;u<d;u++){var f=this.description.Ed(u),p=i.description.Pf(f),g=t.ra.Va(f);0<=p&&null!=i.za[p]?(0!=l&&this.za[u].Mn(c*g,i.za[p],g*o,g,!0,g,g*h),this.za[u].Mn((c+l)*g,i.za[p],g*(o+l),g*(a-l),r,g,g*(h+l))):this.za[u].Ln(c*g,t.ra.se(f),g*a,g*h)}for(this.nb.add(h+a),r=s;r>=e+1;r--)o=this.nb.read(r-1),this.nb.write(r,o+a);for(i.yv(n),this.mb.add(0),r=s-1;r>=e+1;r--)s=this.mb.read(r),s&=-5,this.mb.write(r+1,s);s=i.JR().read(n),s&=-5,this.xf&&(s|=1),this.mb.write(e,s)},i.prototype.Hz=function(e,i){var n=-1,r=this.da();if(n>r)throw t.i.N();0>n&&(n=r),this.Mg=!1;var s=this.wa;this.dm(this.wa+i),this.mc();var o=n<r?this.Ba(n):s;if(null!=e)this.za[0].Iz(2*o,e,0,i,!0,2*s);else{var a=t.ra.se(0);this.za[0].Ln(2*o,a,2*i,2*s)}e=1;for(var h=this.description.Aa;e<h;e++){a=this.description.kd(e);var l=t.ra.Va(a);a=t.ra.se(a),this.za[e].Ln(o*l,a,l*i,l*s)}for(this.nb.add(this.wa),s=r;s>=n+1;s--)o=this.nb.read(s-1),this.nb.write(s,o+i);for(this.mb.add(0),s=r-1;s>=n+1;s--)i=this.mb.read(s),i&=-5,this.mb.write(s+1,i);this.xf&&this.mb.write(n,1)},i.prototype.qG=function(e,i,n){var r=-1;if(0>e&&(e=this.da()),e>this.da()||r>this.Ja(e)||n>i.length)throw t.i.fa("index out of bounds");if(0!=n){e==this.da()&&(this.nb.add(this.wa),this.xf?this.mb.add(1):this.mb.add(0)),0>r&&(r=this.Ja(e)),this.mc();var s=this.wa;this.dm(this.wa+n),this.mc();for(var o=0,a=this.description.Aa;o<a;o++){var h=this.description.Ed(o),l=t.ra.Va(h);this.za[o].Ut(l*(this.Ba(e)+r+n),(s-this.Ba(e)-r)*l,this.za[o],l*(this.Ba(e)+r),!0,l),0==o?this.za[o].vC(l*(this.Ba(e)+r),n,i,0,!0):this.za[o].Wj(t.ra.se(h),(this.Ba(e)+r)*l,n*l)}for(this.tm()&&(this.Ve.Ut(this.Ba(e)+r+n,s-this.Ba(e)-r,this.Ve,this.Ba(e)+r,!0,1),this.Lj.Ut(this.Ba(e)+r+n,s-this.Ba(e)-r,this.Lj,this.Ba(e)+r,!0,1),this.Ve.Wj(1,this.Ba(e)+r,n),this.Lj.Wj(-1,this.Ba(e)+r,n)),e+=1,i=this.da();e<=i;e++)this.nb.write(e,this.nb.read(e)+n)}},i.prototype.wf=function(e,i,n){var r=this.da();if(0>e&&(e=this.da()),e>=r||i>this.Ja(e))throw t.i.fa("index out of bounds");e==this.da()&&(this.nb.add(this.wa),this.xf?this.mb.add(1):this.mb.add(0)),0>i&&(i=this.Ja(e));var s=this.wa;this.dm(this.wa+1),this.mc();var o=this.Ba(e);this.za[0].vj(2*(o+i),n,2*s),n=1;for(var a=this.description.Aa;n<a;n++){var h=this.description.Ed(n),l=t.ra.Va(h);this.za[n].Ln(l*(o+i),t.ra.se(h),l,l*s)}for(e+=1;e<=r;e++)this.nb.write(e,this.nb.read(e)+1)},i.prototype.DB=function(e,i){var n=this.da();if(0>e&&(e=n-1),e>=n||i>=this.Ja(e))throw t.i.fa("index out of bounds");this.mc();var r=this.Ba(e);0>i&&(i=this.Ja(e)-1),i=r+i,r=0;for(var s=this.description.Aa;r<s;r++)if(null!=this.za[r]){var o=t.ra.Va(this.description.Ed(r));this.za[r].En(o*i,o,o*this.wa)}for(;n>=e+1;n--)i=this.nb.read(n),this.nb.write(n,i-1);this.wa--,this.Pg--,this.Pc(1993)},i.prototype.uE=function(e,i,n){var r=this.Ba(e)+i;if((n=this.Ba(n)+void 0)<r||0>r||n>this.I()-1)throw t.i.N();i=0,(e=this.Ga()).Vb(r);do{for(;e.Ha()&&(r=e.ha(),e.wb()!=n);)i+=r=r.Qb();if(e.wb()==n)break}while(e.$a());return i},i.prototype.fO=function(e,i,n){if(i=this.Ba(e)+i,n=this.Ba(e)+n,0>i||n>this.I()-1)throw t.i.N();var r=this.Ga();if(i>n){if(!this.dc(e))throw t.i.N("cannot iterate across an open path");r.JB()}var s=e=0;r.Vb(i);do{s+=e,e=r.ha().Qb()}while(r.wb()!=n);return s},i.prototype.mg=function(){return t.pi.gm(this,null)},i.prototype.KS=function(e,i,n){for(var r=e;r<n-1;r++)if(this.dc(r))throw t.i.N("cannot interpolate across closed paths");if(1!=(r=this.description.Aa)){var s=this.uE(e,i,n);if(0!=s)for(var o=1;o<r;o++){var a=this.description.kd(o);if(2!=t.ra.lz(a))for(var h=t.ra.Va(a),l=0;l<h;l++)this.MS(a,e,i,n,s,l)}}},i.prototype.JS=function(e,i,n){var r=this.description.Aa;if(1!=r){var s=this.fO(e,i,n);if(0!=s)for(var o=1;o<r;o++){var a=this.description.kd(o);if(2!=t.ra.lz(a))for(var h=t.ra.Va(a),l=0;l<h;l++)this.LS(a,e,i,n,s,l)}}},i.prototype.MS=function(e,i,n,r,s,o){var a=this.Ga(),h=this.Ba(i)+n;r=this.Ba(r)+void 0,i=this.Uc(e,h,o),n=this.Uc(e,r,o);var l=i,c=0;a.Vb(h);do{if(a.Ha()){if(a.ha(),a.wb()==r)break;this.setAttribute(e,a.wb(),o,l),a.li();do{if(h=a.ha(),a.ik()==r)return;c+=h=h.Qb(),l=t.lc.hq(i,n,c/s),a.On()||this.setAttribute(e,a.ik(),o,l)}while(a.Ha())}}while(a.$a())},i.prototype.LS=function(e,i,n,r,s,o){var a=this.Ga(),h=this.Ba(i)+n;if((i=this.Ba(i)+r)!=h){r=this.Uc(e,h,o),n=this.Uc(e,i,o);var l=0;a.Vb(h),a.JB(),h=r;do{var c=a.ha();this.setAttribute(e,a.wb(),o,h),l+=h=c.Qb(),h=t.lc.hq(r,n,l/s)}while(a.ik()!=i)}},i.prototype.Oa=function(){this.tq=0,this.Mg=!1,this.Sd=this.Ve=this.Lj=this.mb=this.nb=null,this.wD()},i.prototype.Oc=function(e){e instanceof t.Dd?this.YD(e,-1):this.wN(e)},i.prototype.YD=function(e,i){if(!this.B()&&!e.isIdentity()){this.mc();var n=this.za[0],r=new t.h,s=new t.h;if(0>i){var o=this.tm(),a=0;i=this.wa}else o=this.yv(i),a=this.Ba(i),i=this.Vc(i);for(;a<i;a++){if(r.x=n.read(2*a),r.y=n.read(2*a+1),o){var h=this.Lj.read(a);if(0<=h)switch(7&this.Ve.read(a)){case 2:s.x=this.Sd.read(h),s.y=this.Sd.read(h+1),e.Eh(s,s),this.Sd.write(h,s.x),this.Sd.write(h+1,s.y),s.x=this.Sd.read(h+3),s.y=this.Sd.read(h+4),e.Eh(s,s),this.Sd.write(h+3,s.x),this.Sd.write(h+4,s.y);break;case 4:throw t.i.Qa()}}e.Eh(r,r),n.write(2*a,r.x),n.write(2*a+1,r.y)}this.Pc(1993)}},i.prototype.wN=function(e){if(!this.B()){this.re(1),this.mc();for(var i=this.za[0],n=this.za[1],r=new t.Nd,s=new t.Nd,o=this.tm(),a=0;a<this.wa;a++){if(r.x=i.read(2*a),r.y=i.read(2*a+1),r.z=n.read(a),o){var h=this.Lj.read(a);if(0<=h)switch(7&this.Ve.read(a)){case 2:s.x=this.Sd.read(h),s.y=this.Sd.read(h+1),s.z=this.Sd.read(h+2),s=e.fp(s),this.Sd.write(h,s.x),this.Sd.write(h+1,s.y),this.Sd.write(h+1,s.z),s.x=this.Sd.read(h+3),s.y=this.Sd.read(h+4),s.z=this.Sd.read(h+5),s=e.fp(s),this.Sd.write(h+3,s.x),this.Sd.write(h+4,s.y),this.Sd.write(h+5,s.z);break;case 4:throw t.i.Qa()}}r=e.fp(r),i.write(2*a,r.x),i.write(2*a+1,r.y),n.write(a,r.z)}this.Pc(1993)}},i.prototype.iy=function(){null==this.nb&&(this.nb=t.Yc.Oh(1,0),this.mb=t.Yc.Mr(1,0)),null!=this.Ve&&(this.Ve.resize(this.Pg,1),this.Lj.resize(this.Pg,-1))},i.prototype.op=function(e){e.Mg=!1,e.tq=this.tq,e.xq=this.xq,e.nb=null!=this.nb?t.ia.Bn(this.nb):null,e.mb=null!=this.mb?t.pn.Bn(this.mb):null,e.Lj=null!=this.Lj?t.ia.Bn(this.Lj):null,e.Ve=null!=this.Ve?t.pn.Bn(this.Ve):null,e.Sd=null!=this.Sd?t.be.Bn(this.Sd):null,e.sq=this.sq,e.rq=this.rq,e.Aj=this.ak(1024)?null:this.Aj},i.prototype.Qb=function(){if(!this.ak(512))return this.sq;for(var e=this.Ga(),i=new t.Fx(0);e.$a();)for(;e.Ha();)i.add(e.ha().Qb());return this.sq=i.rm(),this.Lf(512,!1),i.rm()},i.prototype.Nb=function(t){if(t==this)return!0;if(!(t instanceof i&&e.prototype.Nb.call(this,t)))return!1;var n=this.da();return!(n!=t.da()||null!=this.nb&&!this.nb.Nb(t.nb,0,n+1)||this.xq!=t.xq||null!=this.mb&&!this.mb.Nb(t.mb,0,n))&&e.prototype.Nb.call(this,t)},i.prototype.Ga=function(){return new t.YL(this)},i.prototype.hy=function(t){if(e.prototype.hy.call(this,t),this.tm())for(t=this.Ga();t.$a();)t.Ha()},i.prototype.yp=function(t,i){if(e.prototype.yp.call(this,t,i),this.tm())for(t=this.Ga();t.$a();)t.Ha()},i.prototype.$x=function(){this.wa=null==this.nb||0==this.nb.size?0:this.nb.read(this.nb.size-1)},i.prototype.Ke=function(){return this.xf?(this.xu(),this.rq):0},i.prototype.Ev=function(t){return!!this.xf&&(this.ak(8)?(this.xu(),0<this.Aj.read(t)):!!(4&this.mb.read(t)))},i.prototype.Ir=function(t){return this.xf?(this.xu(),this.Aj.read(t)):0},i.prototype.xu=function(){if(this.ak(1024)){var e=this.da();null==this.Aj?this.Aj=new t.be(e):this.Aj.size!=e&&this.Aj.resize(e),e=new t.Fx(0);for(var i=new t.Fx(0),n=new t.h,r=0,s=this.Ga();s.$a();){for(i.reset(),this.D(this.Ba(s.gb),n);s.Ha();)i.add(s.ha().Tx(n.x,n.y));e.add(i.rm());var o=r++;this.Aj.write(o,i.rm())}this.rq=e.rm(),this.Lf(1024,!1)}},i.prototype.FR=function(){if(this.xf){this.fm();for(var t=this.da(),e=0;e<t;e++)this.mb.read(e)}},i.prototype.fm=function(){if(this.ak(8)){this.xu();var e=this.da();(null==this.mb||this.mb.size<e)&&(this.mb=t.Yc.Mr(e+1));for(var i=1,n=0;n<e;n++){var r=this.Aj.read(n);0==n&&(i=0<r?1:-1),0<r*i?this.mb.zJ(n,4):this.mb.KE(n,4)}this.Lf(8,!1)}},i.prototype.sz=function(e){var i=this.gb,n=this.da();if(0<=i&&i<n){if(e<this.Vc(i)){if(e>=this.Ba(i))return i;i--}else i++;if(0<=i&&i<n&&e>=this.Ba(i)&&e<this.Vc(i))return this.gb=i}if(5>n){for(i=0;i<n;i++)if(e<this.Vc(i))return this.gb=i;throw t.i.fa("corrupted geometry")}for(i=0,--n;n>i;){var r=i+(n-i>>1);if(e<this.Ba(r))n=r-1;else{if(!(e>=(i=this.Vc(r))))return this.gb=r;i=r+1}}return this.gb=i},i.prototype.yz=function(){var t=this.I();if(!this.xf){t-=this.da();for(var e=0,i=this.da();e<i;e++)this.dc(e)&&t++}return t},i.prototype.rv=function(t){var e=this.Ja(t);return this.dc(t)||e--,e},i.prototype.Ia=function(){return new i(this.xf,this.description)},i.prototype.Db=function(){return this.xf?2:1},i.prototype.getType=function(){return this.xf?1736:1607},i.prototype.QJ=function(t){this.nb=t,this.Pc(16777215)},i.prototype.VR=function(){return this.wx(),this.Ve},i.prototype.JR=function(){return this.wx(),this.mb},i.prototype.PJ=function(t){this.mb=t,this.Pc(16777215)},i.prototype.da=function(){return null!=this.nb?this.nb.size-1:0},i.prototype.Vc=function(t){return this.nb.read(t+1)},i.prototype.Ja=function(t){return this.nb.read(t+1)-this.nb.read(t)},i.prototype.Ba=function(t){return this.nb.read(t)},i.prototype.lu=function(e,i){null==this.Bb&&(this.Bb=new t.Uk),i=t.Nx.pW(i);var n=this.Bb.Fk;if(null!=n){if(!(n.Ik<e||i>n.RR()))return!0;this.Bb.yD(null)}return n=t.Nx.create(this,e,i),this.Bb.yD(n),!0},i.prototype.cc=function(){var t=e.prototype.cc.call(this);if(!this.Ac()){var i=this.da();null!=this.nb&&this.nb.An(t,0,i+1),null!=this.mb&&this.mb.An(t,0,i)}return t},i.prototype.ZF=function(t){return null!=this.Ve?this.Ve.read(t):1},i.prototype.bc=function(e,i,n){var r=this.sz(e);if(e==this.Vc(r)-1&&!this.dc(r))throw t.i.fa("index out of bounds");this.mc();var s=this.Ve,o=1;if(null!=s&&(o=7&s.read(e)),1!==o)throw t.i.Qa();if(i.Or(),i=i.get(),n?i.Nf(t.ee.og()):i.Nf(this.description),r=e==this.Vc(r)-1&&this.dc(r)?this.Ba(r):e+1,s=new t.h,this.D(e,s),i.Dc(s),this.D(r,s),i.Qc(s),!n)for(n=1,s=this.description.Aa;n<s;n++){o=this.description.Ed(n);for(var a=t.ra.Va(o),h=0;h<a;h++){var l=this.Uc(o,e,h);i.YB(o,h,l),l=this.Uc(o,r,h),i.OB(o,h,l)}}},i.prototype.Rj=function(e,i){if(e>=this.da())throw t.i.N();if(this.B())i.Oa();else{if(this.yv(e))throw t.i.fa("not implemented");var n=this.ub(0),r=new t.h,s=new t.l;s.Oa();var o=this.Ba(e);for(e=this.Vc(e);o<e;o++)n.tc(2*o,r),s.Zb(r);i.K(s)}},i.prototype.fj=function(e){return null==this.Bb&&(this.Bb=new t.Uk),!(0==e||16>this.I()||(e=t.ta.nE(this),this.Bb.WM(e),0))},i.prototype.hM=function(){if(null==this.Bb&&(this.Bb=new t.Uk),null==this.Bb.zo){this.Bb.xD(null);var e=t.ta.YN(this);this.Bb.xD(e)}},i.prototype.Yo=function(t){this.xq=t},i.prototype.In=function(){return this.xq},i.prototype.DD=function(e){if(this==e)throw t.i.fa("MultiPathImpl.add");for(var i=this.da(),n=0;n<e.da();n++)this.addPath(e,n,!0),this.CU(i),i++},i.prototype.kO=function(e){var i=this.sz(e),n=this.Ba(i);if(n!=e){if(e>=(i=this.Vc(i))||e<n)throw t.i.fa("change_ring_start_point");for(var r=0,s=this.description.Aa;r<s;r++){var o=this.description.kd(r);o=t.ra.Va(o),this.za[r].rotate(n*o,e*o,i*o)}}},i}(t.Gx);t.Vk=i}(X||(X={})),function(t){var e=function(e){function i(i){var n=e.call(this)||this;if(void 0!==i){if(null==i)throw t.i.N();n.description=i}else n.description=t.ee.og();return n.wa=0,n}return Q(i,e),i.prototype.Ia=function(){return new i(this.description)},i.prototype.add=function(t){this.resize(this.wa+1),this.Dh(this.wa-1,t)},i.prototype.Bu=function(e,i){this.resize(this.wa+1);var n=new t.h;n.ma(e,i),this.Cb(this.wa-1,n)},i.prototype.Fd=function(e,i,n){if(n=0>n?e.I():n,0>i||i>e.I()||n<i)throw t.i.N();if(i!=n){this.Jl(e.description),n-=i;var r=this.wa;this.resize(this.wa+n),this.mc();for(var s=0,o=e.description.Aa;s<o;s++){var a=e.description.Ed(s),h=t.ra.Va(a),l=this.ub(a);a=e.ub(a),l.Mn(r*h,a,i*h,n*h,!0,1,r*h)}}},i.prototype.HD=function(e,i){var n=e.length;if(i=0>i?n:i,0>n||0>i)throw t.i.N();if(0!=i){n=i-0,i=this.wa,this.resize(this.wa+n);for(var r=0;r<n;r++)this.Cb(i+r,e[0+r])}},i.prototype.DB=function(e){if(0>e||e>=this.I())throw t.i.fa("index out of bounds");this.mc();for(var i=0,n=this.description.Aa;i<n;i++)if(null!=this.za[i]){var r=t.ra.Va(this.description.Ed(i));this.za[i].En(r*e,r,r*this.wa)}this.wa--,this.Pg--,this.Pc(1993)},i.prototype.resize=function(t){this.dm(t)},i.prototype.op=function(){},i.prototype.Oa=function(){e.prototype.wD.call(this)},i.prototype.Oc=function(e){if(e instanceof t.Dd){if(this.B())return;this.mc();for(var i=this.za[0],n=new t.h,r=0;r<this.wa;r++)n.x=i.read(2*r),n.y=i.read(2*r+1),e.Eh(n,n),i.write(2*r,n.x),i.write(2*r+1,n.y)}else{if(this.B())return;this.mc(),this.re(1),this.mc(),i=this.za[0],n=this.za[1];var s=new t.Nd;for(r=0;r<this.wa;r++){s.x=i.read(2*r),s.y=i.read(2*r+1),s.z=n.read(r);var o=e.fp(s);i.write(2*r,o.x),i.write(2*r+1,o.y),n.write(r,o.z)}}this.Pc(1993)},i.prototype.Db=function(){return 0},i.prototype.getType=function(){return 550},i.prototype.Ke=function(){return 0},i.prototype.Qb=function(){return 0},i.prototype.Nb=function(t){return t==this||t instanceof i&&e.prototype.Nb.call(this,t)},i.prototype.lW=function(e,i){var n=this.wa;if(n=Math.min(n,i+1e3),0>i||i>=this.wa||n<i||1e3!=e.length)throw t.i.N();var r=n-i,s=[];for(this.ub(0).Vw(2*i,2*r,s,0,!0),i=0;i<r;i++)e[i]=t.h.construct(s[2*i],s[2*i+1]);return n},i.prototype.$x=function(){},i.prototype.iy=function(){},i.prototype.lu=function(){return!1},i.prototype.fj=function(){return!1},i.prototype.mg=function(){return null},i}(t.Gx);t.de=e}(X||(X={})),function(t){var e;(e=t.iL||(t.iL={}))[e.NotDetermined=0]="NotDetermined",e[e.Structure=1]="Structure",e[e.DegenerateSegments=2]="DegenerateSegments",e[e.Clustering=3]="Clustering",e[e.Cracking=4]="Cracking",e[e.CrossOver=5]="CrossOver",e[e.RingOrientation=6]="RingOrientation",e[e.RingOrder=7]="RingOrder",e[e.OGCPolylineSelfTangency=8]="OGCPolylineSelfTangency",e[e.OGCPolygonSelfTangency=9]="OGCPolygonSelfTangency",e[e.OGCDisconnectedInterior=10]="OGCDisconnectedInterior";var i=function(){function t(t,e,i){void 0===t?(this.Jj=0,this.Ko=this.Jo=-1):(this.Jj=t,this.Jo=e,this.Ko=i)}return t.prototype.Wt=function(t){this.Jj=t.Jj,this.Jo=t.Jo,this.Ko=t.Ko},t}();t.Md=i}(X||(X={})),function(t){t.O=function(){function e(){}return e.assert=function(e){if(!1===e)throw t.i.GK()},e.bK=function(t){return isNaN(t)?NaN:0===t?t:0<t?1:-1},e.Fu=function(t){var i;void 0===i&&(i=0);for(var n=[],r=0;r<t;r++)n[r]=e.lg(2,i);return n},e.lg=function(t,e){void 0===e&&(e=0);for(var i=[],n=0;n<t;n++)i[n]=e;return i},e.$u=function(t,e){var i,n;for(void 0===i&&(i=0),void 0===n&&(n=t.length-1);i<=n;i++)t[i]=e},e.Rk=function(t,e,i){return t<e?e:t>i?i:t},e.Th=function(t,e){var i=5381;return((i=((i=((i=void 0!==e?(e<<5)+e+(255&t):(i<<5)+i+(255&t))<<5)+i+(t>>8&255))<<5)+i+(t>>16&255))<<5)+i+(t>>24&255)&2147483647},e.uj=function(){throw Error("Not Implemented")},e.bB=function(t){return e.aU(t)+12345&2147483647},e.XG=function(t){var i=32,n=t%e.Qx|0,r=t/e.Qx|0;return 0==(i&=63)?t:(32>i?(t=n>>>i|r<<32-i,i=r>>i):(t=r>>i-32,i=0<=r?0:-1),i*e.Qx+(t>>>0))},e.aU=function(t){return(1103495168*(t|=0)|0)+(20077*t|0)|0},e.truncate=function(t){return 0>t?-1*Math.floor(Math.abs(t)):Math.floor(t)},e.MAX_SAFE_INTEGER=Math.pow(2,53)-1,e.MIN_SAFE_INTEGER=-e.MAX_SAFE_INTEGER,e.VC=65536,e.Qx=e.VC*e.VC,e}()}(X||(X={})),function(t){var e;(e=t.CL||(t.CL={}))[e.Project=0]="Project",e[e.Union=1]="Union",e[e.Difference=2]="Difference",e[e.Proximity2D=3]="Proximity2D",e[e.Relate=4]="Relate",e[e.Equals=5]="Equals",e[e.Disjoint=6]="Disjoint",e[e.Intersects=7]="Intersects",e[e.Within=8]="Within",e[e.Contains=9]="Contains",e[e.Crosses=10]="Crosses",e[e.Touches=11]="Touches",e[e.Overlaps=12]="Overlaps",e[e.Buffer=13]="Buffer",e[e.Distance=14]="Distance",e[e.Intersection=15]="Intersection",e[e.Clip=16]="Clip",e[e.Cut=17]="Cut",e[e.DensifyByLength=18]="DensifyByLength",e[e.DensifyByAngle=19]="DensifyByAngle",e[e.LabelPoint=20]="LabelPoint",e[e.GeodesicBuffer=21]="GeodesicBuffer",e[e.GeodeticDensifyByLength=22]="GeodeticDensifyByLength",e[e.ShapePreservingDensify=23]="ShapePreservingDensify",e[e.GeodeticLength=24]="GeodeticLength",e[e.GeodeticArea=25]="GeodeticArea",e[e.Simplify=26]="Simplify",e[e.SimplifyOGC=27]="SimplifyOGC",e[e.Offset=28]="Offset",e[e.Generalize=29]="Generalize",e[e.SymmetricDifference=30]="SymmetricDifference",e[e.ConvexHull=31]="ConvexHull",e[e.Boundary=32]="Boundary",e[e.SimpleRelation=33]="SimpleRelation";var i=function(){function t(){}return t.prototype.getType=function(){return null},t.prototype.wn=function(){},t.prototype.Iu=function(){return!1},t}();t.Je=i}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 13},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r,s){return e instanceof t.aa?(s=new t.Zc(e),this.V(s,i,[n],!1,r).next()):!0===r?(n=new t.BC(e,i,n,!1,s),t.Gh.local().V(n,i,s)):new t.BC(e,i,n,!1,s)},i.instance=null,i}(t.Je);t.AC=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r,s){this.ya=-1,this.Rd=e,this.$z=i,this.Cs=n,this.tT=new t.l,this.tT.Oa(),this.eo=-1,this.Ub=s}return e.prototype.next=function(){for(var t;null!=(t=this.Rd.next());)return this.ya=this.Rd.La(),this.eo+1<this.Cs.length&&this.eo++,this.buffer(t,this.Cs[this.eo]);return null},e.prototype.La=function(){return this.ya},e.prototype.buffer=function(e,i){return t.HK.buffer(e,i,this.$z,NaN,96,this.Ub)},e.prototype.qe=function(){},e}();t.BC=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 16},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n,r).next()):new t.lL(e,i,n,r)},i.instance=null,i}(t.Je);t.kL=e}(X||(X={})),function(t){var e=function(){function e(e,i,n){if(this.ya=-1,null==e)throw t.i.N();this.$=i,this.yk=e,this.qa=t.ta.Wd(n,i,!1)}return e.prototype.next=function(){var e;return null!=(e=this.yk.next())?(this.ya=this.yk.La(),t.Ud.clip(e,this.$,this.qa,0)):null},e.prototype.La=function(){return this.ya},e.prototype.qe=function(){},e}();t.lL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 31},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n){return e instanceof t.aa?t.DC.rE(e):new t.DC(i,e,n)},i.instance=null,i}(t.Je);t.CC=e}(X||(X={})),function(t){var e=function(){function e(e,i,n){if(this.uA=new t.Zt,this.ya=-1,null==i)throw t.i.N();this.cH=e,this.Ic=!1,this.yk=i,this.Ub=n}return e.prototype.next=function(){if(this.cH){if(!this.Ic){var t=this.dO(this.yk);return this.Ic=!0,t}return null}if(!this.Ic){if(null!=(t=this.yk.next()))return this.ya=this.yk.La(),e.rE(t);this.Ic=!0}return null},e.prototype.La=function(){return this.ya},e.prototype.dO=function(t){for(var e;null!=(e=t.next());)this.uA.Ib(e);return this.uA.cR()},e.prototype.qe=function(){if(!this.Ic){if(!this.cH)throw t.i.fa("Invalid call for non merging convex hull.");var e=this.yk.next();if(null==e)throw t.i.fa("Expects a non-null geometry.");this.uA.Ib(e)}},e.rE=function(i){if(e.VS(i))return i;var n=i.getType();if(t.Vk.yd(n))return(n=new t.Ta(i.description)).oc(i,!0),n;if(550==n&&2==i.I()){var r=new t.Sa;return n=new t.Ta(i.description),i.ve(0,r),n.nf(r),i.ve(1,r),n.lineTo(r),n}return t.Zt.RO(i)},e.VS=function(e){if(e.B())return!0;var i=e.getType();return 33==i||197==i||!t.Vk.yd(i)&&(550==i?1==e.I():1607==i?1==e.da()&&2>=e.I():1==e.da()&&(2>=e.I()||t.Zt.JG(e,0)))},e}();t.DC=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 17},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r,s){return new t.nL(e,i,n,r,s)},i.instance=null,i}(t.Je);t.mL=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r,s){if(this.Tf=null,null==i||null==n)throw t.i.fa("invalid argument");this.qT=e,this.nA=i,this.lH=n,e=t.ta.mv(i,n),this.qa=t.ta.Wd(r,e,!0),this.kH=-1,this.nd=s}return e.prototype.La=function(){return 0},e.prototype.next=function(){return this.RQ(),++this.kH<this.Tf.length?this.Tf[this.kH]:null},e.prototype.RQ=function(){if(null==this.Tf)switch(this.Tf=[],this.nA.getType()){case 1607:this.TQ();break;case 1736:this.SQ()}},e.prototype.TQ=function(){var e=new t.Ta,i=new t.Ta,n=new t.Ta;this.Tf.push(e),this.Tf.push(i);var r=[];t.LK.JK(this.qT,this.nA,this.lH,this.qa,r,this.nd);for(var s=0;s<r.length;s++){var o=r[s];if(0==o.bt)e.add(o.X,!1);else if(1==o.bt||2==o.bt)i.add(o.X,!1);else if(3==o.bt)this.Tf.push(o.X);else{if(4!=o.bt)throw t.i.fa("internal");n.add(o.X,!1)}}n.B()||e.B()&&i.B()&&!(3<=this.Tf.length)||this.Tf.push(n),e.B()&&i.B()&&3>this.Tf.length&&(this.Tf.length=0)},e.prototype.SQ=function(){var e=new t.ia(0),i=new t.gd,n=i.aF(),r=i.Ib(this.nA),s=i.Ib(this.lH),o=new t.Fg;try{o.Ft(i,this.qa,this.nd),o.dl(n,r,s,e);var a=i.Ne(r),h=new t.Da,l=new t.Da;for(this.Tf.length=0,this.Tf.push(h),this.Tf.push(l),r=0;r<e.size;r++){var c=new t.gd,u=c.Ib(a),d=c.Ib(i.Ne(e.get(r)));o.dr(c,this.nd);var f=o.Av(u,d),p=c.Ne(f);if(!p.B()){var g=i.KF(e.get(r),n);2==g?h.add(p,!1):1==g?l.add(p,!1):this.Tf.push(p);var v=new t.gd;u=v.Ib(a),d=v.Ib(i.Ne(e.get(r))),o.dr(v,this.nd),a=v.Ne(o.im(u,d))}}!a.B()&&0<e.size&&this.Tf.push(a),h.B()&&l.B()&&(this.Tf.length=0)}finally{o.Ug()}},e.prototype.qe=function(){},e}();t.nL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 18},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n){if(e instanceof t.aa)return e=new t.Zc(e),this.V(e,i,n).next();if(0>=i)throw t.i.N();return new t.oL(e,i,n)},i.instance=null,i}(t.Je);t.Xl=e}(X||(X={})),function(t){var e=function(){function e(t,e){this.ya=-1,this.Rd=t,this.Ps=e}return e.prototype.La=function(){return this.ya},e.prototype.next=function(){var t;return null!=(t=this.Rd.next())?(this.ya=this.Rd.La(),this.NP(t)):null},e.prototype.NP=function(e){if(e.B()||1>e.Db())return e;var i=e.getType();if(1736==i||1607==i)return this.Ny(e);if(t.aa.yd(i))return this.PP(e);if(197==i)return this.OP(e);throw t.i.Qa()},e.prototype.PP=function(e){if(e.Qb()<=this.Ps)return e;var i=new t.Ta(e.description);return i.oc(e,!0),this.Ny(i)},e.prototype.OP=function(e){var i=new t.Da(e.description);i.ad(e,!1);var n=new t.l;return e.A(n),e=n.ca(),n.R()<=this.Ps&&e<=this.Ps?i:this.Ny(i)},e.prototype.Ny=function(e){for(var i=e.Ia(),n=e.Ga();n.$a();)for(var r=!0;n.Ha();){var s=n.ha();if(322!=s.getType())throw t.i.fa("not implemented");var o=n.On(),a=s.Qb();if(a>this.Ps){var h=Math.ceil(a/this.Ps);a=new t.Sa(e.description),r&&(s.To(a),i.nf(a));var l=r=1/h,c=0;for(--h;c<h;c++)s.Tw(l,a),i.lineTo(a),l+=r;o?i.Ap():(s.Po(a),i.lineTo(a))}else o?i.Ap():i.oc(s,r);r=!1}return i},e.prototype.qe=function(){},e}();t.oL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.getType=function(){return 2},i.prototype.V=function(e,i,n,r){return e instanceof t.aa?(e=new t.Zc(e),i=new t.Zc(i),this.V(e,i,n,r).next()):new t.qL(e,i,n,r)},i.im=function(e,n,r,s){if(e.B()||n.B())return e;var o=e.Db(),a=n.Db();if(o>a)return e;var h=e.getType(),l=n.getType(),c=new t.l,u=new t.l,d=new t.l;e.A(c),n.A(u),d.K(c),d.Zb(u);var f=(d=t.ta.Wd(r,d,!0))*Math.sqrt(2)*1.00001,p=new t.l;if(p.K(c),p.W(f,f),!p.isIntersecting(u))return e;if(1==o&&2==a)return i.KV(e,n,l,r,s);if(33==h)switch(t.Vk.yd(l)?(r=new t.Ta(n.description),r.oc(n,!0)):r=n,l){case 1736:return i.XU(e,r,d);case 1607:return i.YU(e,r,d);case 550:return i.VU(e,r,d);case 197:return i.UU(e,r,d);case 33:return i.WU(e,r,d);default:throw t.i.N()}else if(550==h)switch(l){case 1736:return i.nU(e,n,d);case 197:return i.lU(e,n,d);case 33:return i.mU(e,n,d)}return t.Fg.im(e,n,r,s)},i.XU=function(e,i,n){return 0==t.hd.KG(i,e,n)?e:e.Ia()},i.YU=function(e,i,n){var r=e.D();i=i.Ga();for(var s=n*Math.sqrt(2)*1.00001,o=s*s,a=new t.l;i.$a();)for(;i.Ha();){var h=i.ha();if(h.A(a),a.W(s,s),a.contains(r)){if(h.qs(r,n))return e.Ia();var l=h.ac();if(t.h.yc(r,l)<=o)return e.Ia();if(l=h.wc(),t.h.yc(r,l)<=o)return e.Ia()}}return e},i.VU=function(e,i,n){var r=i.ub(0);i=i.I();var s=e.D(),o=new t.h;n=n*Math.sqrt(2)*1.00001,n*=n;for(var a=0;a<i;a++)if(r.tc(2*a,o),t.h.yc(o,s)<=n)return e.Ia();return e},i.UU=function(e,i,n){var r=new t.l;return i.A(r),r.W(n,n),i=e.D(),r.contains(i)?e.Ia():e},i.WU=function(e,i,n){n=n*Math.sqrt(2)*1.00001,n*=n;var r=e.D();return i=i.D(),t.h.yc(r,i)<=n?e.Ia():e},i.nU=function(e,i,n){var r=new t.l;i.A(r),r.W(n,n);for(var s=e.I(),o=!1,a=[],h=0;h<s;h++)a[h]=!1;var l=new t.h;for(h=0;h<s;h++)e.D(h,l),r.contains(l)&&0!=t.hd.Yd(i,l,n)&&(o=!0,a[h]=!0);if(!o)return e;for(i=e.Ia(),h=0;h<s;h++)a[h]||i.Fd(e,h,h+1);return i},i.lU=function(e,i,n){var r=new t.l;i.A(r),r.W(n,n),i=e.I();var s=!1;n=[];for(var o=0;o<i;o++)n[o]=!1;var a=new t.h;for(o=0;o<i;o++)e.D(o,a),r.contains(a)&&(s=!0,n[o]=!0);if(!s)return e;for(r=e.Ia(),o=0;o<i;o++)n[o]||r.Fd(e,o,o+1);return r},i.mU=function(e,i,n){var r=e.ub(0),s=e.I(),o=i.D(),a=new t.h,h=!1;i=[];for(var l=0;l<s;l++)i[l]=!1;for(n=(l=n*Math.sqrt(2)*1.00001)*l,l=0;l<s;l++)r.tc(2*l,a),t.h.yc(a,o)<=n&&(h=!0,i[l]=!0);if(!h)return e;for(r=e.Ia(),l=0;l<s;l++)i[l]||r.Fd(e,l,l+1);return r},i.KV=function(e,i,n,r,s){var o=new t.Fh;e.bn(o);var a=new t.l;return i.A(a),o.Zb(a),o.W(.1*o.R(),.1*o.ca()),(a=new t.Da).ad(o,!1),1736==n?a.add(i,!0):a.ad(i,!0),t.Xj.local().V(e,a,r,s)},i.instance=null,i}(t.Je);t.kp=e}(X||(X={})),function(t){var e=function(){function e(t,e,i,n){this.ts=null==e,this.ya=-1,this.Rd=t,this.$z=i,this.wT=e.next(),this.Ub=n}return e.prototype.next=function(){return this.ts?null:null!=(e=this.Rd.next())?(this.ya=this.Rd.La(),t.kp.im(e,this.wT,this.$z,this.Ub)):null;var e},e.prototype.La=function(){return this.ya},e.prototype.qe=function(){},e}();t.qL=e}(X||(X={})),function(t){var e=function(){function e(e){this.nd=e,this.Bj=new t.l,this.Bj.Oa(),this.oh=new t.l,this.oh.Oa()}return e.prototype.Nt=function(){var t=this.Bj.v;this.Bj.v=this.oh.v,this.oh.v=t,t=this.Bj.C,this.Bj.C=this.oh.C,this.oh.C=t,t=this.Bj.G,this.Bj.G=this.oh.G,this.oh.G=t,t=this.Bj.H,this.Bj.H=this.oh.H,this.oh.H=t},e.prototype.eQ=function(e,i){if(null!=this.nd&&!this.nd.progress(-1,-1))throw t.i.fu("user_canceled");var n=!this.Bj.isIntersecting(this.oh);return t.aa.Hc(e.getType())&&t.aa.Hc(i.getType())?e.I()>i.I()?this.gE(e,i,n):(this.Nt(),e=this.gE(i,e,n),this.Nt(),e):550==e.getType()&&t.aa.Hc(i.getType())?(e=this.hE(i,e,n),this.Nt(),e):550==i.getType()&&t.aa.Hc(e.getType())?this.hE(e,i,n):550==e.getType()&&550==i.getType()?e.I()>i.I()?this.iE(e,i):(this.Nt(),e=this.iE(i,e),this.Nt(),e):0},e.prototype.gE=function(e,i,n){var r=e.Ga(),s=i.Ga(),o=new t.l,a=new t.l,h=17976931348623157e292;if(!n&&this.pY(e,i,r,s))return 0;for(;r.$a();)for(;r.Ha();)if((e=r.ha()).A(o),!(o.px(this.oh)>h)){for(;s.$a();)for(;s.Ha();)if((i=s.ha()).A(a),o.px(a)<h&&(i=e.tb(i,n),(i*=i)<h)){if(0==i)return 0;h=i}s.Zi()}return Math.sqrt(h)},e.prototype.hE=function(e,i,n){var r=e.Ga(),s=new t.l,o=17976931348623157e292,a=new t.h,h=i.I();for(n=!n&&1736==e.getType();r.$a();)for(;r.Ha();){var l=r.ha();if(l.A(s),!(1<h&&s.px(this.oh)>o)){for(var c=0;c<h;c++){if(i.D(c,a),n&&0!=t.hd.Yd(e,a,0))return 0;var u=l.fe(a,!1);if(a.sub(l.hc(u)),(u=a.Sk())<o){if(0==u)return 0;o=u}}n=!1}}return Math.sqrt(o)},e.prototype.iE=function(e,i){for(var n,r=17976931348623157e292,s=new t.h,o=new t.h,a=e.I(),h=i.I(),l=0;l<a;l++)if(e.D(l,s),!(1<h&&this.oh.iK(s)>r))for(var c=0;c<h;c++)if(i.D(c,o),(n=t.h.yc(s,o))<r){if(0==n)return 0;r=n}return Math.sqrt(r)},e.prototype.pY=function(e,i,n,r){if(1736==e.getType()){for(;r.$a();)if(r.Ha()){var s=r.ha();if(0!=t.hd.Yd(e,s.wc(),0))return!0}r.Zi()}if(1736==i.getType()){for(;n.$a();)if(n.Ha()&&(e=n.ha(),0!=t.hd.Yd(i,e.wc(),0)))return!0;n.Zi()}return!1},e.prototype.gm=function(t,e){return t.B()||e.B()?NaN:(t.A(this.Bj),e.A(this.oh),this.eQ(t,e))},e}(),i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return Q(n,i),n.prototype.V=function(i,n,r){if(null==i||null==n)throw t.i.N();if(i.B()||n.B())return NaN;var s=i.getType(),o=n.getType();if(33==s){if(33==o)return t.h.tb(i.D(),n.D());if(197==o)return r=new t.l,n.A(r),r.tb(i.D());(s=new t.de).add(i),i=s}else if(197==s){if(197==o)return o=new t.l,i.A(o),r=new t.l,n.A(r),r.tb(o);(s=new t.Da).ad(i,!1),i=s}return 33==o?((o=new t.de).add(n),n=o):197==o&&((o=new t.Da).ad(n,!1),n=o),new e(r).gm(i,n)},n.local=function(){return null===n.instance&&(n.instance=new n),n.instance},n.prototype.getType=function(){return 14},n.instance=null,n}(t.Je);t.rL=i}(X||(X={})),function(t){var e=function(){function e(t,e,i,n){this.zH=t,this.DH=e,this.nd=n,this.$G=i}return e.prototype.next=function(){var t=this.zH.next();return null==t?null:this.zC(t)},e.prototype.La=function(){return this.zH.La()},e.prototype.zC=function(e){var i=e.getType();if(t.aa.Rn(i))return e;if(197==i)return(i=new t.Da(e.description)).ad(e,!1),this.zC(i);if(e.B())return e;if(null==e)throw t.i.Qa();i=e.Ia();for(var n=new t.yb,r=0,s=e.da();r<s;r++)this.TK(e,r,i,n);return i},e.prototype.TK=function(e,i,n,r){if(!(2>e.Ja(i))){var s=e.Ba(i),o=e.Vc(i)-1,a=e.ub(0),h=e.dc(i),l=new t.ia(0);l.Jb(e.Ja(i)+1);var c=new t.ia(0);for(c.Jb(e.Ja(i)+1),l.add(h?s:o),l.add(s),s=new t.h;1<l.size;){var u=l.Fc();l.If();var d=l.Fc();e.D(u,s),r.Dc(s),e.D(d,s),r.Qc(s),0<=(d=this.SK(r,s,a,u,d,o))?(l.add(d),l.add(u)):c.add(u)}if(h||c.add(l.get(0)),c.size==l.size)n.addPath(e,i,!0);else if(2<=c.size&&(!this.$G||2!=c.size||!(h||t.h.tb(e.Na(c.get(0)),e.Na(c.get(1)))<=this.DH))){for(i=new t.Sa,r=0,o=c.size;r<o;r++)e.ve(c.get(r),i),0==r?n.nf(i):n.lineTo(i);h&&(this.$G||2!=c.size||n.lineTo(i),n.Ap())}}},e.prototype.SK=function(t,e,i,n,r,s){var o=r-1;for(r<=n&&(o=s),s=r=-1,n+=1;n<=o;n++){i.tc(2*n,e);var a=e.x,h=e.y;t.hc(t.fe(e,!1),e),e.x-=a,e.y-=h,(a=e.length())>this.DH&&a>s&&(r=n,s=a)}return r},e.prototype.qe=function(){},e}();t.sL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 29},i.prototype.V=function(e,i,n,r){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n,r).next()):new t.sL(e,i,n,r)},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.instance=null,i}(t.Je);t.EC=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 21},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r,s,o,a,h){return e instanceof t.aa?(h=new t.Zc(e),this.V(h,i,n,[r],s,o,!1,a).next()):!0===a?(n=new t.GC(e,i,n,r,s,!1,!1,h),t.Gh.local().V(n,i,h)):new t.GC(e,i,n,r,s,!1,!1,h)},i.instance=null,i}(t.Je);t.FC=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r,s,o,a,h){if(o)throw t.i.Ie();if(null==i)throw t.i.N();this.ya=-1,this.Ms=e,this.vg=i,this.ze=n,this.Cs=r,this.$n=s,this.eo=-1,this.Ub=h,this.uT=new t.l,this.uT.Oa()}return e.prototype.next=function(){for(var t;null!=(t=this.Ms.next());)return this.ya=this.Ms.La(),this.eo+1<this.Cs.length&&this.eo++,this.$Q(t,this.Cs[this.eo]);return null},e.prototype.La=function(){return this.ya},e.prototype.$Q=function(e,i){return t.VK.buffer(e,this.vg,this.ze,i,this.$n,this.Ub)},e.prototype.qe=function(){},e}();t.GC=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 24},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n){if(null==i)throw t.i.N();if(e.B()||1>e.Db())return 0;if(4==n)throw t.i.Ie();var r=t.cb.sc(i),s=t.cb.vv(r),o=t.cb.ev(r);s*=2-s;var a=r.Hd().ai,h=e.getType();if(1736==h||197==h)var l=e.mg();else t.aa.yd(h)?(l=new t.Ta(e.description)).oc(e,!0):l=e;if(0==r.Nb(i)){if(t.cb.Wc(i)){l=t.Hh.lj(l,i),1607==h&&l==e&&(l=t.aa.jg(e)),e=new t.Nc,t.cb.gh(i).cn(e),h=0;for(var c=l.I();h<c;h++){var u=l.Na(h);u.x=t.Hh.Zm(u.x,e),l.Cb(h,u)}}e=l.Ia(),l=t.Hh.WI(i,r,l,e)?e:t.cb.zh(l,i,r)}return this.hQ(l,n,o,s,a)},i.prototype.hQ=function(e,i,n,r,s){var o=new t.ga(0),a=0;for(e=e.Ga();e.$a();)for(;e.Ha();){var h=e.ha(),l=h.ac();h=h.wc(),l.scale(s),h.scale(s),t.kb.wd(n,r,l.x,l.y,h.x,h.y,o,null,null,i),a+=o.u}return a},i.instance=null,i}(t.Je);t.vL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 18},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r,s){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n,r,s).next()):new t.uL(e,n,r,i,-1,-1,s)},i.instance=null,i}(t.Je);t.tL=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r,s,o){if(0<o)throw t.i.Ie();if(4!=n&&0<s)throw t.i.Ie();if(null==i)throw t.i.N();this.ya=-1,this.Ms=e,this.vg=i,this.ze=n,this.DT=r,this.CT=s}return e.prototype.next=function(){for(var t;null!=(t=this.Ms.next());)return this.ya=this.Ms.La(),this.Zy(t);return null},e.prototype.La=function(){return this.ya},e.prototype.Zy=function(e){return t.cj.Qr(e,this.vg,this.ze,this.DT,this.CT,this.Ub)},e.prototype.qe=function(){},e}();t.uL=e}(X||(X={})),function(t){!function(t){t[t.Unknown=0]="Unknown",t[t.Contains=1]="Contains",t[t.Within=2]="Within",t[t.Equals=3]="Equals",t[t.Disjoint=4]="Disjoint",t[t.Touches=8]="Touches",t[t.Crosses=16]="Crosses",t[t.Overlaps=32]="Overlaps",t[t.NoThisRelation=64]="NoThisRelation",t[t.Intersects=1073741824]="Intersects",t[t.IntersectsOrDisjoint=1073741828]="IntersectsOrDisjoint"}(t.cL||(t.cL={})),t.wL=function(){function e(){}return e.nW=function(e,i){var n=e.getType(),r=i.getType();if(t.aa.xj(n)){var s=e.Bb;if(null!=s&&null!=(s=s.Fk)){if(33==r){var o=i.D();s=s.So(o.x,o.y)}else o=new t.l,i.A(o),s=s.Ro(o);if(1==s)return 1;if(0==s)return 4}}if(t.aa.xj(r)&&null!=(s=i.Bb)&&null!=(s=s.Fk)){if(33==n?(e=e.D(),s=s.So(e.x,e.y)):(i=new t.l,e.A(i),s=s.Ro(i)),1==s)return 2;if(0==s)return 4}return 0},e}()}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.getType=function(){return 15},i.prototype.V=function(e,i,n,r,s){return e instanceof t.aa?(e=new t.Zc(e),i=new t.Zc(i),this.V(e,i,n,r,void 0===s?-1:s).next()):void 0===s?new t.HC(e,i,n,r,-1):new t.HC(e,i,n,r,s)},i.prototype.wn=function(e,i,n){this.Iu(e)&&(i=t.ta.kj(i,e,!1),e.fj(n)||e.lu(i,n))},i.prototype.Iu=function(e){return t.Nx.zE(e)},i.instance=null,i}(t.Je);t.Xj=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r,s){if(this.ts=null==i,this.ya=-1,this.Rd=e,this.vg=n,this.Se=i.next(),this.Dj=this.Se.getType(),this.Ub=r,this.Fi=s,-1!=this.Fi&&(0>=this.Fi||7<this.Fi))throw t.i.N("bad dimension mask")}return e.prototype.next=function(){if(this.ts)return null;if(null!=this.zw){var t=this.zw.next();if(null!=t)return t;this.zw=null}for(;null!=(t=this.Rd.next());)return this.ya=this.Rd.La(),-1==this.Fi?t=this.Ea(t):(this.zw=this.PS(t),t=this.zw.next()),t;return null},e.prototype.La=function(){return this.ya},e.prototype.Ea=function(e){var i=this.zK(e);if(null!=i)return i;i=t.ta.mv(this.Se,e);var n=t.ta.Wd(this.vg,i,!0);i=new t.l,this.Se.A(i);var r=new t.l;return e.A(r),i.W(2*n,2*n),i.Ea(r),i.W(100*n,100*n),n=t.Ud.clip(this.Se,i,0,0),e=t.Ud.clip(e,i,0,0),t.Fg.Av(e,n,this.vg,this.Ub)},e.prototype.QI=function(e,i,n){var r=0;if(1&i)null==n[0]&&(n[0]=new t.de(e)),r++;else for(var s=0;s<n.length-1;s++)n[s]=n[s+1];if(2&i)null==n[r]&&(n[r]=new t.Ta(e)),r++;else for(s=r;s<n.length-1;s++)n[s]=n[s+1];if(4&i)null==n[r]&&(n[r]=new t.Da(e)),r++;else for(s=r;s<n.length-1;s++)n[s]=n[s+1];if(3!=r){for(e=[],s=0;s<r;s++)e[s]=n[s];return new t.Zc(e)}return new t.Zc(n)},e.prototype.PS=function(e){var i=this.zK(e);if(null!=i){var n=[null,null,null];return n[i.Db()]=i,this.QI(e.description,this.Fi,n)}i=t.ta.mv(this.Se,e),n=t.ta.Wd(this.vg,i,!0),i=new t.l,this.Se.A(i),i.W(2*n,2*n);var r=new t.l;return e.A(r),i.Ea(r),i.W(100*n,100*n),n=t.Ud.clip(this.Se,i,0,0),i=t.Ud.clip(e,i,0,0),n=t.Fg.Pz(i,n,this.vg,this.Ub),this.QI(e.description,this.Fi,n)},e.prototype.zK=function(i){var n=t.ta.mv(i,this.Se),r=t.ta.Wd(this.vg,n,!0);n=i.getType();var s=i.B(),o=this.Se.B();if(!(o=s||o)){o=new t.l,i.A(o);var a=new t.l;this.Se.A(a),a.W(2*r,2*r),o=!o.isIntersecting(a)}if(!o)if(4==(a=t.wL.nW(this.Se,i)))o=!0;else{if(2&a)return this.Se;if(1&a)return i}if(o)return(r=t.aa.tf(n))<(o=t.aa.tf(this.Dj))?e.HB(i,s):r>o||0==r&&550==n&&33==this.Dj?this.nJ():e.HB(i,s);if((-1==this.Fi||4==this.Fi)&&197==n&&197==this.Dj)return r=this.Se,n=new t.l,i.A(n),s=new t.l,r.A(s),n.Ea(s),r=new t.Fh,i.copyTo(r),r.Xo(n),r;if(197==n&&0==t.aa.tf(this.Dj)||197==this.Dj&&0==t.aa.tf(n))return s=197==n?i:this.Se,i=197==n?this.Se:i,n=new t.l,s.A(n),t.Ud.clip(i,n,r,0);if(0==t.aa.tf(n)&&0<t.aa.tf(this.Dj)||0<t.aa.tf(n)&&0==t.aa.tf(this.Dj)){if(r=t.ta.kj(this.vg,i,!1),550==n||33==n)return t.Fg.zG(i,this.Se,r);if(550==this.Dj||33==this.Dj)return t.Fg.zG(this.Se,i,r);throw t.i.Qa()}return-1!=this.Fi&&2!=this.Fi||1607!=n||1736!=this.Dj?-1!=this.Fi&&2!=this.Fi||1736!=n||1607!=this.Dj?null:this.wK(this.Se,i):this.wK(i,this.Se)},e.prototype.wK=function(e,i){var n=e,r=i,s=t.ta.kj(this.vg,i,!1),o=new t.l;r.A(o);var a=new t.l;n.A(a),a.W(2*s,2*s),o.Ea(a),o.W(10*s,10*s),n=e=t.Ud.clip(e,o,0,0),a=new t.ia(0);var h=-1,l=r.Bb;if(null!=l){var c=l.Fk;if(null!=c){h=0,a.Jb(n.I()+n.da());for(var u=new t.l,d=n.Ga();d.$a();)for(;d.Ha();){d.ha().A(u);var f=c.Ro(u);1==f?a.add(1):0==f?a.add(0):(a.add(-1),h++)}}}if(5<i.I()&&(l=(r=i=t.Ud.clip(i,o,0,0)).Bb),0>h&&(h=n.yz()),o=n.I()+r.I(),h*r.I()>Math.log(o)*o*4)return null;o=null,h=r.Ga(),null!=l&&null!=l.Fb&&(o=l.Fb),null==o&&20<r.I()&&(o=t.ta.nE(r)),e=e.Ia(),r=null,l=n.Ga(),c=[0,0,0,0,0,0,0,0,0],u=new t.be(0),d=new t.ig,f=-1;for(var p=0,g=0,v=0<a.size,m=-1;l.$a();){m=l.gb;var y=0;for(f=-1,p=0;l.Ha();){var _=v?t.O.truncate(a.get(g)):-1;g++;var b=l.ha();if(0>_){if(null!=o)for(null==r?r=o.vR(b,s):r.Uo(b,s),_=r.next();-1!=_;_=r.next()){h.Vb(o.ja(_)),_=h.ha();var w=b.Ea(_,null,c,null,s);for(_=0;_<w;_++)u.add(c[_])}else for(h.Zi();h.$a();)for(;h.Ha();)for(_=h.ha(),w=b.Ea(_,null,c,null,s),_=0;_<w;_++)u.add(c[_]);if(0<u.size){u.Vd(0,u.size,(function(t,e){return t-e}));var x=0;u.add(1),w=-1,_=0;for(var T=u.size;_<T;_++){var A=u.get(_);if(A!=x){var M=!1;if(0!=x||1!=A?(b.ah(x,A,d),x=d.get()):(x=b,M=!0),2<=y){if(e.Dr(n,m,f,p,3==y),1!=this.QD(i,x.ac(),s)&&1!=this.RD(i,x,s))return null;e.oc(x,!1),y=1,p=0}else switch(w=this.RD(i,x,s),w){case 1:M?2>y?(f=l.wb()-n.Ba(m),p=1,y=0==y?3:2):p++:(e.oc(x,0==y),y=1);break;case 0:y=0,f=-1,p=0;break;default:return null}x=A}}}else{if(0>(_=this.QD(i,b.ac(),s)))return null;1==_?(2>y&&(f=l.wb()-n.Ba(m),y=0==y?3:2),p++):(f=-1,p=0)}u.clear(!1)}else 0!=_&&1==_&&(0==y?(y=3,f=l.wb()-n.Ba(m)):1==y?(y=2,f=l.wb()-n.Ba(m)):p++)}2<=y&&(e.Dr(n,m,f,p,3==y),f=-1)}return e},e.prototype.QD=function(e,i,n){return t.Dg.wm(e,i,n)},e.prototype.RD=function(e,i,n){var r=i.ac();i=i.wc();var s=t.Dg.wm(e,r,n),o=t.Dg.wm(e,i,n);return 1==s&&0==o||0==s&&1==o?-1:0==s||0==o?0:1==s||1==o?1:((s=new t.h).add(r,i),s.scale(.5),0==(e=t.Dg.wm(e,s,n))?0:1==e?1:-1)},e.HB=function(t,e){return e?t:t.Ia()},e.prototype.nJ=function(){return null==this.yH&&(this.yH=this.Se.Ia()),this.yH},e.prototype.qe=function(){},e}();t.HC=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 28},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r,s,o,a){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n,r,s,o,a).next()):new t.xL(e,i,n,r,s,o,a)},i.instance=null,i}(t.Je);t.IC=e}(X||(X={})),function(t){var e=function(){function e(t,e,i,n,r,s,o){this.ya=-1,this.Rd=t,this.Mj=e,this.Ka=i,this.Ki=n,this.CA=r,this.uH=s,this.nd=o}return e.prototype.next=function(){var t=this.Rd.next();return null!=t?(this.ya=this.Rd.La(),this.jL(t)):null},e.prototype.La=function(){return this.ya},e.prototype.jL=function(e){var i=0>=this.uH?t.ta.kj(this.Mj,e,!1):this.uH;return t.IK.V(e,this.Ka,this.Ki,this.CA,i,this.nd)},e.prototype.qe=function(){},e}();t.xL=e}(X||(X={})),function(t){var e;(e=t.NK||(t.NK={}))[e.clipToDomainOnly=1]="clipToDomainOnly",e[e.clipWithHorizon=2]="clipWithHorizon",e[e.foldAndClipWithHorizon=3]="foldAndClipWithHorizon";var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 0},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n).next()):new t.yL(e,i,n)},i.prototype.transform=function(e,i,n,r){return t.bu.transform(e,i,n,r,!0)},i.prototype.Qt=function(e,i,n,r){return t.bu.Qt(e,i,n,r)},i.instance=null,i}(t.Je);t.Hx=i}(X||(X={})),function(t){var e=function(){function e(t,e,i){this.ya=-1,this.Rd=t,this.MT=e,this.nd=i}return e.prototype.next=function(){var e=this.Rd.next();return null!=e?(this.ya=this.Rd.La(),t.bu.zh(e,this.MT,this.nd)):null},e.prototype.La=function(){return this.ya},e.prototype.qe=function(){},e}();t.yL=e}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.reset=function(){this.ph=this.xk=-1,this.us=this.kq=!1},e.prototype.AQ=function(t,e,i){for(t.Vb(e,i);t.Ha();){var n=t.ha();if(0!=(n=n.Qb()))return t.wb()}for(t.Vb(e,i);t.Ez();)if(0!=(n=(n=t.li()).Qb()))return t.wb();return-1},e.prototype.BQ=function(t,e){for(t.Vb(e,-1);t.Ez();)if(0!=t.li().Qb())return t.wb();return-1},e.prototype.zQ=function(t,e){for(t.Vb(e,-1),t.ha();t.Ha();)if(0!=t.ha().Qb())return t.wb();return-1},e.prototype.yQ=function(e,i,n,r){if(this.xk=this.AQ(i,n,r),-1!=this.xk){i.Vb(this.xk,-1);var s=i.ha(),o=s.hc(s.fe(e,!1));if(n=t.h.yc(o,e),(r=new t.h).L(o),r.sub(s.ac()),(o=new t.h).L(e),o.sub(s.ac()),this.kq=0>r.wi(o),this.ph=this.zQ(i,this.xk),-1!=this.ph){i.Vb(this.ph,-1);var a=(s=i.ha()).fe(e,!1);a=s.hc(a);var h=t.h.yc(a,e);h>n?this.ph=-1:(r.L(a),r.sub(s.ac()),o.L(e),o.sub(s.ac()),this.us=0>r.wi(o))}-1==this.ph&&(this.ph=this.BQ(i,this.xk),-1!=this.ph&&(i.Vb(this.ph,-1),a=(s=i.ha()).fe(e,!1),a=s.hc(a),(h=t.h.yc(a,e))>n?this.ph=-1:(r.L(a),r.sub(s.ac()),o.L(e),o.sub(s.ac()),this.us=0>r.wi(o),e=this.xk,this.xk=this.ph,this.ph=e,e=this.kq,this.kq=this.us,this.us=e)))}},e.prototype.cO=function(t,e,i,n,r){return i=i.Ga(),this.yQ(t,i,n,r),-1!=this.xk&&-1==this.ph?this.kq:-1!=this.xk&&-1!=this.ph?this.kq==this.us?this.kq:(i.Vb(this.xk,-1),t=i.ha().kg(),i.Vb(this.ph,-1),e=i.ha().kg(),0<=t.wi(e)):e},e}(),i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return Q(n,i),n.local=function(){return null===n.instance&&(n.instance=new n),n.instance},n.prototype.getType=function(){return 3},n.prototype.nz=function(e,i,n){var r;if(void 0===r&&(r=!1),e.B())return new t.$l;i=i.D();var s=e,o=e.getType();switch(197==o&&((s=new t.Da).ad(e,!1),o=1736),o){case 33:return this.xI(s,i);case 550:return this.jI(s,i);case 1607:case 1736:return this.bU(s,i,n,r);default:throw t.i.fa("not implemented")}},n.prototype.oz=function(e,i){if(e.B())return new t.$l;i=i.D();var n=e,r=e.getType();switch(197==r&&((n=new t.Da).ad(e,!1),r=1736),r){case 33:return this.xI(n,i);case 550:case 1607:case 1736:return this.jI(n,i);default:throw t.i.fa("not implemented")}},n.prototype.pz=function(e,i,n,r){if(0>r)throw t.i.N();if(e.B())return[];i=i.D();var s=e,o=e.getType();switch(197==o&&((s=new t.Da).ad(e,!1),o=1736),o){case 33:return this.TU(s,i,n,r);case 550:case 1607:case 1736:return this.tU(s,i,n,r);default:throw t.i.fa("not implemented")}},n.prototype.bU=function(i,n,r,s){if(1736==i.getType()&&r&&(r=new t.l,i.A(r),r=t.ta.Wd(null,r,!1),0!=(s?t.hd.Yd(i,n,0):t.hd.Yd(i,n,r)))){var o=new t.$l(n,0,0);return s&&o.WJ(!0),o}var a=i.Ga();o=new t.h;for(var h=r=-1,l=17976931348623157e292,c=0;a.$a();)for(;a.Ha();){var u=a.ha();u=u.hc(u.fe(n,!1));var d=t.h.yc(u,n);d<l?(c=1,o=u,r=a.wb(),h=a.gb,l=d):d==l&&c++}return o=new t.$l(o,r,Math.sqrt(l)),s&&(a.Vb(r,h),u=a.ha(),s=0>t.h.Uq(n,u.ac(),u.wc()),1<c&&((c=new e).reset(),s=c.cO(n,s,i,r,h)),o.WJ(s)),o},n.prototype.xI=function(e,i){return e=e.D(),i=t.h.tb(e,i),new t.$l(e,0,i)},n.prototype.jI=function(e,i){for(var n=e.ub(0),r=e.I(),s=e=0,o=0,a=17976931348623157e292,h=0;h<r;h++){var l=new t.h;n.tc(2*h,l);var c=t.h.yc(l,i);c<a&&(s=l.x,o=l.y,e=h,a=c)}return(i=new t.$l).ey(s,o,e,Math.sqrt(a)),i},n.prototype.TU=function(e,i,n,r){return 0==r?[]:(n*=n,e=e.D(),(i=t.h.yc(e,i))<=n?(n=[],(r=new t.$l).ey(e.x,e.y,0,Math.sqrt(i)),n[0]=r):n=[],n)},n.prototype.tU=function(e,i,n,r){if(0==r)return[];var s=e.ub(0),o=e.I();e=[],n*=n;for(var a=0;a<o;a++){var h=s.read(2*a),l=s.read(2*a+1),c=i.x-h,u=i.y-l;(c=c*c+u*u)<=n&&((u=new t.$l).ey(h,l,a,Math.sqrt(c)),e.push(u))}return i=e.length,e.sort((function(t,e){return t.Ka<e.Ka?-1:t.Ka==e.Ka?0:1})),r>=i||(e.length=r),e.slice(0)},n.instance=null,n}(t.Je);t.Ix=i}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 4},i.prototype.V=function(e,i,n,r,s){return t.am.yB(e,i,n,r,s)},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.Iu=function(e){return t.Vt.wy(e)},i.prototype.wn=function(e,i,n){t.Vt.CD(e,i,n)},i.instance=null,i}(t.Je);t.zL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 33},i.prototype.V=function(e,i,n,r,s){return 1073741824===e?!t.ud.zB(i,n,r,4,s):t.ud.zB(i,n,r,e,s)},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.Iu=function(e){return t.Vt.wy(e)},i.prototype.wn=function(e,i,n){t.Vt.CD(e,i,n)},i.instance=null,i}(t.Je);t.dj=e}(X||(X={})),function(t){var e=function(){function e(e,i,n,r){if(this.nd=r,this.rT=n,this.ya=-1,null==e)throw t.i.N();this.yk=e,this.Mj=i}return e.prototype.next=function(){var e;if(null!=(e=this.yk.next())){if(this.ya=this.yk.La(),null!=this.nd&&!this.nd.progress(-1,-1))throw t.i.fu("user_canceled");return this.eC(e)}return null},e.prototype.La=function(){return this.ya},e.prototype.eC=function(e){if(null==e)throw t.i.N();return t.Jx.cK(e,this.Mj,this.rT,this.nd)},e.prototype.qe=function(){},e}();t.AL=e}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 26},i.prototype.V=function(e,i,n,r){return e instanceof t.aa?(e=new t.Zc(e),this.V(e,i,n,r).next()):new t.AL(e,i,n,r)},i.prototype.rs=function(e,i,n,r,s){return 0<(void 0!==r?t.Jx.rs(e,i,n,r,s):t.Jx.rs(e,i,!1,null,n))},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.instance=null,i}(t.Je);t.Yl=e}(X||(X={})),function(t){var e=function(){function t(){this.yq=0}return t.prototype.nX=function(t){this.yq&=-2,this.yq|=t?1:0},t.prototype.Wp=function(){return!!(1&this.yq)},t.prototype.XF=function(){return this.Wp()?0:1},t}();t.xY=e;var i=function(){},n=function(t,e,i,n){this.x=t,this.y=e,this.Ai=i,this.xm=n},r=function(){function t(t){this.Be=t}return t.prototype.compare=function(t,e,i){return t=t.ja(i),e=this.Be.lf.read(2*e),0>(e-=t=this.Be.lf.read(2*t))?-1:0<e?1:0},t}(),s=function(){function t(t){this.Be=t}return t.prototype.compare=function(t,e,i){e=this.Be.hb[e],t=this.Be.hb[t.ja(i)];var n=e.Wp(),r=t.Wp();i=e.ne.Pe(this.Be.Mo,0);var s=t.ne.Pe(this.Be.Mo,0);return i==s&&((n=.5*((i=Math.min(n?e.ne.na:e.ne.la,r?t.ne.na:t.ne.la))-this.Be.Mo)+this.Be.Mo)==this.Be.Mo&&(n=i),i=e.ne.Pe(n,0),s=t.ne.Pe(n,0)),i<s?-1:i>s?1:0},t}(),o=function(){function e(e,i){this.YI=new t.h,this.parent=e,this.dS=i}return e.prototype.nr=function(t,e,i){var n=this.parent,r=this.dS;i.Vd(t,e,(function(t,e){return n.Mh(t,e,r)}))},e.prototype.$p=function(t){return t=this.parent.gi.get(t),this.parent.lf.tc(2*(t>>1),this.YI),this.YI.y+(1&t?this.parent.Oj:-this.parent.Oj)},e}(),a=function(){function a(e,i,n,r,s){this.nH=e.description,this.X=e,this.Qg=i,this.Oj=t.ta.kj(this.Qg,e,!1),this.Bo=t.ta.kj(this.Qg,e,!0),this.xA=n,this.oT=this.nH.Aa,this.hb=[],this.po=[],this.mh=new t.jp,this.fb=new t.Yj,this.ke=new t.Md,this.ZG=this.ql=s}return a.prototype.eT=function(){return this.ZG=!0,(!t.aa.Hc(this.X.getType())||this.GE()&&this.DE(!1))&&this.mO()?t.aa.Hc(this.X.getType())?this.pO()?1607==this.X.getType()?this.rO()?2:0:this.sO()?this.tO():0:0:2:0},a.prototype.kC=function(e,i){var n=this.lf.read(2*e);e=this.lf.read(2*e+1);var r=this.lf.read(2*i);return i=this.lf.read(2*i+1),!t.Yt.Cv(n,e,r,i,this.Oj*this.Oj)||0!=this.X.Db()&&n==r&&e==i},a.prototype.GE=function(){for(var e=this.X,i=e.xf?3:2,n=0,r=e.da();n<r;n++)if(e.Ja(n)<i)return this.ke=new t.Md(1,n,0),!1;return!0},a.prototype.DE=function(e){var i=this.X,n=i.Ga(),r=i.hasAttribute(1);for(i=r?t.ta.wE(this.Qg,i,!1):0;n.$a();)for(;n.Ha();){var s=n.ha();if(!(s.Qb()>this.Oj)){if(e&&r){var o=s.wv(1,0);if(s=s.wv(1,0),Math.abs(s-o)>i)continue}return this.ke=new t.Md(2,n.wb(),-1),!1}}return!0},a.prototype.mO=function(){var e=this.X,i=null;t.aa.Hc(this.X.getType())&&(i=this.X);var n=(this.ZG||this.ql)&&null!=i,s=e.I();this.lf=e.ub(0),this.gi=new t.ia(0),this.gi.Jb(2*s),this.fi=new t.ia(0),this.fi.Jb(2*s),n&&(null==this.Fl&&(this.Fl=new t.ia(0)),this.Fl.Jb(s));for(var a=e=0;a<s;a++)if(this.gi.add(2*a),this.gi.add(2*a+1),this.fi.add(2*a),this.fi.add(2*a+1),n){for(;a>=i.Vc(e);)e++;this.Fl.add(e)}for((new t.Xt).sort(this.fi,0,2*s,new o(this,n)),this.fb.clear(),this.fb.Vo(new r(this)),this.fb.De(s),i=0,s*=2;i<s;i++)if(n=this.fi.get(i),n=(e=this.gi.get(n))>>1,1&e){if(e=this.fb.search(n,-1),a=this.fb.we(e),h=this.fb.lb(e),this.fb.vd(e,-1),-1!=a&&-1!=h&&!this.kC(this.fb.ja(a),this.fb.ja(h)))return this.ke=new t.Md(3,this.fb.ja(a),this.fb.ja(h)),!1}else{if(e=this.fb.addElement(n,-1),-1!=(a=this.fb.we(e))&&!this.kC(this.fb.ja(a),n))return this.ke=new t.Md(3,n,this.fb.ja(a)),!1;var h=this.fb.lb(e);if(-1!=h&&!this.kC(this.fb.ja(h),n))return this.ke=new t.Md(3,n,this.fb.ja(h)),!1}return!0},a.prototype.pO=function(){return 10>this.X.I()?this.nO():this.oO()},a.prototype.oO=function(){var e=new t.gd;e.Ib(this.X);var i=new t.Md;return!t.$t.kI(!1,e,this.Oj,i,this.nd)||(i.Jo=e.Ua(i.Jo),i.Ko=e.Ua(i.Ko),this.ke.Wt(i),!1)},a.prototype.nO=function(){var e=this.X,i=e.Ga();for(e=e.Ga();i.$a();)for(;i.Ha();){var n=i.ha();if(!i.Qn()||!i.$S()){e.BW(i);do{for(;e.Ha();){var r=e.ha();if(0!=(r=n.zr(r,this.Oj,!0)))return this.ke=new t.Md(2==r?5:4,i.wb(),e.wb()),!1}}while(e.$a())}}return!0},a.prototype.sO=function(){var e=this.X;this.hb.length=0,this.po.length=0,this.Zf=e.Ga(),this.Zf.JB();var i=new t.ia(0);i.Jb(10);var n=NaN,r=0,s=0;for(e=2*e.I();s<e;s++){var o=this.fi.get(s);if(!(1&(o=this.gi.get(o)))){o>>=1;var a=this.lf.read(2*o),h=this.lf.read(2*o+1);if(0!=i.size&&(a!=n||h!=r)){if(!this.RI(i))return!1;null!=i&&i.clear(!1)}i.add(o),n=a,r=h}}return!!this.RI(i)},a.prototype.rO=function(){for(var e=this.X,n=Array(e.da()),r=0,s=e.da();r<s;r++)n[r]=e.Nn(r);s=new i;var o=new t.h;r=this.fi.get(0);var a=(r=this.gi.get(r))>>1;this.lf.tc(2*a,o);var h=n[r=this.Fl.get(a)],l=e.Ba(r),c=e.Vc(r)-1;s.el=a==l||a==c,s.ny=this.ql?!h&&s.el:s.el,s.Ai=r,s.x=o.x,s.y=o.y,s.xm=a;for(var u=new i,d=1,f=this.fi.size;d<f;d++)if(r=this.fi.get(d),!(1&(r=this.gi.get(r)))){a=r>>1,this.lf.tc(2*a,o),(r=this.Fl.get(a))!=s.Ai&&(h=n[r],l=e.Ba(r),c=e.Vc(r)-1);var p=a==l||a==c,g=this.ql?!h&&s.el:s.el;if(u.x=o.x,u.y=o.y,u.Ai=r,u.xm=a,u.ny=g,u.el=p,u.x==s.x&&u.y==s.y)if(this.ql){if(!(u.ny&&s.ny||u.Ai==s.Ai&&(u.el||s.el)))return this.ke=new t.Md(8,u.xm,s.xm),!1}else if(!u.el||!s.el)return this.ke=new t.Md(5,u.xm,s.xm),!1;r=s,s=u,u=r}return!0},a.prototype.JE=function(){for(var e=this.X,i=[],r=-1,s=!1,o=0,a=e.da();o<a;o++)e.Ev(o)&&(s=!1,r++,o<a-1&&(e.Ev(o+1)||(s=!0))),i[o]=s?r:-1;s=new t.h,o=this.fi.get(0);var h=(o=this.gi.get(o))>>1;this.lf.tc(2*h,s),o=this.Fl.get(h),r=new n(s.x,s.y,o,h,i[o]),e=[];var l=1;for(a=this.fi.size;l<a;l++)if(o=this.fi.get(l),!(1&(o=this.gi.get(o)))){if(h=o>>1,this.lf.tc(2*h,s),o=this.Fl.get(h),(o=new n(s.x,s.y,o,h,i[o])).x==r.x&&o.y==r.y){if(o.Ai==r.Ai)return this.ke=new t.Md(9,o.xm,r.xm),!1;0<=i[o.Ai]&&i[o.Ai]==i[r.Ai]&&(0!=e.length&&e[e.length-1]==r||e.push(r),e.push(o))}r=o}if(0==e.length)return!0;for(o=new t.jp(!0),t.O.$u(i,-1),s=-1,(l=new t.h).Rc(),r=0,a=e.length;r<a;r++){(h=e[r]).x==l.x&&h.y==l.y||(s=o.Ph(0),l.x=h.x,l.y=h.y);var c=i[h.Ai];-1==c&&(c=o.Ph(2),i[h.Ai]=c),o.addElement(c,s),o.addElement(s,c)}for((a=new t.ia(0)).Jb(10),r=o.je;-1!=r;r=o.qz(r))if(!(1&(e=o.PF(r)))&&2&e){for(e=-1,a.add(r),a.add(-1);0<a.size;){if(s=a.Fc(),a.If(),l=a.Fc(),a.If(),1&(h=o.PF(l))){e=2&h?l:s;break}for(o.fX(l,1|h),h=o.rc(l);-1!=h;h=o.lb(h))(c=o.getData(h))!=s&&(a.add(c),a.add(l))}if(-1!=e){for(o=-1,r=0,a=i.length;r<a;r++)if(i[r]==e){o=r;break}return this.ke=new t.Md(10,o,-1),!1}}return!0},a.prototype.tO=function(){var e=this.X;if(0>=e.Ke())return this.ke=new t.Md(6,1==e.da()?1:-1,-1),0;if(1==e.da())return this.ql&&!this.JE()?0:2;this.to=t.ia.qf(e.da(),0),this.JA=t.ia.qf(e.da(),-1);for(var i=-1,n=0,r=0,o=e.da();r<o;r++){var a=e.Ir(r);if(this.to.write(r,0>a?0:256),0<a)i=r,n=a;else{if(0==a)return this.ke=new t.Md(6,r,-1),0;if((0>i||n<Math.abs(a))&&(this.ke=new t.Md(7,r,-1),this.ql))return 0;this.JA.write(r,i)}}for(this.dt=e.da(),this.Om=new t.ia(0),this.Om.Jb(10),o=e.I(),this.Mo=NaN,(e=new t.ia(0)).Jb(10),this.Qq=t.ia.qf(o,-1),this.Hw=t.ia.qf(o,-1),null!=this.zj?this.zj.clear(!1):this.zj=new t.ia(0),this.zj.Jb(10),this.fb.clear(),this.fb.Vo(new s(this)),i=0,o*=2;0<this.dt&&i<o;i++)if(n=this.fi.get(i),!(1&(n=this.gi.get(n)))){if(n>>=1,(r=this.lf.read(2*n+1))!=this.Mo&&0!=e.size){if(!this.ut(e))return 0;null!=e&&e.clear(!1)}e.add(n),this.Mo=r}return 0<this.dt&&!this.ut(e)?0:this.ql?0==this.ke.Jj&&this.JE()?2:0:0==this.ke.Jj?2:1},a.prototype.RI=function(e){if(1==e.size)return!0;for(var i=0,n=e.size;i<n;i++){var r=e.get(i);this.Zf.Vb(r);var s=this.Zf.li();this.hb.push(this.Su(s,r,this.Zf.gb,!0)),this.Zf.ha(),s=this.Zf.ha(),this.hb.push(this.Su(s,r,this.Zf.gb,!1))}var o=this;for(this.hb.sort((function(t,e){return o.XP(t,e)})),-1==(r=this.mh.je)&&(r=this.mh.Ph(0)),this.mh.fn(this.hb.length),i=0,n=this.hb.length;i<n;i++)this.mh.addElement(r,i);i=!0;for(var a=n=-1;i&&(i=!1,-1!=(s=this.mh.rc(r)));)for(var h=this.mh.lb(s);-1!=h;)if(n=this.mh.getData(s),a=this.mh.getData(h),(n=this.hb[n].Io)!=(a=this.hb[a].Io))s=h,h=this.mh.lb(s);else if(i=!0,this.mh.jd(r,s),s=this.mh.we(h),-1==(h=this.mh.jd(r,h))||-1==s)break;if(i=this.mh.bs(r),this.mh.LE(r),0<i)return this.ke=new t.Md(5,n,a),!1;for(i=0,n=e.size;i<n;i++)this.vB(this.hb[i]);return this.hb.length=0,!0},a.prototype.ut=function(e){for(var i=0,n=e.size;i<n;i++){var r=e.get(i),s=this.Qq.read(r);if(-1!=s){var o=this.fb.ja(s);this.zj.add(o),this.fb.vd(s,-1),this.vB(this.hb[o]),this.hb[o]=null,this.Qq.write(r,-1)}-1!=(s=this.Hw.read(r))&&(o=this.fb.ja(s),this.zj.add(o),this.fb.vd(s,-1),this.vB(this.hb[o]),this.hb[o]=null,this.Hw.write(r,-1))}for(i=0,n=e.size;i<n;i++){if(r=e.get(i),this.Zf.Vb(r),(s=this.Zf.li()).na>s.la){var a=this.Zf.wb(),h=this.Su(s,r,this.Zf.gb,!0);0<this.zj.size?(o=this.zj.Fc(),this.zj.If(),this.hb[o]=h):(o=this.hb.length,this.hb.push(h)),s=this.fb.addElement(o,-1),-1==this.Qq.read(a)?this.Qq.write(a,s):this.Hw.write(a,s),!(3&this.to.read(this.Zf.gb))&&this.Om.add(s)}this.Zf.ha(),(s=this.Zf.ha()).na<s.la&&(a=this.Zf.ik(),h=this.Su(s,r,this.Zf.gb,!1),0<this.zj.size?(o=this.zj.Fc(),this.zj.If(),this.hb[o]=h):(o=this.hb.length,this.hb.push(h)),s=this.fb.addElement(o,-1),-1==this.Qq.read(a)?this.Qq.write(a,s):this.Hw.write(a,s),!(3&this.to.read(this.Zf.gb))&&this.Om.add(s))}for(i=0,n=this.Om.size;i<n&&0<this.dt;i++)if(s=this.Om.get(i),!(3&this.to.read(this.hb[this.fb.ja(s)].IA))){e=-1,r=this.fb.we(s);var l=s;h=null,o=-1;for(var c=0;-1!=r&&(o=this.fb.ja(r),o=(h=this.hb[o]).IA,!(3&(c=this.to.read(o))));)l=r,r=this.fb.we(r);-1==r?(a=1,r=l):(e=1==(3&c)?o:this.JA.read(o),a=0!=h.XF()?0:1,r=this.fb.lb(r));do{if(o=this.fb.ja(r),o=(h=this.hb[o]).IA,!(3&(l=this.to.read(o)))){if(a!=h.XF())return this.ke=new t.Md(6,o,-1),!1;if(l=252&l|(c=0==a||h.Wp()?2:1),this.to.write(o,c),2==c&&0==this.ke.Jj&&this.JA.read(o)!=e&&(this.ke=new t.Md(7,o,-1),this.ql))return!1;if(this.dt--,0==this.dt)return!0}1==(3&l)&&(e=o),l=r,r=this.fb.lb(r),a=0!=a?0:1}while(l!=s)}return null!=this.Om?this.Om.clear(!1):this.Om=new t.ia(0),!0},a.prototype.Su=function(e,i,n,r){if(322!=e.getType())throw t.i.Qa();return(e=this.sP(e)).Io=i,e.IA=n,e.yq=0,e.nX(r),e},a.prototype.sP=function(i){if(0<this.po.length){var n=this.po[this.po.length-1];--this.po.length,i.copyTo(n.ne)}else(n=new e).ne=t.SC.jg(i);return n},a.prototype.vB=function(t){322==t.ne.getType()&&this.po.push(t)},a.prototype.kU=function(){for(var e=this.X.I(),i=new t.ia(0),n=0;n<e;n++)i.add(n);var r=this;for(i.Vd(0,e,(function(t,e){return r.Ou(t,e)})),n=1;n<e;n++)if(0==this.Ou(i.get(n-1),i.get(n)))return this.ke=new t.Md(3,i.get(n-1),i.get(n)),0;return 2},a.prototype.JV=function(){return this.GE()&&this.DE(!0)?2:0},a.prototype.oV=function(){return this.eT()},a.prototype.pU=function(){for(var e=this.X.I(),i=new t.ia(0),n=0;n<e;n++)i.add(n);var r=this;i.Vd(0,e,(function(t,e){return r.PO(t,e)}));var s=Array(e);for(t.O.$u(s,!1),s[i.get(0)]=!0,n=1;n<e;n++){var o=i.get(n-1),a=i.get(n);0==this.Ou(o,a)?s[a]=!1:s[a]=!0}i=this.X.Ia(),o=this.X,a=0;var h=1;for(n=0;n<e;n++)s[n]?h=n+1:(a<h&&i.Fd(o,a,h),a=n+1);return a<h&&i.Fd(o,a,h),i.Ch(2,this.Bo),i},a.prototype.NV=function(){var e=this.X,i=e.Ga(),n=e.Ga(),r=this.X.Ia(),s=this.X,o=e.hasAttribute(1),a=o?t.ta.wE(this.Qg,e,!0):0,h=new t.ia(0),l=new t.ia(0);for(h.Jb(t.O.truncate(e.I()/2+1)),l.Jb(t.O.truncate(e.I()/2+1));i.$a();)if(n.$a(),!(2>e.Ja(i.gb))){n.EW();for(var c,u,d=!0;i.Ha();){var f=i.ha(),p=n.li();if(i.wb()>n.wb())break;d&&(h.add(i.wb()),l.add(n.ik()),d=!1),u=h.Fc();var g=i.ik();if(1<g-u){var v=new t.h;v.uc(e.Na(u),e.Na(g)),c=v.length()}else c=f.Qb();u=l.Fc(),1<(g=n.wb())-u?((v=new t.h).uc(e.Na(u),e.Na(g)),u=v.length()):u=p.Qb(),c>this.Bo?h.add(i.ik()):o&&(c=e.Uc(1,h.Fc(),0),f=f.gv(1,0),Math.abs(f-c)>a&&h.add(i.ik())),u>this.Bo?l.add(n.wb()):o&&(c=e.Uc(1,l.Fc(),0),f=p.gv(1,0),Math.abs(f-c)>a&&l.add(n.wb()))}if(h.Fc()<l.Fc()?h.size>l.size?h.If():l.If():(h.Fc()!=l.Fc()&&l.If(),l.If()),2<=l.size+h.size){for(d=new t.Sa,p=0,f=h.size;p<f;p++)s.ve(h.get(p),d),0==p?r.nf(d):r.lineTo(d);for(p=l.size-1;0<p;p--)s.ve(l.get(p),d),r.lineTo(d);s.dc(i.gb)?r.Ap():0<l.size&&(s.ve(l.get(0),d),r.lineTo(d))}null!=h&&h.clear(!1),null!=l&&l.clear(!1)}return r.Ch(2,this.Bo),r},a.prototype.rV=function(){return this.DX()},a.prototype.DX=function(){return 1736==this.X.getType()&&1==this.X.In()?t.Fg.Mk(this.X,this.Bo,!0,!1,this.nd):(this.Hi=new t.gd,this.Hi.Ib(this.X),0!=this.Hi.fd&&(1!=this.xA&&t.Tk.V(this.Hi,this.Bo,this.nd,!0),1736==this.X.getType()&&t.rn.V(this.Hi,this.Hi.ld,this.xA,!1,this.nd)),this.X=this.Hi.Ne(this.Hi.ld),1736==this.X.getType()&&(this.X.fm(),this.X.Yo(0)),this.X.Ch(2,this.Bo),this.X)},a.rs=function(e,i,n,r,s){if(null!=r&&(r.Jj=0,r.Jo=-1,r.Ko=-1),e.B())return 1;var o=e.getType();if(33==o)return 1;var h=t.ta.kj(i,e,!1);if(197==o)return i=new t.l,e.A(i),i.Bi(h)?(null!=r&&(r.Jj=2,r.Jo=-1,r.Ko=-1),0):1;if(t.aa.yd(o))return(h=new t.Ta(e.description)).oc(e,!0),a.rs(h,i,n,r,s);var l=e.om(h);if(-1!=(n=n?-1:l))return n;if(i=new a(e,i,n,s,!1),550==o)n=i.kU();else if(1607==o)n=i.JV();else{if(1736!=o)throw t.i.Qa();n=i.oV()}return e.Ch(n,h),null!=r&&0==n&&r.Wt(i.ke),n},a.cK=function(e,i,n,r){if(e.B())return e;var s=e.getType();if(33==s)return e;var o=t.ta.kj(i,e,!1);if(197==s)return i=new t.l,e.A(i),i.Bi(o)?e.Ia():e;if(t.aa.yd(s))return(s=new t.Ta(e.description)).oc(e,!0),a.cK(s,i,n,r);if(o=e.om(o),2==(n=n?-1:o))return e;if(e=new a(e,i,n,r,!1),550==s)e=e.pU();else if(1607==s)e=e.NV();else{if(1736!=s)throw t.i.Qa();e=e.rV()}return e},a.prototype.Mh=function(e,i,n){if(e==i)return 0;e=this.gi.get(e);var r=this.gi.get(i);i=e>>1;var s=r>>1,o=new t.h,a=new t.h;return this.lf.tc(2*i,o),o.y+=1&e?this.Oj:-this.Oj,this.lf.tc(2*s,a),a.y+=1&r?this.Oj:-this.Oj,0==(e=o.compare(a))&&n?0>(n=this.Fl.get(i)-this.Fl.get(s))?-1:0<n?1:0:e},a.prototype.Ou=function(e,i){if(e==i)return 0;var n=this.X,r=n.Na(e),s=n.Na(i);if(r.x<s.x)return-1;if(r.x>s.x)return 1;if(r.y<s.y)return-1;if(r.y>s.y)return 1;for(r=1;r<this.oT;r++){s=this.nH.kd(r);for(var o=t.ra.Va(s),a=0;a<o;a++){var h=n.Uc(s,e,a),l=n.Uc(s,i,a);if(h<l)return-1;if(h>l)return 1}}return 0},a.prototype.PO=function(t,e){var i=this.Ou(t,e);return 0==i?t<e?-1:1:i},a.prototype.XP=function(t,e){if(t===e)return 0;var i=t.ne.kg();t.Wp()&&i.Sq(),t=e.ne.kg(),e.Wp()&&t.Sq(),e=i.qu();var n=t.qu();return n==e?(e=i.wi(t),Math.abs(e)<=8881784197001252e-31*(Math.abs(t.x*i.y)+Math.abs(t.y*i.x))&&(e--,e++),0>e?1:0<e?-1:0):e<n?-1:1},a}();t.Jx=a}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 30},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.prototype.V=function(e,i,n,r){return e instanceof t.aa?(e=new t.Zc(e),i=new t.Zc(i),this.V(e,i,n,r).next()):new t.BL(e,i,n,r)},i.ep=function(e,n,r,s){var o=e.Db(),a=n.Db();if(e.B()&&n.B())return o>a?e:n;if(e.B())return n;if(n.B())return e;var h=new t.l,l=new t.l,c=new t.l;return e.A(h),n.A(l),c.K(h),c.Zb(l),h=t.ta.Wd(r,c,!0),l=e.getType(),c=n.getType(),33==l&&33==c?i.aV(e,n,h):l!=c?0<o||0<a?o>a?e:n:550==l?i.iI(e,n,h):i.iI(n,e,h):t.Fg.ep(e,n,r,s)},i.aV=function(e,i,n){n=n*Math.sqrt(2)*1.00001,n*=n;var r=e.D(),s=i.D(),o=new t.de(e.description);return t.h.yc(r,s)>n&&(o.add(e),o.add(i)),o},i.iI=function(e,i,n){var r=e.ub(0),s=e.I(),o=i.D(),a=e.Ia();n=n*Math.sqrt(2)*1.00001;var h=new t.l;if(e.A(h),h.W(n,n),h.contains(o)){n*=n,h=!1;for(var l=[],c=0;c<s;c++)l[c]=!1;for(c=0;c<s;c++){var u=r.read(2*c),d=r.read(2*c+1);(u-=o.x)*u+(d-=o.y)*d<=n&&(h=!0,l[c]=!0)}if(h)for(c=0;c<s;c++)l[c]||a.Fd(e,c,c+1);else a.Fd(e,0,s),a.add(i)}else a.Fd(e,0,s),a.add(i);return a},i.instance=null,i}(t.Je);t.Kx=e}(X||(X={})),function(t){var e=function(){function e(t,e,i,n){this.ts=null==e,this.ya=-1,this.Rd=t,this.vg=i,this.NT=e.next(),this.Ub=n}return e.prototype.next=function(){return this.ts?null:null!=(e=this.Rd.next())?(this.ya=this.Rd.La(),t.Kx.ep(e,this.NT,this.vg,this.Ub)):null;var e},e.prototype.La=function(){return this.ya},e.prototype.qe=function(){},e}();t.BL=e}(X||(X={})),function(t){var e=function(){function t(){}return t.prototype.Fz=function(){this.$y=null,this.Ax=-1,this.AK=!1},t}(),i=function(){function t(){this.Gr=0,this.pj=[]}return t.prototype.pN=function(t){this.Gr+=t.Ax,this.pj.push(t)},t.prototype.TV=function(){this.Gr-=this.pj[this.pj.length-1].Ax,--this.pj.length},t.prototype.my=function(){return this.pj[this.pj.length-1]},t.prototype.Nb=function(t){return t===this},t}(),n=function(){function n(t,e,i){this.ya=-1,this.Ic=!1,this.AH=[!1,!1,!1,!1],this.uq=[0,0,0,0],this.jA=!1,this.zk=-1,this.iq=0,this.bo=-1,this.Do=[],this.Rd=t,this.vg=e,this.Ub=i}return n.dE=function(t){var e=[],i=0;for(t=Object.keys(t);i<t.length;i++)e.push(Number(t[i]));return e.sort((function(t,e){return t-e})),e},n.prototype.fG=function(e){var i=this.Do[e],r=n.dE(i)[0],s=i[r],o=s.my().$y;return s=s.my().AK,delete i[r],s&&(o=t.Yl.local().V(o,this.vg,!1,this.Ub),0==e&&33==o.getType()&&(e=new t.de(o.description),o.B()||e.add(o),o=e)),o},n.prototype.next=function(){if(this.Ic&&this.bo==this.zk)return null;for(;!this.qK(););if(-1==this.zk)return null;if(this.jA){for(this.bo++;;){if(this.bo>this.zk||0>this.bo)throw t.i.Qa();if(this.AH[this.bo])break}return this.ya++,this.fG(this.bo)}return this.ya=0,this.bo=this.zk,this.fG(this.zk)},n.prototype.La=function(){return this.ya},n.prototype.qK=function(){if(this.Ic)return!0;var e=null;if(null!=this.Rd&&null==(e=this.Rd.next())&&(this.Ic=!0,this.Rd=null),t.mp.zp(this.Ub),null!=e){var i=e.Db();this.AH[i]=!0,i>=this.zk&&!this.jA&&(this.ND(i,!1,e),i>this.zk&&!this.jA&&this.zW(i))}if(0<this.iq)for(i=0;i<=this.zk;i++)for(;1<this.uq[i]&&0!=(e=this.FO(i)).length;)e=t.Fg.VP(e,this.vg,this.Ub),this.ND(i,!0,e);return this.Ic},n.prototype.FO=function(t){for(var e=[],i=[],r=this.Do[t],s=n.dE(r),o=0;o<s.length;o++){var a=s[o],h=r[a];if(this.Ic||1e4<h.Gr&&1<h.pj.length){for(this.uq[t]-=h.pj.length,this.iq-=h.pj.length;0<h.pj.length;)e.push(h.my().$y),h.TV();i.push(a)}}for(o=0;o<i.length;o++)delete r[i[o]];return e},n.prototype.zW=function(t){for(var e=0;e<t;e++)this.Do[e]=[],this.iq-=this.uq[e],this.uq[e]=0},n.prototype.ND=function(t,r,s){var o=new e;if(o.Fz(),o.$y=s,s=n.eS(s),o.Ax=s,s=n.cS(s),t+1>this.Do.length)for(var a=0,h=Math.max(2,t+1);a<h;a++)this.Do.push([]);void 0===(a=this.Do[t][s])&&(a=new i,this.Do[t][s]=a),o.AK=r,a.pN(o),this.uq[t]++,this.iq++,this.zk=Math.max(this.zk,t)},n.cS=function(e){return 0<e?t.O.truncate(Math.log(e)/Math.log(4)+.5):0},n.eS=function(e){var i=e.getType();if(t.aa.xj(i))return e.I();if(33==i)return 1;if(197==i)return 4;if(t.aa.yd(i))return 2;throw t.i.Qa()},n.prototype.qe=function(){this.qK()},n}();t.DL=n}(X||(X={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Q(i,e),i.prototype.getType=function(){return 1},i.prototype.V=function(e,i,n,r){return void 0===r?new t.DL(e,i,n):this.gQ(e,i,n,r)},i.prototype.gQ=function(e,i,n,r){return e=new t.Zc([e,i]),this.V(e,n,r).next()},i.local=function(){return null===i.instance&&(i.instance=new i),i.instance},i.instance=null,i}(t.Je);t.Gh=e}(X||(X={})),function(t){var e,i;(i=e||(e={}))[i.nextPath=0]="nextPath",i[i.nextSegment=1]="nextSegment",i[i.iterate=2]="iterate",e=function(){function e(e,i,n,r){this.Ts=new t.l,this.GT=e,this.HT=i,this.mq=r,this.uo=-1,this.rl=!1;var s=e.Bb;null!=s&&null!=(s=r?s.zo:s.Fb)&&(this.Ic=!1,this.qa=n,this.Fb=s,this.xw=this.Fb.getIterator(),this.nq=this.rl=!0,this.Xb=0,r?this.uo=i.da():this.sd=i.Ga()),this.rl||null!=(s=i.Bb)&&null!=(s=r?s.zo:s.Fb)&&(this.Ic=!1,this.qa=n,this.Fb=s,this.xw=this.Fb.getIterator(),this.rl=!0,this.nq=!1,this.Xb=0,r?this.uo=e.da():this.sd=e.Ga()),this.rl||(this.ci=r?t.ta.mR(e,i,n,1<=e.om(0),1<=i.om(0)):t.ta.lR(e,i,n))}return e.prototype.next=function(){if(this.rl){if(this.Ic)return!1;for(var e=!0;e;)switch(this.Xb){case 0:e=this.xU();break;case 1:e=this.yU();break;case 2:e=this.Uz();break;default:throw t.i.fa("internal error")}return!this.Ic}return null!=this.ci&&this.ci.next()},e.prototype.nl=function(){return this.rl?this.nq?this.Fb.ja(this.Fs):this.mq?this.uo:this.sd.wb():this.ci.nl(this.ci.Vf)},e.prototype.hl=function(){return this.rl?this.nq?this.mq?this.uo:this.sd.wb():this.Fb.ja(this.Fs):this.ci.hl(this.ci.Af)},e.prototype.uz=function(){if(!this.mq)throw t.i.fa("internal error");return this.rl?this.nq?this.Fb.GF(this.Fs):this.Ts:this.ci.uz(this.ci.Vf)},e.prototype.az=function(){if(!this.mq)throw t.i.fa("internal error");return this.rl?this.nq?this.Ts:this.Fb.GF(this.Fs):this.ci.az(this.ci.Af)},e.prototype.xU=function(){return this.mq?-1==--this.uo?(this.Ic=!0,!1):(this.nq?this.HT.Rj(this.uo,this.Ts):this.GT.Rj(this.uo,this.Ts),this.xw.Xi(this.Ts,this.qa),this.Xb=2,!0):this.sd.$a()?(this.Xb=1,!0):(this.Ic=!0,!1)},e.prototype.yU=function(){if(!this.sd.Ha())return this.Xb=0,!0;var t=this.sd.ha();return this.xw.Uo(t,this.qa),this.Xb=2,!0},e.prototype.Uz=function(){return this.Fs=this.xw.next(),-1==this.Fs&&(this.Xb=this.mq?0:1,!0)},e}(),t.Zl=e}(X||(X={})),function(t){(t=t.OL||(t.OL={}))[t.enumClosed=1]="enumClosed",t[t.enumHasNonlinearSegments=2]="enumHasNonlinearSegments",t[t.enumOGCStartPolygon=4]="enumOGCStartPolygon",t[t.enumCalcMask=4]="enumCalcMask"}(X||(X={})),function(t){t.QC=function(){function e(){}return e.tb=function(i,n,r,s,o,a,h,l,c){var u=[0,0,0],d=[0,0,0],f=[0,0,0],p=[0,0,0,0],g=new t.ga(0),v=new t.ga(0),m=new t.ga(0);if(null!=h||null!=l||null!=c)if(t.s.ti(n))t.Yg.tb(i,r,s,o,a,h,l,c);else{o=t.F.ba(o),r=t.F.ba(r);var y=t.F.ba(o-r);if(t.s.Y(s,a)&&(t.s.Y(r,o)||t.s.Y(t.s.P(s),1.570796326794897)))null!=h&&(h.u=0),null!=l&&(l.u=0),null!=c&&(c.u=0);else{if(t.s.Y(s,-a)){if(t.s.Y(t.s.P(s),1.570796326794897))return null!=h&&(h.u=2*t.F.Ah(i,n)),null!=l&&(l.u=0<s?t.F.ba(3.141592653589793-t.F.ba(o)):t.F.ba(o)),void(null!=c&&(c.u=0<s?t.F.ba(o):t.F.ba(3.141592653589793-t.F.ba(o))));t.s.Y(t.s.P(y),3.141592653589793)&&(null!=h&&(h.u=2*t.F.Ah(i,n)),null!=l&&(l.u=0),null!=c&&(c.u=0))}else{if(t.s.Y(t.s.P(s),1.570796326794897)||t.s.Y(t.s.P(a),1.570796326794897))return void t.Wk.tb(i,n,r,s,o,a,h,l,c);if(t.s.Y(r,o)||t.s.Y(t.s.P(y),3.141592653589793))return void t.Wk.tb(i,n,r,s,o,a,h,l,c);if(t.s.Cd(s))return void t.Wk.tb(i,n,r,s,o,a,h,l,c)}var _=Math.sqrt(1-n);o=t.F.ba(o-r),r=0,t.F.cl(1,n,s,r,0,g,v,m),u[0]=g.u,u[1]=v.u,u[2]=m.u,t.F.cl(1,n,a,o,0,g,v,m),d[0]=g.u,d[1]=v.u,d[2]=m.u,f[0]=0,f[1]=0,f[2]=-1*n*t.F.n(1,n,s)*Math.sin(s),0>o?t.F.Wq(f,d,u,p,0):t.F.Wq(f,u,d,p,0),v=[0,0,0],m=[0,0,0];var b=[0,0,0];u=[0,0,0],g=[0,0,0];var w=Math.acos(p[2]/1),x=1-n,T=Math.tan(w),A=1+T*T/x,M=2*f[2]*T/x;for(x=(-M+(T=Math.sqrt(M*M-4*A*(f[2]*f[2]/x-1))))/(A*=2),M=(-M-T)/A,T=Math.tan(w),w=(x+M)/2,f=((A=T*x+f[2])+(T*M+f[2]))/2,T=t.F.gp(x-w,A-f),x=f/_*1.570796326794897,M=0;100>M&&(A=(A=t.F.w(n,x))*A/Math.cos(x)*(Math.sin(x)-f*A/(1-n)),!t.s.Cd(A));M++)x-=A;f=t.F.n(1,n,x)*Math.cos(x),T=1-T/(f=Math.sqrt((f-w)*(f+w))),T*=2-T,A=t.F.on(v),w=t.F.on(m),x=t.F.on(b);var S=t.F.St(b,v);M=t.F.St(b,m),t.F.zx(b,v,u),t.F.zx(b,m,g),v=Math.acos(S/(x*A)),m=Math.acos(M/(x*w)),m*=t.s.Mb(1,t.F.St(u,g)),(1.570796326794897<=t.s.P(v)&&1.570796326794897<=t.s.P(m)||3.141592653589793<t.s.P(v-m))&&(v=(3.141592653589793-t.s.P(v))*t.s.Mb(1,v),m=(3.141592653589793-t.s.P(m))*t.s.Mb(1,m)),u=t.F.Qj(T,m),g=t.F.q(f,T,t.F.Qj(T,v)),u=t.F.q(f,T,u),u=t.s.P(u-g)*i,v=new t.ga(0),m=new t.ga(0),b=p[1]/1,b*=-t.s.Mb(1,y),g=Math.acos(b)*t.s.Mb(1,y),e.rf(i,n,r,s,u,g,v,m),t.s.Y(o,v.u)&&t.s.Y(a,m.u)||(T=t.F.gp(t.F.ba(o-v.u),a-m.u),e.rf(i,n,r,s,u,t.F.ba(g+3.141592653589793),v,m),(A=t.F.gp(t.F.ba(o-v.u),a-m.u))<T&&(g=t.F.ba(g+3.141592653589793))),v=[0,0,0,0],m=[0,0,0,0],T=[0,0,0],i=[0,0,0],r=[0,0,0],s=[0,0,0],b=[0,0,0],(f=[0,0,0])[0]=0,f[1]=0,f[2]=_,T[0]=0,T[1]=0,T[2]=0,t.F.Wq(T,f,d,v,0),t.s.Cd(a)?(i[0]=d[0],i[1]=d[1],i[2]=1,r[0]=1*Math.cos(o)-1*Math.sin(o),r[1]=1*Math.sin(o)+1*Math.cos(o)):(n=t.F.n(1,n,a)*Math.cos(a),i[0]=0,i[1]=0,d[2]+=Math.tan(1.570796326794897-t.s.P(a))*n*t.s.Mb(1,a),r[0]=n*Math.cos(o)-n*Math.sin(o),r[1]=n*Math.sin(o)+n*Math.cos(o)),r[2]=d[2],t.F.Wq(d,r,i,m,1),t.F.zx(m,v,s),t.F.zx(m,p,b),b=t.F.St(s,b)/(t.F.on(s)*t.F.on(b)),b*=t.s.Mb(1,y),o=Math.acos(b)*-t.s.Mb(1,y),(0<g&&0<o||0>g&&0>o)&&(o=t.F.ba(o+3.141592653589793)),null!=h&&(h.u=u),null!=l&&(l.u=g),null!=c&&(c.u=o)}}},e.rf=function(e,i,n,r,s,o,a,h){var l=[0,0,0],c=[0,0,0],u=[0,0,0],d=[0,0,0],f=[0,0,0],p=[0,0,0],g=[0,0,0],v=[0,0,0,0],m=new t.ga(0),y=new t.ga(0),_=new t.ga(0),b=new t.ga(0),w=new t.ga(0),x=new t.ga(0);if(null!=a&&null!=h)if(t.s.ti(i))t.Yg.rf(e,n,r,s,o,a,h);else if(t.s.Cd(s))null!=a&&(a.u=n),null!=h&&(h.u=r);else if(o=t.F.ba(o),0>s&&(s=t.s.P(s),o=t.F.ba(o+3.141592653589793)),n=t.F.ba(n),r=t.F.ba(r),1.570796326794897<t.s.P(r)&&(n=t.F.ba(n+3.141592653589793),r=t.s.Mb(3.141592653589793,r)-r),t.s.Y(t.s.P(r),1.570796326794897)||t.s.Cd(r)||t.s.Cd(o)||t.s.Y(t.s.P(o),3.141592653589793))t.Wk.rf(e,i,n,r,s,o,a,h);else{var T=Math.sqrt(1-i);for(e=s/e,t.F.cl(1,i,r,0,0,b,w,x),l[0]=b.u,l[1]=w.u,l[2]=w.u,g[0]=0,g[1]=0,g[2]=-1*i*t.F.n(1,i,r)*Math.sin(r),b=t.F.n(1,i,r),w=t.F.ba(1.570796326794897-o),x=Math.sin(w),s=Math.cos(r),r=Math.sin(r),f[0]=b*s-r*x,f[1]=Math.cos(w),f[2]=(1-i)*b*r+s*x,0>o?t.F.Wq(g,f,l,v,0):t.F.Wq(g,l,f,v,0),l=Math.acos(v[2]/1),v=Math.atan2(-v[1],-v[0]),r=1-i,w=1+(f=Math.tan(l))*f/r,r=(-(b=2*g[2]*f/r)+(f=Math.sqrt(b*b-4*w*(g[2]*g[2]/r-1))))/(w*=2),b=(-b-f)/w,f=Math.tan(l),l=(r+b)/2,g=((w=f*r+g[2])+(f*b+g[2]))/2,f=t.F.gp(r-l,w-g),T=g/T*1.570796326794897,r=0;100>r&&(b=(b=t.F.w(i,T))*b/Math.cos(T)*(Math.sin(T)-g*b/(1-i)),!t.s.Cd(b));r++)T-=b;T=t.F.n(1,i,T)*Math.cos(T),g=1-f/(T=Math.sqrt((T-l)*(T+l))),g*=2-g,p=Math.acos(t.F.St(p,c)/(t.F.on(p)*t.F.on(c))),p*=t.s.Mb(1,c[0]),o=(t.F.q(T,g,t.F.Qj(g,p))+e*t.s.Mb(1,o))/t.F.Ah(T,g),o=t.F.ba(1.570796326794897*o),o=t.F.Rq(g,o),t.F.n(T,g,o),f=t.F.ba(v+n),n=Math.cos(f),o=Math.sin(f),u[0]=d[0]*n+d[1]*-o,u[1]=d[0]*o+d[1]*n,u[2]=d[2],t.F.jO(i,u[0],u[1],u[2],_,y,m),null!=a&&(a.u=y.u),null!=h&&(h.u=_.u)}},e}()}(X||(X={})),function(t){var e=function(){function e(e){this.Ya=null,this.wt=new t.h,this.xt=new t.h,this.g=e}return e.prototype.compare=function(t,e,i){return this.g.Gc(e,this.wt),this.g.Gc(t.ja(i),this.xt),this.wt.compare(this.xt)},e}(),i=function(){function e(e){this.Bf=new t.h,this.Dk=new t.h,this.g=e}return e.prototype.Dh=function(t){this.Bf.L(t)},e.prototype.compare=function(t,e){return this.g.Gc(t.ja(e),this.Dk),this.Bf.compare(this.Dk)},e}(),n=function(t){function e(e){var i=t.call(this,e.g,e.qa,!1)||this;return i.ib=e,i}return Q(e,t),e.prototype.compare=function(t,e,i){if(this.rg)return-1;var n=this.ib.Qd.Jn(this.ib.Rh(e));t=t.ja(i);var r=this.ib.Qd.Jn(this.ib.Rh(t));return this.Dm=i,this.RE(e,n,t,r)},e}(t.UC),r=function(t){function e(e){var i=t.call(this,e.g,e.qa)||this;return i.ib=e,i}return Q(e,t),e.prototype.compare=function(t,e){return this.rg?-1:(t=this.ib.Qd.Jn(this.ib.Rh(t.ja(e))),this.Dm=e,this.SE(e,t))},e}(t.aM),s=function(){function s(){this.Mc=this.df=this.jo=this.Qd=this.lh=this.zd=this.hb=this.g=null,this.Ng=!1,this.vh=this.Nm=this.ie=this.Gk=this.nh=this.Ak=this.Ff=this.$d=null,this.xh=this.Jq=this.UA=this.qa=0,this.Xv=this.Wn=!1,this.yo=new t.h,this.Pi=new t.h,this.hb=new t.$c(8),this.zd=new t.$c(5),this.lh=new t.au,this.Qd=new t.au,this.Ng=!1,this.vh=new t.h,this.vh.ma(0,0),this.qa=0,this.xh=-1,this.Wn=!1,this.g=null,this.df=new t.Yj,this.Mc=new t.Yj,this.nh=new t.ia(0),this.Gk=new t.TC,this.Ff=new t.ia(0),this.Ak=new t.ia(0),this.jo=new t.Sa}return s.prototype.PX=function(e,i){var n=new t.Dd;return n.$B(),e.Oc(n),this.er(e),this.Wn=!1,this.qa=i,this.UA=i*i,i=this.jC(),e.Oc(n),i||(this.qQ(),i||this.jC()),-1!=this.xh&&(this.g.Td(this.xh),this.xh=-1),this.g=null,this.Wn},s.prototype.TX=function(t,e){this.er(t),this.Wn=!1,this.qa=e,this.UA=e*e,this.Ng=!1,this.jC(),this.Ng||(this.Ng=1==t.Gp(e,!0,!1)),-1!=this.xh&&(this.g.Td(this.xh),this.xh=-1),this.g=null},s.prototype.pg=function(t,e){return this.hb.T(t,0+e)},s.prototype.LB=function(t,e,i){this.hb.S(t,0+e,i)},s.prototype.Rh=function(t){return this.hb.T(t,2)},s.prototype.ZW=function(t,e){this.hb.S(t,2,e)},s.prototype.RF=function(t,e){return this.hb.T(t,3+e)},s.prototype.Pp=function(t){return this.hb.T(t,7)},s.prototype.Pl=function(t,e){this.hb.S(t,7,e)},s.prototype.Rp=function(t,e){return this.hb.T(t,3+this.Op(t,e))},s.prototype.fr=function(t,e,i){this.hb.S(t,3+this.Op(t,e),i)},s.prototype.NR=function(t,e){return this.hb.T(t,5+this.Op(t,e))},s.prototype.hr=function(t,e,i){this.hb.S(t,5+this.Op(t,e),i)},s.prototype.Sr=function(t){return this.zd.T(t,0)},s.prototype.UW=function(t,e){this.zd.S(t,0,e)},s.prototype.ez=function(t){return this.zd.T(t,4)},s.prototype.cr=function(t,e){this.zd.S(t,4,e)},s.prototype.il=function(t){return this.zd.T(t,1)},s.prototype.ln=function(t,e){this.zd.S(t,1,e)},s.prototype.dz=function(t){return this.zd.T(t,3)},s.prototype.Et=function(t,e){this.zd.S(t,3,e)},s.prototype.Ym=function(t){var e=this.zd.Ce(),i=this.lh.Ph();return this.UW(e,i),-1!=t?(this.lh.addElement(i,t),this.g.Ra(t,this.xh,e),this.cr(e,this.g.Ua(t))):this.cr(e,-1),e},s.prototype.HP=function(t){this.zd.jd(t)},s.prototype.LD=function(t,e){this.lh.addElement(this.Sr(t),e),this.g.Ra(e,this.xh,t)},s.prototype.nt=function(t){var e=this.hb.Ce(),i=this.Qd.Ph();return this.ZW(e,i),-1!=t&&this.Qd.addElement(i,t),e},s.prototype.MD=function(t,e){this.Qd.addElement(this.Rh(t),e)},s.prototype.Uu=function(t){this.hb.jd(t),0<=(t=this.nh.lF(t))&&this.nh.SV(t)},s.prototype.hj=function(e,i){if(-1==this.pg(e,0))this.LB(e,0,i);else{if(-1!=this.pg(e,1))throw t.i.Qa();this.LB(e,1,i)}this.ky(e,i)},s.prototype.ky=function(t,e){var i=this.il(e);if(-1!=i){var n=this.Rp(i,e);this.hr(n,e,t),this.fr(t,e,n),this.fr(i,e,t),this.hr(t,e,i)}else this.hr(t,e,t),this.fr(t,e,t),this.ln(e,t)},s.prototype.Op=function(t,e){return this.pg(t,0)==e?0:1},s.prototype.Xm=function(t,e){var i,n=this.dz(e);if(-1!=n&&(this.df.vd(n,-1),this.Et(e,-1)),-1!=(n=this.il(e))){var r=i=n;do{var s=!1,o=this.Op(i,e),a=this.RF(i,o);if(this.pg(i,o+1&1)==t){if(this.Xu(i),this.Qd.bh(this.Rh(i)),this.Uu(i),i==a){n=-1;break}n==i&&(n=this.il(e),r=a,s=!0)}i=a}while(i!=r||s);if(-1!=n){do{o=this.Op(i,e),a=this.RF(i,o),this.LB(i,o,t),i=a}while(i!=r);-1!=(i=this.il(t))?(r=this.Rp(i,t),s=this.Rp(n,t),r==i?(this.ln(t,n),this.ky(i,t),this.ln(t,i)):s==n&&this.ky(n,t),this.fr(n,t,r),this.hr(r,t,n),this.fr(i,t,s),this.hr(s,t,i)):this.ln(t,n)}}for(n=this.Sr(t),i=this.Sr(e),r=this.lh.rc(i);-1!=r;r=this.lh.lb(r))this.g.Ra(this.lh.ja(r),this.xh,t);this.lh.Hy(n,i),this.HP(e)},s.prototype.UT=function(t,e){var i=this.pg(t,0),n=this.pg(t,1),r=this.pg(e,0),s=this.pg(e,1);this.Qd.Hy(this.Rh(t),this.Rh(e)),e==this.il(i)&&this.ln(i,t),e==this.il(n)&&this.ln(n,t),this.Xu(e),this.Uu(e),i==r&&n==s||n==r&&i==s||(this.Hn(i,this.yo),this.Hn(r,this.Pi),this.yo.qb(this.Pi)?(i!=r&&this.Xm(i,r),n!=s&&this.Xm(n,s)):(n!=r&&this.Xm(n,r),i!=s&&this.Xm(i,s)))},s.prototype.Xu=function(t){var e=this.pg(t,1);this.dF(t,this.pg(t,0)),this.dF(t,e)},s.prototype.dF=function(t,e){var i=this.Rp(t,e),n=this.NR(t,e),r=this.il(e);i!=t?(this.fr(n,e,i),this.hr(i,e,n),r==t&&this.ln(e,i)):this.ln(e,-1)},s.prototype.WD=function(t,e,i){var n=this.Qd.rc(t),r=this.Qd.ja(n);t=this.Le(r);var s=this.Le(this.g.U(r));for(this.g.jr(r,e,i,!0),n=this.Qd.lb(n);-1!=n;n=this.Qd.lb(n)){r=this.Qd.ja(n);var o=this.Le(r)==t;this.g.jr(r,e,i,o)}n=e.Vp(i,0).ac(),e=e.Vp(i,e.ol(i)-1).wc(),this.BK(t,n),this.BK(s,e)},s.prototype.ZE=function(t,e,i){var n=this.Rh(t),r=this.pg(t,0),s=this.pg(t,1),o=this.nt(-1);for(this.nh.add(o),this.Pl(o,-3),this.Ff.add(o),this.hj(o,r),t=1,e=e.ol(i);t<e;t++)i=this.Ym(-1),this.Ak.add(i),this.Ff.add(i),this.hj(o,i),o=this.nt(-1),this.nh.add(o),this.Pl(o,-3),this.Ff.add(o),this.hj(o,i);for(this.hj(o,s),n=this.Qd.rc(n);-1!=n;n=this.Qd.lb(n))if(s=this.Qd.ja(n),this.Le(s)==r){t=0;do{0<t&&(o=this.Ff.get(t-1),this.LD(o,s),-1==this.ez(o)&&this.cr(o,this.g.Ua(s))),o=this.Ff.get(t),t+=2,this.MD(o,s),s=this.g.U(s)}while(t<this.Ff.size)}else{t=this.Ff.size-1;do{t<this.Ff.size-2&&(o=this.Ff.get(t+1),this.LD(o,s),0>this.ez(o)&&this.cr(o,this.g.Ua(s))),o=this.Ff.get(t),t-=2,this.MD(o,s),s=this.g.U(s)}while(0<=t)}this.Ff.clear(!1)},s.prototype.Le=function(t){return this.g.Pa(t,this.xh)},s.prototype.TI=function(e,i,n){var r=this.pg(i,0),s=new t.h;this.Hn(r,s);var o=new t.h,a=this.pg(i,1);this.Hn(a,o);var h=n.ol(e),l=n.Vp(e,0),c=new t.h;if(l.Yp(c),!s.qb(c)){if(!this.Ng){var u=s.compare(this.vh);0>u*(c=c.compare(this.vh))&&(this.Ng=!0)}this.vF(r,this.Ff),this.Ak.add(r)}for(!this.Ng&&1<h&&(u=s.compare(o),l=l.wc(),(s.compare(l)!=u||l.compare(o)!=u||0>l.compare(this.vh))&&(this.Ng=!0)),e=(l=n.Vp(e,h-1)).wc(),o.qb(e)||(this.Ng||0>(u=o.compare(this.vh))*(c=e.compare(this.vh))&&(this.Ng=!0),this.vF(a,this.Ff),this.Ak.add(a)),this.Ff.add(i),o=0,a=this.Ff.size;o<a;o++)e=this.Ff.get(o),n=this.Pp(e),t.$c.LG(n)&&(this.Mc.vd(n,-1),this.Pl(e,-1)),e!=i&&-3!=this.Pp(e)&&(this.nh.add(e),this.Pl(e,-3));this.Ff.clear(!1)},s.prototype.lO=function(t,e){this.$d.compare(this.Mc,this.Mc.ja(t),e),this.$d.rg&&(this.$d.Kr(),this.oF(t,e))},s.prototype.oF=function(e,i){this.Wn=!0,e=this.Mc.ja(e),i=this.Mc.ja(i);var n=this.Qd.Jn(this.Rh(e)),r=this.Qd.Jn(this.Rh(i)),s=this.g.bc(n);null==s&&(null==this.ie&&(this.ie=new t.yb),this.g.ed(n,this.ie),s=this.ie),null==(n=this.g.bc(r))&&(null==this.Nm&&(this.Nm=new t.yb),this.g.ed(r,this.Nm),n=this.Nm),this.Gk.Oo(s),this.Gk.Oo(n),this.Gk.Ea(this.qa,!0)&&(this.Ng=!0),this.hK(e,i,-1,this.Gk),this.Gk.clear()},s.prototype.GQ=function(e,i){this.Wn=!0,i=this.Mc.ja(i);var n=this.Qd.Jn(this.Rh(i)),r=this.g.bc(n);null==r&&(null==this.ie&&(this.ie=new t.yb),this.g.ed(n,this.ie),r=this.ie),n=this.BF(e),this.Gk.Oo(r),this.g.Vi(n,this.jo),this.Gk.Kz(this.qa,this.jo,!0),this.hK(i,-1,e,this.Gk),this.Gk.clear()},s.prototype.xS=function(){if(0!=this.nh.size)for(;0!=this.nh.size;){if(this.nh.size>Math.max(100,this.g.fd)){this.nh.clear(!1),this.Ng=!0;break}var t=this.nh.Fc();this.nh.If(),this.Pl(t,-1),-1!=this.WS(t)&&this.wS(t),this.Vn=!1}},s.prototype.wS=function(t){if(this.Vn){var e=this.Mc.zu(this.MH,this.GH,t,!0);this.Vn=!1}else e=this.Mc.KD(t);-1==e?this.UT(this.Mc.ja(this.Mc.FF()),t):(this.Pl(t,e),this.$d.rg&&(this.$d.Kr(),this.oF(this.$d.Dm,e)))},s.prototype.WS=function(e){var i=this.pg(e,0);if(e=this.pg(e,1),this.Hn(i,this.yo),this.Hn(e,this.Pi),t.h.yc(this.yo,this.Pi)<=this.UA)return this.Ng=!0,-1;var n=this.yo.compare(this.vh),r=this.Pi.compare(this.vh);return 0>=n&&0<r?e:0>=r&&0<n?i:-1},s.prototype.oQ=function(){var e=new t.ia(0);e.Jb(this.g.fd);for(var i=this.g.Yq(),n=i.next();-1!=n;n=i.next())-1!=this.g.Pa(n,this.xh)&&e.add(n);this.g.nx(e,e.size),this.pQ(e)},s.prototype.pQ=function(i){this.df.clear(),this.df.De(i.size),this.df.Vo(new e(this.g));var n=new t.h;n.Rc();for(var r=-1,s=new t.h,o=0,a=i.size;o<a;o++){var h=i.get(o);this.g.Gc(h,s),s.qb(n)?(h=this.g.Pa(h,this.xh),this.Xm(r,h)):(r=this.Le(h),this.g.Gc(h,n),h=this.df.xn(h),this.Et(r,h))}},s.prototype.qQ=function(){var e=new t.ia(0);e.Jb(this.g.fd);for(var i=this.df.rc(-1);-1!=i;i=this.df.lb(i))e.add(this.df.ja(i));this.df.clear(),this.g.nx(e,e.size),i=0;for(var n=e.size;i<n;i++){var r=e.get(i),s=this.Le(r);r=this.df.xn(r),this.Et(s,r)}},s.prototype.vF=function(e,i){var n=this.il(e);if(-1!=n){var r=n;do{t.$c.LG(this.Pp(r))&&i.add(r),r=this.Rp(r,e)}while(r!=n)}},s.prototype.BK=function(t,e){for(t=this.lh.rc(this.Sr(t));-1!=t;t=this.lh.lb(t))this.g.mf(this.lh.ja(t),e)},s.prototype.hK=function(t,e,i,n){this.Xu(t),-1!=e&&this.Xu(e),this.TI(0,t,n),-1!=e&&this.TI(1,e,n),-1!=i&&(n.Bf.D(this.yo),this.Hn(i,this.Pi),this.Pi.qb(this.yo)||this.Ak.add(i)),i=0;for(var r=this.Ak.size;i<r;i++){var s=this.Ak.get(i),o=this.dz(s);-1!=o&&(this.df.vd(o,-1),this.Et(s,-1))}for(i=this.Rh(t),r=-1!=e?this.Rh(e):-1,this.WD(i,n,0),-1!=e&&this.WD(r,n,1),this.ZE(t,n,0),-1!=e&&this.ZE(e,n,1),this.Qd.bh(i),this.Uu(t),-1!=e&&(this.Qd.bh(r),this.Uu(e)),i=0,r=this.Ak.size;i<r;i++)(s=this.Ak.get(i))==this.Jq&&(this.Xv=!0),-1==(o=this.dz(s))&&(-1==(o=this.df.KD(this.BF(s)))?(t=this.Le(this.df.ja(this.df.FF())),this.Xm(t,s)):this.Et(s,o));this.Ak.clear(!1)},s.prototype.Hn=function(t,e){this.g.dG(this.ez(t),e)},s.prototype.BF=function(t){return this.lh.Jn(this.Sr(t))},s.prototype.jC=function(){this.Xv=!1,this.Jq=-1,null==this.$d&&(this.Mc.Rv=!1,this.$d=new n(this),this.Mc.Zn=this.$d);var e=new t.ia(0),s=null,o=null;this.GH=this.MH=-1,this.Vn=!1;for(var a=this.df.rc(-1);-1!=a;){this.Vn=!1;var h=this.df.ja(a);this.Jq=this.Le(h),this.g.Gc(h,this.vh),this.$d.$J(this.vh.y,this.vh.x);var l=this.il(this.Jq),c=-1==l;if(!c){h=l;do{var u=this.Pp(h);-1==u?(this.nh.add(h),this.Pl(h,-3)):-3!=u&&e.add(u),h=this.Rp(h,this.Jq)}while(h!=l)}if(0<e.size){for(this.Vn=1==e.size&&1==this.nh.size,c=0,l=e.size;c<l;c++)h=this.Mc.ja(e.get(c)),this.Pl(h,-2);var d=-2,f=-2;for(c=0,l=e.size;c<l;c++){if(u=e.get(c),-2==d){var p=this.Mc.we(u);-1!=p?(h=this.Mc.ja(p),-2!=(h=this.Pp(h))&&(d=p)):d=-1}if(-2==f&&(-1!=(u=this.Mc.lb(u))?(h=this.Mc.ja(u),-2!=(h=this.Pp(h))&&(f=u)):f=-1),-2!=d&&-2!=f)break}for(c=0,l=e.size;c<l;c++)u=e.get(c),h=this.Mc.ja(u),this.Mc.vd(u,-1),this.Pl(h,-1);e.clear(!1),this.MH=-1!=d?d:-1,this.GH=-1!=f?f:-1,-1!=d&&-1!=f?this.Vn||this.lO(d,f):-1==d&&-1==f&&(this.Vn=!1)}else c&&(null==s&&(s=new r(this)),s.Dh(this.vh),this.Mc.uJ(s),s.rg&&(s.Kr(),this.GQ(this.Jq,s.Dm)));this.xS(),this.Xv?(this.Xv=!1,null==o&&(o=new i(this.g)),o.Dh(this.vh),a=this.df.uJ(o)):a=this.df.lb(a)}return this.Wn},s.prototype.er=function(e){for(this.g=e,this.xh=this.g.Gd(),this.hb.De(e.fd+32),this.zd.De(e.fd),this.lh.At(e.fd),this.lh.fn(e.fd),this.Qd.At(e.fd+32),this.Qd.fn(e.fd+32),e=this.g.ld;-1!=e;e=this.g.ue(e))if(t.aa.Hc(this.g.ic(e)))for(h=this.g.Ob(e);-1!=h;h=this.g.Rb(h)){var i=this.g.Ja(h),n=this.g.Xa(h),r=this.Ym(n),s=this.nt(n);for(this.hj(s,r),l=this.g.U(n),n=0,i-=2;n<i;n++){var o=this.g.U(l),a=this.Ym(l);this.hj(s,a),s=this.nt(l),this.hj(s,a),l=o}this.g.dc(h)?(a=this.Ym(l),this.hj(s,a),s=this.nt(l),this.hj(s,a),this.hj(s,r)):(a=this.Ym(l),this.hj(s,a))}else for(var h=this.g.Ob(e);-1!=h;h=this.g.Rb(h)){var l=this.g.Xa(h);for(r=0,i=this.g.Ja(h);r<i;r++)this.Ym(l),l=this.g.U(l)}this.oQ()},s}();t.RC=s}(X||(X={})),function(t){var e=function(e){function i(n,r,s){var o=e.call(this)||this;if(void 0!==n)if(void 0!==s){o.description=t.ee.og();var a=new t.Nd;a.K(n,r,s),o.dC(a)}else if(void 0!==r)o.description=t.ee.og(),o.Cb(n,r);else if(n instanceof t.ra)o.description=n;else if(n instanceof t.h)o.description=t.ee.og(),o.Cb(n);else{if(!(n instanceof i))throw t.i.N();o.description=n.description,o.Cb(n.Lg(),n.ih()),null!==n.ka&&(o.ka=n.ka.slice(0))}else o.description=t.ee.og();return o}return Q(i,e),i.prototype.D=function(e){if(void 0===e){if(this.Ac())throw t.i.fa("This operation should not be performed on an empty geometry.");return(e=new t.h).ma(this.ka[0],this.ka[1]),e}if(this.Ac())throw t.i.fa("This operation should not be performed on an empty geometry.");e.ma(this.ka[0],this.ka[1])},i.prototype.Cb=function(t,e){"number"==typeof t?(this.vc(),null==this.ka&&this.un(),this.ka[0]=t,this.ka[1]=e):(this.vc(),this.Cb(t.x,t.y))},i.prototype.Cz=function(){if(this.Ac())throw t.i.fa("This operation should not be performed on an empty geometry.");var e=new t.Nd;return e.x=this.ka[0],e.y=this.ka[1],e.z=this.description.iG()?this.ka[2]:t.ra.se(1),e},i.prototype.dC=function(e){this.vc();var i=this.hasAttribute(1);i||t.ra.DG(1,e.z)||(this.re(1),i=!0),null==this.ka&&this.un(),this.ka[0]=e.x,this.ka[1]=e.y,i&&(this.ka[2]=e.z)},i.prototype.Lg=function(){if(this.Ac())throw t.i.fa("This operation should not be performed on an empty geometry.");return this.ka[0]},i.prototype.cC=function(t){this.setAttribute(0,0,t)},i.prototype.ih=function(){if(this.Ac())throw t.i.fa("This operation should not be performed on an empty geometry.");return this.ka[1]},i.prototype.aK=function(t){this.setAttribute(0,1,t)},i.prototype.bS=function(){return this.Uc(1,0)},i.prototype.wX=function(t){this.setAttribute(1,0,t)},i.prototype.zR=function(){return this.Uc(2,0)},i.prototype.hX=function(t){this.setAttribute(2,0,t)},i.prototype.Ec=function(){return this.yF(3,0)},i.prototype.LJ=function(t){this.setAttribute(3,0,t)},i.prototype.Uc=function(e,i){var n=this.description.Pf(e);return 0<=n?this.ka[this.description.$j(n)+i]:t.ra.se(e)},i.prototype.yF=function(e,i){var n=this.description.Pf(e);return 0<=n?this.ka[this.description.$j(n)+i]:t.ra.se(e)},i.prototype.setAttribute=function(t,e,i){this.vc();var n=this.description.Pf(t);0>n&&(this.re(t),n=this.description.Pf(t)),null==this.ka&&this.un(),this.ka[this.description.$j(n)+e]=i},i.prototype.getType=function(){return 33},i.prototype.Db=function(){return 0},i.prototype.Oa=function(){this.vc(),null!=this.ka&&(this.ka[0]=NaN,this.ka[1]=NaN)},i.prototype.sn=function(e){if(null!=this.ka){for(var i=t.ee.Iw(e,this.description),n=[],r=0,s=0,o=e.Aa;s<o;s++){var a=e.kd(s),h=t.ra.Va(a);if(-1==i[s]){var l=t.ra.se(a);for(a=0;a<h;a++)n[r]=l,r++}else for(l=this.description.$j(i[s]),a=0;a<h;a++)n[r]=this.ka[l],r++,l++}this.ka=n}this.description=e},i.prototype.un=function(){this.lJ(this.description.Ae.length),i.cE(this.description.Ae,this.ka,this.description.Ae.length),this.ka[0]=NaN,this.ka[1]=NaN},i.prototype.Oc=function(e){if(e instanceof t.Dd){if(!this.Ac()){var i=this.D();e.Eh(i,i),this.Cb(i)}}else this.Ac()||(this.re(1),i=this.Cz(),this.dC(e.fp(i)))},i.prototype.copyTo=function(e){if(33!=e.getType())throw t.i.N();e.vc(),null==this.ka?(e.Oa(),e.ka=null,e.Nf(this.description)):(e.Nf(this.description),e.lJ(this.description.Ae.length),i.cE(this.ka,e.ka,this.description.Ae.length))},i.prototype.Ia=function(){return new i(this.description)},i.prototype.B=function(){return this.Ac()},i.prototype.Ac=function(){return null==this.ka||isNaN(this.ka[0])||isNaN(this.ka[1])},i.prototype.bn=function(t){t.Oa(),this.description!=t.description&&t.Nf(this.description),t.Zb(this)},i.prototype.A=function(t){this.Ac()?t.Oa():(t.v=this.ka[0],t.G=this.ka[1],t.C=this.ka[0],t.H=this.ka[1])},i.prototype.Qo=function(t){if(this.Ac())t.Oa();else{var e=this.Cz();t.v=e.x,t.G=e.y,t.Ye=e.z,t.C=e.x,t.H=e.y,t.Bg=e.z}},i.prototype.Tg=function(e,i){var n=new t.Nc;return this.Ac()?(n.Oa(),n):(e=this.Uc(e,i),n.oa=e,n.va=e,n)},i.prototype.lJ=function(e){if(null==this.ka)this.ka=t.O.lg(e);else if(this.ka.length<e){for(var i=this.ka.slice(0),n=this.ka.length;n<e;n++)i[n]=0;this.ka=i}},i.cE=function(t,e,i){if(0<i)for(i=0;i<t.length;i++)e[i]=t[i]},i.prototype.Nb=function(t){if(t==this)return!0;if(!(t instanceof i)||this.description!=t.description)return!1;if(this.Ac())return!!t.Ac();for(var e=0,n=this.description.Ae.length;e<n;e++)if(this.ka[e]!=t.ka[e])return!1;return!0},i.prototype.cc=function(){var e=this.description.cc();if(!this.Ac())for(var i=0,n=this.description.Ae.length;i<n;i++){var r=this.ka[i];r=t.O.truncate(r^r>>>32),e=t.O.Th(r,e)}return e},i.prototype.mg=function(){return null},i}(t.aa);t.Sa=e}(X||(X={})),function(t){var e=function(){function t(t,e,i){void 0!==t&&(this.x=t,this.y=e,this.z=i)}return t.construct=function(e,i,n){var r=new t;return r.x=e,r.y=i,r.z=n,r},t.prototype.K=function(t,e,i){this.x=t,this.y=e,this.z=i},t.prototype.lx=function(){this.z=this.y=this.x=0},t.prototype.normalize=function(){var t=this.length();0==t&&(this.x/=t,this.y/=t,this.z/=t)},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.Ag=function(e){new t(this.x*e,this.y*e,this.z*e)},t.prototype.Qh=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t}();t.Nd=e}(X||(X={})),function(t){var e=function(){function e(t,e,i){this.Gw=this.DA=null,this.Xf=e,this.FT=e.y-i,this.ET=e.y+i,this.Ew=0,this.dA=t,this.qa=i,this.RT=i*i,this.eA=0!=i,this.Lv=!1}return e.prototype.result=function(){return 0!=this.Ew?1:0},e.prototype.ZM=function(e){return e=e.hc(e.fe(this.Xf,!1)),t.h.yc(e,this.Xf)<=this.RT},e.prototype.fF=function(t){if(!this.eA&&(this.dA&&this.Xf.qb(t.ac())||this.Xf.qb(t.wc())))this.Lv=!0;else if(t.na==this.Xf.y&&t.na==t.la){if(this.dA&&!this.eA){var e=Math.max(t.sa,t.pa);this.Xf.x>Math.min(t.sa,t.pa)&&this.Xf.x<e&&(this.Lv=!0)}}else{var i=!1;if(e=Math.max(t.sa,t.pa),this.Xf.x>e?i=!0:this.Xf.x>=Math.min(t.sa,t.pa)&&(i=0<t.cq(!0,this.Xf.y,this.Gw,null)&&this.Gw[0]<=this.Xf.x),i){if(this.Xf.y==t.ac().y){if(this.Xf.y<t.wc().y)return}else if(this.Xf.y==t.wc().y&&this.Xf.y<t.ac().y)return;this.Ew=this.dA?1^this.Ew:this.Ew+(t.ac().y>t.wc().y?1:-1)}}},e.prototype.SI=function(t){var e=t.Tg(0,1);if(e.oa>this.ET||e.va<this.FT)return!1;if(this.eA&&this.ZM(t))return!0;if(e.oa>this.Xf.y||e.va<this.Xf.y)return!1;if(null==this.DA&&(this.DA=[null,null,null,null,null]),null==this.Gw&&(this.Gw=[0,0,0]),0<(e=t.eG()))for(t=0;t<e;t++){var i=this.DA[t].get();if(this.fF(i),this.Lv)return!0}else if(this.fF(t),this.Lv)return!0;return!1},e.PM=function(t,i,n){for(i=new e(0==t.In(),i,n),t=t.Ga();t.$a();)for(;t.Ha();)if(n=t.ha(),i.SI(n))return-1;return i.result()},e.QM=function(i,n,r,s){var o=new t.l;i.xc(o),o.W(s,s);var a=new e(0==i.In(),r,s);i=i.Ga();var h=new t.l;for(h.K(o),h.C=r.x+s,h.G=r.y-s,h.H=r.y+s,s=(r=n.MF(h,s)).next();-1!=s;s=r.next())if(i.Vb(n.ja(s)),i.Ha()&&(s=i.ha(),a.SI(s)))return-1;return a.result()},e.wm=function(i,n,r){if(i.B())return 0;var s=new t.l;if(i.xc(s),s.W(r,r),!s.contains(n))return 0;if(null!=(s=i.Bb)){var o=s.Fk;if(null!=o){if(1==(o=o.So(n.x,n.y)))return 1;if(0==o)return 0}if(null!=(s=s.Fb))return e.QM(i,s,n,r)}return e.PM(i,n,r)},e.bT=function(t,i,n){return i.B()?0:e.wm(t,i.D(),n)},e.Ml=function(t,e){return!(16>(t=t.I()))&&2*t+Math.log(t)/Math.log(2)*e<1*t*e},e}();t.Dg=e}(X||(X={})),function(t){var e=function(t){function e(e){return t.call(this,!0,e)||this}return Q(e,t),e.prototype.Ia=function(){return new e(this.description)},e.prototype.Db=function(){return 2},e.prototype.getType=function(){return 1736},e.prototype.xG=function(t,e,i){this.JS(t,e,i)},e.prototype.qR=function(){this.FR()},e}(t.Vk);t.Da=e}(X||(X={})),function(t){!function(t){t[t.PiPOutside=0]="PiPOutside",t[t.PiPInside=1]="PiPInside",t[t.PiPBoundary=2]="PiPBoundary"}(t.RL||(t.RL={})),t.hd=function(){function e(){}return e.KG=function(e,i,n){return 0==(e=t.Dg.bT(e,i,n))?0:1==e?1:2},e.Yd=function(e,i,n){return 0==(e=t.Dg.wm(e,i,n))?0:1==e?1:2},e.WX=function(i,n,r,s,o){if(n.length<r||o.length<r)throw t.i.N();for(var a=0;a<r;a++)o[a]=e.Yd(i,n[a],s)},e.sK=function(i,n,r,s,o){if(1736==i.getType())e.WX(i,n,r,s,o);else{if(197!=i.getType())throw t.i.fa("invalid_call");var a=new t.l;i.A(a),e.$M(a,n,r,s,o)}},e.$M=function(e,i,n,r,s){if(i.length<n||s.length<n)throw t.i.N();if(e.B())for(r=0;r<n;r++)s[r]=0;else for(e.W(.5*-r,.5*-r),e.W(.5*r,.5*r),r=0;r<n;r++)e.contains(i[r])?s[r]=1:e.contains(i[r])?s[r]=2:s[r]=0},e.YX=function(t,e,i,n,r){for(var s=0;s<i;s++)r[s]=t.qs(e[s],n)?2:0},e.XX=function(t,e,i,n,r){var s=t.Bb,o=null;null!=s&&(o=s.Fk),s=i;for(var a=0;a<i;a++)if(r[a]=1,null!=o){var h=e[a];0==o.So(h.x,h.y)&&(r[a]=0,s--)}if(0!=s)for(t=t.Ga();t.$a()&&0!=s;)for(;t.Ha()&&0!=s;)for(o=t.ha(),a=0;a<i&&0!=s;a++)1==r[a]&&o.qs(e[a],n)&&(r[a]=2,s--);for(a=0;a<i;a++)1==r[a]&&(r[a]=0)},e.tK=function(i,n,r,s,o){var a=i.getType();if(1607==a)e.XX(i,n,r,s,o);else{if(!t.aa.yd(a))throw t.i.fa("Invalid call.");e.YX(i,n,r,s,o)}},e}()}(X||(X={})),function(t){var e=function(t){function e(e,i){if(2==arguments.length){var n=t.call(this,!1,e.description)||this;n.nf(e),n.lineTo(i)}else n=t.call(this,!1,e)||this;return n}return Q(e,t),e.prototype.Ia=function(){return new e(this.description)},e.prototype.Db=function(){return 1},e.prototype.getType=function(){return 1607},e.prototype.xG=function(t,e,i){this.KS(t,e,i)},e}(t.Vk);t.Ta=e}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.progress=function(){return!0},e.zp=function(e){if(null!=e&&!e.progress(-1,-1))throw t.i.WC()},e}();t.mp=e}(X||(X={})),function(t){var e;(e=t.PK||(t.PK={}))[e.clipWithInputHorizon=1]="clipWithInputHorizon",e[e.clipWithOutputHorizon=2]="clipWithOutputHorizon";var i=function(){function t(){this.Kg=3,this.Vu=this.Jr=NaN}return t.prototype.PW=function(t){this.QB(1,t)},t.prototype.QW=function(t){this.QB(2,t)},t.prototype.hS=function(){return this.hs(1)},t.prototype.iS=function(){return this.hs(2)},t.prototype.QB=function(t,e){this.Kg=e?this.Kg|t:this.Kg&~t},t.prototype.hs=function(t){return!!(this.Kg&t)},t.prototype.Of=function(){var e=new t;return e.Jr=this.Jr,e.Vu=this.Vu,e.Kg=this.Kg,e},t}();t.yC=i,function(t){t[t.Dont_Geonomalize_Polygon=2147483648]="Dont_Geonomalize_Polygon",t[t.Dont_Adjust_At_Poles=1073741824]="Dont_Adjust_At_Poles"}(t.QK||(t.QK={}));var n=function(){function t(){this.Kg=0}return t.prototype.QB=function(t,e){this.Kg=e?this.Kg|t:this.Kg&~t},t.prototype.hs=function(t){return!!(this.Kg&t)},t.jg=function(e){var i=new t;return i.Kg=e.Kg,i},t.prototype.mM=function(t){this.Kg=t.Kg},t}();t.AY=n;var r=function(){function e(e,i,n){this.ef=e,this.Yf=i,this.Uf=new t.l,this.Uf.K(n),this.AT=e.cc()+i.cc()+this.Uf.cc().toString()}return e.prototype.cc=function(){return this.AT},e.prototype.Nb=function(t){return this==t||this.ef.Nb(t.ef)&&this.Yf.Nb(t.Yf)&&this.Uf.Nb(t.Uf)},e}();t.FY=r,r=function(){function e(){this.Yf=this.ef=null,this.rH=new i,this.sH=new n,this.ww=this.Wf=null,this.mw=this.Tn=!0}return e.Nr=function(t,i,n,r){var s;void 0===r&&(r=null),void 0===s&&(s=null);var o=new e;return o.qp(t,i,n,r,s),o},e.prototype.qp=function(e,i,n,r,s){if(null==e||null==i)throw t.i.fa("invalidArgument");if(this.ef=e,this.Yf=i,this.mw=this.Tn=!1,null!=r&&(this.rH=r.Of()),null!=s&&this.sH.mM(s),s=!1,1==i.Sb()&&null!=r&&(r=r.Jr,isNaN(r)||0==r||(s=!0)),e==i)this.Tn=!s,this.mw=!0;else{r=e.Sb();var o=i.Sb();if(0==r||0==o){if(null!=n)throw t.i.N();null!=e.Hd()&&null!=i.Hd()&&(this.Tn=e.Hd().Nb(i.Hd()))}else 3==r||3==o?this.Tn=e.Nb(i):this.ef.kS(this.Yf)?this.Tn=!s:this.Tn=!1,this.Wf=n,null!=this.Wf&&this.Wf.ix(),this.mw=(null==this.Wf||0==this.Wf.count())&&this.ef.sc().Nb(this.Yf.sc())}this.oY()},e.prototype.isIdentity=function(){return this.Tn},e.prototype.nR=function(){return this.rH.Of()},e.prototype.Nb=function(t){return t==this||!!(t instanceof e&&this.ef.Nb(t.ef)&&this.Yf.Nb(t.Yf))&&(this.Wf==t.Wf||!(null==this.Wf||null==t.Wf||!this.Wf.Nb(t.Wf)))},e.prototype.oY=function(){this.ww=new t.bu(this)},e}(),t.vr=r}(X||(X={})),function(t){var e=function(){function e(){}return e.Cp=function(t){return t*e.oW},e.mx=function(t,i){return e.gP(i-t)},e.hP=function(e){return-360<=e&&720>e?(0>e?e+=360:360<=e&&(e-=360),e):(0>(e=t.lc.RK(e))&&(e+=360),e)},e.gP=function(t){return 180<(t=e.hP(t))&&(t-=360),t},e.oW=57.29577951308232,e}();t.qr=e,t.Hh=function(){function i(){}return i.lj=function(e,i){var n=new t.l;e.A(n);var r=t.cb.gh(i),s=new t.l;return s.K(r),s.v=n.v,s.C=n.C,s.W(.01*s.ca(),0),i=t.ta.Wd(i,n,!1),s.contains(n)?e:t.Ud.clip(e,s,i,0)},i.ks=function(e,n,r,s,o){if(!t.cb.Wc(n))throw t.i.N();var a=t.ta.kj(n,e,!1),h=t.cb.gh(n),l=t.cb.sc(n),c=l.Hd().ai,u=t.cb.vv(l);l=t.cb.ev(l),u*=2-u;var d=new t.Nc;h.cn(d);var f=[[0,0],[0,0]];if(2==t.Eg.Sb(n)?s?(f[0][0]=i.Zm(o,d),f[0][1]=h.Jp(),t.cb.vt(),h=f[0][0]*c):(f[0][0]=h.gk(),f[0][1]=o,t.cb.vt(),h=f[0][1]*c):h=o*c,!s&&0!=h)throw t.i.N();var p=new t.ga,g=new t.gd;e=g.Ib(e);for(var v=[0],m=new t.h,y=new t.h,_=new t.h,b=new t.h,w=new t.h,x=new t.h,T=g.Ob(e);-1!=T;T=g.Rb(T)){var A=g.Xa(T);g.D(A,_);for(var M=!1,S=A=g.U(A);-1!=S;S=g.U(S)){if(S==A){if(M)break;M=!0}if(g.D(S,b),s&&a<o-_.x&&b.x-o>a||a<o-b.x&&_.x-o>a||!s&&a<-_.y&&b.y>a||a<-b.y&&_.y>a)do{if(!(Math.abs(_.x-b.x)>=.5*d.R())){if(2==t.Eg.Sb(n)?(f[0][0]=i.Zm(_.x,d),f[0][1]=_.y,f[1][0]=i.Zm(b.x,d),f[1][1]=b.y,t.cb.dW(),w.x=f[0][0]*c,w.y=f[0][1]*c,x.x=f[1][0]*c,x.y=f[1][1]*c):(w.x=_.x*c,w.y=_.y*c,x.x=b.x*c,x.y=b.y*c),x.x=6.283185307179586*(b.x-_.x)/d.R()+w.x,s){if(y.x=h,y.y=i.Nz(l,u,w,x,h,r),isNaN(y.y))break}else{if(y.x=i.Lz(l,u,w,x,r),isNaN(y.x))break;y.y=0}t.kb.wd(l,u,w.x,w.y,x.x,x.y,p,null,null,r);var E=p.u;t.kb.wd(l,u,w.x,w.y,y.x,y.y,p,null,null,r);var C=p.u;2==t.Eg.Sb(n)?(f[0][0]=y.x/c,f[0][1]=y.y/c,t.cb.bR(),s?(m.y=f[0][1],m.x=o):(m.x=i.os(f[0][0],_.x,b.x,d),m.y=o)):s?(m.x=o,m.y=y.y/c):(m.x=i.os(y.x/c,_.x,b.x,d),m.y=o),v[0]=0<E?t.O.Rk(C/E,0,1):.5,0!=v[0]&&1!=v[0]&&(E=g.Ma(S),g.Ul(E,v,1),g.Cb(g.U(E),m.x,m.y))}}while(0);_.L(b)}}return g.Ne(e)},i.Fn=function(e,n,r,s,o){if(e.B())return e;var a=t.cb.bf(n);return i.Hp(e,r-180*a,360*a,n,s,o,!0)},i.Nz=function(e,n,r,s,o,a){if(3.141592653589793<=Math.abs(r.x-s.x)||!i.Sn(r.x,s.x,o))return NaN;if(r.x>s.x)var h=s;else h=r,r=s;s=new t.ga(0);var l=new t.ga(0),c=new t.ga(0);t.kb.wd(e,n,h.x,h.y,r.x,r.y,l,s,null,a);var u=l.u,d=0,f=1,p=new t.h;for(p.L(h);u*(f-d)>1e-12*e;){var g=.5*(d+f);if(t.kb.oj(e,n,h.x,h.y,u*g,s.u,l,c,a),p.x=l.u,p.y=c.u,p.x==o)break;if(i.Sn(h.x,p.x,o))f=g;else{if(!i.Sn(r.x,p.x,o))return NaN;d=g}}return p.y},i.Sn=function(t,i,n){return t=e.Cp(t),i=e.mx(t,e.Cp(i)),0==(n=e.mx(t,e.Cp(n)))||0<i&&0<n&&n<=i||0>i&&0>n&&n>=i},i.Zm=function(t,e){var i=e.va-e.oa;return e.It(t-Math.floor((t-e.oa)/i)*i)},i.os=function(e,i,n,r){var s=new t.Nc;for(s.K(i,n),n=r.R(),e=Math.floor((e-i)/n)*n+e,s=s.sf();Math.abs(e-s)>Math.abs(e+n-s);)e+=n;return e},i.Lz=function(e,i,n,r,s){if(n.y>r.y)var o=r;else o=n,n=r;if((r=new t.Nc).K(o.y,n.y),!r.contains(0)||3.141592653589793<=Math.abs(o.x-n.x))return NaN;if(o.x==n.x)return o.x;var a=new t.ga(0),h=new t.ga(0),l=new t.ga(0);t.kb.wd(e,i,o.x,o.y,n.x,n.y,h,a,null,s);var c=h.u,u=0,d=1,f=new t.h;for(f.L(o);c*(d-u)>1e-12*e;){var p=.5*(u+d);if(t.kb.oj(e,i,o.x,o.y,c*p,a.u,h,l,s),f.x=h.u,f.y=l.u,r.K(o.y,f.y),0==f.y)break;if(r.contains(0))d=p;else{if(r.K(n.y,f.y),!r.contains(0))return NaN;u=p}}return f.x},i.Hp=function(e,i,n,r,s,o,a){var h=new t.l;if(e.A(h),h.B())return e;var l=new t.Nc;h.cn(l);var c=new t.Nc;if(c.K(i,i+n),c.contains(l)&&c.va!=l.va)return e;var u=new t.l;u.K(h);var d=e.getType();if(33==d)return((h=(u=s?e:e.Of()).Lg())<c.oa||h>=c.va||a&&h==c.va)&&(h+=Math.ceil((c.oa-h)/n)*n,h=c.It(h),u.cC(h)),u;if(550==d){for(r=(u=s?e:e.Of()).ub(0),d=2*u.I(),e=!1,s=0;s<d;s+=2)((h=r.read(s))<c.oa||h>=c.va||a&&h==c.va)&&(e=!0,h+=Math.ceil((c.oa-h)/n)*n,h=c.It(h),r.write(s,h));return e&&u.Pc(1993),u}if(c.contains(l))return e;if(197==d)return n=s?e:e.Of(),h.Ea(u),n.Xo(h),n;var f=.1*Math.max(h.ca(),h.R());for(u.W(0,f),a=e,c=r.Xd(0),e=t.Gh.local(),s=new t.Dd;;){var p=Math.floor((l.oa-i)/n),g=Math.ceil((l.va-i)/n);if(!(3<g-p))break;p=Math.floor(.5*(g+p)),u.v=h.v-f,u.C=i+n*p;var v=t.Ud.clip(a,u,c,o);u.v=u.C,u.C=h.C+f;var m=t.Ud.clip(a,u,c,o);s.gg((p-g)*n,0),m.Oc(s),1736==d?a=e.V(v,m,r,null):(a=v).add(m,!1),a.A(h),h.cn(l)}for(u.v=i,u.C=i+n,(i=new t.l).K(u),i.W(c,0),0!=(i=Math.floor((h.v-u.v)/n)*n)?(u.move(i,0),s.gg(-i,0)):s.RB(),i=1607==d?new t.Ta(a.description):new t.Da(a.description),o=new t.l,l=new t.l;h.C>u.v;)(f=t.Ud.clip(a,u,c,0)).A(l),(1607==d?!f.B()&&(l.R()>c||l.ca()>c):!f.B()&&(1736!=d||l.R()>c))&&(f.Oc(s),f.A(l),i.A(o),o.W(c,c),o.isIntersecting(l)&&1736==d?i=e.V(i,f,r,null):i.add(f,!1)),u.move(n,0),s.shift(-n,0);return i},i.WI=function(e,i,n,r){var s=new t.de(n.description);s.Fd(n,0,-1),s=t.cb.zh(s,e,i);var o=n.I();if(r.Oa(),!t.cb.Wc(e)||o!=s.I())return!1;var a=new t.l;n.A(a);var h=new t.l;if(s.A(h),a=a.R(),h=h.R(),0!=a&&0!=h){if(h/=a,e=t.cb.gh(i).R()/t.cb.gh(e).R(),1e-10<Math.abs(h/e-1))return!1}else if(0!=a||0!=h)return!1;for(r.add(n,!1),n=0;n<o;n++)e=s.Na(n),r.Cb(n,e);return!0},i.Oz=function(){throw t.i.Ie()},i}()}(X||(X={})),function(t){var e,i,n;(i=e=t.si||(t.si={}))[i.Clip=0]="Clip",i[i.DontClip=1]="DontClip",i[i.PannableFold=2]="PannableFold",function(t){t[t.Geodesic=0]="Geodesic",t[t.Loxodrome=1]="Loxodrome",t[t.GreatElliptic=2]="GreatElliptic",t[t.NormalSection=3]="NormalSection",t[t.ShapePreserving=4]="ShapePreserving"}(n=t.WK||(t.WK={})),t.zb=function(){function i(){}return i.xv=function(e,i,n){if(n||0<i){for(e=e.toString(t.Sc.PE_STR_NAME_CANON|t.Sc.PE_STR_AUTH_NONE),i=[],n=0;n<e.length;n++)i[n]="a"<=e[n]&&"z">=e[n]?i[n]=e[n].toUpperCase():e[n];return i.join()}return e.toString(t.Sc.PE_STR_AUTH_TOP)},i.ur=function(e,i,n,r){var s=r.length,o=n.I();if(0!=o){var a=n.ub(0),h=Math.min(o,s),l=0,c=e.eh();isNaN(i)&&(i=0);for(var u=e.Wc(),d=179*(e=u?e.sc().Oe().R():0)/360;0<o;){if(a.uB(l<<1,h,r),t.ej.projToGeogCenter(c,h,r,i),u)for(var f=0;f<h;f++){var p=r[f][0]-i,g=t.lc.sign(p),v=a.read(2*(l+f));0>g*t.lc.sign(v)&&Math.abs(p)>d&&(r[f][0]+=-g*e)}a.uC(l<<1,h,r),l+=h,o-=h,h=Math.min(o,s)}n.Pc(1993)}},i.IL=function(e,i,n,r){var s=0,o=e.eh();isNaN(s)&&(s=0);var a=e.Wc(),h=e.bf();e=360*h,h*=179;for(var l=r.length,c=0;c<n;){for(var u=c;u<n&&i[u].isNaN();++u)c++;var d=Math.min(l,n-c);if(0<d){u=1;for(var f=c+1;u<d;++u,++f)if(i[f].isNaN()){d=u;break}if(t.ta.Jy(r,i,c,d),t.ej.projToGeogCenter(o,d,r,s),a)for(u=0,f=c;u<d;++u,++f){var p=i[f].x,g=r[u][0]-s,v=t.lc.sign(g);0>v*t.lc.sign(p)&&Math.abs(g)>h&&(r[u][0]-=v*e)}t.ta.Iy(i,c,r,d),c+=d}}},i.Lx=function(e,i,n){var r=n.length,s=i.I();if(!(1>s)){var o=i.ub(0),a=Math.min(s,r),h=0,l=e.eh(),c=e.Wc(),u=c?e.Oe().R():0,d=179*u/360,f=0;for(c&&(f=e.zi());0<s;){if(o.uB(h<<1,a,n),t.ej.geogToProj(l,a,n),c)for(e=0;e<a;e++){var p=n[e][0],g=t.lc.sign(p),v=o.read(2*(h+e))-f;0>g*t.lc.sign(v)&&Math.abs(p)>d&&(n[e][0]+=-g*u)}o.uC(h<<1,a,n),h+=a,s-=a,a=Math.min(s,r)}i.Pc(1993)}},i.HL=function(e,i,n,r){if(0!=n){var s=e.eh(),o=e.Wc(),a=o?e.Oe().R():0,h=179*a/360,l=0;for(o&&(l=e.zi()),e=0;e<n;){for(var c=e;c<n&&i[c].isNaN();++c)e++;var u=Math.min(r.length,n-e);if(0<u){c=1;for(var d=e+1;c<u;++c,++d)if(i[d].isNaN()){u=c;break}if(t.ta.Jy(r,i,e,u),t.ej.geogToProj(s,u,r),o)for(c=0,d=e;c<u;c++){var f=r[c][0],p=t.lc.sign(f);0>p*t.lc.sign(i[d].x-l)&&Math.abs(f)>h&&(r[c][0]-=p*a)}t.ta.Iy(i,e,r,u),e+=u}}}},i.tr=function(e,i,n,r){var s=i.I();if(0!=s){var o=i.ub(0),a=e.ef,h=e.Yf,l=a.sc().Qp(),c=h.sc().Qp(),u=a.bf(),d=h.bf();if(null==(e=e.Wf)||0==e.count()){for(n=l/c,r=(a.Up()-h.Up())*d,c=-90*u,e=90*u,l=!1,d=1,a=2*s;d<a;)u=o.get(d),(h=t.O.Rk(u,c,e))!=u&&(o.set(d,h),l=!0),d+=2;if(0!=r||1!=n)for(l=!0,c=new t.h,d=0;d<s;d++)o.tc(2*d,c),c.x*=n,c.x+=r,c.y*=n,o.Tt(2*d,c);l&&i.Pc(1993)}else{a=r.length,h=Math.min(s,a);var f=t.O.lg(h),p=null,g=0,v=NaN,m=NaN,y=360*d,_=d/u;n&&(m=90*d,v=89.9*u,p=t.O.lg(h));for(var b=!0,w=0;0!=s;){for(u=!1,o.uB(g<<1,h,r),d=0;d<h;d++)f[d]=r[d][0];if(n)for(d=0;d<h;d++){var x=Math.abs(r[d][1])-v;0<x&&(u=r[d][1],r[d][1]=t.lc.Cn(v,u),p[d]=t.lc.Cn(x,u),u=!0)}for(d=r[0][0],e.transform(r,h,l,c),b&&(w=r[0][0]-_*d,b=!1),d=0;d<h;d++)x=r[d][0]-f[d]*_-w,200<Math.abs(x)&&(r[d][0]=0<x?r[d][0]-y:r[d][0]+y);if(u){for(d=0;d<h;d++)0!=p[d]&&(r[d][1]+=_*p[d],r[d][1]>m?r[d][1]=m:r[d][1]<-m&&(r[d][1]=-m));for(u=0;u<h;u++)p[u]=0}o.uC(g<<1,h,r),g+=h,s-=h,h=Math.min(s,a)}i.Pc(1993)}}},i.GL=function(e,i,n,r){if(e.mw)r=90*e.ef.bf(),t.ta.dK(i,n,-r,r);else{var s=e.Wf,o=e.ef,a=e.Yf;e=o.Xr();var h=a.Xr(),l=o.bf(),c=90*l,u=a.bf();if(null==s||0==s.count()){if(r=e/h,s=(o.Up()-a.Up())*u,t.ta.dK(i,n,-c,c),0!=s||1!=r)for(u=0;u<n;u++)i[u].x*=r,i[u].x+=s,i[u].y*=r}else{o=Math.min(n,r.length),c=t.O.lg(o),a=360*u,l=u/l;for(var d=!0,f=0,p=0;0!=n;){for(u=0;u<o;u++)c[u]=i[u+p].x;for(u=i[0].x,t.ta.Jy(r,i,p,o),s.transform(r,o,e,h),t.ta.Iy(i,p,r,o),d&&(f=i[0].x-l*u,d=!1),u=0;u<o;u++){var g=i[p+u].x-c[u]*l-f;200<Math.abs(g)&&(i[p+u].x=0<g?i[p+u].x-a:i[p+u].x+a)}p+=o,n-=o,o=Math.min(n,r.length)}}}},i.dv=function(t,e){return t=t.gh(),isNaN(e)||t.Ju(e,0),t},i.UQ=function(e,n,r,s,o,a,h,l){for(var c=i.dv(s,o),u=c.R(),d=u/360,f=i.pE*d,p=e.ub(0),g=n.Wc(),v=g?u/n.Oe().R():0,m=!1,y=new t.Da(r.description),_=0,b=r.da();_<b;++_){var w=g,x=new t.Ta(r.description);if(x.addPath(r,_,!0),0!=h){var T=i.PD(!0,x,c.H-l,c.H,h);(m=m||T)&&(w=!1)}var A=-1;w&&(A=e.Ba(_));var M=x.ub(0),S=x.I(),E=0,C=M.read(0),O=0;T=3*s.Xd(0);var R=!1,I=new t.h;I.Rc();var P=new t.h;P.Rc();for(var N=!1,D=1;D<S;++D){var L=t.h.construct(M.eg(2*D),M.eg(2*D+1)),z=L.x,j=z+E,k=j-C;if(L.x=j,Math.abs(k)>f){if(w){var F=A+(D+1<S?D:0),H=p.read(2*(A+D-1));F=(p.read(2*F)-H)*v,Math.abs(k-F)>1*d&&(w=!1)}w||(j=z+(E-=t.lc.Cn(u,j-C)),++O,N=0!=E,L.x=j)}else R||t.ta.AG(P,I,L,T)&&(R=!0);N&&M.write(2*D,j),C=j,P.L(I),I.L(L)}0<O&&x.Pc(1993),w=x.Na(0),S=x.Na(S-1),x=t.h.tb(w,S)<T?i.uQ(x,s,o,a,R):i.vQ(e,_,x,s,o),y.add(x,!1)}return o=s.Xd(0),r=c.R()/180,i.Jt(y,c,.1*o,!1),y=y!=(o=t.ri.clip(y,c,o,r,a)),e=e.Ke(),h=0,0<(l=o.Ke())&&0>e?h=1:0>=l&&0<e&&(0==l?(l=NaN,2==n.Sb()?l=n.ml().Ke():1==n.Sb()&&(l=n.Oe().wF()),e>.99*l&&(h=-1)):h=-1),0!=h&&((n=new t.Da(o.description)).tp(c),(n=t.Xl.local().V(n,r,a)).add(o,!1),y=!0,o=n),y&&(o=t.Yl.local().V(o,s,!1,a)),o},i.vQ=function(e,n,r,s,o){var a=r.I(),h=r.Na(0),l=r.Na(a-1);o=(s=i.dv(s,o)).R(),h=t.lc.sign(l.x-h.x);var c=new t.l;r.xc(c);var u=s.gk();if(l=u-o,u+=o,0<=h){var d=Math.ceil((l-c.v)/o);for(d*=o;l>c.v+d;)d+=o;for(;l<c.C+d;)d-=o;var f=d;720<c.R()&&(u=l+360*Math.ceil(c.R()/360))}else{for(d=Math.ceil((u-c.C)/o),d*=o;u<c.C+d;)d-=o;for(;u>c.v+d;)d+=o;f=d,720<c.R()&&(l=u-360*Math.ceil(c.R()/360))}d=h*o;var p=t.l.construct(c.v,c.G,c.C,c.H);p.move(f,0);var g=new t.Dd;g.gg(f,0),r.Oc(g),(c=new t.Ta(r.description)).add(r,!1),f=r.Na(a-1),o=0;for(var v=c.Na(0).x,m=0;0<h?p.C<u:p.v>l;)1024<=m&&(m=0),p.move(d,0),g.Gb=d,r.Oc(g),v+=d,s.v<=v&&s.C>=v&&(o=c.I()-1),r.Cb(0,f),f=r.Na(a-1),c.Dr(r,0,0,a-1,!1);return r=new t.Da(c.description),a=0<e.Ir(n),r.add(c,!1),e=c.Na(0),l=c.Na(c.I()-1),n=r.da()-1,(0>h?a:!a)?(h=t.h.construct(l.x,s.H),r.Ci(h),h=t.h.construct(s.gk(),s.H),r.Ci(h),s=t.h.construct(e.x,s.H)):(h=t.h.construct(l.x,s.G),r.Ci(h),h=t.h.construct(s.gk(),s.G),r.Ci(h),s=t.h.construct(e.x,s.G)),r.Ci(s),r.xG(0,n,0),r.kO(o),r},i.uQ=function(e,n,r,s,o){var a=new t.Da(e.description);a.add(e,!1),a.DB(0,a.I()-1);var h=new t.l;a.xc(h);var l=(r=i.dv(n,r)).R(),c=Math.ceil((r.v-h.v)/l);for(c*=l;r.v>h.v+c;)c+=l;for(;r.v<h.C+c;)c-=l;if(0!=(c+=l)){h.move(c,0);var u=new t.Dd;u.gg(c,0),a.Oc(u)}if(r.v<=h.v&&r.C>h.C)return o&&(o=a.Ke(),n=(a=t.Yl.local().V(a,n,!0,s)).Ke(),(n=t.lc.sign(o)!=t.lc.sign(n))&&a.oJ()),a;for((e=new t.Da(e.description)).add(a,!1),o=o||h.R()>l-n.Xd(0);h.v<r.C;)h.move(l,0),(u=new t.Dd).gg(l,0),a.Oc(u),e.add(a,!1);return o&&(o=e.Ke(),e.Yo(1),n=(e=t.Yl.local().V(e,n,!0,s)).Ke(),(n=t.lc.sign(o)!=t.lc.sign(n))&&e.oJ()),e},i.PD=function(e,i,n,r,s){for(var o=i.ub(0),a=i.I(),h=!1,l=0;l<a;l++){var c=t.h.construct(o.eg(2*l),o.eg(2*l+1));if(1&s&&c.y>=n){h=!0;break}if(2&s&&c.y<=-n){h=!0;break}}if(!h)return!1;o=!1,e&&(o=i.Nn(0)),a=(e=new t.gd).Ib(i),h=e.Ob(a);var u=-1,d=!0,f=new t.h;f.Rc(),l=new t.Sa;for(var p=-1,g=e.Xa(h);-1!=g;g=e.U(g)){c=e.Na(g);var v=1&s&&90<=c.y?1:0;if(v|=2&s&&c.y<=-n?2:0,0<u&&u!=v){if(f.x!=c.x){f.x=c.x,e.Vi(e.Ma(g),l);var m=e.wj(h,g,l);e.mf(m,f)}if(o)for(p=-1!=p?e.U(p):e.Xa(h),m=e.Ma(g);p!=m;)p=e.pd(p,!1);p=-1}0<v&&(c.y=t.lc.Cn(r,c.y),e.mf(g,c),d||u==v||(c.x!=f.x?(e.Vi(g,l),m=e.wj(h,g,l),e.Cb(m,f.x,c.y),p=m):p=g)),u=v,f=c,d=!1}if(o){if(-1!=p)for(p=e.U(p);-1!=p;)p=e.pd(p,!1);n=e.Xa(h),e.fq(n,e.rj(h))||(e.Vi(n,l),e.wj(h,-1,l))}return e.Ne(a).copyTo(i),!0},i.Mz=function(n,r,s,o){var a=n;if(a.B()||s==e.DontClip)return a;var h=a.getType();if(33==h)return a=[(o=a).D()],i.yG(a,1,r,s),a[0].isNaN()?o.Oa():o.Cb(a[0]),n;var l=(n=r.sc()).bf(),c=90*l,u=180*l,d=360*l,f=r.zi(),p=.5*l,g=new t.l;a.A(g);var v=r.Vr(),m=r.PQ(),y=197==v.getType();if(r=new t.l,v.A(r),s==e.PannableFold&&(s=n.Oe().R(),r.v=f-.5*s,r.C=r.v+s),g.G<-c||g.H>c){if((new t.l).K(g.v-l,-c,g.C+l,c),(a=t.ri.Nu(a,r,n,NaN,0,o)).B())return a;a.A(g)}if(m&&(r.H<g.G||r.G>g.H))return a.Ia();if(g.R()>d&&(a=i.Hp(a,f-u,d,n,!0,0,!0,o)).A(g),0!=(c=i.eO(g.v,g.C,r.v,r.C,d))&&g.move(c,0),g.C>r.C||g.v<r.v){if(g.C>r.C)for(;g.v>=r.C;)g.move(-d,0),c-=d;for(;g.v<r.C-d;)g.move(d,0),c+=d}if(s=t.ta.Hu(n,v),0!=c&&((l=new t.Dd).gg(c,0),a.Oc(l)),m){if(y&&r.contains(g))return a;for(m=[null,null],c=0;2>c;c++){if(y?l=t.aa.Hc(h)?t.ri.clip(a,r,s,p,o):t.ri.clip(a,r,s,0,o):(l=t.Xj.local().V(a,v,n,o))==v&&(l=t.aa.jg(l)),r.v<=g.v&&r.C>=g.C||r.v>=g.v&&r.C<=g.C)return l;m[c]=l,0==c&&(g.move(-d,0),(l=new t.Dd).gg(-d,0),a.Oc(l))}if(550==h)m[0].Fd(m[1],0,-1);else if(t.aa.Hc(h))m[0].add(m[1],!1);else{if(33!=h)throw t.i.fa("intersect_with_GCS_horizon: unexpected geometry type");m[0].B()&&(m[0]=m[1])}return m[0]}if(r.H<g.G||r.G>g.H)return a;for(h=0;!a.B()&&g.C>r.v;)0!=h&&((l=new t.Dd).gg(h,0),a.Oc(l)),t.dj.local().V(4,a,v,n,o)||v==(a=t.kp.local().V(a,v,n,o))&&(a=t.aa.jg(a)),0!=h&&((p=new t.Dd).gg(-h,0),a.Oc(p)),h-=d,g.move(-d,0);return a},i.yG=function(n,r,s,o){if(0!=r&&o!=e.DontClip)if(o==e.PannableFold){o=s.HR();for(var a=r,h=0;h<r;h++)(n[h].y>o.H||n[h].y<o.G)&&(n[h].Rc(),a--);0!=a&&i.av(n,r,o.v,o.R())}else{var l=90*(o=s.bf()),c=180*o;for(o*=360,a=r,h=0;h<r;h++)(n[h].y>l||n[h].y<-l)&&(n[h].Rc(),a--);if(0!=a){(a=new t.l).Zw(n,r),l=s.Vr();var u=s.hv();h=197==l.getType();var d=new t.l;if(l.A(d),!u||!(d.H<a.G||d.G>a.H))if(u)if(i.av(n,r,d.gk()-c,o),a=r,h)for(h=0;h<r;h++)d.contains(n[h])||(n[h].Rc(),a--);else for(s=t.ta.Hu(s.sc(),l),h=0;h<r;h++)(c=0!=t.hd.Yd(l,n[h],s))||(n[h].Rc(),a--);else for(i.av(n,r,-c,o),a=r,s=t.ta.Hu(s.sc(),l),h=0;h<r;h++)(c=n[h]).isNaN()&&a--,u=i.tE(c.x,d.v,d.C,o),c.x+=u,(c=0!=t.hd.Yd(l,c,s))&&(n[h].Rc(),a--)}}},i.Hp=function(e,i,n,r,s,o,a,h){var l=e.getType(),c=i+n;if(33===l){var u=(r=s?e:e.Of()).Lg();return(u<i||u>=c||a&&u==c)&&(u+=Math.ceil((i-u)/n)*n,u=t.O.Rk(u,i,c),r.cC(u)),r}if(e.B())return e;if(u=new t.l,e.A(u),u.B())return e;var d=new t.Nc;u.cn(d);var f=new t.Nc;if(f.K(i,c),f.contains(d))return e;if((c=new t.l).K(u),550===l){for(h=(r=s?e:e.Of()).ub(0),l=2*r.I(),c=!1,i=0;i<l;i+=2)((u=h.read(i))<f.oa||u>=f.va||a&&u==f.va)&&(c=!0,u+=Math.ceil((f.oa-u)/n)*n,u=f.It(u),h.write(i,u));return c&&r.Pc(1993),r}if(197==l)return n=s?e:e.Of(),u.Ea(c),n.Xo(u),n;var p=.1*Math.max(u.ca(),u.R());for(c.W(0,p),a=e,f=r.Xd(0),e=t.Gh.local(),s=new t.Dd;;){var g=Math.floor((d.oa-i)/n),v=Math.ceil((d.va-i)/n);if(!(3<v-g))break;g=Math.floor(.5*(v+g)),c.v=u.v-p,c.C=i+n*g;var m=t.ri.clip(a,c,f,o,h);c.v=c.C,c.C=u.C+p;var y=t.ri.clip(a,c,f,o,h);s.gg((g-v)*n,0),y.Oc(s),1736==l?a=e.V(m,y,r,null):(a=m).add(y,!1),a.A(u),u.cn(d)}for(c.v=i,c.C=i+n,(i=new t.l).K(c),i.W(f,0),0!=(i=Math.floor((u.v-c.v)/n)*n)?(c.move(i,0),s.gg(-i,0)):s.RB(),i=1607==l?new t.Ta(a.description):new t.Da(a.description),o=new t.l,d=new t.l;u.C>c.v;)(p=t.ri.clip(a,c,f,0,h)).A(d),(1607==l?!p.B()&&(d.R()>f||d.ca()>f):!p.B()&&(1736!=l||d.R()>f))&&(p.Oc(s),p.A(d),i.A(o),o.W(f,f),o.isIntersecting(d)&&1736==l?i=e.V(i,p,r,null):i.add(p,!1)),c.move(n,0),s.shift(-n,0);return i},i.av=function(e,i,n,r){for(var s=n+r,o=0;o<i;o++){var a=e[o].x;n<=a&&a<s||!(a<n||a>s||a==s)||(a+=Math.ceil((n-a)/r)*r,a=t.O.Rk(a,n,s),e[o].x=a)}},i.Fn=function(e,n,r,s,o,a){if(!n.Wc())throw t.i.fa("fold_into_360_degree_range");if(e.B())return e;if(2==n.Sb()){r=n.pv();var h=n.ov()-r}else{var l=n.bf();h=360*l,r-=180*l}return i.Hp(e,r,h,n,s,o,!0,a)},i.qF=function(t,e,n,r){if(2==n.Sb())r=n.pv(),n=n.ov()-r;else{var s=n.bf();n=360*s,r-=180*s}i.av(t,e,r,n)},i.lj=function(e,i){var n=i.Oe();if(33==e.getType()){var r=e.ih();return n.G<=r&&r<=n.H?e:e.Ia()}r=new t.l,e.A(r);var s=new t.l;return s.K(n),s.v=r.v,s.C=r.C,s.W(.01*s.ca(),0),n=t.ta.uy(i,r),s.contains(r)?e:t.ri.clip(e,s,n,0,null)},i.ir=function(t,e,i){return t>e.C&&t-e.C<i?e.C:t<e.v&&e.v-t<i?e.v:t},i.FX=function(t,e,n,r){r.x=i.ir(t.x,e,n),r.y=t.y},i.EX=function(t,e,n,r){for(var s=0;s<e;s++)t[s].y<n.G||t[s].y>n.H?t[s].Rc():t[s].x=i.ir(t[s].x,n,r)},i.Jt=function(e,n,r,s){if(!e.B()){var o=e.getType();if(!s||1736!=o)if(t.aa.xj(o)){s=e.ub(0),o=0;for(var a=e.I();o<a;o++){var h=s.read(2*o),l=i.ir(h,n,r);l!=h&&s.write(2*o,l)}e.Pc(1993)}else if(197==o)s=new t.l,e.A(s),s.v=i.ir(s.v,n,r),s.C=i.ir(s.C,n,r),e.Xo(s);else{if(33!=o)throw t.i.fa("internal error");e.cC(i.ir(e.Lg(),n,r))}}},i.uS=function(e,n,r,s){var o=new t.gd,a=o.Ib(e);return e=t.ta.Hu(n,e),i.ks(o,a,n,e,r,!0,s),o.Ne(a)},i.ks=function(e,r,s,o,a,h,l){if(!s.Wc())throw t.i.N("invalid call");var c=s.Oe(),u=s.sc(),d=u.eh().getDatum().getSpheroid();u=u.Hd().ai;var f=d.getFlattening();d=d.getAxis(),f*=2-f;var p=new t.Nc;c.cn(p);var g=null,v=[[0,0],[0,0]];if(2==s.Sb()?(g=s.eh(),h?(v[0][0]=i.Zm(l,p),v[0][1]=c.Jp(),t.ej.projToGeog(g,1,v),c=v[0][0]*u):(v[0][0]=c.gk(),v[0][1]=l,t.ej.projToGeog(g,1,v),c=v[0][1]*u)):c=l*u,!h&&0!=c&&a!=n.GreatElliptic)throw t.i.fa("invalid argument");var m=new t.ga,y=[0],_=new t.h,b=new t.h,w=new t.h,x=[null,null],T=new t.h,A=new t.h,M=new t.h,S=new t.h;for(r=e.Ob(r);-1!=r;r=e.Rb(r)){var E=e.Xa(r);e.D(E,T);for(var C=!1,O=E=e.U(E);-1!=O;O=e.U(O)){if(O==E){if(C)break;C=!0}if(e.D(O,A),h&&(o<l-T.x&&A.x-l>o||o<l-A.x&&T.x-l>o)||!h&&(0!=l||o<-T.y&&A.y>o||o<-A.y&&T.y>o))do{if(!(Math.abs(T.x-A.x)>=.5*p.R())){if(2==s.Sb()?(v[0][0]=i.Zm(T.x,p),v[0][1]=T.y,v[1][0]=i.Zm(A.x,p),v[1][1]=A.y,t.ej.projToGeogCenter(g,2,v,0),M.x=v[0][0]*u,M.y=v[0][1]*u,S.y=v[1][1]*u):(M.x=T.x*u,M.y=T.y*u,S.y=A.y*u),S.x=2*(A.x-T.x)*Math.PI/p.R()+M.x,h){if(b.x=c,b.y=i.Nz(d,f,M,S,c,a),isNaN(b.y))break;x[0]=b;var R=1}else if(a==n.GreatElliptic){var I=[0,0];if(0==(R=t.Ox.Oz(f,M,S,c,I)))break;b.x=I[0],b.y=c,x[0]=b,2==R&&(w.x=I[1],w.y=c,x[1]=w)}else{if(b.x=i.Lz(d,f,M,S,a),isNaN(b.x))break;b.y=0,x[0]=b,R=1}var P=-1;for(I=0;I<R;I++){t.kb.wd(d,f,M.x,M.y,S.x,S.y,m,null,null,a);var N=m.u;t.kb.wd(d,f,M.x,M.y,x[I].x,x[I].y,m,null,null,a);var D=m.u;if(2==s.Sb()?(v[0][0]=x[I].x/u,v[0][1]=x[I].y/u,t.ej.geogToProj(g,1,v),h?(_.y=v[0][1],_.x=l):(_.x=i.os(v[0][0],T.x,A.x,p),_.y=l)):h?(_.x=l,_.y=x[I].y/u):(_.x=i.os(x[I].x/u,T.x,A.x,p),_.y=l),y[0]=0<N?t.O.Rk(D/N,0,1):.5,0==y[0]||1==y[0])break;P>y[0]||(P=e.Ma(O),e.Ul(P,y,1),e.Cb(e.U(P),_.x,_.y),P=y[0])}}}while(0);T.L(A)}}},i.Zm=function(t,e){var i=e.va-e.oa;return e.It(t-Math.floor((t-e.oa)/i)*i)},i.os=function(e,i,n,r){var s=new t.Nc;for(s.K(i,n),n=r.R(),e=Math.floor((e-i)/n)*n+e,s=s.sf();Math.abs(e-s)>Math.abs(e+n-s);)e+=n;return e},i.Sn=function(e,i,n){return e=t.qr.Cp(e),i=t.qr.mx(e,t.qr.Cp(i)),0==(n=t.qr.mx(e,t.qr.Cp(n)))||0<i&&0<n&&n<=i||0>i&&0>n&&n>=i},i.Nz=function(e,r,s,o,a,h){if(h==n.GreatElliptic)return t.Ox.SS(r,s,o,a);if(Math.abs(s.x-o.x)>=Math.PI||!i.Sn(s.x,o.x,a))return NaN;if(s.x>o.x)var l=o;else l=s,s=o;o=new t.ga;var c=new t.ga,u=new t.ga;t.kb.wd(e,r,l.x,l.y,s.x,s.y,c,o,null,h);var d=c.u,f=0,p=1,g=new t.h;for(g.L(l);d*(p-f)>1e-12*e;){var v=.5*(f+p);if(t.kb.oj(e,r,l.x,l.y,d*v,o.u,c,u,h),g.x=c.u,g.y=u.u,g.x==a)break;if(i.Sn(l.x,g.x,a))p=v;else{if(!i.Sn(s.x,g.x,a))return NaN;f=v}}return g.y},i.Lz=function(e,i,r,s,o){if(o==n.GreatElliptic)return e=[0,0],t.Ox.Oz(i,r,s,0,e),e[0];if(r.y>s.y)var a=s;else a=r,r=s;if((s=new t.Nc).K(a.y,r.y),!s.contains(0)||Math.abs(a.x-r.x)>=Math.PI)return NaN;if(a.x==r.x)return a.x;var h=new t.ga,l=new t.ga,c=new t.ga;t.kb.wd(e,i,a.x,a.y,r.x,r.y,l,h,null,o);var u=l.u,d=0,f=1,p=new t.h;for(p.L(a);u*(f-d)>1e-12*e;){var g=.5*(d+f);if(t.kb.oj(e,i,a.x,a.y,u*g,h.u,l,c,o),p.x=l.u,p.y=c.u,s.K(a.y,p.y),0==p.y)break;if(s.contains(0))f=g;else{if(s.K(r.y,p.y),!s.contains(0))return NaN;d=g}}return p.x},i.WI=function(e,i,n,r){if(!e.ef.Wc())return!1;var s=new t.de(i.description);if(s.Fd(i,0,-1),r=t.Hx.local().V(s,e,r),s=i.I(),n.Oa(),s!=r.I())return!1;var o=new t.l;i.A(o);var a=new t.l;if(r.A(a),o=o.R(),a=a.R(),0!=o&&0!=a){if(a/=o,e=e.Yf.gh().R()/e.ef.gh().R(),1e-10<Math.abs(a/e-1))return!1}else if(0!=o||0!=a)return!1;for(n.add(i,!1),i=new t.h,e=0;e<s;e++)r.D(e,i),n.Cb(e,i);return!0},i.qN=function(t,e){return(t%=360*e)>=180*e&&(t-=360*e),t},i.UI=function(n,r,s,o){if(s==e.Clip){var a=r.ml();197==a.getType()?(s=new t.l,a.A(s),a=t.ta.uy(r,s),n=t.ri.clip(n,s,a,5e4*r.pm(),o)):t.dj.local().V(1,a,n,r,o)||(n=t.Xj.local().V(n,a,r,o))==a&&(n=t.Vk.jg(n))}else r.Wc()&&(o=new t.l,n.xc(o),r.Oe().contains(o)||(i.Jt(n,r.Oe(),r.Xd(0),!0),s==e.PannableFold&&(n=i.lj(n,r)),n=i.Fn(n,r,0,!0,1e5*r.pm(),null)));return n},i.XD=function(e,i,n){var r=i.Wr();if(null==r)return e;var s=(i=i.sc()).Oe().R(),o=new t.l;e.xc(o);var a=new t.Nc;o.cn(a),o=r.Ga(),r=null;for(var h=new t.Dd;o.$a();)for(;o.Ha();){var l=o.ha(),c=l.Tg(0,0),u=new t.Nc;for(u.K(c.oa,c.va),c=0;u.va>a.oa;)u.move(-s),--c;for(;u.oa<=a.va;){if(u.isIntersecting(a)){null==r&&(r=new t.Ta);var d=t.yb.cP(l.ac(),l.wc());0!=c&&(h.gg(c*s,0),d.Oc(h)),r.oc(d,!0)}u.move(s),++c}}return null!=r?(i=t.ta.gO(i,r),i=t.ta.Er(i),t.$t.lP(e,r,i,n)):e},i.eO=function(t,e,n,r,s){return t>=n&&e<=r?0:i.tE(.5*(e+t),n,r,s)},i.tE=function(e,i,n,r){return t.lc.round((.5*(n+i)-e)/r)*r},i.VQ=function(e,n,r,s,o,a,h,l){var c=i.dv(s,o),u=c.R(),d=u/360,f=i.pE*d,p=e.ub(0),g=n.Wc(),v=g?u/n.Oe().R():0;n=e.Ia();for(var m=0,y=r.da();m<y;++m){var _=g,b=new t.Ta(r.description);b.addPath(r,m,!0);var w=r.dc(m);0!=h&&(w=i.PD(w,b,c.H-l,c.H,h))&&(_=!1);var x=-1;w=b.I();var T=!1;_&&(x=e.Ba(m),T=e.dc(m));var A=b.ub(0),M=0,S=A.read(0),E=0,C=3*s.Xd(0),O=!1,R=new t.h;R.Rc();var I=new t.h;I.Rc();for(var P=!1,N=1;N<w;++N){var D=t.h.construct(A.eg(2*N),A.eg(2*N+1)),L=D.x,z=L+M,j=z-S;if(D.x=z,Math.abs(j)>f){if(_){var k=x+N-1,F=x;(!T||N+1<w)&&(F+=N),k=p.read(2*k),F=(p.read(2*F)-k)*v,Math.abs(j-F)>1*d&&(g=!1)}_||(z=L+(M-=t.lc.Cn(u,z-S)),++E,P=0!=M,D.x=z)}else O||t.ta.AG(R,I,D,C)&&(O=!0);P&&A.write(2*N,z),S=z,R.L(I),I.L(D)}0!=E&&b.Pc(1993),_=b.Na(0),w=b.Na(w-1),t.h.tb(_,w),b=i.wQ(b,s,isNaN(o)?0:o,a),n.add(b,!1)}return e=s.Xd(0),r=c.R()/180,i.Jt(n,c,.1*e,!1),t.ri.clip(n,c,e,r,a)},i.wQ=function(t,e,n,r){return i.Fn(t,e,n,!0,0,r)},i.OS=function(e,i,n,r){var s=e.getType();if(1736==s)for(i=null!=i?i.Xd(0):0,s=0;s<r;s++)1!=t.hd.Yd(e,n[s],i)&&n[s].Rc();else{if(197!=s)throw t.i.N();for(s=0;s<r;s++)e.dP(n[s])||n[s].Rc()}},i.$k=function(e,i,n,r){if(32>n)for(var s=new t.Sa,o=0;o<n;o++)s.Cb(i[o]),e.$k(s,r).D(i[o]);else{var a=new t.de;for(a.re(3),a.HD(i,n),s=a.ub(3),o=0;o<n;o++)s.write(o,o);for(o=e.$k(a,r),e=o.ub(0),s=o.ub(3),r=t.h.construct(NaN,NaN),a=0;a<n;a++)i[a]=r;for(n=o.I(),o=0;o<n;o++)r=s.read(o),e.tc(2*o,i[r])}},i.Zk=function(e,i,n,r){if(32>n)for(var s=new t.Sa,o=0;o<n;o++)s.Cb(i[o]),e.Zk(s,r).D(i[o]);else{var a=new t.de;for(a.re(3),a.HD(i,n),s=a.ub(3),o=0;o<n;o++)s.write(o,o);for(o=e.Zk(a,r),e=o.ub(0),s=o.ub(3),r=t.h.construct(NaN,NaN),a=0;a<n;a++)i[a]=r;for(n=o.I(),o=0;o<n;o++)r=s.read(o),e.tc(2*o,i[r])}},i.pE=210,i}()}(X||(X={})),function(t){var e;(e=t.UL||(t.UL={}))[e.rightSide=1]="rightSide";var i=function(){function e(e,i,n){this.Bs=new t.h,void 0===e?this.Io=-1:(this.Bs.L(e),this.Io=i,this.Ka=n,this.nw=0)}return e.prototype.WJ=function(t){this.nw=t?1|this.nw:-2&this.nw},e.prototype.B=function(){return 0>this.Io},e.prototype.fz=function(){if(this.B())throw t.i.fa("invalid call");return new t.Sa(this.Bs.x,this.Bs.y)},e.prototype.Ua=function(){if(this.B())throw t.i.fa("invalid call");return this.Io},e.prototype.hz=function(){if(this.B())throw t.i.fa("invalid call");return this.Ka},e.prototype.Sz=function(){return!!(1&this.nw)},e.prototype.ey=function(t,e,i,n){this.Bs.x=t,this.Bs.y=e,this.Io=i,this.Ka=n},e}();t.$l=i}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.Uo=function(e,i){if(this.th.resize(0),this.Ii.length=0,this.tk=-1,e.xc(this.Ek),this.Ek.W(i,i),this.Ek.isIntersecting(this.Fb.Ca)){var n=e.getType();(this.vs=t.aa.yd(n))?(this.TH=e.ac(),this.SH=e.wc(),this.qa=i):this.qa=NaN,this.th.add(this.Fb.kf),this.Ii.push(this.Fb.Ca),this.Qs=this.Fb.Ur(this.Fb.kf)}else this.Qs=-1},e.prototype.Xi=function(t,e){this.th.resize(0),this.Ii.length=0,this.tk=-1,this.Ek.K(t),this.Ek.W(e,e),this.qa=NaN,this.Ek.isIntersecting(this.Fb.Ca)?(this.th.add(this.Fb.kf),this.Ii.push(this.Fb.Ca),this.Qs=this.Fb.Ur(this.Fb.kf),this.vs=!1):this.Qs=-1},e.prototype.next=function(){if(0==this.th.size)return-1;this.tk=this.Qs;var e=null,n=null,r=null,s=null;this.vs&&(e=new t.h,n=new t.h,r=new t.l);for(var o=!1;!o;){for(;-1!=this.tk;){var a=this.Fb.bz(this.Fb.fv(this.tk));if(a.isIntersecting(this.Ek)){if(!this.vs){o=!0;break}if(e.L(this.TH),n.L(this.SH),r.K(a),r.W(this.qa,this.qa),0<r.zy(e,n)){o=!0;break}}this.tk=this.Fb.nv(this.tk)}if(-1==this.tk){a=this.th.Fc();var h=this.Ii[this.Ii.length-1];for(null==s&&((s=[])[0]=new t.l,s[1]=new t.l,s[2]=new t.l,s[3]=new t.l),i.EJ(h,s),this.th.If(),--this.Ii.length,h=0;4>h;h++){var l=this.Fb.Lp(a,h);if(-1!=l&&0<this.Fb.WR(l)&&s[h].isIntersecting(this.Ek))if(this.vs){if(e.L(this.TH),n.L(this.SH),r.K(s[h]),r.W(this.qa,this.qa),0<r.zy(e,n)){var c=new t.l;c.K(s[h]),this.th.add(l),this.Ii.push(c)}}else(c=new t.l).K(s[h]),this.th.add(l),this.Ii.push(c)}if(0==this.th.size)return-1;this.tk=this.Fb.Ur(this.th.get(this.th.size-1))}}return this.Qs=this.Fb.nv(this.tk),this.tk},e.bP=function(i,n,r){var s=new e;return s.Fb=i,s.Ek=new t.l,s.th=new t.ia(0),s.Ii=[],s.Uo(n,r),s},e.aP=function(i,n,r){var s=new e;return s.Fb=i,s.Ek=new t.l,s.th=new t.ia(0),s.Ii=[],s.Xi(n,r),s},e.$O=function(i){var n=new e;return n.Fb=i,n.Ek=new t.l,n.th=new t.ia(0),n.Ii=[],n},e}();t.GY=e;var i=function(){function i(e,i){this.jf=new t.$c(11),this.Zh=new t.$c(5),this.ws=[],this.gw=new t.ia(0),this.Ca=new t.l,this.Nk(e,i)}return i.prototype.reset=function(t,e){this.jf.mj(!1),this.Zh.mj(!1),this.ws.length=0,this.gw.clear(!1),this.Nk(t,e)},i.prototype.vj=function(t,e){return this.zv(t,e,0,this.Ca,this.kf,!1,-1)},i.prototype.Jz=function(t,e,i){i=-1==i?this.kf:this.WF(i);var n=this.ca(i),r=this.oR(i);return this.zv(t,e,n,r,i,!1,-1)},i.prototype.ja=function(t){return this.jR(t)},i.prototype.GF=function(t){return this.bz(this.fv(t))},i.prototype.ca=function(t){return this.jv(t)},i.prototype.oR=function(e){var i=new t.l;i.K(this.Ca);var n=this.jv(e);e=this.QF(e);for(var r=0;r<2*n;r+=2){var s=t.O.truncate(3&e>>r);0==s?(i.v=.5*(i.v+i.C),i.G=.5*(i.G+i.H)):1==s?(i.C=.5*(i.v+i.C),i.G=.5*(i.G+i.H)):(2==s?i.C=.5*(i.v+i.C):i.v=.5*(i.v+i.C),i.H=.5*(i.G+i.H))}return i},i.prototype.WR=function(t){return this.Az(t)},i.prototype.vR=function(t,i){return e.bP(this,t,i)},i.prototype.MF=function(t,i){return e.aP(this,t,i)},i.prototype.getIterator=function(){return e.$O(this)},i.prototype.Nk=function(e,i){if(0>i||32<2*i)throw t.i.N("invalid height");this.BT=i,this.Ca.K(e),this.kf=this.jf.Ce(),this.jx(this.kf,0),this.ax(this.kf,0),this.NJ(this.kf,0),this.KJ(this.kf,0)},i.prototype.zv=function(e,n,r,s,o,a,h){if(!s.contains(n))return 0==r?-1:this.zv(e,n,0,this.Ca,this.kf,a,h);if(!a)for(var l=o;-1!=l;l=this.IR(l))this.jx(l,this.Az(l)+1);(l=new t.l).K(s),s=o;var c=[];for(c[0]=new t.l,c[1]=new t.l,c[2]=new t.l,c[3]=new t.l;r<this.BT&&this.iO(s);r++){i.EJ(l,c);for(var u=!1,d=0;4>d;d++)if(c[d].contains(n)){u=!0;var f=this.Lp(s,d);-1==f&&(f=this.rP(s,d)),this.jx(f,this.Az(f)+1),s=f,l.K(c[d]);break}if(!u)break}return this.sS(e,n,r,l,s,a,o,h)},i.prototype.sS=function(t,e,i,n,r,s,o,a){var h=this.NF(r);if(s){if(r==o)return a;this.SP(a),s=a}else s=this.tP(),this.NB(s,t),this.KW(this.fv(s),e);return this.mX(s,r),-1!=h?(this.hx(s,h),this.bx(h,s)):this.GJ(r,s),this.SB(r,s),this.ax(r,this.lv(r)+1),this.hO(r)&&this.MQ(i,n,r),s},i.prototype.SP=function(t){var e=this.WF(t),i=this.NF(e),n=this.OR(t),r=this.nv(t);this.Ur(e)==t?(-1!=r?this.hx(r,-1):this.SB(e,-1),this.GJ(e,r)):i==t?(this.bx(n,-1),this.SB(e,n)):(this.hx(r,n),this.bx(n,r)),this.hx(t,-1),this.bx(t,-1),this.ax(e,this.lv(e)-1)},i.EJ=function(t,e){var i=.5*(t.v+t.C),n=.5*(t.G+t.H);e[0].K(i,n,t.C,t.H),e[1].K(t.v,n,i,t.H),e[2].K(t.v,t.G,i,n),e[3].K(i,t.G,t.C,n)},i.prototype.hO=function(t){return 8==this.lv(t)&&!this.gG(t)},i.prototype.MQ=function(t,e,i){var n=this.Ur(i);do{var r=this.fv(n),s=this.Zh.T(n,0);r=this.bz(r),this.zv(s,r,t,e,i,!0,n),n=s=this.nv(n)}while(-1!=n)},i.prototype.iO=function(t){return 8<=this.lv(t)||this.gG(t)},i.prototype.gG=function(t){return-1!=this.Lp(t,0)||-1!=this.Lp(t,1)||-1!=this.Lp(t,2)||-1!=this.Lp(t,3)},i.prototype.rP=function(t,e){var i=this.jf.Ce();return this.OW(t,e,i),this.jx(i,0),this.ax(i,0),this.Pk(i,t),this.KJ(i,this.jv(t)+1),this.NJ(i,e<<2*this.jv(t)|this.QF(t)),i},i.prototype.tP=function(){var e=this.Zh.Ce();if(0<this.gw.size){var i=this.gw.Fc();this.gw.If()}else i=this.ws.length,this.ws.push(new t.l);return this.LW(e,i),e},i.prototype.Lp=function(t,e){return this.jf.T(t,e)},i.prototype.OW=function(t,e,i){this.jf.S(t,e,i)},i.prototype.Ur=function(t){return this.jf.T(t,4)},i.prototype.GJ=function(t,e){this.jf.S(t,4,e)},i.prototype.NF=function(t){return this.jf.T(t,5)},i.prototype.SB=function(t,e){this.jf.S(t,5,e)},i.prototype.QF=function(t){return this.jf.T(t,6)},i.prototype.NJ=function(t,e){this.jf.S(t,6,e)},i.prototype.lv=function(t){return this.jf.T(t,7)},i.prototype.Az=function(t){return this.jf.T(t,8)},i.prototype.ax=function(t,e){this.jf.S(t,7,e)},i.prototype.jx=function(t,e){this.jf.S(t,8,e)},i.prototype.IR=function(t){return this.jf.T(t,9)},i.prototype.Pk=function(t,e){this.jf.S(t,9,e)},i.prototype.jv=function(t){return this.jf.T(t,10)},i.prototype.KJ=function(t,e){this.jf.S(t,10,e)},i.prototype.jR=function(t){return this.Zh.T(t,0)},i.prototype.NB=function(t,e){this.Zh.S(t,0,e)},i.prototype.OR=function(t){return this.Zh.T(t,1)},i.prototype.nv=function(t){return this.Zh.T(t,2)},i.prototype.hx=function(t,e){this.Zh.S(t,1,e)},i.prototype.bx=function(t,e){this.Zh.S(t,2,e)},i.prototype.WF=function(t){return this.Zh.T(t,3)},i.prototype.mX=function(t,e){this.Zh.S(t,3,e)},i.prototype.fv=function(t){return this.Zh.T(t,4)},i.prototype.LW=function(t,e){this.Zh.S(t,4,e)},i.prototype.bz=function(t){return this.ws[t]},i.prototype.KW=function(t,e){this.ws[t].K(e)},i}();t.du=i}(X||(X={})),function(t){var e;(e=t.aL||(t.aL={}))[e.Outside=0]="Outside",e[e.Inside=1]="Inside",e[e.Border=2]="Border";var i=function(){function t(t,e){this.PT=e,this.Vh=t}return t.prototype.setColor=function(t,e){this.iH!=e&&t.flush(),this.iH=e},t.prototype.gF=function(t,e){for(var i=0;i<e;)for(var n=t[i++],r=t[i++],s=t[i++]*this.PT;n<r;n++)this.Vh[s+(n>>4)]|=this.iH<<2*(15&n)},t}();t.HY=i;var n=function(){function e(t,e,i){this.Vh=null,this.SA=this.Ik=this.cI=this.aI=this.Es=this.qH=this.Gf=this.Um=0,this.Ri=this.Jk=this.vl=null,this.Fz(t,e,i)}return e.create=function(i,n,r){if(!e.zE(i))throw t.i.N();return e.wP(i,n,r)},e.pW=function(e){switch(e){case 0:e=1024;break;case 1:e=16384;break;case 2:e=262144;break;default:throw t.i.fa("Internal Error")}return e},e.zE=function(t){return!(t.B()||1607!=t.getType()&&1736!=t.getType())},e.prototype.rQ=function(e,i){i=i.Ga();for(var n=new t.h,r=new t.h;i.$a();)for(;i.Ha();){var s=i.ha();if(322!=s.getType())throw t.i.fa("Internal Error");e.Eh(s.ac(),n),e.Eh(s.wc(),r),this.Ri.jy(n.x,n.y,r.x,r.y)}this.Ri.iJ(t.Px.Cx)},e.prototype.sQ=function(){throw t.i.fa("Internal Error")},e.prototype.Ry=function(e,i){for(var n=1;4>n;n++)e.jy(i[n-1].x,i[n-1].y,i[n].x,i[n].y);e.jy(i[3].x,i[3].y,i[0].x,i[0].y),this.Ri.iJ(t.Px.Cx)},e.prototype.rK=function(e,i,n){for(var r=[null,null,null,null],s=0;s<r.length;s++)r[s]=new t.h;i=i.Ga(),n=this.Jk.dY(n)+1.5,s=new t.h;for(var o=new t.h,a=new t.h,h=new t.h,l=new t.h,c=new t.l,u=new t.h;i.$a();){var d=!1,f=!0;for(u.ma(0,0);i.Ha();){var p=i.ha();if(h.x=p.sa,h.y=p.na,l.x=p.pa,l.y=p.la,c.Oa(),c.Zb(h.x,h.y),c.Lk(l.x,l.y),this.vl.HG(c)){this.Jk.Eh(l,l),f?(this.Jk.Eh(h,h),u.L(h),f=!1):h.L(u),s.uc(l,h);var g=.5>(p=s.length());0==p?s.ma(1,0):(g||u.L(l),s.scale(n/p),o.ma(-s.y,s.x),a.ma(s.y,-s.x),h.sub(s),l.add(s),r[0].add(h,o),r[1].add(h,a),r[2].add(l,a),r[3].add(l,o),g?d=!0:this.Ry(e,r))}else d&&(this.Ry(e,r),d=!1),f=!0}d&&this.Ry(e,r)}},e.prototype.sC=function(e){return t.O.truncate(e*this.qH+this.aI)},e.prototype.tC=function(e){return t.O.truncate(e*this.Es+this.cI)},e.wP=function(t,i,n){return new e(t,i,n)},e.prototype.Fz=function(e,n,r){this.Gf=Math.max(t.O.truncate(2*Math.sqrt(r)+.5),64),this.Um=t.O.truncate((2*this.Gf+31)/32),this.vl=new t.l,this.Ik=n,r=0;for(var s=this.Gf,o=this.Um;8<=s;)r+=s*o,s=t.O.truncate(s/2),o=t.O.truncate((2*s+31)/32);this.Vh=t.O.lg(r,0),this.Ri=new t.Px,r=new i(this.Vh,this.Um,this),this.Ri.AX(this.Gf,this.Gf,r),e.A(this.vl),this.vl.W(n,n),s=new t.l;var a=n*(o=t.l.construct(1,1,this.Gf-2,this.Gf-2)).R();switch(n*=o.ca(),s.K(this.vl.sf(),Math.max(a,this.vl.R()),Math.max(n,this.vl.ca())),this.SA=this.Ik,this.Jk=new t.Dd,this.Jk.pS(s,o),new t.Dd,e.getType()){case 550:r.setColor(this.Ri,2),this.sQ();break;case 1607:r.setColor(this.Ri,2),this.rK(this.Ri,e,this.SA);break;case 1736:r.setColor(this.Ri,1),this.rQ(this.Jk,e),r.setColor(this.Ri,2),this.rK(this.Ri,e,this.SA)}this.qH=this.Jk.bb,this.Es=this.Jk.ab,this.aI=this.Jk.Gb,this.cI=this.Jk.Lb,this.XN()},e.prototype.XN=function(){this.Ri.flush();for(var e=0,i=this.Gf*this.Um,n=this.Gf,r=t.O.truncate(this.Gf/2),s=this.Um,o=t.O.truncate((2*r+31)/32);8<n;){for(n=0;n<r;n++)for(var a=2*n,h=2*n+1,l=0;l<r;l++){var c=2*l,u=2*l+1,d=c>>4;c=2*(15&c);var f=u>>4;u=2*(15&u);var p=this.Vh[e+s*a+d]>>c&3;p|=this.Vh[e+s*a+f]>>u&3,p|=this.Vh[e+s*h+d]>>c&3,p|=this.Vh[e+s*h+f]>>u&3,this.Vh[i+o*n+(l>>4)]|=p<<2*(15&l)}n=r,s=o,e=i,r=t.O.truncate(n/2),o=t.O.truncate((2*r+31)/32),i=e+s*n}},e.prototype.So=function(t,e){return this.vl.contains(t,e)?(t=this.sC(t),e=this.tC(e),0>t||t>=this.Gf||0>e||e>=this.Gf||0==(e=this.Vh[this.Um*e+(t>>4)]>>2*(15&t)&3)?0:1==e?1:2):0},e.prototype.Ro=function(e){if(!e.Ea(this.vl))return 0;var i=this.sC(e.v),n=this.sC(e.C),r=this.tC(e.G);if(e=this.tC(e.H),0>i&&(i=0),0>r&&(r=0),n>=this.Gf&&(n=this.Gf-1),e>=this.Gf&&(e=this.Gf-1),i>n||r>e)return 0;for(var s=Math.max(n-i,1)*Math.max(e-r,1),o=0,a=this.Um,h=this.Gf,l=0;;){if(32>s||16>h){for(s=r;s<=e;s++)for(var c=i;c<=n;c++)if(1<(l=this.Vh[o+a*s+(c>>4)]>>2*(15&c)&3))return 2;if(0==l)return 0;if(1==l)return 1}o+=a*h,h=t.O.truncate(h/2),a=t.O.truncate((2*h+31)/32),i=t.O.truncate(i/2),r=t.O.truncate(r/2),n=t.O.truncate(n/2),e=t.O.truncate(e/2),s=Math.max(n-i,1)*Math.max(e-r,1)}},e.prototype.RR=function(){return this.Gf*this.Um},e}();t.Nx=n}(X||(X={})),function(t){var e;(e=t.VL||(t.VL={}))[e.contains=1]="contains",e[e.within=2]="within",e[e.equals=3]="equals",e[e.disjoint=4]="disjoint",e[e.touches=8]="touches",e[e.crosses=16]="crosses",e[e.overlaps=32]="overlaps",e[e.unknown=0]="unknown",e[e.intersects=1073741824]="intersects";var i=function(){function t(){}return t.construct=function(e,i,n,r,s,o,a,h){var l=new t;return l.pw=e,l.Mm=i,l.Kj=n,l.Si=r,l.BH=s,l.SY=o,l.TY=a,l.UY=h,l},t}();t.Vt=function(){function e(){}return e.CD=function(i,n,r){if(e.wy(i)){var s=t.ta.kj(n,i,!1);n=!1,t.Uk.CE(i)&&(n=n||i.lu(s,r)),1736!=(s=i.getType())&&1607!=s||!t.Uk.AE(i)||0==r||(n=n||i.fj(r)),1736!=s&&1607!=s||!t.Uk.BE(i)||0==r||n||i.hM()}},e.wy=function(e){return t.Uk.CE(e)||t.Uk.AE(e)||t.Uk.BE(e)},e}();var n=function(){function e(){this.rh=[]}return e.zB=function(i,n,r,s,o){var a=i.getType(),h=n.getType();if(197==a){if(197==h)return e.tW(i,n,r,s);if(33==h)return 2==s?s=1:1==s&&(s=2),e.hJ(n,i,r,s)}else if(33==a){if(197==h)return e.hJ(i,n,r,s);if(33==h)return e.vW(i,n,r,s)}if(i.B()||n.B())return 4==s;var l=new t.l;i.A(l);var c=new t.l;n.A(c);var u=new t.l;if(u.K(l),u.Zb(c),r=t.ta.Wd(r,u,!1),e.dk(l,c,r))return 4==s;switch(l=!1,t.Vk.yd(a)&&((a=new t.Ta(i.description)).oc(i,!0),i=a,a=1607),t.Vk.yd(h)&&((h=new t.Ta(n.description)).oc(n,!0),n=h,h=1607),197!=a&&197!=h?(i.Db()<n.Db()||33==a&&550==h)&&(2==s?s=1:1==s&&(s=2)):1736!=a&&197!=h&&(2==s?s=1:1==s&&(s=2)),a){case 1736:switch(h){case 1736:l=e.rt(i,n,r,s,o);break;case 1607:l=e.$m(i,n,r,s,o);break;case 33:l=e.qt(i,n,r,s);break;case 550:l=e.pt(i,n,r,s,o);break;case 197:l=e.GI(i,n,r,s,o)}break;case 1607:switch(h){case 1736:l=e.$m(n,i,r,s,o);break;case 1607:l=e.gB(i,n,r,s,o);break;case 33:l=e.tt(i,n,r,s,o);break;case 550:l=e.st(i,n,r,s,o);break;case 197:l=e.MI(i,n,r,s)}break;case 33:switch(h){case 1736:l=e.qt(n,i,r,s);break;case 1607:l=e.tt(n,i,r,s,o);break;case 550:l=e.lt(n,i,r,s)}break;case 550:switch(h){case 1736:l=e.pt(n,i,r,s,o);break;case 1607:l=e.st(n,i,r,s,o);break;case 550:l=e.ZA(i,n,r,s,o);break;case 33:l=e.lt(i,n,r,s);break;case 197:l=e.hI(i,n,r,s)}break;case 197:switch(h){case 1736:l=e.GI(n,i,r,s,o);break;case 1607:l=e.MI(n,i,r,s);break;case 550:l=e.hI(n,i,r,s)}}return l},e.tW=function(i,n,r,s){if(i.B()||n.B())return 4==s;var o=new t.l,a=new t.l,h=new t.l;switch(i.A(o),n.A(a),h.K(o),h.Zb(a),i=t.ta.Wd(r,h,!1),s){case 4:return e.dk(o,a,i);case 2:return e.jF(a,o,i);case 1:return e.jF(o,a,i);case 3:return e.ek(o,a,i);case 8:return e.cQ(o,a,i);case 32:return e.bQ(o,a,i);case 16:return e.aQ(o,a,i)}return!1},e.hJ=function(i,n,r,s){if(i.B()||n.B())return 4==s;i=i.D();var o=new t.l,a=new t.l;switch(n.A(o),a.K(i),a.Zb(o),n=t.ta.Wd(r,a,!1),s){case 4:return e.Rw(i,o,n);case 2:return e.eB(i,o,n);case 1:return e.RU(i,o,n);case 3:return e.vI(i,o,n);case 8:return e.dB(i,o,n)}return!1},e.vW=function(i,n,r,s){if(i.B()||n.B())return 4==s;i=i.D(),n=n.D();var o=new t.l;switch(o.K(i),o.Zb(n),r=t.ta.Wd(r,o,!1),s){case 4:return e.SU(i,n,r);case 2:return e.uI(n,i,r);case 1:return e.uI(i,n,r);case 3:return e.wI(i,n,r)}return!1},e.rt=function(t,i,n,r,s){switch(r){case 4:return e.kV(t,i,n);case 2:return e.Sw(i,t,n,s);case 1:return e.Sw(t,i,n,s);case 3:return e.nV(t,i,n);case 8:return e.vV(t,i,n);case 32:return e.qV(t,i,n,s)}return!1},e.$m=function(t,i,n,r,s){switch(r){case 4:return e.lV(t,i,n);case 1:return e.fB(t,i,n,s);case 8:return e.wV(t,i,n,s);case 16:return e.gV(t,i,n)}return!1},e.qt=function(t,i,n,r){switch(r){case 4:return e.jV(t,i,n);case 1:return e.dV(t,i,n);case 8:return e.uV(t,i,n)}return!1},e.pt=function(t,i,n,r){switch(r){case 4:return e.iV(t,i,n);case 1:return e.cV(t,i,n);case 8:return e.tV(t,i,n);case 16:return e.fV(t,i,n)}return!1},e.GI=function(t,i,n,r,s){if(e.hV(t,i,n))return 4==r;if(4==r)return!1;switch(r){case 2:return e.xV(t,i,n);case 1:return e.bV(t,i,n);case 3:return e.mV(t,i,n);case 8:return e.sV(t,i,n,s);case 32:return e.pV(t,i,n,s);case 16:return e.eV(t,i,n,s)}return!1},e.gB=function(t,i,n,r){switch(r){case 4:return e.GV(t,i,n);case 2:return e.KI(i,t,n);case 1:return e.KI(t,i,n);case 3:return e.IV(t,i,n);case 8:return e.NI(t,i,n);case 32:return e.MV(t,i,n);case 16:return e.LI(t,i,n)}return!1},e.tt=function(t,i,n,r){switch(r){case 4:return e.FV(t,i,n);case 1:return e.AV(t,i,n);case 8:return e.QV(t,i,n)}return!1},e.st=function(t,i,n,r){switch(r){case 4:return e.EV(t,i,n);case 1:return e.zV(t,i,n);case 8:return e.PV(t,i,n);case 16:return e.CV(t,i,n)}return!1},e.MI=function(t,i,n,r){if(e.DV(t,i,n))return 4==r;if(4==r)return!1;switch(r){case 2:return e.RV(t,i,n);case 1:return e.yV(t,i,n);case 3:return e.HV(t,i,n);case 8:return e.OV(t,i,n);case 32:return e.LV(t,i,n);case 16:return e.BV(t,i,n)}return!1},e.ZA=function(t,i,n,r){switch(r){case 4:return e.gU(t,i,n);case 2:return e.eI(i,t,n);case 1:return e.eI(t,i,n);case 3:return e.iU(t,i,n);case 32:return e.oU(t,i,n)}return!1},e.lt=function(t,i,n,r){switch(r){case 4:return e.fI(t,i,n);case 2:return e.sU(t,i,n);case 1:return e.dU(t,i,n);case 3:return e.Nw(t,i,n)}return!1},e.hI=function(t,i,n,r){switch(r){case 4:return e.fU(t,i,n);case 2:return e.rU(t,i,n);case 1:return e.cU(t,i,n);case 3:return e.hU(t,i,n);case 8:return e.qU(t,i,n);case 16:return e.eU(t,i,n)}return!1},e.nV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!!e.ek(s,o,r)&&4!=(s=e.qc(i,n,!1))&&1!=s&&2!=s&&(!!e.dI(i,n,r)||(s=i.Qb(),o=n.Qb(),!(Math.abs(s-o)>4*Math.max(i.I(),n.I())*r)&&e.Wz(i,n,r,!0)))},e.kV=function(t,i,n){var r=e.qc(t,i,!0);return 4==r||1!=r&&2!=r&&1073741824!=r&&e.EI(t,i,n)},e.vV=function(t,i,n){var r=e.qc(t,i,!1);return 4!=r&&1!=r&&2!=r&&e.II(t,i,n,null)},e.qV=function(t,i,n,r){var s=e.qc(t,i,!1);return 4!=s&&1!=s&&2!=s&&e.FI(t,i,n,r)},e.Sw=function(i,n,r,s){var o=new t.l,a=new t.l;return i.A(o),n.A(a),!!e.zc(o,a,r)&&4!=(o=e.qc(i,n,!1))&&2!=o&&(1==o||e.BI(i,n,r,s))},e.lV=function(t,i,n){var r=e.qc(t,i,!0);return 4==r||1!=r&&1073741824!=r&&e.EI(t,i,n)},e.wV=function(t,i,n,r){var s=e.qc(t,i,!1);return 4!=s&&1!=s&&e.JI(t,i,n,r)},e.gV=function(t,i,n){var r=e.qc(t,i,!1);return 4!=r&&1!=r&&e.DI(t,i,n,null)},e.fB=function(i,n,r,s){var o=new t.l,a=new t.l;return i.A(o),n.A(a),!!e.zc(o,a,r)&&4!=(o=e.qc(i,n,!1))&&(1==o||e.CI(i,n,r,s))},e.jV=function(e,i,n){return 0==t.hd.KG(e,i,n)},e.uV=function(t,i,n){return i=i.D(),e.HI(t,i,n)},e.dV=function(t,i,n){return i=i.D(),e.AI(t,i,n)},e.iV=function(i,n,r){var s=e.qc(i,n,!1);if(4==s)return!0;if(1==s)return!1;s=new t.l,i.A(s),s.W(r,r);for(var o=new t.h,a=0;a<n.I();a++)if(n.D(a,o),s.contains(o)){var h=t.hd.Yd(i,o,r);if(1==h||2==h)return!1}return!0},e.tV=function(e,i,n){var r=this.qc(e,i,!1);if(4==r||1==r)return!1;r=new t.l,e.A(r),r.W(n,n);for(var s=!1,o=e,a=!1,h=0;h<i.I();h++){var l=i.Na(h);if(r.contains(l))if(2==(l=t.hd.Yd(o,l,n)))s=!0;else if(1==l)return!1;a||(!t.Dg.Ml(e,i.I()-1)||null!=e.Bb&&null!=e.Bb.Fb?o=e:(o=new t.Da,e.copyTo(o),o.fj(1)),a=!0)}return!!s},e.fV=function(e,i,n){var r=this.qc(e,i,!1);if(4==r||1==r)return!1;var s=new t.l;r=new t.l;var o=new t.l;e.A(s),i.A(o),r.K(s),r.W(n,n),o=s=!1;for(var a=e,h=!1,l=0;l<i.I();l++){var c=i.Na(l);if(r.contains(c)?0==(c=t.hd.Yd(a,c,n))?o=!0:1==c&&(s=!0):o=!0,s&&o)return!0;h||(!t.Dg.Ml(e,i.I()-1)||null!=e.Bb&&null!=e.Bb.Fb?a=e:(a=new t.Da,e.copyTo(a),a.fj(1)),h=!0)}return!1},e.cV=function(e,i,n){var r=new t.l,s=new t.l;if(e.A(r),i.A(s),!this.zc(r,s,n))return!1;if(4==(s=this.qc(e,i,!1)))return!1;if(1==s)return!0;s=!1;for(var o=e,a=!1,h=0;h<i.I();h++){var l=i.Na(h);if(!r.contains(l))return!1;if(1==(l=t.hd.Yd(o,l,n)))s=!0;else if(0==l)return!1;a||(!t.Dg.Ml(e,i.I()-1)||null!=e.Bb&&null!=e.Bb.Fb?o=e:(o=new t.Da,e.copyTo(o),o.fj(1)),a=!0)}return s},e.mV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!!e.ek(s,o,r)&&((s=new t.Da).ad(n,!1),e.Wz(i,s,r,!0))},e.hV=function(i,n,r){var s=e.qc(i,n,!1);if(4==s)return!0;if(1==s||2==s)return!1;var o=new t.l;if(s=new t.l,i.A(o),n.A(s),e.zc(s,o,r))return!1;if(o=new t.h,s.dn(o),0!=(n=t.hd.Yd(i,o,r)))return!1;if(s.$I(o),0!=(n=t.hd.Yd(i,o,r)))return!1;if(s.en(o),0!=(n=t.hd.Yd(i,o,r)))return!1;if(s.cJ(o),0!=(n=t.hd.Yd(i,o,r)))return!1;n=i.ub(0),(o=new t.l).K(s),o.W(r,r);for(var a=0,h=i.I();a<h;a++){var l=n.read(2*a),c=n.read(2*a+1);if(o.contains(l,c))return!1}return!e.TG(i,s,r)},e.sV=function(i,n,r,s){var o=e.qc(i,n,!1);if(4==o||1==o||2==o)return!1;o=new t.l;var a=new t.l;return i.A(o),n.A(a),!e.zc(a,o,r)&&(a.R()<=r&&a.ca()<=r?(n=n.Ip(),e.HI(i,n,r)):a.R()<=r||a.ca()<=r?(o=new t.Ta,a=new t.Sa,n.Hf(0,a),o.nf(a),n.Hf(2,a),o.lineTo(a),e.JI(i,o,r,s)):((o=new t.Da).ad(n,!1),e.II(i,o,r,s)))},e.pV=function(i,n,r,s){var o=e.qc(i,n,!1);if(4==o||1==o||2==o)return!1;o=new t.l;var a=new t.l;return i.A(o),n.A(a),!(e.zc(a,o,r)||a.R()<=r||a.ca()<=r)&&((o=new t.Da).ad(n,!1),e.FI(i,o,r,s))},e.xV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),e.zc(o,s,r)},e.bV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!!e.zc(s,o,r)&&4!=(s=e.qc(i,n,!1))&&2!=s&&(1==s||(o.R()<=r&&o.ca()<=r?(n=n.Ip(),e.AI(i,n,r)):o.R()<=r||o.ca()<=r?(o=new t.Ta,s=new t.Sa,n.Hf(0,s),o.nf(s),n.Hf(2,s),o.lineTo(s),e.CI(i,o,r,null)):((o=new t.Da).ad(n,!1),e.BI(i,o,r,null))))},e.eV=function(i,n,r,s){var o=new t.l,a=new t.l;return i.A(o),n.A(a),!(e.zc(a,o,r)||a.ca()>r&&a.R()>r||a.ca()<=r&&a.R()<=r)&&(o=new t.Ta,a=new t.Sa,n.Hf(0,a),o.nf(a),n.Hf(2,a),o.lineTo(a),e.DI(i,o,r,s))},e.IV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(!e.ek(s,o,r)||4==e.qc(i,n,!1))&&(!!e.dI(i,n,r)||e.Wz(i,n,r,!1))},e.GV=function(e,i,n){return 4==this.qc(e,i,!1)||!!new t.Zl(e,i,n,!0).next()&&!this.UG(e,i,n)},e.NI=function(i,n,r){if(4==e.qc(i,n,!1))return!1;var s=new t.be(0);if(0!=e.Xz(i,n,r,s))return!1;for(var o=new t.de,a=0;a<s.size;a+=2){var h=s.read(a),l=s.read(a+1);o.Bu(h,l)}return i=i.mg(),n=n.mg(),i.Fd(n,0,n.I()),e.Mw(i,o,r)},e.LI=function(i,n,r){if(4==e.qc(i,n,!1))return!1;var s=new t.be(0);if(0!=e.Xz(i,n,r,s))return!1;for(var o=new t.de,a=0;a<s.size;a+=2){var h=s.read(a),l=s.read(a+1);o.Bu(h,l)}return i=i.mg(),n=n.mg(),i.Fd(n,0,n.I()),!e.Mw(i,o,r)},e.MV=function(t,i,n){return 4!=e.qc(t,i,!1)&&e.WG(t,i,n)},e.KI=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(!e.zc(s,o,r)||4==e.qc(i,n,!1))&&e.ym(n,i,r,!1)},e.FV=function(t,i,n){return 4==e.qc(t,i,!1)||(i=i.D(),!e.Yz(t,i,n))},e.QV=function(t,i,n){return 4!=e.qc(t,i,!1)&&(i=i.D(),e.Zz(t,i,n))},e.AV=function(t,i,n){return 4!=e.qc(t,i,!1)&&(i=i.D(),e.SG(t,i,n))},e.EV=function(t,i,n){return 4==e.qc(t,i,!1)||!e.VG(t,i,n,!1)},e.PV=function(e,i,n){if(4==this.qc(e,i,!1))return!1;var r=e.Ga(),s=new t.l,o=new t.l,a=new t.l;e.A(s),i.A(o),s.W(n,n),o.W(n,n),a.K(s),a.Ea(o),s=null;var h=e.Bb;if(null!=h){var l=h.Fb;s=h.zo,null==l&&(l=h=t.ta.jj(e,a))}else l=h=t.ta.jj(e,a);var c=l.getIterator(),u=null;null!=s&&(u=s.getIterator());var d=new t.h,f=new t.h,p=!1,g=n*n;for(s=new t.pn(i.I()),h=0;h<i.I();h++)s.write(h,0);for(h=0;h<i.I();h++)if(i.D(h,d),a.contains(d)){if(o.K(d.x,d.y,d.x,d.y),null!=u&&(u.Xi(o,n),-1==u.next()))continue;c.Xi(o,n);for(var v=c.next();-1!=v;v=c.next())if(r.Vb(l.ja(v)),(v=r.ha()).hc(v.fe(d,!1),f),t.h.yc(d,f)<=g){s.write(h,1),p=!0;break}}if(!p)return!1;for(e=e.mg(),r=new t.de,o=new t.h,h=0;h<i.I();h++)0!=s.read(h)&&(i.D(h,o),r.Bu(o.x,o.y));return this.Mw(e,r,n)},e.CV=function(e,i,n){if(4==this.qc(e,i,!1))return!1;var r=e.Ga(),s=new t.l,o=new t.l,a=new t.l;e.A(s),i.A(o),s.W(n,n),o.W(n,n),a.K(s),a.Ea(o),s=null;var h=e.Bb;if(null!=h){var l=h.Fb;s=h.zo,null==l&&(l=h=t.ta.jj(e,a))}else l=h=t.ta.jj(e,a);var c=l.getIterator(),u=null;null!=s&&(u=s.getIterator());var d=new t.h,f=new t.h,p=!1,g=!1,v=n*n;for(s=new t.pn(i.I()),h=0;h<i.I();h++)s.write(h,0);for(h=0;h<i.I();h++)if(i.D(h,d),a.contains(d)){if(o.K(d.x,d.y,d.x,d.y),null!=u&&(u.Xi(o,n),-1==u.next())){g=!0;continue}c.Xi(o,n);for(var m=!1,y=c.next();-1!=y;y=c.next())if(r.Vb(l.ja(y)),(y=r.ha()).hc(y.fe(d,!1),f),t.h.yc(d,f)<=v){s.write(h,1),m=p=!0;break}m||(g=!0)}else g=!0;if(!p||!g)return!1;for(e=e.mg(),r=new t.de,o=new t.h,h=0;h<i.I();h++)0!=s.read(h)&&(i.D(h,o),r.Bu(o.x,o.y));return!this.Mw(e,r,n)},e.zV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(!e.zc(s,o,r)||4==e.qc(i,n,!1)||!e.VG(i,n,r,!0)||(i=i.mg(),e.gI(i,n,r)))},e.HV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(o.ca()>r&&o.R()>r)&&e.ek(s,o,r)},e.DV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!e.zc(o,s,r)&&!e.TG(i,o,r)},e.OV=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),o.ca()<=r&&o.R()<=r)return o=n.Ip(),e.Zz(i,o,r);if(o.ca()<=r||o.R()<=r)return o=new t.Ta,s=new t.Sa,n.Hf(0,s),o.nf(s),n.Hf(2,s),o.lineTo(s),e.NI(i,o,r);i=i.Ga(),n=new t.l,s=new t.l,n.K(o),s.K(o),n.W(-r,-r),s.W(r,r),o=!1;for(var a=new t.l,h=new t.l;i.$a();)for(;i.Ha();){if(i.ha().A(a),h.K(n),h.Ea(a),!h.B()&&(h.ca()>r||h.R()>r))return!1;h.K(s),h.Ea(a),h.B()||(o=!0)}return o},e.LV=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(e.zc(s,o,r)||e.zc(o,s,r)||e.zc(o,s,r)||o.ca()>r&&o.R()>r||o.ca()<=r&&o.R()<=r)&&(s=new t.Ta,o=new t.Sa,n.Hf(0,o),s.nf(o),n.Hf(2,o),s.lineTo(o),e.WG(i,s,r))},e.RV=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),!e.zc(o,s,r)||o.ca()<=r&&o.R()<=r)return!1;if(o.ca()<=r||o.R()<=r)return e.zc(o,s,r);i=i.Ga(),(n=new t.l).K(o),n.W(-r,-r),o=!1,s=new t.l;for(var a=new t.l;i.$a();)for(;i.Ha();)i.ha().A(s),n.hm(s)?o=!0:(a.K(n),a.Ea(s),!a.B()&&(a.ca()>r||a.R()>r)&&(o=!0));return o},e.yV=function(i,n,r){var s=new t.l,o=new t.l;return n.A(o),i.A(s),!(!e.zc(s,o,r)||o.ca()>r&&o.R()>r)&&(o.ca()<=r&&o.R()<=r?(n=n.Ip(),e.SG(i,n,r)):(s=new t.Ta,o=new t.Sa,n.Hf(0,o),s.nf(o),n.Hf(2,o),s.lineTo(o),e.ym(s,i,r,!1)))},e.BV=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),e.zc(o,s,r)||o.ca()<=r&&o.R()<=r)return!1;if(o.ca()<=r||o.R()<=r)return s=new t.Ta,o=new t.Sa,n.Hf(0,o),s.nf(o),n.Hf(2,o),s.lineTo(o),e.LI(i,s,r);i=i.Ga(),n=new t.l,(s=new t.l).K(o),n.K(o),s.W(-r,-r),n.W(r,r);for(var a=o=!1,h=new t.l,l=new t.l;i.$a();)for(;i.Ha();)if(i.ha().A(h),a||n.contains(h)||(a=!0),o||(l.K(s),l.Ea(h),!l.B()&&(l.ca()>r||l.R()>r)&&(o=!0)),o&&a)return!0;return!1},e.iU=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!!e.ek(s,o,r)&&(!!e.jU(i,n,r)||e.YA(i,n,r,!1,!0,!1))},e.gU=function(t,i,n){return!e.gI(t,i,n)},e.oU=function(t,i,n){return e.YA(t,i,n,!1,!1,!0)},e.eI=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!!e.zc(s,o,r)&&e.YA(n,i,r,!0,!1,!1)},e.Mw=function(e,i,n){n*=n;for(var r=new t.h,s=new t.h,o=0;o<i.I();o++){i.D(o,s);for(var a=!1,h=0;h<e.I();h++)if(e.D(h,r),t.h.yc(r,s)<=n){a=!0;break}if(!a)return!1}return!0},e.Nw=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),e.ek(s,o,r)},e.fI=function(t,i,n){return i=i.D(),e.kt(t,i,n)},e.sU=function(t,i,n){return e.Nw(t,i,n)},e.dU=function(t,i,n){return!e.fI(t,i,n)},e.hU=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(o.ca()>r||o.R()>r)&&e.ek(s,o,r)},e.fU=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),e.zc(o,s,r))return!1;for((n=new t.l).K(o),n.W(r,r),r=new t.h,o=0;o<i.I();o++)if(i.D(o,r),n.contains(r))return!1;return!0},e.qU=function(e,i,n){var r=new t.l,s=new t.l,o=new t.l;if(i.A(r),r.ca()<=n&&r.R()<=n)return!1;if(r.ca()<=n||r.R()<=n){i=new t.h;var a=!1;s.K(r),o.K(r),s.W(n,n),r.ca()>n?o.W(0,-n):o.W(-n,0);for(var h=0;h<e.I();h++)if(e.D(h,i),s.contains(i)){if(r.ca()>n){if(i.y>o.G&&i.y<o.H)return!1}else if(i.x>o.v&&i.x<o.C)return!1;a=!0}return a}for(s.K(r),o.K(r),s.W(n,n),o.W(-n,-n),i=new t.h,a=!1,h=0;h<e.I();h++)if(e.D(h,i),s.contains(i)){if(o.hm(i))return!1;a=!0}return a},e.rU=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),!e.zc(o,s,r))return!1;if(o.ca()<=r&&o.R()<=r)return e.ek(s,o,r);if(o.ca()<=r||o.R()<=r){n=!1,s=new t.l;var a=new t.l;s.K(o),a.K(o),o.ca()>r?s.W(0,-r):s.W(-r,0),a.W(r,r);for(var h=new t.h,l=0;l<i.I();l++){if(i.D(l,h),!a.contains(h))return!1;o.ca()>r?h.y>s.G&&h.y<s.H&&(n=!0):h.x>s.v&&h.x<s.C&&(n=!0)}return n}for(n=!1,s=new t.l,a=new t.l,s.K(o),a.K(o),s.W(-r,-r),a.W(r,r),h=new t.h,l=0;l<i.I();l++){if(i.D(l,h),!a.contains(h))return!1;s.hm(h)&&(n=!0)}return n},e.cU=function(i,n,r){var s=new t.l,o=new t.l;return i.A(s),n.A(o),!(!e.zc(s,o,r)||o.ca()>r||o.R()>r||(n=n.Ip(),e.kt(i,n,r)))},e.eU=function(i,n,r){var s=new t.l,o=new t.l;if(i.A(s),n.A(o),e.zc(o,s,r)||o.ca()<=r&&o.R()<=r)return!1;if(o.ca()<=r||o.R()<=r){n=new t.l,s=new t.l,n.K(o),o.ca()>r?n.W(0,-r):n.W(-r,0),s.K(o),s.W(r,r);for(var a=new t.h,h=!1,l=!1,c=0;c<i.I();c++)if(i.D(c,a),h||(o.ca()>r?a.y>n.G&&a.y<n.H&&(h=!0):a.x>n.v&&a.x<n.C&&(h=!0)),l||s.contains(a)||(l=!0),h&&l)return!0;return!1}for(n=new t.l,s=new t.l,n.K(o),n.W(-r,-r),s.K(o),s.W(r,r),a=new t.h,l=h=!1,c=0;c<i.I();c++)if(i.D(c,a),!h&&n.hm(a)&&(h=!0),l||s.contains(a)||(l=!0),h&&l)return!0;return!1},e.wI=function(e,i,n){return t.h.yc(e,i)<=n*n},e.SU=function(e,i,n){return t.h.yc(e,i)>n*n},e.uI=function(t,i,n){return e.wI(t,i,n)},e.vI=function(i,n,r){var s=new t.l;return s.K(i),e.ek(s,n,r)},e.Rw=function(e,i,n){var r=new t.l;return r.K(i),r.W(n,n),!r.contains(e)},e.dB=function(e,i,n){if(i.ca()<=n&&i.R()<=n)return!1;var r=new t.l,s=new t.l;if(r.K(i),r.W(n,n),!r.contains(e))return!1;if(i.ca()<=n||i.R()<=n){if(s.K(i),i.ca()>n?s.W(0,-n):s.W(-n,0),i.ca()>n){if(e.y>s.G&&e.y<s.H)return!1}else if(e.x>s.v&&e.x<s.C)return!1;return!0}return s.K(i),s.W(-n,-n),!s.hm(e)},e.eB=function(e,i,n){if(i.ca()<=n&&i.R()<=n)return!0;if(i.ca()<=n||i.R()<=n){var r=new t.l;r.K(i),i.ca()>n?r.W(0,-n):r.W(-n,0);var s=!1;return i.ca()>n?e.y>r.G&&e.y<r.H&&(s=!0):e.x>r.v&&e.x<r.C&&(s=!0),s}return(r=new t.l).K(i),r.W(-n,-n),r.hm(e)},e.RU=function(t,i,n){return e.vI(t,i,n)},e.ek=function(t,i,n){return e.zc(t,i,n)&&e.zc(i,t,n)},e.dk=function(e,i,n){var r=new t.l;return r.K(i),r.W(n,n),!e.isIntersecting(r)},e.cQ=function(i,n,r){if(i.ca()<=r&&i.R()<=r){var s=i.sf();return e.dB(s,n,r)}if(n.ca()<=r&&n.R()<=r)return s=n.sf(),e.dB(s,i,r);if(i.ca()>r&&i.R()>r&&(n.ca()<=r||n.R()<=r)?s=n:(s=i,i=n),s.ca()<=r||s.R()<=r){if(i.ca()<=r||i.R()<=r){n=new t.yb;var o=new t.yb,a=[0,0],h=[0,0],l=new t.h;return s.dn(l),n.Dc(l),s.en(l),n.Qc(l),i.dn(l),o.Dc(l),i.en(l),o.Qc(l),n.Ea(o,null,a,h,r),1==n.Ea(o,null,null,null,r)&&(0==a[0]||1==a[1]||0==h[0]||1==h[1])}return n=new t.l,o=new t.l,n.K(i),n.W(-r,-r),o.K(n),o.Ea(s),!(!o.B()&&(o.ca()>r||o.R()>r))}return i.W(r,r),(o=new t.l).K(s),o.Ea(i),!(o.B()||!o.B()&&o.ca()>r&&o.R()>r)},e.bQ=function(i,n,r){if(e.zc(i,n,r)||e.zc(n,i,r)||i.ca()<=r&&i.R()<=r||n.ca()<=r&&n.R()<=r)return!1;if(i.ca()<=r||i.R()<=r){if(n.ca()>r&&n.R()>r)return!1;var s=new t.yb,o=new t.yb,a=[0,0],h=[0,0],l=new t.h;return i.dn(l),s.Dc(l),i.en(l),s.Qc(l),n.dn(l),o.Dc(l),n.en(l),o.Qc(l),s.Ea(o,null,a,h,r),2==s.Ea(o,null,null,null,r)&&(0<a[0]||1>a[1])&&(0<h[0]||1>h[1])}return!(n.ca()<=r||n.R()<=r||((s=new t.l).K(i),s.Ea(n),s.B()||s.ca()<=r||s.R()<=r))},e.jF=function(i,n,r){if(!e.zc(i,n,r))return!1;if(i.ca()<=r&&i.R()<=r)return i=i.sf(),e.eB(i,n,r);if(n.ca()<=r&&n.R()<=r)return n=n.sf(),e.eB(n,i,r);if(i.ca()<=r||i.R()<=r)return e.zc(i,n,r);if(n.ca()<=r||n.R()<=r){var s=new t.l;return s.K(i),s.W(-r,-r),!(!s.hm(n)&&((i=new t.l).K(s),i.Ea(n),i.B()||i.ca()<=r&&i.R()<=r))}return e.zc(i,n,r)},e.aQ=function(i,n,r){if(e.zc(i,n,r)||e.zc(n,i,r)||i.ca()<=r&&i.R()<=r||n.ca()<=r&&n.R()<=r||n.ca()>r&&n.R()>r&&i.ca()>r&&i.R()>r)return!1;if(i.ca()>r&&i.R()>r)var s=n;else s=i,i=n;if(i.ca()>r&&i.R()>r){n=new t.l;var o=new t.l;return o.K(i),o.W(-r,-r),n.K(o),n.Ea(s),!(n.B()||n.ca()<=r&&n.R()<=r)}n=new t.yb,o=new t.yb;var a=[0,0],h=[0,0],l=new t.h;return s.dn(l),n.Dc(l),s.en(l),n.Qc(l),i.dn(l),o.Dc(l),i.en(l),o.Qc(l),n.Ea(o,null,a,h,r),1==n.Ea(o,null,null,null,r)&&0<a[0]&&1>a[1]&&0<h[0]&&1>h[1]},e.EI=function(e,i,n){var r=new t.l,s=new t.l,o=new t.Zl(e,i,n,!0);if(!o.next())return!0;if(this.UG(e,i,n))return!1;var a=e,h=null;1736==i.getType()&&(h=i);var l=!1,c=!1;do{var u=o.nl(),d=o.hl();if(d=i.Na(i.Ba(d)),r.K(o.uz()),r.W(n,n),r.contains(d)&&0!=(d=t.hd.Yd(a,d,0))||1736==i.getType()&&(u=e.Na(e.Ba(u)),s.K(o.az()),s.W(n,n),s.contains(u)&&0!=(d=t.hd.Yd(h,u,0))))return!1;l||(!t.Dg.Ml(e,i.da()-1)||null!=e.Bb&&null!=e.Bb.Fb?a=e:(a=new t.Da,e.copyTo(a),a.fj(1)),l=!0),1736!=i.getType()||c||(c=i,!t.Dg.Ml(c,e.da()-1)||null!=i.Bb&&null!=i.Bb.Fb?h=i:(h=new t.Da,c.copyTo(h),h.fj(1)),c=!0)}while(o.next());return!0},e.zc=function(e,i,n){var r=new t.l;return r.K(e),r.W(n,n),r.contains(i)},e.ls=function(e,i,n){var r=new t.l;return r.K(i),r.W(n,n),i=new t.h,e.dn(i),!(r.contains(i)&&(e.$I(i),r.contains(i)&&(e.cJ(i),r.contains(i)&&(e.en(i),r.contains(i)))))},e.dI=function(e,i,n){if(e.da()!=i.da()||e.I()!=i.I())return!1;var r=new t.h,s=new t.h,o=!0;n*=n;for(var a=0;a<e.da();a++){if(e.Vc(a)!=i.Vc(a)){o=!1;break}for(var h=e.Ba(a);h<i.Vc(a);h++)if(e.D(h,r),i.D(h,s),t.h.yc(r,s)>n){o=!1;break}if(!o)break}return!!o},e.jU=function(e,i,n){if(e.I()!=i.I())return!1;var r=new t.h,s=new t.h,o=!0;n*=n;for(var a=0;a<e.I();a++)if(e.D(a,r),i.D(a,s),t.h.yc(r,s)>n){o=!1;break}return!!o},e.YA=function(e,i,n,r,s,o){var a=!1;if(e.I()>i.I()){r&&(r=!1,a=!0);var h=i}else h=e,e=i;if(i=null,s||o||a){i=new t.pn(e.I());for(var l=0;l<e.I();l++)i.write(l,0)}l=new t.l;var c=new t.l,u=new t.l;h.A(l),e.A(c),l.W(n,n),c.W(n,n),u.K(l),u.Ea(c),c=new t.h;for(var d=new t.h,f=!0,p=t.ta.oE(e,u),g=p.getIterator(),v=n*n,m=0;m<h.I();m++)if(h.D(m,c),u.contains(c)){var y=!1;l.K(c.x,c.y,c.x,c.y),g.Xi(l,n);for(var _=g.next();-1!=_&&(_=p.ja(_),e.D(_,d),!(t.h.yc(c,d)<=v&&((s||o||a)&&i.write(_,1),y=!0,r)));_=g.next());if(!y&&(f=!1,s||r))return!1}else{if(s||r)return!1;f=!1}if(o&&f)return!1;if(r)return!0;for(l=0;l<e.I();l++)if(1==i.read(l)){if(o)return!0}else if(s||a)return!1;return!o},e.gI=function(e,i,n){if(e.I()>i.I())var r=i;else r=e,e=i;i=new t.l;var s=new t.l,o=new t.l;r.A(i),e.A(s),i.W(n,n),s.W(n,n),o.K(i),o.Ea(s),s=new t.h;for(var a=new t.h,h=n*n,l=t.ta.oE(e,o),c=l.getIterator(),u=0;u<r.I();u++)if(r.D(u,s),o.contains(s)){i.K(s.x,s.y,s.x,s.y),c.Xi(i,n);for(var d=c.next();-1!=d;d=c.next())if(e.D(l.ja(d),a),t.h.yc(s,a)<=h)return!0}return!1},e.Wz=function(t,i,n,r){return e.ym(t,i,n,r)&&e.ym(i,t,n,r)},e.ym=function(n,r,s,o){function a(t,e){return f.QE(t,e)}var h,l=[0,0],c=[0,0],u=0,d=new t.ia(0),f=new e,p=new t.l,g=new t.l,v=new t.l;n.A(p),r.A(g),p.W(s,s),g.W(s,s),v.K(p),v.Ea(g),n=n.Ga(),g=r.Ga();var m=null,y=m=null,_=r.Bb;for(null!=_?(m=_.Fb,y=_.zo,null==m&&(m=t.ta.jj(r,v))):m=t.ta.jj(r,v),r=m.getIterator(),_=null,null!=y&&(_=y.getIterator());n.$a();)for(;n.Ha();){var b=!1,w=n.ha();if(w.A(p),!p.isIntersecting(v))return!1;if(null!=_&&(_.Xi(p,s),-1==_.next()))return!1;for(y=w.Qb(),r.Uo(w,s),h=r.next();-1!=h;h=r.next()){g.Vb(m.ja(h)),h=g.ha();var x=w.Ea(h,null,l,c,s);if(2==x&&(!o||c[0]<=c[1])){var T=l[1],A=c[0],M=c[1];if((x=l[0])*y<=s&&(1-T)*y<=s){b=!0,u=0,d.resize(0),f.rh.length=0;var S=n.wb();for(A=!0;A;){if(n.Ha()){if(y=(w=n.ha()).Qb(),2==(x=w.Ea(h,null,l,c,s))&&(!o||c[0]<=c[1])&&(T=l[1],(x=l[0])*y<=s&&(1-T)*y<=s)){S=n.wb();continue}if(g.Ha()&&(h=g.ha(),2==(x=w.Ea(h,null,l,c,s))&&(!o||c[0]<=c[1])&&(T=l[1],(x=l[0])*y<=s&&(1-T)*y<=s))){S=n.wb();continue}}A=!1}S!=n.wb()&&(n.Vb(S),n.ha());break}S=n.wb(),h=i.construct(S,n.gb,x,T,g.wb(),g.gb,A,M),f.rh.push(h),d.add(d.size)}}if(!b){if(u==f.rh.length)return!1;for(1<d.size-u&&d.Vd(u,d.size,a),b=0;u<f.rh.length;u++)if(!((h=f.rh[d.get(u)]).Kj<b&&h.Si<b)){if(y*(h.Kj-b)>s)return!1;if(y*(1-(b=h.Si))<=s||1==b)break}if(y*(1-b)>s)return!1;u=0,d.resize(0),f.rh.length=0}}return!0},e.WG=function(i,n,r){if(1>e.Xz(i,n,r,null))return!1;var s=new t.l,o=new t.l;i.A(s),n.A(o);var a=e.ls(s,o,r);return s=e.ls(o,s,r),!((!a||!s)&&(a&&!s?e.ym(n,i,r,!1):s&&!a?e.ym(i,n,r,!1):e.ym(i,n,r,!1)||e.ym(n,i,r,!1)))},e.Xz=function(n,r,s,o){function a(t,e){return g.QE(t,e)}if(n.yz()>r.yz())var h=r,l=n;else h=n,l=r;n=h.Ga(),r=l.Ga();var c=[0,0],u=[0,0],d=-1,f=0,p=new t.ia(0),g=new e,v=new t.l,m=new t.l,y=new t.l;h.A(v),l.A(m),v.W(s,s),m.W(s,s),y.K(v),y.Ea(m),h=null,null!=o&&(h=new t.h);var _=m=m=null,b=l.Bb;for(null!=b?(m=b.Fb,_=b.zo,null==m&&(m=t.ta.jj(l,y))):m=t.ta.jj(l,y),l=m.getIterator(),b=null,null!=_&&(b=_.getIterator());n.$a();)for(_=0;n.Ha();){var w=n.ha();if(w.A(v),v.isIntersecting(y)){if(null!=b&&(b.Xi(v,s),-1==b.next()))continue;var x=w.Qb();l.Uo(w,s);for(var T=l.next();-1!=T;T=l.next()){var A=m.ja(T);r.Vb(A);var M=r.ha(),S=M.Qb(),E=w.Ea(M,null,c,u,s);if(0<E){T=c[0],d=u[0];var C=2==E?c[1]:NaN,O=2==E?u[1]:NaN;if(2==E){if(x*(C-T)>s)return 1;var R=x*(C-T);if(r.Ha()){if(M=r.ha(),2==(E=w.Ea(M,null,c,null,s))){var I=c[1];if(R+(E=x*(I-(E=c[0])))>s)return 1}r.Vb(A),r.ha()}if(!r.vm()){if(r.li(),M=r.li(),2==(E=w.Ea(M,null,c,null,s))&&R+(E=x*((I=c[1])-(E=c[0])))>s)return 1;r.Vb(A),r.ha()}if(n.Ha()){if(A=n.wb(),2==(E=(w=n.ha()).Ea(M,null,c,null,s))&&R+(E=x*((I=c[1])-(E=c[0])))>s)return 1;n.Vb(A),n.ha()}if(!n.vm()){if(A=n.wb(),n.li(),2==(E=(w=n.li()).Ea(M,null,c,null,s))&&R+(E=S*((I=c[1])-(E=c[0])))>s)return 1;n.Vb(A),n.ha()}M=i.construct(n.wb(),n.gb,T,C,r.wb(),r.gb,d,O),g.rh.push(M),p.add(p.size)}d=0,null!=o&&(w.hc(T,h),o.add(h.x),o.add(h.y))}}if(f<g.rh.length){for(p.Vd(f,p.size,a),w=0,T=g.rh[p.get(f)].Mm;f<g.rh.length;f++)if(!((M=g.rh[p.get(f)]).Kj<w&&M.Si<w))if(x*(M.Kj-w)>s)_=x*(M.Si-M.Kj),w=M.Si,T=M.Mm;else{if(M.Mm!=T?(_=x*(M.Si-M.Kj),T=M.Mm):_+=x*(M.Si-M.Kj),_>s)return 1;if(1==(w=M.Si))break}x*(1-w)>s&&(_=0),f=0,p.resize(0),g.rh.length=0}}}return d},e.UG=function(e,i,n){var r=e.Ga(),s=i.Ga();for(e=new t.Zl(e,i,n,!1);e.next();){i=e.nl();var o=e.hl();if(r.Vb(i),s.Vb(o),i=r.ha(),0<s.ha().Ea(i,null,null,null,n))return!0}return!1},e.VG=function(e,i,n,r){var s=e.Ga(),o=new t.l,a=new t.l,h=new t.l;e.A(o),i.A(a),o.W(n,n),o.contains(a),a.W(n,n),h.K(o),h.Ea(a),null!=(o=e.Bb)?null==(o=o.Fb)&&(o=t.ta.jj(e,h)):o=t.ta.jj(e,h),e=o.getIterator();for(var l=new t.h,c=new t.h,u=n*n,d=0;d<i.I();d++)if(i.D(d,l),h.contains(l)){a.K(l.x,l.y,l.x,l.y),e.Xi(a,n);for(var f=!1,p=e.next();-1!=p;p=e.next())if(s.Vb(o.ja(p)),(p=s.ha()).hc(p.fe(l,!1),c),t.h.yc(c,l)<=u){f=!0;break}if(r){if(!f)return!1}else if(f)return!0}return!!r},e.Yz=function(e,i,n){var r=new t.h,s=n*n,o=e.Ga();if(null!=(e=e.Bb)&&null!=(e=e.Fb)){var a=new t.l;for(a.K(i),a=(n=e.MF(a,n)).next();-1!=a;a=n.next())if(o.Vb(e.ja(a)),o.Ha()){var h=(a=o.ha()).fe(i,!1);if(a.hc(h,r),t.h.yc(i,r)<=s)return!0}return!1}for(e=new t.l;o.$a();)for(;o.Ha();)if((a=o.ha()).A(e),e.W(n,n),e.contains(i)&&(h=a.fe(i,!1),a.hc(h,r),t.h.yc(i,r)<=s))return!0;return!1},e.SG=function(t,i,n){return e.Yz(t,i,n)&&!e.Zz(t,i,n)},e.Zz=function(t,i,n){return t=t.mg(),!e.kt(t,i,n)},e.TG=function(e,i,n){if(e.tm()){var r=new t.yb(i.v,i.G,i.v,i.H),s=new t.yb(i.v,i.H,i.C,i.H),o=new t.yb(i.C,i.H,i.C,i.G);for(i=new t.yb(i.C,i.G,i.v,i.G),e=e.Ga();e.$a();)for(;e.Ha();){var a=e.ha();if(a.isIntersecting(r,n)||a.isIntersecting(s,n)||a.isIntersecting(o,n)||a.isIntersecting(i,n))return!0}}else{(r=new t.l).K(i),r.W(n,n),n=e.ub(0),s=new t.h,o=new t.h,i=new t.h,a=new t.h;for(var h=0,l=e.da();h<l;h++)for(var c=!0,u=e.Ba(h),d=e.Vc(h);u<d;u++)if(c)n.tc(2*u,o),c=!1;else{if(n.tc(2*u,s),i.L(o),a.L(s),0!=r.zy(i,a))return!0;o.L(s)}}return!1},e.qc=function(i,n,r){var s=i.getType(),o=n.getType();if(t.aa.xj(s)){var a=i.Bb;if(null!=a&&null!=(a=a.Fk))if(33==o){var h=n.D();if(1==(h=a.So(h.x,h.y)))return 1;if(0==h)return 4}else{if(h=new t.l,n.A(h),1==(h=a.Ro(h)))return 1;if(0==h)return 4;if(r&&t.aa.xj(o)&&e.HE(n,a))return 1073741824}}if(t.aa.xj(o)&&null!=(a=n.Bb)&&null!=(a=a.Fk))if(33==s){if(i=i.D(),1==(h=a.So(i.x,i.y)))return 2;if(0==h)return 4}else{if(n=new t.l,i.A(n),1==(h=a.Ro(n)))return 2;if(0==h)return 4;if(r&&t.aa.xj(s)&&e.HE(i,a))return 1073741824}return 0},e.HE=function(e,i){for(var n=e.I(),r=new t.h,s=0;s<n;s++)if(e.D(s,r),1==i.So(r.x,r.y))return!0;return!1},e.II=function(e,i,n,r){for(var s=1<=e.om(0)&&1<=i.om(0),o=e.Ga(),a=i.Ga(),h=[0,0],l=[0,0],c=new t.Zl(e,i,n,!1),u=!1;c.next();){var d=c.nl(),f=c.hl();if(o.Vb(d),a.Vb(f),d=o.ha(),2==(f=a.ha().Ea(d,null,l,h,n))){if(u=h[0],f=h[1],d=d.Qb(),s&&(f-u)*d>n)return!1;u=!0}else if(0!=f){if(d=l[0],0<(u=h[0])&&1>u&&0<d&&1>d)return!1;u=!0}}return!!u&&(o=new t.l,a=new t.l,s=new t.l,e.A(o),i.A(a),o.W(1e3*n,1e3*n),a.W(1e3*n,1e3*n),s.K(o),s.Ea(a),!(10<e.I()&&(e=t.Ud.clip(e,s,n,0),e.B())||10<i.I()&&(i=t.Ud.clip(i,s,n,0),i.B()))&&t.am.rt(e,i,n,"F********",r))},e.FI=function(i,n,r,s){var o=1<=i.om(0)&&1<=n.om(0),a=new t.l,h=new t.l,l=new t.l;i.A(a),n.A(h);for(var c=!1,u=e.ls(a,h,r),d=e.ls(h,a,r),f=i.Ga(),p=n.Ga(),g=[0,0],v=[0,0],m=new t.Zl(i,n,r,!1);m.next();){var y=m.nl(),_=m.hl();if(f.Vb(y),p.Vb(_),_=f.ha(),2==(y=p.ha().Ea(_,null,v,g,r))){y=g[0];var b=g[1];if(_=_.Qb(),o&&(b-y)*_>r&&(c=!0,u&&d))return!0}else if(0!=y&&(_=v[0],0<(y=g[0])&&1>y&&0<_&&1>_))return!0}if(o=new t.l,f=new t.l,o.K(a),o.W(1e3*r,1e3*r),f.K(h),f.W(1e3*r,1e3*r),l.K(o),l.Ea(f),a="",a=c?a+"**":a+"T*",u){if(10<n.I()&&(n=t.Ud.clip(n,l,r,0)).B())return!1;a+="****"}else a+="T***";if(d){if(10<i.I()&&(i=t.Ud.clip(i,l,r,0)).B())return!1;a+="***"}else a+="T**";return t.am.rt(i,n,r,a.toString(),s)},e.BI=function(i,n,r,s){var o=[!1],a=e.zI(i,n,r,o);return o[0]?a:(o=new t.l,n.A(o),o.W(1e3*r,1e3*r),!(10<i.I()&&(i=t.Ud.clip(i,o,r,0),i.B()))&&t.am.Sw(i,n,r,s))},e.zI=function(e,i,n,r){r[0]=!1;for(var s=e.Ga(),o=i.Ga(),a=[0,0],h=[0,0],l=new t.Zl(e,i,n,!1),c=!1;l.next();){var u=l.nl(),d=l.hl();if(s.Vb(u,-1),o.Vb(d,-1),u=s.ha(),0!=(u=o.ha().Ea(u,null,h,a,n))&&(c=!0,1==u&&(u=a[0],d=h[0],0<u&&1>u&&0<d&&1>d)))return r[0]=!0,!1}if(!c){for(r[0]=!0,a=new t.l,e.A(a),a.W(n,n),l=e,c=!1,h=new t.l,r=0,s=i.da();r<s;r++)if(0<i.Ja(r)){if(i.Rj(r,h),!a.isIntersecting(h))return!1;if(o=i.Na(i.Ba(r)),0==(o=t.Dg.wm(l,o,0)))return!1;c||(!t.Dg.Ml(e,i.da()-1)||null!=e.Bb&&null!=e.Bb.Fb?l=e:(o=new t.Da,e.copyTo(o),o.fj(1),l=o),c=!0)}if(1==e.da()||1607==i.getType())return!0;for(a=new t.l,i.A(a),a.W(n,n),h=i,l=!1,n=new t.l,r=0,s=e.da();r<s;r++)if(0<e.Ja(r)){if(e.Rj(r,n),a.isIntersecting(n)&&(o=e.Na(e.Ba(r)),1==(o=t.Dg.wm(h,o,0))))return!1;l||(!t.Dg.Ml(i,e.da()-1)||null!=i.Bb&&null!=i.Bb.Fb?h=i:(o=new t.Da,i.copyTo(o),o.fj(1),h=o),l=!0)}return!0}return!1},e.JI=function(e,i,n,r){for(var s=e.Ga(),o=i.Ga(),a=[0,0],h=[0,0],l=new t.Zl(e,i,n,!1),c=!1;l.next();){var u=l.nl(),d=l.hl();if(s.Vb(u),o.Vb(d),u=s.ha(),2==(u=o.ha().Ea(u,null,h,a,n)))c=!0;else if(0!=u){if(c=a[0],u=h[0],0<c&&1>c&&0<u&&1>u)return!1;c=!0}}return!!c&&(o=new t.l,a=new t.l,s=new t.l,e.A(o),i.A(a),o.W(1e3*n,1e3*n),a.W(1e3*n,1e3*n),s.K(o),s.Ea(a),!(10<e.I()&&(e=t.Ud.clip(e,s,n,0),e.B())||10<i.I()&&(i=t.Ud.clip(i,s,n,0),i.B()))&&t.am.$m(e,i,n,"F********",r))},e.DI=function(i,n,r,s){for(var o=i.Ga(),a=n.Ga(),h=[0,0],l=[0,0],c=new t.Zl(i,n,r,!1),u=!1;c.next();){var d=c.nl(),f=c.hl();if(o.Vb(d),a.Vb(f),d=o.ha(),2==(d=a.ha().Ea(d,null,l,h,r)))u=!0;else if(0!=d){if(u=h[0],d=l[0],0<u&&1>u&&0<d&&1>d)return!0;u=!0}}return!!u&&(a=new t.l,h=new t.l,l=new t.l,c=new t.l,o=new t.l,i.A(a),n.A(h),e.ls(h,a,r)?(l.K(a),l.W(1e3*r,1e3*r),c.K(h),c.W(1e3*r,1e3*r),o.K(l),o.Ea(c),!(10<i.I()&&(i=t.Ud.clip(i,o,r,0),i.B())||10<n.I()&&(n=t.Ud.clip(n,o,r,0),n.B()))&&(r=t.am.$m(i,n,r,"T********",s))):r=t.am.$m(i,n,r,"T*****T**",s))},e.CI=function(i,n,r,s){var o=[!1],a=e.zI(i,n,r,o);return o[0]?a:(o=new t.l,n.A(o),o.W(1e3*r,1e3*r),!(10<i.I()&&(i=t.Ud.clip(i,o,r,0),i.B()))&&t.am.fB(i,n,r,s))},e.AI=function(e,i,n){return 1==t.hd.Yd(e,i,n)},e.HI=function(e,i,n){return 2==t.hd.Yd(e,i,n)},e.kt=function(e,i,n){var r=new t.h;n*=n;for(var s=0;s<e.I();s++)if(e.D(s,r),t.h.yc(r,i)<=n)return!1;return!0},e.prototype.QE=function(t,e){return t=this.rh[t],e=this.rh[e],t.Mm<e.Mm||t.Mm==e.Mm&&(t.pw<e.pw||t.pw==e.pw&&(t.Kj<e.Kj||t.Kj==e.Kj&&(t.Si<e.Si||t.Si==e.Si&&t.BH<e.BH)))?-1:1},e}();t.ud=n}(X||(X={})),function(t){var e,i,n;(i=e||(e={}))[i.InteriorInterior=0]="InteriorInterior",i[i.InteriorBoundary=1]="InteriorBoundary",i[i.InteriorExterior=2]="InteriorExterior",i[i.BoundaryInterior=3]="BoundaryInterior",i[i.BoundaryBoundary=4]="BoundaryBoundary",i[i.BoundaryExterior=5]="BoundaryExterior",i[i.ExteriorInterior=6]="ExteriorInterior",i[i.ExteriorBoundary=7]="ExteriorBoundary",i[i.ExteriorExterior=8]="ExteriorExterior",function(t){t[t.AreaAreaPredicates=0]="AreaAreaPredicates",t[t.AreaLinePredicates=1]="AreaLinePredicates",t[t.LineLinePredicates=2]="LineLinePredicates",t[t.AreaPointPredicates=3]="AreaPointPredicates",t[t.LinePointPredicates=4]="LinePointPredicates",t[t.PointPointPredicates=5]="PointPointPredicates"}(n||(n={})),e=function(){function e(){this.le=0,this.j=new t.iu,this.J=[0,0,0,0,0,0,0,0,0],this.Za=[0,0,0,0,0,0,0,0,0],this.ea=[!1,!1,!1,!1,!1,!1,!1,!1,!1],this.Sm=this.vw=-1}return e.yB=function(e,i,n,r,s){if(9!=r.length)throw t.i.fa("relation string length has to be 9 characters");for(var o=0;9>o;o++){var a=r.charAt(o);if("*"!=a&&"T"!=a&&"F"!=a&&"0"!=a&&"1"!=a&&"2"!=a)throw t.i.fa("relation string")}if(0!=(o=this.MR(r,e.Db(),i.Db())))return t.ud.zB(e,i,n,o,s);o=new t.l,e.A(o),a=new t.l,i.A(a);var h=new t.l;if(h.K(o),h.Zb(a),n=t.ta.Wd(n,h,!1),e=this.WE(e,n),i=this.WE(i,n),e.B()||i.B())return this.uW(e,i,r);switch(o=e.getType(),a=i.getType(),h=!1,o){case 1736:switch(a){case 1736:h=this.rt(e,i,n,r,s);break;case 1607:h=this.$m(e,i,n,r,s);break;case 33:h=this.qt(e,i,n,r);break;case 550:h=this.pt(e,i,n,r,s)}break;case 1607:switch(a){case 1736:h=this.$m(i,e,n,this.Zp(r),s);break;case 1607:h=this.gB(e,i,n,r,s);break;case 33:h=this.tt(e,i,n,r,s);break;case 550:h=this.st(e,i,n,r,s)}break;case 33:switch(a){case 1736:h=this.qt(i,e,n,this.Zp(r));break;case 1607:h=this.tt(i,e,n,this.Zp(r),s);break;case 33:h=this.$U(e,i,n,r);break;case 550:h=this.lt(i,e,n,this.Zp(r))}break;case 550:switch(a){case 1736:h=this.pt(i,e,n,this.Zp(r),s);break;case 1607:h=this.st(i,e,n,this.Zp(r),s);break;case 550:h=this.ZA(e,i,n,r,s);break;case 33:h=this.lt(e,i,n,r)}break;default:h=!1}return h},e.rt=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.xJ();var h=new t.l,l=new t.l;return i.A(h),n.A(l),s=!1,t.ud.dk(h,l,r)&&(a.Cu(i,n),s=!0),s||(4==(h=t.ud.qc(i,n,!1))?(a.Cu(i,n),s=!0):1==h?(a.ly(n),s=!0):2==h&&(a.ZD(i),s=!0)),s||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.Bp(i,n),a.j.Ug()),e.fg(a.J,a.Xc)},e.Sw=function(i,n,r,s){var o=new e;o.Yi(),o.bj("T*****F**"),o.xJ();var a=new t.l,h=new t.l;i.A(a),n.A(h);var l=!1;return t.ud.dk(a,h,r)&&(o.Cu(i,n),l=!0),l||(4==(a=t.ud.qc(i,n,!1))?(o.Cu(i,n),l=!0):1==a?(o.ly(n),l=!0):2==a&&(o.ZD(i),l=!0)),l?this.fg(o.J,o.Xc):(i=(l=new t.gd).Ib(i),a=l.Ib(n),t.Tk.V(l,r,s,!1),r=l.Ne(a).mg(),l.Gp(0,!0,!0),t.rn.V(l,i,-1,!1,s),0!=l.I(i)&&(t.rn.V(l,a,-1,!1,s),o.er(l,s),(n=0==l.I(a))||(o.Bp(i,a),o.j.Ug(),a=this.fg(o.J,o.Xc))?(i=l.Ne(i),i=(l=new t.gd).Ib(i),a=l.Ib(r),o.er(l,s),o.le=0,o.Yi(),o.bj(n?"T*****F**":"******F**"),o.IB(),o.Bp(i,a),o.j.Ug(),this.fg(o.J,o.Xc)):a))},e.$m=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.IB();var h=new t.l,l=new t.l;return i.A(h),n.A(l),s=!1,t.ud.dk(h,l,r)&&(a.Du(i,n),s=!0),s||(4==(h=t.ud.qc(i,n,!1))?(a.Du(i,n),s=!0):1==h&&(a.$D(n),s=!0)),s||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.kh=a.j.Dp(),e.Jw(n,a.j,a.kh),a.Bp(i,n),a.j.Ep(a.kh),a.j.Ug()),e.fg(a.J,a.Xc)},e.fB=function(i,n,r,s){var o=new e;o.Yi(),o.bj("T*****F**"),o.IB();var a=new t.l,h=new t.l;i.A(a),n.A(h);var l=!1;return t.ud.dk(a,h,r)&&(o.Du(i,n),l=!0),l||(4==(a=t.ud.qc(i,n,!1))?(o.Du(i,n),l=!0):1==a&&(o.$D(n),l=!0)),l?this.fg(o.J,o.Xc):(i=(l=new t.gd).Ib(i),n=l.Ib(n),o.Wo(l,r,s),0!=l.I(i)&&(o.Bp(i,n),o.j.Ug(),this.fg(o.J,o.Xc)))},e.pt=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.yJ();var h=new t.l,l=new t.l;return i.A(h),n.A(l),s=!1,t.ud.dk(h,l,r)&&(a.Eu(i),s=!0),s||(4==(h=t.ud.qc(i,n,!1))?(a.Eu(i),s=!0):1==h&&(a.zN(),s=!0)),s||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.Gy(i,n),a.j.Ug()),e.fg(a.J,a.Xc)},e.gB=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.eX(),s=new t.l;var h=new t.l;i.A(s),n.A(h);var l=!1;return t.ud.dk(s,h,r)&&(a.PG(i,n),l=!0),l||4!=t.ud.qc(i,n,!1)||(a.PG(i,n),l=!0),l||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.Yh=a.j.Dp(),a.kh=a.j.Dp(),e.Jw(i,a.j,a.Yh),e.Jw(n,a.j,a.kh),a.Bp(i,n),a.j.Ep(a.Yh),a.j.Ep(a.kh),a.j.Ug()),e.fg(a.J,a.Xc)},e.st=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.MJ(),s=new t.l;var h=new t.l;i.A(s),n.A(h);var l=!1;return t.ud.dk(s,h,r)&&(a.Vz(i),l=!0),l||4!=t.ud.qc(i,n,!1)||(a.Vz(i),l=!0),l||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.Yh=a.j.Dp(),e.Jw(i,a.j,a.Yh),a.Gy(i,n),a.j.Ep(a.Yh),a.j.Ug()),e.fg(a.J,a.Xc)},e.ZA=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.RJ(),s=new t.l;var h=new t.l;i.A(s),n.A(h);var l=!1;return t.ud.dk(s,h,r)&&(a.yI(),l=!0),l||(i=(s=new t.gd).Ib(i),n=s.Ib(n),a.Wo(s,r,o),a.Gy(i,n),a.j.Ug()),e.fg(a.J,a.Xc)},e.qt=function(i,n,r,s){var o=new e;o.Yi(),o.bj(s),o.yJ();var a=new t.l;i.A(a),n=n.D();var h=!1;return t.ud.Rw(n,a,r)&&(o.Eu(i),h=!0),h||(1==(r=t.hd.Yd(i,n,r))?(o.J[0]=0,o.J[2]=2,o.J[3]=-1,o.J[5]=1,o.J[6]=-1):2==r?(o.J[6]=-1,0!=i.Ke()?(o.J[0]=-1,o.J[3]=0,o.J[2]=2,o.J[5]=1):(o.J[0]=0,o.J[3]=-1,o.J[5]=-1,r=new t.l,i.A(r),o.J[2]=0==r.ca()&&0==r.R()?-1:1)):o.Eu(i)),this.fg(o.J,s)},e.tt=function(i,n,r,s,o){var a=new e;a.Yi(),a.bj(s),a.MJ();var h=new t.l;i.A(h),s=n.D();var l=!1;if(t.ud.Rw(s,h,r)&&(a.Vz(i),l=!0),!l){h=null;var c=l=!1;(a.ea[0]||a.ea[6])&&(t.ud.Yz(i,s,r)?(a.ea[0]&&(h=t.pi.gm(i,o),c=!t.ud.kt(h,s,r),l=!0,a.J[0]=c?-1:0),a.J[6]=-1):(a.J[0]=-1,a.J[6]=0)),a.ea[3]&&(null!=h&&h.B()?a.J[3]=-1:(l||(null==h&&(h=t.pi.gm(i,o)),c=!t.ud.kt(h,s,r),l=!0),a.J[3]=c?0:-1)),a.ea[5]&&(null!=h&&h.B()?a.J[5]=-1:l&&!c?a.J[5]=0:(null==h&&(h=t.pi.gm(i,o)),o=t.ud.Nw(h,n,r),a.J[5]=o?-1:0)),a.ea[2]&&(0!=i.Qb()?a.J[2]=1:((o=new t.de(i.description)).Fd(i,0,i.I()),i=t.ud.Nw(o,n,r),a.J[2]=i?-1:0))}return this.fg(a.J,a.Xc)},e.lt=function(i,n,r,s){var o=new e;o.Yi(),o.bj(s),o.RJ();var a=new t.l;i.A(a),n=n.D();var h=!1;if(t.ud.Rw(n,a,r)&&(o.yI(),h=!0),!h){a=!1,h=!0,r*=r;for(var l=0;l<i.I();l++){var c=i.Na(l);if(t.h.yc(c,n)<=r?a=!0:h=!1,a&&!h)break}a?(o.J[0]=0,o.J[2]=h?-1:0,o.J[6]=-1):(o.J[0]=-1,o.J[2]=0,o.J[6]=0)}return e.fg(o.J,s)},e.$U=function(i,n,r,s){i=i.D(),n=n.D();for(var o=[],a=0;9>a;a++)o[a]=-1;return t.h.yc(i,n)<=r*r?o[0]=0:(o[2]=0,o[6]=0),o[8]=2,e.fg(o,s)},e.fg=function(t,e){for(var i=0;9>i;i++)switch(e.charAt(i)){case"T":if(-1==t[i])return!1;break;case"F":if(-1!=t[i])return!1;break;case"0":if(0!=t[i])return!1;break;case"1":if(1!=t[i])return!1;break;case"2":if(2!=t[i])return!1}return!0},e.uW=function(e,i,n){var r=[-1,-1,-1,-1,-1,-1,-1,-1,-1];if(e.B()&&i.B()){for(var s=0;9>s;s++)r[s]=-1;return this.fg(r,n)}return s=!1,e.B()&&(e=i,s=!0),r[0]=-1,r[1]=-1,r[3]=-1,r[4]=-1,r[6]=-1,r[7]=-1,r[8]=2,i=e.getType(),t.aa.Hc(i)?1736==i?0!=e.Ke()?(r[2]=2,r[5]=1):(r[5]=-1,i=new t.l,e.A(i),r[2]=0==i.ca()&&0==i.R()?0:1):(i=0!=e.Qb(),r[2]=i?1:0,r[5]=t.pi.aq(e)?0:-1):(r[2]=0,r[5]=-1),s&&this.vK(r),this.fg(r,n)},e.MR=function(t,i,n){return e.dQ(t)?3:e.UP(t)?4:e.cY(t,i,n)?8:e.CP(t,i,n)?16:e.eP(t)?1:e.EU(t,i,n)?32:0},e.dQ=function(t){return"T"==t.charAt(0)&&"*"==t.charAt(1)&&"F"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"F"==t.charAt(5)&&"F"==t.charAt(6)&&"F"==t.charAt(7)&&"*"==t.charAt(8)},e.UP=function(t){return"F"==t.charAt(0)&&"F"==t.charAt(1)&&"*"==t.charAt(2)&&"F"==t.charAt(3)&&"F"==t.charAt(4)&&"*"==t.charAt(5)&&"*"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8)},e.cY=function(t,e,i){return(0!=e||0!=i)&&((2!=e||2!=i)&&("F"==t.charAt(0)&&"*"==t.charAt(1)&&"*"==t.charAt(2)&&"T"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"*"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8)||1==e&&1==i&&"F"==t.charAt(0)&&"T"==t.charAt(1)&&"*"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"*"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8))||0!=i&&"F"==t.charAt(0)&&"*"==t.charAt(1)&&"*"==t.charAt(2)&&"*"==t.charAt(3)&&"T"==t.charAt(4)&&"*"==t.charAt(5)&&"*"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8))},e.CP=function(t,e,i){return e>i?"T"==t.charAt(0)&&"*"==t.charAt(1)&&"*"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"T"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8):1==e&&1==i&&"0"==t.charAt(0)&&"*"==t.charAt(1)&&"*"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"*"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8)},e.eP=function(t){return"T"==t.charAt(0)&&"*"==t.charAt(1)&&"*"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"F"==t.charAt(6)&&"F"==t.charAt(7)&&"*"==t.charAt(8)},e.EU=function(t,e,i){if(e==i){if(1!=e)return"T"==t.charAt(0)&&"*"==t.charAt(1)&&"T"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"T"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8);if("1"==t.charAt(0)&&"*"==t.charAt(1)&&"T"==t.charAt(2)&&"*"==t.charAt(3)&&"*"==t.charAt(4)&&"*"==t.charAt(5)&&"T"==t.charAt(6)&&"*"==t.charAt(7)&&"*"==t.charAt(8))return!0}return!1},e.Jw=function(t,e,i){t=e.La(t);for(var n=e.Re;-1!=n;n=e.Rf(n))if(e.xd(n)&t){var r=e.Me(n);if(-1==r)e.nn(n,i,0);else{var s=r,o=0;do{!!(e.dh(s)&t)&&o++,s=e.jc(e.xa(s))}while(s!=r);e.nn(n,i,o)}}},e.Zp=function(t){var e=""+t.charAt(0);return e+=t.charAt(3),e+=t.charAt(6),e+=t.charAt(1),e+=t.charAt(4),e+=t.charAt(7),e+=t.charAt(2),(e+=t.charAt(5))+t.charAt(8)},e.prototype.Yi=function(){for(var t=0;9>t;t++)this.J[t]=-2,this.Za[t]=-2},e.vK=function(t){var e=t[1],i=t[2],n=t[5];t[1]=t[3],t[2]=t[6],t[5]=t[7],t[3]=e,t[6]=i,t[7]=n},e.prototype.bj=function(t){for(this.Xc=t,t=0;9>t;t++)"*"!=this.Xc.charAt(t)?(this.ea[t]=!0,this.le++):this.ea[t]=!1},e.prototype.UJ=function(){for(var t=0;9>t;t++)this.ea[t]&&-2==this.J[t]&&(this.J[t]=-1,this.ea[t]=!1)},e.prototype.pc=function(t){return!(-2==this.J[t]||(-1==this.J[t]?(this.ea[t]=!1,this.le--,0):"T"!=this.Xc.charAt(t)&&"F"!=this.Xc.charAt(t)&&this.J[t]<this.Za[t]||(this.ea[t]=!1,this.le--,0)))},e.prototype.xJ=function(){this.vw=0,this.Za[0]=2,this.Za[1]=1,this.Za[2]=2,this.Za[3]=1,this.Za[4]=1,this.Za[5]=1,this.Za[6]=2,this.Za[7]=1,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.IB=function(){this.vw=1,this.Sm=3,this.Za[0]=1,this.Za[1]=0,this.Za[2]=2,this.Za[3]=1,this.Za[4]=0,this.Za[5]=1,this.Za[6]=1,this.Za[7]=0,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.eX=function(){this.vw=2,this.Sm=4,this.Za[0]=1,this.Za[1]=0,this.Za[2]=1,this.Za[3]=0,this.Za[4]=0,this.Za[5]=0,this.Za[6]=1,this.Za[7]=0,this.Za[8]=2,this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.yJ=function(){this.Sm=3,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=2,this.Za[3]=0,this.Za[4]=-1,this.Za[5]=1,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.MJ=function(){this.Sm=4,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=1,this.Za[3]=0,this.Za[4]=-1,this.Za[5]=0,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.RJ=function(){this.Sm=5,this.Za[0]=0,this.Za[1]=-1,this.Za[2]=0,this.Za[3]=-1,this.Za[4]=-1,this.Za[5]=-1,this.Za[6]=0,this.Za[7]=-1,this.Za[8]=2,this.ea[1]&&(this.J[1]=-1,this.ea[1]=!1,this.le--),this.ea[3]&&(this.J[3]=-1,this.ea[3]=!1,this.le--),this.ea[4]&&(this.J[4]=-1,this.ea[4]=!1,this.le--),this.ea[5]&&(this.J[5]=-1,this.ea[5]=!1,this.le--),this.ea[7]&&(this.J[7]=-1,this.ea[7]=!1,this.le--),this.ea[8]&&(this.J[8]=2,this.ea[8]=!1,this.le--)},e.prototype.xN=function(t,e,i){var n=!0;return this.ea[0]&&(this.CS(t,e,i),n=n&&this.pc(0)),this.ea[1]&&(this.sG(t,e,1),n=n&&this.pc(1)),this.ea[2]&&(this.tG(t,e,i,2),n=n&&this.pc(2)),this.ea[3]&&(this.sG(t,i,3),n=n&&this.pc(3)),this.ea[4]&&(this.BN(t,e,i),n=n&&this.pc(4)),this.ea[5]&&(this.eE(t,i,5),n=n&&this.pc(5)),this.ea[6]&&(this.tG(t,i,e,6),n=n&&this.pc(6)),this.ea[7]&&(this.eE(t,e,7),n=n&&this.pc(7)),n},e.prototype.Cu=function(t,e){this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.Fr(t,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5)),this.Fr(e,this.ea[6]?6:-1,this.Xc.charAt(6),this.ea[7]?7:-1,this.Xc.charAt(7))},e.prototype.Fr=function(e,i,n,r,s){-1==i&&-1==r||(("T"!=n&&"F"!=n&&-1!=i||"T"!=s&&"F"!=s&&-1!=r)&&0==e.Ke()?(-1!=r&&(this.J[r]=-1),-1!=i&&(n=new t.l,e.A(n),this.J[i]=0==n.ca()&&0==n.R()?0:1)):(-1!=i&&(this.J[i]=2),-1!=r&&(this.J[r]=1)))},e.prototype.ly=function(t){this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1,this.Fr(t,this.ea[0]?0:-1,this.Xc.charAt(0),this.ea[1]?1:-1,this.Xc.charAt(1))},e.prototype.ZD=function(t){this.ly(t),e.vK(this.J)},e.prototype.Du=function(e,i){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.ea[6]){var n=this.Xc.charAt(6);n="T"==n||"F"==n||0!=i.Qb(),this.J[6]=n?1:0}this.ea[7]&&(i=t.pi.aq(i),this.J[7]=i?0:-1),this.Fr(e,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5))},e.prototype.$D=function(e){if(this.ea[0]){var i=this.Xc.charAt(0);i="T"==i||"F"==i||0!=e.Qb(),this.J[0]=i?1:0}this.ea[1]&&(e=t.pi.aq(e),this.J[1]=e?0:-1),this.J[2]=2,this.J[3]=-1,this.J[4]=-1,this.J[5]=1,this.J[6]=-1,this.J[7]=-1},e.prototype.Eu=function(t){this.J[0]=-1,this.J[3]=-1,this.J[6]=0,this.Fr(t,this.ea[2]?2:-1,this.Xc.charAt(2),this.ea[5]?5:-1,this.Xc.charAt(5))},e.prototype.zN=function(){this.J[0]=0,this.J[2]=2,this.J[3]=-1,this.J[5]=1,this.J[6]=-1},e.prototype.PG=function(e,i){if(this.J[0]=-1,this.J[1]=-1,this.J[3]=-1,this.J[4]=-1,this.ea[2]){var n=this.Xc.charAt(2);n="T"==n||"F"==n||0!=e.Qb(),this.J[2]=n?1:0}this.ea[5]&&(e=t.pi.aq(e),this.J[5]=e?0:-1),this.ea[6]&&(n="T"==(n=this.Xc.charAt(6))||"F"==n||0!=i.Qb(),this.J[6]=n?1:0),this.ea[7]&&(i=t.pi.aq(i),this.J[7]=i?0:-1)},e.prototype.Vz=function(e){if(this.J[0]=-1,this.J[3]=-1,this.ea[2]){var i=this.Xc.charAt(2);i="T"==i||"F"==i||0!=e.Qb(),this.J[2]=i?1:0}this.ea[5]&&(e=t.pi.aq(e),this.J[5]=e?0:-1),this.J[6]=0},e.prototype.yI=function(){this.J[0]=-1,this.J[2]=0,this.J[6]=0},e.prototype.yN=function(t,e,i){var n=!0;return this.ea[0]&&(this.DS(t,e),n=n&&this.pc(0)),this.ea[1]&&(this.zS(t,e,i,this.kh),n=n&&this.pc(1)),this.ea[2]&&(this.AS(t,e),n=n&&this.pc(2)),this.ea[3]&&(this.FN(t,e,i,this.kh),n=n&&this.pc(3)),this.ea[4]&&(this.CN(t,e,i,this.kh),n=n&&this.pc(4)),this.ea[5]&&(this.DN(t,e,i),n=n&&this.pc(5)),this.ea[6]&&(this.lQ(t,e),n=n&&this.pc(6)),this.ea[7]&&(this.kQ(t,e,i,this.kh),n=n&&this.pc(7)),n},e.prototype.mT=function(t,e,i){var n=!0;return this.ea[0]&&(this.GS(t,e,i,this.Yh,this.kh),n=n&&this.pc(0)),this.ea[1]&&(this.uG(t,e,i,this.Yh,this.kh,1),n=n&&this.pc(1)),this.ea[2]&&(this.vG(t,e,i,2),n=n&&this.pc(2)),this.ea[3]&&(this.uG(t,i,e,this.kh,this.Yh,3),n=n&&this.pc(3)),this.ea[4]&&(this.HN(t,e,i,this.Yh,this.kh),n=n&&this.pc(4)),this.ea[5]&&(this.fE(t,i,this.Yh,5),n=n&&this.pc(5)),this.ea[6]&&(this.vG(t,i,e,6),n=n&&this.pc(6)),this.ea[7]&&(this.fE(t,e,this.kh,7),n=n&&this.pc(7)),n},e.prototype.aE=function(t,e,i){var n=!0;return this.ea[0]&&(this.ES(t,e),n=n&&this.pc(0)),this.ea[2]&&(this.BS(t,e),n=n&&this.pc(2)),this.ea[3]&&(this.GN(t,e,i),n=n&&this.pc(3)),this.ea[5]&&(this.EN(t,e),n=n&&this.pc(5)),this.ea[6]&&(this.mQ(t,e),n=n&&this.pc(6)),n},e.prototype.QG=function(t,e,i){var n=!0;return this.ea[0]&&(this.HS(t,e,i,this.Yh),n=n&&this.pc(0)),this.ea[2]&&(this.FS(t,i),n=n&&this.pc(2)),this.ea[3]&&(this.JN(t,e,i,this.Yh),n=n&&this.pc(3)),this.ea[5]&&(this.IN(t,e,i,this.Yh),n=n&&this.pc(5)),this.ea[6]&&(this.nQ(t,e,i),n=n&&this.pc(6)),n},e.prototype.ZU=function(t,e,i){var n=!0;return this.ea[0]&&(this.IS(t,e,i),n=n&&this.pc(0)),this.ea[2]&&(this.wG(t,e,i,2),n=n&&this.pc(2)),this.ea[6]&&(this.wG(t,i,e,6),n=n&&this.pc(6)),n},e.prototype.CS=function(t,e,i){2!=this.J[0]&&(t=this.j.af(t))&e&&t&i&&(this.J[0]=2)},e.prototype.sG=function(t,e,i){if(1!=this.J[i]){var n=this.j.af(this.j.xa(t));this.j.af(t)&e&&n&e&&(this.J[i]=1)}},e.prototype.tG=function(t,e,i,n){2!=this.J[n]&&(t=this.j.af(t))&e&&!(t&i)&&(this.J[n]=2)},e.prototype.BN=function(t,e,i){if(1!=this.J[4]){var n=this.j.dh(t);n&e&&n&i?this.J[4]=1:0!=this.J[4]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)&&(t=this.j.xd(this.j.uf(t)))&e&&t&i&&(this.J[4]=0)}},e.prototype.eE=function(t,e,i){if(1!=this.J[i]){var n=this.j.af(this.j.xa(t));!(this.j.af(t)&e)&&!(n&e)&&(this.J[i]=1)}},e.prototype.DS=function(t,e){if(1!=this.J[0]){var i=this.j.af(this.j.xa(t));this.j.af(t)&e&&i&e&&(this.J[0]=1)}},e.prototype.zS=function(t,e,i,n){if(0!=this.J[1]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)){var r=this.j.uf(t),s=this.j.xd(r);!(s&e)&&this.j.af(t)&e&&(t=this.j.ng(r,n),s&i&&0!=t%2&&(this.J[1]=0))}},e.prototype.AS=function(t,e){2!=this.J[2]&&this.j.dh(t)&e&&(this.J[2]=2)},e.prototype.FN=function(t,e,i,n){if(1!=this.J[3]){var r=this.j.dh(t);r&e&&r&i?this.J[3]=1:0!=this.J[3]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)&&(r=this.j.uf(t),(t=this.j.xd(r))&e&&(e=this.j.ng(r,n),t&i&&0==e%2&&(this.J[3]=0)))}},e.prototype.CN=function(t,e,i,n){if(0!=this.J[4]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)){var r=this.j.uf(t);(t=this.j.xd(r))&e&&(e=this.j.ng(r,n),t&i&&0!=e%2&&(this.J[4]=0))}},e.prototype.DN=function(t,e,i){1!=this.J[5]&&(t=this.j.dh(t))&e&&!(t&i)&&(this.J[5]=1)},e.prototype.lQ=function(t,e){if(1!=this.J[6]){var i=this.j.af(this.j.xa(t));!(this.j.af(t)&e)&&!(i&e)&&(this.J[6]=1)}},e.prototype.kQ=function(t,e,i,n){if(0!=this.J[7]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)){var r=this.j.uf(t),s=this.j.xd(r);!(s&e)&&!(this.j.af(t)&e)&&(t=this.j.ng(r,n),s&i&&0!=t%2&&(this.J[7]=0))}},e.prototype.GS=function(t,e,i,n,r){if(1!=this.J[0]){var s=this.j.dh(t);s&e&&s&i?this.J[0]=1:0!=this.J[0]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)&&(t=this.j.uf(t),(s=this.j.xd(t))&e&&s&i&&(e=this.j.ng(t,n),r=this.j.ng(t,r),0==e%2&&0==r%2&&(this.J[0]=0)))}},e.prototype.uG=function(t,e,i,n,r,s){if(0!=this.J[s]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)){t=this.j.uf(t);var o=this.j.xd(t);o&e&&o&i&&(e=this.j.ng(t,n),r=this.j.ng(t,r),0==e%2&&0!=r%2&&(this.J[s]=0))}},e.prototype.vG=function(t,e,i,n){1!=this.J[n]&&(t=this.j.dh(t))&e&&!(t&i)&&(this.J[n]=1)},e.prototype.HN=function(t,e,i,n,r){if(0!=this.J[4]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)){t=this.j.uf(t);var s=this.j.xd(t);s&e&&s&i&&(e=this.j.ng(t,n),r=this.j.ng(t,r),0!=e%2&&0!=r%2&&(this.J[4]=0))}},e.prototype.fE=function(t,e,i,n){0!=this.J[n]&&1!=this.j.Ab(this.j.te(this.j.xa(t)),this.Ui)&&(t=this.j.uf(t),!(this.j.xd(t)&e)&&0!=this.j.ng(t,i)%2&&(this.J[n]=0))},e.prototype.ES=function(t,e){0!=this.J[0]&&!(this.j.xd(t)&e)&&this.j.hk(this.j.cz(t))&e&&(this.J[0]=0)},e.prototype.BS=function(t,e){2!=this.J[2]&&this.j.xd(t)&e&&(this.J[2]=2)},e.prototype.GN=function(t,e,i){0!=this.J[3]&&(t=this.j.xd(t))&e&&t&i&&(this.J[3]=0)},e.prototype.EN=function(t,e){1!=this.J[5]&&this.j.xd(t)&e&&(this.J[5]=1)},e.prototype.mQ=function(t,e){0!=this.J[6]&&!(this.j.xd(t)&e)&&!(this.j.hk(this.j.cz(t))&e)&&(this.J[6]=0)},e.prototype.HS=function(t,e,i,n){if(0!=this.J[0]){var r=this.j.xd(t);r&e&&r&i&&0==this.j.ng(t,n)%2&&(this.J[0]=0)}},e.prototype.FS=function(t,e){1!=this.J[2]&&(-1!=this.j.Me(t)?this.J[2]=1:0!=this.J[2]&&!(this.j.xd(t)&e)&&(this.J[2]=0))},e.prototype.JN=function(t,e,i,n){if(0!=this.J[3]){var r=this.j.xd(t);r&e&&r&i&&0!=this.j.ng(t,n)%2&&(this.J[3]=0)}},e.prototype.IN=function(t,e,i,n){if(0!=this.J[5]){var r=this.j.xd(t);r&e&&!(r&i)&&0!=this.j.ng(t,n)%2&&(this.J[5]=0)}},e.prototype.nQ=function(t,e,i){0!=this.J[6]&&!((t=this.j.xd(t))&e)&&t&i&&(this.J[6]=0)},e.prototype.IS=function(t,e,i){0!=this.J[0]&&(t=this.j.xd(t))&e&&t&i&&(this.J[0]=0)},e.prototype.wG=function(t,e,i,n){0!=this.J[n]&&(t=this.j.xd(t))&e&&!(t&i)&&(this.J[n]=0)},e.prototype.Bp=function(e,i){var n=!1;e=this.j.La(e),i=this.j.La(i),this.Ui=this.j.$g();for(var r=this.j.Re;-1!=r;r=this.j.Rf(r)){var s=this.j.Me(r);if(-1==s){if(-1!=this.Sm)switch(this.Sm){case 3:n=this.aE(r,e,i);break;case 4:n=this.QG(r,e,i);break;default:throw t.i.fa("internal error")}}else{var o=s;do{var a=o;if(1!=this.j.Ab(a,this.Ui))do{switch(this.vw){case 0:n=this.xN(a,e,i);break;case 1:n=this.yN(a,e,i);break;case 2:n=this.mT(a,e,i);break;default:throw t.i.fa("internal error")}if(n)break;this.j.Kb(a,this.Ui,1),a=this.j.jc(a)}while(a!=o&&!n);if(n)break;o=this.j.jc(this.j.xa(a))}while(o!=s);if(n)break}}n||this.UJ(),this.j.Jg(this.Ui)},e.prototype.Gy=function(e,i){var n=!1;e=this.j.La(e),i=this.j.La(i);for(var r=this.j.Re;-1!=r;r=this.j.Rf(r)){switch(this.Sm){case 3:n=this.aE(r,e,i);break;case 4:n=this.QG(r,e,i);break;case 5:n=this.ZU(r,e,i);break;default:throw t.i.Qa()}if(n)break}n||this.UJ()},e.prototype.er=function(t,e){this.j.dr(t,e)},e.prototype.Wo=function(t,e,i){this.YP(t,e,i),this.er(t,i)},e.prototype.YP=function(e,i,n){for(t.Tk.V(e,i,n,!1),e.Gp(0,!0,!0),i=e.ld;-1!=i;i=e.ue(i))1736==e.ic(i)&&t.rn.V(e,i,-1,!1,n)},e.WE=function(e,i){var n=e.getType();return t.aa.yd(n)?((i=new t.Ta(e.description)).oc(e,!0),i):197==n?(n=new t.l,e.A(n),n.ca()<=i&&n.R()<=i?(i=new t.Sa(e.description),e.sf(i),i):n.ca()<=i||n.R()<=i?(i=new t.Ta(e.description),n=new t.Sa,e.Hf(0,n),i.nf(n),e.Hf(2,n),i.lineTo(n),i):((i=new t.Da(e.description)).ad(e,!1),i)):e},e}(),t.am=e}(X||(X={})),function(t){var e=function(){function e(e){this.Em=new t.ia(0),this.dw=new t.ia(0),this.wt=new t.h,this.xt=new t.h,this.g=e,this.Hs=-1}return e.prototype.bc=function(t){return this.g.bc(this.zz(t))},e.prototype.Bv=function(t){var e=this.iz(t);if(t=this.HF(t),this.g.Ma(e)==t){var i=e;e=t,t=i}return this.g.Gc(e,this.wt),this.g.Gc(t,this.xt),this.wt.y<this.xt.y},e.prototype.zz=function(t){var e=this.iz(t);return t=this.HF(t),this.g.U(e)==t?e:t},e.prototype.iz=function(t){return this.Em.get(t)},e.prototype.HF=function(t){return this.dw.get(t)},e.prototype.rF=function(t){this.Em.set(t,this.Hs),this.Hs=t},e.prototype.nI=function(e){if(-1!=this.Hs){var i=this.Hs;return this.Hs=this.Em.get(i),this.Em.set(i,e),this.dw.set(i,this.g.U(e)),i}return null==this.Em&&(this.Em=new t.ia(0),this.dw=new t.ia(0)),i=this.Em.size,this.Em.add(e),this.dw.add(this.g.U(e)),i},e.prototype.rz=function(t){return this.g.bd(this.iz(t))},e}();t.yY=e;var i=function(){function e(e){this.Be=e,this.ie=new t.yb,this.Nm=new t.yb,this.CH=0,this.Ao=null,this.yA=-1}return e.prototype.compare=function(t,e,i){i=t.ja(i);var n=this.Be.hb;if(this.yA==e)var r=this.CH;else this.Ao=n.bc(e),null==this.Ao?((t=n.g).ed(n.zz(e),this.ie),this.Ao=this.ie,r=this.ie.Pe(this.Be.yh,0)):r=this.Ao.Pe(this.Be.yh,0),this.CH=r,this.yA=e;if(null==(t=n.bc(i))){(t=n.g).ed(n.zz(i),this.Nm),t=this.Nm;var s=this.Nm.Pe(this.Be.yh,0)}else s=t.Pe(this.Be.yh,0);return r==s&&(e=n.Bv(e),i=n.Bv(i),(e=.5*((i=Math.min(e?this.Ao.la:this.Ao.na,i?t.la:t.na))+this.Be.yh))==this.Be.yh&&(e=i),r=this.Ao.Pe(e,0),s=t.Pe(e,0)),r<s?-1:r>s?1:0},e.prototype.reset=function(){this.yA=-1},e}(),n=function(){function n(){this.Wm=this.Gl=null,this.fb=new t.Yj,this.fb.RP(),this.$d=new i(this),this.fb.Vo(this.$d)}return n.prototype.HQ=function(){var e=!1;if(this.fw&&(e=this.IQ()),1==this.g.da(this.X)){var i=this.g.Ob(this.X);return e=this.g.wz(i),this.g.PB(i,!0),0>e&&(e=this.g.Xa(i),this.g.pJ(e),this.g.Wg(i,this.g.Ma(e)),!0)}for(this.El=this.g.Ky(),this.wo=this.g.Ky(),i=this.g.Ob(this.X);-1!=i;i=this.g.Rb(i))this.g.gr(i,this.El,0),this.g.gr(i,this.wo,-1);i=new t.ia(0),this.yh=NaN;var n=new t.h;this.et=this.g.da(this.X),this.ro=this.g.Gd(),this.Rs=this.g.Gd();for(var r=this.Gl.rc(this.Gl.je);-1!=r;r=this.Gl.lb(r)){var s=this.Gl.getData(r);if(this.g.Gc(s,n),n.y!=this.yh&&0!=i.size&&(e=this.ut(i)||e,this.$d.reset(),i.clear(!1)),i.add(s),this.yh=n.y,0==this.et)break}for(0<this.et&&(e=this.ut(i)||e,i.clear(!1)),this.g.Td(this.ro),this.g.Td(this.Rs),i=this.g.Ob(this.X);-1!=i;)if(3==this.g.sj(i,this.El)){for(this.g.PB(i,!0),n=i,i=this.g.sj(i,this.wo);-1!=i;)r=this.g.sj(i,this.wo),this.g.ZT(this.X,this.g.Rb(n),i),n=i,i=r;i=this.g.Rb(n)}else this.g.PB(i,!1),i=this.g.Rb(i);return this.g.CB(this.El),this.g.CB(this.wo),e},n.prototype.ut=function(t){return this.$V(t)},n.prototype.$V=function(i){var n=!1;null==this.hb&&(this.hb=new e(this.g)),null==this.Wm?(this.Wm=new t.ia(0),this.Wm.Jb(16)):this.Wm.clear(!1),this.ZV(i);for(var r=0,s=i.size;r<s;r++){var o=i.get(r);-1!=o&&this.oG(o,-1)}for(r=0;r<this.Wm.size&&0<this.et;r++)if(i=this.Wm.get(r),o=this.hb.rz(this.fb.ja(i)),s=-1,0==this.g.sj(o,this.El)){o=this.fb.we(i);for(var a,h=i;-1!=o;){var l=this.fb.ja(o),c=this.hb.rz(l),u=this.g.sj(c,this.El);if(0!=u){s=c;break}h=o,o=this.fb.we(o)}-1==o?(a=!0,o=h):(l=this.fb.ja(o),a=this.hb.Bv(l),o=this.fb.lb(o),a=!a);do{if(l=this.fb.ja(o),c=this.hb.rz(l),0==(u=this.g.sj(c,this.El))&&(a!=this.hb.Bv(l)&&(n=this.g.Xa(c),this.g.pJ(n),this.g.Wg(c,this.g.Ma(n)),n=!0),this.g.gr(c,this.El,a?3:2),a||(h=this.g.sj(s,this.wo),this.g.gr(s,this.wo,c),this.g.gr(c,this.wo,h)),this.et--,0==this.et))return n;s=c,h=o,o=this.fb.lb(o),a=!a}while(h!=i)}return n},n.prototype.ZV=function(t){for(var e=0,i=t.size;e<i;e++){var n=t.get(e),r=this.g.Pa(n,this.ro),s=this.g.Pa(n,this.Rs);if(-1!=r){var o=this.fb.ja(r);this.hb.rF(o),this.g.Ra(n,this.ro,-1)}-1!=s&&(o=this.fb.ja(s),this.hb.rF(o),this.g.Ra(n,this.Rs,-1)),o=-1,-1!=r&&-1!=s?(this.fb.vd(r,-1),this.fb.vd(s,-1),t.set(e,-1)):o=-1!=r?r:s,-1!=o&&(this.oG(n,o)||this.fb.vd(o,-1),t.set(e,-1))}},n.prototype.oG=function(e,i){var n=new t.h,r=new t.h;this.g.Gc(e,n);var s=this.g.U(e);this.g.Gc(s,r);var o=!1;if(n.y<r.y){o=!0;var a=this.hb.nI(e);if(-1==i)var h=this.fb.addElement(a,-1);else h=i,this.fb.Sj(h,a);-1==(a=this.g.Pa(s,this.ro))?this.g.Ra(s,this.ro,h):this.g.Ra(s,this.Rs,h),s=this.g.bd(e),0==this.g.sj(s,this.El)&&this.Wm.add(h)}return s=this.g.Ma(e),this.g.Gc(s,r),n.y<r.y&&(o=!0,a=this.hb.nI(s),-1==i?h=this.fb.addElement(a,-1):(h=i,this.fb.Sj(h,a)),-1==(a=this.g.Pa(s,this.ro))?this.g.Ra(s,this.ro,h):this.g.Ra(s,this.Rs,h),s=this.g.bd(e),0==this.g.sj(s,this.El)&&this.Wm.add(h)),o},n.V=function(t,e,i,r){var s=new n;return s.g=t,s.X=e,s.Gl=i,s.fw=r,s.HQ()},n.prototype.IQ=function(){var e=new t.ia(0),i=new t.ia(0),n=-1,r=-1,s=new t.h;s.Rc();for(var o=-1,a=-1,h=-1,l=new t.h,c=this.Gl.rc(this.Gl.je);-1!=c;c=this.Gl.lb(c)){var u=this.Gl.getData(c);this.g.Gc(u,l);var d=this.g.bd(u);s.qb(l)&&a==d?(-1==r&&(n=this.g.Ky(),r=this.g.Gd()),-1==h&&(h=i.size,this.g.Ra(o,r,h),i.add(1),-1==this.g.sj(d,n)&&(this.g.gr(d,n,o),e.add(d))),this.g.Ra(u,r,h),i.bX(i.Fc()+1)):(h=-1,s.L(l)),o=u,a=d}if(0==e.size)return!1;for(s=new t.ia(0),o=new t.ia(0),a=0,h=e.size;a<h;a++){d=e.get(a);var f=this.g.sj(d,n);for(u=this.g.Pa(f,r),s.clear(!1),o.clear(!1),s.add(f),o.add(u),u=this.g.U(f);u!=f;u=this.g.U(u)){var p=u;if(-1!=(l=this.g.Pa(p,r)))if(0==o.size)o.add(l),s.add(p);else if(o.Fc()==l){c=s.Fc();var g=this.g.U(c);f=this.g.U(p),this.g.Bc(c,f),this.g.Cc(f,c),this.g.Bc(p,g),this.g.Cc(g,p),p=[!1],g=this.g.nG(this.X,g,this.g.Xa(d),p),this.g.Ra(u,r,-1),p[0]&&this.g.Jf(d,f),u=this.g.Ja(d),u-=f=this.g.Ja(g),this.g.Vj(d,u),i.set(l,i.get(l)-1),1==i.get(l)&&(i.set(l,0),o.If(),s.If()),u=f=c}else s.add(u),o.add(l)}}return this.g.CB(n),this.g.Td(r),!0},n}();t.WL=n}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.ig=function(){this.PA=this.sb=null},e.prototype.get=function(){return this.PA},e.prototype.set=function(e){if(this.PA=e,null!=e)throw 322==e.getType()&&(this.sb=e),t.i.Qa()},e.prototype.create=function(e){if(322!=e)throw t.i.fa("Not Implemented");this.Or()},e.prototype.Or=function(){null==this.sb&&(this.sb=new t.yb),this.PA=this.sb},e}();t.ig=e}(X||(X={})),function(t){(t=t.XL||(t.XL={}))[t.enumLineSeg=1]="enumLineSeg",t[t.enumBezierSeg=2]="enumBezierSeg",t[t.enumArcSeg=4]="enumArcSeg",t[t.enumNonlinearSegmentMask=6]="enumNonlinearSegmentMask",t[t.enumSegmentMask=7]="enumSegmentMask",t[t.enumDensified=8]="enumDensified"}(X||(X={})),function(t){var e=function(t){this.$i=t,this.qC=this.rC=1,this.sB=this.rB=this.tB=0},i=function(){function i(){this.Fq=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Bk=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.Bf=new t.Sa,this.qa=this.Cw=0,this.mo=[],this.$s=[],this.yw=[],this.Iq=[],this.MA=[]}return i.prototype.wB=function(t){if(null!=t){for(var e=0,i=t.length;e<i;e++)this.rW(t[e]);t.length=0}},i.prototype.rW=function(t){t.$i=null,this.Iq.push(t)},i.prototype.Ow=function(t){if(0===this.Iq.length)var i=new e(t);else(i=this.Iq[this.Iq.length-1]).$i=t,--this.Iq.length;return i},i.prototype.SR=function(t,e){return 0==t?this.$s[e]:this.yw[e]},i.prototype.aB=function(){this.Cw>=this.MA.length&&this.MA.push(new t.ig);var e=this.MA[this.Cw];return this.Cw++,e},i.prototype.clear=function(){this.wB(this.mo),this.wB(this.$s),this.wB(this.yw),this.Cw=0},i.prototype.Oo=function(t){this.mo.push(this.Ow(t))},i.prototype.ol=function(t){return 0==t?this.$s.length:this.yw.length},i.prototype.Vp=function(t,e){return this.SR(t,e).$i},i.prototype.Ea=function(e,i){if(2!=this.mo.length)throw t.i.Qa();this.qa=e;var n=t.lc.ox(.01*e),r=!1,s=this.mo[0],o=this.mo[1];if(i||5&s.$i.zr(o.$i,e,!0)){if(322==s.$i.getType()){var a=s.$i;if(322==o.$i.getType()){i=o.$i;var h=t.yb.Zx(a,i,null,this.Fq,this.Bk,e);if(0==h)throw t.yb.Zx(a,i,null,this.Fq,this.Bk,e),t.i.Qa();e=Array(9),t.O.$u(e,null);for(var l=0;l<h;l++){var c=this.Fq[l],u=this.Bk[l],d=s.sB,f=1;0==c?(d=s.tB,f=s.rC):1==c&&(d=s.rB,f=s.qC);var p=o.sB,g=1;0==u?(p=o.tB,g=o.rC):1==u&&(p=o.rB,g=o.qC);var v=new t.h;d==p?(d=new t.h,a.hc(c,d),c=new t.h,i.hc(u,c),g/=u=f+g,t.lc.OG(d,c,g,v),t.h.yc(v,d)+t.h.yc(v,c)>n&&(r=!0)):d>p?(a.hc(c,v),c=new t.h,i.hc(u,c),t.h.yc(v,c)>n&&(r=!0)):(i.hc(u,v),d=new t.h,a.hc(c,d),t.h.yc(v,d)>n&&(r=!0)),e[l]=v}for(s=0,o=-1,l=0;l<=h;l++)(g=l<h?this.Fq[l]:1)!=s&&(n=this.aB(),a.ah(s,g,n),-1!=o&&n.get().Dc(e[o]),l!=h&&n.get().Qc(e[l]),s=g,this.$s.push(this.Ow(n.get()))),o=l;for(a=[0,0,0,0,0,0,0,0,0],l=0;l<h;l++)a[l]=l;for(1<h&&this.Bk[0]>this.Bk[1]&&(g=this.Bk[0],this.Bk[0]=this.Bk[1],this.Bk[1]=g,l=a[0],a[0]=a[1],a[1]=l),s=0,o=-1,l=0;l<=h;l++)(g=l<h?this.Bk[l]:1)!=s&&(n=this.aB(),i.ah(s,g,n),-1!=o&&(s=a[o],n.get().Dc(e[s])),l!=h&&(s=a[l],n.get().Qc(e[s])),s=g,this.yw.push(this.Ow(n.get()))),o=l;return r}}throw t.i.Qa()}return!1},i.prototype.Kz=function(e,i,n){if(i.copyTo(this.Bf),1!=this.mo.length)throw t.i.Qa();this.qa=e;var r=this.mo[0];if(n||r.$i.ru(i.D(),e,!0)){if(322!=r.$i.getType())throw t.i.Qa();var s=(e=r.$i).fe(i.D(),!1);this.Fq[0]=s;var o=r.sB;for(n=1,0==s?(o=r.tB,n=r.rC):1==s&&(o=r.rB,n=r.qC),r=new t.h,0==o?(o=new t.h,e.hc(s,o),i=i.D(),t.lc.OG(o,i,1/(n+1),r)):0<o?(r=new t.h,e.hc(s,r)):r=i.D(),n=0,s=-1,o=0;1>=o;o++){if((i=1>o?this.Fq[o]:1)!=n){var a=this.aB();e.ah(n,i,a),-1!=s&&a.get().Dc(r),1!=o&&a.get().Qc(r),n=i,this.$s.push(this.Ow(a.get()))}s=o}this.Bf.Cb(r)}},i}();t.TC=i}(X||(X={})),function(t){var e=function(){function e(e){this.Ds=this.rk=this.sb=null,this.ag=0,this.zm=!1,this.zf=-1,this.Cl=this.Jd=0,this.gb=-1,this.ib=e,this.ag=this.Wx(this.Cl),this.zm=!1,this.rk=null,this.Ds=new t.h}return e.prototype.BW=function(e){if(this.ib!=e.ib)throw t.i.Hb();this.zf=e.zf,this.Jd=e.Jd,this.gb=e.gb,this.Cl=e.Cl,this.ag=e.ag,this.zm=e.zm,this.rk=null},e.prototype.ha=function(){if(this.zf!=this.Jd&&this.BD(),this.zm)this.Jd=(this.Jd+1)%this.ag;else{if(this.Jd==this.ag)throw t.i.ce();this.Jd++}return this.rk},e.prototype.li=function(){if(this.zm)this.Jd=(this.ag+this.Jd-1)%this.ag;else{if(0==this.Jd)throw t.i.ce();this.Jd--}return this.Jd!=this.zf&&this.BD(),this.rk},e.prototype.DW=function(){this.zf=-1,this.Jd=0},e.prototype.EW=function(){this.Jd=this.ag,this.zf=-1},e.prototype.Vb=function(t,e){if(void 0===e&&(e=-1),0<=this.gb&&this.gb<this.ib.da()){var i=this.IM();if(t>=i&&t<this.ib.Vc(this.gb))return this.zf=-1,void(this.Jd=t-i)}e=0<=e&&e<this.ib.da()&&t>=this.ib.Ba(e)&&t<this.ib.Vc(e)?e:this.ib.sz(t),this.Cl=e+1,this.gb=e,this.zf=-1,this.Jd=t-this.ib.Ba(e),this.ag=this.Wx(e),this.ib.Ba(this.gb),this.ib.dc(this.gb)},e.prototype.$a=function(){return this.gb=this.Cl,!(this.gb>=this.ib.da()||(this.zf=-1,this.Jd=0,this.ag=this.Wx(this.gb),this.ib.Ba(this.gb),this.ib.dc(this.gb),this.Cl++,0))},e.prototype.Zi=function(){this.ag=this.Jd=this.zf=-1,this.Cl=0,this.gb=-1},e.prototype.Wx=function(t){if(this.ib.Ac())return 0;var e=1;return this.ib.dc(t)&&(e=0),this.ib.Ja(t)-e},e.prototype.On=function(){return this.zf==this.ag-1&&this.ib.dc(this.gb)},e.prototype.JB=function(){this.zm=!0},e.prototype.wb=function(){return this.ib.nb.o[this.gb]+this.zf},e.prototype.IM=function(){return this.ib.Ba(this.gb)},e.prototype.ik=function(){return this.On()?this.ib.Ba(this.gb):this.wb()+1},e.prototype.vm=function(){return 0==this.zf},e.prototype.Qn=function(){return this.zf==this.ag-1},e.prototype.Ha=function(){return this.Jd<this.ag},e.prototype.Ez=function(){return 0<this.Jd},e.prototype.Of=function(){var t=new e(this.ib);return t.zf=this.zf,t.Jd=this.Jd,t.ag=this.ag,t.gb=this.gb,t.Cl=this.Cl,t.ib=this.ib,t.zm=this.zm,t},e.prototype.BD=function(){if(0>this.Jd||this.Jd>=this.ag)throw t.i.ce();this.zf=this.Jd;var e=this.wb();this.ib.mc();var i=this.ib.Ve,n=1;switch(null!=i&&(n=7&i.read(e)),i=this.ib.description,n){case 1:null==this.sb&&(this.sb=new t.yb),this.rk=this.sb;break;case 2:throw t.i.fa("internal error");default:throw t.i.Qa()}this.rk.Nf(i),n=this.ik(),this.ib.Gc(e,this.Ds),this.rk.Dc(this.Ds),this.ib.Gc(n,this.Ds),this.rk.Qc(this.Ds);for(var r=1,s=i.Aa;r<s;r++)for(var o=i.kd(r),a=t.ra.Va(o),h=0;h<a;h++){var l=this.ib.Uc(o,e,h);this.rk.YB(o,h,l),l=this.ib.Uc(o,n,h),this.rk.OB(o,h,l)}},e.prototype.$S=function(){return this.gb==this.ib.da()-1},e.prototype.Pn=function(){var t=this.ib.VR();return null!=t&&1!=(7&t.read(this.zf))},e}();t.YL=e}(X||(X={})),function(t){var e=function(){function e(e){e instanceof t.aa?(this.xH=e,this.ya=-1,this.Ei=1):(this.vT=e.slice(0),this.ya=-1,this.Ei=e.length)}return e.prototype.La=function(){return this.ya},e.prototype.next=function(){return this.ya<this.Ei-1?(this.ya++,null!=this.xH?this.xH:this.vT[this.ya]):null},e.prototype.qe=function(){},e}();t.Zc=e}(X||(X={})),function(t){var e=function(){this.next=null},i=function(){function i(){this.Tq=this.Kw=this.Lw=0,this.kF=!1,this.gK=0,this.gn=this.Kf=this.Wl=this.Jh=null,this.Ol=0,this.vy=null,this.pl=this.oi=-1}return i.prototype.AX=function(e,i,n){this.oi=e,this.pl=i,this.Jh=this.Wl=null,this.Tq=0,this.vy=n,null==this.gn&&(this.gn=t.O.lg(384,0)),this.nK()},i.prototype.R=function(){return this.oi},i.prototype.ca=function(){return this.pl},i.prototype.flush=function(){0<this.Ol&&(this.vy.gF(this.gn,this.Ol),this.Ol=0)},i.prototype.nK=function(){if(0<this.Tq){for(var t=0;t<this.pl;t++){for(var e=this.Wl[t];null!=e;){var i=e;e=e.next,i.next=null}this.Wl[t]=null}this.Jh=null}this.Lw=this.pl,this.Kw=-1,this.Tq=0},i.prototype.iJ=function(t){for(this.kF=t==i.Cx,t=this.Lw;t<=this.Kw;t++)this.sN(),this.lN(t),this.ZP();this.nK()},i.prototype.jy=function(i,n,r,s){if(n!=s){var o=1;if(n>s&&(o=i,i=r,r=o,o=n,n=s,s=o,o=-1),!(0>s||n>=this.pl)){0>i&&0>r?r=i=-1:i>=this.oi&&r>=this.oi&&(r=i=this.oi);var a=(r-i)/(s-n);s>this.pl&&(r=a*((s=this.pl)-n)+i),0>n&&(i=a*(0-n)+i,n=0);var h=Math.max(this.oi+1,8388607);-8388607>i?(n=(0-i)/a+n,i=0):i>h&&(n=(this.oi-i)/a+n,i=this.oi),-8388607>r?s=(0-i)/a+n:r>h&&(s=(this.oi-i)/a+n),(n=t.O.truncate(n))!=(s=t.O.truncate(s))&&((r=new e).x=t.O.truncate(4294967296*i),r.y=n,r.H=s,r.WP=t.O.truncate(4294967296*a),r.dir=o,null==this.Wl&&(this.Wl=t.O.lg(this.pl,null)),r.next=this.Wl[r.y],this.Wl[r.y]=r,r.y<this.Lw&&(this.Lw=r.y),r.H>this.Kw&&(this.Kw=r.H),this.Tq++)}}},i.prototype.sN=function(){if(null!=this.Jh){for(var t=!1,e=null,i=this.Jh;null!=i;)if(i.y++,i.y==i.H){var n=i;i=i.next,null!=e?e.next=i:this.Jh=i,n.next=null}else i.x+=i.WP,null!=e&&e.x>i.x&&(t=!0),e=i,i=i.next;t&&(this.Jh=this.fK(this.Jh))}},i.prototype.lN=function(t){if(!(t>=this.pl)){var e=this.Wl[t];if(null!=e){this.Wl[t]=null,e=this.fK(e),this.Tq-=this.gK,t=this.Jh;for(var i=!0,n=e,r=null;null!=t&&null!=n;)t.x>n.x?(i&&(this.Jh=n),i=n.next,n.next=t,null!=r&&(r.next=n),r=n,n=i):(i=t.next,t.next=n,null!=r&&(r.next=t),r=t,t=i),i=!1;null==this.Jh&&(this.Jh=e)}}},i.eK=function(t,e){return 0>t?0:t>e?e:t},i.prototype.ZP=function(){if(null!=this.Jh)for(var e=0,n=this.Jh,r=t.O.truncate(t.O.XG(n.x)),s=n.next;null!=s;s=s.next)if(e=this.kF?1^e:e+s.dir,s.x>n.x){var o=t.O.truncate(t.O.XG(s.x));0!=e&&(n=i.eK(r,this.oi),(r=i.eK(o,this.oi))>n&&n<this.oi&&(this.gn[this.Ol++]=n,this.gn[this.Ol++]=r,this.gn[this.Ol++]=s.y,this.Ol==this.gn.length&&(this.vy.gF(this.gn,this.Ol),this.Ol=0))),n=s,r=o}},i.prototype.fK=function(e){for(var n=0,r=e;null!=r;r=r.next)n++;if(this.gK=n,1==n)return e;null==this.Kf?this.Kf=t.O.lg(Math.max(n,16),null):this.Kf.length<n&&(this.Kf=t.O.lg(Math.max(n,2*this.Kf.length),null));var s=0;for(r=e;null!=r;r=r.next)this.Kf[s++]=r;for(2==n?this.Kf[0].x>this.Kf[1].x&&(e=this.Kf[0],this.Kf[0]=this.Kf[1],this.Kf[1]=e):i.AN(this.Kf,n,(function(t,e){return t==e?0:t.x<e.x?-1:t.x>e.x?1:0})),e=this.Kf[0],this.Kf[0]=null,r=e,s=1;s<n;s++)r.next=this.Kf[s],r=this.Kf[s],this.Kf[s]=null;return r.next=null,e},i.AN=function(t,e,i){if(e==t.length)t.sort(i);else{var n=t.slice(0,0),r=t.slice(e);e=t.slice(0,e).sort(i),t.length=0,t.push.apply(t,n.concat(e).concat(r))}},i.Cx=0,i}();t.Px=i}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.ui=function(t,e){var i=this.g.Pa(t,this.Pq);if(this.Dl==i&&(this.Dl=this.oe.lb(this.Dl)),this.ho==i&&(this.ho=this.oe.lb(this.ho)),this.oe.jd(this.RA,i),this.bk(t),e&&-1!=(e=this.g.bd(t))&&this.g.Xa(e)==t){var n=this.g.U(t);if(n!=t){if((i=this.g.bd(n))==e)return void this.g.Jf(e,n);if((n=this.g.Ma(t))!=t&&(i=this.g.bd(n))==e)return void this.g.Jf(e,n)}this.g.Jf(e,-1),this.g.Wg(e,-1)}},e.prototype.pD=function(){for(var e=!1,i=new t.h;;){null==this.Wh?(this.Wh=new t.ia(0),this.zs=new t.ia(0),this.xe=new t.ia(0)):(this.Wh.clear(!1),this.zs.clear(!1),this.xe.clear(!1));for(var n=this.ho,r=0,s=!0;n!=this.Dl;){var o=this.oe.getData(n),a=new t.h;this.g.Gc(o,a),s&&(this.g.Gc(o,i),s=!1),a=this.g.Ma(o);var h=this.g.U(o);-559038737!=this.g.Pa(a,this.zg)&&(this.Wh.add(a),this.g.Ra(a,this.zg,-559038737),this.zs.add(o),this.xe.add(r++)),-559038737!=this.g.Pa(h,this.zg)&&(this.Wh.add(h),this.g.Ra(h,this.zg,-559038737),this.zs.add(o),this.xe.add(r++)),n=this.oe.lb(n)}if(2>this.Wh.size)break;var l=this;for(this.xe.Vd(0,this.xe.size,(function(t,e){return l.pM(t,e)})),n=0,r=this.xe.size;n<r;n++)s=this.xe.get(n),s=this.Wh.get(s),this.g.Ra(s,this.zg,n),a=new t.h,this.g.Gc(s,a);for(a=this.TM(i),n=0,r=this.xe.size;n<r;n++)-1!=(s=this.xe.get(n))&&(s=this.Wh.get(s),this.g.Ra(s,this.zg,-1));if(!a)break;e=!0}return e},e.prototype.TM=function(t){for(var e=!1,i=!0;i;){i=!1;var n=0;-1==this.xe.get(n)&&(n=this.cm(n));for(var r=this.cm(n),s=0,o=this.xe.size;s<o&&-1!=n&&-1!=r&&n!=r;s++){var a=this.xe.get(n);r=this.xe.get(r),a=this.Wh.get(a),r=this.Wh.get(r);var h=this.g.U(a);this.g.Dv(h,t)||(h=this.g.Ma(a));var l=this.g.U(r);this.g.Dv(l,t)||(l=this.g.Ma(r));var c=this.pu(h,a),u=this.pu(l,r),d=c?this.g.Ma(h):this.g.U(h),f=u?this.g.Ma(l):this.g.U(l),p=!1;(this.sp(h)||this.sp(l)||this.sp(a)||this.sp(r)||this.sp(d)||this.sp(f))&&(p=!0),!p&&this.g.fq(a,r)&&(p=!0,this.tD(c,u,h,a,l,r)),!p&&this.g.fq(d,f)&&(p=!0,this.tD(!c,!u,h,d,l,f)),p&&(e=!0),i=i||p,n=this.cm(n),r=this.cm(n)}}if(!e)for(n=0,-1==this.xe.get(n)&&(n=this.cm(n)),r=this.cm(n),s=0,o=this.xe.size;s<o&&-1!=n&&-1!=r&&n!=r;s++)a=this.xe.get(n),r=this.xe.get(r),a=this.Wh.get(a),r=this.Wh.get(r),h=this.g.U(a),this.g.Dv(h,t)||(h=this.g.Ma(a)),l=this.g.U(r),this.g.Dv(l,t)||(l=this.g.Ma(r)),c=this.pu(h,a),u=this.pu(l,r),d=c?this.g.Ma(h):this.g.U(h),f=u?this.g.Ma(l):this.g.U(l),this.DM(c,u,a,h,d,r,l,f)&&(e=!0),n=this.cm(n),r=this.cm(n);return e},e.prototype.XM=function(){1736==this.g.ic(this.X)&&1==this.g.In(this.X)&&(new t.Fg).MU(this.fw,this.g,this.X,this.nd);var e=!1,i=!0;this.zg=this.Pq=-1;var n=this.g.I(this.X),r=new t.ia(0);r.Jb(n);for(var s=this.g.Ob(this.X);-1!=s;s=this.g.Rb(s))for(var o=this.g.Xa(s),a=0,h=this.g.Ja(s);a<h;a++)r.add(o),o=this.g.U(o);var l=this.g.td.o,c=this.g.td.stride;this.g.vb.mc();var u=this.g.vb.za[0].o;for(r.Vd(0,n,(function(t,e){var i=l[c*t],n=l[c*e],r=u[2*i];i=u[2*i+1];var s=u[2*n];return 0==(r=i<(n=u[2*n+1])?-1:i>n?1:r<s?-1:r>s?1:0)&&(r=(t=l[c*t+3])<(e=l[c*e+3])?-1:t==e?0:1),r})),this.Pq=this.g.Gd(),this.oe=new t.jp,this.RA=this.oe.Ph(0),this.oe.fn(n),s=0;s<n;s++)o=r.get(s),a=this.oe.addElement(this.RA,o),this.g.Ra(o,this.Pq,a);for(this.zg=this.g.Gd(),this.Dl=-1,this.cD()&&(e=!0);i;){i=!1,n=0,r=!1;do{r=!1,this.ho=-1,h=0,s=new t.h,a=new t.h;for(var d=this.oe.rc(this.RA);-1!=d;)o=this.oe.getData(d),-1!=this.ho?(this.g.Gc(o,a),s.qb(a)?h++:(s.L(a),this.Dl=d,0<h&&(o=this.pD())&&(r=!0,-1!=this.Dl&&(o=this.oe.getData(this.Dl),this.g.Gc(o,s))),this.ho=d=this.Dl,h=0)):(this.ho=d,this.g.Gc(this.oe.getData(d),s),h=0),-1!=d&&(d=this.oe.lb(d));if(this.Dl=-1,0<h&&(o=this.pD())&&(r=!0),10<n++)throw t.i.Qa();r&&this.GM(),this.cD()&&(r=!0),i=i||r&&!1,e=e||r}while(r)}return this.g.Td(this.Pq),this.g.Td(this.zg),t.WL.V(this.g,this.X,this.oe,this.fw)||e},e.prototype.pu=function(t,e){return this.g.U(e)!=t},e.prototype.DM=function(t,e,i,n,r,s,o,a){if(n==o)return this.bk(i),this.bk(s),!1;var h=this.g.Pa(i,this.zg),l=this.g.Pa(r,this.zg),c=this.g.Pa(s,this.zg),u=this.g.Pa(a,this.zg),d=[0,0,0,0];for((i=[0,0,0,0,0,0,0,0])[0]=0,d[0]=h,i[1]=0,d[1]=l,i[2]=1,d[2]=c,i[3]=1,d[3]=u,h=1;4>h;h++){for(l=d[h],c=i[h],u=h-1;0<=u&&d[u]>l;)d[u+1]=d[u],i[u+1]=i[u],u--;d[u+1]=l,i[u+1]=c}return d=0,0!=i[0]&&(d|=1),0!=i[1]&&(d|=2),0!=i[2]&&(d|=4),0!=i[3]&&(d|=8),(5==d||10==d)&&(t==e?t?(this.g.Bc(a,n),this.g.Cc(n,a),this.g.Bc(r,o),this.g.Cc(o,r)):(this.g.Cc(a,n),this.g.Bc(n,a),this.g.Cc(r,o),this.g.Bc(o,r)):t?(this.g.Cc(n,s),this.g.Bc(s,n),this.g.Cc(o,r),this.g.Bc(r,o)):(this.g.Bc(n,s),this.g.Cc(s,n),this.g.Bc(o,r),this.g.Cc(r,o)),!0)},e.prototype.tD=function(t,e,i,n,r,s){this.MY?this.VM():this.UM(t,e,i,n,r,s)},e.prototype.VM=function(){throw t.i.fa("not implemented.")},e.prototype.UM=function(t,e,i,n,r,s){if(t!=e)t?(this.g.Bc(i,r),this.g.Cc(r,i),this.g.Bc(s,n),this.g.Cc(n,s),this.vn(r,i),this.ui(r,!0),this.g.mi(r,!0),this.bk(i),this.vn(s,n),this.ui(s,!0),this.g.mi(s,!1)):(this.g.Bc(r,i),this.g.Cc(i,r),this.g.Bc(n,s),this.g.Cc(s,n),this.vn(r,i),this.ui(r,!0),this.g.mi(r,!1),this.bk(i),this.vn(s,n),this.ui(s,!0),this.g.mi(s,!0)),this.bk(n);else{var o=t?i:n,a=e?r:s;for(t=t?n:i,e=e?s:r,r=!1,this.g.Bc(o,a),this.g.Bc(a,o),this.g.Cc(t,e),this.g.Cc(e,t),s=e;s!=a;)i=this.g.Ma(s),n=this.g.U(s),this.g.Cc(s,n),this.g.Bc(s,i),r=r||s==o,s=n;r||(i=this.g.Ma(a),n=this.g.U(a),this.g.Cc(a,n),this.g.Bc(a,i)),this.vn(a,o),this.ui(a,!0),this.g.mi(a,!1),this.bk(o),this.vn(e,t),this.ui(e,!0),this.g.mi(e,!1),this.bk(t)}},e.prototype.cD=function(){for(var t=!1,e=this.g.Ob(this.X);-1!=e;){for(var i=this.g.Xa(e),n=0,r=this.g.Ja(e);n<r&&1<r;){var s=this.g.Ma(i),o=this.g.U(i);this.g.fq(s,o)?(t=!0,this.ui(i,!1),this.g.pd(i,!0),this.ui(o,!1),this.g.pd(o,!0),i=s,n=0,r=this.g.Ja(e)):(i=o,n++)}if(2>this.g.Ja(e)){for(t=this.g.Xa(e),n=0,r=this.g.Ja(e);n<r;n++)this.ui(t,!1),t=this.g.U(t);e=this.g.Zq(e),t=!0}else e=this.g.Rb(e)}return t},e.prototype.sp=function(t){for(var e=!1;;){var i=this.g.U(t),n=this.g.Ma(t);if(i==t)return this.ui(t,!0),this.g.mi(t,!1),!0;if(!this.g.fq(i,n))break;if(e=!0,this.bk(n),this.bk(i),this.ui(t,!0),this.g.mi(t,!1),this.vn(i,n),this.ui(i,!0),this.g.mi(i,!0),i==n)break;t=n}return e},e.prototype.GM=function(){for(var t=0,e=this.oe.rc(this.oe.je);-1!=e;e=this.oe.lb(e)){var i=this.oe.getData(e);this.g.aj(i,-1)}for(var n=0,r=this.g.Ob(this.X);-1!=r;)if(-1==(e=this.g.Xa(r))||-1!=this.g.bd(e))i=r,r=this.g.Rb(r),this.g.$q(i);else{this.g.aj(e,r);var s=1;for(i=this.g.U(e);i!=e;i=this.g.U(i))this.g.aj(i,r),s++;this.g.cp(r,!1),this.g.Vj(r,s),this.g.Wg(r,this.g.Ma(e)),n+=s,t++,r=this.g.Rb(r)}for(e=this.oe.rc(this.oe.je);-1!=e;e=this.oe.lb(e))i=this.oe.getData(e),-1==this.g.bd(i)&&(r=this.g.nG(this.X,i,i,null),n+=this.g.Ja(r),t++);for(this.g.Rl(this.X,t),this.g.Tj(this.X,n),t=0,n=this.g.ld;-1!=n;n=this.g.ue(n))t+=this.g.I(n);this.g.bC(t)},e.prototype.cm=function(t){for(var e=0,i=this.xe.size-1;e<i;e++)if(t=(t+1)%this.xe.size,-1!=this.xe.get(t))return t;return-1},e.prototype.vn=function(t,e){var i=this.g.Pa(e,this.Pq),n=this.g.Pa(e,this.zg);this.g.lC(t,e),this.g.Ra(e,this.Pq,i),this.g.Ra(e,this.zg,n)},e.prototype.bk=function(t){var e=this.g.Pa(t,this.zg);-1!=e&&(this.xe.set(e,-1),this.g.Ra(t,this.zg,-1))},e.V=function(t,i,n,r,s){var o=new e;return o.g=t,o.X=i,o.xA=n,o.fw=r,o.nd=s,o.XM()},e.prototype.pM=function(e,i){var n=this.Wh.get(e),r=new t.h;this.g.Gc(n,r),n=new t.h;var s=this.Wh.get(i);return this.g.Gc(s,n),r.qb(n)?0:(s=this.zs.get(e),e=new t.h,this.g.Gc(s,e),s=this.zs.get(i),i=new t.h,this.g.Gc(s,i),(s=new t.h).uc(r,e),(r=new t.h).uc(n,i),t.h.nu(s,r))},e}();t.rn=e}(X||(X={})),function(t){var e;(e=t.$L||(t.$L={}))[e.Local=0]="Local",e[e.Geographic=1]="Geographic",e[e.Projected=2]="Projected",e[e.Image=3]="Image",e[e.Unknown=4]="Unknown",function(t){t[t.Integer32=0]="Integer32",t[t.Integer64=1]="Integer64",t[t.FloatingPoint=2]="FloatingPoint"}(t.TL||(t.TL={}));var i=function(){function e(){this.mA=null,this.pp="",this.su=null,this.dg=0,this.ZH=this.Ho=-1,this.wh=null}return e.prototype.Ec=function(){return this.dg},e.prototype.VF=function(){return 1},e.prototype.VW=function(t){this.mA=t},e.prototype.Xd=function(){if(null!==this.mA)return this.mA;var e=.001;return 0!=this.dg?e=t.wr.CQ(this.dg):null!=this.wh&&(e=t.XC.DQ(this.wh)),e},e.prototype.Bz=function(){return this.wh},e.prototype.Hd=function(){return 0!=this.dg?t.Tc.Zg(t.wr.Sy(this.dg)):null!=this.wh?t.XC.EQ(this.wh):void 0},e.Sb=function(e){if(0!=e.dg){if(!0===t.wr.ZS(e.dg))return 1;if(!0===t.wr.aT(e.dg))return 2}return 4},e.prototype.$r=function(){var e=this.Ec();return-1!=this.Ho?this.Ho:(this.Ho=t.wr.FK(e),-1!=this.Ho?this.Ho:e)},e.create=function(i){if(0>=i)throw t.i.N("Invalid or unsupported wkid: "+i);var n=new e;return n.dg=i,n},e.qP=function(i){if(null==i||0==i.length)throw t.i.N("Cannot create SpatialReference from null or empty text.");var n=new e;return n.wh=i,n},e.prototype.Nb=function(t){return this==t||null!=t&&this.constructor==t.constructor&&this.dg==t.dg&&(0!=this.dg||this.wh===t.wh)},e.prototype.toString=function(){return"[ tol: "+this.Kn()+"; wkid: "+this.Ec()+"; wkt: "+this.Bz()+"]"},e.prototype.cc=function(){if(""!==this.pp)return this.pp;var t=this.toString();if(Array.prototype.reduce)return this.pp="S"+t.split("").reduce((function(t,e){return 0|(t<<5)-t+e.charCodeAt(0)}),0);var e=0;if(0===t.length)return"";for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e&=e;return this.pp="S"+e},e.prototype.Kn=function(){return this.Xd(0)},e.prototype.fh=function(){return null!==this.su?this.su:this.su=t.gu.yP(this)},e.ZN=2147483645,e.$N=9007199254740990,e}();t.Eg=i}(X||(X={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.Ji=null,i.ST=null,i.Hq=new t.ZL,i.Eo=null,i.jw=null,i}return Q(i,e),i.yP=function(e){var n=new i;if(n.dg=e.dg,n.Ho=e.Ho,n.ZH=e.ZH,n.wh=e.wh,""!==n.wh&&null!==n.wh){e=i.kM(n.wh);var r=i.iM(n.wh);n.Hq.Xx(e,r,t.hu.Integer64),n.by(e),n.gy(r),n.dg=e.$r()}else e=i.jM(n.dg),n.by(e),n.gy(null),n.Hq.Xx(e,null,t.hu.Integer64);return n},i.prototype.Xd=function(t){return this.Hq.Kn(t)},i.iM=function(e){if(0>=e.length)throw t.i.N();var n=null;try{n=t.NC.fromString(e)}catch(t){n=null}return null==n?null:i.bD(n,!0)},i.prototype.by=function(t){this.Kd=t,this.Eo=this.Kd.Hd()},i.prototype.gy=function(t){this.KH=t,this.ST=null!=this.KH?this.KH.Eo:null},i.prototype.Wc=function(){return 0!=this.Sb()&&3!=this.Sb()&&this.Kd.Wc()},i.prototype.IG=function(){return 0!=this.Sb()&&(3==this.Sb()?this.Ji.fk().Wc():this.Kd.Wc())},i.prototype.eh=function(){return null!=this.Kd?this.Kd.Ue:null},i.prototype.pm=function(){return this.Kd.pm()},i.prototype.bf=function(){return this.Kd.bf()},i.prototype.hh=function(){return null!=this.Kd?this.Kd.sw:NaN},i.prototype.Up=function(){return this.Kd.Up()},i.prototype.Wr=function(){return this.Kd.Wr()},i.prototype.kk=function(){return this.Kd.kk()},i.prototype.kS=function(e){return t.OC.Py(this.Kd,e.Kd)},i.prototype.ml=function(){return this.Kd.ml()},i.prototype.Vr=function(){return this.Kd.Vr()},i.prototype.zi=function(){return 3==this.Sb()?this.Ji.fk().zi():this.Kd.zi()},i.prototype.gh=function(){if(!this.Wc())throw t.i.N("!isPannable()");var e=new t.l;return this.Kd.gh(e),e},i.prototype.Oe=function(){if(!this.Wc())throw t.i.N("!isPannable()");return this.Kd.so},i.prototype.HR=function(){if(!this.Wc())throw t.i.N("!isPannable()");var e=new t.l;return this.Kd.GR(e),e},i.prototype.pv=function(){if(!this.Wc())throw t.i.N("!isPannable()");return this.Kd.pv()},i.prototype.ov=function(){if(!this.Wc())throw t.i.N("!isPannable()");return this.Kd.ov()},i.prototype.Xr=function(){return null!=this.Ji?this.Ji.fk().Xr():this.Kd.Xr()},i.prototype.PQ=function(){return this.Kd.hv()},i.prototype.Qp=function(){return this.Eo.getUnitFactor()},i.prototype.vz=function(t){return this.Hq.vz(t)},i.prototype.sc=function(){var e=this.Sb();if(1==e)return this;if(3==e)return this.Ji.fk().sc();if(0==e)throw t.i.fa("invalid call");if(4===e)throw t.i.fa("invalid call");if(null!==this.jw)return this.jw;if(null==(e=this.eh().getGeogcs()))throw t.i.Qa();return this.jw=i.bF(e,this.Hq.VF())},i.bF=function(e,n){if(null==e)throw t.i.N("null pointer.");var r=new i;return e=i.mu(e,!0),r.Hq.Xx(e,null,n),r.by(e),r.gy(null),r.dg=e.$r(),r},i.prototype.Sb=function(){var e=this.eh();if(null!=e)switch(e.getType()){case t.Sc.PE_TYPE_GEOGCS:return 1;case t.Sc.PE_TYPE_PROJCS:return 2}return 4},i.prototype.hv=function(){return this.Kd.hv()},i.mu=function(e,n){var r=e.getCode();if(0>=r&&0<(r=t.pf.getCode(e))){if(null==(e=t.pf.coordsys(r)))throw t.i.N("Text to wkid mapping had failed: "+r);return i.mu(e,n)}return n&&0<r&&(n=i.qx[r])?n:(n=t.zb.xv(e,r,!1),i.lK[n]||(e=0>=r?e:t.pf.coordsys(r),e=new t.OC(e),i.lK[n]=e,0<r&&(i.qx[r]=e),e))},i.jM=function(e){if(0>=e)throw t.i.N("Invalid or unsupported wkid: "+e);var n=i.qx[e];if(null!=n)return n;if(null==(n=t.pf.coordsys(e)))throw t.i.N("Invalid or unsupported wkid: "+e);return(n=i.mu(n,!1)).$r()!=e&&(i.qx[e]=n),n},i.kM=function(e){if(null==e||void 0===e||0==e.length)throw t.i.N("Cannot create SpatialReference from null or empty text.");var n=null;try{n=t.pf.fromString(t.Sc.PE_TYPE_COORDSYS,e)}catch(e){throw t.i.N("Cannot create SpatialReference from text. "+e.message)}if(null===n)throw t.i.N("Cannot create SpatialReference from text. ");return i.mu(n,!0)},i.bD=function(e,n){var r,s=e.getCode();if(0>=s&&0<(s=t.pf.getCode(e))){if(null===(s=t.pf.vertcs(s)))throw t.i.N();return i.bD(s,n)}if(n&&0<s&&(n=i.kK[s]))return n;if(e=t.zb.xv(e,s,!1),n=i.mK[e])return n;if(0>=s||(r=t.pf.vertcs(s)),null===r)throw t.i.N();return r=new t.PL(r),i.mK[e]=r,0<s&&(i.kK[s]=r),r},i.sI=function(e,i){if(null===i||i.B())return null;var n=new t.l;if(null!==i&&1!=e.Sb()){var r=e.sc(),s=r.eh();e=t.vr.Nr(e,r,null,null),(i=t.Hx.local().V(i,e,null)).A(n)}else s=e.eh(),i.A(n);return i=s.getPrimem().getLongitude(),s=s.getUnit().getUnitFactor(),new t.LC(n.v,n.G,n.C,n.H,i,s)},i.lD=function(t){var e={name:"",steps:[],_pt:null,_entry:null},i=0;for(t=t.getEntries();i<t.length;i++){var n=t[i],r={LY:!1,ZY:"",YY:-1,geogtran:null};0===n.getDirection()?r.isInverse=!1:r.isInverse=!0;var s=n.getGeogtran().getCode();-1<s?r.wkid=s:r.wkt=n.getGeogtran().toString(),e.steps.push(r)}return e},i.XR=function(e,n,r,s){return void 0===r&&(r=null),r=i.sI(s,r),e=t.lp.getGTlist(e.eh(),n.eh(),2,t.lp.PE_GTLIST_OPTS_COMMON,r,1),n=null,e&&0<e.length&&(n=this.lD(e[0]),t.Mx.destroy(e)),null!==r&&r.destroy(),n},i.YR=function(e,n,r,s){var o;if(void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=30),r=i.sI(s,r),e=t.lp.getGTlist(e.eh(),n.eh(),2,t.lp.PE_GTLIST_OPTS_COMMON,r,o),n=[],e&&0<e.length){for(o=0;o<e.length;o++)n.push(this.lD(e[o]));t.Mx.destroy(e)}return null!==r&&r.destroy(),n},i.qx={},i.lK={},i.kK={},i.mK={},i}(t.Eg);t.gu=e}(X||(X={})),function(t){var e,i;(i=e=t.hu||(t.hu={}))[i.Integer32=0]="Integer32",i[i.Integer64=1]="Integer64",i[i.FloatingPoint=2]="FloatingPoint";var n=function(){function i(){this.qp()}return i.prototype.assign=function(t){this.Fm=t.Fm,this.Gm=t.Gm,this.Pj=t.Pj,this.sA=t.sA,this.Fo=t.Fo,this.rA=t.rA,this.Ik=t.Ik,this.Mq=t.Mq,this.Lq=t.Lq,this.Rm=t.Rm},i.prototype.VF=function(){return this.Rm},i.prototype.qp=function(){this.Gm=this.Fm=0,this.Pj=1,this.sA=0,this.Fo=1,this.rA=0,this.Lq=this.Mq=this.Ik=2220446049250313e-29,this.Rm=e.FloatingPoint},i.prototype.Xx=function(i,n,r){if(this.qp(),this.Rm=r,r!=e.FloatingPoint){var s=new t.l;i.hR(s),this.Fm=s.v,this.Gm=s.G}else this.Gm=this.Fm=-17976931348623157e292;(s=i.Ue.getType())==t.Sc.PE_TYPE_GEOGCS?(s=(r==e.Integer64?1e-9:1/18e5)*i.bf(),this.Pj=1/s):s==t.Sc.PE_TYPE_PROJCS&&(s=(r==e.Integer64?1e-4:.001)*i.pm(),this.Pj=1/s),null!=n?(s=(r==e.Integer32?.001:1e-4)*n.IH,this.Fo=1/s):this.Fo=1e4,this.YM(),this.Ik=i.sw,this.Mq=null!=n?.001*n.IH:.001,this.Lq=2220446049250313e-29},i.prototype.YM=function(){if(this.Rm!=e.FloatingPoint){var i=this.Rm==e.Integer64?t.Eg.$N:t.Eg.ZN,n=i/this.Pj,r=this.Fm+n,s=t.O.truncate((r-this.Fm)*this.Pj);s>i&&(this.Pj=i/(r-this.Fm)),n=this.Gm+n,(s=t.O.truncate((n-this.Gm)*this.Pj))>i&&(this.Pj=i/(n-this.Gm))}},i.prototype.aC=function(t){switch(t){case 0:this.Ik=void 0;case 1:this.Mq=void 0;case 2:this.Lq=void 0}},i.prototype.Kn=function(t){switch(t){case 0:return this.Ik;case 1:return this.Mq;case 2:return this.Lq}return 0},i.prototype.vz=function(t){if(this.Rm==e.FloatingPoint)return 0;switch(t){case 0:return 1/this.Pj;case 1:case 2:return 1/this.Fo;default:return 0}},i.prototype.toString=function(){var t="SRPD [m_toleranceXY: "+this.Ik.toString();return(t=(t=(t=(t=(t=(t=(t=(t=(t=t+";m_falseX: "+this.Fm.toString())+";m_falseY: "+this.Gm.toString())+";m_unitsXY: "+this.Pj.toString())+";m_falseZ: "+this.sA.toString())+";m_unitsZ: "+this.Fo.toString())+";m_falseM: "+this.rA.toString())+";m_toleranceZ: "+this.Mq.toString())+";m_toleranceM: "+this.Lq.toString())+";m_precision: "+this.Rm.toString())+"] "},i}();t.ZL=n}(X||(X={})),function(t){function e(t,e){return 89.99999<e?e=89.99999:-89.99999>e&&(e=-89.99999),e*=.017453292519943,[111319.49079327169*t,3189068.5*Math.log((1+Math.sin(e))/(1-Math.sin(e)))]}function i(t,e,i){return t=t/6378137*57.29577951308232,i?[t,57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*e/6378137)))]:[t-360*Math.floor((t+180)/360),57.29577951308232*(1.5707963267948966-2*Math.atan(Math.exp(-1*e/6378137)))]}function n(e,i,n){var r=e.Of();if(33===e.getType())i=i(r.Lg(),r.ih()),r.Cb(i[0],i[1]);else if(197===e.getType()){var s=i(e.es(),e.gs(),n);i=i(e.ds(),e.fs(),n),r.K(s[0],s[1],i[0],i[1])}else for(s=new t.h,e=0;e<r.I();e++){r.D(e,s);var o=i(s.x,s.y,n);s.ma(o[0],o[1]),r.Cb(e,s)}return r}function r(t){return n(t,i,!0)}function s(t){return n(t,e,!0)}var o=Math.PI/180;t.UK=function(){function e(){}return e.vu=function(e){var i=Math.sqrt(.006694379990197414),n=Math.sin(e.y*o);return t.h.construct(6378137*e.x*o,3167719.6636462314*(n/(1-.006694379990197414*n*n)-1/(2*i)*Math.log((1-i*n)/(1+i*n))))},e.Vx=function(e,i,n,r){var s=1/298.257223563,a=Math.sin(n);n=Math.cos(n);var h=(1-s)*Math.tan(e),l=h*(e=1/Math.sqrt(1+h*h)),c=Math.atan2(h,n),u=(h=e*a)*h,d=1-u,f=272331606107.54688*d/40408299984661.45,p=1+f/16384*(4096+f*(f*(320-175*f)-768)),g=f/1024*(256+f*(f*(74-47*f)-128));f=r/(6356752.31424518*p);for(var v,m,y,_=2*Math.PI;1e-12<Math.abs(f-_);)y=Math.cos(2*c+f),_=f,f=r/(6356752.31424518*p)+g*(v=Math.sin(f))*(y+g/4*((m=Math.cos(f))*(2*y*y-1)-g/6*y*(4*v*v-3)*(4*y*y-3)));return r=l*v-e*m*n,d=s/16*d*(4+s*(4-3*d)),t.h.construct((i+(Math.atan2(v*a,e*m-l*v*n)-(1-d)*s*h*(f+d*v*(y+d*m*(2*y*y-1)))))/o,Math.atan2(l*m+e*v*n,(1-s)*Math.sqrt(u+r*r))/o)},e.MM=function(t,e,i,n){var r=1/298.257223563,s=n-e,o=Math.atan((1-r)*Math.tan(t)),a=Math.atan((1-r)*Math.tan(i)),h=Math.sin(o);o=Math.cos(o);var l=Math.sin(a);a=Math.cos(a);var c=s,u=1e3;do{var d=Math.sin(c),f=Math.cos(c),p=Math.sqrt(a*d*a*d+(o*l-h*a*f)*(o*l-h*a*f));if(0===p)return 0;f=h*l+o*a*f;var g=Math.atan2(p,f),v=o*a*d/p,m=1-v*v;d=f-2*h*l/m,isNaN(d)&&(d=0);var y=r/16*m*(4+r*(4-3*m)),_=c;c=s+(1-y)*r*v*(g+y*p*(d+y*f*(2*d*d-1)))}while(1e-12<Math.abs(c-_)&&0<--u);return 0===u?(h=n-e,{azimuth:Math.atan2(Math.sin(h)*Math.cos(i),Math.cos(t)*Math.sin(i)-Math.sin(t)*Math.cos(i)*Math.cos(h)),geodesicDistance:6371008.771415059*Math.acos(Math.sin(t)*Math.sin(i)+Math.cos(t)*Math.cos(i)*Math.cos(n-e))}):(e=(t=272331606107.54688*m/40408299984661.45)/1024*(256+t*(t*(74-47*t)-128)),{azimuth:Math.atan2(a*Math.sin(c),o*l-h*a*Math.cos(c)),YQ:6356752.31424518*(1+t/16384*(4096+t*(t*(320-175*t)-768)))*(g-e*p*(d+e/4*(f*(2*d*d-1)-e/6*d*(4*p*p-3)*(4*d*d-3)))),XY:Math.atan2(o*Math.sin(c),o*l*Math.cos(c)-h*a)})},e.jQ=function(e){var i=e.hasAttribute(1),n=e.hasAttribute(2),r=[],s=e.da(),o=null,a=null;i&&(o=e.ub(1)),n&&(a=e.ub(2));for(var h=new t.h,l=0;l<s;l++){for(var c=e.Ba(l),u=e.Ja(l),d=0,f=0,p=NaN,g=NaN,v=NaN,m=NaN,y=e.dc(l),_=[],b=c;b<c+u;b++){e.D(b,h),m=v=NaN;var w=[h.x,h.y];i&&(v=o.get(b),w.push(v)),n&&(s=a.get(b),w.push(m)),b==c&&y&&(d=h.x,f=h.y,p=v,g=m),_.push(w)}!y||d==h.x&&f==h.y&&(!i||isNaN(p)&&isNaN(v)||p==v)&&(!n||isNaN(g)&&isNaN(m)||g==m)||_.push(_[0].slice(0)),r.push(_)}return r},e.Wy=function(t,i){t=e.jQ(t),637.100877141506>i&&(i=637.100877141506);for(var n,r=[],s=0;s<t.length;s++){var a,h,l=t[s];r.push(n=[]),n.push([l[0][0],l[0][1]]);var c=l[0][0]*o,u=l[0][1]*o;for(a=0;a<l.length-1;a++){var d=l[a+1][0]*o,f=l[a+1][1]*o;if(c!==d||u!==f){d=(f=e.MM(u,c,f,d)).azimuth;var p=(f=f.YQ)/i;if(1<p){for(h=1;h<=p-1;h++){var g=e.Vx(u,c,d,h*i);n.push([g.x,g.y])}h=e.Vx(u,c,d,(f+Math.floor(p-1)*i)/2),n.push([h.x,h.y])}u=e.Vx(u,c,d,f),n.push([u.x,u.y]),c=u.x*o,u=u.y*o}}}return{qJ:r}},e.XQ=function(i){for(var n=[],r=0;r<i.length;r++){var s=i[r];s=e.Wy(s,1e4),n.push(s)}i=[];for(var o=0;o<n.length;o++){s=n[o];var a=0;for(r=0;r<s.qJ.length;r++){var h,l=s.qJ[r],c=e.vu(t.h.construct(l[0][0],l[0][1])),u=e.vu(t.h.construct(l[l.length-1][0],l[l.length-1][1])),d=u.x*c.y-c.x*u.y;for(h=0;h<l.length-1;h++)c=e.vu(t.h.construct(l[h+1][0],l[h+1][1])),d+=(u=e.vu(t.h.construct(l[h][0],l[h][1]))).x*c.y-c.x*u.y;a+=d}a/=1,i.push(a/-2)}return i},e}(),t.cb=function(){function e(){}return e.xB=function(t,i,n,r,s,o,a){e.gD[t.cc()]=i,0==isNaN(n)&&(e.mD[t.cc()]=n),0==isNaN(r)&&(e.zD[t.cc()]=r),0==isNaN(s)&&(e.aD[t.cc()]=s),e.nD[t.cc()]=o,null!==a&&(e.oD[t.cc()]=a)},e.Ww=function(t,i,n){e.sD[t.cc()+"-"+i.cc()]=n},e.sc=function(i){if(null==(i=e.gD[i.cc()]))throw t.i.Ie();return i},e.bf=function(i){if(null==(i=e.mD[i.cc()]))throw t.i.Ie();return i},e.vv=function(i){if(null==(i=e.zD[i.cc()]))throw t.i.Ie();return i},e.ev=function(i){if(null==(i=e.aD[i.cc()]))throw t.i.Ie();return i},e.gh=function(i){if(null==(i=e.oD[i.cc()]))throw t.i.Ie();return t.l.construct(i[0],i[1],i[2],i[3])},e.Wc=function(i){if(null==(i=e.nD[i.cc()]))throw t.i.Ie();return i},e.zh=function(i,n,r){if(n.Nb(r))return i;var s=e.sD[n.cc()+"-"+r.cc()];if(void 0!==s)return s(i,n,r);throw t.i.Ie()},e.vt=function(){throw t.i.Ie()},e.bR=function(){throw t.i.Ie()},e.dW=function(){throw t.i.Ie()},e.ml=function(){throw t.i.Ie()},e.sW=function(){var e=t.Eg.create(102100),i=t.Eg.create(3857),n=t.Eg.create(4326);t.cb.xB(e,n,NaN,NaN,NaN,!1,null),t.cb.xB(n,n,1,.0033528106647474805,6378137,!0,[-180,-90,180,90]),t.cb.xB(i,n,NaN,NaN,NaN,!1,null),t.cb.Ww(e,n,r),t.cb.Ww(n,e,s),t.cb.Ww(i,n,r),t.cb.Ww(n,i,s)},e.gD=[],e.mD=[],e.zD=[],e.aD=[],e.nD=[],e.oD=[],e.sD=[],e}()}(X||(X={})),X.cb.sW(),function(t){var e=function(){function e(t){this.o=new Int32Array(0),this.io=-1,this.Hg=this.size=this.Bl=0,this.stride=t}return e.prototype.jd=function(t){t<this.Bl?(this.o[t*this.stride]=this.io,this.io=t):this.Bl--,this.size--},e.prototype.T=function(t,e){return this.o[t*this.stride+e]},e.prototype.S=function(t,e,i){this.o[t*this.stride+e]=i},e.prototype.Ce=function(){var e=this.io;if(-1==e){if(this.Bl==this.Hg){if(2147483647<(e=0!=this.Hg?t.O.truncate(3*(this.Hg+1)/2):1)&&(e=2147483647),e==this.Hg)throw t.i.ce();this.Dz(e)}e=this.Bl,this.Bl++}else this.io=this.o[e*this.stride];this.size++;for(var i=e*this.stride;i<e*this.stride+this.stride;i++)this.o[i]=-1;return e},e.prototype.Ll=function(e){var i=this.io;if(-1==i){if(this.Bl==this.Hg){if(2147483647<(i=0!=this.Hg?t.O.truncate(3*(this.Hg+1)/2):1)&&(i=2147483647),i==this.Hg)throw t.i.ce();this.Dz(i)}i=this.Bl,this.Bl++}else this.io=this.o[i*this.stride];this.size++;for(var n=i*this.stride,r=0;r<e.length;r++)this.o[n+r]=e[r];return i},e.prototype.mj=function(t){this.io=-1,this.size=this.Bl=0,t&&(this.o=null,this.Hg=0)},e.prototype.De=function(t){t>this.Hg&&this.Dz(t)},e.prototype.tx=function(t,e){t*=this.stride,e*=this.stride;for(var i=0;i<this.stride;i++){var n=this.o[e+i];this.o[e+i]=this.o[t+i],this.o[t+i]=n}},e.prototype.gC=function(t,e,i){var n=this.o[this.stride*e+i];this.o[this.stride*e+i]=this.o[this.stride*t+i],this.o[this.stride*t+i]=n},e.LG=function(t){return 0<=t},e.prototype.Dz=function(t){null==this.o&&(this.o=new Int32Array(0));var e=new Int32Array(this.stride*t);e.set(this.o,0),this.o=e,this.Hg=t},e}();t.$c=e}(X||(X={})),function(t){var e,i;(i=e||(e={}))[i.enumInputModeBuildGraph=0]="enumInputModeBuildGraph",i[i.enumInputModeSimplifyAlternate=4]="enumInputModeSimplifyAlternate",i[i.enumInputModeSimplifyWinding=5]="enumInputModeSimplifyWinding",i[i.enumInputModeIsSimplePolygon=7]="enumInputModeIsSimplePolygon";var n=function(){function e(e){this.Be=e,this.yh=NaN,this.eH=new t.ig,this.fH=new t.ig,this.ms=new t.Nc,this.ns=new t.Nc}return e.prototype.compare=function(t,e,i){if(t=t.ja(i),this.Be.pB(e,this.eH),this.Be.pB(t,this.fH),e=this.eH.get(),t=this.fH.get(),this.ms.K(e.sa,e.pa),this.ns.K(t.sa,t.pa),this.ms.va<this.ns.oa)return-1;if(this.ms.oa>this.ns.va)return 1;i=e.na==e.la;var n=t.na==t.la;if(i||n){if(i&&n)return 0;if(e.na==t.na&&e.sa==t.sa)return i?1:-1;if(e.la==t.la&&e.pa==t.pa)return i?-1:1}return(i=e.Pe(this.yh,this.ms.oa))==(n=t.Pe(this.yh,this.ns.oa))&&((n=.5*((i=Math.min(e.la,t.la))+this.yh))==this.yh&&(n=i),i=e.Pe(n,this.ms.oa),n=t.Pe(n,this.ns.oa)),i<n?-1:i>n?1:0},e.prototype.aK=function(t){this.yh=t},e}(),r=function(){function e(e){this.ib=e,this.WH=new t.ig,this.Bf=new t.h,this.wA=new t.Nc}return e.prototype.kX=function(t){this.Bf.L(t)},e.prototype.compare=function(t,e){return this.ib.pB(t.ja(e),this.WH),t=this.WH.get(),this.wA.K(t.sa,t.pa),this.Bf.x<this.wA.oa?-1:this.Bf.x>this.wA.va?1:(t=t.Pe(this.Bf.y,this.Bf.x),this.Bf.x<t?-1:this.Bf.x>t?1:0)},e}();e=function(){function e(){this.hH=this.Di=this.Gi=this.kA=this.Yn=this.ye=this.Kc=this.jh=this.ge=null,this.Go=this.xg=-1,this.gH=!0,this.pA=!1,this.lA=NaN,this.Ni=new t.Md,this.bO=2147483647,this.aO=t.O.truncate(-2147483648),this.cg=this.ae=this.Hl=this.Cq=this.Cm=this.Bq=this.Os=this.Re=-1,this.wa=0}return e.prototype.yy=function(t){this.lA=t},e.prototype.Ym=function(){null==this.ge&&(this.ge=new t.$c(8));var e=this.ge.Ce();return this.ge.S(e,1,0),e},e.prototype.vU=function(){null==this.Kc&&(this.Kc=new t.$c(8));var e=this.Kc.Ce();this.Kc.S(e,2,0),this.Kc.S(e,3,0);var i=this.Kc.Ce();return this.Kc.S(i,2,0),this.Kc.S(i,3,0),this.JJ(e,i),this.JJ(i,e),e},e.prototype.mI=function(){null==this.ye&&(this.ye=new t.$c(8));var e=this.ye.Ce();return this.ye.S(e,2,0),e},e.prototype.TW=function(t,e){this.ge.S(t,7,e)},e.prototype.mn=function(t,e){this.ge.S(t,2,e)},e.prototype.SW=function(t,e){this.ge.S(t,1,e)},e.prototype.lX=function(t,e){this.ge.S(t,3,e)},e.prototype.iX=function(t,e){this.ge.S(t,4,e)},e.prototype.cr=function(t,e){this.ge.S(t,5,e)},e.prototype.eR=function(t){return this.ge.T(t,5)},e.prototype.RW=function(t,e){this.ge.S(t,6,e)},e.prototype.cN=function(t,e){this.RW(e,t)},e.prototype.IJ=function(t,e){this.Kc.S(t,1,e)},e.prototype.JJ=function(t,e){this.Kc.S(t,4,e)},e.prototype.Tl=function(t,e){this.Kc.S(t,5,e)},e.prototype.Sl=function(t,e){this.Kc.S(t,6,e)},e.prototype.$W=function(t,e){this.Kc.S(t,2,e)},e.prototype.$w=function(t,e){this.Kc.S(t,3,e)},e.prototype.LF=function(t){return this.Kc.T(t,3)},e.prototype.Gt=function(t,e){this.Kc.S(t,7,e)},e.prototype.EK=function(t,e){if(-1!=this.mm(t))for(e=e?-1:t,t=this.mm(t);-1!=t;t=this.js(t))this.g.Ra(this.tj(t),this.Cq,e)},e.prototype.yx=function(t,e){-1!=t&&(this.EK(t,e),this.EK(this.xa(t),e))},e.prototype.Dt=function(t,e){this.ye.S(t,1,e)},e.prototype.Vg=function(t,e){this.ye.S(t,2,e)},e.prototype.jn=function(t,e){this.ye.S(t,3,e),this.NW(t,this.dR(e)),this.MW(e,t)},e.prototype.MW=function(t,e){this.ye.S(t,4,e)},e.prototype.NW=function(t,e){this.ye.S(t,5,e)},e.prototype.DJ=function(t,e){this.ye.S(t,6,e)},e.prototype.BJ=function(t,e){this.ye.S(t,7,e)},e.prototype.AJ=function(t,e){this.Yn.write(t,e)},e.prototype.CJ=function(t,e){this.kA.write(t,e)},e.prototype.kY=function(e){var i=0,n=0,r=this.AF(e),s=new t.h,o=new t.h,a=new t.h;this.Yr(r,s),o.L(s);var h=r;do{this.lm(h,a),n+=t.h.tb(o,a),this.$e(this.xa(h))!=e&&(i+=(a.x-s.x-(o.x-s.x))*(a.y-s.y+(o.y-s.y))*.5),o.L(a),h=this.jc(h)}while(h!=r);this.Yn.write(e,i),this.kA.write(e,n)},e.prototype.PU=function(e,i){var s=new n(this),o=new t.Yj;o.De(t.O.truncate(this.wa/2)),o.Vo(s);for(var a=new t.ia(0),h=this.$g(),l=null,c=0,u=new t.h,d=this.Re;-1!=d;d=this.Rf(d)){if(!(255&++c||null==i||i.progress(-1,-1)))throw t.i.WC();var f=this.Me(d);if(-1!=f){if(a.Bh(0),!this.gY(o,h,a,f)){this.D(d,u),s.aK(u.y);var p=f;do{var g=this.Ab(p,h);-1!=g&&(o.vd(g,-1),this.Kb(p,h,-2)),p=this.jc(this.xa(p))}while(f!=p);p=f;do{-1==(g=this.Ab(p,h))&&(g=o.addElement(p,-1),a.add(g)),p=this.jc(this.xa(p))}while(f!=p)}for(f=a.size-1;0<=f;f--)g=a.get(f),p=o.ja(g),this.Kb(this.xa(p),h,g),this.OU(o,g,e)}else-1==this.cz(d)&&(null==l&&(l=new r(this)),this.D(d,u),l.kX(u),p=o.IW(l),f=this.Hl,-1!=p&&(g=o.ja(p),this.$e(g)==this.$e(this.xa(g))&&(g=this.OF(o,p)),-1!=g&&(f=this.$e(g))),this.cN(f,d))}this.Jg(h)},e.prototype.OU=function(t,e,i){var n=t.ja(e),r=this.$e(n);if(-1==this.Gn(r)){var s=this.OF(t,e),o=this.xa(n),a=this.$e(o);this.Kp(r),this.Kp(a);var h=this.Gn(r),l=this.Gn(a);if(-1==s&&-1==h&&(a==r?(this.jn(a,this.Hl),h=l=this.Hl):(-1==l&&(this.jn(a,this.Hl),l=this.Hl),this.jn(r,a),h=a)),-1!=s){var c=this.$e(s);-1==l&&(0>=this.Kp(c)?(l=this.Gn(c),this.jn(a,l)):(this.jn(a,c),l=c),a==r&&(h=l))}-1==h&&this.hY(r,a),0==i?this.jW(t,e,n,s,r,a):5==i?this.kW(t,e,n,o,r,a):4==i&&this.iW(n,s,r,a)}},e.prototype.jW=function(t,e,i,n,r,s){var o=this.hk(r);if(-1!=n){var a=this.hk(s),h=this.hk(this.$e(n));n=o&a&h,h^=h&this.dh(i),0!=(h|=n)&&(this.Vg(s,a|h),this.Vg(r,h|o),o=o||h)}for(e=t.lb(e);-1!=e&&(n=t.ja(e),i=this.$e(this.xa(n)),r=this.hk(i),s=this.dh(n),a=this.$e(n),n=r&(h=this.hk(a))&o,o^=o&s,0!=(o|=n));e=t.lb(e))this.Vg(i,r|o),this.Vg(a,h|o)},e.prototype.kW=function(e,i,n,r,s,o){if(s!=o){n=this.Ab(n,this.cg),n+=this.Ab(r,this.cg),r=0;var a=new t.ia(0),h=new t.ia(0);h.add(0);for(var l=e.rc(-1);l!=i;l=e.lb(l)){var c=e.ja(l),u=this.xa(c),d=this.$e(c),f=this.$e(u);if(d!=f){if(c=this.Ab(c,this.cg),r+=c+=this.Ab(u,this.cg),u=!1,0!=a.size&&a.Fc()==f&&(h.If(),a.If(),u=!0),-1==this.Gn(f))throw t.i.Qa();u&&this.Gn(f)==d||(h.add(r),a.add(d))}}r+=n,0!=a.size&&a.Fc()==o&&(h.If(),a.If()),0!=r?0==h.Fc()&&(e=this.g.ld,e=this.La(e),this.Vg(s,e)):0!=h.Fc()&&(e=this.g.ld,e=this.La(e),this.Vg(s,e))}},e.prototype.iW=function(t,e,i,n){var r=this.La(this.g.ld);if(-1==e)this.Vg(n,this.Go),1&(t=this.Ab(t,this.xg))?this.Vg(i,r):this.Vg(i,this.Go);else{var s=this.hk(n);0==s?(s=this.hk(this.$e(e)),this.Vg(n,s),1&(t=this.Ab(t,this.xg))?this.Vg(i,s==r?this.Go:r):this.Vg(i,s)):1&(t=this.Ab(t,this.xg))?this.Vg(i,s==r?this.Go:r):this.Vg(i,s)}},e.prototype.gY=function(t,e,i,n){var r=n,s=-1,o=-1,a=0;do{if(2==a)return!1;var h=this.Ab(r,e);if(-1!=h){if(-1!=s)return!1;s=h}else{if(-1!=o)return!1;o=r}a++,r=this.jc(this.xa(r))}while(n!=r);return-1!=o&&-1!=s&&(this.Kb(t.ja(s),e,-2),t.Sj(s,o),i.add(s),!0)},e.prototype.hY=function(t,e){var i=this.Kp(t);if(0!=i){var n=this.Kp(e);(0<i&&0>n||0>i&&0<n||-1!=(e=this.Gn(e)))&&this.jn(t,e)}},e.prototype.vP=function(e,i){this.Cq=this.g.Gd();for(var n=0,r=i.size;n<r;n++){var s=i.get(n),o=this.g.Pa(s,this.Cm),a=this.g.Qf(this.g.bd(s)),h=this.g.ic(a);if(t.aa.Hc(h)){var l=this.g.U(s);if(-1!=l){var c=this.g.Pa(l,this.Cm);if(o!=c){var u=this.vU(),d=this.xa(u),f=this.jh.Ce();this.jh.S(f,0,s),this.jh.S(f,1,-1),this.Gt(u,f),this.IJ(u,o),-1==(f=this.Me(o))?(this.mn(o,u),this.Tl(u,d),this.Sl(d,u)):(o=this.te(f),this.Tl(f,d),this.Sl(d,f),this.Sl(o,u),this.Tl(u,o)),this.IJ(d,c),-1==(o=this.Me(c))?(this.mn(c,d),this.Sl(u,d),this.Tl(d,u)):(c=this.te(o),this.Tl(o,u),this.Sl(u,o),this.Sl(c,d),this.Tl(d,c)),a=this.La(a),0==e?(this.Kb(d,this.ae,0),this.Kb(u,this.ae,1736==h?a:0)):5==e?(c=new t.h,this.g.D(s,c),s=new t.h,this.g.D(l,s),o=l=0,0>c.compare(s)?l=1:o=-1,this.Kb(d,this.ae,0),this.Kb(u,this.ae,0),this.Kb(u,this.cg,l),this.Kb(d,this.cg,o)):7==e?(this.Kb(d,this.ae,this.Go),this.Kb(u,this.ae,1736==h?a:0)):4==e&&(this.Kb(d,this.ae,0),this.Kb(u,this.ae,0),this.Kb(u,this.xg,1),this.Kb(d,this.xg,1)),h=1736==h?this.aO:0,this.$w(u,a|h),this.$w(d,a|h)}}}}},e.prototype.VT=function(t,e){var i=this.mm(e);if(-1!=i){var n=this.mm(t);this.jh.S(i,1,n),this.Gt(t,i),this.Gt(e,-1)}t=this.xa(t),e=this.xa(e),-1!=(i=this.mm(e))&&(n=this.mm(t),this.jh.S(i,1,n),this.Gt(t,i),this.Gt(e,-1))},e.prototype.IX=function(e){function i(t,e){return r.HO(t,e)}var n=new t.ia(0);n.Jb(10);for(var r=this,s=this.Re;-1!=s;s=this.Rf(s)){n.clear(!1);var o=this.Me(s);if(-1!=o){var a=o;do{n.add(a),a=this.jc(this.xa(a))}while(a!=o);if(1<n.size){if(a=!0,2<n.size)n.Vd(0,n.size,i),n.add(n.get(0));else if(0<this.GO(n.get(0),n.get(1))){var h=n.get(0);n.set(0,n.get(1)),n.set(1,h)}else a=!1;for(var l=h=n.get(0),c=this.uf(l),u=this.xa(l),d=-1,f=1,p=n.size;f<p;f++){var g=n.get(f),v=this.xa(g),m=this.jk(v);if(m==c&&g!=l){if(0==e)d=this.LF(l)|this.LF(g),this.$w(l,d),this.$w(u,d),this.Kb(l,this.ae,this.Ab(l,this.ae)|this.Ab(g,this.ae)),this.Kb(u,this.ae,this.Ab(u,this.ae)|this.Ab(v,this.ae));else if(-1!=this.cg)d=this.Ab(l,this.cg)+this.Ab(g,this.cg),v=this.Ab(u,this.cg)+this.Ab(v,this.cg),this.Kb(l,this.cg,d),this.Kb(u,this.cg,v);else{if(7==e)return void(this.Ni=new t.Md(5,s,-1));-1!=this.xg&&(d=this.Ab(l,this.xg)+this.Ab(g,this.xg),v=this.Ab(u,this.xg)+this.Ab(v,this.xg),this.Kb(l,this.xg,d),this.Kb(u,this.xg,v))}this.VT(l,g),this.Ly(g),d=l,n.set(f,-1),g==h&&(n.set(0,-1),h=-1)}else this.yx(d,!1),d=-1,l=g,c=m,u=v}if(this.yx(d,!1),d=-1,a){for(h=-1,f=0,p=n.size;f<p;f++)if(-1!=(g=n.get(f)))if(-1==h)l=h=g,c=this.uf(l),u=this.xa(l);else if(g!=l&&(v=this.xa(g),m=this.jk(v),this.Sl(u,g),this.Tl(g,u),l=g,c=m,u=v,7==e&&(this.Ab(g,this.ae)|this.Ab(this.te(g),this.ae))==(1|this.Go)))return void(this.Ni=new t.Md(5,s,-1));this.mn(s,h)}else{for(h=-1,f=0,p=n.size;f<p;f++)if(-1!=(g=n.get(f))){h=g;break}o!=h&&this.mn(s,h)}}}}},e.prototype.WN=function(){for(var e=-1,i=this.$g(),n=this.Re;-1!=n;n=this.Rf(n)){var r=this.Me(n);if(-1!=r){var s=r;do{if(1!=this.Ab(s,i)){var o=this.mI();this.Dt(o,s),this.BJ(o,e),-1!=e&&this.DJ(e,o),e=o;var a=0,h=s;do{a|=this.Ab(h,this.ae),this.$W(h,o),this.Kb(h,i,1),h=this.jc(h)}while(h!=s);this.Vg(o,a)}s=this.jc(this.xa(s))}while(s!=r)}}o=this.mI(),this.Dt(o,-1),this.BJ(o,e),-1!=e&&this.DJ(e,o),this.Hl=o,this.Yn=t.be.qf(this.ye.size,NaN),this.kA=t.be.qf(this.ye.size,NaN),this.AJ(this.Hl,1/0),this.CJ(this.Hl,1/0),this.Jg(i)},e.prototype.sR=function(t,e,i){if(-1==(e=-1!=e?e:this.Me(t)))return-1;for(t=e;;){if(1!=this.Ab(e,i))return e;if((e=this.jc(this.xa(e)))==t)return-1}},e.prototype.yW=function(){for(var t=this.$g(),e=this.Re;-1!=e;e=this.Rf(e))for(var i=-1;;){var n=this.sR(e,i,t);if(-1==n)break;i=this.jc(this.xa(n));for(var r=n;;){var s=this.jc(r),o=this.te(r),a=this.xa(r);if(o==a){if(this.IP(r),i!=r&&i!=a||(i=-1),r==n||o==n){if(r==(n=s)||o==n)break;r=s;continue}}else this.Kb(r,t,1);if((r=s)==n)break}}this.Jg(t)},e.prototype.MB=function(e,i,n,r,s){this.Ug(),this.gH=s,this.g=e,this.Bq=this.g.aF(),(e=new t.ia(0)).Jb(null!=n?this.g.I(n.get(0)):this.g.fd);var o=0,a=1,h=null!=n?n.get(0):this.g.ld;for(s=1;-1!=h;){this.g.HJ(h,this.Bq,a),a<<=1;for(var l=this.g.Ob(h);-1!=l;l=this.g.Rb(l))for(var c=this.g.Xa(l),u=0,d=this.g.Ja(l);u<d;u++)e.add(c),c=this.g.U(c);t.aa.Rn(this.g.ic(h))||(o+=this.g.da(h)),null!=n?(h=s<n.size?n.get(s):-1,s++):h=this.g.ue(h)}for(this.Go=a,this.wa=e.size,this.g.nx(e,this.wa),null==this.jh&&(this.jh=new t.$c(2),this.ge=new t.$c(8),this.Kc=new t.$c(8),this.ye=new t.$c(8)),this.jh.De(this.wa),t.mp.zp(r),this.ge.De(this.wa+10),this.Kc.De(2*this.wa+32),this.ye.De(Math.max(32,o)),this.Cm=this.g.Gd(),n=new t.h,s=0,o=new t.h,n.Rc(),a=0;a<=this.wa;a++)if(a<this.wa?(c=e.get(a),this.g.D(c,o)):o.Rc(),!n.qb(o)){if(s<a){for(c=this.Ym(),d=u=-1;s<a;s++)d=e.get(s),this.g.Ra(d,this.Cm,c),h=this.jh.Ce(),this.jh.S(h,0,d),this.jh.S(h,1,u),u=h,l=this.g.bd(d),h=this.g.Qf(l),h=this.La(h),this.SW(c,this.xd(c)|h);this.TW(c,u),this.cr(c,this.g.Ua(d)),-1!=this.Os&&this.iX(this.Os,c),this.lX(c,this.Os),this.Os=c,-1==this.Re&&(this.Re=c)}s=a,n.L(o)}t.mp.zp(r),this.ae=this.$g(),5==i&&(this.cg=this.$g()),4==i&&(this.xg=this.$g()),this.vP(i,e),0==this.Ni.Jj&&(this.IX(i),0==this.Ni.Jj&&(isNaN(this.lA)||this.xO()?(this.WN(),0==this.Ni.Jj&&(this.Jg(this.ae),this.ae=-1,this.gH&&this.PU(i,r))):this.pA=!0))},e.prototype.Ly=function(t){var e=this.jc(t),i=this.te(t),n=this.xa(t),r=this.jc(n),s=this.te(n);e!=n&&(this.Sl(s,e),this.Tl(e,s)),i!=n&&(this.Sl(i,r),this.Tl(r,i)),i=this.jk(t),this.Me(i)==t&&(r!=t?this.mn(i,r):this.mn(i,-1)),r=this.jk(n),this.Me(r)==n&&(e!=n?this.mn(r,e):this.mn(r,-1)),this.Kc.jd(t),this.Kc.jd(n)},e.prototype.OF=function(t,e){for(;;){if(-1==(e=t.we(e)))return-1;var i=t.ja(e);if(this.$e(i)!=this.$e(this.xa(i)))return i}},e.prototype.dr=function(t,e){var i;void 0===i&&(i=!0),this.MB(t,0,null,e,i)},e.prototype.vJ=function(e,i,n){var r=new t.ia(0);r.add(i),this.MB(e,4,r,n,1736==e.ic(i))},e.prototype.wJ=function(e,i,n){var r=new t.ia(0);r.add(i),this.MB(e,5,r,n,!0)},e.prototype.Ug=function(){null!=this.g&&(-1!=this.Bq&&(this.g.xW(this.Bq),this.Bq=-1),-1!=this.Cm&&(this.g.Td(this.Cm),this.Cm=-1),-1!=this.Cq&&(this.g.Td(this.Cq),this.Cq=-1),-1!=this.ae&&(this.Jg(this.ae),this.ae=-1),-1!=this.cg&&(this.Jg(this.cg),this.cg=-1),-1!=this.xg&&(this.Jg(this.xg),this.xg=-1),this.g=null,this.ge.mj(!0),this.jh.mj(!0),this.Os=this.Re=-1,null!=this.Kc&&this.Kc.mj(!0),null!=this.Gi&&(this.Gi.length=0),null!=this.Di&&(this.Di.length=0),null!=this.hH&&(this.hH.length=0),null!=this.ye&&this.ye.mj(!0),this.Hl=-1,this.Yn=null)},e.prototype.Me=function(t){return this.ge.T(t,2)},e.prototype.D=function(t,e){this.g.dG(this.eR(t),e)},e.prototype.xd=function(t){return this.ge.T(t,1)},e.prototype.Rf=function(t){return this.ge.T(t,4)},e.prototype.cz=function(t){return this.ge.T(t,6)},e.prototype.km=function(t){return this.ge.T(t,7)},e.prototype.js=function(t){return this.jh.T(t,1)},e.prototype.tj=function(t){return this.jh.T(t,0)},e.prototype.ng=function(t,e){return(e=this.Di[e]).size<=t?-1:e.read(t)},e.prototype.nn=function(t,e,i){(e=this.Di[e]).size<=t&&e.resize(this.ge.size,-1),e.write(t,i)},e.prototype.Dp=function(){null==this.Di&&(this.Di=[]);for(var e=t.ia.qf(this.ge.Hg,-1),i=0,n=this.Di.length;i<n;i++)if(null==this.Di[i])return this.Di[i]=e,i;return this.Di.push(e),this.Di.length-1},e.prototype.Ep=function(t){this.Di[t]=null},e.prototype.jk=function(t){return this.Kc.T(t,1)},e.prototype.uf=function(t){return this.jk(this.xa(t))},e.prototype.xa=function(t){return this.Kc.T(t,4)},e.prototype.te=function(t){return this.Kc.T(t,5)},e.prototype.jc=function(t){return this.Kc.T(t,6)},e.prototype.$e=function(t){return this.Kc.T(t,2)},e.prototype.af=function(t){return this.hk(this.Kc.T(t,2))},e.prototype.mm=function(t){return this.Kc.T(t,7)},e.prototype.Yr=function(t,e){this.D(this.jk(t),e)},e.prototype.lm=function(t,e){this.D(this.uf(t),e)},e.prototype.dh=function(t){return this.Kc.T(t,3)&this.bO},e.prototype.Ab=function(t,e){return(e=this.Gi[e]).size<=t?-1:e.read(t)},e.prototype.Kb=function(t,e,i){(e=this.Gi[e]).size<=t&&e.resize(this.Kc.size,-1),e.write(t,i)},e.prototype.$g=function(){null==this.Gi&&(this.Gi=[]);for(var e=t.ia.qf(this.Kc.Hg,-1),i=0,n=this.Gi.length;i<n;i++)if(null==this.Gi[i])return this.Gi[i]=e,i;return this.Gi.push(e),this.Gi.length-1},e.prototype.Jg=function(t){this.Gi[t]=null},e.prototype.IP=function(t){var e=this.$e(t),i=this.xa(t),n=this.jc(t);n==i&&(n=this.jc(n))==t&&(n=-1);var r=this.AF(e);r!==t&&r!=i||this.Dt(e,n),i=this.Yn.read(e),isNaN(i)||(this.AJ(e,NaN),this.CJ(e,NaN)),this.yx(t,!0),this.Ly(t)},e.prototype.JP=function(t){for(var e=0,i=t.size;e<i;e++){var n=t.get(e),r=this.$e(this.xa(n));this.Dt(this.$e(n),-1),this.Dt(r,-1),this.yx(n,!0),this.Ly(n)}},e.prototype.AF=function(t){return this.ye.T(t,1)},e.prototype.hk=function(t){return this.ye.T(t,2)},e.prototype.Gn=function(t){return this.ye.T(t,3)},e.prototype.dR=function(t){return this.ye.T(t,4)},e.prototype.Kp=function(t){var e=this.Yn.read(t);return isNaN(e)&&(this.kY(t),e=this.Yn.read(t)),e},e.prototype.La=function(t){return this.g.KF(t,this.Bq)},e.prototype.Le=function(t){return this.g.Pa(t,this.Cm)},e.prototype.uR=function(t){return this.g.Pa(t,this.Cq)},e.prototype.tR=function(t,e){var i=this.Me(t);if(-1==i)return-1;var n=i,r=-1,s=-1;do{if(this.uf(n)==e)return n;if(-1==r){if(-1==(r=this.Me(e)))break;s=r}if(this.uf(s)==t)return this.xa(s);n=this.jc(this.xa(n)),s=this.jc(this.xa(s))}while(n!=i&&s!=r);return-1},e.prototype.pB=function(e,i){i.Or(),i=i.get();var n=new t.h;this.Yr(e,n),i.Dc(n),this.lm(e,n),i.Qc(n)},e.prototype.HO=function(e,i){if(e==i)return 0;var n=new t.h;this.lm(e,n);var r=new t.h;return this.lm(i,r),n.qb(r)?0:(i=new t.h,this.Yr(e,i),(e=new t.h).uc(n,i),(n=new t.h).uc(r,i),t.h.nu(e,n))},e.prototype.GO=function(e,i){if(e==i)return 0;var n=new t.h;this.lm(e,n);var r=new t.h;return this.lm(i,r),n.qb(r)?0:(i=new t.h,this.Yr(e,i),(e=new t.h).uc(n,i),(n=new t.h).uc(r,i),0<=n.y&&0<e.y?t.h.nu(e,n):0)},e.prototype.xO=function(){for(var e=t.lc.ox(this.lA),i=new t.h,n=new t.h,r=new t.h,s=new t.h,o=new t.h,a=this.Re;-1!=a;a=this.Rf(a)){var h=this.Me(a);if(-1!=h){var l=h;this.Yr(l,i),this.lm(l,n),o.uc(n,i);var c=o.Sk();do{var u=l;if((l=this.jc(this.xa(l)))!=u){this.lm(l,r),s.uc(r,i),u=s.Sk();var d=s.wi(o);if(d*d/(u*c)*Math.min(u,c)<=e)return!1;o.L(s),c=u,n.L(r)}}while(l!=h)}}return!0},e}(),t.iu=e}(X||(X={})),function(t){var e=function(){function e(){this.j=null,this.oH=new t.h,this.pH=new t.h,this.Gj=null,this.Mv=!1,this.tl=-1}return e.prototype.cf=function(t){return t<this.Gj.length&&this.Gj[t]},e.prototype.dl=function(e,i,n,r){var s=t.aa.tf(this.j.g.ic(n));if(2!=t.aa.tf(this.j.g.ic(i))||1!=s)throw t.i.Qa();this.FP(e,i,n,r)},e.prototype.dr=function(e,i){null==this.j&&(this.j=new t.iu),this.j.dr(e,i)},e.prototype.Ft=function(e,i,n){for(t.Tk.V(e,i,n,!0),i=e.ld;-1!=i;i=e.ue(i))1736==e.ic(i)&&t.rn.V(e,i,-1,this.Mv,n);this.dr(e,n)},e.prototype.ME=function(t,e,i,n,r){var s=this.j.g;if(1736==s.ic(t))for(t=s.Ob(t);-1!=t;t=s.Rb(t)){var o=s.Xa(t);this.j.Le(o),this.j.Le(s.U(o));var a=this.j.uR(o);if(-1!=a){var h=this.j.Ab(a,i);if(1!=h&&2!=h)if(this.cf(this.j.af(a))){this.j.Kb(a,i,1),h=s.vf(e,-1);var l=a,c=this.j.Le(o),u=1;do{var d=this.sm(o,r);s.ij(h,d),-1!=n&&this.j.nn(c,n,1),this.j.Kb(l,i,1),l=this.j.jc(l);do{var f=-1!=(d=1==u?s.U(o):s.Ma(o))?this.j.Le(d):-1}while(f==c);var p=this.j.jk(l);if(p!=f){do{f=-1!=(d=1==u?s.Ma(o):s.U(o))?this.j.Le(d):-1}while(f==c);p!=f?(f=p,d=this.j.tj(this.j.km(f))):u=-u}c=f,o=d}while(l!=a);s.kn(h,!0)}else this.j.Kb(a,i,2)}}},e.prototype.eF=function(){for(var e=this.j.$g(),i=new t.ia(0),n=this.j.Re;-1!=n;n=this.j.Rf(n)){var r=this.j.Me(n),s=r;if(-1!=r)do{if(1!=this.j.Ab(s,e)){var o=this.j.xa(s);this.j.Kb(o,e,1),this.j.Kb(s,e,1),this.cf(this.j.af(s))&&this.cf(this.j.af(o))&&i.add(s)}s=this.j.jc(this.j.xa(s))}while(s!=r)}this.j.Jg(e),this.j.JP(i)},e.prototype.sm=function(t,e){return-1==e?t:this.aS(t,e)},e.prototype.aS=function(t,e){var i=this.j.g,n=this.j.km(this.j.Le(t));do{var r=this.j.tj(n);if(i.Qf(i.bd(r))==e)return r;n=this.j.js(n)}while(-1!=n);return t},e.prototype.Ot=function(e,i,n){this.eF();var r=this.j.g,s=r.Ig(1736),o=this.j.$g();return this.uK(e,i,s,n,o,-1),this.j.Jg(o),t.rn.V(r,s,1,this.Mv,null),s},e.prototype.uK=function(t,e,i,n,r,s){for(this.ME(t,i,r,s,n),-1!=e&&this.ME(e,i,r,s,n),t=this.j.g,e=this.j.Re;-1!=e;e=this.j.Rf(e)){var o=this.j.Me(e);if(-1!=o){var a=o;do{var h=this.j.Ab(a,r);if(1!=h&&2!=h)if(this.cf(this.j.af(a))){h=t.vf(i,-1);var l=a;do{var c=this.j.mm(l);-1!=c?c=this.j.tj(c):(c=this.j.tj(this.j.mm(this.j.xa(l))),c=this.j.g.U(c)),c=this.sm(c,n),t.ij(h,c),this.j.Kb(l,r,1),-1!=s&&(c=this.j.Le(c),this.j.nn(c,s,1)),l=this.j.jc(l)}while(l!=a);t.kn(h,!0)}else this.j.Kb(a,r,2);a=this.j.jc(this.j.xa(a))}while(a!=o)}}},e.prototype.aY=function(e,i,n){var r=this.j.g,s=r.Ig(1736),o=r.Ig(1607),a=r.Ig(550);this.eF();var h=-1,l=this.j.$g(),c=this.j.Dp();for(this.uK(e,i,s,n,l,c),e=this.j.Re;-1!=e;e=this.j.Rf(e))if(-1!=(i=this.j.Me(e))){var u=i;do{var d=this.j.Ab(u,l),f=this.j.Ab(this.j.xa(u),l);if(2==(d|=f))if(d=this.j.dh(u),this.cf(d)){var p=r.vf(o,-1),g=u;d=this.Yw(e,r),d=this.sm(d,n),r.ij(p,d),this.j.nn(e,c,1);do{if(d=this.j.uf(g),f=this.Yw(d,r),f=this.sm(f,n),r.ij(p,f),this.j.Kb(g,l,1),this.j.Kb(this.j.xa(g),l,1),this.j.nn(d,c,1),g=this.j.jc(g),d=this.j.Ab(g,l),2!=(d|=f=this.j.Ab(this.j.xa(g),l)))break;if(d=this.j.dh(g),!this.cf(d)){this.j.Kb(g,l,1),this.j.Kb(this.j.xa(g),l,1);break}}while(g!=u)}else this.j.Kb(u,l,1),this.j.Kb(this.j.xa(u),l,1);u=this.j.jc(this.j.xa(u))}while(u!=i)}for(e=this.j.Re;-1!=e;e=this.j.Rf(e))1!=(d=this.j.ng(e,c))&&(d=this.j.xd(e),this.cf(d)&&(-1==h&&(h=r.vf(a,-1)),-1!=(i=this.j.km(e))&&(i=this.j.tj(i),d=this.sm(i,n),r.ij(h,d))));return this.j.Ep(c),this.j.Jg(l),t.rn.V(r,s,1,this.Mv,null),(n=[])[0]=a,n[1]=o,n[2]=s,n},e.prototype.Yw=function(t,e){var i=-1;for(t=this.j.km(t);-1!=t;t=this.j.js(t)){var n=this.j.tj(t);-1==i&&(i=n);var r=this.j.La(e.Qf(e.bd(n)));if(this.cf(r)){i=n;break}}return i},e.prototype.lB=function(e,i){for(var n=this.jl(i),r=this.j.jk(i),s=this.j.uf(i),o=0,a=0,h=this.j.km(r);-1!=h;h=this.j.js(h)){var l=this.j.tj(h),c=e.bd(l),u=this.j.La(e.Qf(c));c=e.Xa(c),(u=!!(u&n))&&c==l&&(this.tl=i);var d=e.U(l);-1!=d&&this.j.Le(d)==s?(o++,u&&(-1===this.tl&&c==d&&(l=this.j.jc(i),this.cf(this.jl(l))&&(this.tl=l)),a++)):-1!=(l=e.Ma(l))&&this.j.Le(l)==s&&(o--,u&&(-1===this.tl&&c===l&&(l=this.j.jc(i),this.cf(this.jl(l))&&(this.tl=l)),a--))}return this.j.D(r,this.oH),this.j.D(s,this.pH),(0!=a?a:o)*t.h.tb(this.oH,this.pH)},e.prototype.jl=function(t){return this.j.dh(t)|this.j.af(t)|this.j.af(this.j.xa(t))},e.prototype.xK=function(t){for(var e=this.j.xa(this.j.te(t)),i=-1;e!=t;){if(this.cf(this.jl(e))){if(-1!=i)return-1;i=e}e=this.j.xa(this.j.te(e))}return-1!=i?this.j.xa(i):-1},e.prototype.yK=function(t){for(var e=this.j.xa(this.j.jc(t)),i=-1;e!=t;){if(this.cf(this.jl(e))){if(-1!=i)return-1;i=e}e=this.j.xa(this.j.jc(e))}return-1!=i?this.j.xa(i):-1},e.prototype.mJ=function(e,i,n,r,s){var o=this.j.g,a=e,h=this.j.xa(a);this.j.Kb(a,n,1),this.j.Kb(h,n,1),this.tl=-1;for(var l=this.lB(o,a),c=a,u=-1,d=!1,f=1;;){var p=this.j.te(a);if(p==h)break;if(h=this.j.jc(h),this.j.xa(p)!=h){if(-1==(a=this.xK(a))){d=!0;break}h=this.j.xa(a)}else a=p;if(a==e){u=e;break}if(p=this.jl(a),!this.cf(p))break;this.j.Kb(a,n,1),this.j.Kb(h,n,1),c=a,l+=this.lB(o,a),f++}if(-1==u)for(a=e,h=this.j.xa(a),u=a;(e=this.j.jc(a))!=h;){if(h=this.j.te(h),this.j.xa(e)!=h){if(-1==(a=this.yK(a))){d=!0;break}h=this.j.xa(a)}else a=e;if(p=this.jl(a),!this.cf(p))break;this.j.Kb(a,n,1),this.j.Kb(h,n,1),u=a,l+=this.lB(o,a),f++}else if(-1!=this.tl&&(c=this.tl,u=this.j.te(this.tl),this.j.xa(u)!=this.j.jc(this.j.xa(c))&&-1==(u=this.xK(c))))throw t.i.Qa();for(0<=l||(a=u,u=this.j.xa(c),c=this.j.xa(a)),n=o.vf(i,-1),a=c,c=this.j.jk(c),d=this.j.uf(u)==c&&d,l=this.Yw(c,o),l=this.sm(l,s),o.ij(n,l),-1!=r&&this.j.nn(c,r,1),c=0,f=d?t.O.truncate((f+1)/2):-1;e=this.j.uf(a),l=this.Yw(e,o),l=this.sm(l,s),o.ij(n,l),c++,-1!=r&&this.j.nn(e,r,1),d&&c==f&&(n=o.vf(i,-1),o.ij(n,l)),a!=u;)if(e=this.j.jc(a),this.j.te(this.j.xa(a))!=this.j.xa(e)){if(-1==(a=this.yK(a)))throw t.i.Qa()}else a=e},e.prototype.Pt=function(t){for(var e=this.j.g.Ig(1607),i=this.j.$g(),n=this.j.Re;-1!=n;n=this.j.Rf(n)){var r=this.j.Me(n),s=r;do{1!=this.j.Ab(s,i)&&this.cf(this.jl(s))&&this.mJ(s,e,i,-1,t),s=this.j.jc(this.j.xa(s))}while(s!=r)}return this.j.Jg(i),e},e.prototype.bY=function(t){for(var e=this.j.g,i=e.Ig(1607),n=e.Ig(550),r=this.j.$g(),s=this.j.Dp(),o=-1,a=this.j.Re;-1!=a;a=this.j.Rf(a)){var h=this.j.Me(a),l=h;do{var c=this.j.Ab(l,r);1!=c&&(c=this.jl(l),this.cf(c)&&this.mJ(l,i,r,s,t)),l=this.j.jc(this.j.xa(l))}while(l!=h)}for(a=this.j.Re;-1!=a;a=this.j.Rf(a))1!=(c=this.j.ng(a,s))&&(c=this.j.xd(a),this.cf(c)&&(-1==o&&(o=e.vf(n,-1)),-1!=(h=this.j.km(a))&&(h=this.j.tj(h),h=this.sm(h,t),e.ij(o,h))));return this.j.Jg(r),this.j.Ep(s),(t=[])[0]=n,t[1]=i,t},e.prototype.mr=function(){for(var t=this.j.g,e=t.Ig(550),i=t.vf(e,-1),n=this.j.Re;-1!=n;n=this.j.Rf(n))if(this.cf(this.j.xd(n))){for(var r=-1,s=this.j.km(n);-1!=s;s=this.j.js(s)){var o=this.j.tj(s);-1==r&&(r=o);var a=this.j.La(t.Qf(t.bd(o)));if(this.cf(a)){r=o;break}}t.ij(i,r)}return e},e.prototype.bq=function(t){this.Gj=[];for(var e=0;e<t;e++)this.Gj[e]=!1},e.aW=function(e,i,n){var r=e.Ia(),s=Array(1e3);t.O.$u(s,null);var o=t.O.lg(1e3,0),a=e.I(),h=!0,l=2==i.Db();if(1!=i.Db()&&2!=i.Db())throw t.i.Qa();for(var c=0;c<a;){var u=t.O.truncate(e.lW(s,c)-c);l?t.hd.sK(i,s,u,n,o):t.hd.tK(i,s,u,n,o);for(var d=0,f=0;f<u;f++)0==o[f]&&(h&&(h=!1,r.Fd(e,0,c)),d!=f&&r.Fd(e,c+d,c+f),d=f+1);h||d==u||r.Fd(e,c+d,c+u),c+=u}return h?e:r},e.zG=function(i,n,r){return i instanceof t.de?e.aW(i,n,r):n instanceof t.Sa?i.B()||n.B()?i.Ia():t.Tk.zU(r,i,n)?t.Tk.CO(i,n):i.Ia():e.bW(i,n,r)},e.Av=function(i,n,r,s){var o=new t.l;i.A(o);var a=new t.l;n.A(a);var h=new t.l;if(h.K(o),h.Zb(a),r=t.ta.Wd(r,h,!0),(h=new t.l).K(a),a=t.ta.Er(r),h.W(a,a),!o.isIntersecting(h)){if(i.Db()<=n.Db())return e.ki(e.Xe(i.Ia()),i,"&");if(i.Db()>n.Db())return e.ki(e.Xe(n.Ia()),i,"&")}return a=new e,h=(o=new t.gd).Ib(e.Xe(i)),n=o.Ib(e.Xe(n)),a.Ft(o,r,s),s=a.Av(h,n),i=e.ki(o.Ne(s),i,"&"),t.aa.Hc(i.getType())&&(i.Ch(2,r),1736==i.getType()&&i.fm()),i},e.bW=function(e,i,n){if(e.B()||i.B())return e.Ia();var r=[null],s=[0],o=2==i.Db();if(1!=i.Db()&&2!=i.Db())throw t.i.Qa();return r[0]=e.D(),o?t.hd.sK(i,r,1,n,s):t.hd.tK(i,r,1,n,s),0==s[0]?e.Ia():e},e.prototype.LU=function(e,i,n,r,s){if(e.B())return e;var o=new t.gd;return e=o.Ib(e),this.Mk(o,e,i,n,r,s)},e.prototype.NU=function(e,i,n,r,s,o){if(s&&550!=e.ic(i)){var a=new t.RC;a.TX(e,n),a.Ng?(t.Tk.V(e,n,o,!0),s=!1):this.j.yy(n)}else t.Tk.V(e,n,o,!0),s=!1;if(r&&550!=e.ic(i)?this.j.wJ(e,i,o):this.j.vJ(e,i,o),this.j.pA)return this.j.Ug(),this.j=null,this.Mk(e,i,n,r,!1,o);if(this.j.yy(NaN),o=this.j.La(i),this.bq(o+1),this.Gj[o]=!0,1736==e.ic(i)||r&&550!=e.ic(i))return e.Yo(i,0),i=this.Ot(i,-1,-1),(e=e.Ne(i)).Yo(0),s?e.Ch(1,0):(e.Ch(2,n),e.fm()),e;if(1607==e.ic(i))return i=this.Pt(-1),e=e.Ne(i),s||e.Ch(2,n),e;if(550==e.ic(i))return i=this.mr(),e=e.Ne(i),s||e.Ch(2,n),e;throw t.i.Qa()},e.prototype.Mk=function(e,i,n,r,s,o){this.j=new t.iu;try{return this.NU(e,i,n,r,s,o)}finally{this.j.Ug()}},e.Mk=function(t,i,n,r,s){return(new e).LU(t,i,n,r,s)},e.prototype.MU=function(e,i,n,r){this.Mv=e,this.j=new t.iu,e=i.In(n);var s=i.ic(n);if(1!=e||550==s?this.j.vJ(i,n,r):this.j.wJ(i,n,r),!this.j.pA)if(this.j.yy(NaN),r=this.j.La(n),this.bq(r+1),this.Gj[r]=!0,1736==i.ic(n)||1==e&&550!=i.ic(n))i.Yo(n,0),r=this.Ot(n,-1,-1),i.hC(r,n),i.BB(r);else if(1607==i.ic(n))r=this.Pt(-1),i.hC(r,n),i.BB(r);else{if(550!=i.ic(n))throw t.i.fa("internal error");r=this.mr(),i.hC(r,n),i.BB(r)}},e.prototype.im=function(e,i){var n=t.aa.tf(this.j.g.ic(e)),r=t.aa.tf(this.j.g.ic(i));if(n>r)return e;var s=this.j.La(e),o=this.j.La(i);if(this.bq(1+(s|o)),this.Gj[this.j.La(e)]=!0,2==n&&2==r)return this.Ot(e,i,-1);if(1==n&&2==r||1==n&&1==r)return this.Pt(-1);if(0==n)return this.mr();throw t.i.Qa()},e.prototype.Av=function(e,i){var n=t.aa.tf(this.j.g.ic(e)),r=t.aa.tf(this.j.g.ic(i)),s=this.j.La(e),o=this.j.La(i);if(this.bq(1+(s|o)),this.Gj[this.j.La(e)|this.j.La(i)]=!0,s=-1,1<this.j.g.ht.Aa&&(s=e),2==n&&2==r)return this.Ot(e,i,s);if(1==n&&0<r||1==r&&0<n)return this.Pt(s);if(0==n||0==r)return this.mr();throw t.i.Qa()},e.prototype.Pz=function(e,i){var n=t.aa.tf(this.j.g.ic(e)),r=t.aa.tf(this.j.g.ic(i)),s=this.j.La(e),o=this.j.La(i);if(this.bq(1+(s|o)),this.Gj[this.j.La(e)|this.j.La(i)]=!0,s=-1,1<this.j.g.ht.Aa&&(s=e),2==n&&2==r)return this.aY(e,i,s);if(1==n&&0<r||1==r&&0<n)return this.bY(s);if(0==n||0==r)return(e=[])[0]=this.mr(),e;throw t.i.Qa()},e.prototype.ep=function(e,i){var n=t.aa.tf(this.j.g.ic(e)),r=t.aa.tf(this.j.g.ic(i)),s=this.j.La(e),o=this.j.La(i);if(this.bq(1+(s|o)),this.Gj[this.j.La(e)]=!0,this.Gj[this.j.La(i)]=!0,2==n&&2==r)return this.Ot(e,i,-1);if(1==n&&1==r)return this.Pt(-1);if(0==n&&0==r)return this.mr();throw t.i.Qa()},e.Xe=function(e){var i=e.getType();return 197==i?(i=new t.Da(e.description),e.B()||i.ad(e,!1),i):33==i?(i=new t.de(e.description),e.B()||i.add(e),i):322==i?(i=new t.Ta(e.description),e.B()||i.oc(e,!0),i):e},e.ki=function(e,i,n){var r=e.getType();return 197==r?(i=new t.Da(e.description),e.B()||i.ad(e,!1),i):33!=r||"|"!=n&&"^"!=n?322==r?(i=new t.Ta(e.description),e.B()||i.oc(e,!0),i):33==r&&"-"==n&&33==i.getType()||550==r&&"&"==n&&33==i.getType()?(i=new t.Sa(e.description),e.B()||e.ve(0,i),i):e:(i=new t.de(e.description),e.B()||i.add(e),i)},e.im=function(i,n,r,s){if(i.B()||n.B()||i.Db()>n.Db())return e.ki(e.Xe(i),i,"-");var o=new t.l;i.A(o);var a=new t.l;if(n.A(a),!o.isIntersecting(a))return e.ki(e.Xe(i),i,"-");var h=new t.l;return h.K(o),h.Zb(a),r=t.ta.Wd(r,h,!0),a=new e,h=(o=new t.gd).Ib(e.Xe(i)),n=o.Ib(e.Xe(n)),a.Ft(o,r,s),s=a.im(h,n),s=o.Ne(s),i=e.ki(s,i,"-"),t.aa.Hc(i.getType())&&(i.Ch(2,r),1736==i.getType()&&i.fm()),i},e.VP=function(i,n,r){if(2>i.length)throw t.i.N("not enough geometries to dissolve");for(var s=0,o=0,a=i.length;o<a;o++)s=Math.max(i[o].Db(),s);var h=new t.l;h.Oa();var l=new t.gd,c=-1,u=0,d=-1;for(o=0,a=i.length;o<a;o++)if(i[o].Db()==s)if(i[o].B())-1==d&&(d=o);else{d=o,-1==c?c=l.Ib(e.Xe(i[o])):l.uN(c,e.Xe(i[o]));var f=new t.l;i[o].xc(f),h.Zb(f),u++}return 2>u?e.Xe(i[d]):(i=2==s,n=t.ta.Wd(0==s?n:null,h,!0),(new e).Mk(l,c,n,i,!0,r))},e.Pz=function(i,n,r,s){var o=[null,null,null],a=new t.l;i.A(a);var h=new t.l;n.A(h);var l=new t.l;if(l.K(a),l.Zb(h),r=t.ta.Wd(r,l,!0),(l=new t.l).K(h),h=t.ta.Er(r),l.W(h,h),!a.isIntersecting(l)){if(i.Db()<=n.Db())return o[(i=e.ki(e.Xe(i.Ia()),i,"&")).Db()]=i,o;if(i.Db()>n.Db())return o[(i=e.ki(e.Xe(n.Ia()),i,"&")).Db()]=i,o}for(h=new e,l=(a=new t.gd).Ib(e.Xe(i)),n=a.Ib(e.Xe(n)),h.Ft(a,r,s),s=h.Pz(l,n),n=0;n<s.length;n++)h=e.ki(a.Ne(s[n]),i,"&"),t.aa.Hc(h.getType())&&(h.Ch(2,r),1736==h.getType()&&h.fm()),o[h.Db()]=h;return o},e.ep=function(i,n,r,s){if(i.Db()>n.Db())return e.ki(e.Xe(i),i,"^");if(i.Db()<n.Db()||i.B())return e.ki(e.Xe(n),i,"^");if(n.B())return e.ki(e.Xe(i),i,"^");var o=new t.l;i.A(o);var a=new t.l;n.A(a);var h=new t.l;return h.K(o),h.Zb(a),r=t.ta.Wd(r,h,!0),a=new e,h=(o=new t.gd).Ib(e.Xe(i)),n=o.Ib(e.Xe(n)),a.Ft(o,r,s),s=a.ep(h,n),i=e.ki(o.Ne(s),i,"^"),t.aa.Hc(i.getType())&&(i.Ch(2,r),1736==i.getType()&&i.fm()),i},e.prototype.LQ=function(t,e){var i=this.j.g;t=i.vf(t,-1);for(var n=e.size,r=0;r<n;r++){var s=e.get(r);i.ij(t,s)}i.kn(t,!0)},e.prototype.aX=function(t,e){for(var i=this.j.g,n=i.ld;-1!=n;n=i.ue(n))if(n==e)for(var r=i.Ob(n);-1!=r;r=i.Rb(r)){var s=i.Xa(r);if(-1!=s)for(var o=i.U(s);-1!=o;){s=this.j.Le(s);var a=this.j.Le(o);-1!=(s=this.j.tR(s,a))&&(a=this.j.xa(s),this.j.Kb(s,t,1),this.j.Kb(a,t,2)),s=o,o=i.U(s)}}},e.prototype.cW=function(e,i,n,r){n=this.j.La(n),r=this.j.La(r);var s=new t.ia(0);s.Jb(256);for(var o=this.j.g,a=this.j.$g(),h=this.j.Re;-1!=h;h=this.j.Rf(h)){var l=this.j.Me(h);if(-1!=l){var c=l;do{if(1!=this.j.Ab(c,a)){var u=c,d=c,f=!1,p=0;do{if(this.j.Kb(u,a,1),!f){var g=this.j.dh(u);g&r&&this.j.af(u)&n&&(d=u,f=!0)}f&&(s.add(this.j.tj(this.j.km(this.j.jk(u)))),-1!=e&&(g=this.j.dh(u))&r&&(p|=g=this.j.Ab(u,e))),u=this.j.jc(u)}while(u!=d);f&&0<this.j.Kp(this.j.$e(d))&&(u=o.Ig(1736),this.LQ(u,s),-1!=i&&o.HJ(u,i,p)),s.clear(!1)}c=this.j.jc(this.j.xa(c))}while(c!=l)}}this.j.Jg(a)},e.prototype.FP=function(t,e,i,n){this.j.yW();var r=-1;-1!=t&&(r=this.j.$g(),this.aX(r,i)),this.cW(r,t,e,i),-1!=r&&(this.j.Jg(r),r=-1);var s=this.j.g;for(t=0,r=s.ld;-1!=r;r=s.ue(r))r!=e&&r!=i&&(n.add(r),t++);n.Vd(0,t,(function(t,e){return(t=s.wz(s.Ob(t)))<(e=s.wz(s.Ob(e)))?-1:t==e?0:1}))},e.prototype.Ug=function(){null!=this.j&&(this.j.Ug(),this.j=null)},e}();t.Fg=e}(X||(X={})),function(t){var e=function(){function e(t){void 0!==t?this.setScale(t):this.RB()}return e.prototype.lx=function(){this.Lb=this.Gb=this.jb=this.eb=this.ab=this.bb=0},e.prototype.Nb=function(t){return this==t||t instanceof e&&this.bb==t.bb&&this.eb==t.eb&&this.Gb==t.Gb&&this.jb==t.jb&&this.ab==t.ab&&this.Lb==t.Lb},e.prototype.cc=function(){return t.O.uj(),t.O.uj(),t.O.uj(),t.O.uj(),t.O.uj(),t.O.uj()},e.prototype.Eh=function(t,e){var i=this.jb*t.x+this.ab*t.y+this.Lb;e.x=this.bb*t.x+this.eb*t.y+this.Gb,e.y=i},e.prototype.eY=function(e,i,n){for(var r=0;r<i;r++){var s=e[r].x,o=e[r].y,a=this.bb*s+this.eb*o+this.Gb;s=this.jb*s+this.ab*o+this.Lb,null!=n[r]?n[r].ma(a,s):n[r]=t.h.construct(a,s)}},e.prototype.multiply=function(t){e.multiply(this,t,this)},e.multiply=function(t,e,i){var n=t.bb*e.bb+t.jb*e.eb,r=t.eb*e.bb+t.ab*e.eb,s=t.Gb*e.bb+t.Lb*e.eb+e.Gb,o=t.bb*e.jb+t.jb*e.ab,a=t.eb*e.jb+t.ab*e.ab;t=t.Gb*e.jb+t.Lb*e.ab+e.Lb,i.bb=n,i.eb=r,i.Gb=s,i.jb=o,i.ab=a,i.Lb=t},e.prototype.Of=function(){var t=new e;return t.bb=this.bb,t.eb=this.eb,t.Gb=this.Gb,t.jb=this.jb,t.ab=this.ab,t.Lb=this.Lb,t},e.prototype.mC=function(e){if(!e.B()){for(var i=[],n=0;4>n;n++)i[n]=new t.h;e.nB(i),this.fY(i,i),e.Zw(i,4)}},e.prototype.fY=function(e,i){for(var n=0;n<e.length;n++){var r=new t.h,s=e[n];r.x=this.bb*s.x+this.eb*s.y+this.Gb,r.y=this.jb*s.x+this.ab*s.y+this.Lb,i[n]=r}},e.prototype.pS=function(t,e){t.B()||e.B()||0==t.R()||0==t.ca()?this.lx():(this.eb=this.jb=0,this.bb=e.R()/t.R(),this.ab=e.ca()/t.ca(),this.Gb=e.v-t.v*this.bb,this.Lb=e.G-t.G*this.ab)},e.prototype.dY=function(e){var i=new t.h,n=new t.h;i.ma(this.bb,this.jb),n.ma(this.eb,this.ab),i.sub(i);var r=.5*i.Sk();return i.ma(this.bb,this.jb),n.ma(this.eb,this.ab),i.add(n),e*(r>(i=.5*i.Sk())?Math.sqrt(r):Math.sqrt(i))},e.prototype.RB=function(){this.bb=1,this.jb=this.Gb=this.eb=0,this.ab=1,this.Lb=0},e.prototype.isIdentity=function(e){if(void 0!==e){var i=t.h.construct(0,1);return this.Eh(i,i),i.sub(t.h.construct(0,1)),!(i.Sk()>e*e)&&(i.ma(0,0),this.Eh(i,i),!(i.Sk()>e*e)&&(i.ma(1,0),this.Eh(i,i),i.sub(t.h.construct(1,0)),i.Sk()<=e*e))}return 1==this.bb&&1==this.ab&&0==this.eb&&0==this.Gb&&0==this.jb&&0==this.Lb},e.prototype.Bi=function(t){return Math.abs(this.bb*this.ab-this.jb*this.eb)<=2*t*(Math.abs(this.bb*this.ab)+Math.abs(this.jb*this.eb))},e.prototype.gg=function(t,e){this.bb=1,this.eb=0,this.Gb=t,this.jb=0,this.ab=1,this.Lb=e},e.prototype.setScale=function(t,e){void 0!==e?(this.bb=t,this.jb=this.Gb=this.eb=0,this.ab=e,this.Lb=0):this.setScale(t,t)},e.prototype.$B=function(){this.bb=0,this.eb=1,this.Gb=0,this.jb=1,this.Lb=this.ab=0},e.prototype.setRotate=function(t){this.pX(Math.cos(t),Math.sin(t))},e.prototype.pX=function(t,e){this.bb=t,this.eb=-e,this.Gb=0,this.jb=e,this.ab=t,this.Lb=0},e.prototype.shift=function(t,e){this.Gb+=t,this.Lb+=e},e.prototype.scale=function(t,e){this.bb*=t,this.eb*=t,this.Gb*=t,this.jb*=e,this.ab*=e,this.Lb*=e},e.prototype.flipX=function(t,e){this.bb=-this.bb,this.eb=-this.eb,this.Gb=t+e-this.Gb},e.prototype.flipY=function(t,e){this.jb=-this.jb,this.ab=-this.ab,this.Lb=t+e-this.Lb},e.prototype.rotate=function(t){var i=new e;i.setRotate(t),this.multiply(i)},e.prototype.inverse=function(t){if(void 0!==t){var e=this.bb*this.ab-this.eb*this.jb;0==e?t.lx():(e=1/e,t.Gb=(this.eb*this.Lb-this.Gb*this.ab)*e,t.Lb=(this.Gb*this.jb-this.bb*this.Lb)*e,t.bb=this.ab*e,t.eb=-this.eb*e,t.jb=-this.jb*e,t.ab=this.bb*e)}else this.inverse(this)},e}();t.Dd=e}(X||(X={})),function(t){var e=function(){function e(){}return e.prototype.lx=function(){this.hg=this.Lb=this.Gb=this.He=this.Fe=this.Ee=this.Ge=this.ab=this.eb=this.Ze=this.jb=this.bb=0},e.prototype.setScale=function(t,e,i){this.bb=t,this.eb=this.Ze=this.jb=0,this.ab=e,this.Fe=this.Ee=this.Ge=0,this.He=i,this.hg=this.Lb=this.Gb=0},e.prototype.setTranslate=function(t,e,i){this.bb=1,this.eb=this.Ze=this.jb=0,this.ab=1,this.Fe=this.Ee=this.Ge=0,this.He=1,this.Gb=t,this.Lb=e,this.hg=i},e.prototype.translate=function(t,e,i){this.Gb+=t,this.Lb+=e,this.hg+=i},e.prototype.mC=function(e){if(!e.B()){for(var i=new t.Nd[8],n=0;8>n;n++)i[n]=new t.Nd;e.nB(i),this.transform(i,8,i),e.Zw(i)}},e.prototype.transform=function(e,i,n){for(var r=0;r<i;r++){var s=new t.Nd,o=e[r];s.x=this.bb*o.x+this.eb*o.y+this.Ee*o.z+this.Gb,s.y=this.jb*o.x+this.ab*o.y+this.Fe*o.z+this.Lb,s.z=this.Ze*o.x+this.Ge*o.y+this.He*o.z+this.hg,n[r]=s}},e.prototype.fp=function(e){var i=new t.Nd;return i.x=this.bb*e.x+this.eb*e.y+this.Ee*e.z+this.Gb,i.y=this.jb*e.x+this.ab*e.y+this.Fe*e.z+this.Lb,i.z=this.Ze*e.x+this.Ge*e.y+this.He*e.z+this.hg,i},e.prototype.Ag=function(t){e.multiply(this,t,this)},e.multiply=function(t,e,i){var n=t.bb*e.bb+t.jb*e.eb+t.Ze*e.Ee,r=t.bb*e.jb+t.jb*e.ab+t.Ze*e.Fe,s=t.bb*e.Ze+t.jb*e.Ge+t.Ze*e.He,o=t.eb*e.bb+t.ab*e.eb+t.Ge*e.Ee,a=t.eb*e.jb+t.ab*e.ab+t.Ge*e.Fe,h=t.eb*e.Ze+t.ab*e.Ge+t.Ge*e.He,l=t.Ee*e.bb+t.Fe*e.eb+t.He*e.Ee,c=t.Ee*e.jb+t.Fe*e.ab+t.He*e.Fe,u=t.Ee*e.Ze+t.Fe*e.Ge+t.He*e.He,d=t.Gb*e.bb+t.Lb*e.eb+t.hg*e.Ee+e.Gb,f=t.Gb*e.jb+t.Lb*e.ab+t.hg*e.Fe+e.Lb;t=t.Gb*e.Ze+t.Lb*e.Ge+t.hg*e.He+e.hg,i.bb=n,i.jb=r,i.Ze=s,i.eb=o,i.ab=a,i.Ge=h,i.Ee=l,i.Fe=c,i.He=u,i.Gb=d,i.Lb=f,i.hg=t},e.inverse=function(e,i){var n=e.bb*(e.ab*e.He-e.Ge*e.Fe)-e.jb*(e.eb*e.He-e.Ge*e.Ee)+e.Ze*(e.eb*e.Fe-e.ab*e.Ee);if(0==n)throw t.i.fa("math singularity");var r=1/n;n=(e.ab*e.He-e.Ge*e.Fe)*r;var s=-(e.eb*e.He-e.Ge*e.Ee)*r,o=(e.eb*e.Fe-e.ab*e.Ee)*r,a=-(e.jb*e.He-e.Fe*e.Ze)*r,h=(e.bb*e.He-e.Ze*e.Ee)*r,l=-(e.bb*e.Fe-e.jb*e.Ee)*r,c=(e.jb*e.Ge-e.Ze*e.ab)*r,u=-(e.bb*e.Ge-e.Ze*e.eb)*r;r*=e.bb*e.ab-e.jb*e.eb;var d=-(e.Gb*n+e.Lb*s+e.hg*o),f=-(e.Gb*a+e.Lb*h+e.hg*l);e=-(e.Gb*c+e.Lb*u+e.hg*r),i.bb=n,i.jb=a,i.Ze=c,i.eb=s,i.ab=h,i.Ge=u,i.Ee=o,i.Fe=l,i.He=r,i.Gb=d,i.Lb=f,i.hg=e},e.prototype.Of=function(){var t=new e;return t.bb=this.bb,t.jb=this.jb,t.Ze=this.Ze,t.eb=this.eb,t.ab=this.ab,t.Ge=this.Ge,t.Ee=this.Ee,t.Fe=this.Fe,t.He=this.He,t.Gb=this.Gb,t.Lb=this.Lb,t.hg=this.hg,t},e}();t.JY=e}(X||(X={})),function(t){var e=function(e){function n(t){if(void 0!==t)t=e.call(this,t.cc(),t)||this;else{(t=e.call(this)||this).bg=[],t.bg[0]=0,t.Aa=1,t.uh=[];for(var i=0;10>i;i++)t.uh[i]=-1;t.uh[t.bg[0]]=0}return t.jq=!0,t}return Q(n,e),n.prototype.re=function(t){this.hasAttribute(t)||(this.uh[t]=0,this.jD())},n.prototype.removeAttribute=function(e){if(0==e)throw t.i.N("Position attribue cannot be removed");this.hasAttribute(e)&&(this.uh[e]=-1,this.jD())},n.prototype.reset=function(){this.bg[0]=0,this.Aa=1;for(var t=0;t<this.uh.length;t++)this.uh[t]=-1;this.uh[this.bg[0]]=0,this.jq=!0},n.prototype.EF=function(){return i.kz().add(this)},n.og=function(){return i.kz().$R()},n.prototype.tM=function(){var e=this.cc();return new t.ra(e,this)},n.prototype.jD=function(){for(var t=this.Aa=0,e=0;10>t;t++)0<=this.uh[t]&&(this.bg[e]=t,this.uh[t]=e,e++,this.Aa++);this.jq=!0},n.prototype.cc=function(){return this.jq&&(this.wl=this.An(),this.jq=!1),this.wl},n.prototype.Nb=function(t){if(null==t)return!1;if(t==this)return!0;if(!(t instanceof n)||t.Aa!=this.Aa)return!1;for(var e=0;e<this.Aa;e++)if(this.bg[e]!=t.bg[e])return!1;return this.jq==t.jq},n.prototype.GG=function(t){if(t.Aa!=this.Aa)return!1;for(var e=0;e<this.Aa;e++)if(this.bg[e]!=t.bg[e])return!1;return!0},n.Iw=function(t,e){for(var i=[],n=0;n<t.Aa;n++)i[n]=-1;n=0;for(var r=t.Aa;n<r;n++)i[n]=e.Pf(t.kd(n));return i},n.BR=function(t,e){return(t=new n(t)).re(e),t.EF()},n.CR=function(t,e){for(var i=null,r=0;10>r;r++)!t.hasAttribute(r)&&e.hasAttribute(r)&&(null==i&&(i=new n(t)),i.re(r));return null!=i?i.EF():t},n}(t.ra);t.ee=e;var i=function(){function t(){this.map=[];var t=new e;this.add(t),(t=new e).re(1),this.add(t)}return t.kz=function(){return t.bL},t.prototype.$R=function(){return t.ft},t.prototype.add=function(e){var i=e.cc();if(null!=t.ft&&t.ft.cc()==i&&e.GG(t.ft))return t.ft;if(null!=t.Dw&&t.Dw.cc()==i&&e.GG(t.Dw))return t.Dw;var n=null;return void 0!==this.map[i]&&(n=this.map[i]),null==n&&(1==(n=e.tM()).Aa?t.ft=n:2==n.Aa&&1==n.kd(1)?t.Dw=n:this.map[i]=n),n},t.bL=new t,t}()}(X||(X={}));var st={feet:9002,kilometers:9036,meters:9001,miles:9093,"nautical-miles":9030,yards:9096},ot={acres:109402,ares:109463,hectares:109401,"square-feet":109405,"square-kilometers":109414,"square-meters":109404,"square-miles":109439,"square-yards":109442},at=new(function(){function t(){this.RM=50,this.np=new Map,this.gj=[]}return t.prototype.clear=function(){this.gj.length=0,this.np.clear()},t.prototype.delete=function(t){return!!this.np.delete(t)&&(this.gj.splice(this.gj.indexOf(t),1),!0)},t.prototype.get=function(t){var e=this.np.get(t);if(void 0!==e)return this.gj[0]!==t&&(this.gj.splice(this.gj.indexOf(t),1),this.gj.unshift(t)),e},t.prototype.has=function(t){return this.np.has(t)},t.prototype.set=function(t,e){return void 0!==this.get(t)&&this.delete(t),this.gj.unshift(t),this.np.set(t,e),this.oM(),this},t.prototype.oM=function(){for(;this.gj.length&&this.gj.length>this.RM;){var t=this.gj.pop();this.np.delete(t)}},t}()),ht=((Y={}).convertJSONToGeometry=function(t){return X.$b.fP(t)},Y.hasM=function(t){return t.hasAttribute(X.Ih.M)},Y.hasZ=function(t){return t.hasAttribute(X.Ih.Z)},Y.getPointX=function(t){return t.Lg()},Y.getPointY=function(t){return t.ih()},Y.getPointZ=function(t){return t.bS()},Y.getPointM=function(t){return t.zR()},Y.getXMin=function(t){return t.es()},Y.getYMin=function(t){return t.gs()},Y.getXMax=function(t){return t.ds()},Y.getYMax=function(t){return t.fs()},Y.getZExtent=function(t){return t.Tg(X.Ih.Z,0)},Y.getMExtent=function(t){return t.Tg(X.Ih.M,0)},Y.exportPaths=function(t){var e=[],i=t.da(),n=null,r=null,s=t.hasAttribute(X.Ih.Z),o=t.hasAttribute(X.Ih.M);s&&(n=t.ub(X.Ih.Z)),o&&(r=t.ub(X.Ih.M));for(var a=new X.h,h=0;h<i;h++){for(var l=t.Ba(h),c=t.Ja(h),u=0,d=0,f=NaN,p=NaN,g=NaN,v=NaN,m=t.dc(h),y=[],_=l;_<l+c;_++){t.D(_,a),v=g=NaN;var b=[a.x,a.y];s&&(g=n.get(_),b.push(g)),o&&(v=r.get(_),b.push(v)),_==l&&m&&(u=a.x,d=a.y,f=g,p=v),y.push(b)}!m||u==a.x&&d==a.y&&(!s||isNaN(f)&&isNaN(g)||f==g)&&(!o||isNaN(p)&&isNaN(v)||p==v)||y.push(y[0].slice(0)),e.push(y)}return e},Y.exportPathsFlat=function(){},Y.exportPoints=function(t){var e=t.hasAttribute(X.Ih.Z),i=t.hasAttribute(X.Ih.M),n=null,r=null;e&&(n=t.ub(X.Ih.Z)),i&&(r=t.ub(X.Ih.M));for(var s=new X.h,o=t.I(),a=[],h=0;h<o;h++){t.D(h,s);var l=[s.x,s.y];e&&l.push(n.get(h)),i&&l.push(r.get(h)),a.push(l)}return a},Y.exportPointsFlat=function(){},Y),lt=new Map;return function(){function t(){}return t.buffer=C,t.clip=h,t.contains=c,t.convexHull=x,t.crosses=u,t.cut=l,t.densify=L,t.difference=T,t.disjoint=m,t.distance=d,t.equals=f,t.extendedSpatialReferenceInfo=a,t.generalize=D,t.geodesicArea=F,t.geodesicBuffer=O,t.geodesicDensify=z,t.geodesicLength=H,t.intersect=M,t.intersects=p,t.isSimple=b,t.nearestCoordinate=I,t.nearestVertex=P,t.nearestVertices=N,t.offset=E,t.overlaps=y,t.planarArea=j,t.planarLength=k,t.relate=_,t.simplify=w,t.symmetricDifference=A,t.touches=g,t.union=S,t.within=v,t.rotate=X.Ex.rotate,t.flipHorizontal=X.Ex.JQ,t.flipVertical=X.Ex.KQ,t.intersectLinesToPoints=Z,t.ExtendedParams=X.yC,t.clearDefaultSpatialReferenceTolerance=q,t.changeDefaultSpatialReferenceTolerance=W,t._enableProjection=B,t._project=U,t._getTransformation=G,t._getTransformationBySuitability=V,t}()}();void 0!==e&&(t.exports=e)}(s)),s.exports);const a=(0,r.g)(o),h=function(t,e){for(var i=0;i<e.length;i++){const n=e[i];if("string"!=typeof n&&!Array.isArray(n))for(const e in n)if("default"!==e&&!(e in t)){const i=Object.getOwnPropertyDescriptor(n,e);i&&Object.defineProperty(t,e,i.get?i:{enumerable:!0,get:()=>n[e]})}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}({__proto__:null,default:a},[o])},69296:function(t,e,i){"use strict";var n;i.d(e,{u:function(){return n}}),function(t){t[t.KILOBYTES=1024]="KILOBYTES",t[t.MEGABYTES=1048576]="MEGABYTES",t[t.GIGABYTES=1073741824]="GIGABYTES"}(n||(n={}))},99680:function(t,e,i){"use strict";i.d(e,{q:function(){return r}});var n=i(85408);class r{constructor(t,e){this._storage=new n.F,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this),e&&this._storage.registerRemoveFunc("",e)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,e,i=1){this._storage.put(this,t,e,i,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}}},92709:function(t,e,i){"use strict";i.d(e,{T:function(){return n},d:function(){return g}});const n={Base64:0,Hex:1,String:2,Raw:3},r=8,s=(1<<r)-1;function o(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function a(t){const e=[];for(let i=0,n=t.length*r;i<n;i+=r)e[i>>5]|=(t.charCodeAt(i/r)&s)<<i%32;return e}function h(t){const e=[];for(let i=0,n=32*t.length;i<n;i+=r)e.push(String.fromCharCode(t[i>>5]>>>i%32&s));return e.join("")}function l(t,e,i,n,r,s){return o(function(t,e){return t<<e|t>>>32-e}(o(o(e,t),o(n,s)),r),i)}function c(t,e,i,n,r,s,o){return l(e&i|~e&n,t,e,r,s,o)}function u(t,e,i,n,r,s,o){return l(e&n|i&~n,t,e,r,s,o)}function d(t,e,i,n,r,s,o){return l(e^i^n,t,e,r,s,o)}function f(t,e,i,n,r,s,o){return l(i^(e|~n),t,e,r,s,o)}function p(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,n=-271733879,r=-1732584194,s=271733878;for(let e=0;e<t.length;e+=16){const a=i,h=n,l=r,p=s;i=c(i,n,r,s,t[e],7,-680876936),s=c(s,i,n,r,t[e+1],12,-389564586),r=c(r,s,i,n,t[e+2],17,606105819),n=c(n,r,s,i,t[e+3],22,-1044525330),i=c(i,n,r,s,t[e+4],7,-176418897),s=c(s,i,n,r,t[e+5],12,1200080426),r=c(r,s,i,n,t[e+6],17,-1473231341),n=c(n,r,s,i,t[e+7],22,-45705983),i=c(i,n,r,s,t[e+8],7,1770035416),s=c(s,i,n,r,t[e+9],12,-1958414417),r=c(r,s,i,n,t[e+10],17,-42063),n=c(n,r,s,i,t[e+11],22,-1990404162),i=c(i,n,r,s,t[e+12],7,1804603682),s=c(s,i,n,r,t[e+13],12,-40341101),r=c(r,s,i,n,t[e+14],17,-1502002290),n=c(n,r,s,i,t[e+15],22,1236535329),i=u(i,n,r,s,t[e+1],5,-165796510),s=u(s,i,n,r,t[e+6],9,-1069501632),r=u(r,s,i,n,t[e+11],14,643717713),n=u(n,r,s,i,t[e],20,-373897302),i=u(i,n,r,s,t[e+5],5,-701558691),s=u(s,i,n,r,t[e+10],9,38016083),r=u(r,s,i,n,t[e+15],14,-660478335),n=u(n,r,s,i,t[e+4],20,-405537848),i=u(i,n,r,s,t[e+9],5,568446438),s=u(s,i,n,r,t[e+14],9,-1019803690),r=u(r,s,i,n,t[e+3],14,-187363961),n=u(n,r,s,i,t[e+8],20,1163531501),i=u(i,n,r,s,t[e+13],5,-1444681467),s=u(s,i,n,r,t[e+2],9,-51403784),r=u(r,s,i,n,t[e+7],14,1735328473),n=u(n,r,s,i,t[e+12],20,-1926607734),i=d(i,n,r,s,t[e+5],4,-378558),s=d(s,i,n,r,t[e+8],11,-2022574463),r=d(r,s,i,n,t[e+11],16,1839030562),n=d(n,r,s,i,t[e+14],23,-35309556),i=d(i,n,r,s,t[e+1],4,-1530992060),s=d(s,i,n,r,t[e+4],11,1272893353),r=d(r,s,i,n,t[e+7],16,-155497632),n=d(n,r,s,i,t[e+10],23,-1094730640),i=d(i,n,r,s,t[e+13],4,681279174),s=d(s,i,n,r,t[e],11,-358537222),r=d(r,s,i,n,t[e+3],16,-722521979),n=d(n,r,s,i,t[e+6],23,76029189),i=d(i,n,r,s,t[e+9],4,-640364487),s=d(s,i,n,r,t[e+12],11,-421815835),r=d(r,s,i,n,t[e+15],16,530742520),n=d(n,r,s,i,t[e+2],23,-995338651),i=f(i,n,r,s,t[e],6,-198630844),s=f(s,i,n,r,t[e+7],10,1126891415),r=f(r,s,i,n,t[e+14],15,-1416354905),n=f(n,r,s,i,t[e+5],21,-57434055),i=f(i,n,r,s,t[e+12],6,1700485571),s=f(s,i,n,r,t[e+3],10,-1894986606),r=f(r,s,i,n,t[e+10],15,-1051523),n=f(n,r,s,i,t[e+1],21,-2054922799),i=f(i,n,r,s,t[e+8],6,1873313359),s=f(s,i,n,r,t[e+15],10,-30611744),r=f(r,s,i,n,t[e+6],15,-1560198380),n=f(n,r,s,i,t[e+13],21,1309151649),i=f(i,n,r,s,t[e+4],6,-145523070),s=f(s,i,n,r,t[e+11],10,-1120210379),r=f(r,s,i,n,t[e+2],15,718787259),n=f(n,r,s,i,t[e+9],21,-343485551),i=o(i,a),n=o(n,h),r=o(r,l),s=o(s,p)}return[i,n,r,s]}function g(t,e=n.Hex){const i=e||n.Base64,s=p(a(t),t.length*r);switch(i){case n.Raw:return s;case n.Hex:return function(t){const e="0123456789abcdef",i=[];for(let n=0,r=4*t.length;n<r;n++)i.push(e.charAt(t[n>>2]>>n%4*8+4&15)+e.charAt(t[n>>2]>>n%4*8&15));return i.join("")}(s);case n.String:return h(s);case n.Base64:return function(t){const e=[];for(let i=0,n=4*t.length;i<n;i+=3){const n=(t[i>>2]>>i%4*8&255)<<16|(t[i+1>>2]>>(i+1)%4*8&255)<<8|t[i+2>>2]>>(i+2)%4*8&255;for(let r=0;r<4;r++)8*i+6*r>32*t.length?e.push("="):e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-r)&63))}return e.join("")}(s)}}},85408:function(t,e,i){"use strict";i.d(e,{F:function(){return h},Ti:function(){return r}});var n=i(7187);const r=-3,s=r-1;var o,a;(a=o||(o={}))[a.ALL=0]="ALL",a[a.SOME=1]="SOME";class h{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.A,this._users=new n.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,e){const i=this._db.get(t.id+e);return i?.size??0}put(t,e,i,n,a){e=t.id+e;const h=this._db.get(e);if(h&&(this._size-=h.size,t.size-=h.size,this._db.delete(e),h.entry!==i&&this._notifyRemove(e,h.entry,h.size,o.ALL)),n>this._maxSize)return void this._notifyRemove(e,i,n,o.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${e}`),void this._notifyRemove(e,i,0,o.ALL);const c=1+Math.max(a,s)-r;this._db.set(e,new l(i,n,c)),this._size+=n,t.size+=n,this._checkSize()}updateSize(t,e,i,n){e=t.id+e;const r=this._db.get(e);if(r&&r.entry===i){for(this._size-=r.size,t.size-=r.size;n>this._maxSize;){const t=this._notifyRemove(e,i,n,o.SOME);if(!(null!=t&&t>0))return void this._db.delete(e);n=t}r.size=n,this._size+=n,t.size+=n,this._checkSize()}}pop(t,e){e=t.id+e;const i=this._db.get(e);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(e),++this._hit,i.entry;++this._miss}get(t,e){e=t.id+e;const i=this._db.get(e);if(void 0!==i)return this._db.delete(e),i.lives=i.lifetime,this._db.set(e,i),++this._hit,i.entry;++this._miss}peek(t,e){const i=this._db.get(t.id+e);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},i=new Array;this._db.forEach(((t,n)=>{const r=t.lifetime;i[r]=(i[r]||0)+t.size,this._users.forAll((i=>{const{id:r,name:s}=i;if(n.startsWith(r)){const i=e[s]||0;e[s]=i+t.size}}))}));const n={};this._users.forAll((t=>{const i=t.name;if("hitRate"in t&&"number"==typeof t.hitRate&&!isNaN(t.hitRate)&&t.hitRate>0){const r=e[i]||0;e[i]=r,n[i]=Math.round(100*t.hitRate)+"%"}else n[i]="0%"}));const s=Object.keys(e);s.sort(((t,i)=>e[i]-e[t])),s.forEach((i=>t[i]=Math.round(e[i]/2**20)+"MB / "+n[i]));for(let e=i.length-1;e>=0;--e){const n=i[e];n&&(t["Priority "+(e+r-1)]=Math.round(n/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){const e=t.id;this._db.forEach(((t,i)=>{i.startsWith(e)&&(this._size-=t.size,this._db.delete(i),this._notifyRemove(i,t.entry,t.size,o.ALL))})),t.size=0}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,t.size,o.ALL))),this._users.forAll((t=>t.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i,n){let r;return this._removeFuncs.some((s=>{if(t.startsWith(s[0])){const t=s[1](e,n,i);return"number"==typeof t&&(r=t),!0}return!1})),r}_checkSize(){this._users.forAll((t=>this._checkSizeLimits(t))),this._checkSizeLimits()}_checkSizeLimits(t){const e=t??this;if(e.maxSize<0||e.size<=e.maxSize)return;const i=t?.id;let n=!0;for(;n;){n=!1;for(const[r,s]of this._db)if(0===s.lifetime&&(!i||r.startsWith(i))){if(this._purgeItem(r,s,t),e.size<=.9*e.maxSize)return;n||=this._db.has(r)}}for(const[n,r]of this._db)if((!i||n.startsWith(i))&&(this._purgeItem(n,r,t),e.size<=.9*e.maxSize))return}_purgeItem(t,e,i=this._users.find((e=>t.startsWith(e.id)))){if(this._db.delete(t),e.lives<=1){this._size-=e.size,i&&(i.size-=e.size);const n=this._notifyRemove(t,e.entry,e.size,o.SOME);null!=n&&n>0&&(this._size+=n,i&&(i.size+=n),e.lives=e.lifetime,e.size=n,this._db.set(t,e))}else--e.lives,this._db.set(t,e)}}class l{constructor(t,e,i){this.entry=t,this.size=e,this.lifetime=i,this.lives=i}}},7970:function(t,e,i){"use strict";i.d(e,{O:function(){return n}});class n{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return 0===this._outer.size}get(t,e){return this._outer.get(t)?.get(e)}getInner(t){return this._outer.get(t)}set(t,e,i){const n=this._outer.get(t);n?n.set(e,i):this._outer.set(t,new Map([[e,i]]))}delete(t,e){const i=this._outer.get(t);i&&(i.delete(e),0===i.size&&this._outer.delete(t))}forEach(t){this._outer.forEach(((e,i)=>t(e,i)))}forAll(t){for(const e of this._outer.values())for(const i of e.values())t(i)}}},85876:function(t,e,i){"use strict";i.d(e,{A:function(){return s}});var n=i(44567),r=i(87085);class s{constructor(t){this._observable=new r.I,this._set=new Set(t)}get size(){return(0,n.gc)(this._observable),this._set.size}add(t){const e=this._set.size;return this._set.add(t),this._set.size!==e&&this._observable.notify(),this}clear(){this._set.size>0&&(this._set.clear(),this._observable.notify())}delete(t){const e=this._set.delete(t);return e&&this._observable.notify(),e}entries(){return(0,n.gc)(this._observable),this._set.entries()}forEach(t,e){(0,n.gc)(this._observable),this._set.forEach(((i,n)=>t.call(e,i,n,this)),e)}has(t){return(0,n.gc)(this._observable),this._set.has(t)}keys(){return(0,n.gc)(this._observable),this._set.keys()}values(){return(0,n.gc)(this._observable),this._set.values()}[Symbol.iterator](){return(0,n.gc)(this._observable),this._set[Symbol.iterator]()}get[Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}},84016:function(t,e,i){"use strict";i.d(e,{O:function(){return r}});var n=i(25591);const r=()=>n.default.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches},18627:function(t,e,i){"use strict";i.d(e,{P:function(){return f}});var n=i(39819),r=i(92709),s=i(73888),o=i(90683),a=i(66110),h=i(75779),l=i(72977),c=i(23502),u=i(82465),d=i(60534);function f(t){const e=t?.origins??[void 0];return(i,n)=>{const r=function(t,e,i){if("resource"===t?.type)return function(t,e,i){const n=(0,h.z4)(e,i);return{type:String,read:(t,e,i)=>{const r=(0,d.r)(t,e,i);return n.type===String?r:"function"==typeof n.type?new n.type({url:r}):void 0},write:{writer(e,r,a,h){if(!h?.resources)return"string"==typeof e?void(r[a]=(0,d.t)(e,h)):void(r[a]=e.write({},h));const c=function(t){return null==t?null:"string"==typeof t?t:t.url}(e),f=(0,d.t)(c,{...h,verifyItemRelativeUrls:h?.verifyItemRelativeUrls?{writtenUrls:h.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},d.M.NO),m=n.type!==String&&(!(0,s.H)(this)||h?.origin&&this.originIdOf(i)>(0,l.aB)(h.origin)),y={object:this,propertyName:i,value:e,targetUrl:f,dest:r,targetPropertyName:a,context:h,params:t};h?.portalItem&&f&&!(0,o.oP)(f)?m&&t?.contentAddressed?p(y):m?function(t){const{context:e,targetUrl:i,params:n,value:r,dest:s,targetPropertyName:a}=t;if(!e.portalItem)return;const h=e.portalItem.resourceFromPath(i),l=v(r,i,e),c=(0,u.n)(l),d=(0,o.Zo)(h.path),f=n?.compress??!1;c===d?(e.resources&&g({...t,resource:h,content:l,compress:f,updates:e.resources.toUpdate}),s[a]=i):p(t)}(y):function({context:t,targetUrl:e,dest:i,targetPropertyName:n}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),i[n]=e)}(y):h?.portalItem&&(null==f||null!=(0,d.i)(f)||(0,o.w8)(f)||m)?p(y):r[a]=f}}}}(t,e,i);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:e}=d.b;return{read:t,write:e}}}}(t,i,n);for(const t of e){const e=(0,c.rM)(i,t,n);for(const t in r)e[t]=r[t]}}}function p(t){const{targetUrl:e,params:i,value:s,context:h,dest:l,targetPropertyName:c}=t;if(!h.portalItem)return;const f=(0,d.p)(e),p=v(s,e,h);if(i?.contentAddressed&&"json"!==p.type)return void h.messages?.push(new n.A("persistable:contentAddressingUnsupported",`Property "${c}" is trying to serializing a resource with content of type ${p.type} with content addressing. Content addressing is only supported for json resources.`,{content:p}));const m=i?.contentAddressed&&"json"===p.type?(0,r.d)(p.jsonString):f?.filename??(0,a.lk)(),y=(0,o.fj)(i?.prefix??f?.prefix,m),_=`${y}.${(0,u.n)(p)}`;if(i?.contentAddressed&&h.resources&&"json"===p.type){const t=h.resources.toKeep.find((({resource:t})=>t.path===_))??h.resources.toAdd.find((({resource:t})=>t.path===_));if(t)return void(l[c]=t.resource.itemRelativeUrl)}const b=h.portalItem.resourceFromPath(_);(0,o.w8)(e)&&h.resources&&h.resources.pendingOperations.push((0,o.tk)(e).then((t=>{b.path=`${y}.${(0,u.n)({type:"blob",blob:t})}`,l[c]=b.itemRelativeUrl})).catch((()=>{})));const w=i?.compress??!1;h.resources&&g({...t,resource:b,content:p,compress:w,updates:h.resources.toAdd}),l[c]=b.itemRelativeUrl}function g({object:t,propertyName:e,updates:i,resource:n,content:r,compress:s}){i.push({resource:n,content:r,compress:s,finish:i=>{!function(t,e,i){"string"==typeof t[e]?t[e]=i.url:t[e].url=i.url}(t,e,i)}})}function v(t,e,i){return"string"==typeof t?{type:"url",url:e}:{type:"json",jsonString:JSON.stringify(t.toJSON(i))}}},72952:function(t,e,i){"use strict";i.d(e,{EB:function(){return f},Im:function(){return v},Mj:function(){return d},Ui:function(){return g},w2:function(){return p}});var n=i(83525),r=i(78879),s=i(63693);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(t){return t instanceof n.A}function h(t){return t instanceof r.A?Object.keys(t.items):a(t)?(0,s.oY)(t).keys():t?Object.keys(t):[]}function l(t,e){return t instanceof r.A?t.items[e]:t[e]}function c(t){return t?t.declaredClass:null}function u(t,e){const i=t.diff;if(i&&"function"==typeof i)return i(t,e);const n=h(t),r=h(e);if(0===n.length&&0===r.length)return;if(!n.length||!r.length||function(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}(t,e))return{type:"complete",oldValue:t,newValue:e};const s=r.filter((t=>!n.includes(t))),d=n.filter((t=>!r.includes(t))),f=n.filter((i=>r.includes(i)&&l(t,i)!==l(e,i))).concat(s,d).sort(),p=c(t);if(p&&o.has(p)&&f.length)return{type:"complete",oldValue:t,newValue:e};let g;const v=a(t)&&a(e);for(const n of f){const r=l(t,n),s=l(e,n);let o;if((v||"function"!=typeof r&&"function"!=typeof s)&&r!==s&&(null!=r||null!=s)){if(i&&i[n]&&"function"==typeof i[n])o=i[n]?.(r,s);else if(r instanceof Date&&s instanceof Date){if(r.getTime()===s.getTime())continue;o={type:"complete",oldValue:r,newValue:s}}else o="object"==typeof r&&"object"==typeof s&&c(r)===c(s)?u(r,s):{type:"complete",oldValue:r,newValue:s};null!=o&&(null!=g?g.diff[n]=o:g={type:"partial",diff:{[n]:o}})}}return g}function d(t,e){return f(t,e)}function f(t,e){if(null==t)return!1;const i=e.split(".");let n=t;for(const t of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[t];if(!e)return!1;n=e}}return!0}function p(t,e){if(!t)return!1;if("partial"===t.type){const i=Object.keys(t.diff);return 1===i.length&&i[0]===e}return!1}function g(t,e){if("function"!=typeof t&&"function"!=typeof e&&(null!=t||null!=e))return null==t||null==e||"object"==typeof t&&"object"==typeof e&&c(t)!==c(e)?{type:"complete",oldValue:t,newValue:e}:u(t,e)}function v(t){if(null==t)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const t of e.added)if(!v(t))return!1;for(const t of e.removed)if(!v(t))return!1;for(const t of e.changed)if(!v(t))return!1;return!0}case"partial":for(const e in t.diff)if(!v(t.diff[e]))return!1;return!0}}},75505:function(t,e,i){"use strict";i.d(e,{$:function(){return y},IB:function(){return a},Iy:function(){return P},N2:function(){return _},QP:function(){return O},RH:function(){return w},Vl:function(){return C},Ws:function(){return x},ZD:function(){return b},_L:function(){return E},bJ:function(){return M},e$:function(){return S},f6:function(){return I},pW:function(){return T},pf:function(){return R}});var n=i(52874),r=i(50659),s=i(21609),o=(i(33400),i(41546));function a(t){return"r"in t&&"g"in t&&"b"in t}function h(t){return"h"in t&&"s"in t&&"v"in t}function l(t){return"l"in t&&"a"in t&&"b"in t}function c(t){return"l"in t&&"c"in t&&"h"in t}const u=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],d=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function f(t,e){const i=[];let n,r;if(t[0].length!==e.length)throw new Error("dimensions do not match");const s=t.length,o=t[0].length;let a=0;for(n=0;n<s;n++){for(a=0,r=0;r<o;r++)a+=t[n][r]*e[r];i.push(a)}return i}function p(t){const e=[t.r/255,t.g/255,t.b/255].map((t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4)),i=f(u,e);return{x:100*i[0],y:100*i[1],z:100*i[2]}}function g(t){const e=f(d,[t.x/100,t.y/100,t.z/100]).map((t=>{const e=t<=.0031308?12.92*t:1.055*t**(1/2.4)-.055;return Math.min(1,Math.max(e,0))}));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function v(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map((t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29));return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function m(t){const e=t.l,i=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map((t=>t>6/29?t**3:3*(6/29)**2*(t-4/29)));return{x:95.047*i[0],y:100*i[1],z:108.883*i[2]}}function y(t){return a(t)?t:c(t)?function(t){return g(m(function(t){const e=t.l,i=t.c,n=t.h;return{l:e,a:i*Math.cos(n),b:i*Math.sin(n)}}(t)))}(t):l(t)?function(t){return g(m(t))}(t):function(t){return"x"in t&&"y"in t&&"z"in t}(t)?g(t):h(t)?function(t){const e=(t.h+360)%360/60,i=t.s/100,n=t.v/100*255,r=n*i,s=r*(1-Math.abs(e%2-1));let o;switch(Math.floor(e)){case 0:o={r:r,g:s,b:0};break;case 1:o={r:s,g:r,b:0};break;case 2:o={r:0,g:r,b:s};break;case 3:o={r:0,g:s,b:r};break;case 4:o={r:s,g:0,b:r};break;case 5:case 6:o={r:r,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-r),o.g=Math.round(o.g+n-r),o.b=Math.round(o.b+n-r),o}(t):t}function _(t){return h(t)?t:function(t){const e=t.r,i=t.g,n=t.b,r=Math.max(e,i,n),s=r-Math.min(e,i,n);let o=r,a=0===s?0:r===e?(i-n)/s%6:r===i?(n-e)/s+2:(e-i)/s+4,h=0===s?0:s/o;return a<0&&(a+=6),a*=60,h*=100,o*=100/255,{h:a,s:h,v:o}}(y(t))}function b(t){return l(t)?t:function(t){return v(p(t))}(y(t))}function w(t){return c(t)?t:function(t){return function(t){const e=t.l,i=t.a,n=t.b,r=Math.sqrt(i*i+n*n);let s=Math.atan2(n,i);return s=s>0?s:s+2*Math.PI,{l:e,c:r,h:s}}(v(p(t)))}(y(t))}function x(t,e){const{r:i,g:r,b:s}=e?.ignoreAlpha?t:function(t){let{r:e,g:i,b:r,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),i=Math.round(s*i+255*(1-s)),r=Math.round(s*r+255*(1-s))),new n.A({r:e,g:i,b:r})}(t);return.2126*i+.7152*r+.0722*s}var T,A;function M(t,e=T.High){return x(t,{ignoreAlpha:!0})>e?new n.A([0,0,0,t.a]):new n.A([255,255,255,t.a])}function S(t,e){const i=b(t);i.l*=1-e;const n=y(i),r=t.clone();return r.setColor(n),r.a=t.a,r}function E(t,e){const i=t.clone();return i.a*=e,i}function C(t,e){const i=_(t);i.s*=e;const n=y(i),r=t.clone();return r.setColor(n),r.a=t.a,r}function O(t){return n.A.toUnitRGBA(t)}function R(t){return(0,o.fA)(t[0],t[1],t[2],t.length>3?t[3]:1)}function I(t,e){const i=n.A.toUnitRGBA(t);return i[3]*=e,i}function P(t,e,i={}){if(0===t.length||e<=0)return[];if(1===(t=t.map((t=>"string"==typeof t?new n.A(t):t))).length||1===e){const i=[],n=t[0];for(let t=0;t<e;t++)i.push(n.clone());return i}if(i.shuffle&&(t=(0,r.k4)((0,s.o8)(t),i.seed)),t.length>=e){const i=[],n=(t.length-1)/(e-1);for(let r=0;r<e;r++){const e=Math.round(r*n);i.push(t[e].clone())}return i}return function(t,e,i={}){const n=[],s=t.length-1,o=Math.ceil((e-t.length)/s);t:for(let r=0;r<s;r++){const s=t[r],a=t[r+1];for(let r=1;r<=o;r++){const h=r/(o+1);if(n.push(D(s,a,h,i)),n.length+t.length===e)break t}}return[...t.map((t=>t.clone())),...(0,r.k4)(n,i.seed??1)]}(t,e,i)}(A=T||(T={}))[A.Low=160]="Low",A[A.High=225]="High";const N=(t,e)=>{const i=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+i))};function D(t,e,i,s={}){const o=t.r,a=t.g,h=t.b,l=e.r,c=e.g,u=e.b,d=Math.round(o+(l-o)*i),f=Math.round(a+(c-a)*i),p=Math.round(h+(u-h)*i);if(!s.offset)return new n.A([d,f,p]);const g=(0,r.Mo)(s.seed);return new n.A([N(d,g),N(f,g),N(p,g)])}},88264:function(t,e,i){"use strict";function n(t){return"string"==typeof t?document.getElementById(t):t??null}function r(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}i.d(e,{$:function(){return n},y:function(){return r}})},5161:function(t,e,i){"use strict";i.d(e,{T:function(){return s},U:function(){return r}});var n=i(15774);function r(t,e,i=0){const r=(0,n.qE)(t,0,h);for(let t=0;t<4;t++)e[i+t]=Math.floor(256*l(r*o[t]))}function s(t,e=0){let i=0;for(let n=0;n<4;n++)i+=t[e+n]*a[n];return i}const o=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],h=s(new Uint8ClampedArray([255,255,255,255]));function l(t){return t-Math.floor(t)}},12978:function(t,e,i){"use strict";function n(){return[1,0,0,1,0,0]}function r(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}i.d(e,{o8:function(){return r},vt:function(){return n}});Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:[1,0,0,1,0,0],clone:r,create:n,createView:function(t,e){return new Float64Array(t,e,6)},fromValues:function(t,e,i,n,r,s){return[t,e,i,n,r,s]}},Symbol.toStringTag,{value:"Module"}))},43274:function(t,e,i){"use strict";function n(){return new Float32Array(3)}function r(t){const e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(t,e,i){const n=new Float32Array(3);return n[0]=t,n[1]=e,n[2]=i,n}function o(){return n()}function a(){return s(1,1,1)}function h(){return s(1,0,0)}function l(){return s(0,1,0)}function c(){return s(0,0,1)}i.d(e,{fA:function(){return s},o8:function(){return r},vt:function(){return n}});const u=o(),d=a(),f=h(),p=l(),g=c();Object.freeze(Object.defineProperty({__proto__:null,ONES:d,UNIT_X:f,UNIT_Y:p,UNIT_Z:g,ZEROS:u,clone:r,create:n,createView:function(t,e){return new Float32Array(t,e,3)},fromValues:s,ones:a,unitX:h,unitY:l,unitZ:c,zeros:o},Symbol.toStringTag,{value:"Module"}))},67348:function(t,e,i){"use strict";i.d(e,{$0:function(){return u},B8:function(){return o},CV:function(){return d},D_:function(){return r},Tl:function(){return c},e$:function(){return h},hZ:function(){return s},hs:function(){return l},kN:function(){return f},lw:function(){return a}});var n=i(8527);function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s(t,e,i,n,r,s,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t[4]=s,t[5]=o,t}function o(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5];let h=i*s-n*r;return h?(h=1/h,t[0]=s*h,t[1]=-n*h,t[2]=-r*h,t[3]=i*h,t[4]=(r*a-s*o)*h,t[5]=(n*o-i*a)*h,t):null}function a(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],l=i[0],c=i[1],u=i[2],d=i[3],f=i[4],p=i[5];return t[0]=n*l+s*c,t[1]=r*l+o*c,t[2]=n*u+s*d,t[3]=r*u+o*d,t[4]=n*f+s*p+a,t[5]=r*f+o*p+h,t}function h(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],l=Math.sin(i),c=Math.cos(i);return t[0]=n*c+s*l,t[1]=r*c+o*l,t[2]=n*-l+s*c,t[3]=r*-l+o*c,t[4]=a,t[5]=h,t}function l(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],l=i[0],c=i[1];return t[0]=n*l,t[1]=r*l,t[2]=s*c,t[3]=o*c,t[4]=a,t[5]=h,t}function c(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=e[4],h=e[5],l=i[0],c=i[1];return t[0]=n,t[1]=r,t[2]=s,t[3]=o,t[4]=n*l+s*c+a,t[5]=r*l+o*c+h,t}function u(t,e){const i=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=i,t[2]=-i,t[3]=n,t[4]=0,t[5]=0,t}function d(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function f(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function p(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}const g=a,v=p;Object.freeze(Object.defineProperty({__proto__:null,add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},equals:function(t,e){const i=t[0],r=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=e[0],c=e[1],u=e[2],d=e[3],f=e[4],p=e[5],g=(0,n.FD)();return Math.abs(i-l)<=g*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(r-c)<=g*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-u)<=g*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(o-d)<=g*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=g*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(h-p)<=g*Math.max(1,Math.abs(h),Math.abs(p))},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)},fromRotation:u,fromScaling:d,fromTranslation:f,identity:r,invert:o,mul:g,multiply:a,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},multiplyScalarAndAdd:function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t[4]=e[4]+i[4]*n,t[5]=e[5]+i[5]*n,t},rotate:h,scale:l,set:s,str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},sub:v,subtract:p,translate:c},Symbol.toStringTag,{value:"Module"}))},32237:function(t,e,i){"use strict";i.d(e,{A6:function(){return v},B8:function(){return f},Xd:function(){return c},Xr:function(){return p},Yc:function(){return I},hZ:function(){return y},lw:function(){return u},t2:function(){return O},x8:function(){return l}});var n=i(87725),r=i(61769),s=i(32501),o=i(8527),a=i(20551),h=i(33400);function l(t,e,i){i*=.5;const n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t}function c(t,e){const i=2*Math.acos(e[3]),n=Math.sin(i/2);return n>(0,o.FD)()?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),i}function u(t,e,i){const n=e[0],r=e[1],s=e[2],o=e[3],a=i[0],h=i[1],l=i[2],c=i[3];return t[0]=n*c+o*a+r*l-s*h,t[1]=r*c+o*h+s*a-n*l,t[2]=s*c+o*l+n*h-r*a,t[3]=o*c-n*a-r*h-s*l,t}function d(t,e,i,n){const r=e[0],s=e[1],a=e[2],h=e[3];let l,c,u,d,f,p=i[0],g=i[1],v=i[2],m=i[3];return c=r*p+s*g+a*v+h*m,c<0&&(c=-c,p=-p,g=-g,v=-v,m=-m),1-c>(0,o.FD)()?(l=Math.acos(c),u=Math.sin(l),d=Math.sin((1-n)*l)/u,f=Math.sin(n*l)/u):(d=1-n,f=n),t[0]=d*r+f*p,t[1]=d*s+f*g,t[2]=d*a+f*v,t[3]=d*h+f*m,t}function f(t,e){const i=e[0],n=e[1],r=e[2],s=e[3],o=i*i+n*n+r*r+s*s,a=o?1/o:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=s*a,t}function p(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function g(t,e){const i=e[0]+e[4]+e[8];let n;if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);const r=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*r+r]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*r+s]-e[3*s+r])*n,t[r]=(e[3*r+i]+e[3*i+r])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}function v(t,e,i,n){const r=.5*Math.PI/180;e*=r,i*=r,n*=r;const s=Math.sin(e),o=Math.cos(e),a=Math.sin(i),h=Math.cos(i),l=Math.sin(n),c=Math.cos(n);return t[0]=s*h*c-o*a*l,t[1]=o*a*c+s*h*l,t[2]=o*h*l-s*a*c,t[3]=o*h*c+s*a*l,t}const m=h.c,y=h.s,_=h.g,b=u,w=h.d,x=h.h,T=h.l,A=h.j,M=A,S=h.b,E=S,C=h.n,O=h.a,R=h.e;function I(t,e,i){const n=(0,a.f)(e,i);return n<-.999999?((0,a.e)(P,N,e),(0,a.G)(P)<1e-6&&(0,a.e)(P,D,e),(0,a.n)(P,P),l(t,P,Math.PI),t):n>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,a.e)(P,e,i),t[0]=P[0],t[1]=P[1],t[2]=P[2],t[3]=1+n,C(t,t))}const P=(0,s.vt)(),N=(0,s.fA)(1,0,0),D=(0,s.fA)(0,1,0),L=(0,r.vt)(),z=(0,r.vt)(),j=(0,n.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:_,calculateW:function(t,e){const i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},conjugate:p,copy:m,dot:x,equals:R,exactEquals:O,fromEuler:v,fromMat3:g,getAxisAngle:c,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:f,len:M,length:A,lerp:T,mul:b,multiply:u,normalize:C,random:function(t){const e=o.Ov,i=e(),n=e(),r=e(),s=Math.sqrt(1-i),a=Math.sqrt(i);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t},rotateX:function(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h+o*a,t[1]=r*h+s*a,t[2]=s*h-r*a,t[3]=o*h-n*a,t},rotateY:function(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h-s*a,t[1]=r*h+o*a,t[2]=s*h+n*a,t[3]=o*h-r*a,t},rotateZ:function(t,e,i){i*=.5;const n=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(i),h=Math.cos(i);return t[0]=n*h+r*a,t[1]=r*h-n*a,t[2]=s*h+o*a,t[3]=o*h-s*a,t},rotationTo:I,scale:w,set:y,setAxes:function(t,e,i,n){const r=j;return r[0]=i[0],r[3]=i[1],r[6]=i[2],r[1]=n[0],r[4]=n[1],r[7]=n[2],r[2]=-e[0],r[5]=-e[1],r[8]=-e[2],C(t,g(t,r))},setAxisAngle:l,slerp:d,sqlerp:function(t,e,i,n,r,s){return d(L,e,r,s),d(z,i,n,s),d(t,L,z,2*s*(1-s)),t},sqrLen:E,squaredLength:S,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))},7213:function(t,e,i){"use strict";function n(t){let e,i,n=[],r=!1;return function(...s){return r&&e===this&&function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}(s,n)||(i=t.apply(this,s),e=this,n=s,r=!0),i}}i.d(e,{B:function(){return n}})},73888:function(t,e,i){"use strict";function n(t){return t&&"getAtOrigin"in t&&"originOf"in t}i.d(e,{H:function(){return n}})},88226:function(t,e,i){"use strict";i.d(e,{Jd:function(){return f},Nk:function(){return h},OM:function(){return d},Oo:function(){return u},ix:function(){return l},yh:function(){return c}});var n=i(16691),r=i(56275),s=i(15999);function o(t,e,i,n=2,o="abbr"){return(0,s.zJ)(t,(0,r.kM)(e,i).value,i,n,o)}function a(t,e,i,n=2,o="abbr"){return(0,s.nD)(t,(0,r.kM)(e,i).value,i,n,o)}function h(t,e,i,r=n.ie,o=!0){return(0,s.Me)(t.value,t.unit,t.rotationType,e,i,r,o)}function l(t,e,i,n,r="abbr"){switch(n=n??2,i){case"imperial":return function(t,e,i=2,n="abbr"){return(0,s.tr)(t,e.value,e.unit,i,n)}(t,e,n,r);case"metric":return function(t,e,i=2,n="abbr"){return(0,s.Ee)(t,e.value,e.unit,i,n)}(t,e,n,r);default:return o(t,e,i,n,r)}}function c(t,e,i,n=2,r="abbr"){switch(i){case"imperial":return function(t,e,i=2,n="abbr"){return(0,s.J1)(t,e.value,e.unit,i,n)}(t,e,n,r);case"metric":return function(t,e,i=2,n="abbr"){return(0,s.Mm)(t,e.value,e.unit,i,n)}(t,e,n,r);default:return a(t,e,i,n,r)}}function u(t,e,i,n=2,r="abbr"){switch(i){case"imperial":return function(t,e,i=2,n="abbr"){return(0,s.t_)(t,e.value,e.unit,i,n)}(t,e,n,r);case"metric":return function(t,e,i=2,n="abbr"){return(0,s.W4)(t,e.value,e.unit,i,n)}(t,e,n,r);default:return o(t,e,i,n,r)}}function d(t,e,i,n=2,r="abbr"){switch(i){case"imperial":return function(t,e,i=2,n="abbr"){return(0,s.LF)(t,e.value,e.unit,i,n)}(t,e,n,r);case"metric":return function(t,e,i=2,n="abbr"){return(0,s.e_)(t,e.value,e.unit,i,n)}(t,e,n,r);default:return a(t,e,i,n,r)}}function f(t,e,i,n=2,r="abbr"){switch(i){case"imperial":return function(t,e,i=2,n="abbr"){return(0,s.Sz)(t,e.value,e.unit,i,n)}(t,e,n,r);case"metric":return function(t,e,i=2,n="abbr"){return(0,s.zq)(t,e.value,e.unit,i,n)}(t,e,n,r);default:return o(t,e,i,n,r)}}},20248:function(t,e,i){"use strict";i.d(e,{U:function(){return c}});var n=i(53804),r=i(83525),s=i(61226),o=i(28181),a=i(74087),h=i(23502),l=i(65953);let c=class extends r.A{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,e,i={}){return this._installWatch(t,e,i,o.watch)}addWhen(t,e,i={}){return this._installWatch(t,e,i,o.when)}addOnCollectionChange(t,e,{initial:i=!1,final:n=!1}={}){const r=++this._handleId;return this.addHandles([(0,o.on)(t,"after-changes",this._createSyncUpdatingCallback(),o.OH),(0,o.on)(t,"change",e,{onListenerAdd:i?t=>e({added:t.toArray(),removed:[]}):void 0,onListenerRemove:n?t=>e({added:[],removed:t.toArray()}):void 0})],r),(0,s.hA)((()=>this.removeHandles(r)))}addPromise(t){if(null==t)return t;const e=++this._handleId;this.addHandles((0,s.hA)((()=>{this._pendingPromises.delete(t)&&(0!==this._pendingPromises.size||this.hasHandles(u)||this._set("updating",!1))})),e),this._pendingPromises.add(t),this._set("updating",!0);const i=()=>this.removeHandles(e);return t.then(i,i),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,e,i={},n){const r=++this._handleId;i.sync||this._installSyncUpdatingWatch(t,r);const o=n(t,e,i);return this.addHandles(o,r),(0,s.hA)((()=>this.removeHandles(r)))}_installSyncUpdatingWatch(t,e){const i=this._createSyncUpdatingCallback(),n=(0,o.watch)(t,i,{sync:!0,equals:()=>!1});return this.addHandles(n,e),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(u),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles((0,a._)((()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(u))})),u)}}};(0,n._)([(0,h.MZ)({readOnly:!0})],c.prototype,"updating",void 0),c=(0,n._)([(0,l.$)("esri.core.support.UpdatingHandles")],c);const u=-42},15999:function(t,e,i){"use strict";i.d(e,{Cq:function(){return c},Ee:function(){return f},J1:function(){return y},LF:function(){return b},Me:function(){return A},Mm:function(){return p},Sz:function(){return x},W4:function(){return g},e_:function(){return v},nD:function(){return d},t_:function(){return _},tr:function(){return m},v7:function(){return E},zJ:function(){return u},zq:function(){return w}});var n=i(69296),r=i(16691),s=i(15774),o=i(56275),a=i(50944),h=i(62938),l=i(2900);function c(t,e,i){return t.units[e][i]}function u(t,e,i,n=2,r="abbr"){return`${(0,l.ZV)(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:e>0?"never":"exceptZero"})} ${c(t,i,r)}`}function d(t,e,i,n=2,r="abbr"){return`${(0,l.ZV)(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${c(t,i,r)}`}function f(t,e,i,n=2,r="abbr"){const s=(0,h.x0)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}function p(t,e,i,n=2,r="abbr"){const s=(0,h.x0)(e,i);return d(t,(0,h.oU)(e,i,s),s,n,r)}function g(t,e,i,n=2,r="abbr"){const s=(0,h.x$)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}function v(t,e,i,n=2,r="abbr"){const s=(0,h.x$)(e,i);return d(t,(0,h.oU)(e,i,s),s,n,r)}function m(t,e,i,n=2,r="abbr"){const s=(0,h.OU)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}function y(t,e,i,n=2,r="abbr"){const s=(0,h.OU)(e,i);return d(t,(0,h.oU)(e,i,s),s,n,r)}function _(t,e,i,n=2,r="abbr"){const s=(0,h.y7)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}function b(t,e,i,n=2,r="abbr"){const s=(0,h.y7)(e,i);return d(t,(0,h.oU)(e,i,s),s,n,r)}function w(t,e,i,n=2,r="abbr"){const s=(0,h.wv)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}function x(t,e,i,n=2,r="abbr"){const s=(0,h.TL)(e,i);return u(t,(0,h.oU)(e,i,s),s,n,r)}const T=(t,e)=>({style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:e,minimumFractionDigits:e,signDisplay:t>0?"never":"exceptZero"});function A(t,e,i,n,s,a=r.ie,c=!0){let u=a.normalize((0,o.g2)((0,h.oU)(t,e,"degrees"),i,n),0,c);const d=T(u,s??2);return u=function(t,e){const i=JSON.stringify(e);let n=M.get(i);return n||(n=new Intl.NumberFormat("en-US",e),M.set(i,n)),/^[-+]?360\.?0*°?$/.test(n.format(t))?0:t}(u,d),(0,l.ZV)(u,d)}const M=new Map;const S=["B","kB","MB","GB","TB"];function E(t,e){let i=0===(e=Math.round(e))?0:Math.floor(Math.log(e)/Math.log(n.u.KILOBYTES));i=(0,s.qE)(i,0,S.length-1);const r=(0,l.ZV)(e/n.u.KILOBYTES**i,{maximumFractionDigits:2});return(0,a.HC)(t.units.bytes[S[i]],{fileSize:r})}},66110:function(t,e,i){"use strict";i.d(e,{AG:function(){return a},lk:function(){return r},vD:function(){return o},yS:function(){return s}});const n="randomUUID"in crypto;function r(){if(n)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function s(){return`{${r().toUpperCase()}}`}function o(){return`{${r()}}`}function a(t){const e=t.toUpperCase();return"{"!==t[0]?`{${e}}`:e}},6338:function(t,e,i){"use strict";i.d(e,{Hh:function(){return l},mT:function(){return u},o6:function(){return c},s1:function(){return h},ts:function(){return d}});var n=i(39819),r=i(38305),s=i(45532),o=i(57165),a=i(2900);function h(){return(0,r.i)()}function l(){return(0,r.l)()}function c(t,e){const i=[];t=(t=(t=t.replaceAll(/[\u00B0\u00BA]/g,"^")).replaceAll("′","'")).replaceAll("″",'"');const a=function(t){let e=null;if(t||(t=o.A.WGS84),t.wkid){if(e=r.P.geogcs(t.wkid),!e)throw new n.A("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!t.wkt2&&!t.wkt)throw new n.A("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(e=r.P.fromString(r.a.PE_TYPE_GEOGCS,t.wkt2||t.wkt),!e)throw new n.A("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return e}(e);return r.c.dmsToGeog(a,1,[t],i)?new s.default(i[0][0],i[0][1],e||o.A.WGS84):null}function u(t){return t&&h()?(0,a.$J)(t)??c(`0° 0' 0" N | ${t}`)?.longitude??c(`0 | ${t}`)?.longitude??null:null}function d(t){return t&&h()?(0,a.$J)(t)??c(`${t} | 0° 0' 0" E`)?.latitude??c(`${t} | 0`)?.latitude??null:null}},37322:function(t,e,i){"use strict";i.r(e),i.d(e,{hydratedAdapter:function(){return h}});var n=i(91484),r=i(71673),s=i(45532),o=i(44740),a=i(91508);const h={convertToGEGeometry:function(t,e){if(null==e)return null;let i="cache"in e?e.cache._geVersion:void 0;return null==i&&(i=t.convertJSONToGeometry(e),"cache"in e&&(e.cache._geVersion=i)),i},exportPoint:function(t,e,i){const n=t.hasZ(e),r=t.hasM(e),o=new s.default({x:t.getPointX(e),y:t.getPointY(e),spatialReference:i});return n&&(o.z=t.getPointZ(e)),r&&(o.m=t.getPointM(e)),o.cache._geVersion=e,o},exportPolygon:function(t,e,i){const n=new o.A({rings:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:i});return n.cache._geVersion=e,n},exportPolyline:function(t,e,i){const n=new a.A({paths:t.exportPaths(e),hasZ:t.hasZ(e),hasM:t.hasM(e),spatialReference:i});return n.cache._geVersion=e,n},exportMultipoint:function(t,e,i){const n=new r.A({hasZ:t.hasZ(e),hasM:t.hasM(e),points:t.exportPoints(e),spatialReference:i});return n.cache._geVersion=e,n},exportExtent:function(t,e,i){const r=t.hasZ(e),s=t.hasM(e),o=new n.default({xmin:t.getXMin(e),ymin:t.getYMin(e),xmax:t.getXMax(e),ymax:t.getYMax(e),spatialReference:i});if(r){const i=t.getZExtent(e);o.zmin=i.vmin,o.zmax=i.vmax}if(s){const i=t.getMExtent(e);o.mmin=i.vmin,o.mmax=i.vmax}return o.cache._geVersion=e,o}}},22162:function(t,e,i){"use strict";i.r(e),i.d(e,{buffer:function(){return O},changeDefaultSpatialReferenceTolerance:function(){return W},clearDefaultSpatialReferenceTolerance:function(){return q},clip:function(){return l},contains:function(){return u},convexHull:function(){return T},crosses:function(){return d},cut:function(){return c},densify:function(){return F},difference:function(){return A},disjoint:function(){return y},distance:function(){return f},equals:function(){return p},extendedSpatialReferenceInfo:function(){return h},flipHorizontal:function(){return z},flipVertical:function(){return j},generalize:function(){return k},geodesicArea:function(){return V},geodesicBuffer:function(){return R},geodesicDensify:function(){return H},geodesicLength:function(){return U},intersect:function(){return S},intersectLinesToPoints:function(){return $},intersects:function(){return g},isSimple:function(){return w},nearestCoordinate:function(){return I},nearestVertex:function(){return P},nearestVertices:function(){return N},offset:function(){return C},overlaps:function(){return _},planarArea:function(){return B},planarLength:function(){return G},relate:function(){return b},rotate:function(){return L},simplify:function(){return x},symmetricDifference:function(){return M},touches:function(){return v},union:function(){return E},within:function(){return m}}),i(50917);var n=i(67888),r=i(56901),s=i(37322),o=i(57165);function a(t){const e=Array.isArray(t)?t[0].spatialReference:t.spatialReference;return e?(0,n.PZ)(o.A,e):o.A.WGS84}function h(t){return r.G.extendedSpatialReferenceInfo(t)}function l(t,e){return r.G.clip(s.hydratedAdapter,a(t),t,e)}function c(t,e){return r.G.cut(s.hydratedAdapter,a(t),t,e)}function u(t,e){return r.G.contains(s.hydratedAdapter,a(t),t,e)}function d(t,e){return r.G.crosses(s.hydratedAdapter,a(t),t,e)}function f(t,e,i){return r.G.distance(s.hydratedAdapter,a(t),t,e,i)}function p(t,e){return r.G.equals(s.hydratedAdapter,a(t),t,e)}function g(t,e){return r.G.intersects(s.hydratedAdapter,a(t),t,e)}function v(t,e){return r.G.touches(s.hydratedAdapter,a(t),t,e)}function m(t,e){return r.G.within(s.hydratedAdapter,a(t),t,e)}function y(t,e){return r.G.disjoint(s.hydratedAdapter,a(t),t,e)}function _(t,e){return r.G.overlaps(s.hydratedAdapter,a(t),t,e)}function b(t,e,i){return r.G.relate(s.hydratedAdapter,a(t),t,e,i)}function w(t){return r.G.isSimple(s.hydratedAdapter,a(t),t)}function x(t){return r.G.simplify(s.hydratedAdapter,a(t),t)}function T(t,e=!1){return r.G.convexHull(s.hydratedAdapter,a(t),t,e)}function A(t,e){return r.G.difference(s.hydratedAdapter,a(t),t,e)}function M(t,e){return r.G.symmetricDifference(s.hydratedAdapter,a(t),t,e)}function S(t,e){return r.G.intersect(s.hydratedAdapter,a(t),t,e)}function E(t,e=null){return r.G.union(s.hydratedAdapter,a(t),t,e)}function C(t,e,i,n,o,h){return r.G.offset(s.hydratedAdapter,a(t),t,e,i,n,o,h)}function O(t,e,i,n=!1){return r.G.buffer(s.hydratedAdapter,a(t),t,e,i,n)}function R(t,e,i,n,o,h){return r.G.geodesicBuffer(s.hydratedAdapter,a(t),t,e,i,n,o,h)}function I(t,e,i=!0){return r.G.nearestCoordinate(s.hydratedAdapter,a(t),t,e,i)}function P(t,e){return r.G.nearestVertex(s.hydratedAdapter,a(t),t,e)}function N(t,e,i,n){return r.G.nearestVertices(s.hydratedAdapter,a(t),t,e,i,n)}function D(t){return"xmin"in t?"center"in t?t.center:null:"x"in t?t:"extent"in t?t.extent?.center??null:null}function L(t,e,i){if(null==t)throw new Z;const n=t.spatialReference;if(null==(i=i??D(t)))throw new Z;const s=t.constructor.fromJSON(r.G.rotate(t,e,i));return s.spatialReference=n,s}function z(t,e){if(null==t)throw new Z;const i=t.spatialReference;if(null==(e=e??D(t)))throw new Z;const n=t.constructor.fromJSON(r.G.flipHorizontal(t,e));return n.spatialReference=i,n}function j(t,e){if(null==t)throw new Z;const i=t.spatialReference;if(null==(e=e??D(t)))throw new Z;const n=t.constructor.fromJSON(r.G.flipVertical(t,e));return n.spatialReference=i,n}function k(t,e,i,n){return r.G.generalize(s.hydratedAdapter,a(t),t,e,i,n)}function F(t,e,i){return r.G.densify(s.hydratedAdapter,a(t),t,e,i)}function H(t,e,i,n=0){return r.G.geodesicDensify(s.hydratedAdapter,a(t),t,e,i,n)}function B(t,e){return r.G.planarArea(s.hydratedAdapter,a(t),t,e)}function G(t,e){return r.G.planarLength(s.hydratedAdapter,a(t),t,e)}function V(t,e,i){return r.G.geodesicArea(s.hydratedAdapter,a(t),t,e,i)}function U(t,e,i){return r.G.geodesicLength(s.hydratedAdapter,a(t),t,e,i)}function $(t,e){return r.G.intersectLinesToPoints(s.hydratedAdapter,a(t),t,e)}function W(t,e){r.G.changeDefaultSpatialReferenceTolerance(t,e)}function q(t){r.G.clearDefaultSpatialReferenceTolerance(t)}class Z extends Error{constructor(){super("Illegal Argument Exception")}}},7456:function(t,e,i){"use strict";i.d(e,{l:function(){return l}});var n=i(15774),r=i(73364),s=i(32501),o=i(46098),a=i(61441),h=i(57652);function l(t,e,i,n){if(null==t||null==n)return!1;const s=(0,a.Qk)(t,a.Wv),l=(0,a.Qk)(n,a.zp);if(s===l&&!c(l)&&(s!==a.rz.UNKNOWN||(0,h.aI)(t,n)))return(0,r.kN)(i,e),!0;if(c(l)){const t=a.w5[s][a.rz.LON_LAT],n=a.w5[a.rz.LON_LAT][l];return null!=t&&null!=n&&(t(e,0,d,0),n(d,0,f,0),(0,o.z)(u*d[0],u*d[1],i),i[12]=f[0],i[13]=f[1],i[14]=f[2],!0)}const p=c(s);if((l===a.rz.WEB_MERCATOR||l===a.rz.PLATE_CARREE||l===a.rz.WGS84||l===a.rz.CGCS2000)&&(s===a.rz.WGS84||p||s===a.rz.WEB_MERCATOR||s===a.rz.CGCS2000)){const t=a.w5[s][a.rz.LON_LAT],n=a.w5[a.rz.LON_LAT][l];return null!=t&&null!=n&&(t(e,0,d,0),n(d,0,f,0),p?(0,o.Z)(u*d[0],u*d[1],i):(0,r.D_)(i),i[12]=f[0],i[13]=f[1],i[14]=f[2],!0)}return!1}function c(t){return t===a.rz.SPHERICAL_ECEF||t===a.rz.SPHERICAL_MARS_PCPF||t===a.rz.SPHERICAL_MOON_PCPF||t===a.rz.WGS84_ECEF}const u=(0,n.kU)(1),d=(0,s.vt)(),f=(0,s.vt)()},46098:function(t,e,i){"use strict";i.d(e,{Z:function(){return s},z:function(){return r}});var n=i(73364);function r(t,e,i){const n=Math.sin(t),r=Math.cos(t),s=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-n,a[4]=-s*r,a[8]=o*r,a[12]=0,a[1]=r,a[5]=-s*n,a[9]=o*n,a[13]=0,a[2]=0,a[6]=o,a[10]=s,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function s(t,e,i){return r(t,e,i),(0,n.mg)(i,i),i}},56919:function(t,e,i){"use strict";i.d(e,{E:function(){return s}});var n=i(32501),r=(i(46157),i(68734));function s(t,e,i){return!!(0,r.F)(t,e,o,i.spatialReference)&&(i.x=o[0],i.y=o[1],i.z=o[2],!0)}const o=(0,n.vt)()},96611:function(t,e,i){"use strict";i.d(e,{Y0:function(){return l},lO:function(){return c}});var n=i(61714),r=i(57165),s=i(57652);const o=new r.A(n.fv),a=new r.A(n.FY),h=new r.A(n.LJ),l=new r.A(n.Ro);function c(t){const e=u.get(t);if(e)return e;let i=o;if(t)if(t===a)i=a;else if(t===h)i=h;else{const e=t.wkid,n=t.latestWkid;if(null!=e||null!=n)(0,s.tl)(e)||(0,s.tl)(n)?i=a:((0,s.ZL)(e)||(0,s.ZL)(n))&&(i=h);else{const e=t.wkt2??t.wkt;if(e){const t=e.toUpperCase();t===d?i=a:t===f&&(i=h)}}}return u.set(t,i),i}const u=new Map,d=a.wkt.toUpperCase(),f=h.wkt.toUpperCase()},5047:function(t,e,i){"use strict";i.d(e,{AK:function(){return o},Wz:function(){return s},oe:function(){return r}});var n=i(24540);function r(t,e=!1){return t<=n.y9?e?new Array(t).fill(0):new Array(t):new Float32Array(t)}function s(t){return((0,n.cy)(t)?t.length:t.byteLength/8)<=n.y9?Array.from(t):new Float32Array(t)}function o(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}},37819:function(t,e,i){"use strict";i.d(e,{Dg:function(){return r},EH:function(){return d},JH:function(){return o},my:function(){return s},tM:function(){return c}});var n=i(24540);function r(t){if((0,n.cy)(t)){if(t.length<n.y9)return t}else if(t.length<n.y9)return Array.from(t);let e=!0,i=!0;return t.some(((t,n)=>(e=e&&0===t,i=i&&t===n,!e&&!i))),e?d(t.length):i?c(t.length):(0,n.cy)(t)||t.BYTES_PER_ELEMENT!==Uint16Array.BYTES_PER_ELEMENT?function(t){let e=!0;for(const i of t){if(i>=65536)return(0,n.cy)(t)?new Uint32Array(t):t;i>=256&&(e=!1)}return e?new Uint8Array(t):new Uint16Array(t)}(t):t}function s(t){return t<=n.y9?new Array(t):t<=65536?new Uint16Array(t):new Uint32Array(t)}function o(t){return t<=n.y9?new Array(t):new Uint32Array(t)}let a=(()=>{const t=new Uint32Array(131072);for(let e=0;e<t.length;++e)t[e]=e;return t})();const h=[0],l=(()=>{const t=new Uint16Array(65536);for(let e=0;e<t.length;++e)t[e]=e;return t})();function c(t){if(1===t)return h;if(t<n.y9)return Array.from(new Uint16Array(l.buffer,0,t));if(t<l.length)return new Uint16Array(l.buffer,0,t);if(t>a.length){const e=Math.max(2*a.length,t);a=new Uint32Array(e);for(let t=0;t<a.length;t++)a[t]=t}return new Uint32Array(a.buffer,0,t)}let u=new Uint8Array(65536);function d(t){if(1===t)return h;if(t<n.y9)return new Array(t).fill(0);if(t>u.length){const e=Math.max(2*u.length,t);u=new Uint8Array(e)}return new Uint8Array(u.buffer,0,t)}},65907:function(t,e,i){"use strict";i.d(e,{A:function(){return u}});var n,r=i(53804),s=i(75743),o=i(30905),a=i(23502),h=(i(58941),i(40633),i(13798),i(74376)),l=i(65953);let c=n=class extends((0,s.O)(o.oY)){constructor(t){super(t),this.type="georeferenced",this.origin=null}};c.absolute=new n,(0,r._)([(0,h.e)({georeferenced:"georeferenced"},{readOnly:!0})],c.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:[Number],nonNullable:!1,json:{write:!0}})],c.prototype,"origin",void 0),c=n=(0,r._)([(0,l.$)("esri.geometry.support.MeshGeoreferencedVertexSpace")],c);const u=c},20460:function(t,e,i){"use strict";i.d(e,{A:function(){return u}});var n=i(53804),r=i(75743),s=i(30905),o=i(23502),a=(i(58941),i(40633),i(13798),i(74376)),h=i(65953),l=i(32501);let c=class extends((0,r.O)(s.oY)){constructor(t){super(t),this.type="local",this.origin=(0,l.vt)()}};(0,n._)([(0,a.e)({local:"local"},{readOnly:!0})],c.prototype,"type",void 0),(0,n._)([(0,o.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],c.prototype,"origin",void 0),c=(0,n._)([(0,h.$)("esri.geometry.support.MeshLocalVertexSpace")],c);const u=c},36405:function(t,e,i){"use strict";i.d(e,{A:function(){return v}});var n,r=i(53804),s=i(30905),o=i(23502),a=(i(58941),i(40633),i(13798),i(65953)),h=i(73364),l=i(39714),c=i(32237),u=i(61769),d=i(32501),f=i(26133);let p=n=class extends s.oY{constructor(t){super(t),this.translation=(0,d.vt)(),this.rotationAxis=(0,d.ci)(f.up),this.rotationAngle=0,this.scale=(0,d.fA)(1,1,1)}get rotation(){return(0,f.i4)(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=(0,d.o8)((0,f.yo)(t)),this.rotationAngle=(0,f.g7)(t)}get localMatrix(){const t=(0,l.vt)();return(0,c.x8)(g,(0,f.yo)(this.rotation),(0,f.$I)(this.rotation)),(0,h.o1)(t,g,this.translation,this.scale),t}get localMatrixInverse(){return(0,h.B8)((0,l.vt)(),this.localMatrix)}equals(t){return this===t||null!=t&&(0,h.t2)(this.localMatrix,t.localMatrix)}clone(){const t={translation:(0,d.o8)(this.translation),rotationAxis:(0,d.o8)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,d.o8)(this.scale)};return new n(t)}};(0,r._)([(0,o.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],p.prototype,"translation",void 0),(0,r._)([(0,o.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],p.prototype,"rotationAxis",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],p.prototype,"rotationAngle",void 0),(0,r._)([(0,o.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],p.prototype,"scale",void 0),(0,r._)([(0,o.MZ)()],p.prototype,"rotation",null),(0,r._)([(0,o.MZ)()],p.prototype,"localMatrix",null),(0,r._)([(0,o.MZ)()],p.prototype,"localMatrixInverse",null),p=n=(0,r._)([(0,a.$)("esri.geometry.support.MeshTransform")],p);const g=(0,u.vt)(),v=p},26133:function(t,e,i){"use strict";i.d(e,{$I:function(){return m},AU:function(){return p},Cr:function(){return u},g7:function(){return v},i4:function(){return c},ui:function(){return d},up:function(){return _},vt:function(){return l},yo:function(){return g}});var n=i(15774),r=i(73364),s=i(32237),o=i(61769),a=i(20551),h=i(32501);function l(t=_){return[t[0],t[1],t[2],t[3]]}function c(t,e,i=l()){return(0,a.c)(i,t),i[3]=e,i}function u(t,e,i){return(0,a.e)(i,t,e),(0,a.n)(i,i),i[3]=-(0,a.r)(t,e),i}function d(t,e=l()){const i=(0,r.l)(b,t);return y(e,(0,n.KJ)((0,s.Xd)(e,i))),e}function f(t,e,i=l()){return(0,s.x8)(b,t,m(t)),(0,s.x8)(w,e,m(e)),(0,s.lw)(b,w,b),y(i,(0,n.KJ)((0,s.Xd)(i,b)))}function p(t,e,i,n=l()){return c(h.Cw,t,x),c(h.JP,e,T),c(h.Cb,i,A),f(x,T,x),f(x,A,n),n}function g(t){return t}function v(t){return t[3]}function m(t){return(0,n.kU)(t[3])}function y(t,e){return t[3]=e,t}const _=[0,0,1,0],b=(0,o.vt)(),w=(0,o.vt)(),x=(l(),l()),T=l(),A=l()},92754:function(t,e,i){"use strict";i.d(e,{Y$:function(){return d},qB:function(){return b},Qt:function(){return H},My:function(){return U},bf:function(){return z},jZ:function(){return v},j0:function(){return m},Sx:function(){return y},E$:function(){return _},h:function(){return C},P:function(){return P},SL:function(){return A},gH:function(){return f},si:function(){return w},mJ:function(){return B},UL:function(){return $},D6:function(){return j},Yi:function(){return O},An:function(){return N},LC:function(){return M},xs:function(){return p},Xm:function(){return x},Vp:function(){return G},zD:function(){return W},m8:function(){return k},nS:function(){return R},H$:function(){return D},eI:function(){return S},Eq:function(){return g},Aj:function(){return T},E7:function(){return V},Y4:function(){return q},TX:function(){return F},Uz:function(){return I},ml:function(){return L},XP:function(){return E}});class n{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.elementCount=9;const s=this.TypedArrayConstructor;void 0===n&&(n=9*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}getMat(t,e){let i=t*this.typedBufferStride;for(let t=0;t<9;t++)e[t]=this.typedBuffer[i++];return e}setMat(t,e){let i=t*this.typedBufferStride;for(let t=0;t<9;t++)this.typedBuffer[i++]=e[t]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,i){this.typedBuffer[t*this.typedBufferStride+e]=i}copyFrom(t,e,i){const n=this.typedBuffer,r=e.typedBuffer;let s=t*this.typedBufferStride,o=i*e.typedBufferStride;for(let t=0;t<9;++t)n[s++]=r[o++]}get buffer(){return this.typedBuffer.buffer}}n.ElementCount=9;class r{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.elementCount=16;const s=this.TypedArrayConstructor;void 0===n&&(n=16*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}getMat(t,e){let i=t*this.typedBufferStride;for(let t=0;t<16;t++)e[t]=this.typedBuffer[i++];return e}setMat(t,e){let i=t*this.typedBufferStride;for(let t=0;t<16;t++)this.typedBuffer[i++]=e[t]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,i){this.typedBuffer[t*this.typedBufferStride+e]=i}copyFrom(t,e,i){this.copyFromTypedBuffer(t,e.typedBuffer,i*e.typedBufferStride)}copyFromTypedBuffer(t,e,i){const n=this.typedBuffer;let r=t*this.typedBufferStride;for(let t=0;t<16;++t)n[r++]=e[i++]}get buffer(){return this.typedBuffer.buffer}}r.ElementCount=16;class s{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.elementCount=1;const s=this.TypedArrayConstructor;void 0===n&&(n=s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.stride=n,this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride)}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}get(t){return this.typedBuffer[t*this.typedBufferStride]}set(t,e){this.typedBuffer[t*this.typedBufferStride]=e}get buffer(){return this.typedBuffer.buffer}}s.ElementCount=1;var o=i(13786);class a{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.elementCount=2;const s=this.TypedArrayConstructor;void 0===n&&(n=2*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}getVec(t,e){return t*=this.typedBufferStride,(0,o.hZ)(e,this.typedBuffer[t],this.typedBuffer[t+1])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t]=e[1]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,i){this.typedBuffer[t*this.typedBufferStride+e]=i}setValues(t,e,i){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t]=i}copyFrom(t,e,i){const n=this.typedBuffer,r=e.typedBuffer;let s=t*this.typedBufferStride,o=i*e.typedBufferStride;n[s++]=r[o++],n[s]=r[o]}get buffer(){return this.typedBuffer.buffer}}a.ElementCount=2;var h=i(20551);class l{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.elementCount=3;const s=this.TypedArrayConstructor;void 0===n&&(n=3*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}getVec(t,e){return t*=this.typedBufferStride,(0,h.i)(e,this.typedBuffer[t],this.typedBuffer[t+1],this.typedBuffer[t+2])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t++]=e[1],this.typedBuffer[t]=e[2]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,i){this.typedBuffer[t*this.typedBufferStride+e]=i}setValues(t,e,i,n){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t++]=i,this.typedBuffer[t]=n}copyFrom(t,e,i){const n=this.typedBuffer,r=e.typedBuffer;let s=t*this.typedBufferStride,o=i*e.typedBufferStride;n[s++]=r[o++],n[s++]=r[o++],n[s]=r[o]}get buffer(){return this.typedBuffer.buffer}}l.ElementCount=3;var c=i(33400);class u{constructor(t,e,i=0,n,r){this.TypedArrayConstructor=t,this.start=i,this.elementCount=4;const s=this.TypedArrayConstructor;void 0===n&&(n=4*s.BYTES_PER_ELEMENT);const o=0===e.byteLength?0:i;this.typedBuffer=null==r?new s(e,o):new s(e,o,(r-i)/s.BYTES_PER_ELEMENT),this.typedBufferStride=n/s.BYTES_PER_ELEMENT,this.count=Math.ceil(this.typedBuffer.length/this.typedBufferStride),this.stride=this.typedBufferStride*this.TypedArrayConstructor.BYTES_PER_ELEMENT}sliceBuffer(t,e,i=this.count-e){const n=this.typedBuffer.byteOffset+e*this.stride;return new t(this.buffer,n,this.stride,n+i*this.stride)}getVec(t,e){return t*=this.typedBufferStride,(0,c.s)(e,this.typedBuffer[t++],this.typedBuffer[t++],this.typedBuffer[t++],this.typedBuffer[t])}setVec(t,e){t*=this.typedBufferStride,this.typedBuffer[t++]=e[0],this.typedBuffer[t++]=e[1],this.typedBuffer[t++]=e[2],this.typedBuffer[t]=e[3]}get(t,e){return this.typedBuffer[t*this.typedBufferStride+e]}set(t,e,i){this.typedBuffer[t*this.typedBufferStride+e]=i}setValues(t,e,i,n,r){t*=this.typedBufferStride,this.typedBuffer[t++]=e,this.typedBuffer[t++]=i,this.typedBuffer[t++]=n,this.typedBuffer[t]=r}copyFrom(t,e,i){const n=this.typedBuffer,r=e.typedBuffer;let s=t*this.typedBufferStride,o=i*e.typedBufferStride;n[s++]=r[o++],n[s++]=r[o++],n[s++]=r[o++],n[s]=r[o]}get buffer(){return this.typedBuffer.buffer}}u.ElementCount=4;class d extends s{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}static fromTypedArray(t,e){return new d(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}d.ElementType="f32";class f extends a{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(f,t,e)}static fromTypedArray(t,e){return new f(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}f.ElementType="f32";class p extends l{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(p,t,e)}static fromTypedArray(t,e){return new p(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}p.ElementType="f32";class g extends u{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(g,t,e)}static fromTypedArray(t,e){return new g(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}g.ElementType="f32";class v extends n{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(v,t,e)}static fromTypedArray(t,e){return new v(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}v.ElementType="f32";class m extends n{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(m,t,e)}static fromTypedArray(t,e){return new m(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}m.ElementType="f64";class y extends r{constructor(t,e=0,i,n){super(Float32Array,t,e,i,n),this.elementType="f32"}slice(t,e){return this.sliceBuffer(y,t,e)}static fromTypedArray(t,e){return new y(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}y.ElementType="f32";class _ extends r{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(_,t,e)}static fromTypedArray(t,e){return new _(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}_.ElementType="f64";class b extends s{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(b,t,e)}static fromTypedArray(t,e){return new b(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}b.ElementType="f64";class w extends a{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(w,t,e)}static fromTypedArray(t,e){return new w(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}w.ElementType="f64";class x extends l{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(x,t,e)}static fromTypedArray(t,e){return new x(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}x.ElementType="f64";class T extends u{constructor(t,e=0,i,n){super(Float64Array,t,e,i,n),this.elementType="f64"}slice(t,e){return this.sliceBuffer(T,t,e)}static fromTypedArray(t,e){return new T(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}T.ElementType="f64";class A extends s{constructor(t,e=0,i,n){super(Uint8Array,t,e,i,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(A,t,e)}static fromTypedArray(t,e){return new A(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}A.ElementType="u8";class M extends a{constructor(t,e=0,i,n){super(Uint8Array,t,e,i,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(M,t,e)}static fromTypedArray(t,e){return new M(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}M.ElementType="u8";class S extends l{constructor(t,e=0,i,n){super(Uint8Array,t,e,i,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(S,t,e)}static fromTypedArray(t,e){return new S(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}S.ElementType="u8";class E extends u{constructor(t,e=0,i,n){super(Uint8Array,t,e,i,n),this.elementType="u8"}slice(t,e){return this.sliceBuffer(E,t,e)}static fromTypedArray(t,e){return new E(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}E.ElementType="u8";class C extends s{constructor(t,e=0,i,n){super(Uint16Array,t,e,i,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(C,t,e)}static fromTypedArray(t,e){return new C(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}C.ElementType="u16";class O extends a{constructor(t,e=0,i,n){super(Uint16Array,t,e,i,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(O,t,e)}static fromTypedArray(t,e){return new O(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}O.ElementType="u16";class R extends l{constructor(t,e=0,i,n){super(Uint16Array,t,e,i,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(R,t,e)}static fromTypedArray(t,e){return new R(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}R.ElementType="u16";class I extends u{constructor(t,e=0,i,n){super(Uint16Array,t,e,i,n),this.elementType="u16"}slice(t,e){return this.sliceBuffer(I,t,e)}static fromTypedArray(t,e){return new I(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}I.ElementType="u16";class P extends s{constructor(t,e=0,i,n){super(Uint32Array,t,e,i,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(P,t,e)}static fromTypedArray(t,e){return new P(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}P.ElementType="u32";class N extends a{constructor(t,e=0,i,n){super(Uint32Array,t,e,i,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(N,t,e)}static fromTypedArray(t,e){return new N(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}N.ElementType="u32";class D extends l{constructor(t,e=0,i,n){super(Uint32Array,t,e,i,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(D,t,e)}static fromTypedArray(t,e){return new D(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}D.ElementType="u32";class L extends u{constructor(t,e=0,i,n){super(Uint32Array,t,e,i,n),this.elementType="u32"}slice(t,e){return this.sliceBuffer(L,t,e)}static fromTypedArray(t,e){return new L(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}L.ElementType="u32";class z extends s{constructor(t,e=0,i,n){super(Int8Array,t,e,i,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(z,t,e)}static fromTypedArray(t,e){return new z(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}z.ElementType="i8";class j extends a{constructor(t,e=0,i,n){super(Int8Array,t,e,i,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(j,t,e)}static fromTypedArray(t,e){return new j(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}j.ElementType="i8";class k extends l{constructor(t,e=0,i,n){super(Int8Array,t,e,i,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(k,t,e)}static fromTypedArray(t,e){return new k(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}k.ElementType="i8";class F extends u{constructor(t,e=0,i,n){super(Int8Array,t,e,i,n),this.elementType="i8"}slice(t,e){return this.sliceBuffer(F,t,e)}static fromTypedArray(t,e){return new F(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}F.ElementType="i8";class H extends s{constructor(t,e=0,i,n){super(Int16Array,t,e,i,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(H,t,e)}static fromTypedArray(t,e){return new H(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}H.ElementType="i16";class B extends a{constructor(t,e=0,i,n){super(Int16Array,t,e,i,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(B,t,e)}static fromTypedArray(t,e){return new B(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}B.ElementType="i16";class G extends l{constructor(t,e=0,i,n){super(Int16Array,t,e,i,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(G,t,e)}static fromTypedArray(t,e){return new G(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}G.ElementType="i16";class V extends u{constructor(t,e=0,i,n){super(Int16Array,t,e,i,n),this.elementType="i16"}slice(t,e){return this.sliceBuffer(V,t,e)}static fromTypedArray(t,e){return new V(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}V.ElementType="i16";class U extends s{constructor(t,e=0,i,n){super(Int32Array,t,e,i,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(U,t,e)}static fromTypedArray(t,e){return new U(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}U.ElementType="i32";class $ extends a{constructor(t,e=0,i,n){super(Int32Array,t,e,i,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer($,t,e)}static fromTypedArray(t,e){return new $(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}$.ElementType="i32";class W extends l{constructor(t,e=0,i,n){super(Int32Array,t,e,i,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(W,t,e)}static fromTypedArray(t,e){return new W(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}W.ElementType="i32";class q extends u{constructor(t,e=0,i,n){super(Int32Array,t,e,i,n),this.elementType="i32"}slice(t,e){return this.sliceBuffer(q,t,e)}static fromTypedArray(t,e){return new q(t.buffer,t.byteOffset,e,t.byteOffset+t.byteLength)}}q.ElementType="i32"},28404:function(t,e,i){"use strict";function n(t){switch(t){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}i.d(e,{GJ:function(){return n}})},91912:function(t,e,i){"use strict";i.d(e,{$e:function(){return a},j1:function(){return h},mO:function(){return l},vt:function(){return o}});var n=i(89736),r=i(20551),s=i(79578);function o(t){return t?{ray:(0,s.vt)(t.ray),c0:t.c0,c1:t.c1}:{ray:(0,s.vt)(),c0:0,c1:Number.MAX_VALUE}}function a(t,e=o()){return(0,s.C)(t,e.ray),e.c0=0,e.c1=Number.MAX_VALUE,e}function h(t,e){return c(t,t.c0,e)}function l(t,e){return c(t,t.c1,e)}function c(t,e,i){return(0,r.g)(i,t.ray.origin,(0,r.h)(i,t.ray.direction,e))}new n.I((()=>o()))},69508:function(t,e,i){"use strict";i.d(e,{C:function(){return v},FB:function(){return n},ig:function(){return _},m7:function(){return y},ui:function(){return m},vt:function(){return g}});var n,r,s,o=i(89736),a=i(73364),h=i(20551),l=i(32501),c=i(33400),u=i(41546),d=i(91912),f=i(5596),p=i(50973);function g(t){return t?[(0,f.vt)(t[0]),(0,f.vt)(t[1]),(0,f.vt)(t[2]),(0,f.vt)(t[3]),(0,f.vt)(t[4]),(0,f.vt)(t[5])]:[(0,f.vt)(),(0,f.vt)(),(0,f.vt)(),(0,f.vt)(),(0,f.vt)(),(0,f.vt)()]}function v(t,e){for(let i=0;i<b;i++)(0,f.C)(t[i],e[i]);return t}function m(t,e,i,s=T){const o=(0,a.lw)(p.Rc.get(),e,t);(0,a.B8)(o,o);for(let t=0;t<w;++t){const e=(0,c.t)(p.Km.get(),x[t],o);(0,h.i)(s[t],e[0]/e[3],e[1]/e[3],e[2]/e[3])}!function(t,e){(0,f.Cr)(e[r.FAR_BOTTOM_LEFT],e[r.NEAR_BOTTOM_LEFT],e[r.NEAR_TOP_LEFT],t[n.LEFT]),(0,f.Cr)(e[r.NEAR_BOTTOM_RIGHT],e[r.FAR_BOTTOM_RIGHT],e[r.FAR_TOP_RIGHT],t[n.RIGHT]),(0,f.Cr)(e[r.FAR_BOTTOM_LEFT],e[r.FAR_BOTTOM_RIGHT],e[r.NEAR_BOTTOM_RIGHT],t[n.BOTTOM]),(0,f.Cr)(e[r.NEAR_TOP_LEFT],e[r.NEAR_TOP_RIGHT],e[r.FAR_TOP_RIGHT],t[n.TOP]),(0,f.Cr)(e[r.NEAR_BOTTOM_LEFT],e[r.NEAR_BOTTOM_RIGHT],e[r.NEAR_TOP_RIGHT],t[n.NEAR]),(0,f.Cr)(e[r.FAR_BOTTOM_RIGHT],e[r.FAR_BOTTOM_LEFT],e[r.FAR_TOP_LEFT],t[n.FAR])}(i,s)}function y(t,e){for(let i=0;i<b;i++){const n=t[i];if(n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=e[3])return!1}return!0}function _(t,e){for(let i=0;i<b;i++){const n=t[i];if(!(0,f.b6)(n,e))return!1}return!0}(s=n||(n={}))[s.LEFT=0]="LEFT",s[s.RIGHT=1]="RIGHT",s[s.BOTTOM=2]="BOTTOM",s[s.TOP=3]="TOP",s[s.NEAR=4]="NEAR",s[s.FAR=5]="FAR",function(t){t[t.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",t[t.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",t[t.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",t[t.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",t[t.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",t[t.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",t[t.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",t[t.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}(r||(r={})),r.FAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_RIGHT,r.NEAR_BOTTOM_LEFT,r.FAR_BOTTOM_LEFT,r.NEAR_BOTTOM_LEFT,r.NEAR_BOTTOM_RIGHT,r.NEAR_TOP_RIGHT,r.NEAR_TOP_LEFT,r.FAR_BOTTOM_RIGHT,r.FAR_BOTTOM_LEFT,r.FAR_TOP_LEFT,r.FAR_TOP_RIGHT,r.NEAR_BOTTOM_RIGHT,r.FAR_BOTTOM_RIGHT,r.FAR_TOP_RIGHT,r.NEAR_TOP_RIGHT,r.FAR_BOTTOM_LEFT,r.NEAR_BOTTOM_LEFT,r.NEAR_TOP_LEFT,r.FAR_TOP_LEFT,r.FAR_TOP_LEFT,r.NEAR_TOP_LEFT,r.NEAR_TOP_RIGHT,r.FAR_TOP_RIGHT;const b=6,w=8,x=[(0,u.fA)(-1,-1,-1,1),(0,u.fA)(1,-1,-1,1),(0,u.fA)(1,1,-1,1),(0,u.fA)(-1,1,-1,1),(0,u.fA)(-1,-1,1,1),(0,u.fA)(1,-1,1,1),(0,u.fA)(1,1,1,1),(0,u.fA)(-1,1,1,1)],T=(new o.I(d.vt),[(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)(),(0,l.vt)()])},73313:function(t,e,i){"use strict";i.d(e,{C:function(){return l},Cr:function(){return u},H6:function(){return g},_I:function(){return f},dz:function(){return v},fA:function(){return c},kb:function(){return d},ld:function(){return m},sd:function(){return p},vt:function(){return h}});var n=i(15774),r=i(89736),s=i(20551),o=i(32501),a=i(50973);function h(t){return t?{origin:(0,o.o8)(t.origin),vector:(0,o.o8)(t.vector)}:{origin:(0,o.vt)(),vector:(0,o.vt)()}}function l(t,e=h()){return c(t.origin,t.vector,e)}function c(t,e,i=h()){return(0,s.c)(i.origin,t),(0,s.c)(i.vector,e),i}function u(t,e,i=h()){return(0,s.c)(i.origin,t),(0,s.d)(i.vector,e,t),i}function d(t,e){const i=(0,s.d)(a.rq.get(),e,t.origin),r=(0,s.f)(t.vector,i),o=(0,s.f)(t.vector,t.vector),h=(0,n.qE)(r/o,0,1),l=(0,s.d)(a.rq.get(),(0,s.h)(a.rq.get(),t.vector,h),i);return(0,s.f)(l,l)}function f(t,e,i){return g(t,e,0,1,i)}function p(t,e,i){return(0,s.g)(i,t.origin,(0,s.h)(i,t.vector,e))}function g(t,e,i,r,o){const{vector:h,origin:l}=t,c=(0,s.d)(a.rq.get(),e,l),u=(0,s.f)(h,c)/(0,s.k)(h);return(0,s.h)(o,h,(0,n.qE)(u,i,r)),(0,s.g)(o,o,t.origin)}function v(t,e){if(y(t,function(t,e){const i=b.get();return i.origin=t,i.vector=e,i}(e.origin,e.direction),!1,_)){const{tA:e,pB:i,distance2:n}=_;if(e>=0&&e<=1)return n;if(e<0)return(0,s.s)(t.origin,i);if(e>1)return(0,s.s)((0,s.g)(a.rq.get(),t.origin,t.vector),i)}return null}function m(t,e,i){return!!y(t,e,!0,_)&&((0,s.c)(i,_.pA),!0)}function y(t,e,i,r){const o=1e-6,h=t.origin,l=(0,s.g)(a.rq.get(),h,t.vector),c=e.origin,u=(0,s.g)(a.rq.get(),c,e.vector),d=a.rq.get(),f=a.rq.get();if(d[0]=h[0]-c[0],d[1]=h[1]-c[1],d[2]=h[2]-c[2],f[0]=u[0]-c[0],f[1]=u[1]-c[1],f[2]=u[2]-c[2],Math.abs(f[0])<o&&Math.abs(f[1])<o&&Math.abs(f[2])<o)return!1;const p=a.rq.get();if(p[0]=l[0]-h[0],p[1]=l[1]-h[1],p[2]=l[2]-h[2],Math.abs(p[0])<o&&Math.abs(p[1])<o&&Math.abs(p[2])<o)return!1;const g=d[0]*f[0]+d[1]*f[1]+d[2]*f[2],v=f[0]*p[0]+f[1]*p[1]+f[2]*p[2],m=d[0]*p[0]+d[1]*p[1]+d[2]*p[2],y=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],_=(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*y-v*v;if(Math.abs(_)<o)return!1;let b=(g*v-m*y)/_,w=(g+v*b)/y;i&&(b=(0,n.qE)(b,0,1),w=(0,n.qE)(w,0,1));const x=a.rq.get(),T=a.rq.get();return x[0]=h[0]+b*p[0],x[1]=h[1]+b*p[1],x[2]=h[2]+b*p[2],T[0]=c[0]+w*f[0],T[1]=c[1]+w*f[1],T[2]=c[2]+w*f[2],r.tA=b,r.tB=w,r.pA=x,r.pB=T,r.distance2=(0,s.s)(x,T),!0}const _={tA:0,tB:0,pA:(0,o.vt)(),pB:(0,o.vt)(),distance2:0},b=new r.I((()=>h()))},61003:function(t,e,i){"use strict";i.d(e,{b:function(){return s}});var n=i(15774),r=i(37819);function s(t,e,i){const s=Array.isArray(t),c=s?t.length/e:t.byteLength/(4*e),u=s?t:new Uint32Array(t,0,c*e),d=i?.minReduction??0,f=i?.originalIndices||null,p=f?f.length:0,g=i?.componentOffsets||null;let v=0;if(g)for(let t=0;t<g.length-1;t++){const e=g[t+1]-g[t];e>v&&(v=e)}else v=c;const m=Math.floor(1.1*v)+1;(null==l||l.length<2*m)&&(l=new Uint32Array((0,n.cU)(2*m)));for(let t=0;t<2*m;t++)l[t]=0;let y=0;const _=!!g&&!!f,b=_?p:c;let w=(0,r.my)(c);const x=new Uint32Array(p),T=1.96;let A=0!==d?Math.ceil(4*T*T/(d*d)*d*(1-d)):b,M=1,S=g?g[1]:b;for(let t=0;t<b;t++){if(t===A){const e=1-y/t;if(e+T*Math.sqrt(e*(1-e)/t)<d)return null;A*=2}if(t===S){for(let t=0;t<2*m;t++)l[t]=0;if(f)for(let t=g[M-1];t<g[M];t++)x[t]=w[f[t]];S=g[++M]}const i=_?f[t]:t,n=i*e,r=h(u,n,e);let s=r%m,a=y;for(;0!==l[2*s+1];){if(l[2*s]===r){const t=l[2*s+1]-1;if(o(u,n,t*e,e)){a=w[t];break}}s++,s>=m&&(s-=m)}a===y&&(l[2*s]=r,l[2*s+1]=i+1,y++),w[i]=a}if(0!==d&&1-y/c<d)return null;if(_){for(let t=g[M-1];t<x.length;t++)x[t]=w[f[t]];w=(0,r.Dg)(x)}const E=s?new Array(y):new Uint32Array(y*e);y=0;for(let t=0;t<b;t++)w[t]===y&&(a(u,(_?f[t]:t)*e,E,y*e,e),y++);if(f&&!_){const t=new Uint32Array(p);for(let e=0;e<t.length;e++)t[e]=w[f[e]];w=(0,r.Dg)(t)}return{buffer:Array.isArray(E)?E:E.buffer,indices:w,uniqueCount:y}}function o(t,e,i,n){for(let r=0;r<n;r++)if(t[e+r]!==t[i+r])return!1;return!0}function a(t,e,i,n,r){for(let s=0;s<r;s++)i[n+s]=t[e+s]}function h(t,e,i){let n=0;for(let r=0;r<i;r++)n=t[e+r]+n|0,n=n+(n<<11)+(n>>>2)|0;return n>>>0}let l=null},67376:function(t,e,i){"use strict";i.d(e,{CK:function(){return d},E9:function(){return c},Hq:function(){return u},MW:function(){return f},TE:function(){return p},yJ:function(){return g}});var n=i(88022),r=i(40633),s=i(20551),o=i(45532),a=i(65907),h=i(20460);function l(){return r.A.getLogger("esri.geometry.Mesh")}function c(t){return!u(t)}function u(t){return null!=t.origin}function d(t){return u(t.vertexSpace)}function f(t,e){if(!u(t))return null;const[i,n,r]=t.origin;return new o.default({x:i,y:n,z:r,spatialReference:e})}function p(t,e){const{x:i,y:r,z:s,spatialReference:o}=t,c=[i,r,s??0];return void 0!==e?.geographic&&((0,n.io)(l(),"option: geographic",{replacement:"Use the `vertexSpace` option instead.",version:"4.29",warnOnce:!0}),e.vertexSpace&&l().warn("Deprecated geographic flag ignored since vertexSpace option is provided.")),"local"===(e?.vertexSpace??(u=e?.geographic,null==u?void 0:u?"local":"georeferenced")??function(t){return t.isGeographic||t.isWebMercator?"local":"georeferenced"}(o))?new h.A({origin:c}):new a.A({origin:c});var u}function g(t,e){return t.type===e.type&&(t.origin===e.origin||null!=t.origin&&null!=e.origin&&(0,s.p)(t.origin,e.origin))}},6527:function(t,e,i){"use strict";i.d(e,{S:function(){return h}});var n=i(15774),r=i(62938),s=i(20551),o=i(72485),a=i(5596);function h(t,e,i){const h=function(t,e,i,n){const o=(t=>!Array.isArray(t[0]))(e)?(t,i)=>e[3*t+i]:(t,i)=>e[t][i],h=n?(0,r.GA)(n)/(0,r.G9)(n):1;return(0,a.lU)(t,((t,e)=>(0,s.i)(t,o(e,0)*h,o(e,1)*h,o(e,2))),i)}(l,t,e,i)?(0,a.Qj)(l):[0,0,1];return Math.abs(h[2])>Math.cos((0,n.kU)(80))?o._.Z:Math.abs(h[1])>Math.abs(h[0])?o._.Y:o._.X}const l=(0,a.vt)()},67496:function(t,e,i){"use strict";i.d(e,{Fm:function(){return a},Q7:function(){return h}});var n=i(89736),r=i(20551),s=i(32501),o=i(73313);function a(t,e,i){const n=e[0]-t[0],r=e[1]-t[1],s=i[0]-t[0],o=i[1]-t[1];return.5*Math.abs(n*o-r*s)}function h(t,e,i){return(0,r.d)(l,e,t),(0,r.d)(c,i,t),.5*(0,r.l)((0,r.e)(l,l,c))}i(50973),new n.I(o.vt),new n.I((()=>{return t?{p0:(0,s.o8)(t.p0),p1:(0,s.o8)(t.p1),p2:(0,s.o8)(t.p2)}:{p0:(0,s.vt)(),p1:(0,s.vt)(),p2:(0,s.vt)()};var t}));const l=(0,s.vt)(),c=(0,s.vt)()},82588:function(t,e,i){"use strict";i.d(e,{Wq:function(){return n},lO:function(){return d},oR:function(){return f}});var n,r,s=i(59122),o=i(72485),a=i(38441),h=i(50240),l=i(37819),c=i(6527),u=i(61003);function d(t){const e=f(t.rings,t.hasZ,n.CCW_IS_HOLE,t.spatialReference),i=new Array;let r=0,o=0;for(const t of e.polygons){const n=t.count,a=t.index,c=(0,h.l5)(e.position,3*a,3*n),u=t.holeIndices.map((t=>t-a)),d=(0,l.Dg)((0,s.e)(c,u,3));i.push({position:c,faces:d}),r+=c.length,o+=d.length}const a=function(t,e,i){if(1===t.length)return t[0];const n=(0,h.jh)(e),r=new Array(i);let s=0,o=0,a=0;for(const e of t){for(let t=0;t<e.position.length;t++)n[s++]=e.position[t];for(const t of e.faces)r[o++]=t+a;a=s/3}return{position:n,faces:(0,l.Dg)(r)}}(i,r,o),c=Array.isArray(a.position)?(0,u.b)(a.position,3,{originalIndices:a.faces}):(0,u.b)(a.position.buffer,6,{originalIndices:a.faces});return a.position=(0,h.xm)(new Float64Array(c.buffer)),a.faces=c.indices,a}function f(t,e,i,r){const s=t.length,o=new Array(s),a=new Array(s),l=new Array(s);let c=0;for(let e=0;e<s;++e)c+=t[e].length;let u=0,d=0,f=0;const v=(0,h.jh)(3*c);let m=0;for(let h=s-1;h>=0;h--){const c=t[h],y=i===n.CCW_IS_HOLE&&g(c,e,r);if(y&&1!==s)o[u++]=c;else{let t=c.length;for(let e=0;e<u;++e)t+=o[e].length;const i={index:m,pathLengths:new Array(u+1),count:t,holeIndices:new Array(u)};i.pathLengths[0]=c.length,c.length>0&&(l[f++]={index:m,count:c.length}),m=y?p(c,c.length-1,-1,v,m,c.length,e):p(c,0,1,v,m,c.length,e);for(let t=0;t<u;++t){const n=o[t];i.holeIndices[t]=m,i.pathLengths[t+1]=n.length,n.length>0&&(l[f++]={index:m,count:n.length}),m=p(n,0,1,v,m,n.length,e)}u=0,i.count>0&&(a[d++]=i)}}for(let t=0;t<u;++t){const i=o[t];i.length>0&&(l[f++]={index:m,count:i.length}),m=p(i,0,1,v,m,i.length,e)}return a.length=d,l.length=f,{position:v,polygons:a,outlines:l}}function p(t,e,i,n,r,s,o){r*=3;for(let a=0;a<s;++a){const s=t[e];n[r++]=s[0],n[r++]=s[1],n[r++]=o&&s[2]?s[2]:0,e+=i}return r/3}function g(t,e,i){if(!e)return!(0,a.$3)(t);const n=t.length-1;switch((0,c.S)(t,n,i)){case o._.X:return!(0,a.$3)(t,o._.Y,o._.Z);case o._.Y:return!(0,a.$3)(t,o._.X,o._.Z);case o._.Z:return!(0,a.$3)(t,o._.X,o._.Y)}}(r=n||(n={}))[r.NONE=0]="NONE",r[r.CCW_IS_HOLE=1]="CCW_IS_HOLE"},42413:function(t,e,i){"use strict";i.d(e,{CI:function(){return s},fk:function(){return o}}),i(58941);var n=i(15774),r=i(57652);function s(t,e){return t===e||null!=t&&null!=e&&(0,r.aI)(t.spatialReference,e.spatialReference)&&t.x===e.x&&t.y===e.y&&t.z===e.z&&t.m===e.m}function o(t,e,i){return t===e||null!=t&&null!=e&&(0,r.aI)(t.spatialReference,e.spatialReference)&&(0,n.Sp)(t.x,e.x,i)&&(0,n.Sp)(t.y,e.y,i)&&(0,n.Sp)(t.z??0,e.z??0,i)&&(0,n.Sp)(t.m??0,e.m??0,i)}},5915:function(t,e,i){"use strict";function n(t){return"point"===t.type}i.d(e,{v:function(){return n}})},45328:function(t,e,i){"use strict";i.d(e,{EL:function(){return v},RS:function(){return m},gr:function(){return l},wP:function(){return u},wZ:function(){return d}}),i(50917);var n=i(59469),r=(i(58941),i(21609)),s=i(24540),o=i(74697),a=i(46460),h=i(57165);function l(t){return"declaredClass"in t}function c(t){return"declaredClass"in t}function u(t,e){return t?"declaredClass"in t?t:new n.default({layer:e,sourceLayer:e,visible:t.visible,symbol:(0,r.o8)(t.symbol),attributes:(0,r.o8)(t.attributes),geometry:d(t.geometry)}):null}function d(t){return null==t?null:l(t)?t:(0,o.rS)(function(t){const{wkid:e,wkt:i,wkt2:n,latestWkid:r}=t.spatialReference,s={wkid:e,wkt:i,wkt2:n,latestWkid:r};switch(t.type){case"point":{const{x:e,y:i,z:n,m:r}=t;return{x:e,y:i,z:n,m:r,spatialReference:s}}case"polygon":{const{rings:e,hasZ:i,hasM:n}=t;return{rings:f(e),hasZ:i,hasM:n,spatialReference:s}}case"polyline":{const{paths:e,hasZ:i,hasM:n}=t;return{paths:f(e),hasZ:i,hasM:n,spatialReference:s}}case"extent":{const{xmin:e,xmax:i,ymin:n,ymax:r,zmin:o,zmax:a,mmin:h,mmax:l,hasZ:c,hasM:u}=t;return{xmin:e,xmax:i,ymin:n,ymax:r,zmin:o,zmax:a,mmin:h,mmax:l,hasZ:c,hasM:u,spatialReference:s}}case"multipoint":{const{points:e,hasZ:i,hasM:n}=t;return{points:g(e)?p(e):e,hasZ:i,hasM:n,spatialReference:s}}default:return}}(t))}function f(t){return function(t){for(const e of t)if(0!==e.length)return g(e);return!1}(t)?t.map((t=>p(t))):t}function p(t){return t.map((t=>Array.from(t)))}function g(t){return t.length>0&&((0,s.vZ)(t[0])||(0,s.aI)(t[0]))}function v(t,e){if(!t)return null;let i;if(c(t)){if(null==e)return t.clone();if(c(e))return e.copy(t)}return null!=e?(i=e,i.x=t.x,i.y=t.y,i.spatialReference=t.spatialReference,t.hasZ?(i.z=t.z,i.hasZ=t.hasZ):(i.z=void 0,i.hasZ=!1),t.hasM?(i.m=t.m,i.hasM=!0):(i.m=void 0,i.hasM=!1)):(i=(0,a.T)(t.x,t.y,t.z,t.spatialReference),t.hasM&&(i.m=t.m,i.hasM=!0)),i}function m(t){const{wkid:e,wkt:i,wkt2:n,latestWkid:r}=t,s={wkid:e,wkt:i,wkt2:n,latestWkid:r};return h.A.fromJSON(s)}},14921:function(t,e,i){"use strict";var n;i.d(e,{$:function(){return n}}),function(t){t[t.EnableFastUpdates=0]="EnableFastUpdates",t[t.DisableFastUpdates=1]="DisableFastUpdates",t[t.UpdateFastLocalOrigin=2]="UpdateFastLocalOrigin"}(n||(n={}))},47558:function(t,e,i){"use strict";i.d(e,{T:function(){return o}});var n=i(60539),r=i(85445),s=i(55213);class o{constructor(){this._tasks=new Array,this._runningTasks=(0,r.v)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(t){if(0===this.length)return s.G;for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,i){return++this._runningTasks.value,new Promise(((n,r)=>this._tasks.push(new a(n,r,t,e,i)))).finally((()=>--this._runningTasks.value))}unshift(t,e,i){return++this._runningTasks.value,new Promise(((n,r)=>this._tasks.unshift(new a(n,r,t,e,i)))).finally((()=>--this._runningTasks.value))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const i=(0,n.G4)(e.signal);if(i&&!e.abortCallback)e.reject((0,n.NK)());else{const r=i?e.abortCallback?.((0,n.NK)()):e.callback(t);(0,n.$X)(r)?r.then(e.resolve,e.reject):e.resolve(r)}}catch(t){e.reject(t)}return!0}cancelAll(){const t=(0,n.NK)();for(const e of this._tasks)if(e.abortCallback){const i=e.abortCallback(t);e.resolve(i)}else e.reject(t);this._tasks.length=0}}class a{constructor(t,e,i,n=void 0,r=void 0){this.resolve=t,this.reject=e,this.callback=i,this.signal=n,this.abortCallback=r}}},92781:function(t,e,i){"use strict";i.d(e,{R:function(){return s},t:function(){return o}});var n=i(77528);const r={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let s=t=>(0,n.X$)(r,t),o={create:(t,e)=>(e=s(e),(0,n.dj)(t,document.createElement("div"),void 0,e),(0,n.Av)(t,e)),append:(t,e,i)=>(i=s(i),(0,n.dj)(e,t,void 0,i),(0,n.Av)(e,i)),insertBefore:(t,e,i)=>(i=s(i),(0,n.dj)(e,t.parentNode,t,i),(0,n.Av)(e,i)),merge:(t,e,i)=>(i=s(i),e.domNode=t,(0,n.OM)(t,e,i),(0,n.Av)(e,i)),replace:(t,e,i)=>(i=s(i),(0,n.dj)(e,t.parentNode,t,i),t.parentNode.removeChild(t),(0,n.Av)(e,i))}},77528:function(t,e,i){"use strict";i.d(e,{Av:function(){return C},OM:function(){return T},X$:function(){return h},dj:function(){return A}});var n=i(10362);const r="http://www.w3.org/",s=`${r}2000/svg`,o=`${r}1999/xlink`;let a=[],h=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},l=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),c=t=>{if("string"!=typeof t)throw new Error("Style values must be strings")},u=(t,e,i)=>{if(""!==e.vnodeSelector)for(let n=i;n<t.length;n++)if(l(t[n],e))return n;return-1},d=(t,e,i,n)=>{let r=t[e];if(""===r.vnodeSelector)return;let s=r.properties;if(!(s?void 0===s.key?s.bind:s.key:void 0))for(let s=0;s<t.length;s++)if(s!==e){let e=t[s];if(l(e,r))throw new Error(`${i.vnodeSelector} had a ${r.vnodeSelector} child ${"added"===n?n:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},f=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},p=[],g=!1,v=t=>{(t.children||[]).forEach(v),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},m=()=>{g=!1,p.forEach(v),p.length=0},y=t=>{p.push(t),g||(g=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(m,{timeout:16}):setTimeout(m,16))},_=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let n=()=>{e.parentNode&&(e.parentNode.removeChild(e),y(t))};return void i(e,n,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),y(t))},b=(t,e,i)=>{if(!e)return;let r=i.eventHandlerInterceptor,a=Object.keys(e),h=a.length;for(let l=0;l<h;l++){let h=a[l],u=e[h];if("className"===h)throw new Error('Property "className" is not supported, use "class".');if("class"===h)M(t,u,!0);else if("classes"===h){let e=Object.keys(u),i=e.length;for(let n=0;n<i;n++){let i=e[n];u[i]&&t.classList.add(i)}}else if("styles"===h){let e=Object.keys(u),n=e.length;for(let r=0;r<n;r++){let n=e[r],s=u[n];s&&(c(s),i.styleApplyer(t,n,s))}}else if("key"!==h&&null!=u){let a=typeof u;"function"===a?(0===h.lastIndexOf("on",0)&&(r&&(u=r(h,u,t,e)),"oninput"===h&&function(){let t=u;u=function(e){t.apply(this,[e]),e.target["oninput-value"]=e.target.value}}()),t[h]=u):i.namespace===s?"href"===h?t.setAttributeNS(o,h,u):t.setAttribute(h,u):"string"===a&&"value"!==h?"innerHTML"===h?t[h]=n.W5.sanitize(u):w(t)&&h in t?t[h]=u:t.setAttribute(h,u):t[h]=u}}};function w(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let x,T=(t,e,i)=>{((t,e,i)=>{if(e)for(let n of e)A(n,t,void 0,i)})(t,e.children,i),e.text&&(t.textContent=e.text),b(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},A=(t,e,i,n)=>{let r,o=0,a=t.vnodeSelector,l=e.ownerDocument;if(""===a)r=t.domNode=l.createTextNode(t.text),void 0!==i?e.insertBefore(r,i):e.appendChild(r);else{for(let c=0;c<=a.length;++c){let u=a.charAt(c);if(c===a.length||"."===u||"#"===u){let u=a.charAt(o-1),d=a.slice(o,c);"."===u?r.classList.add(d):"#"===u?r.id=d:("svg"===d&&(n=h(n,{namespace:s})),void 0!==n.namespace?r=t.domNode=l.createElementNS(n.namespace,d):(r=t.domNode=t.domNode||l.createElement(d),"input"===d&&t.properties&&void 0!==t.properties.type&&r.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(r,i):r.parentNode!==e&&e.appendChild(r)),o=c+1}}T(r,t,n)}},M=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))},S=(t,e,i,r)=>{if(!i)return;let a=!1,h=Object.keys(i),l=h.length;for(let u=0;u<l;u++){let l=h[u],d=i[l],f=e[l];if("class"===l)f!==d&&(M(t,f,!1),M(t,d,!0));else if("classes"===l){let e=t.classList,i=Object.keys(d),n=i.length;for(let t=0;t<n;t++){let n=i[t],r=!!d[n];r!==!!f[n]&&(a=!0,r?e.add(n):e.remove(n))}}else if("styles"===l){let e=Object.keys(d),i=e.length;for(let n=0;n<i;n++){let i=e[n],s=d[i];s!==f[i]&&(a=!0,s?(c(s),r.styleApplyer(t,i,s)):r.styleApplyer(t,i,""))}}else if(d||"string"!=typeof f||(d=""),"value"!==l||w(t)){if(d!==f){let e=typeof d;"function"===e&&r.eventHandlerInterceptor||(r.namespace===s?"href"===l?t.setAttributeNS(o,l,d):t.setAttribute(l,d):"string"===e?"innerHTML"===l?t[l]=n.W5.sanitize(d):"role"===l&&""===d?t.removeAttribute(l):w(t)&&l in t?t[l]=d:t.setAttribute(l,d):t[l]!==d&&(t[l]=d),a=!0)}}else{let e=t[l];e!==d&&(t["oninput-value"]?e===t["oninput-value"]:d!==f)&&(t[l]=d,t["oninput-value"]=void 0),d!==f&&(a=!0)}}return a},E=(t,e,i,n,r)=>{if(i===n)return!1;n=n||a;let s,o=(i=i||a).length,h=n.length,c=0,p=0,g=!1;for(;p<h;){let a=c<o?i[c]:void 0,h=n[p];if(void 0!==a&&l(a,h))g=x(a,h,r)||g,c++;else{let a=u(i,h,c+1);if(a>=0){for(s=c;s<a;s++)_(i[s]),d(i,s,t,"removed");g=x(i[a],h,r)||g,c=a+1}else A(h,e,c<o?i[c].domNode:void 0,r),f(h),d(n,p,t,"added")}p++}if(o>c)for(s=c;s<o;s++)_(i[s]),d(i,s,t,"removed");return g};x=(t,e,i)=>{let n=t.domNode,r=!1;if(t===e)return!1;let o=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=n.ownerDocument.createTextNode(e.text);return n.parentNode.replaceChild(t,n),e.domNode=t,r=!0,r}e.domNode=n}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=h(i,{namespace:s})),t.text!==e.text&&(o=!0,void 0===e.text?n.removeChild(n.firstChild):n.textContent=e.text),e.domNode=n,o=E(e,n,t.children,e.children,i)||o,o=S(n,t.properties,e.properties,i)||o,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[n,i,e.vnodeSelector,e.properties,e.children]);return o&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(n,e.properties,t.properties),r};let C=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let n=t;t=i,x(n,i,e)},domNode:t.domNode})},81401:function(t,e,i){"use strict";i.d(e,{F:function(){return a}});var n=i(92781);let r;r=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let s=(t,e)=>{let i=t;return e.forEach((t=>{i=i&&i.children?r(i.children,(e=>e.domNode===t)):void 0})),i},o=(t,e,i)=>{let n=function(n){i("domEvent",n);let r=e(),o=((t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i})(n.currentTarget,r.domNode);o.reverse();let a,h=s(r.getLastRender(),o);return t.scheduleRender(),h&&(a=h.properties[`on${n.type}`].apply(h.properties.bind||this,arguments)),i("domEventProcessed",n),a};return(t,e,i,r)=>n},a=t=>{let e,i,r=(0,n.R)(t),s=r.performanceLogger,a=!0,h=!1,l=[],c=[],u=(t,i,n)=>{let a;r.eventHandlerInterceptor=o(e,(()=>a),s),a=t(i,n(),r),l.push(a),c.push(n)},d=()=>{if(i=void 0,a){a=!1,s("renderStart",void 0);for(let t=0;t<l.length;t++){let e=c[t]();s("rendered",void 0),l[t].update(e),s("patched",void 0)}s("renderDone",void 0),a=!0}};return e={renderNow:d,scheduleRender:()=>{i||h||(i=requestAnimationFrame(d))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),h=!0},resume:()=>{h=!1,a=!0,e.scheduleRender()},append:(t,e)=>{u(n.t.append,t,e)},insertBefore:(t,e)=>{u(n.t.insertBefore,t,e)},merge:(t,e)=>{u(n.t.merge,t,e)},replace:(t,e)=>{u(n.t.replace,t,e)},detach:t=>{for(let e=0;e<c.length;e++)if(c[e]===t)return c.splice(e,1),l.splice(e,1)[0];throw new Error("renderFunction was not found")}},e}},82465:function(t,e,i){"use strict";i.d(e,{n:function(){return r}});var n=i(90683);function r(t){return s[function(t){return"json"===t.type?"application/json":"blob"===t.type?t.blob.type:function(t){const e=(0,n.Zo)(t);return h[e]||o}(t.url)}(t)]||a}const s={},o="text/plain",a=s[o],h={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const t in h)s[h[t]]=t},82418:function(t,e,i){"use strict";function n(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function r(t,e){return"number"==typeof t?t:t?.stops?.length?function(t){let e=0,i=0;for(let n=0;n<t.length;n++){const r=t[n].size;"number"==typeof r&&(e+=r,i++)}return e/i}(t.stops):e}function s(t,e){if(!e)return t;const i=e.filter((t=>"size"===t.type)).map((e=>{const{maxSize:i,minSize:n}=e;return(r(i,t)+r(n,t))/2}));let n=0;const s=i.length;if(0===s)return t;for(let t=0;t<s;t++)n+=i[t];const o=Math.floor(n/s);return Math.max(o,t)}function o(t){const e=t?.renderer,i=t?.pointerType,r="touch"===i?9:6;if(!e)return r;const o="visualVariables"in e?s(r,e.visualVariables):r;if("simple"===e.type)return n(o,e.symbol);if("unique-value"===e.type){let t=o;return e.uniqueValueInfos?.forEach((e=>{t=n(t,e.symbol)})),t}if("class-breaks"===e.type){let t=o;return e.classBreakInfos.forEach((e=>{t=n(t,e.symbol)})),t}return"dot-density"===e.type||e.type,o}i.d(e,{o:function(){return o}})},76722:function(t,e,i){"use strict";i.d(e,{c:function(){return s}});var n=i(62938),r=i(51432);function s(t){const e="metric";if(null==t)return e;const i=t.map,s=(i&&"portalItem"in i?i.portalItem?.portal:null)??r.A.getDefault();switch(s.user?.units??s.units){case e:return e;case"english":return"imperial"}return(0,n.jM)(t.spatialReference)??e}},9030:function(t,e,i){"use strict";i.d(e,{D:function(){return r}});var n=i(93040);async function r(t,e){const{data:i}=await(0,n.A)(t,{responseType:"image",...e});return i}},93839:function(t,e,i){"use strict";i.d(e,{fJ:function(){return s},g4:function(){return r},hY:function(){return o}});const n="calcite-mode-";function r(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"").startsWith("dark")}function s(){return`${n}${r()?"dark":"light"}`}function o(t){a(t),t.classList.add(s())}function a(t){Array.from(t.classList).forEach((e=>{e.startsWith(n)&&t.classList.remove(e)}))}},38821:function(t,e,i){"use strict";i.d(e,{D:function(){return s},K:function(){return r}});var n=i(33389);const r={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},s={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:n.fu.Loop,repeatdelay:0,easing:n.Hz.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}}},33389:function(t,e,i){"use strict";var n,r,s,o,a,h,l,c,u,d,f,p,g,v,m,y,_,b,w,x,T,A,M,S,E,C,O,R,I,P,N,D,L,z,j,k,F,H,B,G,V,U,$,W,q,Z,Y,X,K,J,Q,tt,et,it,nt,rt,st,ot,at,ht,lt,ct;i.d(e,{$2:function(){return a},C1:function(){return s},Hz:function(){return p},JO:function(){return r},M1:function(){return M},O$:function(){return ot},Q1:function(){return Y},TZ:function(){return _},WE:function(){return I},Y:function(){return l},YI:function(){return K},bj:function(){return c},e_:function(){return Z},f0:function(){return st},fu:function(){return f},g7:function(){return u},ip:function(){return X},mU:function(){return P},oF:function(){return T},uQ:function(){return A},uT:function(){return F},vG:function(){return ht},wd:function(){return V},xR:function(){return n},xn:function(){return b},xw:function(){return C},yS:function(){return H}}),function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"}(n||(n={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(s||(s={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(o||(o={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(a||(a={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(h||(h={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(l||(l={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(c||(c={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(u||(u={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(d||(d={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(f||(f={})),function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"}(p||(p={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(g||(g={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(v||(v={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(m||(m={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(y||(y={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(_||(_={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(b||(b={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(w||(w={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(x||(x={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(T||(T={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(A||(A={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(M||(M={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(S||(S={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(E||(E={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(C||(C={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(O||(O={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(R||(R={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(I||(I={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(P||(P={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(N||(N={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(D||(D={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(L||(L={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AloneLine=1]="AloneLine"}(z||(z={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(j||(j={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(k||(k={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(F||(F={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(H||(H={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(B||(B={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(G||(G={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(V||(V={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(U||(U={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}($||($={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(W||(W={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(q||(q={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(Z||(Z={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(Y||(Y={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}(X||(X={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(K||(K={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(J||(J={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(Q||(Q={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(tt||(tt={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(et||(et={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(it||(it={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(nt||(nt={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(rt||(rt={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(st||(st={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(ot||(ot={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(at||(at={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(ht||(ht={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(lt||(lt={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(ct||(ct={}))},7590:function(t,e,i){"use strict";i.d(e,{$w:function(){return m},Bu:function(){return R},DW:function(){return S},FH:function(){return H},FM:function(){return l},G9:function(){return s},GV:function(){return _},Go:function(){return c},K3:function(){return F},Kn:function(){return A},MM:function(){return f},MO:function(){return V},Nl:function(){return I},Ny:function(){return b},O2:function(){return P},UE:function(){return N},YC:function(){return G},YF:function(){return L},ZO:function(){return j},_1:function(){return C},_H:function(){return x},_W:function(){return y},_d:function(){return M},bs:function(){return B},dI:function(){return Y},e6:function(){return u},gQ:function(){return h},iA:function(){return k},jn:function(){return g},lW:function(){return d},mA:function(){return p},n5:function(){return D},pM:function(){return E},pV:function(){return T},pk:function(){return U},rB:function(){return $},s4:function(){return r},xo:function(){return O},yH:function(){return w},zb:function(){return z},zr:function(){return v}});var n=i(38821);function r(t,e,i,n){return function(t){return"function"==typeof t}(t)?t(e,i,n):t}function s(t){return[t.r,t.g,t.b,t.a]}const o=" /-,\n";function a(t){let e=t.length;for(;e--;)if(!o.includes(t.charAt(e)))return!1;return!0}function h(t,e){const i=[];let n=0,r=-1;do{if(r=t.indexOf("[",n),r>=n){if(r>n){const e=t.slice(n,r);i.push([e,null,a(e)])}if(n=r+1,r=t.indexOf("]",n),r>=n){if(r>n){const s=e[t.slice(n,r)];s&&i.push([null,s,!1])}n=r+1}}}while(-1!==r);if(n<t.length){const e=t.slice(n);i.push([e,null,a(e)])}return i}function l(t,e,i,n){let r="",s=null;for(const n of e){const[e,o,a]=n;if(e)a?s=e:(s&&(r+=s,s=null),r+=e);else{let e=o;null!=i&&(e=V(o,i));const n=t.attributes[e];n&&(s&&(r+=s,s=null),r+=n)}}return function(t,e){switch("string"!=typeof t&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}(r,n)}function c(t,e,i,n,r,s,o=!0){const a=e/r,h=i/s,l=Math.ceil(a/2),c=Math.ceil(h/2);for(let i=0;i<s;i++)for(let u=0;u<r;u++){const d=4*(u+(o?s-i-1:i)*r);let f=0,p=0,g=0,v=0,m=0,y=0,_=0;const b=(i+.5)*h;for(let n=Math.floor(i*h);n<(i+1)*h;n++){const i=Math.abs(b-(n+.5))/c,r=(u+.5)*a,s=i*i;for(let i=Math.floor(u*a);i<(u+1)*a;i++){let o=Math.abs(r-(i+.5))/l;const a=Math.sqrt(s+o*o);a>=-1&&a<=1&&(f=2*a*a*a-3*a*a+1,f>0&&(o=4*(i+n*e),_+=f*t[o+3],g+=f,t[o+3]<255&&(f=f*t[o+3]/250),v+=f*t[o],m+=f*t[o+1],y+=f*t[o+2],p+=f))}}n[d]=v/p,n[d+1]=m/p,n[d+2]=y/p,n[d+3]=_/g}}function u(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function d(t){return t.data?.symbol??null}function f(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function p(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function g(t){return null!=t&&("CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type)}function v(t){return null!=t&&("CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type)}const m=(t,e=0)=>null==t||isNaN(t)?e:t,y=(t,e)=>null!=t?t:e,_=(t,e)=>t??e,b=t=>t.tintColor?u(t.tintColor):[255,255,255,1],w=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function x(){return i.e(4696).then(i.bind(i,28356))}function T(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function A(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function M(t){let e="normal",i="normal";if(t){const n=t.toLowerCase();n.includes("italic")?e="italic":n.includes("oblique")&&(e="oblique"),n.includes("bold")?i="bold":n.includes("light")&&(i="lighter")}return{style:e,weight:i}}function S(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function E(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=E(e);if(null!=t)return t}break;case"CIMTextSymbol":return E(t.symbol);case"CIMSolidFill":return t.color}return null}function C(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const t of e){const e=C(t);if(null!=e)return e}break}case"CIMTextSymbol":return C(t.symbol);case"CIMSolidStroke":return t.color}}function O(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const t=O(e);if(void 0!==t)return t}break;case"CIMTextSymbol":return O(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function R(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function I(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function P(t){return(t?Object.keys(t):[]).map((e=>({name:e,alias:e,type:"string"==typeof t[e]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const N=t=>t.includes("data:image/svg+xml");function D(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function L(t){return t?t.charAt(0).toLowerCase()+t.slice(1):t}function z(t,e,i,n,r,s,o=!0){const{infos:a}=s;let h=1,l=0,c=0,u=0,d=1;for(const{absoluteAnchorPoint:t,offsetX:e,offsetY:i,rotation:n,size:r,frameHeight:s,rotateClockWise:f,scaleSymbolsProportionally:p}of a)d=t?1:h,c=q(e,i,l,d,c),u=W(e,i,l,d,u),s&&(p||o)&&(h*=r/s),l=Z(n,f,l);const f=q(n,r,l,d,c),p=W(n,r,l,d,u);return{size:t*h,rotation:Z(e,i,l),offsetX:f,offsetY:p}}function j(t){if(null==t)return!1;if(Array.isArray(t))return t.every((t=>j(t)));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function k(t,e){if("color"===e||"outlinecolor"===e||"backgroundcolor"===e||"borderlinecolor"===e||"tintcolor"===e)return[...n.K[e]];const i=n.D[t];if(!i)throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function F(t){return"string"==typeof t?function(t){return t.split(" ").map((t=>Number(t)))}(t):t}function H(t){return t?.dashTemplate&&(t.dashTemplate=F(t.dashTemplate)),t}function B(t){if(null==t)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const t of e)if("CIMVectorMarker"===t.type)return B(t)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const t of e)if(t.symbol)return B(t.symbol)}}return"Normal"}function G(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const t=i.size??n.D.CIMVectorMarker.size;t>e&&(e=t);break}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers)for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const t=i.width;null!=t&&t>e&&(e=t);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&v(i.markerPlacement)){const t=i.size??n.D.CIMVectorMarker.size;t>e&&(e=t)}break;case"CIMPictureFill":{const t=i.height;null!=t&&t>e&&(e=t)}}return e}}}function V(t,e){if(null!==e){const i=e.get(t);return i?i.name:t}return t}function U(t){return t.map((t=>({...t,propertyName:L(t.propertyName)})))}function $(t){const e={};for(const i in t){const n=t[i];e[L(i)]=n}return e}function W(t,e,i,n,r){const s=i*Math.PI/180;if(s){const i=Math.cos(s);return(Math.sin(s)*t+i*e)*n+r}return e*n+r}function q(t,e,i,n,r){const s=i*Math.PI/180;return s?(Math.cos(s)*t-Math.sin(s)*e)*n+r:t*n+r}function Z(t,e,i){return e?i-t:i+t}function Y(t,e,i){const n="Color"===i||"TintColor"===i||"ToColor"===i,r="Rotation"===i||"Angle"===i||"ToRotation"===i;let s=e[L(i)];if(null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:r&&(s*=Math.PI/180)),null==s&&(s=k(e.type,i.toLowerCase()),null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]]:r&&(s*=Math.PI/180))),null!=e.primitiveName){const o=t[e.primitiveName];if(null!=o){const t=o[i];null==t||("string"==typeof t||"number"==typeof t||Array.isArray(t)?(s=t,null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:r&&(s*=Math.PI/180))):(s={valueExpressionInfo:t,defaultValue:s},null!=s&&(n?s={type:"Process",op:"ArcadeColor",value:s}:r&&(s={type:"Process",op:"Divide",left:s,right:180/Math.PI}))))}}if(null==s)throw new Error(`Failed to derive a value or an expression for "${i}".`);return s}},77927:function(t,e,i){"use strict";i.d(e,{Fe:function(){return u},Km:function(){return s},Nk:function(){return h}});var n=i(52874),r=i(7590);function s(t,e,i,n){if(t)if("CIMTextSymbol"!==t.type){if(i&&t.effects)for(const i of t.effects)a(i,e);if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":o(i,e,n);break;case"CIMPictureStroke":case"CIMSolidStroke":!n?.preserveOutlineWidth&&i.width&&(i.width*=e);break;case"CIMPictureFill":i.height&&(i.height*=e),i.offsetX&&(i.offsetX*=e),i.offsetY&&(i.offsetY*=e);break;case"CIMHatchFill":s(i.lineSymbol,e,!0,{...n,preserveOutlineWidth:!1}),i.offsetX&&(i.offsetX*=e),i.offsetY&&(i.offsetY*=e),i.separation&&(i.separation*=e)}}else null!=t.height&&(t.height*=e)}function o(t,e,i){if(t&&(t.markerPlacement&&function(t,e){switch((0,r.zr)(t)&&t.offset&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset&&(t.maxRandomOffset*=e),t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset&&(t.startPointOffset*=e);break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine&&(t.offsetAlongLine*=e);break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition&&(t.beginPosition*=e),t.endPosition&&(t.endPosition*=e);break;case"CIMMarkerPlacementPolygonCenter":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMMarkerPlacementInsidePolygon":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.stepX&&(t.stepX*=e),t.stepY&&(t.stepY*=e)}}(t.markerPlacement,e),t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e),t.anchorPoint&&"Absolute"===t.anchorPointUnits&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size=null!=t.size?t.size*e:0,"CIMVectorMarker"===t.type&&t.markerGraphics))for(const n of t.markerGraphics)t.scaleSymbolsProportionally||s(n.symbol,e,!0,i)}function a(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width&&(t.width*=e);break;case"CIMGeometricEffectBuffer":t.size&&(t.size*=e);break;case"CIMGeometricEffectCut":t.beginCut&&(t.beginCut*=e),t.endCut&&(t.endCut*=e),t.middleCut&&(t.middleCut*=e);break;case"CIMGeometricEffectDashes":if(t.customEndingOffset&&(t.customEndingOffset*=e),t.offsetAlongLine&&(t.offsetAlongLine*=e),t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map((t=>t*e));t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length&&(t.length*=e);break;case"CIMGeometricEffectMove":t.offsetX&&(t.offsetX*=e),t.offsetY&&(t.offsetY*=e);break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset&&(t.offset*=e);break;case"CIMGeometricEffectRegularPolygon":t.radius&&(t.radius*=e);break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth&&(t.fromWidth*=e),t.length&&(t.length*=e),t.toWidth&&(t.toWidth*=e);break;case"CIMGeometricEffectWave":t.amplitude&&(t.amplitude*=e),t.period&&(t.period*=e)}}function h(t){const e=[];return l((0,r.lW)(t),e),e.length?new n.A((0,r.e6)(e[0])):null}function l(t,e){if(!t)return;let i;i="CIMTextSymbol"===t.type?t.symbol:t;const n="CIMPolygonSymbol"===t.type;if(i?.symbolLayers)for(const t of i.symbolLayers)if(!(t.colorLocked||n&&((0,r.mA)(t)||(0,r.MM)(t)&&t.markerPlacement&&(0,r.zr)(t.markerPlacement))))switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor&&c(e,t.tintColor);break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{l(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":c(e,t.color);break;case"CIMHatchFill":l(t.lineSymbol,e)}}function c(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function u(t,e,i){e instanceof n.A||(e=new n.A(e));const s=(0,r.lW)(t);s&&d(s,e,i)}function d(t,e,i){if(!t)return;let n;n="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===n?.type;if(n?.symbolLayers)for(const t of n.symbolLayers){if(t.colorLocked)continue;if(s)if(i){const{layersToColor:e}=i;if(((0,r.mA)(t)||(0,r.MM)(t)&&t.markerPlacement&&(0,r.zr)(t.markerPlacement))&&"fill"===e||(0,r.jn)(t)&&"outline"===e)continue}else if((0,r.mA)(t)||(0,r.MM)(t)&&t.markerPlacement&&(0,r.zr)(t.markerPlacement))continue;const n=e.toArray();switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":t.tintColor=n;break;case"CIMVectorMarker":t.markerGraphics?.forEach((t=>{d(t.symbol,e,i)}));break;case"CIMSolidStroke":case"CIMSolidFill":t.color=n;break;case"CIMHatchFill":d(t.lineSymbol,e,i)}}}},74661:function(t,e,i){"use strict";i.d(e,{A7:function(){return l},Cx:function(){return c},Hk:function(){return u},JJ:function(){return g},SF:function(){return d},UK:function(){return h},jM:function(){return f},x3:function(){return p}}),i(58941);var n=i(8740),r=i(22198),s=i(90363),o=i(90972),a=i(6259);const h=s.A.fromJSON(a.Cb),l=r.A.fromJSON(a.yM),c=n.A.fromJSON(a.WR),u=o.A.fromJSON(a.JZ);function d(t){if(null==t)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return h;case"polyline":return l;case"polygon":case"extent":return c}return null}const f=s.A.fromJSON(a.nC),p=r.A.fromJSON(a.HW),g=n.A.fromJSON(a.b6)},6259:function(t,e,i){"use strict";i.d(e,{Cb:function(){return s},HW:function(){return c},JR:function(){return r},JZ:function(){return h},WR:function(){return a},b6:function(){return u},fT:function(){return n},nC:function(){return l},yM:function(){return o}});const n=[252,146,31,255],r=[153,153,153,255],s={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},a={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},h={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},u={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},31827:function(t,e,i){"use strict";i.d(e,{$4:function(){return _},O0:function(){return b},O1:function(){return w},Sw:function(){return x},eH:function(){return m},rc:function(){return y}});var n=i(53216),r=i(52874),s=i(93040),o=i(99680),a=i(13520),h=i(77927);const l="picture-fill",c="simple-fill",u="simple-line",d="simple-marker",f="text",p="cim",g=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),v=new o.q(1e3);function m(t){const e=t.style;let i=null;if(t)switch(t.type){case d:"cross"!==e&&"x"!==e&&(i=t.color);break;case c:e&&"solid"!==e?"none"!==e&&(i={type:"pattern",x:0,y:0,src:(0,n.s)(`esri/symbols/patterns/${e}.png`),width:5,height:5}):i=t.color;break;case l:i={type:"pattern",src:t.url,width:(0,a.Lz)(t.width)*t.xscale,height:(0,a.Lz)(t.height)*t.yscale,x:(0,a.Lz)(t.xoffset),y:(0,a.Lz)(t.yoffset)};break;case f:i=t.color;break;case p:i=(0,h.Nk)(t)}return i}function y(t,e){const i=t+"-"+e;return void 0!==v.get(i)?Promise.resolve(v.get(i)):(0,s.A)(t,{responseType:"image"}).then((t=>{const n=t.data,r=n.naturalWidth,s=n.naturalHeight,o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d");a.fillStyle=e,a.fillRect(0,0,r,s),a.globalCompositeOperation="destination-in",a.drawImage(n,0,0);const h=o.toDataURL();return v.put(i,h),h}))}function _(t){if(!t)return null;let e=null;switch(t.type){case c:case l:case d:e=_(t.outline);break;case u:{const i=(0,a.Lz)(t.width);null!=t.style&&"none"!==t.style&&0!==i&&(e={color:t.color,style:w(t.style),width:i,cap:t.cap,join:"miter"===t.join?(0,a.Lz)(t.miterLimit):t.join},e.dashArray=b(e).join(",")||"none");break}default:e=null}return e}function b(t){if(!t?.style)return[];const{dashArray:e,style:i,width:n}=t;if("string"==typeof e&&"none"!==e)return e.split(",").map((t=>Number(t)));const r=n??0,s=g.has(i)?g.get(i).map((t=>t*r)):[];if("butt"!==t.cap)for(const[t,e]of s.entries())s[t]=t%2==1?e+r:Math.max(e-r,1);return s}const w=(()=>{const t={};return e=>{if(t[e])return t[e];const i=e.replaceAll("-","");return t[e]=i,i}})(),x=new r.A([128,128,128])},89814:function(t,e,i){"use strict";i.d(e,{$d:function(){return p},GG:function(){return T},N7:function(){return g},Sx:function(){return v},UQ:function(){return x},di:function(){return A},dt:function(){return y},f3:function(){return M},k_:function(){return f},yG:function(){return S}});var n=i(52874),r=i(10748),s=i(77472),o=(i(58941),i(13520)),a=i(32501),h=i(60318),l=i(77927),c=i(31827),u=i(13109);const d=new n.A("white");function f(t){if(!t)return 0;if((0,r.wk)(t)){const e=function(t){const e=t.symbolLayers?.at(-1);if(e&&"outline"in e)return e?.outline?.size}(t);return null!=e?e:0}return(0,o.PN)((0,c.$4)(t)?.width)}function p(t){if(null==t||!("symbolLayers"in t)||null==t.symbolLayers)return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((t=>"object"===t.type));case"line-3d":return t.symbolLayers.some((t=>"path"===t.type));case"polygon-3d":return t.symbolLayers.some((t=>"object"===t.type||"extrude"===t.type));default:return!1}}function g(t){return t.resource?.href??""}function v(t,e){if(!t)return null;let i=null;return(0,r.wk)(t)?i=function(t){const e=t.symbolLayers;if(!e)return null;let i=null;return e.forEach((t=>{"object"===t.type&&t.resource?.href||(i="water"===t.type?t.color:t.material?t.material.color:null)})),i?new n.A(i):null}(t):(0,r.$y)(t)&&(i="cim"===t.type?(0,l.Nk)(t):t.color?new n.A(t.color):null),i?m(i,e):null}function m(t,e){if(null==e||null==t)return t;const i=t.toRgba();return i[3]=i[3]*e,new n.A(i)}function y(t,e,i){var s,o,a;t&&(e||null!=i)&&(e&&(e=new n.A(e)),(0,r.wk)(t)?function(t,e,i){const n=t.symbolLayers;if(!n)return;const r=t=>m(e=e??t??(null!=i?d:null),i);n.forEach((t=>{if("object"!==t.type||!t.resource?.href||e)if("water"===t.type)t.color=r(t.color);else{const e=null!=t.material?t.material.color:null,n=r(e);null==t.material?t.material=new u.N({color:n}):t.material.color=n,null!=i&&"outline"in t&&null!=t.outline?.color&&(t.outline.color=m(t.outline.color,i))}}))}(t,e,i):(0,r.$y)(t)&&(s=t,a=i,(o=(o=e)??s.color)&&(s.color=m(o,a)),null!=a&&"outline"in s&&s.outline?.color&&(s.outline.color=m(s.outline.color,a))))}function _(t){for(const e of t)if("number"==typeof e)return e;return null}function b(t,e,i){for(let n=0;n<3;n++){const r=t[n];switch(r){case"symbol-value":{const t=i[n];return null!=t?t/e[n]:1}case"proportional":break;default:if(r&&e[n])return r/e[n]}}return 1}function w(t,e,i,n){switch(t){case"proportional":return i*n;case"symbol-value":return null!=e?e:i;default:return t}}async function x(t,e){if(t&&e)return(0,r.wk)(t)?async function(t,e){const n=t.symbolLayers;n&&await(0,s.jJ)(n,(async t=>async function(t,e){switch(t.type){case"extrude":!function(t,e){t.size="number"==typeof e[2]?e[2]:0}(t,e);break;case"icon":case"line":case"text":!function(t,e){const i=_(e);null!=i&&(t.size=i)}(t,e);break;case"path":!function(t,e){const i=b(e,a.Un,[t.width,void 0,t.height]);t.width=w(e[0],t.width,1,i),t.height=w(e[2],t.height,1,i)}(t,e);break;case"object":await async function(t,e){const{resourceSize:n,symbolSize:r}=await async function(t){const{computeObjectLayerResourceSize:e}=await i.e(7269).then(i.bind(i,9141)),n=await e(t,10),{width:r,height:s,depth:o}=t,a=[r,o,s];let h=1;for(let t=0;t<3;t++){const e=a[t];if(null!=e){h=e/n[t];break}}for(let t=0;t<3;t++)null==a[t]&&(a[t]=n[t]*h);return{resourceSize:n,symbolSize:a}}(t),s=b(e,n,r);t.width=w(e[0],r[0],n[0],s),t.depth=w(e[1],r[1],n[1],s),t.height=w(e[2],r[2],n[2],s)}(t,e)}}(t,e)))}(t,e):void((0,r.$y)(t)&&function(t,e){const i=_(e);if(null!=i)switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const e=t.width/t.height;e>1?(t.width=i,t.height=i*e):(t.width=i*e,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}(t,e))}function T(t,e,i){if(t&&null!=e)if((0,r.wk)(t)){const n=t.symbolLayers;n&&n.forEach((t=>{if("object"===t.type)switch(i){case"tilt":t.tilt=(t.tilt??0)+e;break;case"roll":t.roll=(t.roll??0)+e;break;default:t.heading=(t.heading??0)+e}"icon"===t.type&&(t.angle+=e)}))}else(0,r.$y)(t)&&("simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle+=e))}function A(t){if(!t)return null;const e=t.effects.filter((t=>"bloom"!==t.type)).map((t=>t.toJSON()));return(0,h.zu)(e)}function M(t){return null!=t&&"polygon-3d"===t.type&&t.symbolLayers.some((t=>"extrude"===t.type))}async function S(t,e){return await t.fetchSymbol(e)||t.fetchCIMSymbol(e)}},1616:function(t,e,i){"use strict";var n,r;function s(t){return null!=t&&!t.running}i.d(e,{c:function(){return r},pi:function(){return s},tf:function(){return n}}),function(t){t[t.Idle=0]="Idle",t[t.Rendering=1]="Rendering",t[t.Ready=2]="Ready",t[t.Fading=3]="Fading"}(n||(n={})),function(t){t[t.RG=0]="RG",t[t.BA=1]="BA",t[t.COUNT=2]="COUNT"}(r||(r={}))},75256:function(t,e,i){"use strict";i.d(e,{c:function(){return n},n:function(){return v}});var n,r,s=i(82547),o=i(15774),a=i(85445),h=i(73364),l=i(39714),c=i(20551),u=i(32501),d=i(26133),f=i(43587),p=i(1616),g=i(58192);class v{constructor(){this.startTime=0,this._data=(0,a.v)(null),this._readChannels=p.c.RG,this.parallax=new m,this.parallaxNew=new m,this._anchorPoint=(0,u.vt)(),this._fadeState=(0,a.v)(n.HIDE),this._fadeFactor=(0,a.v)(1)}get data(){return this._data.value}set data(t){this._data.value=t}get readChannels(){return this._readChannels}get fadeState(){return this._fadeState.value}get fadeFactor(){return this._fadeFactor.value}get opacity(){switch(this.fadeState){case n.HIDE:return 0;case n.FADE_OUT:return 1-this.fadeFactor;case n.FADE_IN:return this.fadeFactor;case n.SHOW:case n.CROSS_FADE:return 1}}fade(t,e,i){this.isFading&&this.fadeFactor<1&&(this._fadeFactor.value=i?(0,o.qE)((e-this.startTime)/(w*i),0,1):1,1===this.fadeFactor&&this._endFade()),this._evaluateState(t,e),this._updateParallax(t)}_evaluateState(t,e){const i=t.relativeElevation,r=this._updateAnchorPoint(t);(i>1.7*g.zF||i<-g.zF||r>T)&&this.opacity>0?this._startFade(n.HIDE,e):this.isFading||(i>g.zF||i<-.35*g.zF||r>x*T?this.opacity>0&&this._startFade(n.FADE_OUT,e):(0,p.pi)(this.data)&&(0===this.opacity?this._startFade(n.FADE_IN,e):this.data.state===p.tf.Ready&&(this.fadeState===n.SHOW?this._startFade(n.CROSS_FADE,e):this._startFade(n.SHOW,e))))}_updateParallax(t){const e=(0,c.k)(t.eye);this.parallax.radiusCurvatureCorrection=.84*Math.sqrt(Math.max(e-f.$O.radius*f.$O.radius,0))/Math.sqrt(e),(0,d.Cr)(y,this.parallax.anchorPoint,_),(0,h.e$)(this.parallax.transform,l.zK,_[3],(0,d.yo)(_)),(0,d.Cr)(y,this.parallaxNew.anchorPoint,_),(0,h.e$)(this.parallaxNew.transform,l.zK,_[3],(0,d.yo)(_))}_updateAnchorPoint(t){return(0,c.n)(this._anchorPoint,t.eye),(0,c.h)(this._anchorPoint,this._anchorPoint,f.$O.radius),this.fadeState===n.HIDE&&this.data?.state===p.tf.Ready?((0,c.c)(this.parallax.anchorPoint,this._anchorPoint),0):(0,c.l)((0,c.d)(b,this.parallax.anchorPoint,this._anchorPoint))}requestFade(){this._fadeFactor.value=0}_startFade(t,e){switch(this._fadeState.value=t,this.startTime=e,t){case n.CROSS_FADE:this.requestFade(),this._switchReadChannels(),(0,c.c)(this.parallaxNew.anchorPoint,this._anchorPoint);break;case n.FADE_IN:this.requestFade(),this._switchReadChannels(),(0,c.c)(this.parallax.anchorPoint,this._anchorPoint),(0,c.c)(this.parallaxNew.anchorPoint,this._anchorPoint);break;case n.FADE_OUT:this.requestFade();break;case n.SHOW:this._switchReadChannels(),(0,c.c)(this.parallax.anchorPoint,this._anchorPoint),(0,c.c)(this.parallaxNew.anchorPoint,this._anchorPoint),this._endFade();break;case n.HIDE:this._endFade()}}_endFade(){switch(this._fadeFactor.value=1,this.data&&this.data.state!==p.tf.Ready&&(this.data.state=p.tf.Idle),this.fadeState){case n.CROSS_FADE:(0,c.c)(this.parallax.anchorPoint,this.parallaxNew.anchorPoint),this._fadeState.value=n.SHOW;break;case n.FADE_IN:this._fadeState.value=n.SHOW;break;case n.FADE_OUT:this._fadeState.value=n.HIDE;break;case n.SHOW:case n.HIDE:break;default:(0,s.Xb)(this.fadeState)}}_switchReadChannels(){this.data?.state===p.tf.Ready&&(this._readChannels=1-this._readChannels,this.data.state=p.tf.Fading)}get isFading(){return this.fadeState===n.FADE_OUT||this.fadeState===n.FADE_IN||this.fadeState===n.CROSS_FADE}}(r=n||(n={}))[r.HIDE=0]="HIDE",r[r.FADE_IN=1]="FADE_IN",r[r.SHOW=2]="SHOW",r[r.CROSS_FADE=3]="CROSS_FADE",r[r.FADE_OUT=4]="FADE_OUT";class m{constructor(){this.anchorPoint=(0,u.vt)(),this.radiusCurvatureCorrection=0,this.transform=(0,l.vt)()}}const y=(0,u.fA)(0,0,1),_=(0,d.vt)(),b=(0,u.vt)(),w=1.25,x=.5,T=2e5},58192:function(t,e,i){"use strict";i.d(e,{k9:function(){return A},zF:function(){return T}});var n,r=i(53804),s=i(30905),o=i(23502),a=(i(58941),i(40633),i(13798),i(74376)),h=i(65953);let l=n=class extends s.oY{constructor(t){super(t),this.type="cloudy",this.cloudCover=.5}clone(){return new n({cloudCover:this.cloudCover})}};(0,r._)([(0,a.e)({cloudy:"cloudy"})],l.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],l.prototype,"cloudCover",void 0),l=n=(0,r._)([(0,h.$)("esri.views.3d.environment.CloudyWeather")],l);const c=l;var u;let d=u=class extends s.oY{constructor(t){super(t),this.type="foggy",this.fogStrength=.5}clone(){return new u({fogStrength:this.fogStrength})}};(0,r._)([(0,a.e)({foggy:"foggy"})],d.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"fogStrength",void 0),d=u=(0,r._)([(0,h.$)("esri.views.3d.environment.FoggyWeather")],d);const f=d;var p;let g=p=class extends s.oY{constructor(t){super(t),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new p({cloudCover:this.cloudCover,precipitation:this.precipitation})}};(0,r._)([(0,a.e)({rainy:"rainy"})],g.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"cloudCover",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],g.prototype,"precipitation",void 0),g=p=(0,r._)([(0,h.$)("esri.views.3d.environment.RainyWeather")],g);const v=g;var m;let y=m=class extends s.oY{constructor(t){super(t),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new m({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};(0,r._)([(0,a.e)({snowy:"snowy"})],y.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],y.prototype,"cloudCover",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],y.prototype,"precipitation",void 0),(0,r._)([(0,o.MZ)({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],y.prototype,"snowCover",void 0),y=m=(0,r._)([(0,h.$)("esri.views.3d.environment.SnowyWeather")],y);const _=y;var b;let w=b=class extends s.oY{constructor(t){super(t),this.type="sunny",this.cloudCover=.5}clone(){return new b({cloudCover:this.cloudCover})}};(0,r._)([(0,a.e)({sunny:"sunny"})],w.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],w.prototype,"cloudCover",void 0),w=b=(0,r._)([(0,h.$)("esri.views.3d.environment.SunnyWeather")],w);const x={key:"type",base:w,typeMap:{sunny:w,cloudy:c,rainy:v,snowy:_,foggy:f}};Object.keys(x.typeMap);const T=1e4,A=1e5},53202:function(t,e,i){"use strict";i.r(e),i.d(e,{DrawGraphicTool3D:function(){return hn},ExtentTransformTool:function(){return Da},ManipulatedObject3DGraphic:function(){return Fa},MoveTool3D:function(){return Ss},ReshapeTool3D:function(){return oo},TransformTool3D:function(){return So}});var n=i(53804),r=i(75505),s=i(61226),o=i(95929),a=i(28181),h=i(23502),l=i(58941),c=(i(40633),i(13798),i(65953)),u=i(20551),d=i(32501),f=i(68945),p=i(6422),g=i(13520),v=(i(39819),i(15263)),m=i(52874),y=(i(64122),i(83525)),_=i(77472),b=i(15774),w=i(88226),x=i(62938),T=i(13786),A=i(1932),M=i(38441),S=i(50973),E=i(38225),C=i(76722);i(77528);let O=(t,e,i)=>{for(let n=0,r=e.length;n<r;n++){let r=e[n];Array.isArray(r)?O(t,r,i):null!=r&&!1!==r&&("string"==typeof r&&(r={vnodeSelector:"",properties:void 0,children:void 0,text:r.toString(),domNode:null}),i.push(r))}};i(81401);const R={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let I=class extends y.A{get position(){return[this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1])}get _textShadowColor(){const{textColor:t,backgroundColor:e}=this,i=e.clone();return i.a*=t.a,i}get _textShadow(){const t=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${t}`}get padding(){return.5*this.fontSize}get borderRadius(){return this.padding}set borderRadius(t){this._overrideIfSome("borderRadius",t)}constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.isDecoration=!0,this.backgroundColor=new m.A([0,0,0,.6]),this.textColor=new m.A([255,255,255]),this._textShadowSize=1}render(){return function(t,e,i){if(Array.isArray(e))i=e,e=void 0;else if(e&&("string"==typeof e||e.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,r;return i&&1===i.length&&"string"==typeof i[0]?n=i[0]:i&&(r=[],O("div",i,r),0===r.length&&(r=void 0)),{vnodeSelector:"div",properties:e,children:r,text:""===n?void 0:n,domNode:null}}(0,{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this.borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const{padding:i,borderRadius:n}=this,r=t.measureText(this.text).width,s=""!==this.text?this.fontSize:0,o=P[this.anchor];t.textAlign="center",t.textBaseline="middle";const a=r+2*i,h=s+2*i,l=this.x+o.x*a,c=this.y+o.y*h;this._roundedRect(t,l,c,a,h,n),t.fillStyle=this.backgroundColor.toCss(!0),t.fill();const u=this.x+(o.x+.5)*a,d=this.y+(o.y+.5)*h;this._renderTextShadow(t,this.text,u,d),t.fillStyle=this.textColor.toCss(!0),t.fillText(this.text,u,d)}_renderTextShadow(t,e,i,n){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/N.length})`;const r=this._textShadowSize;for(const[s,o]of N)t.fillText(e,i+r*s,n+r*o)}_roundedRect(t,e,i,n,r,s){s=Math.min(s,r/2,n/2),t.beginPath(),t.moveTo(e,i+s),t.arcTo(e,i,e+s,i,s),t.lineTo(e+n-s,i),t.arcTo(e+n,i,e+n,i+s,s),t.lineTo(e+n,i+r-s),t.arcTo(e+n,i+r,e+n-s,i+r,s),t.lineTo(e+s,i+r),t.arcTo(e,i+r,e,i+r-s,s),t.closePath()}_cssClasses(){const t={"esri-text-overlay-item":!0};let e;for(e in R)t[R[e]]=this.anchor===e;return t}};(0,n._)([(0,h.MZ)()],I.prototype,"x",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"y",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"position",null),(0,n._)([(0,h.MZ)()],I.prototype,"text",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"fontSize",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"anchor",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"visible",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"isDecoration",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"backgroundColor",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"textColor",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"_textShadowSize",void 0),(0,n._)([(0,h.MZ)()],I.prototype,"_textShadowColor",null),(0,n._)([(0,h.MZ)()],I.prototype,"_textShadow",null),(0,n._)([(0,h.MZ)()],I.prototype,"padding",null),(0,n._)([(0,h.MZ)()],I.prototype,"borderRadius",null),I=(0,n._)([(0,c.$)("esri.views.overlay.TextOverlayItem")],I);const P={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},N=[];{const t=16;for(let e=0;e<360;e+=360/t)N.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}const D=I;var L=i(9862),z=i(22739);const j={default:15,far:25};let k=class extends y.A{constructor(t){super(t),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messageUnitsTask=null,this._labelInfos=[],this._nextLabelIndex=0}initialize(){this.addHandles([(0,a.watch)((()=>[null!=this.context&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((t=>(0,a.on)((()=>this.context?.editGeometryOperations),t,(()=>this._update())))),(0,a.watch)((()=>this._colors),(t=>this._updateStyle(t))),(0,z.oQ)((()=>this._refreshMessages())),(0,s.hA)((()=>this._messageUnitsTask?.abort()))]),this._refreshMessages()}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){}get _messagesUnits(){return this._messageUnitsTask?.value}get _edgeDistancePixels(){return j[this.edgeDistance]}get _colors(){const t=this.context?.view.effectiveTheme.textColor??m.A.fromArray([255,255,255]);return{textColor:t,backgroundColor:(0,r._L)((0,r.bJ)(t,r.pW.Low),.6)}}_update(){if(this.destroyed)return;this._nextLabelIndex=0;const{context:t,stagedVertex:e}=this;if(!t)return this._destroyUnusedLabels();const{editGeometryOperations:i}=t,{components:n,geometry:r,coordinateHelper:s}=i.data;if(!r)return this._destroyUnusedLabels();const o=n.length;for(let n=0;n<o;++n){const a=F(r,i,e,s,n);if(a.length<2||!H(a,t.view,t.elevationInfo,s.spatialReference))continue;const h=1===o&&!(0,M.$3)(a);let l=U,c=$;this.toScreenPointArray(t,a[0],l);for(let e=1;e<a.length;++e){const i=a[e-1],n=a[e];this.toScreenPointArray(t,n,c),this._addLabel(t,i,l,n,c,h),[l,c]=[c,l]}}this._destroyUnusedLabels()}_updateStyle({textColor:t,backgroundColor:e}){const i=this._nextLabelIndex,n=this._labelInfos;for(let r=0;r<i;++r){const{label:i}=n[r];i.textColor=t,i.backgroundColor=e}}_addLabel(t,e,i,n,r,s){const{label:o}=this._getOrCreateLabel(t);if(!this.visible||(0,T.hG)(i,r)<3025)return void(o.visible=!1);const{spatialReference:a}=t.editGeometryOperations.data,h=(0,L.Do)(e,n,a),l=this._messagesUnits,c=(0,C.c)(t.view);o.text=null!=l&&null!=h?(0,w.ix)(l,h,c):"",o.visible=!0;const u=r[0]-i[0],d=r[1]-i[1];s?(0,T.hZ)(G,-d,u):(0,T.hZ)(G,d,-u),(0,T.S8)(G,G),(0,T.hs)(G,G,this._edgeDistancePixels),(0,T.Cc)(V,i,r,.5),(0,T.WQ)(V,V,G),o.position=[V[0],V[1]],Math.abs(G[0])>Math.abs(G[1])?o.anchor=G[0]>0?"left":"right":o.anchor=-G[1]<0?"top":"bottom"}_getOrCreateLabel(t){const e=this._labelInfos.length>this._nextLabelIndex,{textColor:i,backgroundColor:n}=this._colors;if(e){const t=this._labelInfos[this._nextLabelIndex++],{label:e}=t;return e.textColor=i,e.backgroundColor=n,t}const r=new D({anchor:"center",fontSize:8,textColor:i,backgroundColor:n});t.view.overlay?.items.add(r);const s={label:r};return this._labelInfos.push(s),this._nextLabelIndex=this._labelInfos.length,s}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:t}){this.context?.view.overlay?.items.remove(t),t.destroy()}_refreshMessages(){this._messageUnitsTask?.abort(),this._messageUnitsTask=(0,_.UT)((()=>(0,E.ud)("esri/core/t9n/Units")))}};function F(t,e,i,n,r){const s=[];if(e.data.components[r].iterateVertices((t=>{s.push(n.toXYZ(t.pos,S.rq.get()))})),0===r&&null!=i&&s.push(n.toXYZ(i,S.rq.get())),s.length<2)return s;const o=s[0],a=s[s.length-1];return"polygon"===t.type&&s.length>2&&!(0,u.H)(o,a)&&s.push(o),s}function H(t,e,i,n){if("2d"===e.type)return!0;const r=(0,x.Ao)(n)??1,s=(0,x.G9)(n),o=t=>(0,f.xS)(e,t,n,i,f.qt)??0;for(let e=1;e<t.length;++e){const i=t[e-1],n=t[e],a=(n[0]-i[0])*r,h=(n[1]-i[1])*r,l=(o(n)-o(i))*s;if(Math.abs(l)/Math.sqrt(a*a+h*h)>B)return!1}return!0}(0,n._)([(0,h.MZ)()],k.prototype,"context",void 0),(0,n._)([(0,h.MZ)()],k.prototype,"stagedVertex",void 0),(0,n._)([(0,h.MZ)()],k.prototype,"visible",void 0),(0,n._)([(0,h.MZ)()],k.prototype,"edgeDistance",void 0),(0,n._)([(0,h.MZ)()],k.prototype,"updating",null),(0,n._)([(0,h.MZ)()],k.prototype,"_messageUnitsTask",void 0),(0,n._)([(0,h.MZ)()],k.prototype,"_messagesUnits",null),(0,n._)([(0,h.MZ)()],k.prototype,"_edgeDistancePixels",null),(0,n._)([(0,h.MZ)()],k.prototype,"_colors",null),k=(0,n._)([(0,c.$)("esri.views.interactive.SegmentLabels")],k);const B=(0,b.kU)(5),G=(0,A.vt)(),V=(0,A.vt)(),U=(0,g.gs)(),$=(0,g.gs)();let W=class extends k{getCameraOrExtent({view:t}){return t.state.camera}toScreenPointArray({view:t,elevationInfo:e,editGeometryOperations:i},n,r=(0,g.gs)()){const{spatialReference:s}=i.data.coordinateHelper;return(0,v.X)(n,s,e,t,q),t.state.camera.projectToScreen(q,r),r}};W=(0,n._)([(0,c.$)("esri.views.3d.interactive.SegmentLabels3D")],W);const q=(0,d.vt)();var Z=i(68734),Y=i(33400),X=i(41546),K=i(91912),J=i(69508),Q=i(73313),tt=i(79578),et=i(88781),it=i(46949),nt=i(96253),rt=i(91998);class st{constructor(t){this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=it.O7.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(t){t!==this._attached&&(this._attached=t,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(t){this._renderGroup=t;const e=this._resources?.layerView;e&&(e.renderGroup=t)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const t=this._resourceFactory.createResources(),e=new ot({view:this._resourceFactory.view,renderGroup:this._renderGroup}),i=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new ot({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:t,geometriesAdded:!1},i&&(this._resources.drapeSourceRenderer=i.registerGeometryDrapeSource(e)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const t=this._resourceFactory.view.basemapTerrain?.overlayManager;t&&t.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,nt.q.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,nt.q.UPDATE),this._resources.geometriesAdded=!0))}}let ot=class extends((0,et.sA)(y.A)){constructor(t){super(t),this.drapeSourceType=it.Om.Features,this.updatePolicy=rt.q.SYNC,this.renderGroup=it.O7.Outline}};(0,n._)([(0,h.MZ)({constructOnly:!0})],ot.prototype,"view",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],ot.prototype,"drapeSourceType",void 0),(0,n._)([(0,h.MZ)()],ot.prototype,"renderGroup",void 0),ot=(0,n._)([(0,c.$)("esri.views.3d.interactive.visualElements.DrapedVisualElementResources")],ot);class at{get isDecoration(){return this._isDecoration}set isDecoration(t){this._isDecoration=t}constructor(t){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t.view,this._handle=(0,a.watch)((()=>t.view.ready),(t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())}))}applyProperties(t){let e=!1;for(const i in t)i in this&&("attached"===i?e=!!t[i]:this[i]=t[i]);this.attached=e}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(t){t!==this._attached&&this.view._stage&&(this._attached=t,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(t))}onAttachedChange(t){}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this.attached&&this.updateVisibility(t))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}var ht=i(40359),lt=i(10713),ct=i(1296);class ut{constructor(t){this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this._syncVisible())}get attached(){return this._attached}set attached(t){t!==this._attached&&(this._attached=t,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const t=this._resourceFactory.view._stage;if(null==this._resources||!t)return;const e=this._resources.object;this._resources.external.forEach((e=>{e.type!==ht.X.Mesh&&e.type!==ht.X.Line&&e.type!==ht.X.Point||t.remove(e)})),e.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,e,this._resources.layer),this._resources.external.forEach((e=>{e.type!==ht.X.Mesh&&e.type!==ht.X.Line&&e.type!==ht.X.Point||t.add(e)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const t=this._resourceFactory,e=t.view,i=e._stage;if(!i)return;const n=new ct.x(i,{pickable:!1,updatePolicy:rt.q.SYNC}),r=new lt.B({castShadow:!1}),s=t.createResources(r,n);s.forEach((t=>{i.add(t),t.type===ht.X.Texture&&t.load(i.renderView.renderingContext)})),i.add(r),n.add(r);const o=t.cameraChanged,h=o?(0,a.watch)((()=>e.state.camera),(t=>o(t)),a.Vh):null;this._resources={layer:n,object:r,external:s,cameraHandle:h},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const t=this._resourceFactory.view._stage;t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((e=>{t.remove(e),e.type===ht.X.Texture&&e.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class dt extends at{constructor(t){super(t),this._isDraped=!1,this.object3dResources=new ut(this.createObject3DResourceFactory(t.view)),this.drapedResources=new st(this.createDrapedResourceFactory(t.view)),this.isDraped=t.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(t){t!==this._isDraped&&(this._isDraped=t,this.object3dResources.attached=this.attached&&!t,this.drapedResources.attached=this.attached&&t)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(t){this.drapedResources.renderGroup=t}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(t){this.object3dResources.visible=t,this.drapedResources.visible=t}}var ft=i(65420),pt=i(46671),gt=i(74174),vt=i(1092),mt=i(82547),yt=i(34615),_t=i(82273),bt=i(54204),wt=i(57087);class xt extends _t.w{constructor(t,e,n){super(t,e,new yt.$(vt.a,(()=>i.e(3557).then(i.bind(i,42132)))),n)}initializePipeline(t){switch(t.blitMode){case bt.d.None:case bt.d.Depth:return(0,wt.Ey)({colorWrite:wt.kn});case bt.d.Alpha:return(0,wt.Ey)({blending:wt.Ky,colorWrite:wt.kn});default:(0,mt.Xb)(t.blitMode);case bt.d.PremultipliedAlpha:case bt.d.COUNT:return(0,wt.Ey)({blending:wt.Os,colorWrite:wt.kn})}}}var Tt=i(85456);class At{constructor(t,e=bt.d.None){this._techniques=t,this._parameters=new vt.C,this._configuration=new bt.N,this._configuration.blitMode=e,t.precompile(xt,this._configuration)}blit(t,e,i,n){t.bindFramebuffer(i.fbo),t.setClearColor(0,0,0,1),t.clear(Tt.NV.COLOR),this._parameters.texture=e.getTexture();const r=this._techniques.acquire(xt,this._configuration);t.bindTechnique(r,n,this._parameters),t.screen.draw(),r.release()}blend(t,e,i,n,r=1){this._configuration.hasOpacityFactor=r<1;const s=this._techniques.acquire(xt,this._configuration);return s.compiled?(t.bindFramebuffer(i.fbo),this._parameters.texture=e.getTexture(),this._parameters.opacity=r,t.bindTechnique(s,n,this._parameters),t.screen.draw(),s.release(),!0):(s.release(),!1)}}var Mt=i(50240),St=i(69550),Et=i(65856),Ct=i(39506),Ot=i(96500);class Rt extends Ct.Y{constructor(){super(...arguments),this.innerColor=(0,d.fA)(1,1,1),this.innerWidth=1,this.glowColor=(0,d.fA)(1,.5,0),this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.75,this.globalAlphaContrastBoost=2,this.angleCutoff=(0,b.kU)(6),this.pointDistanceOrigin=(0,d.vt)(),this.pointDistanceTarget=(0,d.vt)(),this.lineVerticalPlaneSegment=(0,Q.vt)(),this.intersectsLineSegment=(0,Q.vt)(),this.intersectsLineRadius=3,this.heightManifoldTarget=(0,d.vt)(),this.lineStartWorld=(0,d.vt)(),this.lineEndWorld=(0,d.vt)()}}class It extends _t.w{constructor(t,e,n){super(t,e,new yt.$(Ot.L,(()=>i.e(3824).then(i.bind(i,62372)))),n)}}var Pt=i(65839),Nt=i(58054);class Dt extends Rt{constructor(){super(...arguments),this.origin=(0,d.vt)()}}class Lt extends _t.w{constructor(t,e,n){super(t,e,new yt.$(Nt.L,(()=>i.e(2436).then(i.bind(i,28374)))),n,zt)}}const zt=new Map([[Pt.r.START,0],[Pt.r.END,1],[Pt.r.EXTRUDE,2],[Pt.r.START_UP,3],[Pt.r.END_UP,4]]);var jt=i(69445),kt=i(86305);class Ft{constructor(t){this._renderCoordsHelper=t,this._buffers=null,this._origin=(0,d.vt)(),this._dirty=!1,this._count=0,this._vao=null}set vertices(t){const e=(0,Mt.jh)(3*t.length);let i=0;for(const n of t)e[i++]=n[0],e[i++]=n[1],e[i++]=n[2];this.buffers=[e]}set buffers(t){if(this._buffers=t,this._buffers.length>0){const t=this._buffers[0],e=3*Math.floor(t.length/3/2);(0,u.i)(this._origin,t[e],t[e+1],t[e+2])}else(0,u.i)(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(t){const e=this._ensureVAO(t);null!=e&&(t.bindVAO(e),t.drawArrays(Tt.WR.TRIANGLES,0,this._count))}dispose(){null!=this._vao&&this._vao.dispose()}get _layout(){return this._renderCoordsHelper.viewingMode===ft.RT.Global?Vt:Ut}_ensureVAO(t){return null==this._buffers?null:(this._vao??=this._createVAO(t,this._buffers),this._ensureVertexData(this._vao,this._buffers),this._vao)}_createVAO(t,e){const i=this._createDataBuffer(e);return this._dirty=!1,new jt.Z(t,zt,new Map([["data",(0,St.U)(this._layout)]]),new Map([["data",kt.g.createVertex(t,Tt._U.STATIC_DRAW,i)]]))}_ensureVertexData(t,e){if(!this._dirty)return;const i=this._createDataBuffer(e);t.vertexBuffers.get("data")?.setData(i),this._dirty=!1}_createDataBuffer(t){const e=t.reduce(((t,e)=>t+Ht(e)),0);this._count=e;const i=this._layout.createBuffer(e),n=this._origin;let r=0,s=0;const o="startUp"in i?this._setUpVectors.bind(this,i):void 0;for(const e of t){for(let t=0;t<e.length;t+=3){const a=(0,u.i)(Gt,e[t],e[t+1],e[t+2]);0===t?s=this._renderCoordsHelper.getAltitude(a):this._renderCoordsHelper.setAltitude(a,s);const h=r+2*t;o?.(t,h,e,a);const l=(0,u.d)(Gt,a,n);if(t<e.length-3){for(let t=0;t<6;t++)i.start.setVec(h+t,l);i.extrude.setValues(h,0,-1),i.extrude.setValues(h+1,1,-1),i.extrude.setValues(h+2,1,1),i.extrude.setValues(h+3,0,-1),i.extrude.setValues(h+4,1,1),i.extrude.setValues(h+5,0,1)}if(t>0)for(let t=-6;t<0;t++)i.end.setVec(h+t,l)}r+=Ht(e)}return i.buffer}_setUpVectors(t,e,i,n,r){const s=this._renderCoordsHelper.worldUpAtPosition(r,Bt);if(e<n.length-3)for(let e=0;e<6;e++)t.startUp.setVec(i+e,s);if(e>0)for(let e=-6;e<0;e++)t.endUp.setVec(i+e,s)}}function Ht(t){return 2*(t.length/3-1)*3}const Bt=(0,d.vt)(),Gt=(0,d.vt)(),Vt=(0,Et.BP)().vec3f(Pt.r.START).vec3f(Pt.r.END).vec2f(Pt.r.EXTRUDE).vec3f(Pt.r.START_UP).vec3f(Pt.r.END_UP),Ut=(0,Et.BP)().vec3f(Pt.r.START).vec3f(Pt.r.END).vec2f(Pt.r.EXTRUDE);var $t=i(65875);class Wt extends $t.K{constructor(){super(...arguments),this.contrastControlEnabled=!1,this.spherical=!1}}(0,n._)([(0,$t.W)()],Wt.prototype,"contrastControlEnabled",void 0),(0,n._)([(0,$t.W)()],Wt.prototype,"spherical",void 0);class qt extends Wt{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1}}(0,n._)([(0,$t.W)()],qt.prototype,"heightManifoldEnabled",void 0),(0,n._)([(0,$t.W)()],qt.prototype,"pointDistanceEnabled",void 0),(0,n._)([(0,$t.W)()],qt.prototype,"lineVerticalPlaneEnabled",void 0),(0,n._)([(0,$t.W)()],qt.prototype,"intersectsLineEnabled",void 0);var Zt=i(54407),Yt=i(84887);let Xt=class extends gt.A{constructor(t){super(t),this.produces=pt.OG.LASERLINES,this.consumes={required:[pt.OG.LASERLINES,"normals"]},this.requireGeometryDepth=!0,this._configuration=new qt,this._pathTechniqueConfiguration=new Wt,this._heightManifoldEnabled=!1,this._pointDistanceEnabled=!1,this._lineVerticalPlaneEnabled=!1,this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._pathVerticalPlaneEnabled=!1,this._passParameters=new Dt;const e=t.view._stage.renderView.techniques,i=new Wt;i.contrastControlEnabled=t.contrastControlEnabled,e.precompile(Lt,i)}initialize(){this._passParameters.renderCoordsHelper=this.view.renderCoordsHelper,this._pathTechniqueConfiguration.spherical=this.view.state.viewingMode===ft.RT.Global,this._pathTechniqueConfiguration.contrastControlEnabled=this.contrastControlEnabled,this._techniques.precompile(Lt,this._pathTechniqueConfiguration),this._blit=new At(this._techniques,bt.d.PremultipliedAlpha)}destroy(){this._pathVerticalPlaneData=(0,o.WD)(this._pathVerticalPlaneData),this._blit=null}get _techniques(){return this.view._stage.renderView.techniques}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(t){this._heightManifoldEnabled!==t&&(this._heightManifoldEnabled=t,this.requestRender(Zt.C7.UPDATE))}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(t){(0,u.c)(this._passParameters.heightManifoldTarget,t),this.requestRender(Zt.C7.UPDATE)}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(t){t!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=t,this.requestRender(Zt.C7.UPDATE))}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(t){(0,u.c)(this._passParameters.pointDistanceTarget,t),this.requestRender(Zt.C7.UPDATE)}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(t){(0,u.c)(this._passParameters.pointDistanceOrigin,t),this.requestRender(Zt.C7.UPDATE)}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(t){t!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=t,this.requestRender(Zt.C7.UPDATE))}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(t){(0,Q.C)(t,this._passParameters.lineVerticalPlaneSegment),this.requestRender(Zt.C7.UPDATE)}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(t){t!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=t,this.requestRender(Zt.C7.UPDATE))}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(t){(0,Q.C)(t,this._passParameters.intersectsLineSegment),this.requestRender(Zt.C7.UPDATE)}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(t){t!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=t,this.requestRender(Zt.C7.UPDATE))}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(t){t!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=t,this.requestRender(Zt.C7.UPDATE))}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(t){t!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=t,null!=this._pathVerticalPlaneData&&this.requestRender(Zt.C7.UPDATE))}set pathVerticalPlaneVertices(t){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new Ft(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.vertices=t,this.pathVerticalPlaneEnabled&&this.requestRender(Zt.C7.UPDATE)}set pathVerticalPlaneBuffers(t){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new Ft(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.buffers=t,this.pathVerticalPlaneEnabled&&this.requestRender(Zt.C7.UPDATE)}setParameters(t){(0,Yt.MB)(this._passParameters,t)&&this.requestRender(Zt.C7.UPDATE)}precompile(){this._acquireTechnique().release()}render(t){const e=t.find((({name:t})=>t===pt.OG.LASERLINES));if(!this.bindParameters.decorations||null==this._blit)return e;const i=this.renderingContext,n=t.find((({name:t})=>"normals"===t));this._passParameters.normals=n?.getTexture();const r=()=>{(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(),this.pathVerticalPlaneEnabled&&this._renderPath()};if(!this.contrastControlEnabled)return i.bindFramebuffer(e.fbo),r(),e;this._passParameters.colors=e.getTexture();const s=this.fboCache.acquire(e.fbo.width,e.fbo.height,"laser lines");return i.bindFramebuffer(s.fbo),i.setClearColor(0,0,0,0),i.clear(Tt.NV.COLOR|Tt.NV.DEPTH),r(),i.unbindTexture(e.getTexture()),this._blit.blend(i,s,e,this.bindParameters)||this.requestRender(Zt.C7.UPDATE),s.release(),e}_acquireTechnique(){return this._configuration.heightManifoldEnabled=this.heightManifoldEnabled,this._configuration.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._configuration.pointDistanceEnabled=this.pointDistanceEnabled,this._configuration.intersectsLineEnabled=this.intersectsLineEnabled,this._configuration.contrastControlEnabled=this.contrastControlEnabled,this._configuration.spherical=this.view.state.viewingMode===ft.RT.Global,this._techniques.acquire(It,this._configuration)}_renderUnified(){if(!this._updatePassParameters())return;const t=this._acquireTechnique();if(t.compiled){const e=this.renderingContext;e.bindTechnique(t,this.bindParameters,this._passParameters),e.screen.draw()}else this.requestRender(Zt.C7.UPDATE);t.release()}_renderPath(){if(null==this._pathVerticalPlaneData)return;const t=this._techniques.acquire(Lt,this._pathTechniqueConfiguration);if(t.compiled){const e=this.renderingContext;this._passParameters.origin=this._pathVerticalPlaneData.origin,e.bindTechnique(t,this.bindParameters,this._passParameters),this._pathVerticalPlaneData.draw(e)}else this.requestRender(Zt.C7.UPDATE);t.release()}_updatePassParameters(){if(!this._intersectsLineEnabled)return!0;const t=this.bindParameters.camera,e=this._passParameters;if(this._intersectsLineInfinite){if((0,K.$e)((0,tt.LV)(e.intersectsLineSegment.origin,e.intersectsLineSegment.vector),Kt),Kt.c0=-Number.MAX_VALUE,!(0,J.ig)(t.frustum,Kt))return!1;(0,K.j1)(Kt,e.lineStartWorld),(0,K.mO)(Kt,e.lineEndWorld)}else(0,u.c)(e.lineStartWorld,e.intersectsLineSegment.origin),(0,u.g)(e.lineEndWorld,e.intersectsLineSegment.origin,e.intersectsLineSegment.vector);return!0}get test(){}};(0,n._)([(0,h.MZ)({constructOnly:!0})],Xt.prototype,"contrastControlEnabled",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],Xt.prototype,"isDecoration",void 0),(0,n._)([(0,h.MZ)()],Xt.prototype,"produces",void 0),(0,n._)([(0,h.MZ)()],Xt.prototype,"consumes",void 0),Xt=(0,n._)([(0,c.$)("esri.views.3d.webgl-engine.effects.laserlines.LaserLineRenderer")],Xt);const Kt=(0,K.vt)();class Jt extends at{constructor(t){super(t),this._angleCutoff=Ot.d,this._style={},this._heightManifoldTarget=(0,d.vt)(),this._heightManifoldEnabled=!1,this._intersectsLine=(0,Q.vt)(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProperties(t)}get testData(){}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(t){this._angleCutoff!==t&&(this._angleCutoff=t,this._syncAngleCutoff())}get style(){return this._style}set style(t){this._style=t,this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(t){null!=t?((0,u.c)(this._heightManifoldTarget,t),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold()}set intersectsWorldUpAtLocation(t){if(null==t)return void(this.intersectsLine=null);const e=this.view.renderCoordsHelper.worldUpAtPosition(t,Qt);this.intersectsLine=(0,Q.fA)(t,e),this.intersectsLineInfinite=!0}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(t){null!=t?((0,Q.C)(t,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(t){this._intersectsLineInfinite=t,this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(t){this._lineVerticalPlaneSegment=null!=t?(0,Q.C)(t):null,this._syncLineVerticalPlane(),this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(t){this._pathVerticalPlaneBuffers=t,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(t){this._pointDistanceLine=null!=t?{origin:(0,d.o8)(t.origin),target:t.target?(0,d.o8)(t.target):null}:null,this._syncPointDistance(),this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new Xt({view:this.view,contrastControlEnabled:!0,isDecoration:this.isDecoration}),this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff())}_syncStyle(){null!=this._renderer&&(this._renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){null!=this._renderer&&this._renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null==this._renderer)return;const t=this._pointDistanceLine,e=null!=t;this._renderer.pointDistanceEnabled=e&&null!=t.target&&this.visible,e&&(this._renderer.pointDistanceOrigin=t.origin,null!=t.target&&(this._renderer.pointDistanceTarget=t.target))}_disposeRenderer(){null!=this._renderer&&this.view._stage&&(this._renderer.destroy(),this._renderer=null)}}const Qt=(0,d.vt)();var te=i(58704),ee=i(8470),ie=i(24100),ne=i(15389),re=i(65352);class se extends dt{constructor(t){super(t),this._ray=(0,tt.vt)(),this._isWorldDown=!1,this._start=(0,d.vt)(),this._end=(0,d.fA)(1,0,0),this._width=1,this._color=(0,X.fA)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,X.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=ue.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=ie.m$.OccludeAndTransparent,this._fadedExtensions=pe,this._laserline=new Jt({view:this.view,isDecoration:t.isDecoration}),this.applyProperties(t)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(t){return{view:t,createResources:t=>this._createObject3DResources(t),destroyResources:oe,recreateGeometry:(t,e)=>this._recreateObject3DGeometry(t,e),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(t){return{view:t,createResources:()=>this._createDrapedResources(),destroyResources:oe,recreateGeometry:t=>this._recreateDrapedGeometry(t)}}updateVisibility(t){super.updateVisibility(t),this._laserline.visible=t}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(t){this._isWorldDown=!0,(0,u.c)(this._start,t),this.view.renderCoordsHelper.worldUpAtPosition(t,this._end),(0,u.d)(this._end,t,this._end),(0,tt.Cr)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(t){this._isWorldDown=!1,(0,u.p)(this._start,t)||((0,u.c)(this._start,t),(0,tt.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(t){this._isWorldDown=!1,(0,u.p)(this._end,t)||((0,u.c)(this._end,t),(0,tt.Cr)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get color(){return this._color}set color(t){(0,Y.a)(t,this._color)||((0,Y.c)(this._color,t),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){t!==this._polygonOffset&&(this._polygonOffset=t,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(t){this._writeDepthEnabled!==t&&(this._writeDepthEnabled=t,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(t){t!==this._innerWidth&&(this._innerWidth=t,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(t){(0,Y.a)(t,this._innerColor)||((0,Y.c)(this._innerColor,t),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const e=null!=t!=(null!=this._stipplePattern);this._stipplePattern=t,e?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(t){null!=t&&null!=this._stippleOffColor&&(0,Y.a)(t,this._stippleOffColor)||(this._stippleOffColor=null!=t?(0,X.o8)(t):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(t){t!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=t,this._updateMaterial())}get falloff(){return this._falloff}set falloff(t){t!==this._falloff&&(this._falloff=t,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(t){t!==this._extensionType&&(this._extensionType=t,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(t){this._laserlineStyle=t,this._laserline.attached=this._laserlineAttached,null!=t&&(this._laserline.style=t)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(t){this._laserlineEnabled!==t&&(this._laserlineEnabled=t,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===ie.m$.OccludeAndTransparentStencil?ie.m$.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(t){this._fadedExtensions=t??pe,this.recreateGeometry()}_updateMaterial(){const{materialParameters:t}=this;this.object3dResources.resources?.material.setParameters(t),this.drapedResources.resources?.material.setParameters(t)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(t){const e=new re.W(this.materialParameters),i=new Array;return this._createObject3DGeometry(e,t,i),{material:e,geometries:i,forEach:t=>{t(e),i.forEach(t)}}}_recreateObject3DGeometry(t,e){t.geometries.length=0,this._createObject3DGeometry(t.material,e,t.geometries)}_createObject3DGeometry(t,e,i){const n=this._createGeometry(t);i.push(n),e.addGeometry(n),this._updateVerticesObject3D(e)}_createDrapedResources(){const t=new re.W(this.materialParameters);return{material:t,geometries:[this._createDrapedGeometry(t)]}}_recreateDrapedGeometry(t){t.geometries=[this._createDrapedGeometry(t.material)]}_createDrapedGeometry(t){const e=this._createGeometry(t);return this._updateVerticesDraped(e),new ne.$(e)}_createGeometry(t){const e=this.extensionType===ue.FADED,i=e?[(0,d.vt)(),(0,d.vt)(),(0,d.vt)(),(0,d.vt)()]:[(0,d.vt)(),(0,d.vt)()];return(0,ee.Z8)(t,i,null,e?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const t=this.object3dResources.object;t&&this._updateVerticesObject3D(t)}}_updateVerticesObject3D(t){const e=this._lineSegment;this._updateVertexAttributesObject3D(t,e),this._laserline.intersectsLine=e}_updateVerticesDraped(t){this._updateVertexAttributesDraped(t,this._lineSegment)}get _lineSegment(){return this._extensionType===ue.FADED?this._updateLineSegmentFinite(ce):this._updateLineSegmentInfinite(this._extensionType,ce)}_updateLineSegmentFinite(t){return(0,Q.Cr)(this._start,this._end,t)}_updateLineSegmentInfinite(t,e){const i=this.view.state.camera;switch((0,K.$e)(this._ray,ae),t){case ue.LINE:ae.c0=-Number.MAX_VALUE;break;case ue.RAY:case ue.GROUND_RAY:{const t=this._ray.origin,e=this.view.elevationProvider.getElevation(t[0],t[1],t[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,i=this.view.renderCoordsHelper.getAltitude(t);this._isWorldDown&&i<e&&(0,u.v)(ae.ray.direction,ae.ray.direction),this._extensionType===ue.GROUND_RAY&&null!=e&&(ae.c1=Math.abs(i-e));break}}if(!(0,J.ig)(i.frustum,ae))return this._updateLineSegmentFinite(e);const n=(0,K.j1)(ae,he),r=(0,K.mO)(ae,le);return(0,Q.Cr)(n,r,e)}_updateVertexAttributesObject3D(t,e){const i=t.geometries[0].getMutableAttribute(Pt.r.POSITION)?.data;if(!i)return;let n=0;for(const t of this._lineVertices(e))i[n++]=t[0],i[n++]=t[1],i[n++]=t[2];t.geometryVertexAttributeUpdated(t.geometries[0],Pt.r.POSITION)}_updateVertexAttributesDraped(t,e){const i=t.getMutableAttribute(Pt.r.POSITION)?.data;if(!i)return;let n=0;for(const t of this._lineVertices(e))i[n++]=t[0],i[n++]=t[1],i[n++]=te.bi;t.invalidateBoundingInfo()}*_lineVertices(t){this.extensionType===ue.FADED?(yield(0,Q.sd)(t,-this.fadedExtensions.start,he),yield(0,Q.sd)(t,0,he),yield(0,Q.sd)(t,1,he),yield(0,Q.sd)(t,1+this.fadedExtensions.end,he)):(yield(0,Q.sd)(t,0,he),yield(0,Q.sd)(t,1,he))}}function oe(t){t.geometries=[]}const ae=(0,K.vt)(),he=(0,d.vt)(),le=(0,d.vt)(),ce=(0,Q.vt)();var ue,de;(de=ue||(ue={}))[de.LINE=0]="LINE",de[de.RAY=1]="RAY",de[de.GROUND_RAY=2]="GROUND_RAY",de[de.FADED=3]="FADED";const fe=1/3,pe={start:fe,end:fe};var ge=i(46460);class ve extends dt{constructor(t){super(t),this._location=(0,d.vt)(),this._direction=(0,d.fA)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,X.fA)(1,0,1,1),this._renderOccluded=ie.m$.OccludeAndTransparent,this.applyProperties(t)}createObject3DResourceFactory(t){return{view:t,createResources:t=>this._createObject3DResources(t),destroyResources:_e,recreateGeometry:(t,e)=>this._recreateObject3DGeometry(t,e),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(t){return{view:t,createResources:()=>this._createDrapedResources(),destroyResources:be,recreateGeometry:t=>this._recreateDrapedGeometry(t)}}get location(){return this._location}set location(t){(0,u.p)(this._location,t)||((0,u.c)(this._location,t),this._updateGeometry())}get direction(){return this._direction}set direction(t){(0,u.p)(this._direction,t)||((0,u.c)(this._direction,t),this._updateGeometry())}setDirectionFromPoints(t,e){(0,u.n)(this._direction,(0,u.d)(this._direction,e,t)),this._updateGeometry()}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get offset(){return this._offset}set offset(t){t!==this._offset&&(this._offset=t,this._updateGeometry())}get length(){return this._length}set length(t){t!==this._length&&(this._length=t,this._updateGeometry())}get color(){return this._color}set color(t){(0,Y.a)(t,this._color)||((0,Y.c)(this._color,t),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}_createObject3DResources(t){const e=new re.W(this.materialParameters),i=new Array;return this._createObject3DGeometry(e,t,i),{material:e,geometries:i,forEach:t=>{t(e),i.forEach(t)}}}_recreateObject3DGeometry(t,e){t.geometries.length=0,this._createObject3DGeometry(t.material,e,t.geometries)}_createObject3DGeometry(t,e,i){const[n,r]=me(t);e.addGeometry(n),e.addGeometry(r),i.push(n),i.push(r),this._updateVerticesObject3D(e)}_createDrapedResources(){const t=new re.W(this.materialParameters),e=(0,a.watch)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}));return{material:t,geometries:this._createDrapedGeometry(t),pixelRatioHandle:e}}_recreateDrapedGeometry(t){t.geometries=this._createDrapedGeometry(t.material)}_createDrapedGeometry(t){const e=me(t);return this._updateVerticesDraped(e),e.map((t=>new ne.$(t)))}_updateMaterial(){const{materialParameters:t}=this;this.object3dResources.resources?.material.setParameters(t),this.drapedResources.resources?.material.setParameters(t)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const t=this.object3dResources.object;t&&this._updateVerticesObject3D(t)}}_updateVerticesObject3D(t){const e=this.view.state.camera;e.projectToScreen(this.location,Me),(0,u.g)(we,this.location,this.direction),e.projectToScreen(we,Se),(0,T.S8)(Se,(0,T.Re)(Se,Se,Me)),this._updateVertexAttributesObject3D(e,t,0,Me,Se,1),this._updateVertexAttributesObject3D(e,t,1,Me,Se,-1)}_updateVertexAttributesObject3D(t,e,i,n,r,s){const o=e.geometries[i],a=o.getMutableAttribute(Pt.r.POSITION)?.data;if(!a)return;const{start:h,end:l}=ye(r,n,s,this.offset,this.width,this.length);t.unprojectFromScreen((0,g.PR)(h),we),a[0]=we[0],a[1]=we[1],a[2]=we[2],t.unprojectFromScreen((0,g.PR)(l),we),a[3]=we[0],a[4]=we[1],a[5]=we[2],e.geometryVertexAttributeUpdated(o,Pt.r.POSITION)}_updateVerticesDraped(t){const{view:{basemapTerrain:{overlayManager:e},state:{contentPixelRatio:i}}}=this,{location:n,width:r,length:s,offset:o}=this,a=Ee;a.spatialReference=e.renderer.spatialReference,a.x=n[0],a.y=n[1];const h=this.view.overlayPixelSizeInMapUnits(a)*i,l=r*h,c=s*h,u=o*h;this._updateVertexAttributesDraped(t[0],l,c,u,-1),this._updateVertexAttributesDraped(t[1],l,c,u,1)}_updateVertexAttributesDraped(t,e,i,n,r){const s=t.getMutableAttribute(Pt.r.POSITION)?.data;if(!s)return;const{location:o,direction:a}=this,{start:h,end:l}=ye(a,o,r,n,e,i);s[0]=h[0],s[1]=h[1],s[2]=te.bi,s[3]=l[0],s[4]=l[1],s[5]=te.bi,t.invalidateBoundingInfo()}}function me(t){return[(0,ee.Z8)(t,[(0,d.vt)(),(0,d.vt)()]),(0,ee.Z8)(t,[(0,d.vt)(),(0,d.vt)()])]}function ye(t,e,i,n,r,s){const o=(0,T.hs)(xe,(0,T.hZ)(xe,t[1]*i,t[0]*-i),n+r/2),a=(0,T.WQ)(Te,(0,T.WQ)(Te,(0,T.WQ)(Te,e,(0,T.hs)(Te,t,s/2)),o),o);return{start:a,end:(0,T.WQ)(Ae,a,(0,T.hs)(Ae,t,-s))}}function _e(t){t.geometries.length=0}function be(t){t.pixelRatioHandle.remove(),t.geometries=[]}const we=(0,d.vt)(),xe=(0,A.vt)(),Te=(0,A.vt)(),Ae=(0,A.vt)(),Me=(0,g.gs)(),Se=(0,g.gs)(),Ee=(0,ge.T)(0,0,void 0,null);var Ce=i(24761),Oe=i(73364),Re=i(39714);class Ie extends at{constructor(t){super(t),this._resources=null,this._transform=(0,Re.vt)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(t){(0,Oe.C)(this._transform,t),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const t=this._resources.object,e=this.view._stage;e.removeMany(t.geometries),t.removeAllGeometries(),this.createGeometries(t),t.visible=this.visible,e.addMany(t.geometries)}createResources(){this.destroyResources();const t=this.view._stage;if(!t)return;const e=new ct.x(t,{pickable:!1,updatePolicy:rt.q.SYNC}),i=new lt.B({castShadow:!1});i.transformation=this._transform,this.createExternalResources(),this.createGeometries(i),t.addMany(i.geometries),this.forEachExternalMaterial((e=>t.add(e))),t.add(i),e.add(i),i.visible=this.visible,this._resources={layer:e,object:i}}destroyResources(){const t=this.view._stage;null!=this._resources&&t&&(t.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((e=>{t.remove(e)})),t.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(t){null!=this._resources&&(this._resources.object.visible=t)}}var Pe=i(49618),Ne=i(76589),De=i(98323),Le=i(6955);class ze extends Ie{constructor(t){super(t),this._material=null,this._texture=null,this._geometry=null,this._size=3,this._color=(0,X.fA)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,X.fA)(1,1,1,1),this._elevationInfo=null,this.applyProperties(t)}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this.recreateGeometry()}get size(){return this._size}set size(t){if(t!==this._size){const e=this._preferredTextureSize;this._size=t,e<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(t){(0,Y.a)(t,this._color)||((0,Y.c)(this._color,t),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(t){this._pixelSnappingEnabled!==t&&(this._pixelSnappingEnabled=t,this._updateMaterial())}get primitive(){return this._primitive}set primitive(t){this._primitive!==t&&(this._primitive=t,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(t){t!==this._outlineSize&&(this._outlineSize=t,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(t){(0,Y.a)(t,this._outlineColor)||((0,Y.c)(this._outlineColor,t),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this.recreateGeometry()}_updateMaterial(){this._material?.setParameters(this._materialParameters)}_updateSizeAttribute(){const t=this.object;if(null==t)return;const e=t.geometries[0];if(null==e)return;const i=e.getMutableAttribute(Pt.r.SIZE).data,n=this._geometrySize;i[0]=n,i[1]=n,t.geometryVertexAttributeUpdated(t.geometries[0],Pt.r.SIZE)}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:(0,De.ny)(this._primitive),distanceFieldBoundingBox:ke,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/je}createExternalResources(){this._texture=(0,De.sZ)(this._primitive,this._preferredTextureSize),this._material=new Le.R(this._materialParameters,this.view.state.viewingMode===ft.RT.Global);const t=this.view._stage;this._texture.load(t.renderView.renderingContext),t.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null),this._material=null}createGeometries(t){const e=this._createRenderGeometry();null!=e&&t.addGeometry(e)}forEachExternalMaterial(t){this._material&&t(this._material)}get _preferredTextureSize(){return(0,b.qE)(2*this._geometrySize,16,128)}calculateMapBounds(t){const e=this.object?.geometries[0];if(!e)return!1;const i=e.attributes.get(Pt.r.POSITION).data;return(0,Z.F)(i,this.view.renderCoordsHelper.spatialReference,Fe,this.view.spatialReference),(0,Ce.Hq)(t,Fe),!0}_createRenderGeometry(){const{geometry:t,_material:e}=this;if(null==t||null==e)return null;const{renderCoordsHelper:i,elevationProvider:n}=this.view,r=(0,Pe.nG)(t,n,Ne.F.fromElevationInfo(this.elevationInfo),i),s=(0,u.i)(S.rq.get(),t.x,t.y,r),o=S.rq.get();(0,Z.F)(s,t.spatialReference,o,i.spatialReference);const a=this._geometrySize;return(0,ee.DJ)(e,null,o,null,null,[a,a],[0,0,0,1])}}const je=De.CN,ke=[je/2,je/2,1-je/2,1-je/2],Fe=(0,d.vt)();var He=i(14905),Be=i(89769),Ge=i(48042);class Ve extends dt{constructor(t){super(t),this._maxSize=0,this._position=(0,d.vt)(),this._up=(0,d.vt)(),this._right=(0,d.vt)(),this._renderOccluded=ie.m$.OccludeAndTransparent,this._color=(0,X.fA)(1,0,0,1),this._outlineColor=(0,X.fA)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=ie.m$.Opaque,this.applyProperties(t)}createObject3DResourceFactory(t){return{view:t,createResources:t=>this._createObject3DResources(t),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(t){return{view:t,createResources:()=>this._createDrapedResources(),destroyResources:Ue}}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateQuadMaterial())}get color(){return this._color}set color(t){(0,Y.c)(this._color,t),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(t){(0,Y.c)(this._outlineColor,t),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(t){const e=0===this._outlineSize!=(0===t);this._outlineSize=t,e?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(t){t!==this._size&&(this._size=t,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(t){this._outlineRenderOccluded=t,this._updateOutlineMaterial()}set geometry({previous:t,center:e,next:i}){this._maxSize=Math.min((0,u.j)(e,t),(0,u.j)(e,i))/3,(0,u.n)(this._up,(0,u.d)(this._up,t,e)),(0,u.n)(this._right,(0,u.d)(this._right,i,e)),(0,u.c)(this._position,e),this.recreateGeometry()}_createObject3DResources(t){const e=new Ge.v(this._quadMaterialParameters),i=0===this._outlineSize?void 0:new re.W(this._outlineMaterialParameters);return this._createObject3DGeometries(t,e,i),{quadMaterial:e,outlineMaterial:i,forEach:t=>{t(e),i&&t(i)}}}_createObject3DGeometries(t,e,i){if((0,u.p)(this._up,d.uY)&&(0,u.p)(this._right,d.uY))return;const n=this._createGeometries(e,i);for(const e of n)t.addGeometry(e);this._updateTransformObject3D(t)}_createDrapedResources(){const t=new Ge.v(this._quadMaterialParameters),e=0===this._outlineSize?void 0:new re.W(this._outlineMaterialParameters),i=this._createGeometries(t,e).map((t=>new ne.$(t)));return this._setTransformDraped(i),{quadMaterial:t,outlineMaterial:e,geometries:i,pixelRatioHandle:(0,a.watch)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_createGeometries(t,e){const{up:i,right:n,corner:r}=this._getVertices(),s=function(t,e,i,n){return new Be.V(n,[[Pt.r.POSITION,new He.n([0,0,0,...e,...t,...i],[0,1,2,1,2,3],3,!0)]])}(i,n,r,t);return e?[s,(0,ee.Z8)(e,[i,r,n])]:[s]}_getVertices(){let t=this._up,e=this._right;const i=(0,u.g)(S.rq.get(),t,e);return this.isDraped&&(t=(0,u.c)(S.rq.get(),t),e=(0,u.c)(S.rq.get(),e),t[2]=0,e[2]=0,i[2]=0),{up:t,right:e,corner:i}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(t=this.object3dResources.object){if(!t)return;const e=this.view.state.camera,i=this._size*e.computeScreenPixelSizeAt(this._position),n=Math.min(this._maxSize,i);(0,Oe.kN)($e,this._position),(0,Oe.hs)($e,$e,[n,n,n]),t.transformation=$e}_setTransformDraped(t){if(0===t.length)return;const{view:{basemapTerrain:{overlayManager:e},state:{contentPixelRatio:i}}}=this,{_position:n,_size:r}=this,s=(0,u.c)(S.rq.get(),n);s[2]=te.bi;const o=We;o.spatialReference=e.renderer.spatialReference,o.x=s[0],o.y=s[1];const a=r*(this.view.overlayPixelSizeInMapUnits(o)*i),h=Math.min(this._maxSize,a);(0,Oe.kN)($e,s),(0,Oe.hs)($e,$e,[h,h,1]);for(const e of t)e.transformation=$e}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}function Ue(t){t.pixelRatioHandle.remove(),t.geometries=[]}const $e=(0,Re.vt)(),We=(0,ge.T)(0,0,void 0,null);var qe=i(28397),Ze=i(21267),Ye=i(34618),Xe=i(44425),Ke=i(21858),Je=i(64330);class Qe extends Ke.b{sortUniqueHints(t){return t.sort(((t,e)=>(e instanceof Je.c?e.length:0)-(t instanceof Je.c?t.length:0)))}visualizeIntersectionPoint(t,e){const{spatialReference:i,view:n}=e,r=ti(e);return(0,s.DQ)(new ze({view:n,primitive:"circle",geometry:(0,qe.io)(t.intersectionPoint,i),elevationInfo:t.isDraped?f.Tq:f.qt,size:20,outlineSize:2,color:r.intersectionPointColor,outlineColor:r.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(t,e){const{view:i,spatialReference:n}=e,r=ti(e),o=ei(t.point,t.domain,e);return(0,s.DQ)(new ze({view:i,primitive:"circle",geometry:(0,qe.io)(o,n),elevationInfo:ii(t),size:20,outlineSize:2,color:r.pointColor,outlineColor:r.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(t,e){const{view:i,spatialReference:n}=e,r=ti(e),o=ei(t.lineStart,t.domain,e),a=ei(t.lineEnd,t.domain,e);return(0,s.DQ)(function(t,e,i,n,r,s,o,a=!1,h=!0,l=!0){const c=ni(e,n,r,s,a),u=ni(i,n,r,s,a),d=new se({view:s,extensionType:ue.FADED,start:c,end:u,isDraped:a,color:o.lineColor,renderOccluded:a?ie.m$.OccludeAndTransparent:ie.m$.Opaque,renderGroup:it.O7.SnappingHint,isDecoration:!0});switch(t){case Xe.H3.TARGET:d.width=Ze.N.lineHintWidthTarget,d.fadedExtensions={start:0,end:Ze.N.lineHintFadedExtensions};break;case Xe.H3.REFERENCE_EXTENSION:d.width=Ze.N.lineHintWidthReference,d.fadedExtensions={start:0,end:0};break;case Xe.H3.REFERENCE:d.width=Ze.N.lineHintWidthReference,d.fadedExtensions={start:h?Ze.N.lineHintFadedExtensions:0,end:l?Ze.N.lineHintFadedExtensions:0}}return d.attached=!0,d}(t.type,o,a,n,ii(t),i,r,t.isDraped,t.fadeLeft,t.fadeRight))}visualizeParallelSign(t,e){const{view:i,spatialReference:n}=e,r=ti(e),{isDraped:o}=t,a=ii(t),h=ei(t.lineStart,t.domain,e),l=ei(t.lineEnd,t.domain,e),c=ni(h,n,a,i,o),d=ni(l,n,a,i,o),f=(0,u.m)(d,c,d,.5),p=new ve({view:i,attached:!1,offset:Ze.N.parallelLineHintOffset,length:Ze.N.parallelLineHintLength,width:Ze.N.parallelLineHintWidth,color:r.parallelSignColor,location:f,renderOccluded:o?ie.m$.OccludeAndTransparent:ie.m$.Opaque,isDraped:o,renderGroup:it.O7.SnappingHint,isDecoration:!0});return p.setDirectionFromPoints(c,f),p.attached=!0,(0,s.DQ)(p)}visualizeRightAngleQuad(t,e){const{view:i,spatialReference:n}=e,r=ti(e),o=ii(t),{isDraped:a}=t,h=ei(t.previousVertex,t.domain,e),l=ei(t.centerVertex,t.domain,e),c=ei(t.nextVertex,t.domain,e),u=ni(h,n,o,i,a),d=ni(l,n,o,i,a),f=ni(c,n,o,i,a);return(0,s.DQ)(new Ve({view:i,attached:!0,color:a?r.rightAngleColorDraped:r.rightAngleColor,renderOccluded:a?ie.m$.OccludeAndTransparent:ie.m$.Transparent,outlineRenderOccluded:a?ie.m$.OccludeAndTransparent:ie.m$.Opaque,outlineColor:r.rightAngleOutlineColor,outlineSize:Ze.N.rightAngleHintOutlineSize,size:Ze.N.rightAngleHintSize,isDraped:a,geometry:{previous:u,center:d,next:f},renderGroup:it.O7.SnappingHint,isDecoration:!0}))}}function ti(t){const{effectiveTheme:e}=t.view,i=m.A.toUnitRGBA(e.accentColor),n=[0,0,0,0];return{intersectionPointColor:n,intersectionPointOutlineColor:i,pointColor:n,pointOutlineColor:i,lineColor:i,lineOutlineColor:void 0,parallelSignColor:i,rightAngleColor:i,rightAngleColorDraped:m.A.toUnitRGBA((0,r._L)(e.accentColor,.5)),rightAngleOutlineColor:i}}function ei(t,e,{selfSnappingZ:i,view:n,spatialReference:r}){return e&Ye.n.SELF&&(0,qe.Ex)(t)&&null!=i?(0,qe.FH)(t,i,n,r):t}function ii(t){return t.isDraped?f.Tq:f.qt}function ni(t,e,i,n,r){const s=(0,d.vt)();if(r){const i=n.basemapTerrain.overlayManager.renderer.spatialReference;(0,Z.F)(t,e,s,i)}else(0,v.X)(t,e,i,n,s);return s}var ri=i(14921);function si(t){const e=t.graphic;return e?[(0,a.watch)((()=>"visible"in t?t.visible:t.displaying),(t=>{t&&e.notifyMeshTransformChanged({action:ri.$.EnableFastUpdates})}),{...a.pc}),(0,s.hA)((()=>e.notifyMeshTransformChanged({action:ri.$.DisableFastUpdates})))]:[]}var oi=i(20794);const ai=.3;function hi(t,e){e&&Object.assign(t,e)}class li{constructor(t){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=ie.m$.Opaque,this.color=t.accent}}class ci{constructor({colors:t,...e}){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=t.accent,this.outlineColor=t.outline,this.renderOccluded=ie.m$.Opaque,this.hoverOutlineColor=t.selectedOutline,hi(this,e)}applyColor(t){this._apply(this.color,t)}applyOutline(t){this._apply(this.outlineColor,t)}applyHoverOutline(t){this._apply(this.hoverOutlineColor,t)}_apply(t,e){e.setParameters({color:(0,r.QP)(t),renderOccluded:this.renderOccluded})}}class ui{constructor({colors:t,...e}){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=ie.m$.Transparent,this.minSquaredEdgeLength=900,this.color=(0,r._L)(t.accent,.5),this.hoverColor=t.accent,hi(this,e)}applyColor(t){this._apply(this.color,t)}applyHover(t){this._apply(this.hoverColor,t)}_apply(t,e){e.setParameters({color:(0,r.QP)(t),renderOccluded:this.renderOccluded})}}class di{constructor(t){this.vertex=new ci({colors:t,color:t.accent,outlineColor:t.outline}),this.edge=new ci({colors:t,color:(0,r.Vl)((0,r._L)(t.accent,2/3),.5),outlineColor:(0,r._L)(t.outline,.5),size:8,collisionPadding:8}),this.selected=new ci({colors:t,color:t.selected,outlineColor:t.outline}),this.edgeOffset=new ui({colors:t})}}class fi{constructor({colors:t,...e}){this.width=1.5,this.stipplePattern=(0,oi.wk)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=ie.m$.OccludeAndTransparent,this.color=t.selected,this.stippleOffColor=t.outline,this.innerColor=t.selected,hi(this,e)}apply(t){t.color=(0,r.QP)(this.color),t.width=this.width,t.stipplePattern=this.stipplePattern,t.stippleOffColor=(0,r.QP)(this.stippleOffColor),t.falloff=this.falloff,t.innerWidth=this.innerWidth,t.innerColor=(0,r.QP)(this.innerColor),t.renderOccluded=this.renderOccluded}}class pi{constructor({colors:t,...e}){this.size=4,this.outlineSize=1,this.shape="square",this.color=t.selected,this.outlineColor=t.outline,hi(this,e)}apply(t){t.color=(0,r.QP)(this.color),t.size=this.size,t.outlineSize=this.outlineSize,t.outlineColor=(0,r.QP)(this.outlineColor),t.primitive=this.shape}}class gi{constructor({colors:t,...e}){this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=ai,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=t.selected,this.glowColor=t.accent,this.heightFillColor=t.accent,hi(this,e)}apply(t,e=1){const i={glowColor:m.A.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:m.A.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in t?t.style=i:t.laserlineStyle=i}}class vi{constructor(t){this.outline=new fi({colors:t,color:t.stippleOff,renderOccluded:ie.m$.OccludeAndTransparentStencil,stippleOffColor:t.stippleOn,innerWidth:0}),this.staged=new fi({colors:t,color:t.stippleOn,renderOccluded:ie.m$.OccludeAndTransparentStencil,innerColor:t.stagedSolid,stippleOffColor:t.stippleOff}),this.shadowStyle=new gi({colors:t,globalAlpha:ai,glowColor:t.accent,glowFalloff:8,glowWidth:8,innerColor:t.selected,innerWidth:1})}}class mi{constructor(t){this.outline=new pi({colors:t,color:t.selected,outlineColor:t.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new gi({colors:t,globalAlpha:ai,glowColor:t.accent,glowFalloff:1.5,glowWidth:6,innerColor:t.selected,innerWidth:1,radius:2})}}class yi extends fi{constructor({colors:t,...e}){super({colors:t}),this.extensionType=ue.GROUND_RAY,hi(this,e)}}class _i{constructor(t){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineObjects=new vi(t),this.pointObjects=new mi(t),this.heightPlane=new gi({colors:t,globalAlpha:ai,glowColor:t.accent,glowFalloff:8,glowWidth:8,innerColor:t.selected,innerWidth:1}),this.heightBox=new gi({colors:t,globalAlpha:ai,glowColor:t.accent,glowFalloff:8,glowWidth:8,innerColor:t.selected,innerWidth:0,heightFillColor:t.accent}),this.zVerticalLine=new yi({colors:t,color:(0,r._L)(t.accent,.5),falloff:2,innerColor:(0,r._L)(t.selected,0),renderOccluded:ie.m$.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:ue.GROUND_RAY})}}let bi=class extends y.A{constructor(t){super(t)}get colors(){const t=this.getTheme().accentColor,e=t.a;return{accent:t,contrast:(0,r.bJ)(t),selected:m.A.fromArray([255,255,255,e]),selectedOutline:m.A.fromArray([255,255,255,e]),staged:m.A.fromArray([12,207,255,e]),stagedSolid:m.A.fromArray([12,207,255,1]),outline:m.A.fromArray([0,0,0,.5*e]),stippleOn:m.A.fromArray([255,255,255,1]),stippleOff:m.A.fromArray([0,0,0,.5])}}get visualElements(){return new _i(this.colors)}get manipulators(){return new di(this.colors)}get zManipulator(){return new li(this.colors)}};(0,n._)([(0,h.MZ)()],bi.prototype,"colors",null),(0,n._)([(0,h.MZ)()],bi.prototype,"visualElements",null),(0,n._)([(0,h.MZ)()],bi.prototype,"manipulators",null),(0,n._)([(0,h.MZ)()],bi.prototype,"zManipulator",null),(0,n._)([(0,h.MZ)()],bi.prototype,"getTheme",void 0),bi=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.settings")],bi);var wi=i(48996),xi=i(57617),Ti=i(79366),Ai=i(29800);class Mi extends dt{constructor(t){super(t),this._attachmentOrigin=(0,ge.T)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new wi.A,this._geometry=null,this._width=1,this._color=(0,X.fA)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,X.fA)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=ie.m$.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=t.view.spatialReference,this._laserline=new Jt({view:t.view,isDecoration:t.isDecoration}),this.applyProperties(t),this.attached=t.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(t){return{view:t,createResources:t=>this._createObject3DResources(t),destroyResources:Si,recreateGeometry:(t,e)=>{t.geometries.length=0,this._recreateGeometry(e,t.material,t.geometries)}}}createDrapedResourceFactory(t){return{view:t,createResources:()=>this._createDrapedResources(),destroyResources:Si,recreateGeometry:t=>{t.geometries=this._createRenderGeometriesDraped(t.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(t){this._laserline.attached=this._laserlineAttached,t&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this.recreateGeometry()}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get color(){return this._color}set color(t){(0,Y.a)(t,this._color)||((0,Y.c)(this._color,t),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(t){t!==this._innerWidth&&(this._innerWidth=t,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(t){(0,Y.a)(t,this._innerColor)||((0,Y.c)(this._innerColor,t),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const e=null!=t!=(null!=this._stipplePattern);this._stipplePattern=t,e?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(t){t&&this._stippleOffColor&&(0,Y.a)(t,this._stippleOffColor)||(this._stippleOffColor=t?(0,X.o8)(t):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(t){t!==this._falloff&&(this._falloff=t,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(t){this._laserlineStyle=t,this._laserline.attached=this._laserlineAttached,null!=t&&(this._laserline.style=t)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(t){this._laserlineEnabled!==t&&(this._laserlineEnabled=t,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const t=this.object3dResources.resources?.geometries;if(!t||0===t.length)return null;(0,u.i)(Ci,0,0,0);let e=0;for(const i of t)i.computeAttachmentOrigin(Ei)&&((0,u.g)(Ci,Ci,Ei),e++);return 0===e?null:((0,u.h)(Ci,Ci,1/e),this.view.renderCoordsHelper.fromRenderCoords(Ci,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){this.object3dResources.resources?.material.setParameters(this._materialParameters),this.drapedResources.resources?.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===ie.m$.OccludeAndTransparentStencil?ie.m$.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(t,e,i){this._createRenderGeometries(e,i);for(const e of i)t.addGeometry(e);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createObject3DResources(t){const e=new re.W(this._materialParameters),i=new Array;return this._recreateGeometry(t,e,i),{material:e,geometries:i,forEach:t=>{t(e),i.forEach(t)}}}_createDrapedResources(){const t=new re.W(this._materialParameters);return{material:t,geometries:this._createRenderGeometriesDraped(t)}}_createRenderGeometriesDraped(t){const{geometry:e,view:i}=this,n=i.basemapTerrain.spatialReference;return null==e||null==n?[]:(0,Ai.A)(e,n).lines.map((({position:e})=>{const r={overlayInfo:{spatialReference:n,renderCoordsHelper:i.renderCoordsHelper},attributeData:{position:e},removeDuplicateStartEnd:this._isClosed};return new ne.$((0,Ti.t)(t,r))}))}calculateMapBounds(t){if(null==this.object3dResources.resources)return!1;const e=this.view.renderCoordsHelper;for(const i of this.object3dResources.resources.geometries){const n=i.attributes.get(Pt.r.POSITION),r=(0,Mt.jh)(n.data.length);(0,xi.projectBuffer)(n.data,e.spatialReference,0,r,this.view.spatialReference,0),(0,Ce.Hq)(t,r)}return!0}_createRenderGeometries(t,e){const i=this.geometry;if(null==i)return;const n=(0,Ai.C)(i,this.view.elevationProvider,this.view.renderCoordsHelper,Ne.F.fromElevationInfo(this.elevationInfo??new p.A({mode:(0,f.w7)(i,null)}))),r=new Array;for(const{position:i,mapPositions:s}of n.lines){const n={mapPositions:s,attributeData:{position:i},removeDuplicateStartEnd:this._isClosed};e.push((0,Ti.t)(t,n)),r.push(i)}this._laserline.pathVerticalPlane=r}}function Si(t){t.geometries=[]}const Ei=(0,d.vt)(),Ci=(0,d.vt)();var Oi=i(92754),Ri=i(27264),Ii=i(28686),Pi=i(4875),Ni=i(45079),Di=i(29165),Li=i(90553),zi=i(93678),ji=i(54840),ki=i(46921),Fi=i(60593);class Hi extends _t.w{constructor(t,e,n){super(t,e,new yt.$(Fi.S,(()=>i.e(9586).then(i.bind(i,52609)))),n,Bi)}initializePipeline(t){const{oitPass:e,output:i,transparent:n,cullFace:r,shadingEnabled:s}=t,o=e===ji.Y.NONE,a=e===ji.Y.FrontFace;return(0,wt.Ey)({blending:i===Ri.V.Color&&n?(0,ki.Yf)(e):null,culling:(0,wt.Xt)(r),depthTest:{func:a?Tt.MT.LESS:s?Tt.MT.LEQUAL:Tt.MT.LESS},depthWrite:(0,ki.z5)(t),drawBuffers:(0,ki.m6)(e,i),colorWrite:wt.kn,polygonOffset:o||a?null:ki.SE})}}const Bi=new Map([[Pt.r.POSITION,0],[Pt.r.NORMAL,1],[Pt.r.OFFSET,2]]);var Gi=i(2457),Vi=i(38130),Ui=i(22095);class $i extends Ui.E{constructor(){super(...arguments),this.cullFace=Zt.s2.None,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=Gi.I.None,this.emissionSource=Vi.ZX.None,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}get discardInvisibleFragments(){return this.transparent}}(0,n._)([(0,$t.W)({count:Zt.s2.COUNT})],$i.prototype,"cullFace",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"hasSlicePlane",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"transparent",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"writeDepth",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"screenSizeEnabled",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"shadingEnabled",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"terrainDepthTest",void 0),(0,n._)([(0,$t.W)()],$i.prototype,"cullAboveTerrain",void 0);class Wi extends ie.im{constructor(t){super(t,Zi),this._configuration=new $i,this.vertexAttributeLocations=Bi,this.supportsEdges=!0,this.produces=new Map([[Di.N.OPAQUE_MATERIAL,t=>t===Ri.V.Highlight||(0,Ri.zW)(t)&&!this.parameters.transparent],[Di.N.TRANSPARENT_MATERIAL,t=>(0,Ri.zW)(t)&&this.parameters.transparent&&this.parameters.writeDepth],[Di.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>(0,Ri.zW)(t)&&this.parameters.transparent&&!this.parameters.writeDepth]])}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.oitPass=e.oitPass,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration}get visible(){return this.parameters.color[3]>=Ii.Q}intersect(t,e,i,n,r,s){if(this.parameters.screenSizeEnabled){const e=t.attributes.get(Pt.r.OFFSET),o={applyToVertex:(t,n,r,s)=>{const o=(0,u.i)(Xi,e.data[3*s],e.data[3*s+1],e.data[3*s+2]),a=(0,u.i)(Ki,t,n,r);return(0,u.h)(o,o,this.parameters.screenSizeScale*i.camera.computeScreenPixelSizeAt(o)),(0,u.g)(a,a,o),[a[0],a[1],a[2]]},applyToAabb:t=>{const e=(0,Ce.gX)(t,Xi);return(0,Ce.hs)(t,this.parameters.screenSizeScale*i.camera.computeScreenPixelSizeAt(e))}};(0,Ni.Uy)(t,i,n,r,o,s)}else(0,Ni.Uy)(t,i,n,r,void 0,s)}createGLMaterial(t){return new qi(t)}createBufferWriter(){return new Yi(this.parameters.screenSizeEnabled)}}class qi extends Pi.A{beginSlot(t){return this.acquireTechnique(Hi,t)}}class Zi extends ie.qA{constructor(){super(...arguments),this.color=(0,X.fA)(1,1,1,1),this.shadingTint=(0,X.fA)(0,0,0,.25),this.shadingDirection=(0,u.n)((0,d.vt)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=Zt.s2.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}get transparent(){return this.color[3]<1||this.forceTransparentMode}}class Yi{constructor(t){this.screenSizeEnabled=t;const e=(0,Et.BP)().vec3f(Pt.r.POSITION).vec3f(Pt.r.NORMAL);this.screenSizeEnabled&&e.vec3f(Pt.r.OFFSET),this.vertexBufferLayout=e}elementCount(t){return t.get(Pt.r.POSITION).indices.length}write(t,e,i,n,r,s){if((0,zi.SA)(i,n,this.vertexBufferLayout,t,e,r,s),this.screenSizeEnabled){if(!i.has(Pt.r.OFFSET))throw new Error(`${Pt.r.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const t=i.get(Pt.r.OFFSET);(0,Li.vA)(3===t.size);const n=r.getField(Pt.r.OFFSET,Oi.xs);if(!n)throw new Error("unable to acquire view for "+Pt.r.OFFSET);(0,zi.Hk)(t,e,n,s)}}}}const Xi=(0,d.vt)(),Ki=(0,d.vt)();class Ji extends Ie{constructor(t){super(t),this.view=null,this._renderOccluded=ie.m$.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=(0,X.ci)([1,127/255,0,1]),this._size=11,this._outlineColor=(0,X.ci)([0,0,0,.5]),this._outlineSize=1,this._elevationInfo=null,this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(t){this._vertices=t,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(t){this._spatialReference=t,this.recreateGeometry()}get color(){return this._color}set color(t){(0,Y.a)(t,this._color)||((0,Y.c)(this._color,t),this._updateMaterial())}get size(){return this._size}set size(t){t!==this._size&&(this._size=t,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(t){(0,Y.a)(t,this._outlineColor)||((0,Y.c)(this._outlineColor,t),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(t){t!==this._outlineSize&&(this._outlineSize=t,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const t=this.vertices;if(null==t||0===t.length)return[];const e=function(t,e,i,n,r){const s=(0,Mt.jh)(3*t.length),o=(0,Mt.jh)(s.length);t.forEach(((t,e)=>{s[3*e]=t[0],s[3*e+1]=t[1],s[3*e+2]=t.length>2?t[2]:0}));const a=(0,Pe.au)(s,e,0,o,0,s,0,s.length/3,i,n,r),h=null!=a;return{numVertices:t.length,position:s,mapPositions:o,projectionSuccess:h,sampledElevation:a}}(t,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,Ne.F.fromElevationInfo(this.elevationInfo)),i=[],n=e.numVertices,r=e.position;for(let t=0;t<n;++t){const e=(0,u.i)(Qi,r[3*t],r[3*t+1],r[3*t+2]),n=tn(this._vertexMaterial,.5,e),s=tn(this._vertexOutlineMaterial,.5,e);i.push({vertexGeometry:n,vertexOutlineGeometry:s})}return i}createGeometries(t){const e=this._createRenderGeometries();for(const{vertexGeometry:i,vertexOutlineGeometry:n}of e)t.addGeometry(i),t.addGeometry(n)}createExternalResources(){this._vertexMaterial=new Wi({...this._vertexMaterialParameters,writeDepth:!0,cullFace:Zt.s2.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new Wi({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:Zt.s2.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(t){t(this._vertexMaterial),t(this._vertexOutlineMaterial)}}const Qi=(0,d.vt)();function tn(t,e,i){return(0,ee.CM)(t,e,16,16,{offset:i})}let en=class extends wi.A.EventedAccessor{constructor(t){super(t),this.tracking=!1,this.displaying=!1,this.error=null,this.isDraped=!1}};(0,n._)([(0,h.MZ)({constructOnly:!0})],en.prototype,"graphic",void 0),(0,n._)([(0,h.MZ)()],en.prototype,"tracking",void 0),(0,n._)([(0,h.MZ)()],en.prototype,"displaying",void 0),(0,n._)([(0,h.MZ)()],en.prototype,"error",void 0),(0,n._)([(0,h.MZ)()],en.prototype,"isDraped",void 0),en=(0,n._)([(0,c.$)("esri.views.3d.layers.graphics.GraphicState")],en);var nn=i(93336),rn=i(85499),sn=i(99113),on=i(24148),an=i(25638);let hn=class extends nn.N{constructor(t){super(t),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this._verticalLineVisualElement=null,this._settings=new bi({getTheme:()=>this.view.effectiveTheme}),this.geometryType=null,this.type="draw-3d"}initialize(){const{mode:t,offset:e,unit:i}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new p.A({mode:t,offset:e,unit:i})}normalizeCtorArgs(t){if(!t.elevationInfo){const e=t.hasZ??!0;return{...t,elevationInfo:(0,f.bK)(e)}}return t}initializeGraphic(t){const{view:e}=this,i=this._createGraphicState=new en({graphic:t});return(0,s.vE)([e.maskOccludee(t),e.trackGraphicState(i),(0,a.watch)((()=>({element:this._outlineVisualElement,isDraped:i.isDraped})),(({element:t,isDraped:e})=>{t&&(t.isDraped=e)}),a.pc),(0,an.fm)((()=>{(0,on.IA)(this.tooltipInfos.mesh,this.geometryToPlace)})),this._setupLoadingIndicator(i),...si(i)])}makeDrawOperation(){const{geometryType:t}=this,e="circle"!==t&&"rectangle"!==t;return new rn.O0({view:this.view,manipulators:this.manipulators,geometryType:(0,nn.l)(t),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new sn.IX(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new sn.rT(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new Qe,segmentLabels:e?new W:null,labelOptions:this.sketchOptions.labels,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,f.wF)(this.hasZ,this.elevationInfo),cursor:this.cursor,constraintsEnabled:!0})}onActiveVertexChanged(t){const{view:e}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=[t],this._activeVertexVisualElement.recreate(),this._updateVerticalLineVisualElement(t),(0,s.hA)();const i=this._settings,n=i.manipulators.vertex,h=new Ji({view:e,spatialReference:e.spatialReference,vertices:[t],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:n.size,outlineSize:n.outlineSize,renderOccluded:n.renderOccluded,attached:!1,isDecoration:!0});this._activeVertexVisualElement=h;const l=i.visualElements.zVerticalLine,c=new se({view:e,extensionType:l.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0});this._verticalLineVisualElement=c;const u=(0,s.vE)([(0,a.watch)((()=>i.visualElements.zVerticalLine),(t=>t.apply(c)),a.Vh),(0,a.watch)((()=>({selectedColor:(0,r.QP)(i.colors.selected),outlineColor:(0,r.QP)(i.manipulators.vertex.outlineColor)})),(({selectedColor:t,outlineColor:e})=>{h.color=t,h.outlineColor=e}),a.Vh),(0,s.hA)((()=>{this._activeVertexVisualElement=(0,o.pR)(this._activeVertexVisualElement),this._verticalLineVisualElement=(0,o.pR)(this._verticalLineVisualElement)}))]);return h.attached=!0,this._updateVerticalLineVisualElement(t),u}_updateVerticalLineVisualElement(t){const e=this._verticalLineVisualElement;if(!e)return;const{renderCoordsHelper:i,elevationProvider:n}=this.view;(0,u.i)(cn,t[0],t[1],t[2]),ln.setFromElevationInfo(this.elevationInfo),cn[2]=(0,Pe.nG)(cn,n,ln,i),i.toRenderCoords(cn,this.view.spatialReference,cn)?(e.setStartEndFromWorldDownAtLocation(cn),e.attached=!0):e.attached=!1}onOutlineChanged(t){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=t,(0,s.hA)();const e=this.internalGraphicsLayer.elevationInfo,{view:i}=this,n=this._settings,r=new Mi({view:i,geometry:t,elevationInfo:e,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,f.wF)(this.hasZ,e),attached:!1,isDecoration:!0});this._outlineVisualElement=r;const h=(0,s.vE)([(0,a.watch)((()=>n.visualElements.lineObjects.outline),(t=>t.apply(r)),a.Vh),(0,a.watch)((()=>n.visualElements.lineObjects.shadowStyle),(t=>t.apply(r)),a.Vh),(0,s.hA)((()=>{this._outlineVisualElement=(0,o.pR)(this._outlineVisualElement)}))]);return r.attached=!0,r.laserlineEnabled=!0,h}onRegularVerticesChanged(t){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=t,(0,s.hA)();const{view:e}=this,i=this._settings,n=i.manipulators.vertex,h=new Ji({view:e,spatialReference:e.spatialReference,vertices:t,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:n.size,outlineSize:n.outlineSize,renderOccluded:n.renderOccluded,attached:!1,isDecoration:!0}),l=(0,s.vE)([(0,a.watch)((()=>({color:(0,r.QP)(i.manipulators.vertex.color),outlineColor:(0,r.QP)(i.manipulators.vertex.outlineColor)})),(({color:t,outlineColor:e})=>{h.color=t,h.outlineColor=e}),a.Vh),(0,s.hA)((()=>{this._verticesVisualElement=(0,o.pR)(this._verticesVisualElement)}))]);return h.attached=!0,this._verticesVisualElement=h,l}updateGraphicGeometry(t){if("mesh"!==this.geometryType||"point"!==t?.type)super.updateGraphicGeometry(t);else{const e=this.geometryToPlace;e?.centerAt(t),(0,on.IA)(this.tooltipInfos.mesh,e);const i=this._graphic;e&&i.geometry===e||(i.geometry=e)}}_setupLoadingIndicator(t){const{drawOperation:e}=this;if(!this.geometryToPlace)return e.loading=!1,null;e.loading=!0;const i=(0,s.hA)((()=>{e.loading=!1}));let n;const r=()=>n&&cancelAnimationFrame(n);return(0,s.vE)([(0,a.when)((()=>t.displaying),(()=>{r(),n=requestAnimationFrame((()=>i.remove()))}),{...a.pc,once:!0}),(0,s.hA)(r),i])}};(0,n._)([(0,h.MZ)({constructOnly:!0})],hn.prototype,"elevationInfo",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],hn.prototype,"geometryType",void 0),(0,n._)([(0,h.MZ)()],hn.prototype,"type",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],hn.prototype,"view",void 0),hn=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],hn);const ln=new Ne.F,cn=(0,d.vt)();var un=i(50659),dn=i(78879),fn=i(56275),pn=i(20248),gn=i(8527);function vn(t){if(null==t||"polyline"!==t.type&&"polygon"!==t.type)return 0;const e="polyline"===t.type?t.paths:t.rings,i=(0,gn.FD)();for(const t of e)for(let e=0;e<t.length-1;e++){const n=t[e],r=t[e+1],s=n[0]-r[0],o=n[1]-r[1];if(s*s+o*o>i)return Math.atan2(r[1]-n[1],r[0]-n[0])}return 0}var mn=i(71851);function yn(t){return t?.operations?.data.geometry}function _n(t,e){return function(t,e){return!!t&&"on-the-ground"!==e.mode&&!(0,f.v9)(e)}(t?.data.coordinateHelper.hasZ(),e)}var bn=i(34358),wn=i(46517);function xn(t,e,i){function n(){const t=i(),e=t.sketchOptions.tooltips.effectiveEnabled?t.activeTooltipInfo:null;return{...t,activeTooltipInfo:e}}let r=!1;function o(t){r||(r=!0,t(),r=!1)}function h({activeTooltipInfo:i,sketchOptions:n,scaleRotateTransform:r}){o((()=>{i&&(i.sketchOptions=n,Mn(i,e),function(t,e){if("transform-point"!==t?.type)return;if(!e)return t.orientation.actual=void 0,t.size.actual=void 0,t.orientation.visible=!1,void(t.size.visible=!1);const i=e.mode,{size:n,orientationClockwise:r}=e.adapter,{visualVariables:s}=t.sketchOptions.tooltips,o=s?.rotation,a=null!=r&&(null==i||"rotate"===i),h=o?.rotationType??"geographic";t.orientation.actual=a?(0,fn.Wq)(r,"radians",h):void 0,t.orientation.precision=En(o?.valueType),t.orientation.visible=a;const l=s?.size,c=null!=n&&(null==i||"scale"===i);t.size.actual=c?(0,fn.d_)(n,l?.unit??"meters"):void 0,t.size.precision=En(l?.valueType),t.size.visible=c}(i,r)),t.info=i}))}return(0,s.vE)([(0,a.watch)(n,h,a.pc),(0,a.watch)((()=>{const t=n(),{activeTooltipInfo:i}=t;if(i)return{context:t,activeTooltipInfo:i,key:i.key,geometry:yn(e)}}),((t,i)=>{t&&i&&i.key!==t.key&&o((()=>Tn(e,t.context)))}),a.OH),e.on("committed",(()=>{queueMicrotask((()=>h(n())))})),(0,on.sZ)(t,{onBeforePaste:()=>{r=!0},onAfterPaste:()=>{Tn(e,n()),r=!1}})])}function Tn(t,{activeTooltipInfo:e,callbacks:i}){if(!e)return;i.onBeforeUpdate();const n=yn(t);switch(n?.type){case"mesh":An(e,n.origin,t,i),"orientation"in e&&"scale"in e&&(0,on.IA)(e,n,i);break;case"point":An(e,n,t,i)}}function An(t,e,i,n){const{dx:r,dy:s,dz:o}=(0,on.mu)(t,e);0===r&&0===s&&0===o||(n.onMoveStart(),i.operations?.move(r,s,o,bn.Y.NEW_STEP),n.onMove(r,s,o),n.onMoveStop())}function Mn(t,e){const i=yn(e),n=i?.type;if(!t||!i||"mesh"!==n&&"point"!==n)return;const r="mesh"===n,s=r?i.origin:i;t.setLocationFromPoint(s),Sn(t,s,e),"transform-mesh"===t.type&&r&&(0,on.Ue)(t,i),t.clearInputValues()}function Sn(t,e,i){t.elevation.actual=(0,wn.Of)(e),t.elevation.visible=!!i.operations?.data.coordinateHelper.hasZ(),t.elevation.readOnly=!1,t.elevation.showAsZ=!0}function En(t){switch(t){case"integer":case"long":return 0;default:return null}}var Cn=i(85445),On=(i(50917),i(44705)),Rn=i(87725),In=i(61714),Pn=i(46157),Nn=i(46098),Dn=i(61441),Ln=i(87416),zn=i(5596),jn=i(45328),kn=i(60516);function Fn(t,e,i=(0,tt.vt)()){return Hn(t,(0,g.WA)(e),i),(0,u.n)(i.direction,i.direction),i}function Hn(t,e,i){return function(t,e,i){const n=(0,g.sc)((0,T.C)(S.rq.get(),e));if(n[2]=0,!t.unprojectFromRenderScreen(n,i.origin))return null;const r=(0,g.sc)((0,T.C)(S.rq.get(),e));r[2]=1;const s=t.unprojectFromRenderScreen(r,S.rq.get());return null==s?null:((0,u.d)(i.direction,s,i.origin),i)}(t,t.screenToRender(e,(0,g.sc)(S.rq.get())),i)}var Bn=i(65631),Gn=i(53551),Vn=i(45532);class Un{constructor(t){this.metadata=void 0,this._camera=new Bn.A,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,Re.vt)(),this._worldFrame=null,this._renderLocation=(0,d.vt)(),this._renderLocationDirty=!0,this._location=new Vn.default({x:0,y:0,z:0}),this._elevationAlignedLocation=new Vn.default,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.consumesClicks=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=Gn.SJ.None,this._focused=!1,this.events=new wi.A.EventEmitter,this._screenLocation={screenPointArray:(0,g.gs)(),renderScreenPointArray:(0,g.r_)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=t.view.spatialReference,Object.assign(this,t);const e=this.view.state?.camera;e&&this._camera.copyFrom(e)}destroy(){this._applyObjectTransform=or,this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(t){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=t.slice(),this._updateEngineObject()}set available(t){t!==this._available&&(this._available=t,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),(0,s.hA)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}set radius(t){t!==this._radius&&(this._radius=t,this._updateEngineObject())}get radius(){return this._radius}set worldSized(t){t!==this._worldSized&&(this._worldSized=t,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(t){$n(t)&&(this._screenLocationDirty=!0),(0,Oe.C)(this._modelTransform,t),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,Re.vt)()),function(t,e,i){switch(t.viewingMode){case"local":return(0,Oe.D_)(i),!0;case"global":{const n=(0,In.tO)(t.renderCoordsHelper.spatialReference);(0,Dn.n4)(e,0,Qn,0,n.radius),(0,Nn.z)((0,b.kU)(Qn[0]),(0,b.kU)(Qn[1]),i)}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(t){this.view.renderCoordsHelper.fromRenderCoords(t,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(t){(0,jn.EL)(t,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(t){(0,jn.EL)(t,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const t=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=t+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,jn.RS)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(t){t!==this._grabbing&&(this._grabbing=t,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(t){t!==this._hovering&&(this._hovering=t,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(t){t!==this._selected&&(this._selected=t,this._updateEngineObject(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get state(){return this._state}set state(t){t!==this._state&&(this._state=t,this._updateEngineObject())}updateStateEnabled(t,e){e?this.state|=t:this.state&=~t}_setFocused(t){t!==this._focused&&(this._focused=t,this.events.emit("focus-changed",{action:!0===t?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let t;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,$n(this._modelTransform)){const e=this._calculateModelTransformOffset(rr);t=(0,u.g)(e,e,this.renderLocation)}else t=this.renderLocation;this._camera.projectToRenderScreen(t,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(t){this._applyObjectTransform=t,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(t,e){if(!this.available)return null;const i=(0,g.WA)(t,Wn),n=this._getCollisionRadius(e),r=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,T.hG)(this.screenLocation.screenPointArray,i)<n*n)return this.screenLocation.renderScreenPointArray[2]+r;break;case"line":{const t=this.collisionType.paths,e=this._getWorldToScreenObjectScale(),s=this._calculateObjectTransform(e,Kn),o=n*this.screenLocation.pixelSize,a=Hn(this._camera,i,Zn);if(null==a)return null;for(const e of t){if(0===e.length)continue;const t=(0,u.t)(Qn,e[0],s);for(let i=1;i<e.length;i++){const n=(0,u.t)(tr,e[i],s),h=(0,Q.dz)((0,Q.Cr)(t,n,qn),a);if(null!=h&&h<o*o){const e=(0,u.g)(S.rq.get(),t,n);(0,u.h)(e,e,.5);const i=(0,g.rX)(S.rq.get());return this._camera.projectToRenderScreen(e,i),i[2]+r}(0,u.c)(t,n)}}break}case"disc":{const t=this.collisionType.direction,e=this.collisionType.offset??d.uY,s=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(s,Kn),a=n*this.screenLocation.pixelSize,h=Hn(this._camera,i,Zn);if(null==h)return null;const l=(0,On.z0)(Yn,o),c=(0,u.q)(ir,t,l),f=(0,u.t)(nr,e,o);(0,zn.O_)(f,c,Jn);const p=er;if((0,zn.Ui)(Jn,h,p)&&(0,u.s)(p,f)<a*a)return this.screenLocation.renderScreenPointArray[2]+r;break}case"ribbon":{const{paths:t,direction:e}=this.collisionType,s=this._getWorldToScreenObjectScale(),o=this._calculateObjectTransform(s,Kn),a=n*this._camera.computeScreenPixelSizeAt(this.renderLocation),h=Hn(this._camera,i,Zn);if(null==h)return null;const l=(0,On.z0)(Yn,o),c=(0,u.q)(ir,e,l),d=this._calculateModelTransformPosition(nr);(0,zn.O_)(d,c,Jn);const f=er;if(!(0,zn.Ui)(Jn,h,f))break;for(const e of t){if(0===e.length)continue;const t=(0,u.t)(Qn,e[0],o);for(let i=1;i<e.length;i++){const n=(0,u.t)(tr,e[i],o),s=(0,Q.kb)((0,Q.Cr)(t,n,qn),f);if(null!=s&&s<a*a){const e=(0,u.g)(S.rq.get(),t,n);(0,u.h)(e,e,.5);const i=(0,g.rX)(S.rq.get());return this._camera.projectToRenderScreen(e,i),i[2]+r}(0,u.c)(t,n)}}break}default:(0,mt.Xb)(this.collisionType)}return null}attach(t={manipulator3D:{}}){const e=this._stage;if(!e)return;const i=t.manipulator3D;null==i.engineLayerId?(this._engineLayer=new ct.x(e,{pickable:!1,updatePolicy:rt.q.SYNC}),i.engineLayerId=this._engineLayer.id):e?.getObject&&(this._engineLayer=e.getObject(i.engineLayerId)),i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,Pn.canProjectWithoutEngine)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Vn.default({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(t={manipulator3D:{}}){const e=t.manipulator3D;e.engineLayerReferences--;const i=0===e.engineLayerReferences;this._removeResourcesFromStage(),i&&(e.engineLayerId=null,(0,o.pR)(this._engineLayer)),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(t){(0,Pn.projectPoint)(this.location,sr,t.spatialReference)&&(0,Ln.vR)(t.extent,sr)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null==this.elevationInfo)return;let t=null,e=0;const i=(0,f.Ze)(this.elevationInfo,this.location.spatialReference??this.view.elevationProvider.spatialReference);switch(this.elevationInfo.mode){case"on-the-ground":t=(0,kn.R1)(this.view.elevationProvider,this.location,"ground")??0;break;case"relative-to-ground":e=((0,kn.R1)(this.view.elevationProvider,this.location,"ground")??0)+i;break;case"relative-to-scene":e=((0,kn.R1)(this.view.elevationProvider,this.location,"scene")??0)+i;break;case"absolute-height":e=i}return e!==this._elevation.offset||t!==this._elevation.override?(this._elevation.offset=e,void(this._elevation.override=t)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const t=this._getWorldToScreenObjectScale(),e=Kn;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*t;this._calculateObjectTransform(i,e)}else this._calculateObjectTransform(t,e);const{objectsByState:i}=this._ensureEngineResources(),n=(this.focused?Gn.p7.Focused:Gn.p7.Unfocused)|(this.selected?Gn.p7.Selected:Gn.p7.Unselected),r=this._noDisplayCount>0;for(const{stateMask:t,objects:s}of i){if(r){for(const t of s)t.visible=!1;continue}const i=(t&Gn.p7.All)!==Gn.p7.None,o=(t&Gn.SJ.All)!==Gn.SJ.None,a=!i||(n&t)==(t&Gn.p7.All),h=!o||(this.state&t)==(t&Gn.SJ.All);if(a&&h)for(const t of s)t.visible=!0,t.transformation=e;else for(const t of s)t.visible=!1}}_ensureEngineResources(){if(null==this._engineResources){const t=this._engineLayer,e=[],i=new Set;this.renderObjects.forEach((({geometry:{material:t}})=>{i.has(t)||(e.push(t),i.add(t))}));const n=new Map;this._renderObjects.forEach((t=>{const e=new lt.B({castShadow:!1,geometries:[t.geometry]}),i=n.get(t.stateMask)||[];i.push(e),n.set(t.stateMask,i)}));const r=[];n.forEach(((t,e)=>r.push({stateMask:e,objects:t}))),this._engineResources={objectsByState:r,layer:t,materials:e}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const t=this._stage;if(this._engineResourcesAddedToStage||null==this._engineResources||!t)return;const{objectsByState:e,layer:i,materials:n}=this._engineResources;n.forEach((e=>{const i=this._materialIdReferences,n=i.get(e.id)||0;0===n&&t.add(e),i.set(e.id,n+1)})),e.forEach((({objects:e})=>{i.addMany(e),t.addMany(e)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(){const t=this._stage;if(!this._engineResourcesAddedToStage||null==this._engineResources||!t)return;const{objectsByState:e,layer:i,materials:n}=this._engineResources;e.forEach((({objects:e})=>{i.removeMany(e),t.removeMany(e)})),n.forEach((e=>{const i=this._materialIdReferences,n=i.get(e.id);1===n?(t.remove(e),i.delete(e.id)):i.set(e.id,n-1)})),this._engineResourcesAddedToStage=!1}_getCollisionRadius(t){return this._getFocusedSize(this.radius,!0)*("touch"===t?this.touchMultiplier:1)}_getFocusedSize(t,e){return t*(e?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(t){const e=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(e,Xn);return(0,u.i)(t,i[12],i[13],i[14])}_calculateModelTransformOffset(t){const e=this._calculateModelTransformPosition(t);return(0,u.d)(t,e,this.renderLocation)}_calculateObjectTransform(t,e){return(0,Oe.hZ)(e,t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1),this._worldFrame&&(0,Oe.lw)(e,e,this._worldFrame),(0,Oe.lw)(e,e,this._modelTransform),e[12]+=this.renderLocation[0],e[13]+=this.renderLocation[1],e[14]+=this.renderLocation[2],e[15]=1,null!=this._applyObjectTransform&&this._applyObjectTransform(e),e}get test(){}}function $n(t){return 0!==t[12]||0!==t[13]||0!==t[14]}const Wn=(0,g.gs)(),qn=(0,Q.vt)(),Zn=(0,tt.vt)(),Yn=(0,Rn.vt)(),Xn=(0,Re.vt)(),Kn=(0,Re.vt)(),Jn=(0,zn.vt)(),Qn=(0,d.vt)(),tr=(0,d.vt)(),er=(0,d.vt)(),ir=(0,d.vt)(),nr=(0,d.vt)(),rr=(0,d.vt)(),sr=new Vn.default({x:0,y:0,z:0,spatialReference:null}),or=()=>{};var ar,hr,lr,cr;(cr=ar||(ar={}))[cr.NONE=0]="NONE",cr[cr.ANY=1]="ANY",cr[cr.Z=2]="Z",cr[cr.XY=4]="XY",(lr=hr||(hr={}))[lr.TRANSLATE_Z=0]="TRANSLATE_Z",lr[lr.TRANSLATE_XY=1]="TRANSLATE_XY",lr[lr.SCALE=2]="SCALE",lr[lr.ROTATE=3]="ROTATE",lr[lr.SCALE_ROTATE=4]="SCALE_ROTATE";class ur{constructor(){this.grabbingState=ar.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}update(t){this.grabbingState=ar.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,t.forEachManipulator(((t,e)=>{if(e===hr.TRANSLATE_Z&&(this.zManipulator=t),t instanceof Un&&(t.selected&&(0===this.numSelected&&(this.firstSelected=t),this.numSelected++),null==this.firstGrabbedXY&&t.grabbing&&e===hr.TRANSLATE_XY&&(this.firstGrabbedXY=t)),t.grabbing)switch(this.grabbingState|=ar.ANY,e){case hr.TRANSLATE_Z:this.grabbingState|=ar.Z;break;case hr.TRANSLATE_XY:this.grabbingState|=ar.XY}}))}}function dr(t,e){const{object:i,view:n}=t,r=[],o=i.elevationInfo,h="on-the-ground"===o.mode||!o.offset&&"absolute-height"!==o.mode,l=new ur,c=new bi({getTheme:()=>n.effectiveTheme}),d=c.visualElements,f=new se({view:n,extensionType:d.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0}),p=(0,b.kU)(d.heightPlaneAngleCutoff),g=new Jt({view:n,attached:!1,angleCutoff:p,isDecoration:!0}),v=(0,Cn.v)(1);r.push((0,a.watch)((()=>({lineShadowStyle:c.visualElements.lineObjects.shadowStyle,pointShadowStyle:c.visualElements.pointObjects.shadowStyle,alpha:v.value})),(({lineShadowStyle:t,pointShadowStyle:i,alpha:n})=>{t.apply(e,n),i.apply(f,n)}),a.Vh));const m=(0,Cn.v)(1);r.push((0,a.watch)((()=>({heightPlane:c.visualElements.heightPlane,alpha:m.value})),(({heightPlane:t,alpha:e})=>t.apply(g,e)),a.Vh));const y=()=>{l.update(t);const n=yn(i);if(!i.visible||h&&(i.isDraped||!fr(n)||!n.hasZ))return e.laserlineEnabled=!1,f.attached=!1,void(g.attached=!1);e.laserlineEnabled=!0;const r=l.grabbingState&ar.XY?d.laserlineAlphaMultiplier:1;v.value=r;const s=l.grabbingState&ar.Z?d.laserlineAlphaMultiplier:1;m.value=s,function(t,e){const i=1===e.numSelected?e.firstSelected:e.numSelected>1&&null!=e.firstGrabbedXY?e.firstGrabbedXY:null;null!=i?(t.setStartEndFromWorldDownAtLocation(i.renderLocation),t.attached=!0):t.attached=!1}(f,l),function(t,e,i,n){if(n.numSelected>0){(0,u.i)(pr,0,0,0);let e=0;t.forEachManipulator(((t,i)=>{i===hr.TRANSLATE_XY&&t.selected&&t instanceof Un&&((0,u.g)(pr,pr,t.renderLocation),e++)})),e>0?(i.heightManifoldTarget=(0,u.h)(pr,pr,1/e),i.attached=!0):i.attached=!1}else{const n=e.attachmentOrigin;null!=n&&t.view.renderCoordsHelper.toRenderCoords(n,pr)?(i.heightManifoldTarget=pr,i.attached=!0):i.attached=!1}}(t,e,g,l)};r.push((0,a.watch)((()=>c.visualElements.zVerticalLine),(t=>t.apply(f)),a.Vh)),r.push(i.on("committed",y),(0,a.watch)((()=>i.visible),y),e.events.on("attachment-origin-changed",y),(0,s.DQ)(f),(0,s.DQ)(g));const _=[],w=()=>{(0,s.a0)(_),_.length=0,t.forEachManipulator((t=>_.push(t.events.on("grab-changed",y)))),t.forEachManipulator((t=>_.push(t.events.on("select-changed",y)))),y()};return w(),r.push(t.onManipulatorsChanged(w),(0,s.a2)((()=>(0,s.vE)(_)))),(0,s.vE)(r)}function fr(t){return null!=t&&("polygon"===t.type||"polyline"===t.type)}const pr=(0,d.vt)();var gr=i(56763);function vr(t){const e=[],i=function(t,e){const{view:i,object:n}=t,r=new ze({view:i,geometry:mr(yn(n)),elevationInfo:n.elevationInfo,isDecoration:!0});return function(t,e,i){const{view:n,object:r}=t,o=new bi({getTheme:()=>n.effectiveTheme});(function(t,e,i){const{view:n,object:r}=t;let o=null;const a=()=>{const t=mr(yn(r));null!=t&&(0,f.x)(r.elevationInfo)&&(t.z=0),(t=>{null!=o&&(o.remove(),o=null),r.isDraped&&null!=t&&(o=function(t,e,i){const n=t.elevationProvider.spatialReference;(0,gr.g)(e,yr,n);const r=yr[0],s=yr[1];return t.elevationProvider.on("elevation-change",(t=>{(0,Ln.Rj)(t.extent,r,s)&&i()}))}(n,t,(()=>{e.geometry=t})))})(t),e.geometry=t};i.push(r.on("committed",a),(0,s.a2)((()=>o))),a()})(t,e,i),o.visualElements.pointObjects.outline.apply(e),i.push((0,a.watch)((()=>r.visible),(()=>{e.attached=r.visible}),a.Vh))}(t,r,e),e.push((0,s.DQ)(r)),r}(t,e);return function(t,e,i){const{view:n,object:r}=t,o=new bi({getTheme:()=>n.effectiveTheme}),h=new se({view:n,extensionType:o.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0});e.push((0,a.watch)((()=>o.visualElements.zVerticalLine),(t=>t.apply(h)),a.Vh));const l=new Jt({view:n,intersectsLineInfinite:!0,attached:!1,isDecoration:!0}),c=(0,b.kU)(o.visualElements.heightPlaneAngleCutoff),d=new Jt({view:n,attached:!1,angleCutoff:c,isDecoration:!0}),p=r.elevationInfo,g=Ne.F.fromElevationInfo(p),v="on-the-ground"===p.mode||!p.offset&&"absolute-height"!==p.mode,m=new ur,y=(0,Cn.v)(1);e.push((0,a.watch)((()=>({heightPlane:o.visualElements.heightPlane,alpha:y.value})),(({heightPlane:t,alpha:e})=>t.apply(d,e)),a.Vh));const _=(0,Cn.v)(1);e.push((0,a.watch)((()=>({shadowStyle:o.visualElements.pointObjects.shadowStyle,alpha:_.value})),(({shadowStyle:t,alpha:e})=>t.apply(l,e)),a.Vh));const w=()=>{m.update(t);let e=mr(yn(r));const s=v&&(r.isDraped||null==e||!e.hasZ);let a=!0;if(s||null==e)a=!1;else{(0,f.x)(r.elevationInfo)&&(e=e.clone(),e.z=0);const t=(0,Pe.nG)(e,n.elevationProvider,g,n.renderCoordsHelper);(0,u.i)(yr,e.x,e.y,t),(0,Z.F)(yr,e.spatialReference,yr,n.renderCoordsHelper.spatialReference),h.setStartEndFromWorldDownAtLocation(yr),l.intersectsWorldUpAtLocation=yr}const c=m.grabbingState&ar.Z?o.visualElements.laserlineAlphaMultiplier:1;y.value=c;const p=(0,Ce.Ie)(_r);!s&&r.visible&&i.calculateMapBounds(p)&&(0,Z.F)((0,Ce.pg)(p,yr),n.spatialReference,yr,n.renderCoordsHelper.spatialReference)?(d.heightManifoldTarget=yr,d.attached=!0):d.attached=!1;const b=m.grabbingState&ar.XY?o.visualElements.laserlineAlphaMultiplier:1;_.value=b;const w=a&&r.visible&&!s;l.attached=w,h.attached=w};e.push((0,a.watch)((()=>[r.visible,r.isDraped]),w),r.on("committed",w)),t.forEachManipulator((t=>{e.push(t.events.on("grab-changed",w))})),e.push((0,s.DQ)(l)),e.push((0,s.DQ)(h)),e.push((0,s.DQ)(d)),w()}(t,e,i),{visualElement:i,remove:()=>(0,s.a0)(e)}}function mr(t){return null==t?null:"point"===t.type?t:"mesh"===t.type?t.origin.clone():null}const yr=(0,d.vt)(),_r=(0,Ce.vt)();function br(t){switch(yn(t.object)?.type){case"point":case"mesh":return vr(t);case"polygon":case"polyline":return function(t){const{object:e}=t,i=function(t){const{view:e,object:i}=t,n=yn(i),r=new Mi({view:e,geometry:fr(n)?n:null,elevationInfo:i.elevationInfo,attached:!1,isDecoration:!0}),o=new bi({getTheme:()=>e.effectiveTheme}),h=()=>{r.attached=i.visible},l=(0,s.vE)([(0,a.watch)((()=>o.visualElements.lineObjects.outline),(t=>t.apply(r)),a.Vh),(0,a.watch)((()=>o.visualElements.lineObjects.shadowStyle),(t=>t.apply(r)),a.Vh),(0,a.watch)((()=>i.visible),h),(0,a.watch)((()=>i.isDraped),(t=>{r.isDraped=t}),a.Vh),i.on("committed",(()=>{const t=yn(i);r.geometry=fr(t)?t:null})),(0,s.DQ)(r)]);return h(),{visualElement:r,remove:()=>l.remove()}}(t),n=[i,dr(t,i.visualElement)];return e.maskOccludee&&n.push(e.maskOccludee()),{visualElement:i.visualElement,remove:()=>(0,s.a0)(n)}}(t);default:return null}}const wr=70,xr=Math.ceil(wr/3*2),Tr=5*Math.PI/12,Ar=1*Math.PI/3;var Mr=i(14606);class Sr{constructor(){this._available=!0}set location(t){this._forEachManipulator3D((e=>e.location=t))}set elevationAlignedLocation(t){this._forEachManipulator3D((e=>e.elevationAlignedLocation=t))}set elevationInfo(t){this._forEachManipulator3D((e=>e.elevationInfo=t))}get renderLocation(){let t;return this._forEachManipulator3D((e=>{t||(t=e.renderLocation)})),t}set renderLocation(t){this._forEachManipulator3D((e=>e.renderLocation=t))}get available(){return this._available}set available(t){this._available=t,this._forEachManipulator3D((e=>e.available=t))}get hovering(){return this.someManipulator((t=>t.hovering))}get grabbing(){return this.someManipulator((t=>t.grabbing))}get dragging(){return this.someManipulator((t=>t.dragging))}get selected(){return this.someManipulator((t=>t.selected))}hasManipulator(t){return this.someManipulator((e=>e===t))}someManipulator(t){let e=!1;return this.forEachManipulator((i=>{!e&&t(i)&&(e=!0)})),e}_forEachManipulator3D(t){this.forEachManipulator(((e,i)=>{e instanceof Un&&t(e,i)}))}}class Er extends Sr{constructor(){super(...arguments),this._interactive=!0}get interactive(){return this._interactive}set interactive(t){this._interactive!==t&&(this._interactive=t),this._updateManipulatorInteractivity()}_updateManipulatorInteractivity(){const t=!this.grabbing&&this._interactive;this.forEachManipulator((e=>{e.interactive=t||e.grabbing}))}}class Cr{constructor(t,e=Gn.p7.None){this.geometry=t,this.stateMask=e}}var Or,Rr=i(29531),Ir=(i(49845),i(38177),i(22323),i(2831));function Pr(t,e){return Nr(t,(()=>e))}function Nr(t,e){const i=(0,d.vt)(),n=(0,d.vt)();let r=!1;return s=>{const o=e(s);if("start"===s.action){const e=(0,g.WA)(s.screenStart,(0,g.PR)(S.oG.get())),n=Hn(t.state.camera,e,Fr);null!=n&&(r=(0,zn.Ui)(o,n,i))}if(!r)return null;const a=(0,g.WA)(s.screenEnd,(0,g.PR)(S.oG.get())),h=Hn(t.state.camera,a,Fr);return null==h?null:(0,zn.Ui)(o,h,n)?{...s,renderStart:i,renderEnd:n,plane:o,ray:h}:null}}function Dr(t,e,i,n=null,r=null){return function(t,e,i=0,n=null,r=null){let s=null;return o=>{if("start"===o.action&&(s=t.sceneIntersectionHelper.intersectElevationFromScreen((0,g.gs)(o.screenStart.x,o.screenStart.y),e,i,r),null!=s&&null!=n&&!(0,Pn.projectPoint)(s,s,n)))return null;if(null==s)return null;const a=t.sceneIntersectionHelper.intersectElevationFromScreen((0,g.gs)(o.screenEnd.x,o.screenEnd.y),e,i,r);return null==a||null!=n&&!(0,Pn.projectPoint)(a,a,n)?null:{...o,mapStart:s,mapEnd:a}}}(t,i,(0,f.id)(e,t,i),n,r)}function Lr(t,e,i){let n=null;const r=new Ir.rh;return r.next(Pr(t,function(t,e){const i=jr,n=kr,r=(0,zn.vt)();t.renderCoordsHelper.worldUpAtPosition(e,i);const s=(0,u.e)((0,zn.Qj)(r),i,(0,u.d)(n,e,t.state.camera.eye));return(0,u.e)(s,s,i),(0,zn.O_)(e,s,r)}(t,e))).next(function(t,e){const i=(0,d.vt)(),n=(0,u.l)(e);t.renderCoordsHelper.worldUpAtPosition(e,i);const r=(0,d.vt)(),s=(0,d.vt)(),o=r=>((0,u.d)(r,r,e),(0,Rr._I)(i,r,r),"global"===t.viewingMode&&(0,u.l)(r)*Math.sign((0,u.f)(i,r))<.001-n&&(0,u.d)(r,(0,u.h)(r,i,.001),e),(0,u.g)(r,r,e),r);return t=>(t.renderStart=o((0,u.c)(r,t.renderStart)),t.renderEnd=o((0,u.c)(s,t.renderEnd)),t)}(t,e)).next(zr(t,i)).next((t=>{t.mapEnd.x=t.mapStart.x,t.mapEnd.y=t.mapStart.y,n=t})),t=>(n=null,r.execute(t),n)}function zr(t,e){const i=t.renderCoordsHelper;return t=>{const n=i.fromRenderCoords(t.renderStart,new Vn.default({spatialReference:e})),r=i.fromRenderCoords(t.renderEnd,new Vn.default({spatialReference:e}));return null!=n&&null!=r?{...t,mapStart:n,mapEnd:r}:null}}!function(t){t[t.GROUND=0]="GROUND",t[t.OTHER=1]="OTHER"}(Or||(Or={})),(0,A.vt)();const jr=(0,d.vt)(),kr=(0,d.vt)(),Fr=(0,tt.vt)();function Hr(t,e,i){const n=(i,n)=>{e({action:i,object:t,dxScreen:n.screenDeltaX,dyScreen:n.screenDeltaY})};return i(((e,i,r)=>(i.next((t=>("start"===t.action&&n("start",t),t))).next((0,Ir.Wp)(t)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&n("update",t);break;case"end":n("end",t)}return t})),{steps:i,cancel:r=r.next((0,Ir.dp)(t)).next((t=>(n("end",{screenDeltaX:0,screenDeltaY:0}),t)))})))}function Br(t){if(null==t?.axis)return 1;const{mapStart:e,mapEnd:i,axis:n}=t,r=[i.x-e.x,i.y-e.y];return r[0]*n[0]+r[1]*n[1]>0?1:-1}class Gr extends Sr{constructor(t){super(),this._handles=new Mr.A,this._arrowManipulatorInfos=new Array,this._angle=0,this._scale=1,this._radius=wr,this._updateAfterDrag=!1,this.events=new wi.A,this._tool=t.tool,this._view=t.view,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}set orthogonalAvailable(t){this._arrowManipulatorInfos.length>=3&&(this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t)}destroy(){this._handles=(0,o.pR)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}forEachManipulator(t){for(const{manipulator:e}of this._arrowManipulatorInfos)t(e,hr.TRANSLATE_XY)}createManipulatedObjectDragPipeline(t,e,i){if(!e.operations)return(0,s.hA)();const n=e.operations.data.spatialReference,r=e.graphic;return Hr(e,i,(i=>this.createDragPipeline(((e,n,r,s,o)=>(({steps:n,cancel:r}=t(e,n,r,s,o)),i(e,n,r))),e.elevationInfo,n,r)))}createDragPipeline(t,e,i,n){return(0,s.vE)(this._arrowManipulatorInfos.map((({manipulator:r},s)=>(0,Ir.Xt)(r,((r,o,a,h,l)=>{const c=o.next((t=>({...t,manipulatorType:hr.TRANSLATE_XY}))).next((0,Ir.Tp)(this._view,r.elevationAlignedLocation)).next(Dr(this._view,r.elevationAlignedLocation,e,i,n)).next((0,Ir.an)(r.location,this.angle+(s+1)*Math.PI*.5)).next((0,Ir.sO)());t(r,c,a,h,l)})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators())}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:t,transform:e},i){const n=this._radius/wr,r=54*n,s=r*Math.sqrt(3)/2,o=(0,ee._B)(this._opaqueMaterial,s,r/2,r/2,.02);(0,ee.xh)(o,(0,Oe.kN)(S.Rc.get(),(0,u.i)(S.rq.get(),0,-s/3,0))),t.renderObjects=[new Cr(o,Gn.p7.Focused),new Cr(o.instantiate({material:this._transparentMaterial}),Gn.p7.Unfocused)],t.radius=s/3*2*1.2;const a=(0,Oe.N9)(S.Rc.get(),i*Math.PI/2),h=(0,Oe.kN)(S.Rc.get(),(0,u.i)(S.rq.get(),0,100*n,0));(0,Oe.lw)(e,a,h)}_createManipulators(){for(let t=0;t<4;t++){const e=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(e)}this._updateManipulatorTransform()}_updateManipulatorTransform(){const t=this.angle,e=(0,Oe.$0)(S.Rc.get(),t,(0,d.fA)(0,0,1));if(null==e)return;const i=(0,Oe.CV)(S.Rc.get(),(0,u.i)(S.rq.get(),this.displayScale,this.displayScale,this.displayScale)),n=(0,Oe.lw)(S.Rc.get(),i,e);for(const t of this._arrowManipulatorInfos){const e=(0,Oe.lw)(S.Rc.get(),n,t.transform);t.manipulator.modelTransform=e}}_createArrowManipulator(t){const e=new Un({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,d.fA)(0,0,1)}}),i={manipulator:e,transform:(0,Re.vt)()};return this._updateArrowManipulator(i,t),this._handles.add(e.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}))),i}_createMaterial(t=1){const e=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Transparent,isDecoration:!0});return this._handles.add((0,a.watch)((()=>m.A.toUnitRGBA(this._view.effectiveTheme.accentColor)),(i=>{i[3]*=t,e.setParameters({color:i})}),a.Vh)),e}get test(){}}class Vr{constructor(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e=this._lastDragEvent.mapEnd,i=this._snap(this._lastDragEvent.screenEnd);if(null!=i){const n={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===t?i:e,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(n)}}this._enabled=t}_snap(t){const e=null!=this._view?this._view.toMap(t,{exclude:[]}):null;return null!=e&&null!=this._view&&(e.z=(0,f.id)(e,this._view,this._elevationInfo)),e}createDragEventPipelineStep(t,e){this._view=t,this._elevationInfo=e,this._lastDragEvent=null;const i=new Ir.rh;return this._next=i,[t=>{if(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled){const e=this._snap(t.screenEnd);return null!=e?{action:t.action,mapStart:t.mapStart,mapEnd:e,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}},i]}}class Ur extends Sr{constructor(t){super(),this._handles=new Mr.A,this._snapToScene=new Vr,this._scale=1,this._radius=wr,this._view=t.view,this._tool=t.tool,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles=(0,o.pR)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){t(this._manipulator,hr.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}get discManipulator(){return this._manipulator}createManipulatedObjectDragPipeline(t,e,i){if(!e.operations)return(0,s.hA)();const n=e.graphic,r=e.elevationInfo,o=e.operations.data.spatialReference;return Hr(e,i,(e=>this.createDragPipeline(((i,n,r,s,o)=>(({steps:n,cancel:r}=t(i,n,r,s,o)),e(i,n,r))),r,o,n)))}createDragPipeline(t,e,i,n){const r=this._view;return(0,Ir.Xt)(this._manipulator,((s,o,a,h,l)=>{const c=o.next((0,Ir.Tp)(r,s.elevationAlignedLocation)).next(Dr(r,s.elevationAlignedLocation,e,i,n)).next(...this._snapToScene.createDragEventPipelineStep(r,e)).next((t=>({...t,manipulatorType:hr.TRANSLATE_XY}))).next((0,Ir.sO)());t(s,c,a,h,l)}))}_updateManipulatorTransform(){const t=(0,Oe.CV)(S.Rc.get(),(0,u.i)(S.rq.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t}_createManipulator(){const t=this._view;this._manipulator=new Un({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,d.fA)(0,0,1)},worldOriented:!0}),this._updateManipulator()}_updateManipulator(){const t=(0,ee.nW)(this._discMaterial,.02,1,128,(0,d.fA)(0,0,1),(0,d.fA)(0,0,0));t.transformation=(0,Oe.CV)((0,Re.vt)(),(0,d.fA)(this._radius,this._radius,this._radius)),this._manipulator.renderObjects=[new Cr(t,Gn.p7.Focused),new Cr(t.instantiate({material:this._discMaterialTransparent}),Gn.p7.Unfocused)],this._manipulator.radius=this._radius/wr*80}_createMaterial(t=1){const e=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Transparent,isDecoration:!0});return this._handles.add((0,a.watch)((()=>m.A.toUnitRGBA(this._view.effectiveTheme.accentColor)),(i=>{i[3]*=t,e.setParameters({color:i})}),a.Vh)),e}get test(){}}var $r=i(75302);function Wr(t,e=ie.m$.OccludeAndTransparent,i=!0){const n=(0,r.pf)(t),s=!(t[3]<1);return i?new Wi({color:n,writeDepth:s,cullFace:Zt.s2.Back,renderOccluded:e,isDecoration:!0}):new Ge.v({color:n,writeDepth:s,cullFace:Zt.s2.Back,renderOccluded:e,isDecoration:!0})}function qr(t,e=ie.m$.OccludeAndTransparent){const i=(0,r.pf)(t);return new Ge.v({color:i,writeDepth:!0,cullFace:Zt.s2.Front,renderOccluded:e,isDecoration:!0})}const Zr=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),Yr=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function Xr(t,e,i,n){const r=(0,u.d)(S.rq.get(),t,i),s=Kr(r,(0,u.e)(S.rq.get(),n,r),i,S.Rc.get());(0,Oe.B8)(s,s);const o=(0,u.t)(S.rq.get(),e,s);return Math.atan2(o[1],o[0])}function Kr(t,e,i,n){const r=(0,u.n)(S.rq.get(),t),s=(0,u.n)(S.rq.get(),e),o=(0,u.e)(S.rq.get(),r,s);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=0,n[4]=s[0],n[5]=s[1],n[6]=s[2],n[7]=0,n[8]=o[0],n[9]=o[1],n[10]=o[2],n[11]=0,n[12]=i[0],n[13]=i[1],n[14]=i[2],n[15]=1,n}function Jr(t,e){const i=e.origin;null==i?function(t,e){if(null==e)return;const i="mesh"===e.type?e.origin:(0,$r.W$)(e);null!=i&&(t.location=(0,jn.wZ)(i))}(t,yn(e)):t.elevationAlignedLocation=i}class Qr extends Sr{constructor(t){super(),this._radius=wr,this.events=new wi.A,this._tool=t.tool,this._view=t.view;const e=new bi({getTheme:()=>this._view.effectiveTheme});this._settings=e,null!=t.radius&&(this._radius=t.radius);const i=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:Wr(ts(i,1,.25),ie.m$.Occlude),materialFocused:Wr(ts(i,1,0),ie.m$.Occlude),materialOccludedUnfocused:Wr(ts(i,.7,0),e.zManipulator.renderOccluded),materialOccludedFocused:Wr(ts(i,.85,0),e.zManipulator.renderOccluded)},this._themeHandle=(0,a.watch)((()=>this._view.effectiveTheme.accentColor),(t=>{const e=ts(t,1,.25),i=ts(t,1,0),n=ts(t,.7,0),r=ts(t,.85,0),{materialUnfocused:s,materialFocused:o,materialOccludedUnfocused:a,materialOccludedFocused:h}=this._materials;s.setParameters({color:e}),o.setParameters({color:i}),a.setParameters({color:n}),h.setParameters({color:r})})),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._themeHandle=(0,o.xt)(this._themeHandle),this._manipulator.applyObjectTransform=rs,this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){t(this._manipulator,hr.TRANSLATE_Z)}createManipulatedObjectDragPipeline(t,e,i){if(!e.operations)return(0,s.hA)();const n=e.operations.data.spatialReference;return Hr(e,i,(e=>this.createDragPipeline(((i,n,r,s,o)=>(({steps:n,cancel:r}=t(i,n,r,s,o)),e(i,n,r))),n)))}createDragPipeline(t,e){const i=this._view;return(0,Ir.Xt)(this._manipulator,((n,r,s,o,a)=>{const h=r.next((t=>({...t,manipulatorType:hr.TRANSLATE_Z}))).next(Lr(i,n.renderLocation,e)).next((0,Ir.sO)());t(n,h,s,o,a)}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}_updateManipulator(){const t=this._settings,e=this._radius/wr,i=t.zManipulator.height*e,n=t.zManipulator.coneHeight*e,r=t.zManipulator.coneWidth*e,s=t.zManipulator.width*e,o=[(0,d.fA)(0,0,0),(0,d.fA)(0,0,i)],a=[(0,d.fA)(0,0,0),(0,d.fA)(0,0,i+n)],h=(()=>{const t=(0,Re.vt)();return(0,Oe.Tl)(t,t,[0,0,i]),(0,Oe.eL)(t,t,Math.PI/2),t})(),{materialUnfocused:l,materialFocused:c,materialOccludedUnfocused:u,materialOccludedFocused:f}=this._materials,p=(0,ee.Nb)(l,o,s/2,16,!1),g=(0,ee.EE)(l,n,r/2,16,!1);g.transformation=h,this._manipulator.renderObjects=[new Cr(g,Gn.p7.Unfocused),new Cr(p,Gn.p7.Unfocused),new Cr(g.instantiate({material:c}),Gn.p7.Focused),new Cr(p.instantiate({material:c}),Gn.p7.Focused),new Cr(g.instantiate({material:u}),Gn.p7.Unfocused),new Cr(p.instantiate({material:u}),Gn.p7.Unfocused),new Cr(g.instantiate({material:f}),Gn.p7.Focused),new Cr(p.instantiate({material:f}),Gn.p7.Focused)],this._manipulator.radius=s/2+2,this._manipulator.collisionType={type:"line",paths:[a]}}_createManipulator(){const t=this._view,e=new Un({view:t,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});e.applyObjectTransform=e=>{const i=t.state.camera,n=es;t.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,n);const r=(0,u.F)(i.eye,n),s=i.computeRenderPixelSizeAtDist(r),o=(0,u.d)(is,n,i.eye);(0,u.n)(o,o);const a=ns;t.renderCoordsHelper.worldUpAtPosition(es,a);const h=Math.abs((0,u.f)(o,a)),l=(0,u.e)(is,o,a),c=(0,u.e)(is,l,a),d=(0,b.qE)(h,.01,1),f=1-Math.sqrt(1-d*d)/d/i.fullWidth,p=this._settings,g=this._radius/wr,v=p.zManipulator.width*g;(0,u.h)(c,(0,u.n)(c,c),(1/f-1)*r+s*v),e[12]-=is[0],e[13]-=is[1],e[14]-=is[2]},this._manipulator=e,this._updateManipulator()}get test(){}}function ts(t,e,i){const n=(0,r.e$)(t,i);return n.a*=e,m.A.toUnitRGBA(n)}const es=(0,d.vt)(),is=(0,d.vt)(),ns=(0,d.vt)(),rs=()=>{};class ss extends Er{constructor(t){super(),this._handles=new Mr.A;const{tool:e,view:i,snapToScene:n,radius:r}=t;this._view=i,this.xyManipulation=new Ur({tool:e,view:i,snapToScene:n,radius:r}),this.xyAxisManipulation=new Gr({tool:e,view:i,radius:r}),this.zManipulation=new Qr({tool:e,view:i,radius:r}),this.xyManipulation.available=t.xyAvailable,this.xyAxisManipulation.available=t.xyAxisAvailable,this.zManipulation.available=t.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((t=>this._handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))))}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}createManipulatedObjectDragPipeline(t,e,i){return(0,s.vE)([this.xyManipulation.createManipulatedObjectDragPipeline(((e,i,n,r,s)=>t(as.XY,e,i,n,r,s)),e,i),this.xyAxisManipulation.createManipulatedObjectDragPipeline(((e,i,n,r,s)=>t(as.XY_AXIS,e,i,n,r,s)),e,i),this.zManipulation.createManipulatedObjectDragPipeline(((e,i,n,r,s)=>t(as.Z,e,i,n,r,s)),e,i)])}createDragPipeline(t,e,i,n){return(0,s.vE)([this.xyManipulation.createDragPipeline(((e,i,n,r,s)=>t(as.XY,e,i,n,r,s)),e,i,n),this.xyAxisManipulation.createDragPipeline(((e,i,n,r,s)=>t(as.XY_AXIS,e,i,n,r,s)),e,i,n),this.zManipulation.createDragPipeline(((e,i,n,r,s)=>t(as.Z,e,i,n,r,s)),i)])}set snapToScene(t){this.xyManipulation.snapToScene=t}set angle(t){this.xyAxisManipulation.angle=t}set radius(t){this.xyAxisManipulation.radius=t,this.xyManipulation.radius=t,this.zManipulation.radius=t}set displayScale(t){this.xyManipulation.displayScale=t,this.xyAxisManipulation.displayScale=t}forEachManipulator(t){this.xyManipulation.forEachManipulator((e=>t(e,hr.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((e=>t(e,hr.TRANSLATE_XY))),this.zManipulation.forEachManipulator((e=>t(e,hr.TRANSLATE_Z)))}get _xyAxisVisible(){const t=this.xyManipulation.someManipulator((t=>t.focused))||this.xyAxisManipulation.someManipulator((t=>t.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||t}_autoHideXYAxis(){const t=this.xyAxisManipulation,e=this.xyManipulation;if((0,l.A)("esri-mobile"))return;const i=[];e.forEachManipulator((t=>i.push(t))),t.forEachManipulator((t=>i.push(t)));const n=()=>{const e=[];this._xyAxisVisible||t.forEachManipulator((t=>e.push(t.disableDisplay()))),this._handles.remove(os),this._handles.add(e,os)};for(const t of i)this._handles.add(t.events.on("focus-changed",n));this._view.inputManager&&this._handles.add((0,a.when)((()=>this._view.inputManager?.latestPointerType),n)),n()}static radiusForSymbol(t){const e=null!=t&&"point-3d"===t.type&&t.symbolLayers;return e&&e.some((t=>"icon"===t.type))?xr:wr}}const os="disable-xy-axis-display";var as,hs;(hs=as||(as={}))[hs.XY=0]="XY",hs[hs.XY_AXIS=1]="XY_AXIS",hs[hs.Z=2]="Z";class ls extends Sr{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._object=t.object,this._manipulator=this._object.createManipulator?.({selectable:!0,cursor:"move"}),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){this._manipulator&&t(this._manipulator,hr.TRANSLATE_XY)}createManipulatedObjectDragPipeline(t){return Hr(this._object,t,(t=>this.createDragPipeline(t)))}createDragPipeline(t){if(!this._manipulator)return(0,s.hA)();const e=this._view;return(0,Ir.Xt)(this._manipulator,((i,n,r,s,o)=>{const a=this._object.operations?.data.spatialReference,h=n.next((t=>a?t:null)).next(function(t,e,i,n){const r=i.toMap(t.screenStart);return null!=r?Dr(e,r,i.elevationInfo,n):null}(o,e,this._object,a)).next((0,Ir.EX)()).next((0,Ir.sO)());t(i,h,r,s,o)}))}}var cs=i(87982),us=i(83202),ds=i(7819),fs=i(37102),ps=i(58144),gs=i(45908),vs=i(18945),ms=i(94492),ys=i(90858);let _s=class extends ys.w{constructor(t){super(t),this.type="translate-xy",this.distance=fn.r7}};(0,n._)([(0,h.MZ)()],_s.prototype,"type",void 0),(0,n._)([(0,h.MZ)()],_s.prototype,"distance",void 0),_s=(0,n._)([(0,c.$)("esri.views.interactive.tooltip.infos.TranslateXYTooltipInfo")],_s);let bs=class extends ys.w{constructor(t){super(t),this.type="translate-z",this.distance=fn.r7}clear(){this.distance=fn.r7}};(0,n._)([(0,h.MZ)()],bs.prototype,"type",void 0),(0,n._)([(0,h.MZ)()],bs.prototype,"distance",void 0),bs=(0,n._)([(0,c.$)("esri.views.interactive.tooltip.infos.TranslateZTooltipInfo")],bs);class ws{constructor(t){this.objects=t,this.type="move-start"}}class xs{constructor(t,e,i){this.dx=t,this.dy=e,this.objects=i,this.type="move"}}class Ts{constructor(t){this.objects=t,this.type="move-stop"}}const As=Symbol("manipulators"),Ms=Symbol("tooltips");let Ss=class extends us.g{constructor(t){super(t),this._infos=new Map,this.events=new wi.A,this.objects=new dn.A,this.enableZ=!0,this.sketchOptions=new fs.A,this.type="move-3d",this._latestTooltipInfo=null,this._translateTooltipInfo=null,this._translateXYTooltipInfo=null,this._translateZTooltipInfo=null,this._updatingHandles=new pn.U,this._moveManipulation=null}initialize(){const{view:t}=this;this.tooltip=(0,on.A)((()=>({view:t,options:this.sketchOptions.tooltips}))),this.addHandles([this.objects.on("change",(t=>{t.removed.forEach((t=>this.removeHandles(t))),this._updateObjectInfos(t),this._setupFastTransformUpdates(t.added),this._refreshManipulators()})),this.objects.on("change",(()=>this._connectTooltips()))]);const e=this.objects.toArray();this._updateObjectInfos({added:e,removed:[]}),this._setupFastTransformUpdates(e),this._refreshManipulators(),this._connectTooltips(),this.finishToolCreation()}destroy(){this.tooltip=(0,o.pR)(this.tooltip),this._moveManipulation=(0,o.pR)(this._moveManipulation),this._set("view",null),this._updatingHandles.destroy()}onInputEvent(t){if(!this.destroyed&&!(0,on.wG)(t,this.tooltip))return super.onInputEvent(t)}get updating(){return this._updatingHandles.updating}get _shouldShowMovePointTooltip(){const{objects:t}=this;if(1!==t.length)return!1;const e=yn(t.at(0))?.type;return"point"===e||"mesh"===e}get activeTooltipInfo(){return this._shouldShowMovePointTooltip?this._movePointTooltipInfo:this._latestTooltipInfo}reset(){}_updateObjectInfos({added:t,removed:e}){for(const e of t){if((0,cs.Y)(e)!==mn.d.SUPPORTED)continue;const t=new Es(e);this._infos.set(e,t)}for(const t of e)this._infos.delete(t)}_setupFastTransformUpdates(t){for(const e of t){const t=this._infos.get(e);this.addHandles(si(t.object),e)}}_refreshManipulators(){if(this.removeHandles(As),this._moveManipulation=(0,o.pR)(this._moveManipulation),this.manipulators.removeAll(),0===this._infos.size)return;const t=Array.from(this._infos.values());this._createManipulators(t),this._createVisualElements(t),this._updateMoveManipulation(t)}_createManipulators(t){for(const e of t){const i=e.object;e.manipulationXY=new ls({tool:this,view:this.view,object:i}),e.manipulationXY.forEachManipulator((t=>{this.addHandles([t.events.on("immediate-click",(t=>{this.events.emit("immediate-click",{...t,object:i}),t.stopPropagation()})),t.events.on("grab-changed",(({action:t})=>{"start"===t?this._showTooltip(as.XY):this._hideTooltip()}))],As)})),this.addHandles(e.manipulationXY.createDragPipeline(((e,i,n,r)=>this._buildDragEventPipeline(t,as.XY,e,i,n,r))),As)}this._createMoveManipulation(t)}_createMoveManipulation(t){const e=new ss({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?ss.radiusForSymbol(t[0].object.graphic?.symbol):wr});this._moveManipulation=e,e.elevationInfo={mode:"absolute-height",offset:0},e.forEachManipulator((t=>{this.addHandles(t.events.on("immediate-click",(i=>{const n=this.objects.at(0);!e.zManipulation.hasManipulator(t)&&1===this.objects.length&&n&&this.events.emit("immediate-click",{...i,object:n}),i.stopPropagation()})),As)}));const i=t=>e=>{this.addHandles([e.events.on("focus-changed",(({action:e})=>{"focus"===e?this._showTooltip(t):this._hideTooltip()})),e.events.on("grab-changed",(()=>{this._latestTooltipInfo&&(this._latestTooltipInfo.distance=fn.r7)}))],As)};this._moveManipulation.xyManipulation.forEachManipulator(i(as.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(i(as.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(i(as.Z));const n=()=>this._updateMoveManipulation(t);for(const e of t)this.addHandles([e.object.on("committed",n),(0,a.watch)((()=>e.object.visible),n)],As);const r=t[t.length-1];this.addHandles(r.object.on("committed",(()=>this._updateMoveManipulationAngle(r))),As);const{object:s}=r,{operations:o}=s;if(o){const i=s.graphic;this.addHandles(e.createDragPipeline(((e,i,n,r,s)=>this._buildDragEventPipeline(t,e,i,n,r,s)),s.elevationInfo,o.data.spatialReference,i),As)}this._updateMoveManipulationAngle(r)}_createVisualElements(t){for(const e of t){const i=e.object,n=br({view:this.view,object:i,forEachManipulator:t=>{e.manipulationXY?.forEachManipulator(t),this._moveManipulation?.forEachManipulator(t)},onManipulatorsChanged:()=>(0,s.hA)()});null!=n&&(e.geometryRepresentation=n.visualElement,e.geometryRepresentation instanceof Mi&&this.addHandles([e.geometryRepresentation.events.on("attachment-origin-changed",(()=>{e.object.isDraped||this._updateMoveManipulation(t)})),(0,a.watch)((()=>e.object.isDraped),(()=>this._updateMoveManipulation(t)))],As),this.addHandles(n,As))}}_updateMoveManipulationAngle(t){this._moveManipulation&&(this._moveManipulation.angle=vn(yn(t.object)))}_updateMoveManipulation(t){const e=(0,ge.T)(0,0,0,this.view.spatialReference);let i=0,n=!1;const r=this._moveManipulation;if(r){for(const r of t){if(!r.object.visible)continue;this.enableZ&&_n(r.object.operations,r.object.elevationInfo)&&(n=!0);const t=r.geometryRepresentation instanceof Mi&&!r.object.isDraped?r.geometryRepresentation.attachmentOrigin:r.object.origin;if(null!=t){const{x:n,y:r,z:s}=t;e.x+=n,e.y+=r,s&&(e.z??=0,e.z+=s),i++}}i>0?(e.x/=i,e.y/=i,e.z??=0,e.z/=i,r.location=e,r.xyManipulation.available=!0,r.xyAxisManipulation.available=!0,r.zManipulation.available=n):r.available=!1}}_buildDragEventPipeline(t,e,i,n,r,s){const o=[],a=[];let h=null,l=null;const c=()=>{for(const t of o)t.dragging=!1;o.length=0,a.length=0,h=null,l=null,this._moveManipulation&&(this._moveManipulation.interactive=!0)};if(1===t.length&&e===as.XY){const e=t[0].object;({steps:n,cancel:r}=this._buildSnappingPipelineSteps(e,e.elevationInfo,n,r,s))}return r=r.next((t=>l?.(t))).next((()=>(a.length&&this.events.emit("move-stop",new Ts(a)),this.destroyed||c(),null))),{steps:n=n.next((e=>{if("start"===e.action){o.length=0,a.length=0;for(const e of t)e.dragging||!e.manipulationXY?.hasManipulator(i)&&e.manipulationXY?.grabbing||(o.push(e),a.push(e.object),e.dragging=!0);if(0!==a.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),h=(0,Ir.bl)(a),l=(0,Ir.mc)(a),this._emitRecordUndo(),this.events.emit("move-start",new ws(a)),this.destroyed))return null}return 0!==a.length?e:null})).next((t=>h?.(t))).next((t=>(this._updateMoveTooltip(e,t),t))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const e=this.view.toScreen(t.mapStart),i=this.view.toScreen(t.mapEnd),n=i.x-e.x,r=i.y-e.y;if(this.events.emit("move",new xs(n,r,a)),this.destroyed)return null}break;case"end":if(this.events.emit("move-stop",new Ts(a)),this.destroyed)return null;c()}return null})),cancel:r}}_connectTooltips(){let t;if(this.removeHandles(Ms),this._shouldShowMovePointTooltip){const e=this.objects.at(0),{events:i}=this;this._movePointTooltipInfo??=new vs.F({viewType:this.view.type,sketchOptions:this.sketchOptions});const n={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo(),i.emit("move-start",new ws([e]))},onMove:()=>i.emit("move",new xs(0,0,[e])),onMoveStop:()=>i.emit("move-stop",new Ts([e])),onRotateStart:()=>{},onRotate:()=>{},onRotateStop:()=>{},onScaleStart:()=>{},onScale:()=>{},onScaleStop:()=>{}};t=xn(this.tooltip,e,(()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this._movePointTooltipInfo,callbacks:n})))}else t=(0,a.watch)((()=>this.sketchOptions.tooltips.effectiveEnabled?this._latestTooltipInfo:null),(t=>{this.tooltip.info=t}),a.pc);this.addHandles(t,Ms)}_showTooltip(t){this._shouldShowMovePointTooltip||this._updateMoveTooltip(t)}_hideTooltip(){this._shouldShowMovePointTooltip||(this.tooltip?.clear(),this._latestTooltipInfo=null)}_updateMoveTooltip(t,e){if(this._shouldShowMovePointTooltip)return;const{sketchOptions:i}=this;switch(t){case as.XY:this._latestTooltipInfo=this._translateTooltipInfo??=new ms.M({sketchOptions:i}),Cs(this._latestTooltipInfo,e,((t,e)=>(0,L.Kt)(t,e)));break;case as.XY_AXIS:this._latestTooltipInfo=this._translateXYTooltipInfo??=new _s({sketchOptions:i}),Cs(this._latestTooltipInfo,e,((t,i)=>(0,fn.hs)((0,L.Kt)(t,i),Br(e))));break;case as.Z:this._latestTooltipInfo=this._translateZTooltipInfo??=new bs({sketchOptions:i}),Cs(this._latestTooltipInfo,e,wn.e5)}this._latestTooltipInfo.sketchOptions=i}_emitRecordUndo(){const t=this.objects.toArray().map((t=>t.createUndoRecord?.())).filter(un.Ru);t.length>0&&this.events.emit("record-undo",{updates:t})}_buildSnappingPipelineSteps(t,e,i,n,r){const s=yn(t);if(null==s||"point"!==s.type&&"mesh"!==s.type)return{steps:i,cancel:n};const o=("point"===s.type?s:s.origin).clone(),a=new ps.e({elevationInfo:e,pointer:r,editGeometryOperations:ds.p.fromGeometry(o,this.view.state.viewingMode),visualizer:new Qe,excludeFeature:t.graphic}),h=this.snappingManager,{snappingStep:l,cancelSnapping:c}=(0,gs.L)({snappingContext:a,snappingManager:h,updatingHandles:this._updatingHandles});return n=n.next(c),{steps:i=i.next((e=>(o.z=(0,f.wS)(this.view,o,t.elevationInfo,{mode:"absolute-height",offset:0}),{...e,snapOrigin:a.coordinateHelper.pointToVector(o)}))).next(...l),cancel:n}}};(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],Ss.prototype,"view",void 0),(0,n._)([(0,h.MZ)()],Ss.prototype,"objects",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],Ss.prototype,"enableZ",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,type:fs.A})],Ss.prototype,"sketchOptions",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],Ss.prototype,"snappingManager",void 0),(0,n._)([(0,h.MZ)()],Ss.prototype,"type",void 0),(0,n._)([(0,h.MZ)()],Ss.prototype,"updating",null),(0,n._)([(0,h.MZ)()],Ss.prototype,"_latestTooltipInfo",void 0),(0,n._)([(0,h.MZ)()],Ss.prototype,"_shouldShowMovePointTooltip",null),(0,n._)([(0,h.MZ)()],Ss.prototype,"activeTooltipInfo",null),Ss=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.move.MoveTool3D")],Ss);class Es{constructor(t){this.object=t,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1}}function Cs(t,e,i){if(null==e||"end"===e.action)return void(t.distance=fn.r7);const{mapStart:n,mapEnd:r}=e,s=i(n,r);t.distance=null!=s?s:fn.r7}var Os=i(91508),Rs=i(57165),Is=i(89814),Ps=i(57862),Ns=i(63447);function Ds(t,e,i){const n="on-the-ground"===i.mode?Ns.B.XY:Ns.B.XYZ;return new Ns.L(t,n,e,0)}function Ls(t,e,i){const n=(0,d.vt)();if(!t.renderCoordsHelper.toRenderCoords(e,n))return null;const r=zs(t,e,(0,zn.Qj)(i.plane)),s=zs(t,e,i.edgeDirection);if(null==r||null==s)return null;const o=(0,u.e)((0,d.vt)(),r,s);return(0,zn.O_)(n,o,(0,zn.vt)())}function zs(t,e,i){const n=(0,ge.T)(e.x+i[0],e.y+i[1],e.z+i[2],e.spatialReference),r=(0,d.vt)(),s=(0,d.vt)();return t.renderCoordsHelper.toRenderCoords(e,r)&&t.renderCoordsHelper.toRenderCoords(n,s)?(0,u.o)(s,r,s):null}function js(t,e,i,n){const{elevationInfo:r,operations:s}=i;if(!s||!t)return null;const o=n.manipulator.elevationAlignedLocation,a=(0,f.id)(o,e,r),h=e.sceneIntersectionHelper.intersectElevationFromScreen((0,g.gs)(t.x,t.y),r,a);return h&&(0,Pn.projectPoint)(h,h,s.data.spatialReference)?h:null}var ks=i(87265);let Fs=class extends ys.w{constructor(t){super(t),this.type="reshape-edge-offset",this.distance=(0,ks.Y3)({lockable:!1}),this.area=(0,ks.Am)({visible:!1}),this.totalLength=(0,ks.fr)({visible:!1})}get allFields(){return[this.distance,this.area,this.totalLength]}};(0,n._)([(0,h.MZ)()],Fs.prototype,"type",void 0),(0,n._)([(0,h.MZ)()],Fs.prototype,"distance",void 0),(0,n._)([(0,h.MZ)()],Fs.prototype,"area",void 0),(0,n._)([(0,h.MZ)()],Fs.prototype,"totalLength",void 0),(0,n._)([(0,h.MZ)()],Fs.prototype,"allFields",null),Fs=(0,n._)([(0,c.$)("esri.views.interactive.tooltip.infos.ReshapeEdgeOffsetTooltipInfo")],Fs);var Hs=i(83931),Bs=i(70474);function Gs(t,e,i){function n(){const t=i(),e=t.sketchOptions.tooltips.effectiveEnabled?t.activeTooltipInfo:null;return{...t,activeTooltipInfo:e}}let r=!1;function o(t){r||(r=!0,t(),r=!1)}function h(i){o((()=>{(function(t,{activeTooltipInfo:e,selectedVertexManipulatorInfo:i,sketchOptions:n}){if(e)switch(e.sketchOptions=n,e?.type){case"move-point":Mn(e,t);break;case"selected-vertex":!function(t,e,i){if(!t||"selected-vertex"!==t.type)return;const n=e?.manipulator.location;t.setLocationFromPoint(n),Sn(t,n,i);const r=i.operations?.data.geometry;switch(r?.type){case"polygon":t.geometryType="polygon",t.totalLength.visible=!1,t.area.actual=(0,Bs.n)(r);break;case"polyline":t.geometryType="polyline",t.totalLength.actual=(0,L.ob)(r),t.area.visible=!1}}(e,i,t)}})(e,i),t.info=i.activeTooltipInfo}))}return(0,s.vE)([(0,a.watch)(n,h,a.pc),(0,a.watch)((()=>{const t=n(),{activeTooltipInfo:i}=t;if(i&&"key"in i)return{context:t,activeTooltipInfo:i,key:i.key,geometry:yn(e)}}),((t,i)=>{t&&i&&i.key!==t.key&&o((()=>Vs(e,t.context)))}),a.OH),e.on("committed",(()=>h(n()))),(0,on.sZ)(t,{onBeforePaste:()=>{r=!0},onAfterPaste:()=>{Vs(e,n()),r=!1}})])}function Vs(t,{activeTooltipInfo:e,selectedVertexManipulatorInfo:i,callbacks:n}){if(!e)return;n.onBeforeReshape();const r=yn(t);switch(r?.type){case"mesh":"move-point"===e.type&&An(e,r.origin,t,n);break;case"point":"move-point"===e.type&&An(e,r,t,n);break;case"polyline":case"polygon":"selected-vertex"===e.type&&function(t,e,i,n){if(!e)return;const{dx:r,dy:s,dz:o}=(0,on.mu)(t,e.manipulator.location);0===r&&0===s&&0===o||(n.onReshapeStart(),i.operations?.moveVertices([e.handle],r,s,o,bn.Y.NEW_STEP),n.onReshape(),n.onReshapeStop())}(e,i,t,n)}}function Us(t,e,i){if(null!=e&&"end"!==e.action){const{mapStart:n,mapEnd:r}=e,s=i(n,r);t.distance=null!=s?s:fn.r7}else t.distance=fn.r7}function $s({operations:t},e,{sketchOptions:i,tooltipInfos:n}){const r=n.edgeOffset;if(r.distance.committed=null,null!=e&&null!=e.signedDistance&&"end"!==e.action&&null!=t){const i=t.data.coordinateHelper,{start:n,end:s}=e.operation.clampedStartAndEnd(e.mapEnd),o=(0,L.Do)(n,s,i.spatialReference),a=Math.sign(e.signedDistance*e.operation.selectedArrow);r.distance.actual=null!=o?(0,fn.hs)(o,a):null}else r.distance.actual=fn.r7;const s=t?.data.geometry;switch(r.area.actual=null,r.area.visible=!1,r.totalLength.actual=null,r.totalLength.visible=!1,s?.type){case"polygon":r.area.actual=(0,Bs.n)(s),r.area.visible=!0;break;case"polyline":r.totalLength.actual=(0,L.ob)(s),r.totalLength.visible=!0}return r.sketchOptions=i,r}var Ws=i(71168),qs=i(37578);const Zs=Symbol();let Ys=class extends y.A{get _operations(){return this.object.operations}constructor(t){super(t),this._selectedIndex=0,this._manipulatorHandles=new Mr.A,this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=ro.NONE,this._pendingEdgeOffsetInfo=null,this._updatingHandles=new pn.U,this._recreatingManipulators=!1,this._settings=new bi({getTheme:()=>this.view.effectiveTheme}),this.events=new wi.A,this.activeTooltipInfo=null,this._vertexLaserLineVisualElement=null,this._tooltipCallbacks={onBeforeReshape:()=>this.tool.endDrag(),onReshapeStart:()=>this._updateEventState(ro.RESHAPING),onReshape:()=>this.events.emit("reshape",{type:"reshape",object:this.object}),onReshapeStop:()=>this._updateEventState(ro.NONE,{forceEnd:!0}),onMoveStart:()=>this._updateEventState(ro.MOVING),onMove:()=>this.events.emit("move",{type:"move",object:this.object,dx:0,dy:0}),onMoveStop:()=>this._updateEventState(ro.NONE,{forceEnd:!0})}}initialize(){const{view:t}=this,e=this._settings.manipulators,i=e.vertex;this.tooltipInfos=function(t,e){const i=e?.type;return{edgeOffset:new Fs({sketchOptions:t,viewType:i}),movePoint:new vs.F({sketchOptions:t,viewType:i}),selectedVertex:new Hs.d({sketchOptions:t,viewType:i}),translate:new ms.M({sketchOptions:t,viewType:i}),translateXY:new _s({sketchOptions:t,viewType:i}),translateZ:new bs({sketchOptions:t,viewType:i})}}(this._sketchOptions,t),this._vertexManipulatorMaterial=Wr((0,r.QP)(i.color),i.renderOccluded),this._vertexManipulatorOutlineMaterial=qr((0,r.QP)(i.outlineColor),i.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=qr((0,r.QP)(i.hoverOutlineColor),i.renderOccluded);const n=e.edge;this._edgeManipulatorMaterial=Wr((0,r.QP)(n.color),n.renderOccluded),this._edgeManipulatorOutlineMaterial=qr((0,r.QP)(n.outlineColor),n.renderOccluded);const s=e.edgeOffset;this._edgeOffsetManipulatorMaterial=Wr((0,r.QP)(s.color),s.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=Wr((0,r.QP)(s.hoverColor),s.renderOccluded,!1);const o=e.selected;this._selectedManipulatorMaterial=Wr((0,r.QP)(o.color),o.renderOccluded),this._selectedManipulatorOutlineMaterial=qr((0,r.QP)(o.outlineColor),o.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=qr((0,r.QP)(o.hoverOutlineColor),o.renderOccluded),this.tooltip=(0,on.A)((()=>({view:t,options:this._sketchOptions.tooltips}))),this.addHandles([(0,a.watch)((()=>{const t=this._settings.manipulators;return{vertexSettings:t.vertex,edgeSettings:t.edge,edgeOffsetSettings:t.edgeOffset,selectedSettings:t.selected}}),(({vertexSettings:t,edgeSettings:e,edgeOffsetSettings:i,selectedSettings:n})=>{t.applyColor(this._vertexManipulatorMaterial),t.applyOutline(this._vertexManipulatorOutlineMaterial),t.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial),e.applyColor(this._edgeManipulatorMaterial),e.applyOutline(this._edgeManipulatorOutlineMaterial),i.applyColor(this._edgeOffsetManipulatorMaterial),i.applyHover(this._edgeOffsetManipulatorHoverMaterial),n.applyColor(this._selectedManipulatorMaterial),n.applyOutline(this._selectedManipulatorOutlineMaterial),n.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)})),(0,a.watch)((()=>this.object.visible),(t=>{for(const e of this._manipulatorInfos)e.manipulator.available=t,Qs(e)&&(e.edgeManipulator.available=t)})),(0,a.watch)((()=>this._numGrabbing+this._numDragging===0),(t=>this._toggleAutoHideManipulators(t))),(0,a.watch)((()=>({labels:this._segmentLabels,enabled:this._sketchOptions.labels.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:t,enabled:e,edgeOffsetEnabled:i})=>{null!=t&&(t.visible=e,t.edgeDistance=i?"far":"default")}),a.Vh),Gs(this.tooltip,this.object,(()=>this._tooltipsContext)),(0,a.watch)((()=>this.tooltip.mode),((t,e)=>{"input"===e&&"input"!==t&&this._resetTooltip()})),(0,a.on)((()=>this._operations),"vertex-update",(t=>this._updateManipulatorPositions(t.vertices)),{onListenerAdd:()=>this._recreateManipulators()}),(0,a.on)((()=>this._operations?.data),"change",(t=>{"undo"!==t.operation&&"redo"!==t.operation||this._recreateManipulators()}))])}destroy(){this._removeManipulators(),this._updatingHandles.destroy(),this._segmentLabels=(0,o.pR)(this._segmentLabels),this.tooltip=(0,o.pR)(this.tooltip)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get object(){return this.tool.object}get enableZShape(){return this.tool.enableZShape}get enableDeleteVertices(){return this.tool.enableDeleteVertices}get enableZVertex(){return this.tool.enableZVertex}get autoHideManipulators(){return this.tool.autoHideManipulators}get enableMoveObject(){return this.tool.enableMoveObject}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _sketchOptions(){return this.tool.sketchOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}enterInputModeIfAvailable(t){return"key-down"===t.type&&t.key===qs.ac.enterInputMode&&("reshape-edge-offset"===this.activeTooltipInfo?.type?this._enterInputModeDuringEdgeOffset(t):!!(0,on.wG)(t,this.tooltip)&&(this.tool.endDrag(),!0))}removeSelectedVertices(){const t=this._manipulatorInfos.filter((t=>t.manipulator.selected&&"vertex"===t.type));return this._removeVertices(t),t.length}onManipulatorSelectionChanged(){this.events.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll(),this._moveManipulation=(0,o.pR)(this._moveManipulation),this._objectMoveManipulation=(0,o.pR)(this._objectMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}_createManipulators(t){if(null==this._operations)return;const e=this.object.elevationInfo;for(const i of this._operations.data.components){const n=t?.byComponentIndex.get(i.index);for(const t of i.vertices){const i=n?.has(t.index);this._createVertexOrEdgeManipulator(t,e,i)}for(const t of i.edges)this._createVertexOrEdgeManipulator(t,e)}this._createObjectMoveManipulation(),this._createMoveManipulation(e),this._createVisualElements()}get canRedo(){return null!=this._operations&&this._operations.canRedo}get canUndo(){return null!=this._operations&&this._operations.canUndo}redo(){return this._operations?.redo()}undo(){return this.events.emit("undo"),this._operations?.undo()}_recreateManipulators(){if(!this._recreatingManipulators){if(this._recreatingManipulators=!0,this._removeManipulators(),this._resetTooltip(),this._operations&&this._segmentLabels?.context?.editGeometryOperations===this._operations||(this._segmentLabels=(0,o.pR)(this._segmentLabels)),this._createManipulators(),!this._segmentLabels&&this._operations){const t=this._sketchOptions.labels;this._segmentLabels=new W({context:{view:this.view,editGeometryOperations:this._operations,elevationInfo:this.object.elevationInfo,labelOptions:t},visible:t.enabled})}this._recreatingManipulators=!1}}_perObjectManipulatorDragAction(t,e){if("end"===e.action)return e;let i=0;const n=[],r=this._manipulatorInfos.some((t=>"vertex"===t.type&&t.manipulator.selected)),s=t===so.SELECTED_OR_ALL&&r;for(const t of this._manipulatorInfos)"vertex"===t.type&&(t.manipulator.grabbing||s&&!t.manipulator.selected||n.push(t),i++);if(this._moveVertices(n,e),n.length===i){if(this._updateEventState(ro.MOVING),this.destroyed)return e;this.events.emit("move",{type:"move",dx:e.screenDeltaX,dy:e.screenDeltaY,object:this.object})}else{if(this._updateEventState(ro.RESHAPING),this.destroyed)return e;this.events.emit("reshape",{type:"reshape",object:this.object})}return e}_toggleAutoHideManipulators(t){this.autoHideManipulators&&(t?this.removeHandles(Zs):this.tool.manipulators.forEach((({manipulator:t})=>{const e=t.disableDisplay?.();e&&this.addHandles(e,Zs)})))}_isMultiVertexSelection(){return this._manipulatorInfos.reduce(((t,e)=>"vertex"===e.type&&e.manipulator.selected?t+1:t),0)>1}_perVertexManipulatorDragAction(t){if(this._updateEventState(ro.RESHAPING),this.destroyed)return;const{mapDeltaX:e,mapDeltaY:i,mapDeltaZ:n}=t;if(!e&&!i&&!n)return;const r=[];for(const e of this._manipulatorInfos)"vertex"===e.type&&(e.manipulator.selected&&!e.manipulator.grabbing||e===t.info)&&r.push(e);this._moveVertices(r,t,bn.Y.ACCUMULATE_STEPS),this.events.emit("reshape",{type:"reshape",object:this.object})}_updateEventState(t,e={}){if(t===this._reshapeEventState)return!1;switch(t){case ro.NONE:if(!e.forceEnd&&(0!==this._numGrabbing||0!==this._numDragging))return!1;switch(this._reshapeEventState){case ro.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object});break;case ro.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object})}break;case ro.MOVING:switch(this._reshapeEventState){case ro.NONE:this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object});break;case ro.RESHAPING:this.events.emit("reshape",{type:"reshape-stop",object:this.object}),this.destroyed||this.events.emit("move",{type:"move-start",dx:0,dy:0,object:this.object})}break;case ro.RESHAPING:switch(this._reshapeEventState){case ro.NONE:this.events.emit("reshape",{type:"reshape-start",object:this.object});break;case ro.MOVING:this.events.emit("move",{type:"move-stop",dx:0,dy:0,object:this.object}),this.destroyed||this.events.emit("reshape",{type:"reshape-start",object:this.object})}}if(this.destroyed)return!1;const i=this._reshapeEventState!==t;return this._reshapeEventState=t,i}_createObjectMoveManipulation(){const{tool:t,view:e,object:i,_operations:n}=this;if(n){if(this._objectMoveManipulation=new ls({tool:t,view:e,object:i}),this.enableMoveObject){let t=null;this._manipulatorHandles.add(this._objectMoveManipulation.createDragPipeline(((e,i,r)=>{i.next((t=>this._trackNumDragging(t))).next((e=>("start"===e.action&&(t=n.createUndoGroup()),e))).next((t=>this._perObjectManipulatorDragAction(so.ALL,t))).next((t=>(this._updateTranslateObjectTooltip(as.XY,t),t))).next((e=>{"end"===e.action&&(this._resetTooltip(),t=(0,o.xt)(t))})),r.next((()=>this._onDragCancel(!0,(()=>t=(0,o.xt)(t)))))}))),this._objectMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(t,!1))))}else this._objectMoveManipulation.forEachManipulator((t=>{t.grabbable=!1,t.cursor=null}));this._objectMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(t.events.on("immediate-click",(t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...t,object:this.object}),t.stopPropagation()})))))}}_createMoveManipulation(t){const{object:e,tool:i,view:n,_operations:r}=this;if(!r)return;this._moveManipulation=new ss({tool:i,view:n,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&_n(e.operations,e.elevationInfo),snapToScene:!1,radius:ss.radiusForSymbol(e.graphic?.symbol)}),this._moveManipulation.forEachManipulator((t=>this.addHandles([t.events.on("immediate-click",(e=>{this._moveManipulation.zManipulation.hasManipulator(t)||this._manipulatorInfos.some((t=>t.manipulator.selected))||this.events.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()})),this._watchAndUpdateGrabState(t,!1)])));const s=t=>e=>{this.addHandles([e.events.on("focus-changed",(({action:e})=>{"focus"===e?this._updateTranslateTooltip(t):this._resetTooltip()}))])};this._moveManipulation.xyManipulation.forEachManipulator(s(as.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(s(as.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(s(as.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const o=r.data.spatialReference;this.addHandles([this._moveManipulation.createDragPipeline(((n,s,o,a,h)=>{const{snappingStep:l,cancelSnapping:c}=(0,gs.L)({predicate:t=>!!t.info,snappingManager:i.snappingManager,snappingContext:new ps.e({editGeometryOperations:r,elevationInfo:t,pointer:h,excludeFeature:e.graphic,visualizer:new Qe}),updatingHandles:this._updatingHandles,useZ:!1});return a=a.next((t=>(this._onDragCancel(),t))).next(c),{steps:o=o.next((t=>this._trackNumDragging(t))).next((t=>{const e=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));return t.manipulatorType===hr.TRANSLATE_XY&&1===e.length?{...t,info:e[0],snapOrigin:e[0].handle.pos}:t})).next((0,Ir.pg)(this.view,t,e.graphic??void 0)).next(...l).next((0,Ir.EX)()).next((t=>this._perObjectManipulatorDragAction(so.SELECTED_OR_ALL,t))).next((t=>(this._updateTranslateTooltip(n,t),t))),cancel:a}}),t,o,e.graphic),(0,a.watch)((()=>e.visible),(()=>this._updateMoveManipulationPosition()),a.Vh),e.on("committed",(()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()})),(0,a.watch)((()=>e.isDraped),(t=>{this._updateMoveManipulationPosition();const e="align-move-manipulation";t?this.addHandles(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),e):this.removeHandles(e)}),a.Vh)])}_createVisualElements(){const{object:t,view:e}=this,i=br({view:e,object:t,forEachManipulator:t=>{if(!this.destroyed&&!this._recreatingManipulators){this._objectMoveManipulation.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);for(const e of this._manipulatorInfos)t(e.manipulator,hr.TRANSLATE_XY)}},onManipulatorsChanged:t=>this.events.on("manipulators-changed",t)});null!=i&&(this._outlineVisualElement=i.visualElement instanceof Mi?i.visualElement:null);const n=this._outlineVisualElement;if(null!=n){const e=()=>{t.isDraped||this._updateMoveManipulationPosition()};this._manipulatorHandles.add((0,a.on)((()=>n.events),"attachment-origin-changed",e,{onListenerAdd:e}))}this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(t,e=this.object.elevationInfo){const i=this.view,n=this._operations;if(t.component.vertices.length<=2||!n)return null;const r=n.data.spatialReference,o=this._settings.manipulators.edgeOffset,a=o.size/2,h=a+o.collisionPadding,l=a/h,c=l/2,u=l*Math.sqrt(3)/2,{height:f,offset:p}=o,g=this._edgeOffsetManipulatorMaterial;if(!this._edgeOffsetManipulatorGeometryInside){const t=(0,ee._B)(g,u,c,c,f,p);this._edgeOffsetManipulatorGeometryInside=t}if(!this._edgeOffsetManipulatorGeometryOutside){const t=(0,ee._B)(g,-u,c,c,f,-p);this._edgeOffsetManipulatorGeometryOutside=t}const v=[new Cr(this._edgeOffsetManipulatorGeometryInside.instantiate(),Gn.p7.Unfocused),new Cr(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),Gn.p7.Focused),new Cr(this._edgeOffsetManipulatorGeometryOutside.instantiate(),Gn.p7.Unfocused),new Cr(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),Gn.p7.Focused)],m=new Un({view:i,renderObjects:v,elevationInfo:"on-the-ground"!==e.mode||(0,Is.$d)(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:e,worldOriented:!1,focusMultiplier:1,radius:h,available:this.object.visible,collisionType:{type:"disc",direction:(0,d.fA)(0,0,1)},collisionPriority:1,metadata:{deleting:!1},location:Js(r)}),y=new Un({view:i,worldSized:!0,worldOriented:!1,available:this.object.visible,collisionPriority:-10,cursor:this.enableMoveObject?"move":"default",metadata:{deleting:!1},location:Js(r)}),_={manipulator:m,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:y,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(_,o.minSquaredEdgeLength);const b=()=>this._updateEdgeOffsetManipulator(_);b(),_.locationUpdateHandle=(0,s.vE)([t.leftVertex,t.rightVertex].map((t=>{const e=this._getManipulatorInfoFromHandle(t);return e?.manipulator.events.on("location-update",b)})));const w=t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.events.emit("immediate-click",{...t,object:this.object}),t.stopPropagation()};return this._manipulatorHandles.add([_.locationUpdateHandle,this._watchAndUpdateGrabState(m,!0),this._watchAndUpdateGrabState(y,!0),(0,Ir.Xt)(m,this._createEdgeOffsetPipeline(_,e,n)),(0,Ir.Xt)(y,this._createEdgePipeline(_,e,n)),y.events.on("immediate-click",w),m.events.on("immediate-click",w),m.events.on("focus-changed",(()=>this._resetTooltip())),m.events.on("grab-changed",(({screenPoint:t,action:e})=>{_.grabMapPoint="start"===e?js(t,this.view,this.object,_):null}))],m),this._manipulatorInfos.push(_),this.manipulators.addMany([m,y]),this.events.emit("manipulators-changed"),_}_autoHideEdgeOffsetManipulator(t,e){const i=t.manipulator,n=t.edgeManipulator,r=()=>{t.visibilityHandle=(0,o.xt)(t.visibilityHandle);const r=this._getManipulatorInfoFromHandle(t.handle.leftVertex),a=this._getManipulatorInfoFromHandle(t.handle.rightVertex),h=null!=r&&null!=a&&function(t,e,i){const n=i.projectToRenderScreen(t,(0,g.r_)()),r=i.projectToRenderScreen(e,(0,g.r_)());return null!=n&&null!=r?(0,u.k)((0,u.d)(n,n,r)):0}(r.manipulator.renderLocation,a.manipulator.renderLocation,this.view.state.camera)<e;(!i.focused&&!n.focused||h)&&(i.grabbable=!h,n.grabbable=!h,t.visibilityHandle=(0,s.vE)([i.disableDisplay(),(0,s.hA)((()=>{i.grabbable=!0,n.grabbable=this.enableMoveObject}))]))};this._manipulatorHandles.add([i.events.on("focus-changed",r),n.events.on("focus-changed",r),(0,s.hA)((()=>{(0,o.xt)(t.visibilityHandle),n.metadata.deleting=!0,this.manipulators.remove(n)}))],i),r()}_updateEdgeOffsetManipulator(t){if(!this._operations)return;this._updateManipulatorPosition(t);const{coordinateHelper:e}=this._operations.data,i=Ls(this.view,t.manipulator.elevationAlignedLocation,Ds(e,t.handle,t.manipulator.elevationInfo)),n=this._getManipulatorInfoFromHandle(t.handle.leftVertex),r=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==n||null==r)return;const s=n.manipulator.renderLocation,o=r.manipulator.renderLocation,a=null!=i?function(t,e,i){const n=(0,zn.Qj)(t),r=(0,u.o)((0,d.vt)(),e,i),s=(0,u.e)((0,d.vt)(),r,n),o=(0,u.e)((0,d.vt)(),r,s);return(0,Re.fA)(r[0],r[1],r[2],0,s[0],s[1],s[2],0,o[0],o[1],o[2],0,0,0,0,1)}(i,s,o):Re.zK;t.manipulator.modelTransform=a,t.edgeManipulator.elevationAlignedLocation=t.manipulator.elevationAlignedLocation,t.edgeManipulator.modelTransform=a;const h=(0,u.l)((0,u.d)(eo,s,o))/2;t.edgeManipulator.collisionType={type:"line",paths:[[[-h,0,0],[h,0,0]]]}}_createEdgePipeline(t,e,i){return(n,r,s,o)=>{if("touch"===o)this._createEdgeOffsetPipeline(t,e,i)(n,r,s);else if(this.enableMoveObject){const t=this.object.graphic,o=i.data.spatialReference,{elevationAlignedLocation:a}=n;r.next((t=>this._trackNumDragging(t))).next((0,Ir.Tp)(this.view,a)).next(Dr(this.view,a,e,o,t)).next((0,Ir.sO)()).next((0,Ir.EX)()).next((t=>this._perObjectManipulatorDragAction(so.ALL,t))).next((t=>(this._updateTranslateObjectTooltip(as.XY,t),t))).next((t=>{"end"===t.action&&this._resetTooltip()})),s.next((()=>this._onDragCancel(!n.metadata.deleting)))}}}_createEdgeOffsetPipeline(t,e,i){return(n,r,s)=>{const o=this._pendingEdgeOffsetInfo;if(o?.manipulatorInfo===t&&"drag"!==o.mode)return void s.execute({action:"cancel"});this._clearSelection();const{initializeStep:a,cleanup:h}=this._initializeEdgeOffset(t,e,i,s),l=this._applyEdgeOffsetStep(t);r.next((t=>this._trackNumDragging(t))).next((0,Ir.Tp)(this.view,n.elevationAlignedLocation)).next(a).next(function(t){return Nr(t,(t=>t.plane))}(this.view)).next(zr(this.view,i.data.spatialReference)).next((0,Ir.EX)()).next((t=>{const{operation:e,mapEnd:i}=t;return null==e||null==i?t:{...t,signedDistance:e.signedDistanceToPoint(i)}})).next((t=>this._pendingEdgeOffsetInfo?t:l(t))).next((t=>{"end"!==t.action||this._pendingEdgeOffsetInfo||h()})),s.next((()=>{this._exitEdgeOffsetInputMode(),n.metadata.deleting||(h(),this._onDragCancel())}))}}_initializeEdgeOffset(t,e,i,n){const{view:r,object:a}=this,h=Ds(i.data.coordinateHelper,t.handle,e),l=i.createUndoGroup(),c=Ls(r,t.manipulator.elevationAlignedLocation,h);let u;this._splitEdgesBeforeEdgeOffset(t,h),this._selectEdgeOffsetArrow(t,h);const d=()=>{this._cleanEdgeOffsetCollapsedEdges(t,i),u=(0,o.xt)(u)},f=this.events.on("undo",d);return u=(0,s.vE)([this._initializeEdgeOffsetVisualElement(t,a,e,i),l,f,this._connectEdgeOffsetTooltip(t,h,i,(()=>{n.execute({action:"cancel"})}))]),{initializeStep:t=>null==h||null==c?(d(),null):{...t,operation:h,plane:c},cleanup:d}}_initializeEdgeOffsetVisualElement(t,e,i,n){const o=()=>new Os.A({paths:[[t.handle.leftVertex.pos,t.handle.rightVertex.pos]],spatialReference:n.data.spatialReference}),h=new Mi({view:this.view,isDraped:e.isDraped,geometry:o(),elevationInfo:i,width:this._settings.visualElements.lineObjects.outline.width,attached:!1,isDecoration:!0}),l=(0,s.vE)([(0,a.watch)((()=>({color:this._accentColor,draped:e.isDraped})),(({color:t,draped:e})=>{h.color=(0,r.QP)(t),h.isDraped=e}),a.pc),e.on("committed",(()=>{h.geometry=o()})),(0,s.DQ)(h)]);return h.attached=!0,l}_applyEdgeOffsetStep(t){return e=>(this.destroyed||null==e.operation||!this._operations||(this._updateEventState(ro.RESHAPING),null==e.signedDistance?this._resetTooltip():((e.mapDeltaX||e.mapDeltaY||e.mapDeltaZ)&&(this._offsetEdge(t,e.operation,e.signedDistance),this.events.emit("reshape",{type:"reshape",object:this.object})),this._updateEdgeOffsetTooltip(e))),e)}_cleanEdgeOffsetCollapsedEdges(t,e){const i=t.handle.leftVertex.leftEdge?.leftVertex,n=t.handle.leftVertex,r=t.handle.rightVertex.rightEdge?.rightVertex,s=t.handle.rightVertex,o=e.data.coordinateHelper,a=this.view.pixelSizeAt(o.vectorToDehydratedPoint(n.pos),o.spatialReference),h=[];if(i&&o.distance(i.pos,n.pos)<io){const t=this._getManipulatorInfoFromHandle(n);null!=t&&h.push(t)}if(o.distance(n.pos,s.pos)<a||r&&o.distance(r.pos,s.pos)<io){const t=this._getManipulatorInfoFromHandle(s);null!=t&&h.push(t)}h.length&&this._removeVertices(h)}_enterInputModeDuringEdgeOffset(t){const e=this._findActiveEdgeOffsetManipulatorInfo();return!(!e||!(0,on.wG)(t,this.tooltip)||(e.manipulator.dragging?(this._pendingEdgeOffsetInfo={manipulatorInfo:e,mode:"drag"},0):(this._clearSelection(),this._pendingEdgeOffsetInfo={manipulatorInfo:e,mode:"hover"},this._connectEdgeOffsetTooltipOnHover(e),0)))}_exitEdgeOffsetInputMode(){this.tooltip&&(this._pendingEdgeOffsetInfo=null,this._resetTooltip(),this.tooltip.exitInputMode())}_findActiveEdgeOffsetManipulatorInfo(){return this._manipulatorInfos.filter(Qs).find((({manipulator:t})=>t.hovering||t.grabbing||t.dragging))}_connectEdgeOffsetTooltipOnHover(t){const{_operations:e,object:i}=this;if(!e)return;const{elevationInfo:n}=i,r=Ds(e.data.coordinateHelper,t.handle,n);this._selectEdgeOffsetArrow(t,r),this.addHandles([this._initializeEdgeOffsetVisualElement(t,i,n,e),this._connectEdgeOffsetTooltip(t,r,e,(()=>{this.removeHandles(r),this._exitEdgeOffsetInputMode()}))],r)}_splitEdgesBeforeEdgeOffset(t,e){if(e.requiresSplitEdgeLeft){const e=this._getManipulatorInfoFromHandle(t.handle.leftVertex.leftEdge);null!=e&&this._splitEdgeManipulator(e,1)}if(e.requiresSplitEdgeRight){const e=this._getManipulatorInfoFromHandle(t.handle.rightVertex.rightEdge);null!=e&&this._splitEdgeManipulator(e,0)}}_selectEdgeOffsetArrow(t,e){const i=t.grabMapPoint??js(this.view.inputManager?.latestPointerLocation,this.view,this.object,t);i&&e.selectArrowFromStartPoint(i)}_connectEdgeOffsetTooltip(t,e,i,n){const r=()=>this.tooltipInfos.edgeOffset.distance.actual,o=r=>{n(),queueMicrotask((()=>{this.view.focus();const n=i.createUndoGroup();this._tooltipCallbacks.onReshapeStart?.(),this._splitEdgesBeforeEdgeOffset(t,e),this._offsetEdge(t,e,function(t,e,i,{data:{coordinateHelper:n,spatialReference:r}}){const s=(0,fn.l3)(t,"meters"),o=(0,x.GA)(r),a=Math.sign(s*i.selectedArrow),h=(0,Ps.Xn)(r),l=(0,zn.Qj)(i.plane),c=n.pointToXYZ(e),f=(0,d.vt)();(0,u.b)(f,c,l,a*(10/o));const p=s*i.selectedArrow/o;if(!h||!(0,Z.F)(c,r,c,h)||!(0,Z.F)(f,r,f,h))return p;const g=new Ps.Zj;if((0,Ps._3)(g,c,f,h),(0,Ps.vN)(f,c,g.azimuth,s,h),!(0,Z.F)(f,h,f,r))return p;const v=f[0]-e.x,m=f[1]-e.y,y=Math.sqrt(v*v+m*m)*a,[_,b]=l,w=Math.sqrt(_*_+b*b);return 0===w?0:y/w}(r,t.manipulator.location,e,i)),this._tooltipCallbacks.onReshape?.(),this._tooltipCallbacks.onReshapeStop?.(),this._cleanEdgeOffsetCollapsedEdges(t,i),n.remove()}))},h=()=>{const t=r();null!=t?o(t):n()};return(0,s.vE)([(0,a.when)((()=>this.tooltip&&!this.tooltip.focused),(()=>h()),a.OH),this.tooltip.on("discard",n),this.tooltip.on("commit",(t=>{"commit-and-exit"===t.type&&h()}))])}_createVertexOrEdgeManipulator(t,e=this.object.elevationInfo,i=!1){const n=this.view,r=this._operations,a=this._settings;if(!r)return null;const h=r.data.type,l=r.data.spatialReference;if("edge"===t.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(t,e);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const{size:t,outlineSize:e}=Xs(a.manipulators.vertex);this._vertexManipulatorGeometry=(0,ee.CM)(this._vertexManipulatorMaterial,t,16,16),this._vertexManipulatorOutlineGeometry=(0,ee.CM)(this._vertexManipulatorOutlineMaterial,e,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const{size:t,outlineSize:e}=Xs(a.manipulators.edge);this._edgeManipulatorGeometry=(0,ee.CM)(this._edgeManipulatorMaterial,t,16,16),this._edgeManipulatorOutlineGeometry=(0,ee.CM)(this._edgeManipulatorOutlineMaterial,e,16,16)}const c="point"===h||"mesh"===h?[]:[new Cr(this._vertexManipulatorGeometry.instantiate(),no.Vertex|Gn.p7.Unselected),new Cr(this._vertexManipulatorOutlineGeometry.instantiate(),no.Vertex|Gn.p7.Unfocused|Gn.p7.Unselected),new Cr(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),no.Vertex|Gn.p7.Focused|Gn.p7.Unselected),new Cr(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),Gn.p7.Selected),new Cr(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),Gn.p7.Selected|Gn.p7.Unfocused),new Cr(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),Gn.p7.Selected|Gn.p7.Focused)];this.enableMidpoints&&c.push(new Cr(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),no.Edge|Gn.p7.Focused|Gn.p7.Unselected),new Cr(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),no.Edge|Gn.p7.Focused|Gn.p7.Unselected),new Cr(this._edgeManipulatorGeometry.instantiate(),no.Edge|Gn.p7.Unfocused|Gn.p7.Unselected),new Cr(this._edgeManipulatorOutlineGeometry.instantiate(),no.Edge|Gn.p7.Unfocused|Gn.p7.Unselected));const u=new Un({view:n,renderObjects:c,elevationInfo:e,focusMultiplier:1,touchMultiplier:1,available:this.object.visible,metadata:{deleting:!1},location:Js(l)});u.selected=i,this._setTypeSpecificManipulatorSettings(u,t,e);const d="edge"===t.type?{manipulator:u,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:u,handle:t,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(d),this.manipulators.add(u),this._updateManipulatorPosition(d),"edge"===d.type){const t=[];for(const e of[d.handle.leftVertex,d.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(e);null!=i&&t.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(d))))}d.locationUpdateHandle=(0,s.vE)(t),this._manipulatorHandles.add(d.locationUpdateHandle,u)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(u,!0),u);const f=(0,Ir.Xt)(u,((t,i,s,a)=>{let h=null;const{snappingStep:c,cancelSnapping:u}=(0,gs.L)({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new ps.e({editGeometryOperations:r,elevationInfo:e,pointer:a,excludeFeature:this.object.graphic,visualizer:new Qe}),updatingHandles:this._updatingHandles,useZ:!1});s=s.next((e=>(this._onDragCancel(!t.metadata.deleting,(()=>h=(0,o.xt)(h))),e))).next(u);const{elevationAlignedLocation:f}=t,p=this.object.graphic??void 0;i.next((t=>this._trackNumDragging(t))).next((t=>{if("start"===t.action&&r&&(h=r.createUndoGroup()),"edge"===d.type){const e=this._splitEdgeManipulator(d);return{...t,info:e,snapOrigin:e.handle.pos}}return{...t,info:d,snapOrigin:d.handle.pos}})).next((0,Ir.Tp)(n,f)).next(Dr(n,f,e,l,p)).next((0,Ir.pg)(n,e,p)).next(...c).next((0,Ir.EX)()).next((t=>{this._perVertexManipulatorDragAction(t),"end"===t.action&&(h=(0,o.xt)(h)),this._resetTooltip()}))}));return this._manipulatorHandles.add([f,u.events.on("immediate-click",(t=>this._manipulatorClickCallback(t,d))),u.events.on("select-changed",(()=>{d.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition(),this._resetTooltip()})),u.events.on("focus-changed",(()=>{this._resetTooltip()}))],u),this.events.emit("manipulators-changed"),d}_trackNumDragging(t){switch(t.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return t}_onDragCancel(t=!0,e){switch(this._numDragging--,t&&this.undo(),this.tool.snappingManager?.doneSnapping(),this._resetTooltip(),this._reshapeEventState){case ro.NONE:break;case ro.MOVING:this.events.emit("move",{type:"move",dx:0,dy:0,object:this.object});break;case ro.RESHAPING:this.events.emit("reshape",{type:"reshape",object:this.object})}e?.(),this.destroyed||this._updateEventState(ro.NONE)}_setTypeSpecificManipulatorSettings(t,e,i){const n=this._settings;switch(e.type){case"vertex":{t.state=no.Vertex,t.selectable=!0,t.cursor="move",t.collisionPriority=2;const{size:e,collisionPadding:r}=n.manipulators.vertex;t.radius=e/2+r,t.elevationInfo=i;const s=this._operations?.data.type;t.interactive=null!=s&&"point"!==s&&"mesh"!==s;break}case"edge":{t.state=no.Edge,t.selectable=!1,t.cursor="copy",t.collisionPriority=-1;const{size:e,collisionPadding:r}=n.manipulators.edge;t.radius=e/2+r,t.elevationInfo="on-the-ground"!==i.mode||(0,Is.$d)(this.object.graphic?.symbol)?{mode:"absolute-height",offset:0}:i;break}}}_watchAndUpdateGrabState(t,e){return t.events.on("grab-changed",(i=>{this._onGrabStateChanged(t,e,i.action,i.pointerType)}))}_onGrabStateChanged(t,e,i,n="mouse"){if(!this._recreatingManipulators){if("start"===i)e&&this._updateSelection(t),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(ro.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==n||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((t=>{const{manipulator:e}=t,i=this._operations?.data.type;e.interactive=e.grabbing||!this._numGrabbing&&null!=i&&"point"!==i&&"mesh"!==i,Qs(t)&&(t.edgeManipulator.interactive=t.edgeManipulator.grabbing||!this._numGrabbing)})),this._objectMoveManipulation.forEachManipulator((t=>{t.interactive=t.grabbing||!this._numGrabbing})))}}_clearSelection(){for(const t of this._manipulatorInfos)t.manipulator.grabbing||(t.manipulator.selected=!1);this._pendingEdgeOffsetInfo=null}_updateSelection(t){t.grabbing&&!t.selected&&t.selectable&&(this._clearSelection(),t.selected=!0,this.events.emit("manipulators-changed"))}_removeManipulator(t){null!=t&&(t.manipulator.metadata.deleting=!0,this.manipulators.remove(t.manipulator),this._manipulatorHandles.remove(t.manipulator),(0,un.Xy)(this._manipulatorInfos,t),this.events.emit("manipulators-changed"),this._resetTooltip())}_getManipulatorInfoFromHandle(t){if(t)for(const e of this._manipulatorInfos)if(t===e.handle)return e;return null}_updateManipulatorPositions(t){for(const e of t)this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e))}_updateManipulatorPosition(t){const e=this._operations;if(null!=t&&e)if("vertex"===t.type)t.manipulator.location=e.data.coordinateHelper.vectorToDehydratedPoint(t.handle.pos,to),t.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=t.manipulator.renderLocation);else if("edge"===t.type){const i=this._getManipulatorInfoFromHandle(t.handle.leftVertex),n=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==i||null==n)return;const r=i.manipulator,s=n.manipulator;if("on-the-ground"===t.manipulator.elevationInfo?.mode){const i=r.location,n=s.location,o=.5,a=i.x+o*(n.x-i.x),h=i.y+o*(n.y-i.y),l=i.hasZ&&n.hasZ?0:void 0;t.manipulator.location=(0,ge.T)(a,h,l,e.data.spatialReference)}else(0,u.m)(eo,r.renderLocation,s.renderLocation,.5),t.manipulator.renderLocation=eo}}_splitEdgeManipulator(t,e=.5){const i=this._operations,n=i.splitEdge(t.handle,e).createdVertex;t.locationUpdateHandle=(0,o.xt)(t.locationUpdateHandle);const r=this.object.elevationInfo;let s;this.enableEdgeOffset?(this._removeManipulator(t),s=this._createVertexOrEdgeManipulator(n)):(s=t,s.handle=n,s.type="vertex",this._setTypeSpecificManipulatorSettings(t.manipulator,t.handle,r)),n.leftEdge&&this._createVertexOrEdgeManipulator(n.leftEdge),n.rightEdge&&this._createVertexOrEdgeManipulator(n.rightEdge),this._updateManipulatorPosition(s),this.enableEdgeOffset||this._resetTooltip(),this._updateSelection(t.manipulator);const a=this._updateEventState(ro.RESHAPING),h=i.data.coordinateHelper.vectorToArray(s.handle.pos),l=i.data.components.indexOf(n.component);return this.events.emit("vertex-add",{type:"vertex-add",object:this.object,vertices:[{coordinates:h,componentIndex:l,vertexIndex:n.index}],added:h}),a&&this._updateEventState(ro.NONE),s}_updateMoveManipulationPosition(){const t=(0,u.i)(eo,0,0,0);let e=0,i=!1,n=null,r=null;for(const s of this._manipulatorInfos)"vertex"===s.type&&(s.manipulator.selected?(e++,(0,u.g)(t,t,s.manipulator.renderLocation),null==n||s.selectedIndex>n.selectedIndex?(r=n,n=s):(null==r||s.selectedIndex>r.selectedIndex)&&(r=s)):i=!0);const s=this.object,o=this._operations?.data.geometry;if(0===e){const t=s.visible&&this.enableMoveObject;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t,this._moveManipulation.zManipulation.available=t&&this.enableZShape&&_n(this._operations,s.elevationInfo),this._moveManipulation.angle=vn(o),this._moveManipulation.radius=ss.radiusForSymbol(s.graphic?.symbol)}else{const t=s.visible;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.zManipulation.available=t&&this.enableZVertex&&_n(this._operations,this.object.elevationInfo),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t&&1!==e;let i=0;if(null!=n){const t=n.handle.pos,e=null!=r?r.handle.pos:n.handle.leftEdge?.leftVertex?n.handle.leftEdge.leftVertex.pos:null,s=null==r&&n.handle.rightEdge?.rightVertex?n.handle.rightEdge.rightVertex.pos:null;e&&s?this._moveManipulation.xyAxisManipulation.available=!1:e?i=Ks(e,t):s&&(i=Ks(t,s))}this._moveManipulation.angle=i,this._moveManipulation.radius=xr}0!==e&&i?((0,u.h)(t,t,1/e),to.spatialReference=this._operations.data.spatialReference,to.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(t,to),this._moveManipulation.elevationAlignedLocation=to):null==this._outlineVisualElement||this.object.isDraped||null==this._outlineVisualElement.attachmentOrigin?Jr(this._moveManipulation,this.object):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(t){const e=new Array,i=this._operations;if(i){for(const n of t){const t=n.handle.component;if("vertex"===n.type&&i.canRemoveVertex(t)){e.push(n.handle),this._removeManipulator(n),this._removeManipulator(this._getManipulatorInfoFromHandle(n.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(n.handle.rightEdge));const r=i.removeVertices([n.handle]),s=r.removedVertices?.[0].createdEdge;s?this._createVertexOrEdgeManipulator(s):this.enableEdgeOffset&&t.vertices.length<=2&&this._removeManipulator(this._getManipulatorInfoFromHandle(t.edges[0]))}}if(e.length>0){const t=e.map((t=>{const e=i.data.components.indexOf(t.component);return{coordinates:i.data.coordinateHelper.vectorToArray(t.pos),componentIndex:e,vertexIndex:t.index}})),n=this._updateEventState(ro.RESHAPING);if(this.destroyed)return;if(this.events.emit("vertex-remove",{type:"vertex-remove",object:this.object,removed:t.map((t=>t.coordinates)),vertices:t}),this.destroyed)return;if(n&&(this._updateEventState(ro.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}}_moveVertices(t,e,i=("start"===e.action?bn.Y.NEW_STEP:bn.Y.ACCUMULATE_STEPS)){const n=this._operations;if(n){t.length>0&&n.moveVertices(t.map((t=>t.handle)),e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i);for(const e of t)this._updateManipulatorPosition(e)}}_offsetEdge(t,e,i){if(!this._operations)return;const n=e.clone();n.distance=i,this._operations.updateVertices([t.handle.leftVertex,t.handle.rightVertex],n),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.rightVertex))}_manipulatorClickCallback(t,e){t.shiftKey||this._clearSelection(),"vertex"===e.type&&(e.manipulator.selected=!e.manipulator.selected,this.enableDeleteVertices&&t.button===Ws.w.Right&&this._removeVertices([e])),"edge"===e.type&&t.button===Ws.w.Left&&this._splitEdgeManipulator(e),t.stopPropagation()}_updateTranslateTooltip(t,e){null!=this._defaultTooltipInfo?this._resetTooltip():this._updateTranslateObjectTooltip(t,e)}_updateTranslateObjectTooltip(t,e){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=function(t,e,{sketchOptions:i,tooltipInfos:n}){let r=null;switch(t){case as.XY:r=n.translate,Us(r,e,((t,e)=>(0,L.Kt)(t,e)));break;case as.XY_AXIS:r=n.translateXY,Us(r,e,((t,i)=>(0,fn.hs)((0,L.Kt)(t,i),Br(e))));break;case as.Z:r=n.translateZ,Us(r,e,wn.e5)}return r.sketchOptions=i,r}(t,e,this._tooltipsContext))}_updateEdgeOffsetTooltip(t){this._pendingEdgeOffsetInfo||(this.activeTooltipInfo=$s(this.object,t,this._tooltipsContext))}_resetTooltip(){const t=this.activeTooltipInfo;if(this._pendingEdgeOffsetInfo&&"reshape-edge-offset"===t?.type)return;let e=null;e=this._pendingEdgeOffsetInfo||null!=this._findActiveEdgeOffsetManipulatorInfo()?$s(this.object,null,this._tooltipsContext):this._defaultTooltipInfo,e!==t&&(null!=t&&null!=e&&"input"===this.tooltip.mode||(this.activeTooltipInfo=e))}get _defaultTooltipInfo(){const t=this._operations?.data.type;switch(t){case"polyline":case"polygon":return this._selectedVertexManipulatorInfo?this.tooltipInfos.selectedVertex:null;case"point":case"mesh":return this.tooltipInfos.movePoint;default:return null}}get _selectedVertexManipulatorInfo(){const t=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));return 1===t.length?t[0]:null}get _tooltipsContext(){return{sketchOptions:this._sketchOptions,tooltipInfos:this.tooltipInfos,activeTooltipInfo:this.activeTooltipInfo,selectedVertexManipulatorInfo:this._selectedVertexManipulatorInfo,callbacks:this._tooltipCallbacks}}get test(){}};function Xs(t){const e=t.size/2,i=e+t.collisionPadding;return{size:e/i,outlineSize:(e+t.outlineSize)/i}}function Ks(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])+Math.PI/2}function Js(t){return new Vn.default({x:0,y:0,z:0,spatialReference:t})}function Qs(t){return"edge"===t.type&&"edgeManipulator"in t}(0,n._)([(0,h.MZ)()],Ys.prototype,"_numGrabbing",void 0),(0,n._)([(0,h.MZ)()],Ys.prototype,"_numDragging",void 0),(0,n._)([(0,h.MZ)()],Ys.prototype,"_pendingEdgeOffsetInfo",void 0),(0,n._)([(0,h.MZ)()],Ys.prototype,"_operations",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"_segmentLabels",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],Ys.prototype,"tool",void 0),(0,n._)([(0,h.MZ)()],Ys.prototype,"tooltip",void 0),(0,n._)([(0,h.MZ)()],Ys.prototype,"activeTooltipInfo",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Ys.prototype,"updating",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"manipulators",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"view",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"object",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableZShape",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableDeleteVertices",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableZVertex",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"autoHideManipulators",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableMoveObject",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableMidpoints",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"enableEdgeOffset",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"_sketchOptions",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"_accentColor",null),(0,n._)([(0,h.MZ)()],Ys.prototype,"_tooltipsContext",null),Ys=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.reshape.ReshapeOperation")],Ys);const to=(0,ge.T)(0,0,void 0,Rs.A.WGS84),eo=(0,d.vt)(),io=1e-6;var no,ro,so;!function(t){t.Vertex=Gn.SJ.Custom1,t.Edge=Gn.SJ.Custom2}(no||(no={})),function(t){t[t.NONE=0]="NONE",t[t.MOVING=1]="MOVING",t[t.RESHAPING=2]="RESHAPING"}(ro||(ro={})),function(t){t[t.ALL=0]="ALL",t[t.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(so||(so={}));let oo=class extends us.g{constructor(t){super(t),this._reshapeOperation=null,this.events=new wi.A,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveObject=!0,this.enableDeleteVertices=!0,this.autoHideManipulators=!1,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.sketchOptions=new fs.A,this.snappingManager=null,this.automaticManipulatorSelection=!1}initialize(){const t=this._reshapeOperation=new Ys({tool:this});this.addHandles([t.events.on("reshape",(t=>this.events.emit("reshape",t))),t.events.on("move",(t=>this.events.emit("move",t))),t.events.on("vertex-add",(t=>this.events.emit("vertex-add",t))),t.events.on("vertex-remove",(t=>this.events.emit("vertex-remove",t))),t.events.on("immediate-click",(t=>this.events.emit("immediate-click",{...t,object:this.object}))),this.view.on("pointer-down",["Shift"],(t=>t.stopPropagation()))]),this.finishToolCreation()}destroy(){this._reshapeOperation=(0,o.pR)(this._reshapeOperation)}get updating(){return((this.object.updating??!1)||this._reshapeOperation?.updating)??!1}get activeTooltipInfo(){return this._reshapeOperation?.activeTooltipInfo??null}get tooltip(){return this._reshapeOperation?.tooltip??null}onManipulatorSelectionChanged(){this._reshapeOperation?.onManipulatorSelectionChanged()}get canUndo(){return this._reshapeOperation?.canUndo??!1}undo(){this.snappingManager?.doneSnapping(),this._reshapeOperation?.undo()}get canRedo(){return this._reshapeOperation?.canRedo??!1}redo(){this.snappingManager?.doneSnapping(),this._reshapeOperation?.redo()}onInputEvent(t){const e=this._reshapeOperation;e&&!e.enterInputModeIfAvailable(t)&&this.enableDeleteVertices&&"key-down"===t.type&&qs.NE.delete.includes(t.key)&&e.removeSelectedVertices()>0&&t.stopPropagation()}reset(){}};(0,n._)([(0,h.MZ)()],oo.prototype,"_reshapeOperation",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"view",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],oo.prototype,"object",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableZShape",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableZVertex",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableMoveObject",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableDeleteVertices",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"autoHideManipulators",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableMidpoints",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"enableEdgeOffset",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"type",void 0),(0,n._)([(0,h.MZ)({type:fs.A})],oo.prototype,"sketchOptions",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"snappingManager",void 0),(0,n._)([(0,h.MZ)()],oo.prototype,"updating",null),(0,n._)([(0,h.MZ)()],oo.prototype,"activeTooltipInfo",null),(0,n._)([(0,h.MZ)()],oo.prototype,"tooltip",null),(0,n._)([(0,h.MZ)()],oo.prototype,"automaticManipulatorSelection",void 0),oo=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.reshape.ReshapeTool3D")],oo);var ao=i(26133);let ho=class extends y.A{constructor(t){super(t),this._interactionState=null}initialize(){this.addHandles([(0,a.when)((()=>{const t=this._interactionState;return t&&t.angle!==t.previousAngle?{interactionState:t,angle:t.state.angle}:null}),(({interactionState:t})=>{this._updateMeshRotation(t)}),a.OH),(0,a.when)((()=>{const t=this._interactionState;return t&&t.scale!==t.previousScale?{interactionState:t,scale:t.state.scale}:null}),(({interactionState:t})=>{this._updateMeshSize(t)}),a.OH)])}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const t=this.geometry.transform;if(null==t)return this._interactionState?.angle??0;const e=(0,ao.yo)(t.rotation)[2];return Math.abs(e)>.999999?(0,b.kU)((0,ao.g7)(t.rotation))*Math.sign(e):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const t=new lo({angle:this.angle});this._interactionState=t;const e=()=>{this._interactionState=null};return{state:t,done:e,cancel:()=>{t.cancel(),e()}}}createUndoRecord(){return this.object.createUndoRecord()}_updateMeshRotation(t){const{angle:e,previousAngle:i}=t;t.previousAngle=e;const n=(0,b.KJ)(e-i);this.geometry.rotate(0,0,n)}_updateMeshSize(t){const{scale:e,previousScale:i}=t;t.previousScale=e;const n=e/i;this.geometry.scale(n)}};(0,n._)([(0,h.MZ)({constructOnly:!0})],ho.prototype,"object",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],ho.prototype,"geometry",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],ho.prototype,"viewingMode",void 0),(0,n._)([(0,h.MZ)()],ho.prototype,"initialAngle",null),(0,n._)([(0,h.MZ)()],ho.prototype,"angle",null),(0,n._)([(0,h.MZ)()],ho.prototype,"angleClockwise",null),(0,n._)([(0,h.MZ)()],ho.prototype,"relativeAngle",null),(0,n._)([(0,h.MZ)()],ho.prototype,"relativeAngleClockwise",null),(0,n._)([(0,h.MZ)()],ho.prototype,"scale",null),(0,n._)([(0,h.MZ)()],ho.prototype,"_interactionState",void 0),ho=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter")],ho);let lo=class extends y.A{get state(){const{angle:t,scale:e}=this;return{angle:t,scale:e}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle}cancel(){this.angle=this.initialAngle,this.scale=1}};(0,n._)([(0,h.MZ)()],lo.prototype,"angle",void 0),(0,n._)([(0,h.MZ)()],lo.prototype,"initialAngle",void 0),(0,n._)([(0,h.MZ)()],lo.prototype,"previousAngle",void 0),(0,n._)([(0,h.MZ)()],lo.prototype,"previousScale",void 0),(0,n._)([(0,h.MZ)()],lo.prototype,"scale",void 0),(0,n._)([(0,h.MZ)()],lo.prototype,"state",null),lo=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateMeshAdapter.InteractionState")],lo);let co=class extends y.A{constructor(t){super(t),this.sizeAxis=null,this._interactionState=null}initialize(){this.addHandles((0,a.when)((()=>null!=this._interactionState?this._interactionState.state:null),(t=>{this._updateSymbol(t)}),a.OH))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?(t=this._orientationReferenceSymbolLayer.heading??0,-(0,b.kU)(t)):0;var t}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const t=this._sizeReferenceSymbolLayer;if(null==t)return null;const e=this.findLayerView(),i=this._graphicSymbol;if(null==e||null==i||"point-3d"!==i.type)return null;const n=e.getSymbolLayerSize(i,t);if("size"in n&&null!=n.size)return n.size;const r=this.sizeAxis;return!("width"in n)||null==n.width||null!=r&&"width"!==r&&"all"!==r&&"width-and-depth"!==r?!("depth"in n)||null==t.depth||null!=r&&"depth"!==r&&"all"!==r&&"width-and-depth"!==r?!("height"in n)||null==t.height||null!=r&&"height"!==r&&"all"!==r?null:n.height:n.depth:n.width}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&null!=t.heading))}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(null!=this._interactionState||null==t||null==e)return uo;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),n=t.clone(),r=this.angle,s=new fo({originalSymbol:n,angle:r,initialSizes:i});this._interactionState=s;const o=()=>{this._interactionState=null};return{state:s,done:o,cancel:()=>{this._graphicSymbol=n,o()}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return{undo:i=>{e=i.symbol,i.symbol=t},redo:i=>{t=i.symbol,i.symbol=e}}}_updateSymbol({scale:t,angle:e,originalSymbol:i,initialSizes:n}){const r=this._graphicSymbol;if(null==r||"point-3d"!==r.type)return;const s=r.clone(),o=-(0,b.KJ)(e-this.initialAngle);let a=!1;this._forEachObjectSymbolLayerPair(i,s,((e,i,r)=>{const s=(e.heading??0)+o;i.heading!==s&&(i.heading=s,a=!0);const h=n[r];if(null!=h&&"width"in h){h.width=this.sizeFilter(h.width),h.height=this.sizeFilter(h.height),h.depth=this.sizeFilter(h.depth);const e=h.width*t;i.width!==e&&(i.width=e,a=!0);const n=h.depth*t;i.depth!==n&&(i.depth=n,a=!0);const r=h.height*t;i.height!==r&&(i.height=r,a=!0)}})),a&&(this._graphicSymbol=s)}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,n)=>{const r=e.symbolLayers.at(n);"object"===t.type&&"object"===r.type&&i(t,r,n)}))}};(0,n._)([(0,h.MZ)()],co.prototype,"initialAngle",null),(0,n._)([(0,h.MZ)()],co.prototype,"angle",null),(0,n._)([(0,h.MZ)()],co.prototype,"angleClockwise",null),(0,n._)([(0,h.MZ)()],co.prototype,"orientation",null),(0,n._)([(0,h.MZ)()],co.prototype,"orientationClockwise",null),(0,n._)([(0,h.MZ)()],co.prototype,"relativeAngle",null),(0,n._)([(0,h.MZ)()],co.prototype,"relativeAngleClockwise",null),(0,n._)([(0,h.MZ)()],co.prototype,"scale",null),(0,n._)([(0,h.MZ)()],co.prototype,"size",null),(0,n._)([(0,h.MZ)()],co.prototype,"sizeAxis",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],co.prototype,"graphic",void 0),(0,n._)([(0,h.MZ)()],co.prototype,"_interactionState",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],co.prototype,"findLayerView",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],co.prototype,"sizeFilter",void 0),(0,n._)([(0,h.MZ)()],co.prototype,"_sizeReferenceSymbolLayer",null),(0,n._)([(0,h.MZ)()],co.prototype,"_orientationReferenceSymbolLayer",null),(0,n._)([(0,h.MZ)()],co.prototype,"_graphicSymbol",null),co=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter")],co);const uo={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let fo=class extends y.A{get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:n,initialSizes:r}=this;return{originalSymbol:t,angle:e,initialAngle:i,scale:n,initialSizes:r}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle}};(0,n._)([(0,h.MZ)()],fo.prototype,"originalSymbol",void 0),(0,n._)([(0,h.MZ)()],fo.prototype,"angle",void 0),(0,n._)([(0,h.MZ)()],fo.prototype,"initialAngle",void 0),(0,n._)([(0,h.MZ)()],fo.prototype,"initialSizes",void 0),(0,n._)([(0,h.MZ)()],fo.prototype,"scale",void 0),(0,n._)([(0,h.MZ)()],fo.prototype,"state",null),fo=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateObjectSymbol3DAdapter.InteractionState")],fo);var po,go,vo=i(16691),mo=i(74087);(go=po||(po={})).ScaleIn=Gn.SJ.Custom2,go.ScaleOut=Gn.SJ.Custom3,go.RotateLeft=Gn.SJ.Custom4,go.RotateRight=Gn.SJ.Custom5,go.Unlocked=Gn.SJ.Custom7,go.DelayedFocused=Gn.SJ.Custom8,go.TouchInput=Gn.SJ.Custom12;let yo=class extends y.A{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this._ringManipulator.location=t}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t}get updating(){return!!this._activeAnimation}constructor(t){super(t),this.mode=null,this._scaleRotateDragData=null,this._activeAnimation=null,this._ringIndicatorDelayMs=200,this.events=new wi.A,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:1}initialize(){this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this.addHandles([(0,a.watch)((()=>{const{adapter:t}=this;return[t.angle,t.scale]}),(()=>this._updateManipulatorTransform()))])}destroy(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=null,this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=(0,mo.mg)({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation()}});this._activeAnimation={...t,frameTask:e}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=(0,o.pR)(this._activeAnimation)}forEachManipulator(t){t(this._ringManipulator,hr.SCALE_ROTATE)}_createManipulator(){const t=this._createRingManipulator();this._ringManipulator=t,this.tool.manipulators.add(t);const e=this.tool.object,i=(0,Ir.Xt)(t,((t,i,n)=>{this._scaleRotateDragData=null;const r=this.adapter.startInteraction(),s={mode:"none",origin:(0,d.o8)(t.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=s,this._updateDragState();const o=S.rq.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,o),i.next(Pr(this.tool.view,(0,zn.O_)(t.renderLocation,o,(0,zn.vt)()))).next((t=>{const i=(0,zn.Qj)(t.plane),n=Xr(t.renderStart,t.renderEnd,s.origin,i),o=vo.wf.shortestSignedDiff(s.angle,n);s.angleDir=(0,b.qE)(s.angleDir+o,-.3,.3),s.angle=n;const a=function(t,e){const i=(0,u.d)(S.rq.get(),e.renderStart,t.origin),n=(0,u.d)(S.rq.get(),e.renderEnd,t.origin),r=(0,u.l)(i),s=(0,u.l)(n);return 0===r?0:s/r}(s,t),h=a-this.adapter.scale;if(s.scaleDir=(0,b.qE)(s.scaleDir+h,-.2,.2),this._onScaleChanged(),"none"===s.mode){const i=this.mode||function(t,e,i,n){const{renderStart:r,renderEnd:s}=t,o=_o(r,n,S.rq.get()),a=_o(s,n,S.rq.get());if((0,u.s)(o,a)<100)return null;const h=(0,u.d)(S.rq.get(),r,i),l=(0,u.e)(S.rq.get(),h,(0,zn.Qj)(e)),c=r,d=(0,u.g)(S.rq.get(),c,l),f=_o(i,n,S.rq.get()),p=o,g=_o(d,n,S.rq.get()),v=(0,u.d)(S.rq.get(),g,p),m=(0,u.d)(S.rq.get(),o,f),y=(0,tt.LV)(p,v),_=(0,tt.LV)(f,m);return(0,tt.kb)(y,a)<(0,tt.kb)(_,a)?"rotate":"scale"}(t,t.plane,s.origin,this.tool.view.state.camera);if(null!=i){switch(i){case"rotate":this.tool.events.emit("rotate-start",{object:e,angle:0}),this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]});break;case"scale":this.tool.events.emit("scale-start",{object:e,xScale:1,yScale:1}),this.tool.events.emit("record-undo",{updates:[this.adapter.createUndoRecord()]})}s.mode=i}}switch(s.mode){case"rotate":r.state.angle=s.initialAngle+n;break;case"scale":r.state.scale=a,this._onScaleChanged()}switch(this._updateDragState(),this._updateManipulatorTransform(),t.action){case"start":case"update":switch(s.mode){case"rotate":this.tool.events.emit("rotate",{object:e,angle:(0,b.KJ)(s.angle)});break;case"scale":this.tool.events.emit("scale",{object:e,xScale:a,yScale:a})}break;case"end":switch(s.mode){case"rotate":this.tool.events.emit("rotate-stop",{object:e,angle:(0,b.KJ)(s.angle)});break;case"scale":this.tool.events.emit("scale-stop",{object:e,xScale:a,yScale:a})}}return"end"===t.action&&(this.startAnimation(wo(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),r.done()),t})),n.next((()=>{if(r.cancel(),null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.events.emit("rotate-stop",{object:e,angle:0});break;case"scale":this.tool.events.emit("scale-stop",{object:e,xScale:1,yScale:1})}this.startAnimation(wo(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState()}}))}));this.addHandles([i,t.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(function(t,e,i){let n=0,r=null;const s=()=>!1;return{start:()=>{r=t.getFocused,t.getFocused=s,n=0,e()},update:t=>(n+=t,!r?.()||n>=i.delayMs?bo.STOP:bo.CONTINUE),destroy:()=>{r&&(t.getFocused=r),e()}}}(this,(()=>this._updateDelayedFocusedState()),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()})),t.events.on("immediate-click",(t=>{t.stopPropagation()})),(0,a.watch)((()=>this.tool.object.visible),(t=>this._ringManipulator.available=t),a.Vh)])}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(po.DelayedFocused,this.getFocused())}_updateDragState(){if(this._ringManipulator.updateStateEnabled(po.Unlocked,!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode)),null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(po.ScaleIn|po.ScaleOut,!1),this._ringManipulator.updateStateEnabled(po.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(po.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(po.RotateLeft|po.RotateRight,!1),this._ringManipulator.updateStateEnabled(po.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(po.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this._ringManipulator.updateStateEnabled(po.ScaleIn|po.ScaleOut|po.RotateLeft|po.RotateRight,!1)}_updateManipulatorTransform(){const t=(0,Oe.$0)(S.Rc.get(),this.adapter.angle,(0,d.fA)(0,0,1));if(null==t)return;const e=this.getScale(),i=(0,Oe.CV)(S.Rc.get(),(0,u.i)(S.rq.get(),e,e,e));this._ringManipulator.modelTransform=(0,Oe.lw)(S.Rc.get(),i,t)}_createRingManipulator(){const t=(t,e,i)=>{const n=[],r=Math.ceil(128*(e-t)/(2*Math.PI));for(let s=0;s<r+1;s++){const o=t+s*(e-t)/r;n.push((0,d.fA)(i*Math.cos(o),i*Math.sin(o),0))}return n},e=e=>t(0,2*Math.PI,e),i=this._createMaterial(1),n=(t,e,n=i)=>(0,ee.Nq)(n,(t=>[[-t/2,0],[t/2,0],[t/2,.25],[-t/2,.25]])(e),t,[],[],!1),r=e(160),s=n(r,24),o={left:new Array,right:new Array},a=[];for(let e=0;e<2;e++){const r=e*Math.PI-Math.PI/4,s=Math.PI/2-Tr,h=r+s,l=r+Math.PI/2-s,c=t(h,l,190),u=n(c,9);a.push(c),a.push(t(h,l,201)),o.left.push(u),o.right.push(u.instantiate());for(let t=0;t<2;t++){const e=0===t,n=(0,Re.vt)();if(e){(0,Oe.hs)(n,n,[1,-1,1]),(0,Oe.e$)(n,n,-h,[0,0,1]);const t=Math.round(.2*(c.length-1));n[12]=c[t][0],n[13]=c[t][1],n[14]=c[t][2]}else{(0,Oe.e$)(n,n,l,[0,0,1]);const t=Math.round(.8*(c.length-1));n[12]=c[t][0],n[13]=c[t][1],n[14]=c[t][2]}const r=(0,ee._B)(i,60,0,23,.5);(0,ee.xh)(r,n),(e?o.left:o.right).push(r)}}const h=[];for(let e=0;e<2;e++){const i=e*Math.PI-Math.PI/4,r=Math.PI/2-Ar,s=i+r,o=i+Math.PI/2-r,a=t(s,o,213);h.push(n(a,9))}const l=this._createMaterial(.66),c=this._createMaterial(.5),u=this._createMaterial(.33),f=e(190),p=e(213),g=n(f,9,l),v=n(p,9,u),m=e(130),y=e(107),_=n(m,9,l),b=n(y,9,u);let w=[new Cr(s,po.DelayedFocused),new Cr(s.instantiate({material:c}),Gn.p7.None)];this.mode&&"scale"!==this.mode||(w=w.concat([...h.map((t=>new Cr(t,po.DelayedFocused|po.Unlocked))),new Cr(g,po.DelayedFocused|po.ScaleIn),new Cr(v,po.DelayedFocused|po.ScaleIn),new Cr(_,po.DelayedFocused|po.ScaleOut),new Cr(b,po.DelayedFocused|po.ScaleOut)])),this.mode&&"rotate"!==this.mode||(w=w.concat([...o.right.map((t=>new Cr(t.instantiate(),po.DelayedFocused|po.Unlocked))),...o.left.map((t=>new Cr(t,po.DelayedFocused|po.RotateLeft))),...o.right.map((t=>new Cr(t,po.DelayedFocused|po.RotateRight)))]));const x=[r,...a];return new Un({view:this.tool.view,renderObjects:w,autoScaleRenderObjects:!1,worldOriented:!0,radius:24,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:this.tool.object.elevationInfo,collisionType:{type:"ribbon",paths:x,direction:(0,d.fA)(0,0,1)}})}_createMaterial(t){const e=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Transparent,isDecoration:!0});return this.addHandles((0,a.watch)((()=>(0,r.f6)(this.tool.view.effectiveTheme.accentColor,t)),(t=>e.setParameters({color:t})),a.Vh)),e}get test(){}};function _o(t,e,i){return e.projectToScreen(t,xo),(0,u.i)(i,xo[0],xo[1],0)}var bo;function wo(t,e){let i=null,n=1;const r=()=>n;return{start:()=>{n=t.getScale(),i=t.getScale,t.getScale=r,e()},update:t=>(n+=((n+1)/2-n)*Math.min(3*t,1),e(),Math.abs(n-1)<.01?bo.STOP:bo.CONTINUE),destroy:()=>{i&&(t.getScale=i),e()}}}(0,n._)([(0,h.MZ)({constructOnly:!0})],yo.prototype,"tool",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],yo.prototype,"adapter",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],yo.prototype,"sketchOptions",void 0),(0,n._)([(0,h.MZ)()],yo.prototype,"mode",void 0),(0,n._)([(0,h.MZ)()],yo.prototype,"_activeAnimation",void 0),(0,n._)([(0,h.MZ)()],yo.prototype,"updating",null),yo=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ScaleRotateTransform")],yo),function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP"}(bo||(bo={}));const xo=(0,g.gs)();var To=i(73919);let Ao=class extends((0,To.B)(ys.w)){constructor(t){super(t),this.type="transform-mesh",this.orientation=(0,ks.LJ)(),this.scale=(0,ks.dy)(),this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic,orientation:this.orientation.actual,scale:this.scale.actual}}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};(0,n._)([(0,h.MZ)()],Ao.prototype,"key",null),(0,n._)([(0,h.MZ)()],Ao.prototype,"allFields",null),Ao=(0,n._)([(0,c.$)("esri.views.interactive.tooltip.infos.TransformMeshTooltipInfo")],Ao);let Mo=class extends((0,To.B)(ys.w)){constructor(t){super(t),this.type="transform-point",this.orientation=(0,ks.LJ)({readOnly:!0}),this.size=(0,ks.qP)({readOnly:!0}),this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.size]}};(0,n._)([(0,h.MZ)()],Mo.prototype,"allFields",null),Mo=(0,n._)([(0,c.$)("esri.views.interactive.tooltip.infos.TransformPointTooltipInfo")],Mo);let So=class extends us.g{constructor(t){super(t),this.events=new wi.A,this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.sketchOptions=new fs.A,this.type="transform-3d",this._updatingHandles=new pn.U,this._scaleRotate=null}initialize(){const{events:t,object:e,view:i}=this;this.tooltip=(0,on.A)((()=>({view:i,options:this.sketchOptions.tooltips}))),this._moveManipulation=new ss({tool:this,view:i,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&_n(e.operations,e.elevationInfo),radius:ss.radiusForSymbol(e.graphic?.symbol)}),this._moveManipulation.forEachManipulator((e=>this.addHandles(e.events.on("immediate-click",(e=>{t.emit("immediate-click",{...e,object:this.object}),e.stopPropagation()})))));const n=e.elevationInfo;if(this._moveManipulation.elevationInfo=n,this.addHandles(si(e)),this._moveManipulation.createManipulatedObjectDragPipeline(((t,r,s,o,a)=>{if(t===as.XY){const{snappingStep:t,cancelSnapping:r}=(0,gs.L)({snappingContext:new ps.e({elevationInfo:n,pointer:a,editGeometryOperations:ds.p.fromGeometry(new Vn.default({spatialReference:e.operations?.data.spatialReference}),i.state.viewingMode),visualizer:new Qe,excludeFeature:e.graphic}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,useZ:!1});o=o.next(r),s=s.next((0,Ir.RS)(this.view,n)).next(...t)}return{steps:s,cancel:o}}),e,(e=>{const{action:i,object:n,dxScreen:r,dyScreen:s}=e,o={object:n,dxScreen:r,dyScreen:s};switch(i){case"start":this._emitRecordUndo(),t.emit("translate-start",o);break;case"update":t.emit("translate",o);break;case"end":t.emit("translate-stop",o)}})),this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.addHandles((0,a.watch)((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new yo({tool:this,mode:t,adapter:this._scaleRotateAdapter,sketchOptions:this.sketchOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())))}this.addHandles([br({view:this.view,object:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,s.hA)()}),e.on("committed",(()=>this._onGeometryChanged())),this._hideManipulatorsForObjectState(),(0,a.watch)((()=>i.scale),(()=>this._updateMoveAngle()))].filter(un.Ru)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof Un&&this.addHandles(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())))}));const r=i?.type,{sketchOptions:o}=this;this._meshTooltipInfo=new Ao({viewType:r,sketchOptions:o}),this._pointTooltipInfo=new Mo({viewType:r,sketchOptions:o});const h={object:e,dxScreen:0,dyScreen:0},l={onBeforeUpdate:()=>this.endDrag(),onMoveStart:()=>{this._emitRecordUndo(),t.emit("translate-start",{...h})},onMove:()=>t.emit("translate",{...h}),onMoveStop:()=>t.emit("translate-stop",{...h}),onRotateStart:i=>{this._emitRecordUndo(),t.emit("rotate-start",{object:e,angle:i})},onRotate:i=>t.emit("rotate",{object:e,angle:i}),onRotateStop:i=>t.emit("rotate-stop",{object:e,angle:i}),onScaleStart:(i,n)=>{this._emitRecordUndo(),t.emit("scale-start",{object:e,xScale:i,yScale:n})},onScale:(i,n)=>t.emit("scale",{object:e,xScale:i,yScale:n}),onScaleStop:(i,n)=>t.emit("scale-stop",{object:e,xScale:i,yScale:n})};this.addHandles(xn(this.tooltip,this.object,(()=>({sketchOptions:this.sketchOptions,activeTooltipInfo:this.activeTooltipInfo,callbacks:l,scaleRotateTransform:this._scaleRotate})))),this.finishToolCreation()}destroy(){this.tooltip.destroy(),this._moveManipulation.destroy(),this._scaleRotate=(0,o.pR)(this._scaleRotate),this._scaleRotateAdapter=(0,o.pR)(this._scaleRotateAdapter),this._updatingHandles.destroy(),this._set("view",null),this._set("object",null)}onInputEvent(t){if(!this.destroyed&&!(0,on.wG)(t,this.tooltip))return super.onInputEvent(t)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){const t=yn(this.object);return"mesh"===t?.type?new ho({object:this.object,geometry:t,viewingMode:this.view.state.viewingMode}):new co({graphic:this.object.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.object.graphic?.layer)),sizeAxis:this.sketchOptions?.tooltips?.visualVariables?.size?.axis??null})}_forEachManipulator(t){this._moveManipulation?.forEachManipulator(t),this._scaleRotate?.forEachManipulator(t)}_hideManipulatorsForObjectState(){return(0,a.watch)((()=>this.object.visible),(t=>{this._forEachManipulator((e=>e.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&_n(this.object.operations,this.object.elevationInfo)}))}_emitRecordUndo(){this.events.emit("record-undo",{updates:[this.object.createUndoRecord()]})}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t)}get updating(){return this._updatingHandles.updating||!!this._scaleRotate?.updating}get activeTooltipInfo(){return"mesh"===yn(this.object)?.type?this._meshTooltipInfo:this._pointTooltipInfo}set location(t){this._moveManipulation.location=t,this._scaleRotate&&(this._scaleRotate.location=t)}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=t)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){const{view:t}=this,e=t.state.viewingMode===ft.RT.Local||t.scale<1e6;this._moveManipulation.angle=e?this._scaleRotateAdapter.angle:0}_onGeometryChanged(){Jr(this,this.object)}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}get test(){}};(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],So.prototype,"view",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],So.prototype,"object",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],So.prototype,"enableZ",void 0),(0,n._)([(0,h.MZ)()],So.prototype,"enableRotation",void 0),(0,n._)([(0,h.MZ)()],So.prototype,"enableScaling",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,type:fs.A})],So.prototype,"sketchOptions",void 0),(0,n._)([(0,h.MZ)({value:!1})],So.prototype,"snapToScene",null),(0,n._)([(0,h.MZ)({constructOnly:!0})],So.prototype,"snappingManager",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],So.prototype,"type",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],So.prototype,"updating",null),(0,n._)([(0,h.MZ)()],So.prototype,"activeTooltipInfo",null),So=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.TransformTool3D")],So);var Eo=i(75743),Co=i(30905),Oo=i(77560),Ro=i(67888),Io=i(18627);let Po=class extends((0,Eo.O)(Co.oY)){constructor(t){super(t),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&(0,o.CM)(this.position,t.position)&&this.width===t.width&&this.height===t.height}};(0,n._)([(0,h.MZ)({readOnly:!0,json:{read:!1,write:!0}})],Po.prototype,"type",void 0),(0,n._)([(0,h.MZ)({type:Vn.default}),(0,Io.P)()],Po.prototype,"position",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,Io.P)(),(0,Oo.w)((t=>vo.ie.normalize((0,Ro.GB)(t),0,!0)))],Po.prototype,"heading",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,Io.P)(),(0,Oo.w)((t=>vo.ie.normalize((0,Ro.GB)(t),0,!0)))],Po.prototype,"tilt",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0}),(0,Io.P)()],Po.prototype,"width",void 0),(0,n._)([(0,h.MZ)({type:Number,nonNullable:!0}),(0,Io.P)()],Po.prototype,"height",void 0),Po=(0,n._)([(0,c.$)("esri.analysis.SlicePlane")],Po),i(72485);var No=i(2075);(0,X.fA)(0,0,0,.04),(0,l.A)("mac"),Math.cos((0,b.kU)(45)),Math.cos((0,b.kU)(5));const Do=22.5;(0,Re.vt)(),new $t.K;var Lo,zo=i(84264),jo=i(73318),ko=i(27291);function Fo(t){const e=(0,u.l)(t.basis1),i=(0,u.l)(t.basis2);return.3*Math.min(e,i)}function Ho(t){return Fo(t)}function Bo(t){return 0!==t.direction[0]&&0!==t.direction[1]}i(29829),Ct.Y,_t.w,ko.W,Pi.A,i(12378),i(91484),function(t){t[t.POSITIVE_X=0]="POSITIVE_X",t[t.POSITIVE_Y=1]="POSITIVE_Y",t[t.NEGATIVE_X=2]="NEGATIVE_X",t[t.NEGATIVE_Y=3]="NEGATIVE_Y"}(Lo||(Lo={}));const Go=Gn.SJ.Custom1;var Vo,Uo;!function(t){t[t.HEADING=1]="HEADING",t[t.TILT=2]="TILT"}(Vo||(Vo={})),function(t){t[t.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.TILTED=3]="TILTED"}(Uo||(Uo={}));const $o=Gn.SJ.Custom2,Wo=((0,tt.vt)(),Math.PI/2),qo=Gn.SJ.Custom1,Zo=Gn.SJ.Custom2;var Yo,Xo=i(32237);!function(t){t[t.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",t[t.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"}(Yo||(Yo={}));class Ko extends Un{constructor(t,e){const i=new re.W({width:1,renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0}),n=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Opaque,isDecoration:!0}),s=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Opaque,isDecoration:!0}),o=new Ge.v({cullFace:Zt.s2.Back,renderOccluded:ie.m$.Opaque,isDecoration:!0}),h=new Ge.v({writeDepth:!1,cullFace:Zt.s2.Front,renderOccluded:ie.m$.Transparent,isDecoration:!0});super({view:t,...Jo({offsetMode:e,tubeMaterial:n,tipMaterial:s,capMaterial:o,outlineMaterial:h,calloutMaterial:i})}),this._themeHandle=(0,a.watch)((()=>t.effectiveTheme.accentColor),(t=>{const e=(0,r.bJ)(t),a=m.A.toUnitRGBA(t),l=m.A.toUnitRGBA(e),c=m.A.toUnitRGBA(m.A.blendColors(e,t,.4)),u=m.A.toUnitRGBA(m.A.blendColors(e,t,.14));i.setParameters({color:a}),n.setParameters({color:u}),s.setParameters({color:l}),o.setParameters({color:c}),h.setParameters({color:a})}),a.Vh)}destroy(){this._themeHandle.remove(),super.destroy()}}function Jo({offsetMode:t,tubeMaterial:e,tipMaterial:i,capMaterial:n,outlineMaterial:r,calloutMaterial:s}){const o=t===Yo.CENTER_ON_CALLOUT?40:0,a=[(0,d.fA)(o,0,-24),(0,d.fA)(o,0,24)],h=function(t){const e=(0,u.d)((0,d.vt)(),t[t.length-1],t[t.length-2]);(0,u.n)(e,e),(0,u.h)(e,e,Do),(0,u.g)(e,e,t[t.length-1]);{const i=(0,u.d)((0,d.vt)(),t[0],t[1]);return(0,u.n)(i,i),(0,u.h)(i,i,Do),(0,u.g)(i,i,t[0]),[i,...t,e]}}(a),l=Qo({vertices:a,padding:0,materials:{tube:e,tip:i,cap:n}}),c=Qo({vertices:a,padding:2.25,materials:{tube:r,tip:r,cap:r}}),f=(0,ee.Z8)(s,[[o,0,0],[o-40,0,0]]),p=(0,ee.Z8)(s,[[o,0,0],[o-40,0,0]]);return{renderObjects:[...l.normal.map((t=>new Cr(t,Gn.p7.Unfocused|Go))),...c.normal.map((t=>new Cr(t,Gn.p7.Unfocused|Go))),new Cr(f,Gn.p7.Unfocused|Go|$o),...l.focused.map((t=>new Cr(t,Gn.p7.Focused|Go))),...c.focused.map((t=>new Cr(t,Gn.p7.Focused|Go))),new Cr(p,Gn.p7.Focused|Go|$o)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[h]},collisionPriority:1,radius:11,state:Go}}function Qo({vertices:t,padding:e,materials:i}){const n=n=>{const r=t.slice(),s=(0,u.d)(S.rq.get(),r[0],r[1]);(0,u.n)(s,s);const o=(0,u.d)(S.rq.get(),r[r.length-1],r[r.length-2]);if((0,u.n)(o,o),e>0){const t=(0,u.h)((0,d.vt)(),o,-e);r[r.length-1]=(0,u.g)(t,t,r[r.length-1]);const i=(0,u.h)((0,d.vt)(),s,-e);r[0]=(0,u.g)(i,i,r[0])}const a=n?1.15:1,h=Do*a,l=11*a,c=(0,Oe.D_)(S.Rc.get());if(e>0){const t=h/4,i=(0,u.i)(S.rq.get(),0,t,0),n=1+e/t;(0,Oe.Tl)(c,c,i),(0,Oe.hs)(c,c,(0,u.i)(S.rq.get(),n,n,n)),(0,Oe.Tl)(c,c,(0,u.h)(i,i,-1/n))}const f=(0,Oe.D_)((0,Re.vt)()),p=(0,d.fA)(0,1,0),g=(0,Oe.I0)((0,Re.vt)(),(0,Xo.Yc)(S.J8.get(),p,o));g[12]=r[r.length-1][0],g[13]=r[r.length-1][1],g[14]=r[r.length-1][2],(0,Oe.lw)(g,g,c);const v=i.tube,m=function(t,e,i){const n=[];for(let e=0;e<12;e++){const i=e/12*2*Math.PI;n.push([Math.cos(i)*t,Math.sin(i)*t])}return(0,ee.Nq)(i,n,e,[],[],!1)}(3*(n?1.15:1)+e,r,v);m.transformation=f;const y=[m],_=i.tip,b=(0,ee.EE)(_,h,l,24,!1,!1,!0);b.transformation=g,y.push(b);const w=i.cap,x=(0,ee.EE)(w,h,l,24,!1,!0,!1);x.transformation=g,y.push(x);const T=(0,Oe.I0)((0,Re.vt)(),(0,Xo.Yc)(S.J8.get(),p,s));return T[12]=r[0][0],T[13]=r[0][1],T[14]=r[0][2],(0,Oe.lw)(T,T,c),y.push(b.instantiate({transformation:T})),y.push(x.instantiate({transformation:T})),y};return{normal:n(!1),focused:n(!0)}}class ta{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(t,e){this._tool=t,this._bounds=e,this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null;const i=this._tool,n=i.view;this.moveXYObjectManipulation=new ls({view:n,tool:i,object:this._object}),i.addHandles(this._createMoveXYObjectDragPipeline()),this.moveZManipulator=new Ko(n,Yo.CENTER_ON_CALLOUT),this.moveZManipulator.state|=$o,i.manipulators.add(this.moveZManipulator),i.addHandles([this._createMoveZDragPipeline()]),i.addHandles([i.events.on("translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null}))])}destroy(){this.moveXYObjectManipulation.destroy(),this._tool.manipulators.remove(this.moveZManipulator),this.moveZManipulator.destroy()}forEachManipulator(t){this.moveXYObjectManipulation.forEachManipulator(t),t(this.moveZManipulator,hr.TRANSLATE_Z)}updateManipulators(t,e){const i=this.moveZManipulator,n=(0,Oe.Qr)(S.Rc.get(),t,Math.PI);n[12]=0,n[13]=0,n[14]=0,i.modelTransform=n,i.renderLocation=(0,u.d)(S.rq.get(),e.origin,e.basis1)}getUpdatedTooltipInfo(){return this.moveXYObjectManipulation.grabbing||this.moveXYObjectManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){const t=this._tool,e=this._moveXYTooltipInfo??=new ms.M({sketchOptions:t.sketchOptions});if(this.moveXYObjectManipulation.dragging){const i=this._bounds,n=i.mapBoundsStart.origin,r=i.mapBounds.origin,{renderSpatialReference:s}=t.view;if(!s)return null;const o=(0,L.Do)(n,r,s);if(null==o)return null;e.distance=o}else e.distance=fn.r7;return e}_computeMoveZTooltipInfo(){const t=this._tool,e=this._moveZTooltipInfo??=new bs({sketchOptions:t.sketchOptions});if(this.moveZManipulator.dragging){const i=this._bounds,n=i.mapBoundsStart.origin,r=i.mapBounds.origin,{renderSpatialReference:s}=t.view;if(!s)return null;const o=(0,wn.cL)(n,r,s);if(null==o)return null;e.distance=o}else e.distance=fn.r7;return e}_createMoveXYObjectDragPipeline(){return this.moveXYObjectManipulation.createDragPipeline(((t,e,i)=>this._applyObjectMoveSteps(e,i)))}_createMoveZDragPipeline(){if(!this._operations)return(0,s.hA)();const t=this._operations.data.spatialReference;return(0,Ir.Xt)(this.moveZManipulator,((e,i,n)=>{const r=(0,d.o8)(e.renderLocation),s=i.next(Lr(this._tool.view,r,t)).next((0,Ir.sO)());this._applyObjectMoveSteps(s,n)}))}_applyObjectMoveSteps(t,e){const{_tool:i,_object:n}=this,r=t.next((t=>("start"===t.action&&(i.inputState={type:"move"},this._bounds.backupMapBounds(),i.events.emit("translate-start",{object:n,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next((0,Ir.EX)()).next(this._moveDragUpdateGeometry()).next((t=>{const e={object:n,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||(t.mapEnd.z??0)-(t.mapStart.z??0))&&i.events.emit("translate",e);break;case"end":i.inputState=null,i.events.emit("translate-stop",e)}return t}));return e.next((()=>{null!=i.inputState&&i.events.emit("translate-stop",{object:n,dxScreen:0,dyScreen:0}),i.cancel()})),r}_moveDragUpdateGeometry(){const t=this._tool;return e=>{if(null==t.inputState||"move"!==t.inputState.type)return e;const i="start"===e.action?bn.Y.NEW_STEP:bn.Y.ACCUMULATE_STEPS;if(this._operations){const t=this._operations.move(e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i);this._bounds.updateMapBoundsFromOperation(t)}return e}}}var ea=i(59552),ia=i(36634),na=i(6200),ra=i(72468);class sa extends _t.w{constructor(t,e,n){super(t,e,new yt.$(ra.I,(()=>i.e(2205).then(i.bind(i,35108)))),n,oa)}_getPipelineState(t,e){const{oitPass:i,output:n,hasOccludees:r,enableOffset:s,cullFace:o}=t,a=i===ji.Y.NONE,h=i===ji.Y.FrontFace;return(0,wt.Ey)({blending:n===Ri.V.Color?a?wt.Os:(0,ki.ez)(i):null,culling:(0,wt.Xt)(o),depthTest:{func:(0,ki.K_)(i)},depthWrite:(0,ki.z5)(t),drawBuffers:(0,ki.m6)(i,n),colorWrite:wt.kn,stencilWrite:r?na.v0:null,stencilTest:r?e?na.a9:na.qh:null,polygonOffset:a||h?null:(0,ki.aB)(s)})}initializePipeline(t){return this._occludeePipeline=this._getPipelineState(t,!0),this._getPipelineState(t,!1)}getPipeline(t){return t?this._occludeePipeline:super.getPipeline()}}const oa=new Map([[Pt.r.POSITION,0],[Pt.r.UV0,2],[Pt.r.PERSPECTIVEDIVIDE,3]]);class aa extends Ui.E{constructor(){super(...arguments),this.cullFace=Zt.s2.None,this.hasSlicePlane=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=Gi.I.None,this.emissionSource=Vi.ZX.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}}(0,n._)([(0,$t.W)({count:Zt.s2.COUNT})],aa.prototype,"cullFace",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"hasSlicePlane",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"enableOffset",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"writeDepth",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"hasOccludees",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"terrainDepthTest",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"cullAboveTerrain",void 0),(0,n._)([(0,$t.W)()],aa.prototype,"perspectiveInterpolation",void 0);class ha extends ko.W{constructor(t){super(t,ua),this._configuration=new aa,this.vertexAttributeLocations=oa,this.supportsEdges=!0,this.produces=new Map([[Di.N.OPAQUE_MATERIAL,t=>(0,Ri.CL)(t)],[Di.N.TRANSPARENT_MATERIAL,t=>(0,Ri._o)(t)&&this.parameters.writeDepth],[Di.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>(0,Ri._o)(t)&&!this.parameters.writeDepth],[Di.N.DRAPED_MATERIAL,t=>(0,Ri._o)(t)||(0,Ri.CL)(t)]])}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=e.hasOccludees,this._configuration.oitPass=e.oitPass,this._configuration.enableOffset=e.camera.relativeElevation<ki.xt,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(t){return new la(t)}createBufferWriter(){const t=jo.zK.clone();return this.parameters.perspectiveInterpolation&&t.f32(Pt.r.PERSPECTIVEDIVIDE),new ca(t)}}class la extends ia.m8{constructor(t){super({...t,...t.material.parameters})}beginSlot(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.acquireTechnique(sa,t)}}class ca extends zo.Z{write(t,e,i,n,r,s){for(const n of this.vertexBufferLayout.fields.keys()){const o=i.get(n);if(o)if(n===Pt.r.PERSPECTIVEDIVIDE){(0,Li.vA)(1===o.size);const t=r.getField(n,Oi.Y$);t&&(0,zi.uO)(o,t,s)}else(0,zi.zC)(n,o,t,e,r,s)}}}class ua extends ie.qA{constructor(){super(...arguments),this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=Zt.s2.None,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0,this.perspectiveInterpolation=!1}}class da extends Un{constructor(t,e){const i=new ha({writeDepth:!1,renderOccluded:ie.m$.Opaque,isDecoration:!0}),n=Zr.calloutWidth,s=new re.W({width:n,renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0});super({view:t,...fa({imageMaterial:i,calloutMaterial:s})}),this._currentTexture=null,this._themeHandle=(0,a.watch)((()=>t.effectiveTheme.accentColor),(t=>{const n=(0,r._L)(t,.5),o=(0,r.bJ)(t),a=this._currentTexture,h=e(n,o);i.setParameters({textureId:h.texture.id}),s.setParameters({color:m.A.toUnitRGBA(t)}),this._currentTexture=h,a?.release()}),a.Vh)}destroy(){this._themeHandle.remove(),this._currentTexture?.release(),super.destroy()}}function fa({imageMaterial:t,calloutMaterial:e}){const{focusMultiplier:i,calloutLength:n,discRadius:r}=Zr,s=r*i,o=(t,e)=>{const i=[0,1,2,2,3,0];return new Be.V(e,[[Pt.r.POSITION,new He.n([n-t,-t,0,n+t,-t,0,n+t,t,0,n-t,t,0],i,3,!0)],[Pt.r.UV0,new He.n([0,0,1,0,1,1,0,1],i,2,!0)]])},a=(0,ee.Z8)(e,[[0,0,0],[n-r,0,0]]),h=(0,ee.Z8)(e,[[0,0,0],[n-s,0,0]]),l=Go;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[n,0,0]},focusMultiplier:i,radius:r,renderObjects:[new Cr(o(r,t),Gn.p7.Unfocused|l),new Cr(a,Gn.p7.Unfocused|l),new Cr(o(s,t),Gn.p7.Focused|l),new Cr(h,Gn.p7.Focused|l)],state:l}}var pa=i(57665),ga=i(60403);class va{get _object(){return this._tool.object}get _operations(){return this._object.operations}constructor(t,e,i){this._tool=t,this._bounds=e,this._snapRotation=i,this._rotateTooltipInfo=null,this._startAngle=0,this._endAngle=0;const n=this._tool,r=n.view,s=!r._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new da(r,((t,e)=>function(t,e){const{accentColor:i,contrastColor:n,preMultiplyAlpha:r}=e;return t.fromData(`heading-rotate:[accent:${i},contrast:${n},size:64]`,(()=>new ea.g(function(t,e){return function(t,e){const i=new Image(e,e);return i.src=t,i}(function(t){const e=(new XMLSerializer).serializeToString(t);return`data:image/svg+xml;base64,${btoa(e)}`}(function(t,{accentColor:e,contrastColor:i}){const n=e.toHex(),r=e.a,s=i.toHex(),o=i.a,a=t.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem("theme-style");return a&&(a.innerHTML=`\n      .contrast-fill { fill: ${s}; fill-opacity: ${o}; }\n      .contrast-stroke { stroke: ${s}; stroke-opacity: ${o};  }\n      .accent-fill { fill: ${n}; fill-opacity: ${r}; }\n      .accent-stroke { stroke: ${n}; stroke-opacity:  ${r}; }`),t}(function(t){const e=t.split(",")[1],i=atob(e);return(new DOMParser).parseFromString(i,"image/svg+xml")}(t),e)),e.size)}("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NiIgY2xhc3M9ImFjY2VudC1maWxsIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI0Ljk5IiBkPSJNMjAuMDUgNDAuODZhMTUuMDUgMTUuMDUgMCAwIDAgMTcuMTQtMS41IDE1LjA1IDE1LjA1IDAgMCAwIDQuNDctMTYuNjUgMTUuMDUgMTUuMDUgMCAwIDAtMjIuNzItNy4xNSAxNS4wNSAxNS4wNSAwIDAgMC01LjUgNy4xNSIgY2xhc3M9ImNvbnRyYXN0LXN0cm9rZSIvPjxwYXRoIGQ9Im0xMC45NyAzNS41NyA1LjM4IDEyLjA3IDcuNzktMTMuNDd6IiBjbGFzcz0iY29udHJhc3QtZmlsbCIvPjwvc3ZnPg==",{accentColor:i,contrastColor:n,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:r})))}(r.textures,{accentColor:t,contrastColor:e,preMultiplyAlpha:s}))),n.addHandles([this.rotateManipulator.events.on("grab-changed",(t=>this._onRotateGrab(t))),this._createRotateDragPipeline(this.rotateManipulator)]),n.manipulators.add(this.rotateManipulator),n.addHandles([n.events.on("rotate-start",(t=>this._startAngle=t.angle)),n.events.on("rotate",(t=>this._endAngle=t.angle)),n.events.on("rotate-stop",(()=>{this._startAngle=0,this._endAngle=0}))])}destroy(){this._tool.manipulators.remove(this.rotateManipulator),this.rotateManipulator.destroy()}forEachManipulator(t){t(this.rotateManipulator,hr.ROTATE)}updateManipulators(t,e){const i=this._bounds.mapBounds.plane[2]<0?Math.PI:0,n=(0,Oe.eL)(S.Rc.get(),t,i);n[12]=0,n[13]=0,n[14]=0,this.rotateManipulator.modelTransform=n,this.rotateManipulator.renderLocation=(0,u.g)(S.rq.get(),e.origin,e.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){const t=this._rotateTooltipInfo??=new ga.d({sketchOptions:this._tool.sketchOptions});return t.angle=this._startAngle-this._endAngle,t}_onRotateGrab({action:t,screenPoint:e}){const i=this._tool,n=this._bounds;if("start"!==t||!e)return;const r=function(t,e,i,n){const r=e.worldUpAtPosition(t.origin,S.rq.get()),s=S.rq.get();switch(i){case Vo.HEADING:(0,u.c)(s,r);break;case Vo.TILT:(0,u.c)(s,t.basis1)}return(0,zn.O_)(t.origin,s,n)}(n.displayBounds,i.view.renderCoordsHelper,Vo.HEADING,(0,zn.vt)()),s=Fn(i.view.state.camera,e);(0,zn.Ui)(r,s,S.rq.get())&&(n.backupMapBounds(),i.inputState={type:"rotate",rotatePlane:r})}_createRotateDragPipeline(t){const{_tool:e,_object:i}=this;return(0,Ir.Xt)(t,((t,n,r)=>{const s=e.inputState;null!=s&&(n.next((t=>("start"===t.action&&e.events.emit("rotate-start",{object:i,angle:0}),t))).next(Pr(e.view,s.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(s)).next(...this._snapRotation()).next(this._rotateDragUpdateGeometry()).next((t=>{const n={object:i,angle:(0,b.KJ)(t.rotateAngle)};switch(t.action){case"start":case"update":e.events.emit("rotate",n);break;case"end":e.inputState=null,e.events.emit("rotate-stop",n)}return t})),r.next((()=>{null!=e.inputState&&e.events.emit("rotate-stop",{object:i,angle:0}),e.cancel()})))}))}_rotateDragRenderPlaneToRotate(t){return e=>{const i=(0,zn.Qj)(t.rotatePlane),n=Xr(e.renderStart,e.renderEnd,this._bounds.displayBounds.origin,i);return{...e,rotateAxis:i,rotateAngle:n}}}_rotateDragUpdateGeometry(){const t=this._bounds;return e=>{const i=(0,u.c)((0,d.vt)(),t.mapBoundsStart.origin),n="start"===e.action?bn.Y.NEW_STEP:bn.Y.ACCUMULATE_STEPS;if(this._operations){const r=this._operations.rotate(i,e.rotateAngle,n,pa.K.REPLACE);(0,No.c)(t.mapBoundsStart,t.mapBounds),t.updateMapBoundsFromOperation(r)}return e}}}class ma extends Un{constructor(t,e){const i=Bo(e),n=i?4:1,r=2*n,s={renderOccluded:ie.m$.OccludeAndTransparent,isDecoration:!0},o=new re.W({...s,width:n}),h=new re.W({...s,width:r}),l=new re.W({...s,width:1});super({view:t,...Yr,...ya({isCorner:i,unfocusedMaterial:o,focusedMaterial:h,outlineMaterial:l})}),this._themeHandle=(0,a.watch)((()=>t.effectiveTheme.accentColor),(t=>{const e=m.A.toUnitRGBA(t);o.setParameters({color:e}),h.setParameters({color:e}),l.setParameters({color:e})}),a.Vh)}destroy(){this._themeHandle.remove(),super.destroy()}}function ya({isCorner:t,unfocusedMaterial:e,focusedMaterial:i,outlineMaterial:n}){const r=t?[(0,d.fA)(1,0,0),(0,d.fA)(0,0,0),(0,d.fA)(0,1,0)]:[(0,d.fA)(1,0,0),(0,d.fA)(-1,0,0)];return{renderObjects:[new Cr((0,ee.Z8)(e,r),Gn.p7.Unfocused|qo),new Cr((0,ee.Z8)(i,r),Gn.p7.Focused|qo),new Cr((0,ee.Z8)(n,r),Zo)],collisionType:{type:"line",paths:[r]},radius:t?6:4,state:qo}}var _a=i(41857),ba=i(16633);class wa{constructor(t,e){this._tool=t,this.mapBounds=(0,No.a)(),this.mapBoundsStart=(0,No.a)(),this.displayBounds=(0,No.a)(),t.addHandles((0,a.on)((()=>t.object),"modified-externally",(()=>this._resetMapBounds()),{onListenerAdd:()=>this._resetMapBounds()})),this._onDisplayBoundsChanged=e}get displayBoundsMargin(){const{view:t,object:e}=this._tool,i=yn(e),n=t.pointsOfInterest?.centerOnSurfaceFrequent.location??i?.extent?.center;return n?xa*t.pixelSizeAt(n):0}backupMapBounds(){(0,No.c)(this.mapBounds,this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds(),this._onDisplayBoundsChanged?.()}updateMapBoundsFromOperation(t){(0,_a.Bb)(t,this.mapBounds),this.updateDisplayBounds()}updateMapBoundsFromOperationInverse(t){(0,_a.fJ)(t,this.mapBounds),this.updateDisplayBounds()}_resetMapBounds(){this._calculateMapBounds(),this.updateDisplayBounds()}_calculateMapBounds(){const{view:t,attachmentOrigin:e,object:i}=this._tool,n=i.operations?.data;if(!n)return;const r=n.geometry;this.spatialReference=r.spatialReference;const s=function(t){const e=vn(t);return(0,A.fA)(Math.cos(e),Math.sin(e))}(r);(0,T.hs)(s,s,-1);const o=e?t.pixelSizeAt(e,r.spatialReference):0;(0,_a.G3)(s,n,Ta*o,this.mapBounds)}_calculateDisplayBounds(){const{view:t,attachmentOrigin:e}=this._tool,i=e?.z??(0,Pe.nG)(this.mapBounds.origin,t.elevationProvider,Ne.F.fromElevationInfo(this._tool.object.elevationInfo),t.renderCoordsHelper),n=(0,No.c)(this.mapBounds);n.origin[2]=i??0,function(t,e,i,n=0,r){r||(r=(0,No.a)()),e.toRenderCoords(t.origin,i,r.origin);const s=S.rq.get();(0,u.g)(s,t.origin,t.basis1),(0,u.g)(s,s,t.basis2),e.toRenderCoords(s,i,s);const o=S.rq.get();(0,u.g)(o,t.origin,t.basis1),(0,u.d)(o,o,t.basis2),e.toRenderCoords(o,i,o);const a=S.rq.get();(0,u.d)(a,t.origin,t.basis1),(0,u.d)(a,a,t.basis2),e.toRenderCoords(a,i,a);const h=S.rq.get();(0,u.d)(h,t.origin,t.basis1),(0,u.g)(h,h,t.basis2),e.toRenderCoords(h,i,h);const l=(0,u.m)(S.rq.get(),s,o,.5);(0,u.d)(l,l,r.origin);const c=(0,u.m)(S.rq.get(),a,h,.5);(0,u.d)(c,r.origin,c),(0,u.m)(r.basis1,l,c,.5);const d=(0,u.m)(S.rq.get(),h,s,.5);(0,u.d)(d,d,r.origin);const f=(0,u.m)(S.rq.get(),o,a,.5);(0,u.d)(f,r.origin,f),(0,u.m)(r.basis2,d,f,.5);const p=(0,u.e)(S.rq.get(),r.basis1,r.basis2),g=(0,u.e)(p,p,r.basis1);(0,u.n)(g,g),(0,u.h)(r.basis2,g,(0,u.f)(r.basis2,g)),(0,u.h)(r.basis1,r.basis1,1+n/(0,u.l)(r.basis1)),(0,u.h)(r.basis2,r.basis2,1+n/(0,u.l)(r.basis2)),(0,No.u)(r)}(n,t.renderCoordsHelper,this.spatialReference,this.displayBoundsMargin,this.displayBounds)}}const xa=10,Ta=80,Aa=(0,d.vt)(),Ma=(0,d.vt)(),Sa=(0,d.vt)(),Ea=(0,d.vt)();var Ca=i(96632);class Oa{get _object(){return this._tool.object}get _operations(){return this._object.operations}get zMax(){if(!this._zMaxDirty||!this._operations)return this._zMax;const t=this._operations.data;if(t.geometry.hasZ){const e=t.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const i of t.components)for(const t of i.vertices){const i=e.getZ(t.pos)??0;this._zMax=Math.max(i,this._zMax)}}else this._zMax=0;return this._zMaxDirty=!1,this._zMax}constructor(t,e,i){this._tool=t,this._bounds=e,this._preserveAspectRatioStep=i,this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._displayBoundsStart=(0,No.a)(),this._displayBoundsMarginStart=0,this._zMax=0,this._zMaxDirty=!0;const n=this._tool,r=n.view;this.resizeManipulators=this._resizeHandles.map((t=>{const e=new ma(r,t);return n.addHandles([e.events.on("grab-changed",(t=>this._onResizeGrab(t))),this._createResizeDragPipeline(e,t)]),e})),n.manipulators.addMany(this.resizeManipulators),this._operations&&n.addHandles(this._operations.data.on("change",(()=>{"resize"!==n.inputState?.type&&(this._zMaxDirty=!0)})))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){this.resizeManipulators.forEach((e=>t(e,hr.SCALE)))}updateManipulators(t,e){this.resizeManipulators.forEach(((i,n)=>{!function(t,e,i,n){const r=(0,u.l)(n.basis1),s=(0,u.l)(n.basis2),o=Fo(n),a=Ho(n),h=(0,u.i)(S.rq.get(),0,0,0);(0,u.g)(h,(0,u.h)(S.rq.get(),n.basis1,e.direction[0]),(0,u.h)(S.rq.get(),n.basis2,e.direction[1])),(0,u.g)(h,n.origin,h);let l=0,c=1;if(Bo(e))1===e.direction[0]&&-1===e.direction[1]?l=Wo:1===e.direction[0]&&1===e.direction[1]?l=Math.PI:-1===e.direction[0]&&1===e.direction[1]&&(l=3*Math.PI/2),c=a;else{const t=0!==e.direction[0]?1:2;l=1===t?Wo:0,c=(1===t?s:r)-o}const d=(0,Oe.N9)(S.Rc.get(),l);(0,Oe.hs)(d,d,(0,u.i)(S.rq.get(),c,c,c)),(0,Oe.lw)(d,i,d),d[12]=0,d[13]=0,d[14]=0,t.modelTransform=d,t.renderLocation=h}(i,this._resizeHandles[n],t,e)}))}getUpdatedTooltipInfo(){if(!this.resizeManipulators.some((t=>t.focused)))return null;const t=this._tooltipInfo??=new Ca.c({sketchOptions:this._tool.sketchOptions}),e=function(t,e,i){return(0,u.d)(Ea,(0,u.d)(Ea,t.origin,t.basis1),t.basis2),(0,u.b)(Sa,Ea,t.basis1,2),(0,u.b)(Ma,Sa,t.basis2,2),(0,u.b)(Aa,Ea,t.basis2,2),Ea[2]=Sa[2]=Ma[2]=Aa[2]=e,(0,ba.b)({topLeft:Aa,topRight:Ma,bottomRight:Sa,bottomLeft:Ea,spatialReference:i})}(this._bounds.mapBounds,this.zMax,this._bounds.spatialReference);return e&&(t.xSize=e.xSize,t.ySize=e.ySize),this.resizeManipulators.some((t=>t.dragging))||(t.xScale=1,t.yScale=1),t}_onResizeGrab({action:t,screenPoint:e}){const i=this._tool,n=this._bounds;if("start"!==t||!e)return;const r=Fn(i.view.state.camera,e);(0,zn.Ui)(n.displayBounds.plane,r,S.rq.get())&&(n.backupMapBounds(),(0,No.c)(n.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=n.displayBoundsMargin,i.inputState={type:"resize"})}_createResizeDragPipeline(t,e){const{_tool:i,_object:n}=this;return(0,Ir.Xt)(t,((t,r,s)=>{null!=i.inputState&&(r.next((t=>("start"===t.action&&i.events.emit("scale-start",{object:n,xScale:1,yScale:1}),t))).next(Pr(i.view,this._displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next((t=>{const e=this._tooltipInfo;e&&(e.xScale=t.factor1,e.yScale=t.factor2);const r={object:n,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":i.events.emit("scale",r);break;case"end":i.inputState=null,i.events.emit("scale-stop",r)}return t})),s.next((()=>{null!=i.inputState&&i.events.emit("scale-stop",{object:n,xScale:1,yScale:1}),i.cancel()})))}))}_resizeDragRenderPlaneToFactors(){const t=this._bounds;return e=>{const i=this._displayBoundsStart,n=e.handle.direction,r=t.displayBoundsMargin,s=this._displayBoundsMarginStart,o=(0,u.c)(S.rq.get(),i.origin);(0,u.b)(o,o,i.basis1,-n[0]),(0,u.b)(o,o,i.basis2,-n[1]);const a=(0,u.d)(S.rq.get(),e.renderEnd,o),h=(0,u.d)(S.rq.get(),e.renderStart,o),l=Bo(e.handle),c=Ho(i),d=Ho(t.displayBounds)/c,f=(t,e)=>{if(0===t)return 1;let i=(0,u.l)(e),n=.5*t*(0,u.f)(e,a)/i;const o=n<0?-1:1;l&&(n+=(i-.5*t*(0,u.f)(e,h)/i)*o*d);const c=i<1.5*s?1:Ra;return i=Math.max(i-s,Ra),o>0&&(n-=r),o*Math.max(o*(n/i),c)};return{...e,factor1:f(n[0],i.basis1),factor2:f(n[1],i.basis2)}}}_resizeDragUpdateGeometry(){const t=this._bounds;return e=>{const i=(0,u.c)((0,d.vt)(),t.mapBoundsStart.origin);(0,u.b)(i,i,t.mapBoundsStart.basis1,-e.handle.direction[0]),(0,u.b)(i,i,t.mapBoundsStart.basis2,-e.handle.direction[1]);const n=(0,T.hZ)((0,A.vt)(),t.mapBoundsStart.basis1[0],t.mapBoundsStart.basis1[1]);(0,T.S8)(n,n);const r="start"===e.action?bn.Y.NEW_STEP:bn.Y.ACCUMULATE_STEPS;if(this._operations){const s=this._operations.scale(i,n,e.factor1,e.factor2,r,pa.K.REPLACE);(0,No.c)(t.mapBoundsStart,t.mapBounds),t.updateMapBoundsFromOperation(s)}return e}}}const Ra=1e-6;class Ia{constructor(){this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e={...this._lastDragEvent,action:"update"};t&&Pa(e),this._next.execute(e)}this._enabled=t}createDragEventPipelineStep(){this._lastDragEvent=null;const t=new Ir.rh;return this._next=t,[t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&Pa(t),t),t]}get test(){}}function Pa(t){const e=Bo(t.handle)?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.handle.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e}class Na{constructor(){this._lastDragEvent=null,this._next=null,this.incrementRadians=(0,b.kU)(5),this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const e={...this._lastDragEvent,action:"update"};t&&this._adjustRotation(e),this._next.execute(e)}this._enabled=t}createDragEventPipelineStep(){this._lastDragEvent=null;const t=new Ir.rh;return this._next=t,[t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustRotation(t),t),t]}_adjustRotation(t){t.rotateAngle=Math.round(t.rotateAngle/this.incrementRadians)*this.incrementRadians}}let Da=class extends us.g{get updating(){return!!this.object.updating}constructor(t){super(t),this.events=new wi.A,this.enableZ=!0,this.enableScaling=!0,this.enableRotation=!0,this.sketchOptions=new fs.A,this._preserveAspectRatio=new Ia,this._snapRotation=new Na,this.grabbing=!1,this.inputState=null,this._attachmentOrigin=null,this.type="transform-3d",this._outlineVisualElement=null}initialize(){const{view:t,object:e}=this,i=this._bounds=new wa(this,(()=>this._updateManipulators()));this._extentMove=new ta(this,i),this._extentScale=new Oa(this,i,(()=>this._preserveAspectRatio.createDragEventPipelineStep())),this._extentRotate=new va(this,i,(()=>this._snapRotation.createDragEventPipelineStep())),this.addHandles([(0,a.watch)((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,hr.TRANSLATE_Z))),(0,a.watch)((()=>this.enableScaling),(()=>this._extentScale.forEachManipulator((t=>this._updateManipulatorAvailability(t,hr.SCALE))))),(0,a.watch)((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,hr.ROTATE)))]),this._updateManipulators(),this._updateAllManipulatorAvailability();const n=br({view:t,object:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,s.hA)()});if(null!=n){const{visualElement:t}=n;t instanceof Mi&&(this._outlineVisualElement=t,this.addHandles(t.events.on("attachment-origin-changed",(()=>this._bounds.updateDisplayBounds())))),this.addHandles(n)}this.addHandles([e.on("committed",(()=>this._onGeometryChanged())),(0,a.watch)((()=>this.object.visible),(()=>this._updateAllManipulatorAvailability())),(0,a.watch)((()=>this.object.isDraped),(()=>this._graphicDrapedChanged()),a.Vh),(0,a.watch)((()=>t.pointsOfInterest?.centerOnSurfaceFrequent.location),(()=>i.updateDisplayBounds()))]),this._forEachManipulator((t=>{this.addHandles(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability()})))})),this._forEachManipulator(((t,i)=>{this.addHandles(t.events.on("immediate-click",(t=>{i===hr.TRANSLATE_XY&&this.events.emit("immediate-click",{...t,object:e}),t.stopPropagation()})))})),this._initializeTooltip(),this.finishToolCreation()}destroy(){this._extentMove.destroy(),this._extentScale.destroy(),this._extentRotate.destroy(),this.tooltip.destroy(),this._set("view",null),this._set("object",null)}_initializeTooltip(){const{view:t}=this;this.tooltip=(0,on.A)((()=>({view:t,options:this.sketchOptions.tooltips})));const e=()=>{this.tooltip.info=this._getUpdatedTooltipInfo()};this.addHandles([(0,a.watch)((()=>this.sketchOptions.tooltips.effectiveEnabled),e),(0,a.watch)((()=>this.preserveAspectRatio),e)]),this._forEachManipulator((t=>{this.addHandles([t.events.on(["focus-changed","grab-changed"],e),t.events.on("drag",(t=>{"cancel"===t.action?this.tooltip.clear():e()}))])}))}_getUpdatedTooltipInfo(){return this.sketchOptions.tooltips.effectiveEnabled?this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles(La),this._bounds.updateDisplayBounds(),this.object.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",(t=>{null!=this._attachmentOrigin&&(0,Ln.Rj)(t.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()})),La)}_updateManipulators(){if(!this.visible)return;const t=this._bounds.displayBounds,e=function(t,e){return Kr(t.basis1,t.basis2,t.origin,e)}(t,S.Rc.get());this._extentMove.updateManipulators(e,t),this._extentScale.updateManipulators(e,t),this._extentRotate.updateManipulators(e,t)}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)))}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof Un){const n=this.object.visible,r=this.enableZ&&_n(this.object.operations,this.object.elevationInfo);switch(e){case hr.ROTATE:t.available=n&&this.enableRotation;break;case hr.SCALE:t.available=n&&(this.enableScaling||this.enableRotation||r),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?qo:Zo;break;case hr.TRANSLATE_Z:t.available=n&&r;break;default:t.available=n}}}_forEachManipulator(t){this._extentMove.forEachManipulator(t),this._extentScale.forEachManipulator(t),this._extentRotate.forEachManipulator(t)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t)}get snapRotation(){return this._snapRotation.enabled}set snapRotation(t){this._snapRotation.enabled=t,this._set("snapRotation",t)}get attachmentOrigin(){const t=this.object.isDraped?null:this._outlineVisualElement?.attachmentOrigin;return this._attachmentOrigin=t??this.object.origin??yn(this.object)?.extent?.center,this._attachmentOrigin}reset(){}cancel(){if(this.canUndo){const t=this.object.operations?.undo();t&&this._bounds.updateMapBoundsFromOperationInverse(t)}this.inputState=null}get canUndo(){return!!this.object.operations?.canUndo}undo(){if(null!=this.inputState)this.view.activeTool=null;else if(this.canUndo){const t=this.object.operations?.undo();t&&this._bounds.updateMapBoundsFromOperationInverse(t)}}get canRedo(){return!!this.object.operations?.canRedo}redo(){if(this.canRedo){const t=this.object.operations?.redo();t&&this._bounds.updateMapBoundsFromOperation(t)}}get test(){}};(0,n._)([(0,h.MZ)()],Da.prototype,"updating",null),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],Da.prototype,"view",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],Da.prototype,"object",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"enableZ",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"enableScaling",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"enableRotation",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0,type:fs.A})],Da.prototype,"sketchOptions",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"preserveAspectRatio",null),(0,n._)([(0,h.MZ)()],Da.prototype,"snapRotation",null),(0,n._)([(0,h.MZ)()],Da.prototype,"grabbing",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"inputState",void 0),(0,n._)([(0,h.MZ)({readOnly:!0})],Da.prototype,"type",void 0),(0,n._)([(0,h.MZ)()],Da.prototype,"tooltip",void 0),Da=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.transform.ExtentTransformTool")],Da);const La="draped-elevation-changes";var za=i(67376);var ja=i(82067);const ka=Symbol();let Fa=class extends wi.A.EventedAccessor{get operations(){return this._operations}get updating(){return this._updatingHandles.updating}get elevationInfo(){return(0,f.bh)(this.graphic)}get visible(){return this._graphicState.displaying}get isDraped(){return this._graphicState.isDraped}get origin(){return function(t,e){const i=t.getViewForGraphic(e);return null!=i&&"computeAttachmentOrigin"in i?i.computeAttachmentOrigin(e,t.spatialReference):null}(this.view,this.graphic)}constructor(t){super(t),this._updatingHandles=new pn.U}destroy(){this._operations=(0,o.pR)(this._operations),this._updatingHandles.destroy()}initialize(){this._graphicState=new en({graphic:this.graphic}),this._graphicState.on("changed",(()=>this.emit("committed"))),this.addHandles(this.view.trackGraphicState(this._graphicState)),this.addHandles(this._updatingHandles.add((()=>this.graphic.geometry),(t=>{const e=this._operations?.data.geometry;if(t!==e){if(!t||"multipoint"===t?.type||"extent"===t?.type)return(0,o.pR)(this._operations),this.removeHandles(ka),void(this._operations=null);if(this._operations?.trySetGeometry(t))this.emit("modified-externally");else{(0,o.pR)(this._operations),this.removeHandles(ka);const e=ds.p.fromGeometry(t,this.view.state.viewingMode);this._operations=e,this.addHandles(e.data.on("change",(()=>this.graphic.geometry=e.data.geometry)),ka)}}}),a.pc))}createManipulator(t){return new ja.l({view:this.view,graphic:this.graphic,...t})}maskOccludee(){return this.view.maskOccludee(this.graphic)}endInteraction(){const t=this.graphic.geometry;"mesh"===t?.type&&this.graphic.notifyMeshTransformChanged({action:ri.$.UpdateFastLocalOrigin})}toMap(t){return this.view.toMap(t,{include:[this.graphic]})}createUndoRecord(){const{graphic:{geometry:t}}=this;return function(t){return null!=t&&"mesh"===t.type?function(t){return(0,za.Hq)(t.vertexSpace)?function(t,e,i){let n=e?.clone(),r=(0,d.o8)(i.origin),s=null,o=null;return{undo:()=>{s=t.transform?.clone(),o=(0,d.o8)(i.origin),t.transform=n,t.vertexSpace.origin=r},redo:()=>{n=t.transform?.clone(),r=(0,d.o8)(i.origin),t.transform=s,t.vertexSpace.origin=o}}}(t,t.transform,t.vertexSpace):function(t){let e,i=t.vertexAttributes.clonePositional();return{undo:()=>{e=t.vertexAttributes.clonePositional(),t.vertexAttributes=i},redo:()=>{i=t.vertexAttributes.clonePositional(),t.vertexAttributes=e}}}(t)}(t):function(t){let e=t,i=null;return{undo(t){i=t.geometry,t.geometry=e},redo(t){e=t.geometry,t.geometry=i}}}(t)}(t)}};(0,n._)([(0,h.MZ)({constructOnly:!0})],Fa.prototype,"view",void 0),(0,n._)([(0,h.MZ)({constructOnly:!0})],Fa.prototype,"graphic",void 0),(0,n._)([(0,h.MZ)()],Fa.prototype,"_operations",void 0),(0,n._)([(0,h.MZ)()],Fa.prototype,"operations",null),(0,n._)([(0,h.MZ)()],Fa.prototype,"updating",null),Fa=(0,n._)([(0,c.$)("esri.views.3d.interactive.editingTools.ManipulatedObject3DGraphic")],Fa)},76589:function(t,e,i){"use strict";i.d(e,{F:function(){return s}});var n=i(32e3),r=i(68546);class s{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(t){this._unit=t,this._metersPerElevationInfoUnit=(0,n.Ao)(t)}get requiresSampledElevationInfo(){return"absolute-height"!==this.mode}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(t){this._meterUnitOffset=t,this._renderUnitOffset=0}set offsetElevationInfoUnits(t){this._meterUnitOffset=t*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(t){this._renderUnitOffset+=t}geometryZWithOffset(t,e){const i=this.calculateOffsetRenderUnits(e);return null!=this.featureExpressionInfoContext?i:t+i}calculateOffsetRenderUnits(t){let e=this._meterUnitOffset;const i=this.featureExpressionInfoContext;return null!=i&&(e+=(0,r.g7)(i)*this._metersPerElevationInfoUnit),e/t.unitInMeters+this._renderUnitOffset}setFromElevationInfo(t){this.mode=t.mode,this.unit=(0,n.Tg)(t.unit)?t.unit:"meters",this.offsetElevationInfoUnits=t.offset??0}updateFeatureExpressionInfoContext(t,e,i){if(null==t)return void(this._featureExpressionInfoContext=null);const n=t?.arcade;n&&null!=e&&null!=i?(this._featureExpressionInfoContext=(0,r.o8)(t),(0,r.gf)(this._featureExpressionInfoContext,(0,r.VG)(n.modules,e,i))):this._featureExpressionInfoContext=t}static fromElevationInfo(t){const e=new s;return null!=t&&e.setFromElevationInfo(t),e}}},49618:function(t,e,i){"use strict";i.d(e,{I2:function(){return v},Kf:function(){return y},Uk:function(){return w},ai:function(){return b},au:function(){return f},fe:function(){return _},nG:function(){return g},nu:function(){return m},sE:function(){return p},uw:function(){return n}});var n,r,s=i(73364),o=i(39714),a=i(32501),h=i(7456),l=i(57617),c=i(5915),u=i(60516),d=i(65839);function f(t,e,i,n,r,s,o,a,h,c,u){const d=x[u.mode];let f,p,g=0;if((0,l.projectBuffer)(t,e,i,n,h.spatialReference,r,a))return d?.requiresAlignment(u)?(g=d.applyElevationAlignmentBuffer(n,r,s,o,a,h,c,u),f=s,p=o):(f=n,p=r),(0,l.projectBuffer)(f,h.spatialReference,p,s,c.spatialReference,o,a)?g:void 0}function p(t,e,i,n,r){const s=((0,c.v)(t)?t.z:(0,u.cN)(t)?t.array[t.offset+2]:t[2])||0;switch(i.mode){case"on-the-ground":{const i=(0,u.R1)(e,t,"ground")??0;return r.verticalDistanceToGround=0,r.sampledElevation=i,void(r.z=i)}case"relative-to-ground":{const o=(0,u.R1)(e,t,"ground")??0,a=i.geometryZWithOffset(s,n);return r.verticalDistanceToGround=a,r.sampledElevation=o,void(r.z=a+o)}case"relative-to-scene":{const o=(0,u.R1)(e,t,"scene")??0,a=i.geometryZWithOffset(s,n);return r.verticalDistanceToGround=a,r.sampledElevation=o,void(r.z=a+o)}case"absolute-height":{const o=i.geometryZWithOffset(s,n),a=(0,u.R1)(e,t,"ground")??0;return r.verticalDistanceToGround=o-a,r.sampledElevation=a,void(r.z=o)}default:return void(r.z=0)}}function g(t,e,i,n){return p(t,e,i,n,A),A.z}function v(t,e,i){return"on-the-ground"===e&&"on-the-ground"===i?t.staysOnTheGround:e===i||"on-the-ground"!==e&&"on-the-ground"!==i?null==e||null==i?t.definedChanged:n.UPDATE:t.onTheGroundChanged}function m(t){return"relative-to-ground"===t||"relative-to-scene"===t}function y(t){return"absolute-height"!==t}function _(t,e,i,n,r){p(e,i,r,n,A),b(t,A.verticalDistanceToGround);const o=A.sampledElevation,a=(0,s.C)(T,t.transformation);return M[0]=e.x,M[1]=e.y,M[2]=A.z,(0,h.l)(e.spatialReference,M,a,n.spatialReference)?t.transformation=a:console.warn("Could not locate symbol object properly, it might be misplaced"),o}function b(t,e){for(let i=0;i<t.geometries.length;++i){const n=t.geometries[i].getMutableAttribute(d.r.CENTEROFFSETANDDISTANCE);n&&n.data[3]!==e&&(n.data[3]=e,t.geometryVertexAttributeUpdated(t.geometries[i],d.r.CENTEROFFSETANDDISTANCE))}}class w{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}}(r=n||(n={}))[r.NONE=0]="NONE",r[r.UPDATE=1]="UPDATE",r[r.RECREATE=2]="RECREATE";const x={"absolute-height":{applyElevationAlignmentBuffer:function(t,e,i,n,r,s,o,a){const h=a.calculateOffsetRenderUnits(o),l=a.featureExpressionInfoContext;e*=3,n*=3;for(let s=0;s<r;++s){const r=t[e],s=t[e+1],o=t[e+2];i[n]=r,i[n+1]=s,i[n+2]=null==l?o+h:h,e+=3,n+=3}return 0},requiresAlignment:function(t){const e=t.meterUnitOffset,i=t.featureExpressionInfoContext;return 0!==e||null!=i}},"on-the-ground":{applyElevationAlignmentBuffer:function(t,e,i,n,r,s){let o=0;const a=s.spatialReference;e*=3,n*=3;for(let h=0;h<r;++h){const r=t[e],h=t[e+1],l=t[e+2],c=s.getElevation(r,h,l,a,"ground")??0;o+=c,i[n]=r,i[n+1]=h,i[n+2]=c,e+=3,n+=3}return o/r},requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:function(t,e,i,n,r,s,o,a){let h=0;const l=a.calculateOffsetRenderUnits(o),c=a.featureExpressionInfoContext,u=s.spatialReference;e*=3,n*=3;for(let o=0;o<r;++o){const r=t[e],o=t[e+1],a=t[e+2],d=s.getElevation(r,o,a,u,"ground")??0;h+=d,i[n]=r,i[n+1]=o,i[n+2]=null==c?a+d+l:d+l,e+=3,n+=3}return h/r},requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:function(t,e,i,n,r,s,o,a){let h=0;const l=a.calculateOffsetRenderUnits(o),c=a.featureExpressionInfoContext,u=s.spatialReference;e*=3,n*=3;for(let o=0;o<r;++o){const r=t[e],o=t[e+1],a=t[e+2],d=s.getElevation(r,o,a,u,"scene")??0;h+=d,i[n]=r,i[n+1]=o,i[n+2]=null==c?a+d+l:d+l,e+=3,n+=3}return h/r},requiresAlignment:()=>!0}},T=(0,o.vt)(),A=new w,M=(0,a.vt)()},68546:function(t,e,i){"use strict";i.d(e,{KF:function(){return p},MF:function(){return f},VG:function(){return c},g7:function(){return d},gf:function(){return u},o8:function(){return h},q6:function(){return l}});var n=i(40633),r=i(60539),s=i(45328),o=i(54547);const a=()=>n.A.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function h(t){return{cachedResult:t.cachedResult,arcade:t.arcade?{func:t.arcade.func,context:t.arcade.modules.arcadeUtils.createExecContext(null,{sr:t.arcade.context.spatialReference}),modules:t.arcade.modules}:null}}async function l(t,e,i,n){const s=t?.expression;if("string"!=typeof s)return null;const a=function(t){return"0"===t?0:null}(s);if(null!=a)return{cachedResult:a};const h=await(0,o.lw)();(0,r.Te)(i);const l=h.arcadeUtils,c=l.createSyntaxTree(s);return l.dependsOnView(c)?(null!=n&&n.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:l.createFunction(c),context:l.createExecContext(null,{sr:e}),modules:h}}}function c(t,e,i){return t.arcadeUtils.createFeature(e.attributes,e.geometry,i)}function u(t,e){if(null!=t&&!g(t)){if(!e||!t.arcade)return void a().errorOncePerTick("Arcade support required but not provided");const i=e;i._geometry&&(i._geometry=(0,s.wZ)(i._geometry)),t.arcade.modules.arcadeUtils.updateExecContext(t.arcade.context,e)}}function d(t){if(null!=t){if(g(t))return t.cachedResult;const e=t.arcade;let i=e?.modules.arcadeUtils.executeFunction(e.func,e.context);return"number"!=typeof i&&(t.cachedResult=0,i=0),i}return 0}function f(t,e=!1){let i=t?.featureExpressionInfo;const n=i?.expression;return e||"0"===n||(i=null),i??null}const p={cachedResult:0};function g(t){return null!=t.cachedResult}},75302:function(t,e,i){"use strict";i.d(e,{$2:function(){return M},$C:function(){return w},Hj:function(){return T},Mh:function(){return A},W$:function(){return m},pW:function(){return x},t8:function(){return b},vY:function(){return S}});var n=i(62938),r=i(73364),s=i(39714),o=i(32501),a=i(33400),h=i(41546),l=i(46157),c=i(24761),u=i(87416),d=i(72228),f=i(38441),p=i(67376),g=i(46460),v=i(45328);function m(t,e){if("point"===t.type)return _(t,e,!1);if((0,v.gr)(t))switch(t.type){case"extent":return _(t.center,e,!1);case"polygon":return _(t.centroid,e,!1);case"polyline":return _(y(t),e,!0);case"mesh":return _((0,p.MW)(t.vertexSpace,t.spatialReference)??t.extent.center,e,!1);case"multipoint":return}else switch(t.type){case"extent":return _(function(t){return(0,g.T)(.5*(t.xmax+t.xmin),.5*(t.ymax+t.ymin),null!=t.zmin&&null!=t.zmax&&isFinite(t.zmin)&&isFinite(t.zmax)?.5*(t.zmax+t.zmin):void 0,t.spatialReference)}(t),e,!0);case"polygon":return _(function(t){const e=t.rings[0];if(!e||0===e.length)return null;const i=(0,d.S8)(t.rings,!!t.hasZ);return(0,g.T)(i[0],i[1],i[2],t.spatialReference)}(t),e,!0);case"polyline":return _(y(t),e,!0);case"multipoint":return}}function y(t){const e=t.paths[0];if(!e||0===e.length)return null;const i=(0,f.$H)(e,(0,f.Yl)(e)/2);return(0,g.T)(i[0],i[1],i[2],t.spatialReference)}function _(t,e,i){const n=i?t:(0,v.EL)(t);return e&&t?(0,l.projectPoint)(t,n,e)?n:null:n}function b(t,e,i,n=0){if(t){e||(e=(0,u.vt)());const r=t;let s=.5*r.width*(i-1),o=.5*r.height*(i-1);return r.width<1e-7*r.height?s+=o/20:r.height<1e-7*r.width&&(o+=s/20),(0,a.s)(e,r.xmin-s-n,r.ymin-o-n,r.xmax+s+n,r.ymax+o+n),e}return null}function w(t,e,i=null){const n=(0,h.o8)(h.Un);return null!=t&&(n[0]=t[0],n[1]=t[1],n[2]=t[2]),null!=e?n[3]=e:null!=t&&t.length>3&&(n[3]=t[3]),i&&(n[0]*=i,n[1]*=i,n[2]*=i,n[3]*=i),n}function x(t=o.Un,e,i,n=1){const r=new Array(3);if(null==e||null==i)r[0]=1,r[1]=1,r[2]=1;else{let n,s=0;for(let o=2;o>=0;o--){const a=t[o];let h;const l=null!=a,c=0===o&&!n&&!l,u=i[o];"symbol-value"===a||c?h=0!==u?e[o]/u:1:l&&"proportional"!==a&&isFinite(a)&&(h=0!==u?a/u:1),null!=h&&(r[o]=h,n=h,s=Math.max(s,Math.abs(h)))}for(let t=2;t>=0;t--)null==r[t]?r[t]=n:0===r[t]&&(r[t]=.001*s)}for(let t=2;t>=0;t--)r[t]/=n;return(0,o.ci)(r)}function T(t){return A(function(t){return null!=t.isPrimitive}(t)?[t.width,t.depth,t.height]:t)?null:"Symbol sizes may not be negative values"}function A(t){const e=t=>null==t||t>=0;return Array.isArray(t)?t.every(e):e(t)}function M(t,e,i,n=(0,s.vt)()){return t&&(0,r.Qr)(n,n,-t/180*Math.PI),e&&(0,r.eL)(n,n,e/180*Math.PI),i&&(0,r.Z8)(n,n,i/180*Math.PI),n}function S(t,e,i){if(null!=i.minDemResolution)return i.minDemResolution;const r=(0,n.GA)(e),s=(0,c.VL)(t)*r,o=(0,c.yr)(t)*r,a=(0,c.uJ)(t)*(e.isGeographic?1:r);return 0===s&&0===o&&0===a?i.minDemResolutionForPoints:.01*Math.max(s,o,a)}},46949:function(t,e,i){"use strict";var n,r,s;i.d(e,{O7:function(){return r},Om:function(){return n},sv:function(){return s}}),function(t){t[t.RasterImage=0]="RasterImage",t[t.Features=1]="Features"}(n||(n={})),function(t){t[t.MapLayer=0]="MapLayer",t[t.ViewLayer=1]="ViewLayer",t[t.Outline=2]="Outline",t[t.SnappingHint=3]="SnappingHint"}(r||(r={})),function(t){t[t.WithRasterImage=0]="WithRasterImage",t[t.WithoutRasterImage=1]="WithoutRasterImage"}(s||(s={}))},24129:function(t,e,i){"use strict";i.d(e,{Gd:function(){return L},J_:function(){return N},VC:function(){return k},b3:function(){return j},s_:function(){return P},ul:function(){return F},wI:function(){return O}}),i(58941);var n,r,s,o=i(15774),a=i(44705),h=i(87725),l=i(73364),c=i(39714),u=i(20551),d=i(32501),f=i(85031),p=i(70974),g=i(39506);(s=n||(n={}))[s.Undefined=0]="Undefined",s[s.DefinedSize=1]="DefinedSize",s[s.DefinedScale=2]="DefinedScale",function(t){t[t.Undefined=0]="Undefined",t[t.DefinedAngle=1]="DefinedAngle"}(r||(r={}));class v{constructor(t){this.field=t}}class m extends v{constructor(t){super(t),this.minSize=[0,0,0],this.maxSize=[0,0,0],this.offset=[0,0,0],this.factor=[0,0,0],this.type=[n.Undefined,n.Undefined,n.Undefined]}}class y extends v{constructor(t){super(t),this.colors=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.values=[0,0,0,0,0,0,0,0]}}class _ extends v{constructor(t){super(t),this.values=[0,0,0,0,0,0,0,0],this.opacityValues=[0,0,0,0,0,0,0,0]}}class b{}function w(t){return null!=t}function x(t){return"number"==typeof t}function T(t){return"string"==typeof t}function A(t,e){t&&t.push(e)}function M(t,e,i,r,s){const o=t.minSize,a=t.maxSize;if(t.useSymbolValue){const t=r.symbolSize[i];return e.minSize[i]=t,e.maxSize[i]=t,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=n.DefinedSize,!0}if(w(t.field))return w(t.stops)?2===t.stops.length&&x(t.stops[0].size)&&x(t.stops[1].size)?(S(t.stops[0].size,t.stops[1].size,t.stops[0].value,t.stops[1].value,e,i),e.type[i]=n.DefinedSize,!0):(A(s,"Could not convert size info: stops only supported with 2 elements"),!1):x(o)&&x(a)&&w(t.minDataValue)&&w(t.maxDataValue)?(S(o,a,t.minDataValue,t.maxDataValue,e,i),e.type[i]=n.DefinedSize,!0):"unknown"===t.valueUnit?(A(s,"Could not convert size info: proportional size not supported"),!1):null!=f.j[t.valueUnit]?(e.minSize[i]=-1/0,e.maxSize[i]=1/0,e.offset[i]=0,e.factor[i]=1/f.j[t.valueUnit],e.type[i]=n.DefinedSize,!0):(A(s,"Could not convert size info: scale-dependent size not supported"),!1);if(!w(t.field)){if(t.stops?.[0]&&x(t.stops[0].size))return e.minSize[i]=t.stops[0].size,e.maxSize[i]=t.stops[0].size,e.offset[i]=e.minSize[i],e.factor[i]=0,e.type[i]=n.DefinedSize,!0;if(x(o))return e.minSize[i]=o,e.maxSize[i]=o,e.offset[i]=o,e.factor[i]=0,e.type[i]=n.DefinedSize,!0}return A(s,"Could not convert size info: unsupported variant of sizeInfo"),!1}function S(t,e,i,n,r,s){const o=Math.abs(n-i)>0?(e-t)/(n-i):0;r.minSize[s]=o>0?t:e,r.maxSize[s]=o>0?e:t,r.offset[s]=t-i*o,r.factor[s]=o}function E(t,e,i){t[4*e]=i.r/255,t[4*e+1]=i.g/255,t[4*e+2]=i.b/255,t[4*e+3]=i.a}function C(t,e,i){const n=2===i&&"arithmetic"===t.rotationType;e.offset[i]=n?90:0,e.factor[i]=n?-1:1,e.type[i]=1}class O{constructor(t,e=[1,1,1],i=[1,1,1],n=1,r=[0,0,0],s=[1,1,1],o=[0,0,0]){this.supports=t,this.modelSize=e,this.symbolSize=i,this.unitInMeters=n,this.anchor=r,this.scale=s,this.rotation=o}}function R(t,e,i){if(!t)return null;const r=t.reduce(((t,n)=>{if(!t)return t;if(n.valueExpression)return A(i,"Could not convert visual variables: arcade expressions not supported"),null;switch(n.type){case"size":return e.supports.size?function(t,e,i,n){if(t.normalizationField||t.valueRepresentation)return A(n,"Could not convert size info: unsupported property"),null;if(!function(t){return null==t||T(t)}(t.field))return A(n,"Could not convert size info: field is not a string"),null;if(e.size){if(t.field)if(e.size.field){if(t.field!==e.size.field)return A(n,"Could not convert size info: multiple fields in use"),null}else e.size.field=t.field}else e.size=new m(t.field);let r;switch(t.axis){case"width":return r=M(t,e.size,0,i,n),r?e:null;case"height":return r=M(t,e.size,2,i,n),r?e:null;case"depth":return r=M(t,e.size,1,i,n),r?e:null;case"width-and-depth":return r=M(t,e.size,0,i,n),r&&M(t,e.size,1,i,n),r?e:null;case null:case void 0:case"all":return r=M(t,e.size,0,i,n),r=r&&M(t,e.size,1,i,n),r=r&&M(t,e.size,2,i,n),r?e:null;default:return A(n,`Could not convert size info: unknown axis "${t.axis}""`),null}}(n,t,e,i):t;case"color":return e.supports.color?function(t,e,i){if(t.normalizationField)return A(i,"Could not convert color info: unsupported property"),null;if(T(t.field)){if(!t.stops)return A(i,"Could not convert color info: missing stops or colors"),null;{if(t.stops.length>8)return A(i,"Could not convert color info: too many color stops"),null;e.color=new y(t.field);const n=t.stops;for(let t=0;t<8;++t){const i=n[Math.min(t,n.length-1)];e.color.values[t]=i.value,E(e.color.colors,t,i.color)}}}else{if(!(t.stops&&t.stops.length>=0))return A(i,"Could not convert color info: no field and no colors/stops"),null;{const i=t.stops&&t.stops.length>=0&&t.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(let t=0;t<8;t++)e.color.values[t]=1/0,E(e.color.colors,t,i)}}return e}(n,t,i):t;case"opacity":return e.supports.opacity?function(t,e,i){if(t.normalizationField)return A(i,"Could not convert opacity info: unsupported property"),null;if(T(t.field)){if(!t.stops)return A(i,"Could not convert opacity info: missing stops or opacities"),null;{if(t.stops.length>8)return A(i,"Could not convert opacity info: too many opacity stops"),null;e.opacity=new _(t.field);const n=t.stops;for(let t=0;t<8;++t){const i=n[Math.min(t,n.length-1)];e.opacity.values[t]=i.value,e.opacity.opacityValues[t]=i.opacity}}}else{if(!(t.stops&&t.stops.length>=0))return A(i,"Could not convert opacity info: no field and no opacities/stops"),null;{const i=t.stops&&t.stops.length>=0?t.stops[0].opacity:0;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(let t=0;t<8;t++)e.opacity.values[t]=1/0,e.opacity.opacityValues[t]=i}}return e}(n,t,i):null;case"rotation":return e.supports.rotation?function(t,e,i){if(!T(t.field))return A(i,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(t.field)if(e.rotation.field){if(t.field!==e.rotation.field)return A(i,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=t.field}else e.rotation={field:t.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(t.axis){case"tilt":return C(t,e.rotation,0),e;case"roll":return C(t,e.rotation,1),e;case null:case void 0:case"heading":return C(t,e.rotation,2),e;default:return A(i,`Could not convert rotation info: unknown axis "${t.axis}""`),null}}(n,t,i):t;default:return null}}),new b);return!(t.length>0&&r)||r.size||r.color||r.opacity||r.rotation?r?.size&&!function(t,e,i){for(let i=0;i<3;++i){let r=e.unitInMeters;t.type[i]===n.DefinedSize&&(r*=e.modelSize[i],t.type[i]=n.DefinedScale),t.minSize[i]=t.minSize[i]/r,t.maxSize[i]=t.maxSize[i]/r,t.offset[i]=t.offset[i]/r,t.factor[i]=t.factor[i]/r}let r;if(t.type[0]!==n.Undefined)r=0;else if(t.type[1]!==n.Undefined)r=1;else{if(t.type[2]===n.Undefined)return A(i,"No size axis contains a valid size or scale"),!1;r=2}for(let e=0;e<3;++e)t.type[e]===n.Undefined&&(t.minSize[e]=t.minSize[r],t.maxSize[e]=t.maxSize[r],t.offset[e]=t.offset[r],t.factor[e]=t.factor[r],t.type[e]=t.type[r]);return!0}(r.size,e,i)?null:r:null}class I{constructor(t,e,i){this.visualVariables=t,this.materialParameters=e,this.requiresShaderTransformation=i}}function P(t,e){if(!t)return null;if(p.b.TESTS_DISABLE_FAST_UPDATES)return null;const i=R(t.visualVariables,e);return i?new I(i,z(i,e),!!i.size):null}function N(t,e,i){if(!e||!t)return!1;const n=t.visualVariables,r=R(e.visualVariables,i);return!!r&&!!(D(n.size,r.size,"size")&&D(n.color,r.color,"color")&&D(n.rotation,r.rotation,"rotation")&&D(n.opacity,r.opacity,"opacity"))&&(t.visualVariables=r,t.materialParameters=z(r,i),t.requiresShaderTransformation=!!r.size,!0)}function D(t,e,i){if(!!t!=!!e)return!1;if(t&&t.field!==e?.field)return!1;if(t&&"rotation"===i){const i=t,n=e;for(let t=0;t<3;t++)if(i.type[t]!==n.type[t]||i.offset[t]!==n.offset[t]||i.factor[t]!==n.factor[t])return!1}return!0}class L extends g.Y{constructor(t){super(),this.vvSize=t?.size??null,this.vvColor=t?.color??null,this.vvOpacity=t?.opacity??null}}function z(t,e){const i=new L(t);return i.vvSize&&(i.vvSymbolAnchor=e.anchor,(0,l.D_)(G),function(t,e,i,n=(0,c.vt)()){const r=t||0,s=e||0,o=i||0;0!==r&&(0,l.Qr)(n,n,-r/180*Math.PI),0!==s&&(0,l.eL)(n,n,s/180*Math.PI),0!==o&&(0,l.Z8)(n,n,o/180*Math.PI)}(e.rotation[2],e.rotation[0],e.rotation[1],G),i.vvSymbolRotationMatrix=i.vvSymbolRotationMatrix||(0,h.vt)(),(0,a.z0)(i.vvSymbolRotationMatrix,G)),i}function j(t,e,i){if(!t.vvSize)return i;(0,l.C)(H,i);const n=t.vvSymbolRotationMatrix;(0,l.hZ)(G,n[0],n[1],n[2],0,n[3],n[4],n[5],0,n[6],n[7],n[8],0,0,0,0,1),(0,l.lw)(H,H,G);for(let i=0;i<3;++i){const n=t.vvSize.offset[i]+e[0]*t.vvSize.factor[i];B[i]=(0,o.qE)(n,t.vvSize.minSize[i],t.vvSize.maxSize[i])}return(0,l.hs)(H,H,B),(0,l.Tl)(H,H,t.vvSymbolAnchor),H}function k(t,e,i){if(!e.vvSize)return(0,u.i)(t,1,1,1),t;for(let n=0;n<3;++n){const r=e.vvSize.offset[n]+i[0]*e.vvSize.factor[n];t[n]=(0,o.qE)(r,e.vvSize.minSize[n],e.vvSize.maxSize[n])}return t}function F(t,e){const i=null==t?0:e.attributes[t];return"number"==typeof i&&isFinite(i)?i:0}const H=(0,c.vt)(),B=(0,d.vt)(),G=(0,c.vt)()},60516:function(t,e,i){"use strict";i.d(e,{R1:function(){return o},aY:function(){return r},cN:function(){return s}});var n=i(5915);class r{constructor(t,e=null,i=0){this.array=t,this.spatialReference=e,this.offset=i}}function s(t){return"array"in t}function o(t,e,i="ground"){if((0,n.v)(e))return t.getElevation(e.x,e.y,e.z||0,e.spatialReference,i);if(s(e)){let n=e.offset;return t.getElevation(e.array[n++],e.array[n++],e.array[n]||0,e.spatialReference??t.spatialReference,i)}return t.getElevation(e[0],e[1],e[2]||0,t.spatialReference,i)}},12378:function(t,e,i){"use strict";i.d(e,{d:function(){return E}});var n=i(15774),r=i(62938),s=i(73364),o=i(20551),a=i(61714),h=i(96611),l=i(56763),c=i(56919),u=i(68734),d=i(87416),f=i(72485),p=i(32501),g=(i(57165),i(2075)),v=i(13794);function m(t,e,i=function(t){return{operations:t,value:t.create()}}(t)){return i.operations=t,t.copy(e,i.value),i}const y=2**50;function _(t,e,i,n){return t.operations.setAltitudeAt(t.value,e,i,n)}function b(t,e,i){return t.operations.elevate(t.value,e,i.value)}const w=(0,p.vt)();(0,p.vt)();var x=i(5596),T=i(29531),A=i(50973),M=i(5915),S=i(65420);class E{constructor(t,e,i,n){this.viewingMode=t,this.spatialReference=e,this.unitInMeters=i,this._coordinateSystem=n,this._tmpCoordinateSystem=function(t){const{value:e,operations:i}=t;return{operations:i,value:i.create(e)}}(n),this.referenceEllipsoid=(0,a.tO)(e),this.sphericalPCPF=(0,h.lO)(e)}set extent(t){t&&function(t,e,i){t.operations.setExtent(t.value,e,i.value)}(this._coordinateSystem,t,this._coordinateSystem)}get extent(){return t=this._coordinateSystem,e=(0,d.vt)(),t.operations.getExtent(t.value,e),e;var t,e}getAltitude(t){return function(t,e){return t.operations.altitudeAt(t.value,e)}(this._coordinateSystem,t)}setAltitude(t,e,i=t){return _(this._coordinateSystem,i,e,t)}setAltitudeOfTransformation(t,e){var i,n,r,a;i=this._coordinateSystem,r=t,(n=e)!==(a=e)&&(0,s.C)(a,n),(0,o.i)(w,a[12],a[13],a[14]),_(i,w,r,w),a[12]=w[0],a[13]=w[1],a[14]=w[2]}worldUpAtPosition(t,e){return function(t,e,i){return t.operations.axisAt(t.value,e,f._.Z,i)}(this._coordinateSystem,t,e)}worldBasisAtPosition(t,e,i){return function(t,e,i,n){return t.operations.axisAt(t.value,e,i,n)}(this._coordinateSystem,t,e,i)}basisMatrixAtPosition(t,e){const i=this.worldBasisAtPosition(t,f._.X,A.rq.get()),n=this.worldBasisAtPosition(t,f._.Y,A.rq.get()),r=this.worldBasisAtPosition(t,f._.Z,A.rq.get());return(0,s.hZ)(e,i[0],i[1],i[2],0,n[0],n[1],n[2],0,r[0],r[1],r[2],0,0,0,0,1),e}headingAtPosition(t,e){const i=this.worldUpAtPosition(t,A.rq.get()),r=this.worldBasisAtPosition(t,f._.Y,A.rq.get()),s=(0,T.EJ)(e,r,i);return(0,n.KJ)(s)}intersectManifoldClosestSilhouette(t,e,i){return b(this._coordinateSystem,e,this._tmpCoordinateSystem),function(t,e,i){t.operations.intersectRayClosestSilhouette(t.value,e,i)}(this._tmpCoordinateSystem,t,i),i}intersectManifold(t,e,i){b(this._coordinateSystem,e,this._tmpCoordinateSystem);const n=A.rq.get();return function(t,e,i){return t.operations.intersectRay(t.value,e,i)}(this._tmpCoordinateSystem,t,n)?(0,o.c)(i,n):null}intersectInfiniteManifold(t,e,i){if(this.viewingMode===S.RT.Global)return this.intersectManifold(t,e,i);b(this._coordinateSystem,e,this._tmpCoordinateSystem);const n=this._tmpCoordinateSystem.value,r=A.rq.get();return(0,x.Ui)(n.plane,t,r)?(0,o.c)(i,r):null}toRenderCoords(t,e,i){return(0,M.v)(t)?(0,l.g)(t,e,this.spatialReference):(0,u.F)(t,e,i,this.spatialReference)}fromRenderCoords(t,e,i=null){return(0,M.v)(e)?(null!=i&&(e.spatialReference=i),(0,c.E)(t,this.spatialReference,e)?e:null):(0,u.F)(t,this.spatialReference,e,i)?e:null}static create(t,e){switch(t){case S.RT.Local:return new E(S.RT.Local,e,(0,r.GA)(e),m(g.b,(0,g.f)([0,0,0],[y,0,0],[0,y,0])));case S.RT.Global:return new E(S.RT.Global,e,1,function(t){return m(v.s,(0,v.f)(0,0,0,(0,a.tO)(t).radius))}(e))}}static renderUnitScaleFactor(t,e){return(0,r.KX)(t)/(0,r.KX)(e)}}},65856:function(t,e,i){"use strict";i.d(e,{BP:function(){return h},l5:function(){return l},q3:function(){return a}});var n=i(92754),r=i(28404),s=i(90553);class o{constructor(t,e){this.layout=t,this.buffer="number"==typeof e?new ArrayBuffer(e*t.stride):e;for(const e of t.fields.keys()){const i=t.fields.get(e);this[e]=new i.constructor(this.buffer,i.offset,this.stride)}}get stride(){return this.layout.stride}get count(){return this.buffer.byteLength/this.stride}get byteLength(){return this.buffer.byteLength}getField(t,e){const i=this[t];return i&&i.elementCount===e.ElementCount&&i.elementType===e.ElementType?i:null}slice(t,e){return new o(this.layout,this.buffer.slice(t*this.stride,e*this.stride))}copyFrom(t,e=0,i=0,n=t.count){const r=this.stride;if(r%4==0){const s=new Uint32Array(t.buffer,e*r,n*r/4);new Uint32Array(this.buffer,i*r,n*r/4).set(s)}else{const s=new Uint8Array(t.buffer,e*r,n*r);new Uint8Array(this.buffer,i*r,n*r).set(s)}return this}get usedMemory(){return this.byteLength}dispose(){}}class a{constructor(t){this._stride=0,this._lastAligned=0,this._fields=new Map,t&&(this._stride=t.stride,t.fields.forEach((t=>this._fields.set(t[0],{...t[1],constructor:d(t[1].constructor)}))))}freeze(){return this}vec2f(t,e){return this._appendField(t,n.gH,e),this}vec2f64(t,e){return this._appendField(t,n.si,e),this}vec3f(t,e){return this._appendField(t,n.xs,e),this}vec3f64(t,e){return this._appendField(t,n.Xm,e),this}vec4f(t,e){return this._appendField(t,n.Eq,e),this}vec4f64(t,e){return this._appendField(t,n.Aj,e),this}mat3f(t,e){return this._appendField(t,n.jZ,e),this}mat3f64(t,e){return this._appendField(t,n.j0,e),this}mat4f(t,e){return this._appendField(t,n.Sx,e),this}mat4f64(t,e){return this._appendField(t,n.E$,e),this}vec4u8(t,e){return this._appendField(t,n.XP,e),this}f32(t,e){return this._appendField(t,n.Y$,e),this}f64(t,e){return this._appendField(t,n.qB,e),this}u8(t,e){return this._appendField(t,n.SL,e),this}u16(t,e){return this._appendField(t,n.h,e),this}i8(t,e){return this._appendField(t,n.bf,e),this}vec2i8(t,e){return this._appendField(t,n.D6,e),this}vec2i16(t,e){return this._appendField(t,n.mJ,e),this}vec2u8(t,e){return this._appendField(t,n.LC,e),this}vec4u16(t,e){return this._appendField(t,n.Uz,e),this}u32(t,e){return this._appendField(t,n.P,e),this}_appendField(t,e,i){if(this._fields.has(t))return void(0,s.vA)(!1,`${t} already added to vertex buffer layout`);const n=e.ElementCount*(0,r.GJ)(e.ElementType),o=this._stride;this._stride+=n,this._fields.set(t,{size:n,constructor:e,offset:o,optional:i})}createBuffer(t){return new o(this,t)}createView(t){return new o(this,t)}clone(){const t=new a;return t._stride=this._stride,t._fields=new Map,this._fields.forEach(((e,i)=>t._fields.set(i,e))),t.BufferType=this.BufferType,t}get stride(){if(this._lastAligned!==this._fields.size){let t=1;this._fields.forEach((e=>t=Math.max(t,(0,r.GJ)(e.constructor.ElementType)))),this._stride=Math.floor((this._stride+t-1)/t)*t,this._lastAligned=this._fields.size}return this._stride}get fields(){return this._fields}}function h(){return new a}class l{constructor(t){this.fields=new Array,t.fields.forEach(((t,e)=>{const i={...t,constructor:u(t.constructor)};this.fields.push([e,i])})),this.stride=t.stride}}const c=[n.Y$,n.gH,n.xs,n.Eq,n.jZ,n.Sx,n.qB,n.si,n.Xm,n.Aj,n.j0,n.E$,n.SL,n.LC,n.eI,n.XP,n.h,n.Yi,n.nS,n.Uz,n.P,n.An,n.H$,n.ml,n.bf,n.D6,n.m8,n.TX,n.Qt,n.mJ,n.Vp,n.E7,n.My,n.UL,n.zD,n.Y4];function u(t){return`${t.ElementType}_${t.ElementCount}`}function d(t){return f.get(t)}const f=new Map;c.forEach((t=>f.set(u(t),t)))},69550:function(t,e,i){"use strict";i.d(e,{U:function(){return s}});var n=i(85456),r=i(3817);function s(t,e=0){const i=t.stride;return Array.from(t.fields.keys()).map((n=>{const s=t.fields.get(n),a=s.constructor.ElementCount,h=o(s.constructor.ElementType),l=s.offset,c=s.optional?.glNormalized??!1;return new r._(n,a,h,l,i,c,e)}))}function o(t){const e=a[t];if(e)return e;throw new Error("BufferType not supported in WebGL")}const a={u8:n.pe.UNSIGNED_BYTE,u16:n.pe.UNSIGNED_SHORT,u32:n.pe.UNSIGNED_INT,i8:n.pe.BYTE,i16:n.pe.SHORT,i32:n.pe.INT,f32:n.pe.FLOAT}},70974:function(t,e,i){"use strict";i.d(e,{b:function(){return h}});var n=i(53804),r=i(83525),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953));let a=class extends r.A{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1}};(0,n._)([(0,s.MZ)()],a.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"DECONFLICTOR_SHOW_GRID",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"LABELS_SHOW_BORDER",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"TEXT_SHOW_BASELINE",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"TEXT_SHOW_BORDER",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"OVERLAY_SHOW_CENTER",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"SHOW_POI",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"I3S_TREE_SHOW_TILES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"I3S_SHOW_MODIFICATIONS",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"LINE_WIREFRAMES",void 0),a=(0,n._)([(0,o.$)("esri.views.3d.support.debugFlags")],a);const h=new a},79366:function(t,e,i){"use strict";i.d(e,{t:function(){return v},z:function(){return _}});var n=i(13786),r=i(1932),s=i(41546),o=i(61714),a=i(61441),h=i(50240),l=i(5047),c=i(37819),u=i(65420),d=i(14905),f=i(40359),p=i(89769),g=i(65839);function v(t,e,i=null){const r=[],v=e.mapPositions;!function(t,e){const{attributeData:{position:i},removeDuplicateStartEnd:n}=t,r=function(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}(i)&&n,s=i.length/3-(r?1:0),o=new Array(2*(s-1)),a=r?i.slice(0,-3):i;let h=0;for(let t=0;t<s-1;t++)o[h++]=t,o[h++]=t+1;e.push([g.r.POSITION,new d.n(a,o,3,r)])}(e,r);const _=r[0][1].data,b=r[0][1].indices.length,w=(0,c.EH)(b);return function(t,e,i){if(null!=t.attributeData.colorFeature)return;const n=t.attributeData.color;e.push([g.r.COLOR,new d.n(n??s.Un,i,4)])}(e,r,w),function(t,e,i){null==t.attributeData.sizeFeature&&e.push([g.r.SIZE,new d.n([t.attributeData.size??1],i,1,!0)])}(e,r,w),function(t,e,i){t.attributeData.normal&&e.push([g.r.NORMAL,new d.n(t.attributeData.normal,i,3)])}(e,r,w),function(t,e,i){null!=t.attributeData.colorFeature&&e.push([g.r.COLORFEATUREATTRIBUTE,new d.n([t.attributeData.colorFeature],i,1,!0)])}(e,r,w),function(t,e,i){null!=t.attributeData.sizeFeature&&e.push([g.r.SIZEFEATUREATTRIBUTE,new d.n([t.attributeData.sizeFeature],i,1,!0)])}(e,r,w),function(t,e,i){null!=t.attributeData.opacityFeature&&e.push([g.r.OPACITYFEATUREATTRIBUTE,new d.n([t.attributeData.opacityFeature],i,1,!0)])}(e,r,w),function(t,e,i){if(null==t.overlayInfo||t.overlayInfo.renderCoordsHelper.viewingMode!==u.RT.Global||!t.overlayInfo.spatialReference.isGeographic)return;const r=(0,h.jh)(i.length),s=(0,o.tO)(t.overlayInfo.spatialReference);for(let t=0;t<r.length;t+=3)(0,a.RC)(i,t,r,t,s);const c=i.length/3,f=(0,l.oe)(c+1);let p=m,v=y,_=0,b=0;(0,n.hZ)(p,r[b++],r[b++]),b++,f[0]=0;for(let t=1;t<c+1;++t)t===c&&(b=0),(0,n.hZ)(v,r[b++],r[b++]),b++,_+=(0,n.xg)(p,v),f[t]=_,[p,v]=[v,p];e.push([g.r.DISTANCETOSTART,new d.n(f,e[0][1].indices,1,!0)])}(e,r,_),new p.V(t,r,v,f.X.Line,i)}const m=(0,r.vt)(),y=(0,r.vt)();function _(t,e){if(null==t||0===t.length)return[];const i=[];return t.forEach((t=>{const n=t.length,r=(0,h.jh)(3*n);t.forEach(((t,e)=>{r[3*e]=t[0],r[3*e+1]=t[1],r[3*e+2]=t[2]}));const s={attributeData:{position:r,normal:e},removeDuplicateStartEnd:!1};i.push(s)})),i}},33710:function(t,e,i){"use strict";i.d(e,{Cz:function(){return r},DZ:function(){return o},PV:function(){return s},vO:function(){return n}}),i(98323),i(85456),i(12285),i(10956);const n=64,r=n/2,s=n/(r/5),o=.25},98323:function(t,e,i){"use strict";i.d(e,{CN:function(){return a},Q_:function(){return o},ny:function(){return h},sZ:function(){return l}}),i(58941);var n=i(5161),r=i(59552),s=i(85456);const o=128,a=.5;function h(t){return"cross"===t||"x"===t}function l(t,e=o,i=e*a,n=0){const h=function(t,e=o,i=e*a,n=0){switch(t){case"circle":default:return function(t,e){const i=t/2-.5;return p(t,d(i,i,e/2))}(e,i);case"square":return function(t,e){return c(t,e,!1)}(e,i);case"cross":return function(t,e,i=0){return u(t,e,!1,i)}(e,i,n);case"x":return function(t,e,i=0){return u(t,e,!0,i)}(e,i,n);case"kite":return function(t,e){return c(t,e,!0)}(e,i);case"triangle":return function(t,e){return p(t,f(t/2,e,e/2))}(e,i);case"arrow":return function(t,e){const i=e,n=e/2,r=t/2,s=.8*i,o=d(r,(t-e)/2-s,Math.sqrt(s*s+n*n)),a=f(r,i,n);return p(t,((t,e)=>Math.max(a(t,e),-o(t,e))))}(e,i)}}(t,e,i,n);return new r.g(h,{mipmap:!1,wrap:{s:s.pF.CLAMP_TO_EDGE,t:s.pF.CLAMP_TO_EDGE},width:e,height:e,components:4,noUnpackFlip:!0,reloadable:!0})}function c(t,e,i){return i&&(e/=Math.SQRT2),p(t,((n,r)=>{let s=n-.5*t+.25,o=.5*t-r-.75;if(i){const t=(s+o)/Math.SQRT2;o=(o-s)/Math.SQRT2,s=t}return Math.max(Math.abs(s),Math.abs(o))-.5*e}))}function u(t,e,i,n=0){e-=n,i&&(e*=Math.SQRT2);const r=.5*e;return p(t,((e,s)=>{let o,a=e-.5*t,h=.5*t-s-1;if(i){const t=(a+h)/Math.SQRT2;h=(h-a)/Math.SQRT2,a=t}return a=Math.abs(a),h=Math.abs(h),o=a>h?a>r?Math.sqrt((a-r)*(a-r)+h*h):h:h>r?Math.sqrt(a*a+(h-r)*(h-r)):a,o-=n/2,o}))}function d(t,e,i){return(n,r)=>{const s=n-t,o=r-e;return Math.sqrt(s*s+o*o)-i}}function f(t,e,i){const n=Math.sqrt(e*e+i*i);return(r,s)=>{const o=Math.abs(r-t)-i,a=s-t+e/2+.75,h=(e*o+i*a)/n,l=-a;return Math.max(h,l)}}function p(t,e){const i=new Uint8Array(4*t*t);for(let r=0;r<t;r++)for(let s=0;s<t;s++){const o=s+t*r;let a=e(s,r);a=a/t+.5,(0,n.U)(a,i,4*o)}return i}},89765:function(t,e,i){"use strict";i.d(e,{ab:function(){return bt},gm:function(){return Rt}});var n=i(44705),r=i(87725),s=i(39714),o=i(32237),a=i(61769),h=i(20551),l=i(32501),c=i(33400),u=i(41546),d=i(61714),f=i(96611),p=i(7456),g=i(57617),v=i(61441),m=i(5596),y=i(57652),_=i(50973),b=i(65420),w=i(1932),x=i(14905);const T=1e-6,A=(0,l.vt)(),M=(0,l.vt)();function S(t,e,i,n,r,s,o,a,h,l){return function(t,e,i){let n=yt(t.maxVert[0],t.minVert[0]),r=0;for(let e=1;e<7;++e){const i=yt(t.maxVert[e],t.minVert[e]);i>n&&(n=i,r=e)}pt(e,t.minVert[r]),pt(i,t.maxVert[r])}(t,n,r),yt(n,r)<T?1:(dt(o,n,r),vt(o,o),function(t,e,i,n){const{data:r,size:s}=t;let o=Number.NEGATIVE_INFINITY,a=0;for(let t=0;t<r.length;t+=s){z[0]=r[t]-e[0],z[1]=r[t+1]-e[1],z[2]=r[t+2]-e[2];const n=i[0]*z[0]+i[1]*z[1]+i[2]*z[2],s=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],h=z[0]*z[0]+z[1]*z[1]+z[2]*z[2]-n*n/s;h>o&&(o=h,a=t)}return pt(n,r,a),o}(e,n,o,s)<T?2:(dt(a,r,s),vt(a,a),dt(h,s,n),vt(h,h),gt(i,a,o),vt(i,i),U(e,i,o,a,h,l),0))}const E=(0,l.vt)(),C=(0,l.vt)(),O=(0,l.vt)(),R=(0,l.vt)(),I=(0,l.vt)(),P=(0,l.vt)(),N=(0,l.vt)(),D=(0,l.vt)();function L(t,e,i,n,r,s,o,a,h){(function(t,e,i,n,r){!function(t,e,i,n,r){const{data:s,size:o}=t;pt(n,s),pt(r,n),i[0]=_t($,e),i[1]=i[0];for(let t=o;t<s.length;t+=o){const o=s[t]*e[0]+s[t+1]*e[1]+s[t+2]*e[2];o<i[0]&&(i[0]=o,pt(n,s,t)),o>i[1]&&(i[1]=o,pt(r,s,t))}}(t,e,j,r,n);const s=_t(i,e);j[1]-T<=s&&(n[0]=void 0),j[0]+T>=s&&(r[0]=void 0)})(t,e,i,E,C),void 0!==E[0]&&(dt(O,E,i),vt(O,O),dt(R,E,n),vt(R,R),dt(I,E,r),vt(I,I),gt(P,R,s),vt(P,P),gt(N,I,o),vt(N,N),gt(D,O,a),vt(D,D),U(t,P,s,R,O,h),U(t,N,o,I,R,h),U(t,D,a,O,I,h)),void 0!==C[0]&&(dt(O,C,i),vt(O,O),dt(R,C,n),vt(R,R),dt(I,C,r),vt(I,I),gt(P,R,s),vt(P,P),gt(N,I,o),vt(N,N),gt(D,O,a),vt(D,D),U(t,P,s,R,O,h),U(t,N,o,I,R,h),U(t,D,a,O,I,h))}const z=[0,0,0],j=(0,w.vt)(),k=(0,l.vt)(),F=(0,l.vt)(),H=(0,l.vt)(),B=(0,l.vt)(),G=(0,l.vt)(),V=(0,l.vt)();function U(t,e,i,n,r,s){if(mt(e)<T)return;gt(k,i,e),gt(F,n,e),gt(H,r,e),W(t,e,j),G[1]=j[0],B[1]=j[1],V[1]=B[1]-G[1];const o=[i,n,r],a=[k,F,H];for(let i=0;i<3;++i){W(t,o[i],j),G[0]=j[0],B[0]=j[1],W(t,a[i],j),G[2]=j[0],B[2]=j[1],V[0]=B[0]-G[0],V[2]=B[2]-G[2];const n=ct(V);n<s.quality&&(pt(s.b0,o[i]),pt(s.b1,e),pt(s.b2,a[i]),s.quality=n)}}const $=(0,l.vt)();function W(t,e,i){const{data:n,size:r}=t;i[0]=Number.POSITIVE_INFINITY,i[1]=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t+=r){const r=n[t]*e[0]+n[t+1]*e[1]+n[t+2]*e[2];i[0]=Math.min(i[0],r),i[1]=Math.max(i[1],r)}}function q(t,e,i){i.center=t,i.halfSize=(0,h.h)(e,e,.5),i.quaternion=a.zK}const Z=(0,l.vt)(),Y=(0,l.vt)(),X=(0,l.vt)(),K=(0,l.vt)(),J=(0,l.vt)(),Q=(0,l.vt)();function tt(t,e,i){pt(Z,e),Math.abs(e[0])>Math.abs(e[1])&&Math.abs(e[0])>Math.abs(e[2])?Z[0]=0:Math.abs(e[1])>Math.abs(e[2])?Z[1]=0:Z[2]=0,mt(Z)<T&&(Z[0]=Z[1]=Z[2]=1),gt(Y,e,Z),vt(Y,Y),gt(X,e,Y),vt(X,X),et(t,e,Y,X,K,J),dt(Q,J,K),at(e,Y,X,K,J,Q,i)}function et(t,e,i,n,r,s){W(t,e,j),r[0]=j[0],s[0]=j[1],W(t,i,j),r[1]=j[0],s[1]=j[1],W(t,n,j),r[2]=j[0],s[2]=j[1]}const it=(0,l.vt)(),nt=(0,l.vt)(),rt=(0,l.vt)(),st=(0,r.fA)(1,0,0,0,1,0,0,0,1),ot=(0,a.vt)();function at(t,e,i,n,r,s,o){st[0]=t[0],st[1]=t[1],st[2]=t[2],st[3]=e[0],st[4]=e[1],st[5]=e[2],st[6]=i[0],st[7]=i[1],st[8]=i[2],o.quaternion=function(t,e){const i=e[0]+e[4]+e[8];if(i>0){let n=Math.sqrt(i+1);t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n}else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);const n=(i+1)%3,r=(i+2)%3;let s=Math.sqrt(e[3*i+i]-e[3*n+n]-e[3*r+r]+1);t[i]=.5*s,s=.5/s,t[3]=(e[3*n+r]-e[3*r+n])*s,t[n]=(e[3*n+i]+e[3*i+n])*s,t[r]=(e[3*r+i]+e[3*i+r])*s}return t}(ot,st),ut(it,n,r),ft(it,it,.5),ft(nt,t,it[0]),ft(rt,e,it[1]),ut(nt,nt,rt),ft(rt,i,it[2]),o.center=(0,h.g)(nt,nt,rt),o.halfSize=(0,h.h)(it,s,.5)}class ht{constructor(t){this.minVert=new Array(7),this.maxVert=new Array(7),this.buffer=new ArrayBuffer(448);let e=0;this.minProj=new Float64Array(this.buffer,e,7),e+=56,this.maxProj=new Float64Array(this.buffer,e,7),e+=56;for(let t=0;t<7;++t)this.minVert[t]=new Float64Array(this.buffer,e,3),e+=24;for(let t=0;t<7;++t)this.maxVert[t]=new Float64Array(this.buffer,e,3),e+=24;for(let t=0;t<7;++t)this.minProj[t]=Number.POSITIVE_INFINITY,this.maxProj[t]=Number.NEGATIVE_INFINITY;const i=new Array(7),n=new Array(7),{data:r,size:s}=t;for(let t=0;t<r.length;t+=s){let e=r[t];e<this.minProj[0]&&(this.minProj[0]=e,i[0]=t),e>this.maxProj[0]&&(this.maxProj[0]=e,n[0]=t),e=r[t+1],e<this.minProj[1]&&(this.minProj[1]=e,i[1]=t),e>this.maxProj[1]&&(this.maxProj[1]=e,n[1]=t),e=r[t+2],e<this.minProj[2]&&(this.minProj[2]=e,i[2]=t),e>this.maxProj[2]&&(this.maxProj[2]=e,n[2]=t),e=r[t]+r[t+1]+r[t+2],e<this.minProj[3]&&(this.minProj[3]=e,i[3]=t),e>this.maxProj[3]&&(this.maxProj[3]=e,n[3]=t),e=r[t]+r[t+1]-r[t+2],e<this.minProj[4]&&(this.minProj[4]=e,i[4]=t),e>this.maxProj[4]&&(this.maxProj[4]=e,n[4]=t),e=r[t]-r[t+1]+r[t+2],e<this.minProj[5]&&(this.minProj[5]=e,i[5]=t),e>this.maxProj[5]&&(this.maxProj[5]=e,n[5]=t),e=r[t]-r[t+1]-r[t+2],e<this.minProj[6]&&(this.minProj[6]=e,i[6]=t),e>this.maxProj[6]&&(this.maxProj[6]=e,n[6]=t)}for(let t=0;t<7;++t){let e=i[t];pt(this.minVert[t],r,e),e=n[t],pt(this.maxVert[t],r,e)}}}class lt{constructor(){this.b0=(0,l.fA)(1,0,0),this.b1=(0,l.fA)(0,1,0),this.b2=(0,l.fA)(0,0,1),this.quality=0}}function ct(t){return t[0]*t[1]+t[0]*t[2]+t[1]*t[2]}function ut(t,e,i){t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2]}function dt(t,e,i){t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2]}function ft(t,e,i){t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}function pt(t,e,i=0){t[0]=e[i],t[1]=e[i+1],t[2]=e[i+2]}function gt(t,e,i){const n=e[0],r=e[1],s=e[2],o=i[0],a=i[1],h=i[2];t[0]=r*h-s*a,t[1]=s*o-n*h,t[2]=n*a-r*o}function vt(t,e){const i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(i>0){const n=1/Math.sqrt(i);t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}}function mt(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]}function yt(t,e){const i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r}function _t(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}class bt{constructor(t=l.uY,e=Ut,i=a.zK){this._data=[t[0],t[1],t[2],e[0],e[1],e[2],i[0],i[1],i[2],i[3]]}clone(){const t=new bt;return t._data=this._data.slice(),t}invalidate(){this._data[3]=-1}get isValid(){return this._data[3]>=0}static fromData(t){const e=new bt;return e._data=t.slice(),e}static fromJSON(t){return new bt(t.center,t.halfSize,t.quaternion)}copy(t){this._data=t.data.slice()}get center(){return(0,h.i)(_.rq.get(),this._data[0],this._data[1],this._data[2])}get centerX(){return this._data[0]}get centerY(){return this._data[1]}get centerZ(){return this._data[2]}getCenter(t){return t[0]=this._data[0],t[1]=this._data[1],t[2]=this._data[2],t}set center(t){this._data[0]=t[0],this._data[1]=t[1],this._data[2]=t[2]}setCenter(t,e,i){this._data[0]=t,this._data[1]=e,this._data[2]=i}get halfSize(){return(0,h.i)(_.rq.get(),this._data[3],this._data[4],this._data[5])}get halfSizeX(){return this._data[3]}get halfSizeY(){return this._data[4]}get halfSizeZ(){return this._data[5]}getHalfSize(t){return t[0]=this._data[3],t[1]=this._data[4],t[2]=this._data[5],t}set halfSize(t){this._data[3]=t[0],this._data[4]=t[1],this._data[5]=t[2]}get quaternion(){return(0,o.hZ)(_.J8.get(),this._data[6],this._data[7],this._data[8],this._data[9])}getQuaternion(t){return t[0]=this._data[6],t[1]=this._data[7],t[2]=this._data[8],t[3]=this._data[9],t}set quaternion(t){this._data[6]=t[0],this._data[7]=t[1],this._data[8]=t[2],this._data[9]=t[3]}get data(){return this._data}getCorners(t){const e=wt,i=this._data;e[0]=i[6],e[1]=i[7],e[2]=i[8],e[3]=i[9];for(let n=0;n<8;++n){const r=t[n];r[0]=(1&n?-1:1)*i[3],r[1]=(2&n?-1:1)*i[4],r[2]=(4&n?-1:1)*i[5],(0,h.w)(r,r,e),r[0]+=i[0],r[1]+=i[1],r[2]+=i[2]}}doesIntersectFrustumConservativeApproximation(t){return this.intersectPlane(t[0])<=0&&this.intersectPlane(t[1])<=0&&this.intersectPlane(t[2])<=0&&this.intersectPlane(t[3])<=0&&this.intersectPlane(t[4])<=0&&this.intersectPlane(t[5])<=0}get radius(){const t=this._data[3],e=this._data[4],i=this._data[5];return Math.sqrt(t*t+e*e+i*i)}intersectSphere(t){At[0]=this._data[0]-t[0],At[1]=this._data[1]-t[1],At[2]=this._data[2]-t[2];const e=this.getQuaternion(xt);return(0,o.Xr)(wt,e),(0,h.w)(At,At,wt),(0,h.x)(At,At),Mt[0]=Math.min(At[0],this._data[3]),Mt[1]=Math.min(At[1],this._data[4]),Mt[2]=Math.min(At[2],this._data[5]),(0,h.y)(Mt,At)<t[3]*t[3]}intersectSphereWithMBS(t,e=this.radius){const i=this._data;At[0]=i[0]-t[0],At[1]=i[1]-t[1],At[2]=i[2]-t[2];const n=t[3],r=n+e;return!((0,h.z)(At)>r*r)&&(wt[0]=-i[6],wt[1]=-i[7],wt[2]=-i[8],wt[3]=i[9],(0,h.w)(At,At,wt),(0,h.x)(At,At),Mt[0]=Math.min(At[0],i[3]),Mt[1]=Math.min(At[1],i[4]),Mt[2]=Math.min(At[2],i[5]),(0,h.y)(Mt,At)<n*n)}intersectPlane(t){const e=t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3],i=this.projectedRadius((0,m.Qj)(t));return e>i?1:e<-i?-1:0}intersectRay(t,e,i=0){const n=this._data,r=wt;r[0]=-n[6],r[1]=-n[7],r[2]=-n[8],r[3]=n[9],At[0]=t[0]-n[0],At[1]=t[1]-n[1],At[2]=t[2]-n[2];const s=(0,h.w)(At,At,wt),o=(0,h.w)(Mt,e,wt);let a=-1/0,l=1/0;const c=this.getHalfSize(jt);for(let t=0;t<3;t++){const e=s[t],n=o[t],r=c[t]+i;if(Math.abs(n)>1e-6){const t=(r-e)/n,i=(-r-e)/n;a=Math.max(a,Math.min(t,i)),l=Math.min(l,Math.max(t,i))}else if(e>r||e<-r)return!1}return a<=l}projectedArea(t,e,i,r){const s=this.getQuaternion(xt);(0,o.Xr)(wt,s),At[0]=t[0]-this._data[0],At[1]=t[1]-this._data[1],At[2]=t[2]-this._data[2],(0,h.w)(At,At,wt);const a=this.getHalfSize(jt),l=At[0]<-a[0]?-1:At[0]>a[0]?1:0,u=At[1]<-a[1]?-1:At[1]>a[1]?1:0,d=At[2]<-a[2]?-1:At[2]>a[2]?1:0,f=Math.abs(l)+Math.abs(u)+Math.abs(d);if(0===f)return 1/0;const p=1===f?4:6,g=6*(l+3*u+9*d+13);(0,n.I0)(kt,s),(0,n.hs)(kt,kt,a);const v=this.getCenter(Lt);for(let t=0;t<p;t++){const i=Ot[g+t];(0,h.i)(At,((1&i)<<1)-1,(2&i)-1,((4&i)>>1)-1),(0,h.q)(At,At,kt),(0,h.g)(St,v,At),St[3]=1,(0,c.t)(St,St,e);const n=1/Math.max(1e-6,St[3]);Ct[2*t]=St[0]*n,Ct[2*t+1]=St[1]*n}const m=2*p-2;let y=Ct[0]*(Ct[3]-Ct[m+1])+Ct[m]*(Ct[1]-Ct[m-1]);for(let t=2;t<m;t+=2)y+=Ct[t]*(Ct[t+3]-Ct[t-1]);return Math.abs(y)*i*r*.125}projectedRadius(t){const e=this.getQuaternion(xt);return(0,o.Xr)(wt,e),(0,h.w)(At,t,wt),Math.abs(At[0]*this._data[3])+Math.abs(At[1]*this._data[4])+Math.abs(At[2]*this._data[5])}minimumDistancePlane(t){return t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3]-this.projectedRadius((0,m.Qj)(t))}maximumDistancePlane(t){return t[0]*this._data[0]+t[1]*this._data[1]+t[2]*this._data[2]+t[3]+this.projectedRadius((0,m.Qj)(t))}toAaBoundingBox(t){const e=this.getQuaternion(xt),i=(0,n.I0)(kt,e),r=this._data[3]*Math.abs(i[0])+this._data[4]*Math.abs(i[3])+this._data[5]*Math.abs(i[6]),s=this._data[3]*Math.abs(i[1])+this._data[4]*Math.abs(i[4])+this._data[5]*Math.abs(i[7]),o=this._data[3]*Math.abs(i[2])+this._data[4]*Math.abs(i[5])+this._data[5]*Math.abs(i[8]);t[0]=this._data[0]-r,t[1]=this._data[1]-s,t[2]=this._data[2]-o,t[3]=this._data[0]+r,t[4]=this._data[1]+s,t[5]=this._data[2]+o}transform(t,e,i,n=0,r=(0,f.lO)(i),s=(0,f.lO)(e),a=(0,v.jd)(e,s)){if(i===r)e.isGeographic?function(t,e,i,n,r=(0,f.lO)(i)){const s=(0,d.tO)(i),a=1+Math.max(0,n)/(s.radius+t.centerZ);t.getCenter(Dt),Dt[2]+=n,(0,g.projectBuffer)(Dt,i,0,Dt,r,0),e.center=Dt;const l=t.getQuaternion(xt);e.quaternion=l,(0,o.Xr)(wt,l),(0,h.i)(Bt,0,0,1),(0,h.w)(Bt,Bt,wt);const c=t.getHalfSize(jt);(0,h.i)(Bt,c[0]*Math.abs(Bt[0]),c[1]*Math.abs(Bt[1]),c[2]*Math.abs(Bt[2])),(0,h.h)(Bt,Bt,s.inverseFlattening),(0,h.g)(Bt,c,Bt),e.halfSize=(0,h.h)(Bt,Bt,a)}(this,t,e,n,s):function(t,e,i,n,r=(0,f.lO)(i),s=(0,v.jd)(i,r)){t.getCorners(Ht),t.getCenter(Dt),Dt[2]+=n,(0,p.l)(i,Dt,Ft,r),e.setCenter(Ft[12],Ft[13],Ft[14]);const a=2*Math.sqrt(1+Ft[0]+Ft[5]+Ft[10]);wt[0]=(Ft[6]-Ft[9])/a,wt[1]=(Ft[8]-Ft[2])/a,wt[2]=(Ft[1]-Ft[4])/a,wt[3]=.25*a;const l=t.getQuaternion(xt);e.quaternion=(0,o.lw)(wt,wt,l),(0,o.Xr)(wt,wt),(0,h.i)(Gt,0,0,0);const c=e.getCenter(zt);for(const t of Ht)t[2]+=n,s(t,0,t,0),(0,h.a)(Bt,t,c),(0,h.w)(Bt,Bt,wt),(0,h.x)(Bt,Bt),(0,h.D)(Gt,Gt,Bt);e.halfSize=Gt}(this,t,e,n,s,a);else if(e.isWGS84&&(i.isWebMercator||(0,y.r1)(i)))!function(t,e,i,n,r){e.getCenter(Lt),Lt[2]+=r;const s=(0,f.lO)(i);(0,g.projectBuffer)(Lt,t,0,Lt,s,0),It(s,e,Lt,i,n)}(e,this,i,t,n);else if(e.isWebMercator&&(0,y.r1)(i))!function(t,e,i,n,r){e.getCenter(Lt),Lt[2]+=r,It(t,e,Lt,i,n)}(e,this,i,t,n);else{const r=this.getCenter(Lt);r[2]+=n,(0,g.projectBuffer)(r,e,0,r,i,0),t.center=r,this!==t&&(t.quaternion=this.getQuaternion(xt),t.halfSize=this.getHalfSize(jt))}}}const wt=(0,a.vt)(),xt=(0,a.vt)(),Tt=(0,a.vt)(),At=(0,l.vt)(),Mt=(0,l.vt)(),St=(0,u.vt)();function Et(t,e=new bt){return function(t,e){const{data:i,size:n}=t,r=i.length/n;if(r<=0)return;const s=new ht(t);ut(A,s.minProj,s.maxProj),ft(A,A,.5),dt(M,s.maxProj,s.minProj);const o=ct(M),a=new lt;a.quality=o,r<14&&(t=new x.K(new Float64Array(s.buffer,112,42),3));const h=(0,l.vt)(),c=(0,l.vt)(),u=(0,l.vt)(),d=(0,l.vt)(),f=(0,l.vt)(),p=(0,l.vt)(),g=(0,l.vt)();switch(S(s,t,g,h,c,u,d,f,p,a)){case 1:return void q(A,M,e);case 2:return void tt(t,d,e)}L(t,g,h,c,u,d,f,p,a),et(t,a.b0,a.b1,a.b2,K,J);const v=(0,l.vt)();dt(v,J,K),a.quality=ct(v),a.quality<o?at(a.b0,a.b1,a.b2,K,J,v,e):q(A,M,e)}(t,e),e}const Ct=[.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1,1.2],Ot=(()=>{const t=new Int8Array(162);let e=0;const i=i=>{for(let n=0;n<i.length;n++)t[e+n]=i[n];e+=6};return i([6,2,3,1,5,4]),i([0,2,3,1,5,4]),i([0,2,3,7,5,4]),i([0,1,3,2,6,4]),i([0,1,3,2,0,0]),i([0,1,5,7,3,2]),i([0,1,3,7,6,4]),i([0,1,3,7,6,2]),i([0,1,5,7,6,2]),i([0,1,5,4,6,2]),i([0,1,5,4,0,0]),i([0,1,3,7,5,4]),i([0,2,6,4,0,0]),i([0,0,0,0,0,0]),i([1,3,7,5,0,0]),i([2,3,7,6,4,0]),i([2,3,7,6,0,0]),i([2,3,1,5,7,6]),i([0,1,5,7,6,2]),i([0,1,5,7,6,4]),i([0,1,3,7,6,4]),i([4,5,7,6,2,0]),i([4,5,7,6,0,0]),i([4,5,1,3,7,6]),i([0,2,3,7,5,4]),i([6,2,3,7,5,4]),i([6,2,3,1,5,4]),t})();function Rt(t,e,i,n,r){const s=t.getQuaternion(xt);r.quaternion=s,(0,o.Xr)(wt,s);const a=t.getCenter(Lt),c=t.getHalfSize(jt);if(n===b.RT.Global){(0,h.w)(Bt,a,wt),(0,h.x)(Gt,Bt),(0,h.A)(Vt,Gt,c),(0,h.a)(Vt,Gt,Vt);const n=(0,h.l)(Vt);(0,h.g)(Vt,Gt,c);const s=(0,h.l)(Vt);if(n<i)r.center=a,(0,h.i)(Bt,i,i,i),r.halfSize=(0,h.g)(Bt,c,Bt);else{const o=s>0?1+e/s:1,a=n>0?1+i/n:1,l=(a+o)/2,u=(a-o)/2;(0,h.h)(Vt,Gt,u),r.halfSize=(0,h.b)(Vt,Vt,c,l),(0,h.h)(Vt,Gt,l),(0,h.b)(Vt,Vt,c,u),(0,h.B)(Bt,Bt),(0,h.C)(Bt,Vt,Bt);const d=t.getQuaternion(Tt);r.center=(0,h.w)(Bt,Bt,d)}}else{r.center=(0,h.b)(Bt,a,l.Cb,(i+e)/2);const t=(0,h.w)(Bt,l.Cb,wt);(0,h.x)(t,t),r.halfSize=(0,h.b)(Gt,c,t,(i-e)/2)}return r}function It(t,e,i,r,s){const o=e.getQuaternion(xt),a=(0,n.I0)(kt,o),h=e.getHalfSize(jt);for(let t=0;t<8;++t){for(let e=0;e<3;++e)Dt[e]=h[e]*(t&1<<e?-1:1);for(let e=0;e<3;++e){let n=i[e];for(let t=0;t<3;++t)n+=Dt[t]*a[3*t+e];Pt[3*t+e]=n}}(0,g.projectBuffer)(Pt,t,0,Pt,r,0,8),Et(Nt,s)}const Pt=new Array(24),Nt=new x.K(Pt,3),Dt=(0,l.vt)(),Lt=(0,l.vt)(),zt=(0,l.vt)(),jt=(0,l.vt)(),kt=(0,r.vt)(),Ft=(0,s.vt)(),Ht=[[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0],[0,0,0]],Bt=(0,l.vt)(),Gt=(0,l.vt)(),Vt=(0,l.vt)(),Ut=(0,l.CN)(-1,-1,-1)},29800:function(t,e,i){"use strict";i.d(e,{A:function(){return l},C:function(){return h}});var n=i(57617),r=i(50240),s=i(82588),o=i(49618),a=i(58704);function h(t,e,i,n){const a="polygon"===t.type?s.Wq.CCW_IS_HOLE:s.Wq.NONE,h="polygon"===t.type?t.rings:t.paths,{position:l,outlines:u}=(0,s.oR)(h,!!t.hasZ,a,t.spatialReference),d=(0,r.jh)(l.length),f=(0,o.au)(l,t.spatialReference,0,d,0,l,0,l.length/3,e,i,n),p=null!=f;return{lines:p?c(u,l,d):[],projectionSuccess:p,sampledElevation:f}}function l(t,e){const i="polygon"===t.type?s.Wq.CCW_IS_HOLE:s.Wq.NONE,r="polygon"===t.type?t.rings:t.paths,{position:o,outlines:h}=(0,s.oR)(r,!1,i),l=(0,n.projectBuffer)(o,t.spatialReference,0,o,e,0);for(let t=2;t<o.length;t+=3)o[t]=a.bi;return{lines:l?c(h,o):[],projectionSuccess:l}}function c(t,e,i=null){const n=new Array;for(const{index:s,count:o}of t){if(o<=1)continue;const t=3*s,a=3*o;n.push({position:(0,r.l5)(e,3*s,3*o),mapPositions:null!=i?(0,r.l5)(i,t,a):void 0})}return n}},89756:function(t,e,i){"use strict";i.d(e,{MQ:function(){return r}}),i(38177);var n=i(50456);i(59356);class r extends n.R6{constructor(t,e,i){super(t,e),this.triangleNr=i}}},58704:function(t,e,i){"use strict";i.d(e,{bi:function(){return Xe}});var n,r,s=i(53804),o=i(48996),a=i(58941),h=i(25738),l=i(95929),c=i(7187),u=i(28181),d=i(17660),f=i(23502),p=i(40633),g=(i(13798),i(65953)),v=i(73364),m=i(20551),y=i(32501),_=i(46949),b=i(70974),w=i(86398),x=i(87416),T=i(79068);class A{constructor(){this._extent=(0,x.vt)(),this.resolution=0,this.renderLocalOrigin=(0,T.f)(0,0,0,"O"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new M}get extent(){return this._extent}setupGeometryViewsCyclical(t){this.setupGeometryView();const e=.001*t.range;if(this._extent[0]-e<=t.min){const e=this.canvasGeometries.extents[this.canvasGeometries.numViews++];(0,x.cY)(this._extent,t.range,0,e)}if(this._extent[2]+e>=t.max){const e=this.canvasGeometries.extents[this.canvasGeometries.numViews++];(0,x.cY)(this._extent,-t.range,0,e)}}setupGeometryView(){this.canvasGeometries.numViews=1,(0,x.C)(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let t=0;t<this.canvasGeometries.numViews;t++){const e=this.canvasGeometries.extents[t];if(e[0]!==e[2]&&e[1]!==e[3])return!0}return!1}}class M{constructor(){this.extents=[(0,x.vt)(),(0,x.vt)(),(0,x.vt)()],this.numViews=0}}(r=n||(n={}))[r.Color=0]="Color",r[r.ColorNoRasterImage=1]="ColorNoRasterImage",r[r.Highlight=2]="Highlight",r[r.WaterNormal=3]="WaterNormal",r[r.Occluded=4]="Occluded",r[r.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor";class S{constructor(t,e,i){this._fbos=t,this._format=e,this._name=i}get valid(){return null!=this._handle?.getTexture()}dispose(){this._handle=(0,l.Gz)(this._handle)}get texture(){return this._handle?.getTexture()}bind(t,e,i){this._handle&&this._handle.fbo?.width===e&&this._handle.fbo?.height===i||(this._handle?.release(),this._handle=this._fbos.acquire(e,i,this._name,this._format)),t.bindFramebuffer(this._handle?.fbo)}generateMipMap(){this._handle?.getTexture()?.descriptor?.hasMipmap&&this._handle?.getTexture()?.generateMipmap()}}var E=i(98680),C=i(27264),O=i(39534);class R{constructor(t,e,i,n,r=E.N.RGBA_MIPMAP){this.output=i,this.content=n,this.fbo=new S(t,r,e)}get valid(){return this.fbo.valid}}class I{constructor(t){this.targets=[new R(t,"overlay color",C.V.Color,n.Color),new R(t,"overlay IM color",C.V.Color,n.ColorNoRasterImage),new R(t,"overlay highlight",C.V.Highlight,n.Highlight,E.N.RG),new R(t,"overlay water",C.V.Normal,n.WaterNormal),new R(t,"overlay occluded",C.V.Color,n.Occluded)],(0,O.E)()&&this.targets.push(new R(t,"overlay olid",C.V.ObjectAndLayerIdColor,n.ObjectAndLayerIdColor,E.N.RGBA))}getTexture(t){return this.targets[t]?.fbo.texture}dispose(){for(const t of this.targets)t.fbo.dispose()}computeValidity(){return this.targets.reduce(((t,e,i)=>e.valid?t|=1<<i:t),0)}}var P,N,D=i(65631),L=i(41546);i(94211).Zo,(N=P||(P={}))[N.Material=0]="Material",N[N.ShadowMap=1]="ShadowMap",N[N.Highlight=2]="Highlight",N[N.ViewshedShadowMap=3]="ViewshedShadowMap",i(42426),i(11520),i(5830),i(41356),i(14543);var z,j,k=i(39506),F=(i(39838),i(65312));(j=z||(z={}))[j.Disabled=0]="Disabled",j[j.Enabled=1]="Enabled",j[j.EnabledWithWater=2]="EnabledWithWater",j[j.COUNT=3]="COUNT",(0,L.vt)(),F.n;var H=i(55747),B=i(67521),G=i(13786),V=i(46671),U=i(74174),$=i(34615),W=i(82273),q=i(82186),Z=i(57087);class Y extends W.w{constructor(t,e,n){super(t,e,new $.$(q.H,(()=>i.e(4746).then(i.bind(i,50906)))),n)}initializePipeline(){return(0,Z.Ey)({blending:Z.Ky,colorWrite:Z.kn})}}var X=i(40434);class K extends W.w{constructor(t,e,n){super(t,e,new $.$(X.a,(()=>i.e(5536).then(i.bind(i,5858)))),n)}initializePipeline(){return(0,Z.Ey)({colorWrite:Z.kn})}}var J=i(82854);class Q extends k.Y{constructor(){super(...arguments),this.occludedFactor=J.cD,this.maxHighlightLevel=1,this.verticalCellCount=0,this.horizontalCellCount=0,this.highlightLevel=0,this.pixelRatio=1}}var tt=i(46655);class et extends W.w{constructor(t,e,n){super(t,e,new $.$(tt.H,(()=>i.e(2803).then(i.bind(i,7471)))),n)}initializePipeline(){return(0,Z.Ey)({colorWrite:Z.kn})}}var it=i(966);class nt extends W.w{constructor(t,e,n){super(t,e,new $.$(it.S,(()=>i.e(9086).then(i.bind(i,69718)))),n)}initializePipeline(){return(0,Z.Ey)({blending:Z.Ky,colorWrite:Z.kn})}}var rt=i(2963);class st extends W.w{constructor(t,e,n){super(t,e,new $.$(rt.a,(()=>i.e(8643).then(i.bind(i,92227)))),n)}initializePipeline(){return(0,Z.Ey)({colorWrite:Z.kn})}}var ot=i(54407),at=i(40502),ht=i(65839),lt=i(85456),ct=i(3817);const ut=[];new ct._(ht.r.POSITION,3,lt.pe.FLOAT,0,12),new ct._(ht.r.POSITION,2,lt.pe.FLOAT,0,8),new ct._(ht.r.POSITION,2,lt.pe.FLOAT,0,16),new ct._(ht.r.UV0,2,lt.pe.FLOAT,8,16);var dt=i(69445),ft=i(86305),pt=i(12285),gt=i(10956);let vt=class extends U.A{constructor(t){super(t),this.produces=V.OG.HIGHLIGHTS,this.consumes={required:[V.OG.HIGHLIGHTS,"highlights"]},this.useMultipleHighlights=!!(0,a.A)("enable-feature:multiple-highlights"),this._optionsTexture=null,this._downsampleDrawParameters=new X.H,this._passParameters=new Q,this._singleHighlightBlurDrawParameters=new rt.S,this._grid=new mt,t.techniques.precompile(K),this.useMultipleHighlights?t.techniques.precompile(Y):(t.techniques.precompile(et),t.techniques.precompile(st),t.techniques.precompile(nt))}initialize(){this.addHandles([(0,u.watch)((()=>xt(this.view.highlights)),(()=>{this._optionsTexture=(0,l.WD)(this._optionsTexture),this.requestRender(ot.C7.UPDATE)}),u.Vh)])}destroy(){this._passParameters&&(this._passParameters.highlightOptionsTexture=null),this._grid.coverage=(0,l.Gz)(this._grid.coverage),this._grid.vao=(0,l.WD)(this._grid.vao),this._optionsTexture=(0,l.Gz)(this._optionsTexture)}_updateOptionsTexture(t){const e=this.renderingContext;let i=this._optionsTexture;if(null==i){const t=new gt.R(16,2);t.internalFormat=lt.Ab.RGBA,t.samplingMode=lt.Cj.NEAREST,i=new pt.g(e,t,null),this._optionsTexture=i}i.setData(t),this._passParameters.highlightOptionsTexture=i}render(t){const e=t.find((({name:t})=>t===V.OG.HIGHLIGHTS)),{techniques:i,bindParameters:n,_passParameters:r,renderingContext:s}=this;if(!n.decorations)return e;const o=i.acquire(K);if(!o.compiled)return o.release(),this.requestRender(ot.C7.UPDATE),e;const a=t.find((({name:t})=>"highlights"===t)).getTexture(),h=()=>{const{highlights:t}=this.view;this._optionsTexture||this._updateOptionsTexture(function(t){const e=new Uint8Array(128),i=(t,i)=>{e[t]=i};return bt(t,((t,e)=>{((t,e)=>{const n=4*t,r=4*t+64,{color:s}=e,o=e.haloColor??s;i(n+0,s.r),i(n+1,s.g),i(n+2,s.b),i(n+3,e.fillOpacity*s.a*255),i(r+0,o.r),i(r+1,o.g),i(r+2,o.b),i(r+3,e.haloOpacity*o.a*255)})(e,t.options)})),e}(t)),r.highlightOptionsTexture=this._optionsTexture,this._gridUpdateResources(a);const e=this._gridComputeCoverage(o,a,n);o.release();const{horizontalCellCount:i,verticalCellCount:s}=e;return r.horizontalCellCount=i,r.verticalCellCount=s,r.coverageTexture=e.coverage?.getTexture(),e},l=t=>{const e=t.verticalCellCount*t.horizontalCellCount;s.bindVAO(t.vao),s.drawElementsInstanced(lt.WR.TRIANGLES,6,lt.pe.UNSIGNED_BYTE,0,e)},{camera:c}=n,u=()=>{s.bindFramebuffer(e.fbo),s.setViewport4fv(c.fullViewport)};return this.useMultipleHighlights?this._renderMultiple(a,h,l,u):this._renderSingle(a,h,l,u),r.highlightTexture=null,r.coverageTexture=null,e}_renderMultiple(t,e,i,n){const{techniques:r,bindParameters:s,_passParameters:o,renderingContext:a}=this,h=r.acquire(Y);if(!h.compiled)return h.release(),void this.requestRender(ot.C7.UPDATE);const l=e();o.highlightTexture=t,o.pixelRatio=s.camera.pixelRatio,o.maxHighlightLevel=At(this.view.highlights)-1,a.bindTechnique(h,s,o),n(),i(l),h.release()}_renderSingle(t,e,i,n){const{fboCache:r,techniques:s,bindParameters:o,_passParameters:a,renderingContext:h}=this,l=s.acquire(et),c=s.acquire(st),u=s.acquire(nt);if(!u.compiled||!c.compiled||!l.compiled)return u.release(),c.release(),l.release(),void this.requestRender(ot.C7.UPDATE);const d=e(),{width:f,height:p}=t.descriptor;a.maxHighlightLevel=At(this.view.highlights)-1,a.highlightTexture=t;const{camera:g}=o,{fullWidth:v,fullHeight:m,pixelRatio:y}=g,_=Math.ceil(v/y),b=Math.ceil(m/y),{_singleHighlightBlurDrawParameters:w}=this;for(let t=0;t<=a.maxHighlightLevel;++t){a.highlightLevel=t,h.setClearColor(0,0,0,0);const e=r.acquire(f,p,"single highlight",E.N.RG);h.bindFramebuffer(e.fbo),h.setViewport(0,0,f,p),h.clear(lt.NV.COLOR),h.bindTechnique(l,o,a),i(d),w.blurInput=e.getTexture(),(0,G.hZ)(w.blurSize,1/_,0);const s=r.acquire(_,b,"single highlight blur h",E.N.RG);h.unbindTexture(s.fbo?.colorTexture),h.bindFramebuffer(s.fbo),h.setViewport(0,0,_,b),h.clear(lt.NV.COLOR),w.blurInput=e.getTexture(),(0,G.hZ)(w.blurSize,1/_,0),h.bindTechnique(c,o,a,w),i(d),e.release(),(0,G.hZ)(w.blurSize,0,1/b),a.singleHighlightBlurTexture=s.getTexture(),n(),h.bindTechnique(u,o,a,w),i(d),s.release()}l.release(),c.release(),u.release()}_gridUpdateResources(t){const e=this.renderingContext,i=this._grid,{width:n,height:r}=t.descriptor;if(i.horizontalCellCount=Math.ceil(n/X.g),i.verticalCellCount=Math.ceil(r/X.g),i.vao)return;const s=ft.g.createIndex(e,lt._U.STATIC_DRAW,Tt);i.vao=new dt.Z(e,at.D,new Map([["geometry",ut]]),new Map([["geometry",ft.g.createVertex(e,lt._U.STATIC_DRAW)]]),s)}_gridComputeCoverage(t,e,i){const n=this.renderingContext,r=this._grid,s=e.descriptor,o=Math.ceil(s.width/X.g),a=Math.ceil(s.height/X.g);this._downsampleDrawParameters.input=e,r.coverage?.release();const h=this.fboCache.acquire(o,a,"highlight coverage",E.N.RG);return r.coverage=h,n.bindFramebuffer(h.fbo),n.bindTechnique(t,i,this._passParameters,this._downsampleDrawParameters),n.setViewport(0,0,o,a),n.screen.draw(),r}get test(){}};(0,s._)([(0,f.MZ)()],vt.prototype,"produces",void 0),(0,s._)([(0,f.MZ)()],vt.prototype,"consumes",void 0),(0,s._)([(0,f.MZ)({constructOnly:!0})],vt.prototype,"techniques",void 0),vt=(0,s._)([(0,g.$)("esri.views.3d.webgl-engine.effects.highlight.Highlight")],vt);class mt{constructor(){this.coverage=null,this.vao=null,this.verticalCellCount=0,this.horizontalCellCount=0,this.viewportWidth=0,this.viewportHeight=0}}const yt=new Array(J.cz),_t=new Array(J.cz);function bt(t,e){const i=Math.min(t.length,J.cz);let n=J.cz;for(let e=i-1;e>=0;--e){const i=t.at(e);if(i){const t=i.name;yt.includes(t,n)||(--n,yt[n]=t,_t[n]=e)}}const r=J.cz-n;for(let i=0;i<r;++i){const n=_t[J.cz-r+i];e(t.at(n),i)}}let wt=0;function xt(t){let e=0;const i=Math.min(J.cz,t.length);for(let n=0;n<i;++n){const i=t.at(n);if(i){const{name:t,options:n}=i;e+=t.length;const{color:r,fillOpacity:s,haloColor:o,haloOpacity:a}=n;e+=r.r+(o?.r??1)+s+a}}{const i=t.at(0);if(i){const{shadowOpacity:t,shadowDifference:n,shadowColor:r}=i.options;e+=t+n+r.r}}return wt+++(e>=0?0:1)}const Tt=new Uint8Array([0,1,2,2,1,3]);function At(t){const e=new Set;for(let i=0;i<J.cz;++i){const n=t.at(i)?.name;n&&e.add(n)}return e.size}var Mt=i(7970),St=i(90553);class Et{constructor(t,e,i,n){this._textures=t,this._techniques=e,this.materialChanged=i,this.requestRender=n,this._id2glMaterialRef=new Mt.O}dispose(){this._textures.destroy()}acquire(t,e,i){this._ownMaterial(t);const n=t.produces.get(e);if(!n?.(i))return null;let r=this._id2glMaterialRef.get(i,t.id);if(null==r){const e=t.createGLMaterial({material:t,techniques:this._techniques,textures:this._textures,output:i});r=new Ct(e),this._id2glMaterialRef.set(i,t.id,r)}return r.ref(),r.glMaterial}release(t,e){const i=this._id2glMaterialRef.get(e,t.id);null!=i&&(i.unref(),i.referenced||((0,l.WD)(i.glMaterial),this._id2glMaterialRef.delete(e,t.id)))}_ownMaterial(t){t.repository&&t.repository!==this&&p.A.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"),t.repository=this}}class Ct{constructor(t){this.glMaterial=t,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,(0,St.vA)(this._refCnt>=0)}get referenced(){return this._refCnt>0}}var Ot,Rt=i(19860),It=i(24100),Pt=i(54840),Nt=(i(38504),i(39714)),Dt=i(1932),Lt=i(75256),zt=i(60808),jt=i(29165);!function(t){t[t.Immediate=0]="Immediate",t[t.FadeWithWeather=1]="FadeWithWeather"}(Ot||(Ot={}));var kt=i(95629);class Ft{constructor(t){this.shadowMap=t,this.slot=jt.N.OPAQUE_MATERIAL,this.slicePlane=null,this.hasOccludees=!1,this.enableFillLights=!0,this.oitPass=Pt.Y.NONE,this.alignPixelEnabled=!1,this.decorations=!0,this.overlayStretch=1,this.viewshedEnabled=!1,this._camera=new D.A,this._inverseViewport=(0,Dt.vt)(),this._oldLighting=new kt.TA,this._newLighting=new kt.TA,this._fadedLighting=new kt.TA,this._lighting=this._newLighting,this.ssr=new Ht,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.highlightMixTexture=null,this.highlightGroupName=null,this.highlightGroupIndices=new Map,this.highlightLevel=0,this.highlightMixOrigin=(0,Dt.vt)(),this.hudRenderStyle=zt.D.Occluded,this.clouds=new Lt.n,this.shadowHighlightsVisible=!1}get camera(){return this._camera}set camera(t){this._camera=t,this._inverseViewport[0]=1/t.fullViewport[2],this._inverseViewport[1]=1/t.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}fadeLighting(){switch(this.clouds.fadeFactor){case 0:this._lighting=this._oldLighting;break;default:this._fadedLighting.lerpLighting(this._oldLighting,this._newLighting,this.clouds.fadeFactor),this._lighting=this._fadedLighting;break;case 1:this._lighting=this._newLighting,this._oldLighting.copyFrom(this._newLighting)}}updateLighting(t,e,i,n){this._oldLighting.copyFrom(this.lighting),this._newLighting.noonFactor=e,this._newLighting.globalFactor=i,this._newLighting.set(t),n===Ot.FadeWithWeather&&this.clouds.requestFade(),this.fadeLighting()}}class Ht{constructor(){this.fadeFactor=1,this.reprojectionMatrix=(0,Nt.vt)()}}class Bt{constructor(t,e){this.rctx=t,this.lastFrameCamera=new D.A,this.output=C.V.Color,this.renderOccludedMask=Gt,this.bind=new Ft(e),this.bind.alignPixelEnabled=!0}}const Gt=It.m$.Occlude|It.m$.OccludeAndTransparent|It.m$.OccludeAndTransparentStencil;var Vt=i(15774),Ut=i(87725),$t=i(33400),Wt=i(65420);let qt=class extends D.A{constructor(){super(...arguments),this._projectionMatrix=(0,Nt.vt)()}get projectionMatrix(){return this._projectionMatrix}};(0,s._)([(0,f.MZ)()],qt.prototype,"_projectionMatrix",void 0),(0,s._)([(0,f.MZ)({readOnly:!0})],qt.prototype,"projectionMatrix",null),qt=(0,s._)([(0,g.$)("esri.views.3d.webgl-engine.lib.CascadeCamera")],qt);var Zt,Yt,Xt=i(12569);(Yt=Zt||(Zt={}))[Yt.Highlight=0]="Highlight",Yt[Yt.ExcludeHighlight=1]="ExcludeHighlight";class Kt{constructor(){this.camera=new qt,this.lightMat=(0,Nt.vt)()}}class Jt{constructor(){this.maxNumCascadesHighQuality=4,this.maxNumCascadesLowQuality=4,this.textureSizeModHighQuality=1.3,this.textureSizeModLowQuality=.9,this.splitSchemeLambda=0}}class Qt{constructor(t,e){this._fbos=t,this._viewingMode=e,this._enabled=!1,this._snapshots=new Array,this._textureHeight=0,this._numCascades=1,this.settings=new Jt,this._projectionView=(0,Nt.vt)(),this._projectionViewInverse=(0,Nt.vt)(),this._modelViewLight=(0,Nt.vt)(),this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=(0,L.vt)(),this._cascades=[new Kt,new Kt,new Kt,new Kt],this._lastOrigin=null,this._maxTextureWidth=Math.min((0,a.A)("esri-mobile")?4096:16384,t.rctx.parameters.maxTextureSize)}dispose(){this.enabled=!1,this.disposeOffscreenBuffers()}get depthTexture(){return this._handle?.getTexture()}get _textureWidth(){return this._textureHeight*this._numCascades}get numCascades(){return this._numCascades}get cascadeDistances(){return(0,$t.s)(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}disposeOffscreenBuffers(){this._handle=(0,l.Gz)(this._handle),this._discardSnapshots()}set maxCascades(t){this.settings.maxNumCascadesHighQuality=(0,Vt.qE)(Math.floor(t),1,4)}get maxCascades(){return this.settings.maxNumCascadesHighQuality}set enabled(t){this._enabled=t,t||this.disposeOffscreenBuffers()}get enabled(){return this._enabled}get ready(){return this._enabled&&null!=this.depthTexture}get cascades(){for(let t=0;t<this._numCascades;++t)le[t]=this._cascades[t];return le.length=this._numCascades,le}start(t,e,i,n,r){(0,St.vA)(this.enabled);const{near:s,far:o}=function(t){let{near:e,far:i}=t;return e<2&&(e=2),i<2&&(i=2),e>=i&&(e=2,i=4),{near:e,far:i}}(i);this._computeCascadeDistances(s,o,n),this._textureHeight=this._computeTextureHeight(t,r,n),this._setupMatrices(t,e);const{viewMatrix:a,projectionMatrix:h}=t;for(let t=0;t<this._numCascades;++t)this._constructCascade(t,h,a,e);this._lastOrigin=null,this.clear()}finish(){(0,St.vA)(this.enabled),this._handle?.detachDepth()}getShadowMapMatrices(t){if(!this._lastOrigin||!(0,m.p)(t,this._lastOrigin)){this._lastOrigin=this._lastOrigin||(0,y.vt)(),(0,m.c)(this._lastOrigin,t);for(let e=0;e<this._numCascades;++e){(0,v.Tl)(ce,this._cascades[e].lightMat,t);for(let t=0;t<16;++t)ue[16*e+t]=ce[t]}}return ue}moveSnapshot(t){(0,St.vA)(this.enabled),this._handle?.detachDepth(),this._snapshots[t]?.release(),this._snapshots[t]=this._handle,this._handle=null,this.clear()}copySnapshot(t){const e=this._handle?.getTexture()?.descriptor;if(!this.enabled||!e)return;this._snapshots[t]?.release();const{width:i,height:n}=e,r=t===Zt.Highlight?"shadow highlight snapshot":"shadow no highlight snapshot";this._snapshots[t]=this._fbos.acquire(i,n,r,E.N.RGBA4);const s=this._fbos.rctx;this._bindFbo();const o=s.bindTexture(this._snapshots[t]?.getTexture(),pt.g.TEXTURE_UNIT_FOR_UPDATES);s.gl.copyTexSubImage2D(lt.Ap.TEXTURE_2D,0,0,0,0,0,i,n),s.bindTexture(o,pt.g.TEXTURE_UNIT_FOR_UPDATES)}getSnapshot(t){return this.enabled?this._snapshots[t]?.getTexture():null}clear(){const t=this._fbos.rctx;this._ensureFbo(),this._bindFbo(),t.setClearColor(1,1,1,1),t.clear(lt.NV.COLOR|lt.NV.DEPTH)}_computeTextureHeight(t,e,i){const n=Math.min(window.devicePixelRatio,e)/t.pixelRatio,r=i?this.settings.textureSizeModHighQuality:this.settings.textureSizeModLowQuality,s=(0,Xt.Mv)(Math.floor(Math.max(t.fullWidth,t.fullHeight)*n*r)),o=Math.min(this._maxTextureWidth,this._numCascades*s);return(0,Xt.uT)(o/this._numCascades)}_ensureFbo(){this._handle?.fbo?.width===this._textureWidth&&this._handle?.fbo.height===this._textureHeight||(this._handle?.release(),this._handle=this._fbos.acquire(this._textureWidth,this._textureHeight,"shadow map",E.N.RGBA4)),this._handle?.acquireDepth(E.z.DEPTH16_BUFFER)}_discardSnapshot(t){this._snapshots[t]=(0,l.Gz)(this._snapshots[t])}_discardSnapshots(){for(let t=0;t<this._snapshots.length;++t)this._discardSnapshot(t);this._snapshots.length=0}_bindFbo(){this._fbos.rctx.bindFramebuffer(this._handle?.fbo)}_constructCascade(t,e,i,n){const r=this._cascades[t],s=-this._cascadeDistances[t],o=-this._cascadeDistances[t+1],a=(e[10]*s+e[14])/Math.abs(e[11]*s+e[15]),h=(e[10]*o+e[14])/Math.abs(e[11]*o+e[15]);(0,St.vA)(a<h);for(let t=0;t<8;++t){(0,$t.s)(ee,t%4==0||t%4==3?-1:1,t%4==0||t%4==1?-1:1,t<4?a:h,1);const e=ie[t];(0,$t.t)(e,ee,this._projectionViewInverse),e[0]/=e[3],e[1]/=e[3],e[2]/=e[3]}(0,m.v)(he,ie[0]),r.camera.viewMatrix=(0,v.Tl)(te,this._modelViewLight,he);for(let t=0;t<8;++t)(0,m.t)(ie[t],ie[t],r.camera.viewMatrix);let l=ie[0][2],c=ie[0][2];for(let t=1;t<8;++t)l=Math.min(l,ie[t][2]),c=Math.max(c,ie[t][2]);l-=200,c+=200,r.camera.near=-c,r.camera.far=-l,function(t,e,i,n,r){const s=1/ie[0][3],o=1/ie[4][3];(0,St.vA)(s<o);let a=s+Math.sqrt(s*o);const h=Math.sin((0,Vt.XM)(t[2]*e[0]+t[6]*e[1]+t[10]*e[2]));a/=h,function(t,e,i,n,r,s,o,a){(0,G.hZ)(de,0,0);for(let e=0;e<4;++e)(0,G.WQ)(de,de,t[e]);(0,G.hs)(de,de,.25),(0,G.hZ)(fe,0,0);for(let e=4;e<8;++e)(0,G.WQ)(fe,fe,t[e]);(0,G.hs)(fe,fe,.25),(0,G.Cc)(pe[0],t[4],t[5],.5),(0,G.Cc)(pe[1],t[5],t[6],.5),(0,G.Cc)(pe[2],t[6],t[7],.5),(0,G.Cc)(pe[3],t[7],t[4],.5);let h=0,l=(0,G.hG)(pe[0],de);for(let t=1;t<4;++t){const e=(0,G.hG)(pe[t],de);e<l&&(l=e,h=t)}(0,G.Re)(ge,pe[h],t[h+4]);const c=ge[0];let u,d;ge[0]=-ge[1],ge[1]=c,(0,G.Re)(ve,fe,de),(0,G.Om)(ve,ge)<0&&(0,G.ze)(ge,ge),(0,G.Cc)(ge,ge,ve,i),(0,G.S8)(ge,ge),u=d=(0,G.Om)((0,G.Re)(me,t[0],de),ge);for(let e=1;e<8;++e){const i=(0,G.Om)((0,G.Re)(me,t[e],de),ge);i<u?u=i:i>d&&(d=i)}(0,G.C)(n,de),(0,G.hs)(me,ge,u-e),(0,G.WQ)(n,n,me);let f=-1,p=1,g=0,v=0;for(let e=0;e<8;++e){(0,G.Re)(ye,t[e],n),(0,G.S8)(ye,ye);const i=ge[0]*ye[1]-ge[1]*ye[0];i>0?i>f&&(f=i,g=e):i<p&&(p=i,v=e)}(0,St.MX)(f>0,"leftArea"),(0,St.MX)(p<0,"rightArea"),(0,G.hs)(_e,ge,u),(0,G.WQ)(_e,_e,de),(0,G.hs)(be,ge,d),(0,G.WQ)(be,be,de),we[0]=-ge[1],we[1]=ge[0];const m=(0,St.L)(n,t[v],be,(0,G.WQ)(me,be,we),1,r),y=(0,St.L)(n,t[g],be,me,1,s),_=(0,St.L)(n,t[g],_e,(0,G.WQ)(me,_e,we),1,o),b=(0,St.L)(n,t[v],_e,me,1,a);(0,St.MX)(m,"rayRay"),(0,St.MX)(y,"rayRay"),(0,St.MX)(_,"rayRay"),(0,St.MX)(b,"rayRay")}(ie,a,h,ne,re,se,oe,ae),function(t,e,i,n,r){(0,G.Re)(Me,i,n),(0,G.hs)(Me,Me,.5),Se[0]=Me[0],Se[1]=Me[1],Se[2]=0,Se[3]=Me[1],Se[4]=-Me[0],Se[5]=0,Se[6]=Me[0]*Me[0]+Me[1]*Me[1],Se[7]=Me[0]*Me[1]-Me[1]*Me[0],Se[8]=1,Se[xe(0,2)]=-(0,G.Om)(Ae(Se,0),t),Se[xe(1,2)]=-(0,G.Om)(Ae(Se,1),t);let s=(0,G.Om)(Ae(Se,0),i)+Se[xe(0,2)],o=(0,G.Om)(Ae(Se,1),i)+Se[xe(1,2)],a=(0,G.Om)(Ae(Se,0),n)+Se[xe(0,2)],h=(0,G.Om)(Ae(Se,1),n)+Se[xe(1,2)];s=-(s+a)/(o+h),Se[xe(0,0)]+=Se[xe(1,0)]*s,Se[xe(0,1)]+=Se[xe(1,1)]*s,Se[xe(0,2)]+=Se[xe(1,2)]*s,s=1/((0,G.Om)(Ae(Se,0),i)+Se[xe(0,2)]),o=1/((0,G.Om)(Ae(Se,1),i)+Se[xe(1,2)]),Se[xe(0,0)]*=s,Se[xe(0,1)]*=s,Se[xe(0,2)]*=s,Se[xe(1,0)]*=o,Se[xe(1,1)]*=o,Se[xe(1,2)]*=o,Se[xe(2,0)]=Se[xe(1,0)],Se[xe(2,1)]=Se[xe(1,1)],Se[xe(2,2)]=Se[xe(1,2)],Se[xe(1,2)]+=1,s=(0,G.Om)(Ae(Se,1),e)+Se[xe(1,2)],o=(0,G.Om)(Ae(Se,2),e)+Se[xe(2,2)],a=(0,G.Om)(Ae(Se,1),i)+Se[xe(1,2)],h=(0,G.Om)(Ae(Se,2),i)+Se[xe(2,2)],s=-.5*(s/o+a/h),Se[xe(1,0)]+=Se[xe(2,0)]*s,Se[xe(1,1)]+=Se[xe(2,1)]*s,Se[xe(1,2)]+=Se[xe(2,2)]*s,s=(0,G.Om)(Ae(Se,1),e)+Se[xe(1,2)],o=(0,G.Om)(Ae(Se,2),e)+Se[xe(2,2)],a=-o/s,Se[xe(1,0)]*=a,Se[xe(1,1)]*=a,Se[xe(1,2)]*=a,r[0]=Se[0],r[1]=Se[1],r[2]=0,r[3]=Se[2],r[4]=Se[3],r[5]=Se[4],r[6]=0,r[7]=Se[5],r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=Se[6],r[13]=Se[7],r[14]=0,r[15]=Se[8]}(ne,re,oe,ae,r.projectionMatrix),r.projectionMatrix[10]=2/(i-n),r.projectionMatrix[14]=-(i+n)/(i-n)}(i,n,l,c,r.camera),(0,v.lw)(r.lightMat,r.camera.projectionMatrix,r.camera.viewMatrix);const u=this._textureHeight;r.camera.viewport=[t*u,0,u,u]}_setupMatrices(t,e){(0,v.lw)(this._projectionView,t.projectionMatrix,t.viewMatrix),(0,v.B8)(this._projectionViewInverse,this._projectionView);const i=this._viewingMode===Wt.RT.Global?t.eye:(0,m.i)(he,0,0,1);(0,v.t5)(this._modelViewLight,[0,0,0],[-e[0],-e[1],-e[2]],i)}_computeCascadeDistances(t,e,i){const n=i?this.settings.maxNumCascadesHighQuality:this.settings.maxNumCascadesLowQuality;this._numCascades=Math.min(1+Math.floor((0,St.kL)(e/t,4)),n);const r=(e-t)/this._numCascades,s=(e/t)**(1/this._numCascades);let o=t,a=t;for(let t=0;t<this._numCascades+1;++t)this._cascadeDistances[t]=(0,Vt.Cc)(o,a,this.settings.splitSchemeLambda),o*=s,a+=r}get test(){}}const te=(0,Nt.vt)(),ee=(0,L.vt)(),ie=[];for(let t=0;t<8;++t)ie.push((0,L.vt)());const ne=(0,Dt.vt)(),re=(0,Dt.vt)(),se=(0,Dt.vt)(),oe=(0,Dt.vt)(),ae=(0,Dt.vt)(),he=(0,y.vt)(),le=[],ce=(0,Nt.vt)(),ue=Nt.zK.concat(Nt.zK,Nt.zK,Nt.zK,Nt.zK),de=(0,Dt.vt)(),fe=(0,Dt.vt)(),pe=[(0,Dt.vt)(),(0,Dt.vt)(),(0,Dt.vt)(),(0,Dt.vt)()],ge=(0,Dt.vt)(),ve=(0,Dt.vt)(),me=(0,Dt.vt)(),ye=(0,Dt.vt)(),_e=(0,Dt.vt)(),be=(0,Dt.vt)(),we=(0,Dt.vt)();function xe(t,e){return 3*e+t}const Te=(0,Dt.vt)();function Ae(t,e){return(0,G.hZ)(Te,t[e],t[e+3]),Te}const Me=(0,Dt.vt)(),Se=(0,Ut.vt)();var Ee=i(83525),Ce=i(13794),Oe=i(89756),Re=i(23545),Ie=i(49845),Pe=i(38177),Ne=i(96253),De=i(57701),Le=i(26347);let ze=class extends Ee.A{constructor(t){super(t),this._pending=new je,this._changes=new Re.VR,this._renderers=new Map,this._sortedRenderers=new c.A,this._geometries=new Map,this._hasHighlights=!1,this._hasWater=!1}destroy(){this._changes.prune(),this._renderers.forEach((t=>t.destroy())),this._renderers.clear(),this._sortedRenderers.clear(),this._geometries.clear(),this._pending.clear()}get updating(){return!this._pending.empty||this._changes.updates.length>0}get rctx(){return this.rendererContext.rctx}get _materials(){return this.rendererContext.materials}get _localOriginFactory(){return this.rendererContext.localOriginFactory}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccludedDraped(){for(const t of this._renderers.values())if(0!==t.numGeometries&&!t.queryRenderOccludedState(It.m$.Occlude))return!0;return!1}get isEmpty(){return!this.updating&&0===this._renderers.size&&0===this._geometries.size}getMaterialRenderer(t){return this._renderers.get(t)}get sortedRenderers(){return this._sortedRenderers}commitChanges(){if(!this.updating)return!1;this._processAddsRemoves();const t=(0,De.$T)(this._changes);let e=!1;return t.forEach(((t,i)=>{let n=this._renderers.get(i);!n&&t.adds.length>0&&(n=new Le.y({material:i}),n.initializeRenderContext(this.rendererContext.pluginContext,this._materials),this._renderers.set(i,n),e=!0),n&&(n.modify(t),0===n.numGeometries&&(this._renderers.delete(i),n.destroy(),e=!0))})),this._changes.clear(),e&&this._updateSortedMaterialRenderers(),this._hasHighlights=(0,h.Bs)(this._renderers,(t=>{const e=t.produces.get(jt.N.DRAPED_MATERIAL);return!!e&&e(C.V.Highlight)})),this._hasWater=(0,h.Bs)(this._renderers,(t=>{const e=t.produces.get(jt.N.DRAPED_WATER);return!!e&&e(C.V.Normal)})),this.notifyChange("updating"),!0}addGeometries(t,e){if(0===t.length)return;const i=this._validateRenderGeometries(t);for(const t of i)this._geometries.set(t.id,t);const n=this._pending.empty;for(const t of i)this._pending.adds.add(t);n&&this.notifyChange("updating"),e===Ne.q.UPDATE&&this._notifyGraphicGeometryChanged(t)}removeGeometries(t,e){const i=this._pending.empty,n=this._pending.adds;for(const e of t)n.has(e)?(this._pending.removed.add(e),n.delete(e)):this._pending.removed.has(e)||this._pending.removes.add(e),this._geometries.delete(e.id);i&&!this._pending.empty&&this.notifyChange("updating"),e===Ne.q.UPDATE&&this._notifyGraphicGeometryChanged(t)}modifyGeometries(t,e){const i=0===this._changes.updates.length;for(const i of t){const t=this._changes.updates.pushNew();t.renderGeometry=this._validateRenderGeometry(i),t.updateType=e}switch(i&&this._changes.updates.length>0&&this.notifyChange("updating"),e){case Ne.k.TRANSFORMATION:case Ne.k.GEOMETRY:return this._notifyGraphicGeometryChanged(t);case Ne.k.VISIBILITY:return this._notifyGraphicVisibilityChanged(t)}}updateAnimation(t){let e=!1;return this._sortedRenderers.forAll((i=>e=!!i.updateAnimation&&i.updateAnimation(t)||e)),e}precompile(t){return this._sortedRenderers.reduce(((e,i)=>i.precompile(t)||e),!1)}render(t){this._sortedRenderers.forAll((e=>{const i=e.acquireTechniques(t);i&&(e.render(t,i),(0,B.VM)(i))}))}intersect(t,e,i,n,r){for(const s of this._geometries.values()){if(!n(s))continue;this._intersectRenderGeometry(s,i,e,0,t,r);const o=this.rendererContext.longitudeCyclical;o&&(s.boundingSphere[0]-s.boundingSphere[3]<o.min&&this._intersectRenderGeometry(s,i,e,o.range,t,r),s.boundingSphere[0]+s.boundingSphere[3]>o.max&&this._intersectRenderGeometry(s,i,e,-o.range,t,r)),r++}return r}_updateSortedMaterialRenderers(){this._sortedRenderers.clear();let t=0;for(const e of this._renderers.values())e.drapedPriority=t++,this._sortedRenderers.push(e);this._sortedRenderers.sort(((t,e)=>e.material?.renderPriority===t.material?.renderPriority?t.drapedPriority-e.drapedPriority:(e.material?.renderPriority||0)-(t.material?.renderPriority||0)))}_processAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes)),this._changes.updates.filterInPlace((({renderGeometry:t})=>!this._pending.has(t))),this._pending.clear()}_intersectRenderGeometry(t,e,i,n,r,s){if(!t.visible||!t.material.visible)return;let o=0;n+=t.transformation[12],o=t.transformation[13],ke[0]=i[0]-n,ke[1]=i[1]-o,t.screenToWorldRatio=this.rendererContext.screenToWorldRatio,t.material.intersectDraped(t,null,r,ke,((i,n,o)=>{!function(t,e,i,n,r,s,o){const a=new Oe.MQ(s,o,e),h=e=>{e.set(Pe.dz.OVERLAY,a,t.dist,t.normal,t.transformation,i,n)};if((null==r.results.min.drapedLayerOrder||i>=r.results.min.drapedLayerOrder)&&(null==r.results.min.dist||r.results.ground.dist<=r.results.min.dist)&&h(r.results.min),r.options.store!==Pe.oH.MIN&&(null==r.results.max.drapedLayerOrder||i<r.results.max.drapedLayerOrder)&&(null==r.results.max.dist||r.results.ground.dist>r.results.max.dist)&&h(r.results.max),r.options.store===Pe.oH.ALL){const t=(0,Ie.G7)(r.ray);h(t),r.results.all.push(t)}}(e,o,s,t.material.renderPriority,r,t.layerUid,t.graphicUid)}),e)}_notifyGraphicGeometryChanged(t){if(null==this.drapeSource.notifyGraphicGeometryChanged)return;let e;for(const{graphicUid:i}of t)null!=i&&i!==e&&(this.drapeSource.notifyGraphicGeometryChanged(i),e=i)}_notifyGraphicVisibilityChanged(t){if(null==this.drapeSource.notifyGraphicVisibilityChanged)return;let e;for(const{graphicUid:i}of t)null!=i&&i!==e&&(this.drapeSource.notifyGraphicVisibilityChanged(i),e=i)}_validateRenderGeometries(t){for(const e of t)this._validateRenderGeometry(e);return t}_validateRenderGeometry(t){return null==t.localOrigin&&(t.localOrigin=this._localOriginFactory.getOrigin((0,Ce.a)(t.boundingSphere))),t}get test(){}};(0,s._)([(0,f.MZ)()],ze.prototype,"drapeSource",void 0),(0,s._)([(0,f.MZ)()],ze.prototype,"updating",null),(0,s._)([(0,f.MZ)()],ze.prototype,"rctx",null),(0,s._)([(0,f.MZ)({constructOnly:!0})],ze.prototype,"rendererContext",void 0),(0,s._)([(0,f.MZ)()],ze.prototype,"_materials",null),(0,s._)([(0,f.MZ)()],ze.prototype,"_localOriginFactory",null),(0,s._)([(0,f.MZ)({readOnly:!0})],ze.prototype,"isEmpty",null),(0,s._)([(0,f.MZ)()],ze.prototype,"_renderers",void 0),(0,s._)([(0,f.MZ)()],ze.prototype,"_geometries",void 0),ze=(0,s._)([(0,g.$)("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],ze);class je{constructor(){this.adds=new Set,this.removes=new Set,this.removed=new Set}get empty(){return 0===this.adds.size&&0===this.removes.size&&0===this.removed.size}has(t){return this.adds.has(t)||this.removes.has(t)||this.removed.has(t)}clear(){this.adds.clear(),this.removes.clear(),this.removed.clear()}}const ke=(0,Dt.vt)();class Fe extends W.w{constructor(t,e,n){super(t,e,new $.$(H.a,(()=>i.e(6404).then(i.bind(i,41722)))),n)}initializePipeline(t){return t.hasAlpha?(0,Z.Ey)({blending:Z.Ky,colorWrite:Z.kn}):(0,Z.Ey)({colorWrite:Z.kn})}}var He=i(65875);class Be extends He.K{constructor(){super(...arguments),this.hasAlpha=!1}}(0,s._)([(0,He.W)()],Be.prototype,"hasAlpha",void 0);var Ge=i(91998),Ve=i(35910),Ue=i(94010);class $e extends W.w{constructor(t,e,n){super(t,e,new $.$(Ue.a,(()=>i.e(5835).then(i.bind(i,49706)))),n)}}var We=i(48961);let qe=class extends B.RW{constructor(t){super(t),this._overlays=null,this._renderTargets=null,this._overlayParameters=new Ue.O,this.hasHighlights=!1,this._hasWater=!1,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new c.A,this._passParameters=new H.T,this._materials=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.unloadedMemory=0,this.ignoresMemoryFactor=!1,this._camera=new D.A,this.worldToPCSRatio=1,this.events=new o.A,this.longitudeCyclical=null,this.produces=new Map([[jt.N.DRAPED_MATERIAL,t=>t!==C.V.Highlight||this.hasHighlights],[jt.N.DRAPED_WATER,()=>this._hasWater]]),this._hasTargetWithoutRasterImage=!1,this._hasDrapedFeatureSource=!1,this._hasDrapedRasterSource=!1}initialize(){const{view:t}=this,{_stage:e}=t,i=e.renderer.fboCache,n=e.renderView,{waterTextures:r,textures:s}=n;this._renderContext=new Bt(this._rctx,new Qt(i,t.state.viewingMode)),this.addHandles([(0,u.watch)((()=>r.updating),(()=>this.events.emit("content-changed")),u.pc),(0,u.watch)((()=>this.spatialReference),(t=>this._localOriginFactory=new Rt.g(t)),u.pc),(0,u.on)((()=>this.view.allLayerViews),"after-changes",(()=>this._sortedDrapeSourceRenderersDirty=!0)),(0,u.watch)((()=>xt(this.view.highlights)),(()=>this._sortedDrapeSourceRenderersDirty=!0),u.pc)]),this._materials=new Et(s,this._techniques,(()=>{this.notifyChange("rendersOccludedDraped"),this.events.emit("content-changed"),this.notifyChange("updating"),this.notifyChange("isEmpty")}),(()=>this.events.emit("content-changed")));const{_bindParameters:o,_camera:a}=this;o.slot=jt.N.DRAPED_MATERIAL,o.mainDepth=null,a.near=1,a.far=1e4,a.relativeElevation=null,o.camera=this._camera,o.oitPass=Pt.Y.NONE,o.updateLighting([new Ve.$p((0,y.S)())],0,0,Ot.Immediate),this.addHandles(this.view.resourceController.scheduler.registerTask(We.W6.STAGE,this))}destroy(){this._renderers.forEach((t=>t.destroy())),this._renderers.clear(),this._passParameters.texture=(0,l.WD)(this._passParameters.texture),this.disposeOverlays()}get _bindParameters(){return this._renderContext.bind}get _rctx(){return this.view._stage.renderView.renderingContext}get _techniques(){return this.view._stage.renderView.techniques}get rctx(){return this._rctx}get materials(){return this._materials}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}get pluginContext(){return this._pluginContext}initializeRenderContext(t){this._pluginContext=t,this._techniques.precompile($e)}uninitializeRenderContext(){}acquireTechniques(){return[]}render(){}get updating(){return this._sortedDrapeSourceRenderersDirty||(0,h.Bs)(this._renderers,(t=>t.updating))}get hasOverlays(){return null!=this._overlays&&null!=this._renderTargets}getMaterialRenderer(t){for(const e of this._renderers.values()){const i=e.getMaterialRenderer(t);if(i)return i}return null}get layers(){return this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers(),this._sortedRenderers.map((t=>t.drapeSource.layer)).filter((t=>!!t))}createGeometryDrapeSourceRenderer(t){return this.createDrapeSourceRenderer(t,ze)}createDrapeSourceRenderer(t,e,i){const n=this._renderers.get(t);null!=n&&n.destroy();const r=new e({...i,rendererContext:this,drapeSource:t});return this._renderers.set(t,r),this._sortedDrapeSourceRenderersDirty=!0,"fullOpacity"in t&&this.addHandles((0,u.watch)((()=>t.fullOpacity),(()=>this.events.emit("content-changed"))),t),r}removeDrapeSourceRenderer(t){if(null==t)return;const e=this._renderers.get(t);null!=e&&(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(t),this.removeHandles(t),e.destroy())}computeValidity(){return this._renderTargets?.computeValidity()??0}releaseRenderTargets(){this._renderTargets?.dispose()}get overlays(){return this._overlays??[]}ensureDrapeTargets(t){this._hasTargetWithoutRasterImage=!!this._overlays&&(0,d.bw)(t,(t=>t.drapeTargetType===_.sv.WithoutRasterImage))}ensureDrapeSources(t){this._overlays?(this._hasDrapedFeatureSource=(0,d.bw)(t,(t=>t.drapeSourceType===_.Om.Features)),this._hasDrapedRasterSource=(0,d.bw)(t,(t=>t.drapeSourceType===_.Om.RasterImage))):this._hasDrapedFeatureSource=this._hasDrapedRasterSource=!1}get _needsColorWithoutRasterImage(){return this._hasDrapedRasterSource&&this._hasDrapedFeatureSource&&this._hasTargetWithoutRasterImage}ensureOverlays(t,e,i=this._bindParameters.overlayStretch){null==this._overlays&&(this._renderTargets=new I(this.view._stage.renderer.fboCache),this._overlays=[new A,new A]),this.ensureDrapeTargets(t),this.ensureDrapeSources(e),this._bindParameters.overlayStretch=i}disposeOverlays(){this._overlays=null,this._renderTargets=(0,l.WD)(this._renderTargets),this.events.emit("textures-disposed")}getTexture(t){if(null!=t)return t===n.ColorNoRasterImage&&!this._needsColorWithoutRasterImage&&this._hasDrapedFeatureSource?this._renderTargets?.getTexture(n.Color):this._renderTargets?.getTexture(t)}get running(){return this.updating}runTask(t){this._processDrapeSources(t,(()=>!0))}_processDrapeSources(t,e){let i=!1;for(const[n,r]of this._renderers){if(t.done)break;(n.destroyed||e(n))&&r.commitChanges()&&(i=!0,t.madeProgress())}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,i=!0,this._updateSortedDrapeSourceRenderers()),i&&(null!=this._overlays&&0===this._renderers.size&&this.disposeOverlays(),this.notifyChange("updating"),this.notifyChange("isEmpty"),this.events.emit("content-changed"),this.hasHighlights=(0,h.Bs)(this._renderers,(t=>t.hasHighlights)),this.notifyChange("rendersOccludedDraped"),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(We.Bb,(t=>t.updatePolicy===Ge.q.SYNC))}get isEmpty(){return!b.b.OVERLAY_DRAW_DEBUG_TEXTURE&&!(0,h.Bs)(this._renderers,(t=>!t.isEmpty))}get hasWater(){return this._hasWater}get rendersOccludedDraped(){const t=this._renderContext.renderOccludedMask;this._renderContext.renderOccludedMask=Ke,++this._techniques.precompiling;const e=this._sortedRenderers.some((({renderer:t})=>t.precompile(this._renderContext)));return--this._techniques.precompiling,this._renderContext.renderOccludedMask=t,e}renders(t){if(b.b.OVERLAY_DRAW_DEBUG_TEXTURE&&t!==n.Occluded&&t!==n.Highlight)return!0;++this._techniques.precompiling;const e=this._sortedRenderers.some((({renderer:t})=>t.precompile(this._renderContext)));return--this._techniques.precompiling,e}get mode(){return this.isEmpty?z.Disabled:this._renderTargets?.getTexture(n.WaterNormal)?z.EnabledWithWater:this._renderTargets?.getTexture(n.Color)?z.Enabled:z.Disabled}updateAnimation(t){let e=!1;return this._renderers.forEach((i=>e=i.updateAnimation(t)||e)),e}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}precompileShaders(t){if(this._renderTargets){this._bindParameters.alignPixelEnabled=t.alignPixelEnabled,this._bindParameters.highlightGroupName=null,++this._techniques.precompiling;for(const t of this._renderTargets.targets){if(t.content===n.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const e=t.output;this._renderContext.output=e,this._bindParameters.slot=e===C.V.Normal?jt.N.DRAPED_WATER:jt.N.DRAPED_MATERIAL,t.content===n.Occluded&&(this._renderContext.renderOccludedMask=Ke),this._sortedRenderers.forAll((({drapeSource:e,renderer:i})=>{t.content===n.ColorNoRasterImage&&e.drapeSourceType===_.Om.RasterImage||i.precompile(this._renderContext)})),this._renderContext.renderOccludedMask=Gt}--this._techniques.precompiling}}drawOverlays(t){if(this._overlays&&this._renderTargets){for(const t of this._overlays)this.longitudeCyclical?t.setupGeometryViewsCyclical(this.longitudeCyclical):t.setupGeometryView();this._bindParameters.alignPixelEnabled=t.alignPixelEnabled;for(const e of this._renderTargets.targets){if(e.content===n.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const i=this._drawTarget(w.vr.INNER,e,t),r=this._drawTarget(w.vr.OUTER,e,t);(i||r)&&e.fbo.generateMipMap()}}}_drawTarget(t,e,i){const r=this._overlays[t],s=r.canvasGeometries;if(0===s.numViews)return!1;const{contentPixelRatio:o}=i;this._screenToWorldRatio=o*r.mapUnitsPerPixel/this._bindParameters.overlayStretch;const a=e.output;if(this.isEmpty||a===C.V.Normal&&!this.hasWater||!r.hasSomeSizedView())return!1;const{_rctx:h,_bindParameters:l}=this;if(this._camera.pixelRatio=r.pixelRatio*o,this._renderContext.output=a,l.screenToWorldRatio=this._screenToWorldRatio,l.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,l.slot=a===C.V.Normal?jt.N.DRAPED_WATER:jt.N.DRAPED_MATERIAL,e.content===n.Occluded&&(this._renderContext.renderOccludedMask=Ke),l.highlightGroupName=null,!this.renders(e.content))return this._renderContext.renderOccludedMask=Gt,!1;const{resolution:c}=r,u=t===w.vr.INNER?0:c;if(h.setViewport(u,0,c,c),this._bindTargetFBO(e),t===w.vr.INNER&&(h.setClearColor(0,0,0,0),h.clear(lt.NV.COLOR)),b.b.OVERLAY_DRAW_DEBUG_TEXTURE&&e.content!==n.Occluded&&e.content!==n.Highlight){this._techniques.precompile(Fe,Je);const e=this._techniques.acquire(Fe,Je);for(let i=0;i<s.numViews;i++)this._setViewParameters(s.extents[i],r),this._ensureDebugPatternResources(r.resolution,Ye[t]),h.bindTechnique(e,l,this._passParameters),h.screen.draw();e.release()}if(e.output===C.V.Highlight){const{fboCache:i}=this.view._stage.renderer,n=this._resolution;!function(t,e,i,n,r,s,o=0,a){const{highlightGroupIndices:h}=r;h.clear();const l=[];bt(n,(t=>{const{name:e}=t;h.set(e,l.length),l.push(e)}));const c=h.size,{gl:u}=t;(0,G.hZ)(r.highlightMixOrigin,o,0);let d=null;c>1&&(d=e.acquire(i.width,i.height,"highlight mix",E.N.RG),t.bindFramebuffer(d.fbo),t.clearFramebuffer(L.uY));const f=d?.getTexture()??null;r.highlightMixTexture=f,a();for(let e=0;e<c;++e)e>0&&(t.bindTexture(f,0),u.copyTexSubImage2D(lt.Ap.TEXTURE_2D,0,0,0,o,0,i.width,i.height),t.bindTexture(null,0)),t.clear(lt.NV.DEPTH),r.highlightLevel=e,r.highlightGroupName=l[e],s();d?.release()}(h,i,{width:n,height:n},this.view.highlights,l,(()=>this._renderAllGeometry(t,e)),u,(()=>this._bindTargetFBO(e)))}else this._renderAllGeometry(t,e);return h.bindFramebuffer(null),this._renderContext.renderOccludedMask=Gt,!0}_renderAllGeometry(t,e){const i=this._overlays[t],r=i.canvasGeometries;this._sortedRenderers.forAll((({drapeSource:s,renderer:o})=>{if(e.content===n.ColorNoRasterImage&&s.drapeSourceType===_.Om.RasterImage)return;const{fullOpacity:a}=s,h=null!=a&&a<1&&e.output===C.V.Color&&this._bindTemporaryFBO();for(let t=0;t<r.numViews;t++)this._setViewParameters(r.extents[t],i),o.render(this._renderContext);if(h){this._bindTargetFBO(e),this._overlayParameters.texture=h.getTexture(),this._overlayParameters.opacity=a,this._overlayParameters.overlayIndex=t;const i=this._techniques.acquire($e);this._rctx.bindTechnique(i,this._bindParameters,this._overlayParameters),this._rctx.screen.draw(),i.release(),h.release()}}))}_bindTargetFBO(t){const e=this._resolution,i=2*e;t.fbo.bind(this._rctx,i,e)}_bindTemporaryFBO(){const t=this._resolution,e=2*t,i=this.view._stage.renderer.fboCache,n=i.acquire(e,t,"overlay tmp");return i.rctx.bindFramebuffer(n.fbo),i.rctx.clear(lt.NV.COLOR),n}get _resolution(){return this._overlays?.[w.vr.INNER].resolution??0}notifyContentChanged(){this.events.emit("content-changed")}intersect(t,e,i,n){this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers();let r=0;for(const{renderer:s}of this._sortedRenderers)r=s.intersect?.(t,e,i,n,r)??r}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),0===this._renderers.size)return;const t=this.view.map.allLayers,e=t.length;this._renderers.forEach(((i,n)=>{const r=t.indexOf(n.layer),s=r>=0,o=n.renderGroup??(s?_.O7.MapLayer:_.O7.ViewLayer),a=e*o+(s?r:0);this._sortedRenderers.push(new Ze(n,i,a))})),this._sortedRenderers.sort(((t,e)=>t.index-e.index))}_setViewParameters(t,e){const i=this._camera;i.viewport=[0,0,e.resolution,e.resolution],(0,v.v3)(i.projectionMatrix,0,t[2]-t[0],0,t[3]-t[1],i.near,i.far),(0,v.kN)(i.viewMatrix,[-t[0],-t[1],0])}_updateHasWater(){const t=(0,h.Bs)(this._renderers,(t=>t.hasWater));t!==this._hasWater&&(this._hasWater=t,this.events.emit("has-water"))}_ensureDebugPatternResources(t,e){if((0,m.i)(this._passParameters.color,e[0],e[1],e[2]),this._passParameters.texture)return;const i=new Uint8Array(t*t*4);let n=0;for(let e=0;e<t;e++)for(let r=0;r<t;r++){const s=Math.floor(r/10),o=Math.floor(e/10);s<2||o<2||10*s>t-20||10*o>t-20?(i[n++]=255,i[n++]=255,i[n++]=255,i[n++]=255):(i[n++]=255,i[n++]=255,i[n++]=255,i[n++]=1&s&&1&o?1&r^1&e?0:255:1&s^1&o?0:128)}const r=new gt.R(t);r.samplingMode=lt.Cj.NEAREST,this._passParameters.texture=new pt.g(this._rctx,r,i)}get test(){}};(0,s._)([(0,f.MZ)()],qe.prototype,"hasHighlights",void 0),(0,s._)([(0,f.MZ)()],qe.prototype,"_sortedDrapeSourceRenderersDirty",void 0),(0,s._)([(0,f.MZ)({constructOnly:!0})],qe.prototype,"view",void 0),(0,s._)([(0,f.MZ)({readOnly:!0})],qe.prototype,"_techniques",null),(0,s._)([(0,f.MZ)()],qe.prototype,"worldToPCSRatio",void 0),(0,s._)([(0,f.MZ)()],qe.prototype,"spatialReference",void 0),(0,s._)([(0,f.MZ)({type:Boolean,readOnly:!0})],qe.prototype,"updating",null),(0,s._)([(0,f.MZ)()],qe.prototype,"isEmpty",null),(0,s._)([(0,f.MZ)({readOnly:!0})],qe.prototype,"rendersOccludedDraped",null),qe=(0,s._)([(0,g.$)("esri.views.3d.terrain.OverlayRenderer")],qe);class Ze{constructor(t,e,i){this.drapeSource=t,this.renderer=e,this.index=i}}const Ye=[[1,.5,.5],[.5,.5,1]],Xe=-2,Ke=It.m$.OccludeAndTransparent,Je=new Be;Je.hasAlpha=!0},86398:function(t,e,i){"use strict";var n,r,s;i.d(e,{vr:function(){return n}}),function(t){t[t.INNER=0]="INNER",t[t.OUTER=1]="OUTER"}(n||(n={})),function(t){t[t.REGULAR=0]="REGULAR",t[t.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",t[t.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",t[t.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(r||(r={})),function(t){t[t.FADING=0]="FADING",t[t.IMMEDIATE=1]="IMMEDIATE",t[t.UNFADED=2]="UNFADED"}(s||(s={}))},30087:function(t,e,i){"use strict";i.d(e,{i$:function(){return l},oD:function(){return c},xJ:function(){return h}});var n=i(27264),r=i(66299),s=i(11687),o=i(39506);function a(t){t.varyings.add("linearDepth","float")}function h(t){t.vertex.uniforms.add(new s.G("nearFar",((t,e)=>e.camera.nearFar)))}function l(t){t.vertex.code.add(o.H`float calculateLinearDepth(vec2 nearFar,float z) {
return (-z - nearFar[0]) / (nearFar[1] - nearFar[0]);
}`)}function c(t,e){const{vertex:i}=t;switch(e.output){case n.V.Color:case n.V.ColorEmission:if(e.receiveShadows)return a(t),void i.code.add(o.H`void forwardLinearDepth() { linearDepth = gl_Position.w; }`);break;case n.V.Shadow:case n.V.ShadowHighlight:case n.V.ShadowExcludeHighlight:case n.V.ViewshedShadow:return t.include(r.em,e),a(t),h(t),l(t),void i.code.add(o.H`void forwardLinearDepth() {
linearDepth = calculateLinearDepth(nearFar, vPosition_view.z);
}`)}i.code.add(o.H`void forwardLinearDepth() {}`)}},28721:function(t,e,i){"use strict";i.d(e,{Q:function(){return a}});var n=i(12511),r=i(39506),s=i(39838),o=i(40434);function a(t){const{vertex:e}=t;e.uniforms.add(new s.N("coverageTexture",(t=>t.coverageTexture)),new n.g("highlightRenderCellCount",(t=>[t.horizontalCellCount,t.verticalCellCount])),new n.g("highlightTextureResolution",(t=>[t.highlightTexture.descriptor.width,t.highlightTexture.descriptor.height]))),e.constants.add("cellSize","int",o.g),t.varyings.add("sUV","vec2"),t.varyings.add("vOutlinePossible","float"),e.code.add(r.H`const ivec2 cellVertices[4] = ivec2[4](ivec2(0,0), ivec2(1,0), ivec2(0,1), ivec2(1,1));`),e.main.add(r.H`int cellIndex = gl_InstanceID;
int cellX = cellIndex % highlightRenderCellCount[0];
int cellY = (cellIndex - cellX) / highlightRenderCellCount[0];
ivec2 cellPos = ivec2(cellX, cellY);
vec4 cov = texelFetch(coverageTexture, cellPos, 0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
return;
}
vOutlinePossible = cov.g;
ivec2 iPosInCell = cellVertices[gl_VertexID];
vec2 sPos = vec2(cellPos * cellSize + iPosInCell * (cellSize));
vec2 vPos = sPos / vec2(highlightTextureResolution);
sUV = vPos;
gl_Position = vec4(2.0 * vPos - vec2(1.0), 0.0, 1.0);`)}},74571:function(t,e,i){"use strict";i.d(e,{y:function(){return r}});var n=i(39506);function r(t){const{fragment:e}=t;e.code.add(n.H`uint readChannelBits(uint channel, int highlightLevel) {
int llc = (highlightLevel & 3) << 1;
return (channel >> llc) & 3u;
}
uint readChannel(vec2 texel, int highlightLevel) {
int lic = (highlightLevel >> 2) & 1;
return uint(texel[lic] * 255.0);
}
uint readLevelBits(vec2 texel, int highlightLevel) {
return readChannelBits(readChannel(texel, highlightLevel), highlightLevel);
}`)}},68561:function(t,e,i){"use strict";i.d(e,{K:function(){return l}});var n=i(23397),r=i(82316),s=i(82598),o=i(14543),a=i(39506),h=i(39838);function l(t,e){const i=t.fragment;i.include(n.E),t.include(r.Ir),i.uniforms.add(new o.m("globalAlpha",(t=>t.globalAlpha)),new s.t("glowColor",(t=>t.glowColor)),new o.m("glowWidth",((t,e)=>t.glowWidth*e.camera.pixelRatio)),new o.m("glowFalloff",(t=>t.glowFalloff)),new s.t("innerColor",(t=>t.innerColor)),new o.m("innerWidth",((t,e)=>t.innerWidth*e.camera.pixelRatio)),new h.N("depthMap",((t,e)=>e.depth?.attachment)),new h.N("normalMap",(t=>t.normals))),i.code.add(a.H`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`),i.code.add(a.H`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`),i.code.add(a.H`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`),i.code.add(a.H`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float angleCutoffAdjust, out float depthDiscontinuityAlpha) {
float depth = depthFromTexture(depthMap, uv);
if (depth == 1.0) {
return false;
}
float linearDepth = linearizeDepth(depth);
pos = reconstructPosition(gl_FragCoord.xy, linearDepth);
float minStep = 6e-8;
float depthStep = clamp(depth + minStep, 0.0, 1.0);
float linearDepthStep = linearizeDepth(depthStep);
float depthError = abs(linearDepthStep - linearDepth);
if (depthError > 0.2) {
normal = texture(normalMap, uv).xyz * 2.0 - 1.0;
angleCutoffAdjust = 0.004;
} else {
normal = normalize(cross(dFdx(pos), dFdy(pos)));
angleCutoffAdjust = 0.0;
}
float ddepth = fwidth(linearDepth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / linearDepth);
return true;
}`),e.contrastControlEnabled?(i.uniforms.add(new h.N("frameColor",((t,e)=>t.colors)),new o.m("globalAlphaContrastBoost",(t=>null!=t.globalAlphaContrastBoost?t.globalAlphaContrastBoost:1))),i.code.add(a.H`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):i.code.add(a.H`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)}},88416:function(t,e,i){"use strict";i.d(e,{L:function(){return o}});var n=i(20830),r=i(14543),s=i(39506);function o(t,e){if(!e.screenSizeEnabled)return;const i=t.vertex;(0,n.yu)(i,e),i.uniforms.add(new r.m("perScreenPixelRatio",((t,e)=>e.camera.perScreenPixelRatio)),new r.m("screenSizeScale",(t=>t.screenSizeScale))).code.add(s.H`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},77423:function(t,e,i){"use strict";i.d(e,{c:function(){return s}});var n=i(39506),r=i(65839);function s(t,e=!0){t.attributes.add(r.r.POSITION,"vec2"),e&&t.varyings.add("uv","vec2"),t.vertex.main.add(n.H`
      gl_Position = vec4(position, 0.0, 1.0);
      ${e?n.H`uv = position * 0.5 + vec2(0.5);`:""}
  `)}},27264:function(t,e,i){"use strict";var n;function r(t){return t===n.Shadow||t===n.ShadowHighlight||t===n.ShadowExcludeHighlight||t===n.ViewshedShadow}function s(t){return g(t)||t===n.Normal}function o(t){return function(t){return function(t){return c(t)||a(t)}(t)||v(t)}(t)||t===n.Normal}function a(t){return t===n.Highlight||t===n.ObjectAndLayerIdColor}function h(t){return l(t)||a(t)}function l(t){return t===n.Color}function c(t){return l(t)||m(t)}function u(t){return l(t)||t===n.ObjectAndLayerIdColor}function d(t){return l(t)||t===n.Highlight}function f(t){return d(t)||v(t)}function p(t){return l(t)||a(t)}function g(t){return p(t)||v(t)}function v(t){return t===n.Depth}function m(t){return t===n.ColorEmission}i.d(e,{CL:function(){return a},LG:function(){return m},MO:function(){return g},PJ:function(){return r},RN:function(){return c},V:function(){return n},XY:function(){return s},_o:function(){return l},aD:function(){return f},dX:function(){return p},eh:function(){return v},i3:function(){return h},iq:function(){return o},zW:function(){return u}}),function(t){t[t.Color=0]="Color",t[t.ColorEmission=1]="ColorEmission",t[t.Depth=2]="Depth",t[t.Normal=3]="Normal",t[t.Shadow=4]="Shadow",t[t.ShadowHighlight=5]="ShadowHighlight",t[t.ShadowExcludeHighlight=6]="ShadowExcludeHighlight",t[t.ViewshedShadow=7]="ViewshedShadow",t[t.Highlight=8]="Highlight",t[t.ObjectAndLayerIdColor=9]="ObjectAndLayerIdColor",t[t.COUNT=10]="COUNT"}(n||(n={}))},13668:function(t,e,i){"use strict";i.d(e,{HQ:function(){return l}});var n=i(73364),r=i(39714),s=i(20551),o=i(32501),a=i(4435),h=(i(82598),i(39506));function l(t,e){!function(t,e,...i){if(!e.hasSlicePlane){const i=h.H`#define rejectBySlice(_pos_) false
#define discardBySlice(_pos_) {}
#define highlightSlice(_color_, _pos_) (_color_)`;return e.hasSliceInVertexProgram&&t.vertex.code.add(i),void t.fragment.code.add(i)}const n=h.H`struct SliceFactors {
float front;
float side0;
float side1;
float side2;
float side3;
};
SliceFactors calculateSliceFactors(vec3 pos) {
vec3 rel = pos - slicePlaneOrigin;
vec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);
float slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);
float basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);
float basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);
float basis1Dot = dot(slicePlaneBasis1, rel);
float basis2Dot = dot(slicePlaneBasis2, rel);
return SliceFactors(
dot(slicePlaneNormal, pos) + slicePlaneW,
-basis1Dot - basis1Len2,
basis1Dot - basis1Len2,
-basis2Dot - basis2Len2,
basis2Dot - basis2Len2
);
}
bool sliceByFactors(SliceFactors factors) {
return factors.front < 0.0
&& factors.side0 < 0.0
&& factors.side1 < 0.0
&& factors.side2 < 0.0
&& factors.side3 < 0.0;
}
bool sliceEnabled() {
return dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;
}
bool sliceByPlane(vec3 pos) {
return sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));
}
#define rejectBySlice(_pos_) sliceByPlane(_pos_)
#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }`,r=h.H`vec4 applySliceHighlight(vec4 color, vec3 pos) {
SliceFactors factors = calculateSliceFactors(pos);
const float HIGHLIGHT_WIDTH = 1.0;
const vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);
factors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);
factors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);
factors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);
factors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);
factors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);
if (sliceByFactors(factors)) {
return color;
}
float highlightFactor = (1.0 - step(0.5, factors.front))
* (1.0 - step(0.5, factors.side0))
* (1.0 - step(0.5, factors.side1))
* (1.0 - step(0.5, factors.side2))
* (1.0 - step(0.5, factors.side3));
return mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);
}`,s=e.hasSliceHighlight?h.H`
        ${r}
        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))
      `:h.H`#define highlightSlice(_color_, _pos_) (_color_)`;e.hasSliceInVertexProgram&&t.vertex.uniforms.add(...i).code.add(n),t.fragment.uniforms.add(...i).code.add(n),t.fragment.code.add(s)}(t,e,new a.W("slicePlaneOrigin",((t,i)=>function(t,e,i){if(null==i.slicePlane)return o.uY;const n=c(t,e,i),r=u(n,i.slicePlane),a=d(t,n,i);return null!=a?(0,s.t)(g,r,a):r}(e,t,i))),new a.W("slicePlaneBasis1",((t,i)=>f(e,t,i,i.slicePlane?.basis1))),new a.W("slicePlaneBasis2",((t,i)=>f(e,t,i,i.slicePlane?.basis2))))}function c(t,e,i){return t.instancedDoublePrecision?(0,s.i)(p,i.camera.viewInverseTransposeMatrix[3],i.camera.viewInverseTransposeMatrix[7],i.camera.viewInverseTransposeMatrix[11]):e.slicePlaneLocalOrigin}function u(t,e){return null!=t?(0,s.d)(g,e.origin,t):e.origin}function d(t,e,i){return t.hasSliceTranslatedView?null!=e?(0,n.Tl)(m,i.camera.viewMatrix,e):i.camera.viewMatrix:null}function f(t,e,i,n){if(null==n||null==i.slicePlane)return o.uY;const r=c(t,e,i),a=u(r,i.slicePlane),h=d(t,r,i);return null!=h?((0,s.g)(v,n,a),(0,s.t)(g,a,h),(0,s.t)(v,v,h),(0,s.d)(v,v,g)):n}h.Y;const p=(0,o.vt)(),g=(0,o.vt)(),v=(0,o.vt)(),m=(0,r.vt)()},34178:function(t,e,i){"use strict";i.d(e,{d:function(){return s}});var n=i(30087),r=i(39506);function s(t){(0,n.i$)(t),t.vertex.code.add(r.H`vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {
vec4 eye = view * vec4(pos, 1.0);
depth = calculateLinearDepth(nearFar,eye.z);
return proj * eye;
}`),t.vertex.code.add(r.H`vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {
return proj * (view * vec4(pos, 1.0));
}`)}},11377:function(t,e,i){"use strict";i.d(e,{W:function(){return n},Y:function(){return h}});var n,r,s=i(82547),o=i(39506),a=i(65839);function h(t,e){switch(e.normalType){case n.Compressed:t.attributes.add(a.r.NORMALCOMPRESSED,"vec2"),t.vertex.code.add(o.H`vec3 decompressNormal(vec2 normal) {
float z = 1.0 - abs(normal.x) - abs(normal.y);
return vec3(normal + sign(normal) * min(z, 0.0), z);
}
vec3 normalModel() {
return decompressNormal(normalCompressed);
}`);break;case n.Attribute:t.attributes.add(a.r.NORMAL,"vec3"),t.vertex.code.add(o.H`vec3 normalModel() {
return normal;
}`);break;case n.ScreenDerivative:t.fragment.code.add(o.H`vec3 screenDerivativeNormal(vec3 positionView) {
return normalize(cross(dFdx(positionView), dFdy(positionView)));
}`);break;default:(0,s.Xb)(e.normalType);case n.COUNT:}}(r=n||(n={}))[r.Attribute=0]="Attribute",r[r.Compressed=1]="Compressed",r[r.ScreenDerivative=2]="ScreenDerivative",r[r.COUNT=3]="COUNT"},27271:function(t,e,i){"use strict";i.d(e,{g:function(){return o}});var n=i(27264),r=i(39506),s=i(65839);function o(t,e){if(e.output!==n.V.ObjectAndLayerIdColor)return t.vertex.code.add(r.H`void forwardObjectAndLayerIdColor() {}`),void t.fragment.code.add(r.H`void outputObjectAndLayerIdColor() {}`);const i=e.objectAndLayerIdColorInstanced;t.varyings.add("objectAndLayerIdColorVarying","vec4"),t.attributes.add(i?s.r.INSTANCEOBJECTANDLAYERIDCOLOR:s.r.OBJECTANDLAYERIDCOLOR,"vec4"),t.vertex.code.add(r.H`
    void forwardObjectAndLayerIdColor() {
      objectAndLayerIdColorVarying = ${i?"instanceObjectAndLayerIdColor":"objectAndLayerIdColor"} * 0.003921568627451;
    }`),t.fragment.code.add(r.H`void outputObjectAndLayerIdColor() {
fragColor = objectAndLayerIdColorVarying;
}`)}},91765:function(t,e,i){"use strict";i.d(e,{I:function(){return s}});var n=i(39506),r=i(65839);function s(t){t.attributes.add(r.r.POSITION,"vec3"),t.vertex.code.add(n.H`vec3 positionModel() { return position; }`)}},55123:function(t,e,i){"use strict";i.d(e,{s:function(){return c}});var n=i(58766),r=i(82598),s=i(14543),o=i(454),a=i(39506),h=i(65839);const l=8;function c(t,e){const i=t.vertex;i.uniforms.add(new s.m("intrinsicWidth",(t=>t.width))),e.vvSize?(t.attributes.add(h.r.SIZEFEATUREATTRIBUTE,"float"),i.uniforms.add(new r.t("vvSizeMinSize",(t=>t.vvSize.minSize)),new r.t("vvSizeMaxSize",(t=>t.vvSize.maxSize)),new r.t("vvSizeOffset",(t=>t.vvSize.offset)),new r.t("vvSizeFactor",(t=>t.vvSize.factor))),i.code.add(a.H`float getSize() {
return intrinsicWidth * clamp(vvSizeOffset + sizeFeatureAttribute * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).x;
}`)):(t.attributes.add(h.r.SIZE,"float"),i.code.add(a.H`float getSize(){
return intrinsicWidth * size;
}`)),e.vvOpacity?(t.attributes.add(h.r.OPACITYFEATUREATTRIBUTE,"float"),i.constants.add("vvOpacityNumber","int",8),i.uniforms.add(new o.x("vvOpacityValues",(t=>t.vvOpacity.values),l),new o.x("vvOpacityOpacities",(t=>t.vvOpacity.opacityValues),l)),i.code.add(a.H`float interpolateOpacity( float value ){
if (value <= vvOpacityValues[0]) {
return vvOpacityOpacities[0];
}
for (int i = 1; i < vvOpacityNumber; ++i) {
if (vvOpacityValues[i] >= value) {
float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);
return mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f);
}
}
return vvOpacityOpacities[vvOpacityNumber - 1];
}
vec4 applyOpacity( vec4 color ){
return vec4(color.xyz, interpolateOpacity(opacityFeatureAttribute));
}`)):i.code.add(a.H`vec4 applyOpacity( vec4 color ){
return color;
}`),e.vvColor?(t.include(n.A,e),t.attributes.add(h.r.COLORFEATUREATTRIBUTE,"float"),i.code.add(a.H`vec4 getColor(){
return applyOpacity(interpolateVVColor(colorFeatureAttribute));
}`)):(t.attributes.add(h.r.COLOR,"vec4"),i.code.add(a.H`vec4 getColor(){
return applyOpacity(color);
}`))}},2457:function(t,e,i){"use strict";i.d(e,{I:function(){return n},U:function(){return h}});var n,r,s=i(82547),o=i(39506),a=i(65839);function h(t,e){switch(e.textureCoordinateType){case n.Default:return t.attributes.add(a.r.UV0,"vec2"),t.varyings.add("vuv0","vec2"),void t.vertex.code.add(o.H`void forwardTextureCoordinates() {
vuv0 = uv0;
}`);case n.Compressed:return t.attributes.add(a.r.UV0,"vec2"),t.varyings.add("vuv0","vec2"),void t.vertex.code.add(o.H`vec2 getUV0() {
return uv0 / 16384.0;
}
void forwardTextureCoordinates() {
vuv0 = getUV0();
}`);case n.Atlas:return t.attributes.add(a.r.UV0,"vec2"),t.varyings.add("vuv0","vec2"),t.attributes.add(a.r.UVREGION,"vec4"),t.varyings.add("vuvRegion","vec4"),void t.vertex.code.add(o.H`void forwardTextureCoordinates() {
vuv0 = uv0;
vuvRegion = uvRegion;
}`);default:(0,s.Xb)(e.textureCoordinateType);case n.None:return void t.vertex.code.add(o.H`void forwardTextureCoordinates() {}`);case n.COUNT:return}}(r=n||(n={}))[r.None=0]="None",r[r.Default=1]="Default",r[r.Atlas=2]="Atlas",r[r.Compressed=3]="Compressed",r[r.COUNT=4]="COUNT"},85709:function(t,e,i){"use strict";i.d(e,{c:function(){return s}});var n=i(39506),r=i(65839);function s(t,e){e.hasVertexColors?(t.attributes.add(r.r.COLOR,"vec4"),t.varyings.add("vColor","vec4"),t.vertex.code.add(n.H`void forwardVertexColor() { vColor = color; }`),t.vertex.code.add(n.H`void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }`)):t.vertex.code.add(n.H`void forwardVertexColor() {}
void forwardNormalizedVertexColor() {}`)}},94211:function(t,e,i){"use strict";i.d(e,{Mh:function(){return u},Zo:function(){return d},gy:function(){return f}});var n=i(82547),r=i(87725),s=i(41546),o=i(11377),a=i(66299),h=i(39506),l=i(31190),c=i(78567);function u(t,e){switch(e.normalType){case o.W.Attribute:case o.W.Compressed:t.include(o.Y,e),t.varyings.add("vNormalWorld","vec3"),t.varyings.add("vNormalView","vec3"),t.vertex.uniforms.add(new l.h("transformNormalGlobalFromModel",(t=>t.transformNormalGlobalFromModel)),new c.k("transformNormalViewFromGlobal",(t=>t.transformNormalViewFromGlobal))),t.vertex.code.add(h.H`void forwardNormal() {
vNormalWorld = transformNormalGlobalFromModel * normalModel();
vNormalView = transformNormalViewFromGlobal * vNormalWorld;
}`);break;case o.W.ScreenDerivative:t.vertex.code.add(h.H`void forwardNormal() {}`);break;default:(0,n.Xb)(e.normalType);case o.W.COUNT:}}class d extends a.dO{constructor(){super(...arguments),this.transformNormalViewFromGlobal=(0,r.vt)()}}class f extends a.EM{constructor(){super(...arguments),this.transformNormalGlobalFromModel=(0,r.vt)(),this.toMapSpace=(0,s.vt)()}}},66299:function(t,e,i){"use strict";i.d(e,{EM:function(){return v},dO:function(){return g},em:function(){return p}});var n=i(87725),r=i(39714),s=i(32501),o=i(91765),a=i(90576),h=i(4435),l=i(82598),c=i(39506),u=i(31190),d=i(78567),f=i(70340);function p(t,e){t.include(o.I);const i=t.vertex;i.include(a.u,e),t.varyings.add("vPositionWorldCameraRelative","vec3"),t.varyings.add("vPosition_view","vec3"),i.uniforms.add(new l.t("transformWorldFromViewTH",(t=>t.transformWorldFromViewTH)),new l.t("transformWorldFromViewTL",(t=>t.transformWorldFromViewTL)),new d.k("transformViewFromCameraRelativeRS",(t=>t.transformViewFromCameraRelativeRS)),new f.X("transformProjFromView",(t=>t.transformProjFromView)),new u.h("transformWorldFromModelRS",(t=>t.transformWorldFromModelRS)),new h.W("transformWorldFromModelTH",(t=>t.transformWorldFromModelTH)),new h.W("transformWorldFromModelTL",(t=>t.transformWorldFromModelTL))),i.code.add(c.H`vec3 positionWorldCameraRelative() {
vec3 rotatedModelPosition = transformWorldFromModelRS * positionModel();
vec3 transform_CameraRelativeFromModel = dpAdd(
transformWorldFromModelTL,
transformWorldFromModelTH,
-transformWorldFromViewTL,
-transformWorldFromViewTH
);
return transform_CameraRelativeFromModel + rotatedModelPosition;
}`),i.code.add(c.H`
    void forwardPosition(float fOffset) {
      vPositionWorldCameraRelative = positionWorldCameraRelative();
      if (fOffset != 0.0) {
        vPositionWorldCameraRelative += fOffset * ${e.spherical?c.H`normalize(transformWorldFromViewTL + vPositionWorldCameraRelative)`:c.H`vec3(0.0, 0.0, 1.0)`};
      }

      vPosition_view = transformViewFromCameraRelativeRS * vPositionWorldCameraRelative;
      gl_Position = transformProjFromView * vec4(vPosition_view, 1.0);
    }
  `),t.fragment.uniforms.add(new l.t("transformWorldFromViewTL",(t=>t.transformWorldFromViewTL))),i.code.add(c.H`vec3 positionWorld() {
return transformWorldFromViewTL + vPositionWorldCameraRelative;
}`),t.fragment.code.add(c.H`vec3 positionWorld() {
return transformWorldFromViewTL + vPositionWorldCameraRelative;
}`)}class g extends c.Y{constructor(){super(...arguments),this.transformWorldFromViewTH=(0,s.vt)(),this.transformWorldFromViewTL=(0,s.vt)(),this.transformViewFromCameraRelativeRS=(0,n.vt)(),this.transformProjFromView=(0,r.vt)()}}class v extends c.Y{constructor(){super(...arguments),this.transformWorldFromModelRS=(0,n.vt)(),this.transformWorldFromModelTH=(0,s.vt)(),this.transformWorldFromModelTL=(0,s.vt)()}}},28499:function(t,e,i){"use strict";i.d(e,{r:function(){return o}});var n=i(2457),r=i(39506);function s(t){t.fragment.code.add(r.H`vec4 textureAtlasLookup(sampler2D tex, vec2 textureCoordinates, vec4 atlasRegion) {
vec2 atlasScale = atlasRegion.zw - atlasRegion.xy;
vec2 uvAtlas = fract(textureCoordinates) * atlasScale + atlasRegion.xy;
float maxdUV = 0.125;
vec2 dUVdx = clamp(dFdx(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
vec2 dUVdy = clamp(dFdy(textureCoordinates), -maxdUV, maxdUV) * atlasScale;
return textureGrad(tex, uvAtlas, dUVdx, dUVdy);
}`)}function o(t,e){const{textureCoordinateType:i}=e;if(i===n.I.None||i===n.I.COUNT)return;t.include(n.U,e);const o=i===n.I.Atlas;o&&t.include(s),t.fragment.code.add(r.H`
    vec4 textureLookup(sampler2D tex, vec2 uv) {
      return ${o?"textureAtlasLookup(tex, uv, vuvRegion)":"texture(tex, uv)"};
    }
  `)}},74603:function(t,e,i){"use strict";i.d(e,{G:function(){return l},V:function(){return u}});var n=i(33400),r=i(41546),s=i(19202),o=i(20830),a=i(38917),h=i(39506);function l(t,e){const i=t.vertex;e.hasVerticalOffset?(u(i),e.hasScreenSizePerspective&&(t.include(s.Y6),(0,s.OH)(i),(0,o.yu)(t.vertex,e)),i.code.add(h.H`
      vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);
        ${e.spherical?h.H`vec3 worldNormal = normalize(worldPos + localOrigin);`:h.H`vec3 worldNormal = vec3(0.0, 0.0, 1.0);`}
        ${e.hasScreenSizePerspective?h.H`
            float cosAngle = dot(worldNormal, normalize(worldPos - cameraPosition));
            float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);`:h.H`
            float verticalOffsetScreenHeight = verticalOffset.x;`}
        // Screen sized offset in world space, used for example for line callouts
        float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);
        return worldNormal * worldOffset;
      }

      vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {
        return worldPos + calculateVerticalOffset(worldPos, localOrigin);
      }
    `)):i.code.add(h.H`vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }`)}const c=(0,r.vt)();function u(t){t.uniforms.add(new a.E("verticalOffset",((t,e)=>{const{minWorldLength:i,maxWorldLength:r,screenLength:s}=t.verticalOffset,o=Math.tan(.5*e.camera.fovY)/(.5*e.camera.fullViewport[3]),a=e.camera.pixelRatio||1;return(0,n.s)(c,s*a,o,i,r)})))}},10155:function(t,e,i){"use strict";i.d(e,{K:function(){return s}});var n=i(45937),r=i(39506);function s(t){t.uniforms.add(new n.e("alignPixelEnabled",((t,e)=>e.alignPixelEnabled))),t.code.add(r.H`vec4 alignToPixelCenter(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.500123) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = (floor(xy * widthHeight) + vec2(0.5)) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`),t.code.add(r.H`vec4 alignToPixelOrigin(vec4 clipCoord, vec2 widthHeight) {
if (!alignPixelEnabled)
return clipCoord;
vec2 xy = vec2(0.5) + 0.5 * clipCoord.xy / clipCoord.w;
vec2 pixelSz = vec2(1.0) / widthHeight;
vec2 ij = floor((xy + 0.5 * pixelSz) * widthHeight) * pixelSz;
vec2 result = (ij * 2.0 - vec2(1.0)) * clipCoord.w;
return vec4(result, clipCoord.zw);
}`)}},1143:function(t,e,i){"use strict";i.d(e,{Q:function(){return u},R:function(){return c}});var n=i(74603),r=i(19202),s=i(20830),o=i(38917),a=i(14543),h=i(39506),l=i(65839);const c=.5;function u(t,e){t.include(r.Y6),t.attributes.add(l.r.POSITION,"vec3"),t.attributes.add(l.r.NORMAL,"vec3"),t.attributes.add(l.r.CENTEROFFSETANDDISTANCE,"vec4");const i=t.vertex;(0,s.NB)(i,e),(0,s.yu)(i,e),i.uniforms.add(new o.E("viewport",((t,e)=>e.camera.fullViewport)),new a.m("polygonOffset",(t=>t.shaderPolygonOffset)),new a.m("cameraGroundRelative",((t,e)=>e.camera.aboveGround?1:-1))),e.hasVerticalOffset&&(0,n.V)(i),i.constants.add("smallOffsetAngle","float",.984807753012208),i.code.add(h.H`struct ProjectHUDAux {
vec3 posModel;
vec3 posView;
vec3 vnormal;
float distanceToCamera;
float absCosAngle;
};`),i.code.add(h.H`
    float applyHUDViewDependentPolygonOffset(float pointGroundDistance, float absCosAngle, inout vec3 posView) {
      float pointGroundSign = ${e.terrainDepthTest?h.H.float(0):h.H`sign(pointGroundDistance)`};
      if (pointGroundSign == 0.0) {
        pointGroundSign = cameraGroundRelative;
      }

      // cameraGroundRelative is -1 if camera is below ground, 1 if above ground
      // groundRelative is 1 if both camera and symbol are on the same side of the ground, -1 otherwise
      float groundRelative = cameraGroundRelative * pointGroundSign;

      // view angle dependent part of polygon offset emulation: we take the absolute value because the sign that is
      // dropped is instead introduced using the ground-relative position of the symbol and the camera
      if (polygonOffset > .0) {
        float cosAlpha = clamp(absCosAngle, 0.01, 1.0);
        float tanAlpha = sqrt(1.0 - cosAlpha * cosAlpha) / cosAlpha;
        float factor = (1.0 - tanAlpha / viewport[2]);

        // same side of the terrain
        if (groundRelative > 0.0) {
          posView *= factor;
        }
        // opposite sides of the terrain
        else {
          posView /= factor;
        }
      }

      return groundRelative;
    }
  `),e.draped&&!e.hasVerticalOffset||(0,s.S7)(i),e.draped||(i.uniforms.add(new a.m("perDistancePixelRatio",((t,e)=>Math.tan(e.camera.fovY/2)/(e.camera.fullViewport[2]/2)))),i.code.add(h.H`
    void applyHUDVerticalGroundOffset(vec3 normalModel, inout vec3 posModel, inout vec3 posView) {
      float distanceToCamera = length(posView);

      // Compute offset in world units for a half pixel shift
      float pixelOffset = distanceToCamera * perDistancePixelRatio * ${h.H.float(c)};

      // Apply offset along normal in the direction away from the ground surface
      vec3 modelOffset = normalModel * cameraGroundRelative * pixelOffset;

      // Apply the same offset also on the view space position
      vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;

      posModel += modelOffset;
      posView += viewOffset;
    }
  `)),e.screenCenterOffsetUnitsEnabled&&(0,s.Nz)(i),e.hasScreenSizePerspective&&(0,r.OH)(i),i.code.add(h.H`
    vec4 projectPositionHUD(out ProjectHUDAux aux) {
      vec3 centerOffset = centerOffsetAndDistance.xyz;
      float pointGroundDistance = centerOffsetAndDistance.w;

      aux.posModel = position;
      aux.posView = (view * vec4(aux.posModel, 1.0)).xyz;
      aux.vnormal = normal;
      ${e.draped?"":"applyHUDVerticalGroundOffset(aux.vnormal, aux.posModel, aux.posView);"}

      // Screen sized offset in world space, used for example for line callouts
      // Note: keep this implementation in sync with the CPU implementation, see
      //   - MaterialUtil.verticalOffsetAtDistance
      //   - HUDMaterial.applyVerticalOffsetTransformation

      aux.distanceToCamera = length(aux.posView);

      vec3 viewDirObjSpace = normalize(cameraPosition - aux.posModel);
      float cosAngle = dot(aux.vnormal, viewDirObjSpace);

      aux.absCosAngle = abs(cosAngle);

      ${e.hasScreenSizePerspective&&(e.hasVerticalOffset||e.screenCenterOffsetUnitsEnabled)?"vec3 perspectiveFactor = screenSizePerspectiveScaleFactor(aux.absCosAngle, aux.distanceToCamera, screenSizePerspectiveAlignment);":""}

      ${e.hasVerticalOffset?e.hasScreenSizePerspective?"float verticalOffsetScreenHeight = applyScreenSizePerspectiveScaleFactorFloat(verticalOffset.x, perspectiveFactor);":"float verticalOffsetScreenHeight = verticalOffset.x;":""}

      ${e.hasVerticalOffset?h.H`
            float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * aux.distanceToCamera, verticalOffset.z, verticalOffset.w);
            vec3 modelOffset = aux.vnormal * worldOffset;
            aux.posModel += modelOffset;
            vec3 viewOffset = (viewNormal * vec4(modelOffset, 1.0)).xyz;
            aux.posView += viewOffset;
            // Since we elevate the object, we need to take that into account
            // in the distance to ground
            pointGroundDistance += worldOffset;`:""}

      float groundRelative = applyHUDViewDependentPolygonOffset(pointGroundDistance, aux.absCosAngle, aux.posView);

      ${e.screenCenterOffsetUnitsEnabled?"":h.H`
            // Apply x/y in view space, but z in screen space (i.e. along posView direction)
            aux.posView += vec3(centerOffset.x, centerOffset.y, 0.0);

            // Same material all have same z != 0.0 condition so should not lead to
            // branch fragmentation and will save a normalization if it's not needed
            if (centerOffset.z != 0.0) {
              aux.posView -= normalize(aux.posView) * centerOffset.z;
            }
          `}

      vec4 posProj = proj * vec4(aux.posView, 1.0);

      ${e.screenCenterOffsetUnitsEnabled?e.hasScreenSizePerspective?"float centerOffsetY = applyScreenSizePerspectiveScaleFactorFloat(centerOffset.y, perspectiveFactor);":"float centerOffsetY = centerOffset.y;":""}

      ${e.screenCenterOffsetUnitsEnabled?"posProj.xy += vec2(centerOffset.x, centerOffsetY) * pixelRatio * 2.0 / viewport.zw * posProj.w;":""}

      // constant part of polygon offset emulation
      posProj.z -= groundRelative * polygonOffset * posProj.w;
      return posProj;
    }
  `)}},50399:function(t,e,i){"use strict";i.d(e,{I:function(){return o}});var n=i(10155),r=i(77771),s=i(39506);function o(t,e){const{vertex:i,fragment:o}=t;t.include(r.Z,e),i.include(n.K),e.terrainDepthTest&&t.varyings.add("depth","float"),i.main.add(s.H`
    vec4 posProjCenter;
    if (dot(position, position) > 0.0) {
      // Render single point to center of the pixel to avoid subpixel filtering to affect the marker color
      ProjectHUDAux projectAux;
      vec4 posProj = projectPositionHUD(projectAux);
      posProjCenter = alignToPixelCenter(posProj, viewport.zw);

      ${e.terrainDepthTest?s.H`depth = projectAux.posView.z;`:""}
      vec3 vpos = projectAux.posModel;
      if (rejectBySlice(vpos)) {
        // Project out of clip space
        posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
      }

    } else {
      // Project out of clip space
      posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);
    }

    gl_Position = posProjCenter;
    gl_PointSize = 1.0;
  `),o.main.add(s.H`fragColor = vec4(1);
if(terrainDepthTest(depth)) {
fragColor.g = 0.5;
}`)}},60808:function(t,e,i){"use strict";var n;i.d(e,{D:function(){return n}}),function(t){t[t.Occluded=0]="Occluded",t[t.NotOccluded=1]="NotOccluded",t[t.Both=2]="Both",t[t.COUNT=3]="COUNT"}(n||(n={}))},80231:function(t,e,i){"use strict";i.d(e,{y:function(){return l}});var n=i(10155),r=i(60808),s=i(38917),o=i(14543),a=i(39506),h=i(39838);function l(t){t.vertex.uniforms.add(new o.m("renderTransparentlyOccludedHUD",((t,e)=>e.hudRenderStyle===r.D.Occluded?1:e.hudRenderStyle===r.D.NotOccluded?0:.75)),new s.E("viewport",((t,e)=>e.camera.fullViewport)),new h.N("hudVisibilityTexture",((t,e)=>e.hudVisibility?.getTexture()))),t.vertex.include(n.K),t.vertex.code.add(a.H`bool testHUDVisibility(vec4 posProj) {
vec4 posProjCenter = alignToPixelCenter(posProj, viewport.zw);
vec4 occlusionPixel = texture(hudVisibilityTexture, .5 + .5 * posProjCenter.xy / posProjCenter.w);
if (renderTransparentlyOccludedHUD > 0.5) {
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g * renderTransparentlyOccludedHUD < 1.0;
}
return occlusionPixel.r * occlusionPixel.g > 0.0 && occlusionPixel.g == 1.0;
}`)}},38130:function(t,e,i){"use strict";i.d(e,{NL:function(){return f},ZX:function(){return n}});var n,r,s=i(27264),o=i(28499),a=i(4435),h=i(82598),l=i(39506),c=i(40075),u=i(39838),d=i(54516);function f(t,e){if(!(0,s.RN)(e.output))return;const{emissionSource:i,hasEmissiveTextureTransform:r,bindType:f}=e,p=i===n.Texture;p&&(t.include(o.r,e),t.fragment.uniforms.add(f===d.c.Pass?new u.N("texEmission",(t=>t.textureEmissive)):new c.o("texEmission",(t=>t.textureEmissive))));const g=i===n.Value||p;g&&t.fragment.uniforms.add(f===d.c.Pass?new h.t("emissionFactor",(t=>t.emissiveFactor)):new a.W("emissionFactor",(t=>t.emissiveFactor))),t.fragment.code.add(l.H`
    vec4 getEmissions() {
      vec4 emissions = ${g?"vec4(emissionFactor, 1.0)":"vec4(0.0)"};
      ${(0,l.If)(p,`emissions *= textureLookup(texEmission, ${r?"emissiveUV":"vuv0"});\n         emissions.w = emissions.rgb == vec3(0.0) ? 0.0: emissions.w;`)};
      return emissions;
    }
  `)}i(36634),(r=n||(n={}))[r.None=0]="None",r[r.Value=1]="Value",r[r.Texture=2]="Texture",r[r.COUNT=3]="COUNT"},84435:function(t,e,i){"use strict";i.d(e,{Q:function(){return h}});var n=i(27264),r=i(12511),s=i(50295),o=i(39506),a=i(39838);function h(t,e){const{fragment:i}=t;e.output===n.V.Highlight?(i.uniforms.add(new a.N("depthTexture",((t,e)=>e.mainDepth)),new a.N("highlightTexture",((t,e)=>e.highlightMixTexture)),new s.c("highlightLevel",((t,e)=>e.highlightLevel)),new r.g("highlightMixOrigin",((t,e)=>e.highlightMixOrigin))),t.outputs.add("fragHighlight","vec2",0),i.code.add(o.H`vec2 getAccumulatedHighlight() {
return texelFetch(highlightTexture, ivec2(gl_FragCoord.xy) - highlightMixOrigin, 0).rg;
}
void outputHighlight(bool occluded) {
if (highlightLevel == 0) {
uint bits = occluded ? 3u : 1u;
fragHighlight = vec2(float(bits) / 255.0, 0.0);
} else {
int ll = (highlightLevel & 3) << 1;
int li = (highlightLevel >> 2) & 3;
uint bits;
if (occluded) {
bits = 3u << ll;
} else {
bits = 1u << ll;
}
vec2 combinedHighlight = getAccumulatedHighlight();
uint accumulatedI = uint(combinedHighlight[li] * 255.0);
combinedHighlight[li] = float(bits | accumulatedI) / 255.0;
fragHighlight = combinedHighlight;
}
}
bool isHighlightOccluded() {
float sceneDepth = texelFetch(depthTexture, ivec2(gl_FragCoord.xy), 0).x;
return gl_FragCoord.z > sceneDepth + 5e-7;
}
void calculateOcclusionAndOutputHighlight() {
outputHighlight(isHighlightOccluded());
}`),e.canHaveOverlay&&(i.constants.add("occlusionAndMask","int",85),i.code.add(o.H`void outputAllHighlights(vec2 highlightToAdd) {
if (highlightToAdd == vec2(0.0)) { discard; }
int occludedOrMask = isHighlightOccluded() ? 0xaa : 0;
ivec2 added = ivec2(highlightToAdd * 255.0);
ivec2 masked = (added & ivec2(occlusionAndMask)) | (ivec2(occludedOrMask) & (added<<1));
fragHighlight = vec2(masked) / 255.0;
}`))):i.code.add(o.H`void calculateOcclusionAndOutputHighlight() {}`)}},23397:function(t,e,i){"use strict";i.d(e,{E:function(){return a}});var n=i(13786),r=i(1932),s=i(11687),o=i(39506);function a(t){t.uniforms.add(new s.G("zProjectionMap",((t,e)=>function(t){const e=t.projectionMatrix;return(0,n.hZ)(h,e[14],e[10])}(e.camera)))),t.code.add(o.H`float linearizeDepth(float depth) {
float depthNdc = depth * 2.0 - 1.0;
float c1 = zProjectionMap[0];
float c2 = zProjectionMap[1];
return -(c1 / (depthNdc + c2 + 1e-7));
}`),t.code.add(o.H`float depthFromTexture(sampler2D depthTexture, vec2 uv) {
ivec2 iuv = ivec2(uv * vec2(textureSize(depthTexture, 0)));
float depth = texelFetch(depthTexture, iuv, 0).r;
return depth;
}`),t.code.add(o.H`float linearDepthFromTexture(sampler2D depthTexture, vec2 uv) {
return linearizeDepth(depthFromTexture(depthTexture, uv));
}`)}const h=(0,r.vt)()},2120:function(t,e,i){"use strict";i.d(e,{v:function(){return s},z:function(){return r}});var n=i(39506);function r(t){t.fragment.code.add(n.H`float normals2FoamIntensity(vec3 n, float waveStrength){
float normalizationFactor =  max(0.015, waveStrength);
return max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);
}`)}function s(t){t.fragment.code.add(n.H`vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){
return foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;
}`)}},31166:function(t,e,i){"use strict";i.d(e,{q:function(){return p},h:function(){return g}});var n=i(52766),r=i(20830),s=i(38917),o=i(14543),a=i(39506),h=i(39838);function l(t){return t.pattern.map((e=>Math.round(e*t.pixelRatio)))}function c(t){return l(t).reduce(((t,e)=>Math.max(t,e)))}i(5161),i(85456),i(12285),i(10956);var u=i(33400),d=i(41546);const f=(0,d.vt)();function p(t,e){e.stippleEnabled?function(t,e){const i=!(e.draped&&e.stipplePreferContinuous),{vertex:l,fragment:p}=t;p.include(n.W),e.draped||((0,r.yu)(l,e),l.uniforms.add(new o.m("worldToScreenPerDistanceRatio",((t,e)=>1/e.camera.perScreenPixelRatio))),l.code.add(a.H`float computeWorldToScreenRatio(vec3 segmentCenter) {
float segmentDistanceToCamera = length(segmentCenter - cameraPosition);
return worldToScreenPerDistanceRatio / segmentDistanceToCamera;
}`)),t.varyings.add("vStippleDistance","float"),t.varyings.add("vStippleDistanceLimits","vec2"),t.varyings.add("vStipplePatternStretch","float"),l.code.add(a.H`
    float discretizeWorldToScreenRatio(float worldToScreenRatio) {
      float step = ${v};

      float discreteWorldToScreenRatio = log(worldToScreenRatio);
      discreteWorldToScreenRatio = ceil(discreteWorldToScreenRatio / step) * step;
      discreteWorldToScreenRatio = exp(discreteWorldToScreenRatio);
      return discreteWorldToScreenRatio;
    }
  `),l.code.add(a.H`vec2 computeStippleDistanceLimits(float startPseudoScreen, float segmentLengthPseudoScreen, float segmentLengthScreen, float patternLength) {`),l.code.add(a.H`
    if (segmentLengthPseudoScreen >= ${i?"patternLength":"1e4"}) {
  `),(0,r.Nz)(l),l.code.add(a.H`float repetitions = segmentLengthScreen / (patternLength * pixelRatio);
float flooredRepetitions = max(1.0, floor(repetitions + 0.5));
float segmentLengthScreenRounded = flooredRepetitions * patternLength;
float stretch = repetitions / flooredRepetitions;
vStipplePatternStretch = max(0.75, stretch);
return vec2(0.0, segmentLengthScreenRounded);
}
return vec2(startPseudoScreen, startPseudoScreen + segmentLengthPseudoScreen);
}`),p.uniforms.add(new h.N("stipplePatternTexture",(t=>t.stippleTexture)),new o.m("stipplePatternSDFNormalizer",(t=>function(t){return t?(Math.floor(.5*(c(t)-1))+.5)/t.pixelRatio:1}(t.stipplePattern))),new o.m("stipplePatternPixelSizeInv",(t=>1/g(t)))),p.code.add(a.H`float getStippleSDF(out bool isClamped) {
float stippleDistanceClamped = clamp(vStippleDistance, vStippleDistanceLimits.x, vStippleDistanceLimits.y);
vec2 aaCorrectedLimits = vStippleDistanceLimits + vec2(1.0, -1.0) / gl_FragCoord.w;
isClamped = vStippleDistance < aaCorrectedLimits.x || vStippleDistance > aaCorrectedLimits.y;
float u = stippleDistanceClamped * gl_FragCoord.w * stipplePatternPixelSizeInv * vLineSizeInv;
u = fract(u);
float encodedSDF = rgba2float(texture(stipplePatternTexture, vec2(u, 0.5)));
float sdf = (encodedSDF * 2.0 - 1.0) * stipplePatternSDFNormalizer;
return (sdf - 0.5) * vStipplePatternStretch + 0.5;
}
float getStippleSDF() {
bool ignored;
return getStippleSDF(ignored);
}
float getStippleAlpha() {
bool isClamped;
float stippleSDF = getStippleSDF(isClamped);
float antiAliasedResult = clamp(stippleSDF * vLineWidth + 0.5, 0.0, 1.0);
return isClamped ? floor(antiAliasedResult + 0.5) : antiAliasedResult;
}`),e.stippleOffColorEnabled?(p.uniforms.add(new s.E("stippleOffColor",(t=>function(t){return null==t?d.uY:4===t.length?t:(0,u.s)(f,t[0],t[1],t[2],1)}(t.stippleOffColor)))),p.code.add(a.H`#define discardByStippleAlpha(stippleAlpha, threshold) {}
#define blendStipple(color, stippleAlpha) mix(color, stippleOffColor, stippleAlpha)`)):p.code.add(a.H`#define discardByStippleAlpha(stippleAlpha, threshold) if (stippleAlpha < threshold) { discard; }
#define blendStipple(color, stippleAlpha) vec4(color.rgb, color.a * stippleAlpha)`)}(t,e):function(t){t.fragment.code.add(a.H`float getStippleAlpha() { return 1.0; }
#define discardByStippleAlpha(_stippleAlpha_, _threshold_) {}
#define blendStipple(color, _stippleAlpha_) color`)}(t)}function g(t){const e=t.stipplePattern;return e?function(t){if(null==t)return 1;const e=l(t);return Math.floor(e.reduce(((t,e)=>t+e)))}(t.stipplePattern)/e.pixelRatio:1}const v=a.H.float(.4)},42426:function(t,e,i){"use strict";i.d(e,{Gc:function(){return s},O4:function(){return o},Vt:function(){return a}});var n=i(82598),r=i(39506);function s(t){t.uniforms.add(new n.t("mainLightDirection",((t,e)=>e.lighting.mainLight.direction)))}function o(t){t.uniforms.add(new n.t("mainLightIntensity",((t,e)=>e.lighting.mainLight.intensity)))}function a(t){s(t.fragment),o(t.fragment),t.fragment.code.add(r.H`vec3 applyShading(vec3 shadingNormalWorld, float shadow) {
float dotVal = clamp(dot(shadingNormalWorld, mainLightDirection), 0.0, 1.0);
return mainLightIntensity * ((1.0 - shadow) * dotVal);
}`)}},91981:function(t,e,i){"use strict";i.d(e,{r:function(){return h}});var n=i(33710),r=i(20830),s=i(14543),o=i(39506),a=i(50678);function h(t,e){const i=t.vertex;(0,r.Nz)(i),null==i.uniforms.get("markerScale")&&i.constants.add("markerScale","float",1),i.constants.add("markerSizePerLineWidth","float",n.PV).code.add(o.H`float getLineWidth() {
return max(getSize(), 1.0) * pixelRatio;
}
float getScreenMarkerSize() {
return markerSizePerLineWidth * markerScale * getLineWidth();
}`),e.space===a.lM.World&&(i.constants.add("maxSegmentLengthFraction","float",.45),i.uniforms.add(new s.m("perRenderPixelRatio",((t,e)=>e.camera.perRenderPixelRatio))),i.code.add(o.H`bool areWorldMarkersHidden(vec4 pos, vec4 other) {
vec3 midPoint = mix(pos.xyz, other.xyz, 0.5);
float distanceToCamera = length(midPoint);
float screenToWorldRatio = perRenderPixelRatio * distanceToCamera * 0.5;
float worldMarkerSize = getScreenMarkerSize() * screenToWorldRatio;
float segmentLen = length(pos.xyz - other.xyz);
return worldMarkerSize > maxSegmentLengthFraction * segmentLen;
}
float getWorldMarkerSize(vec4 pos) {
float distanceToCamera = length(pos.xyz);
float screenToWorldRatio = perRenderPixelRatio * distanceToCamera * 0.5;
return getScreenMarkerSize() * screenToWorldRatio;
}`))}},51942:function(t,e,i){"use strict";i.d(e,{c:function(){return a},f:function(){return h}});var n=i(39506);function r(t){const e=t.fragment.code;e.add(n.H`vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)
{
return ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;
}`),e.add(n.H`float integratedRadiance(float cosTheta2, float roughness)
{
return (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);
}`),e.add(n.H`vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)
{
float cosTheta2 = 1.0 - RdotNG * RdotNG;
float intRadTheta = integratedRadiance(cosTheta2, roughness);
float ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;
float sky = 2.0 - ground;
return (ground * ambientGround + sky * ambientSky) * 0.5;
}`)}var s=i(11520),o=i(61629);function a(t,e){const i=t.fragment.code;t.include(o.p),e.pbrMode!==s.A9.Normal&&e.pbrMode!==s.A9.Schematic&&e.pbrMode!==s.A9.Simplified&&e.pbrMode!==s.A9.TerrainWithWater||(i.add(n.H`float normalDistribution(float NdotH, float roughness)
{
float a = NdotH * roughness;
float b = roughness / (1.0 - NdotH * NdotH + a * a);
return b * b * INV_PI;
}`),i.add(n.H`const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);
const vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);
const vec2 c2 = vec2(-1.04, 1.04);
vec2 prefilteredDFGAnalytical(float roughness, float NdotV) {
vec4 r = roughness * c0 + c1;
float a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;
return c2 * a004 + r.zw;
}`)),e.pbrMode!==s.A9.Normal&&e.pbrMode!==s.A9.Schematic||(t.include(r),i.add(n.H`struct PBRShadingInfo
{
float NdotV;
float LdotH;
float NdotNG;
float RdotNG;
float NdotAmbDir;
float NdotH_Horizon;
vec3 skyRadianceToSurface;
vec3 groundRadianceToSurface;
vec3 skyIrradianceToSurface;
vec3 groundIrradianceToSurface;
float averageAmbientRadiance;
float ssao;
vec3 albedoLinear;
vec3 f0;
vec3 f90;
vec3 diffuseColor;
float metalness;
float roughness;
};`),i.add(n.H`vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {
vec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);
vec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);
vec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;
vec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);
vec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;
vec3 specularComponent = specularColor * indirectSpecular;
return (diffuseComponent + specularComponent);
}`),i.add(n.H`float gamutMapChanel(float x, vec2 p){
return (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );
}`),i.add(n.H`vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){
vec3 outColor;
vec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));
outColor.x = gamutMapChanel(inColor.x, p) ;
outColor.y = gamutMapChanel(inColor.y, p) ;
outColor.z = gamutMapChanel(inColor.z, p) ;
return outColor;
}`))}function h(t,e){const i=t.fragment.code;t.include(o.p),i.add(n.H`
  struct PBRShadingWater
  {
      float NdotL;   // cos angle between normal and light direction
      float NdotV;   // cos angle between normal and view direction
      float NdotH;   // cos angle between normal and half vector
      float VdotH;   // cos angle between view direction and half vector
      float LdotH;   // cos angle between light direction and half vector
      float VdotN;   // cos angle between view direction and normal vector
  };

  float dtrExponent = ${e.useCustomDTRExponentForWater?"2.2":"2.0"};
  `),i.add(n.H`vec3 fresnelReflection(float angle, vec3 f0, float f90) {
return f0 + (f90 - f0) * pow(1.0 - angle, 5.0);
}`),i.add(n.H`float normalDistributionWater(float NdotH, float roughness)
{
float r2 = roughness * roughness;
float NdotH2 = NdotH * NdotH;
float denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;
return r2 / denom;
}`),i.add(n.H`float geometricOcclusionKelemen(float LoH)
{
return 0.25 / (LoH * LoH);
}`),i.add(n.H`vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)
{
vec3  F = fresnelReflection(props.VdotH, F0, F0Max);
float dSun = normalDistributionWater(props.NdotH, roughness);
float V = geometricOcclusionKelemen(props.LdotH);
float diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);
float strengthSunHaze  = 1.2;
float dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze) * strengthSunHaze;
return ((dSun + dSunHaze) * V) * F;
}`)}},11520:function(t,e,i){"use strict";i.d(e,{A9:function(){return n},_Z:function(){return f}});var n,r,s=i(28499),o=i(4435),a=i(82598),h=i(39506),l=i(40075),c=i(39838),u=i(54516),d=i(36634);function f(t,e){const i=e.pbrMode,r=t.fragment;if(i!==n.Schematic&&i!==n.Disabled&&i!==n.Normal)return void r.code.add(h.H`void applyPBRFactors() {}`);if(i===n.Disabled)return void r.code.add(h.H`void applyPBRFactors() {}
float getBakedOcclusion() { return 1.0; }`);if(i===n.Schematic)return void r.code.add(h.H`vec3 mrr = vec3(0.0, 0.6, 0.2);
float occlusion = 1.0;
void applyPBRFactors() {}
float getBakedOcclusion() { return 1.0; }`);const{hasMetallicRoughnessTexture:d,hasMetallicRoughnessTextureTransform:f,hasOcclusionTexture:p,hasOcclusionTextureTransform:g,bindType:v}=e;(d||p)&&t.include(s.r,e),r.code.add(h.H`vec3 mrr;
float occlusion;`),d&&r.uniforms.add(v===u.c.Pass?new c.N("texMetallicRoughness",(t=>t.textureMetallicRoughness)):new l.o("texMetallicRoughness",(t=>t.textureMetallicRoughness))),p&&r.uniforms.add(v===u.c.Pass?new c.N("texOcclusion",(t=>t.textureOcclusion)):new l.o("texOcclusion",(t=>t.textureOcclusion))),r.uniforms.add(v===u.c.Pass?new a.t("mrrFactors",(t=>t.mrrFactors)):new o.W("mrrFactors",(t=>t.mrrFactors))),r.code.add(h.H`
    ${(0,h.If)(d,h.H`void applyMetallicRoughness(vec2 uv) {
            vec3 metallicRoughness = textureLookup(texMetallicRoughness, uv).rgb;
            mrr[0] *= metallicRoughness.b;
            mrr[1] *= metallicRoughness.g;
          }`)}

    ${(0,h.If)(p,"void applyOcclusion(vec2 uv) { occlusion *= textureLookup(texOcclusion, uv).r; }")}

    float getBakedOcclusion() {
      return ${p?"occlusion":"1.0"};
    }

    void applyPBRFactors() {
      mrr = mrrFactors;
      occlusion = 1.0;

      ${(0,h.If)(d,`applyMetallicRoughness(${f?"metallicRoughnessUV":"vuv0"});`)}
      ${(0,h.If)(p,`applyOcclusion(${g?"occlusionUV":"vuv0"});`)}
    }
  `)}i(27539),(r=n||(n={}))[r.Disabled=0]="Disabled",r[r.Normal=1]="Normal",r[r.Schematic=2]="Schematic",r[r.Water=3]="Water",r[r.WaterOnIntegratedMesh=4]="WaterOnIntegratedMesh",r[r.Simplified=5]="Simplified",r[r.TerrainWithWater=6]="TerrainWithWater",r[r.COUNT=7]="COUNT",d.NV},61629:function(t,e,i){"use strict";function n(t){const e=3.141592653589793,i=.3183098861837907;t.vertex.constants.add("PI","float",e),t.fragment.constants.add("PI","float",e),t.fragment.constants.add("LIGHT_NORMALIZATION","float",i),t.fragment.constants.add("INV_PI","float",i),t.fragment.constants.add("HALF_PI","float",1.570796326794897),t.fragment.constants.add("TWO_PI","float",6.28318530717958)}i.d(e,{p:function(){return n}})},3088:function(t,e,i){"use strict";i.d(e,{O:function(){return n},b:function(){return r}});const n=3e5,r=5e5},77771:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}});var n=i(23397),r=i(39506),s=i(39838);function o(t,{occlusionPass:e,terrainDepthTest:i,cullAboveTerrain:o}){i?(t.fragment.include(n.E),t.fragment.uniforms.add(new s.N("terrainDepthTexture",((t,e)=>e.terrainDepth?.attachment))).code.add(r.H`
   ${e?"bool":"void"} terrainDepthTest(float fragmentDepth) {
      float depth = texelFetch(terrainDepthTexture, ivec2(gl_FragCoord.xy), 0).r;
      float linearDepth = linearizeDepth(depth);
      ${e?r.H`return fragmentDepth < linearDepth && depth < 1.0;`:r.H`if(fragmentDepth ${o?">":"<="} linearDepth) discard;`}
    }`)):e?t.fragment.code.add(r.H`#define terrainDepthTest(fragmentDepth) false`):t.fragment.code.add(r.H`#define terrainDepthTest(fragmentDepth) {}`)}},58766:function(t,e,i){"use strict";i.d(e,{A:function(){return c}});var n=i(82598),r=i(30636),s=i(454),o=i(39506),a=i(78567),h=i(65839),l=i(77971);function c(t,e){const{vertex:i,attributes:c}=t;e.hasVvInstancing&&(e.vvSize||e.vvColor)&&c.add(h.r.INSTANCEFEATUREATTRIBUTE,"vec4"),e.vvSize?(i.uniforms.add(new n.t("vvSizeMinSize",(t=>t.vvSize.minSize))),i.uniforms.add(new n.t("vvSizeMaxSize",(t=>t.vvSize.maxSize))),i.uniforms.add(new n.t("vvSizeOffset",(t=>t.vvSize.offset))),i.uniforms.add(new n.t("vvSizeFactor",(t=>t.vvSize.factor))),i.uniforms.add(new a.k("vvSymbolRotationMatrix",(t=>t.vvSymbolRotationMatrix))),i.uniforms.add(new n.t("vvSymbolAnchor",(t=>t.vvSymbolAnchor))),i.code.add(o.H`vec3 vvScale(vec4 _featureAttribute) {
return clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);
}
vec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {
return vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);
}`),i.code.add(o.H`
      const float eps = 1.192092896e-07;
      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {
        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);
        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);
      }

      ${e.hasVvInstancing?o.H`
      vec4 vvLocalNormal(vec3 _normal) {
        return vvTransformNormal(_normal, instanceFeatureAttribute);
      }

      vec4 localPosition() {
        return vvTransformPosition(position, instanceFeatureAttribute);
      }`:""}
    `)):i.code.add(o.H`vec4 localPosition() { return vec4(position, 1.0); }
vec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }`),e.vvColor?(i.constants.add("vvColorNumber","int",l.p),i.uniforms.add(new s.x("vvColorValues",(t=>t.vvColor.values),l.p),new r.F("vvColorColors",(t=>t.vvColor.colors),l.p)),i.code.add(o.H`
      vec4 interpolateVVColor(float value) {
        if (value <= vvColorValues[0]) {
          return vvColorColors[0];
        }

        for (int i = 1; i < vvColorNumber; ++i) {
          if (vvColorValues[i] >= value) {
            float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);
            return mix(vvColorColors[i-1], vvColorColors[i], f);
          }
        }
        return vvColorColors[vvColorNumber - 1];
      }

      vec4 vvGetColor(vec4 featureAttribute) {
        return interpolateVVColor(featureAttribute.y);
      }

      ${e.hasVvInstancing?o.H`
            vec4 vvColor() {
              return vvGetColor(instanceFeatureAttribute);
            }`:"vec4 vvColor() { return vec4(1.0); }"}
    `)):i.code.add(o.H`vec4 vvColor() { return vec4(1.0); }`)}},5830:function(t,e,i){"use strict";i.d(e,{E:function(){return C}});var n=i(2120),r=i(39506);function s(t){t.fragment.code.add(r.H`const float GAMMA = 2.2;
const float INV_GAMMA = 0.4545454545;
vec4 delinearizeGamma(vec4 color) {
return vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);
}
vec3 linearizeGamma(vec3 color) {
return pow(color, vec3(GAMMA));
}`)}var o=i(51942),a=i(3088),h=i(23397),l=i(11687),c=i(14543),u=i(70340),d=i(39838);function f(t,e){if(!e.screenSpaceReflections)return;const i=t.fragment;i.include(h.E),i.uniforms.add(new l.G("nearFar",((t,e)=>e.camera.nearFar)),new d.N("depthMap",((t,e)=>e.depth?.attachment)),new u.X("proj",((t,e)=>e.camera.projectionMatrix)),new c.m("invResolutionHeight",((t,e)=>1/e.camera.height)),new u.X("reprojectionMatrix",((t,e)=>e.ssr.reprojectionMatrix))).code.add(r.H`
  vec2 reprojectionCoordinate(vec3 projectionCoordinate)
  {
    vec4 zw = proj * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);
    vec4 reprojectedCoord = reprojectionMatrix * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);
    reprojectedCoord.xy /= reprojectedCoord.w;
    return reprojectedCoord.xy * 0.5 + 0.5;
  }

  const int maxSteps = ${e.highStepCount?"150":"75"};

  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)
  {
    vec4 projectedCoord =  projectionMat * vec4(x, 1.0);
    projectedCoord.xy /= projectedCoord.w;
    projectedCoord.xy = projectedCoord.xy*0.5 + 0.5;
    return projectedCoord;
  }

  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)
  {
    vec3 viewPos = startPosition;
    vec3 viewPosEnd = startPosition;

    // Project the start position to the screen
    vec4 projectedCoordStart = applyProjectionMat(proj, viewPos);
    vec3  Q0 = viewPos / projectedCoordStart.w; // homogeneous camera space
    float k0 = 1.0/ projectedCoordStart.w;

    // advance the position in the direction of the reflection
    viewPos += dir;

    vec4 projectedCoordVanishingPoint = applyProjectionMat(proj, dir);

    // Project the advanced position to the screen
    vec4 projectedCoordEnd = applyProjectionMat(proj, viewPos);
    vec3  Q1 = viewPos / projectedCoordEnd.w; // homogeneous camera space
    float k1 = 1.0/ projectedCoordEnd.w;

    // calculate the reflection direction in the screen space
    vec2 projectedCoordDir = (projectedCoordEnd.xy - projectedCoordStart.xy);
    vec2 projectedCoordDistVanishingPoint = (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);

    float yMod = min(abs(projectedCoordDistVanishingPoint.y), 1.0);

    float projectedCoordDirLength = length(projectedCoordDir);
    float maxSt = float(maxSteps);

    // normalize the projection direction depending on maximum steps
    // this determines how blocky the reflection looks
    vec2 dP = yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);

    // Normalize the homogeneous camera space coordinates
    vec3  dQ = yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);
    float dk = yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);

    // initialize the variables for ray marching
    vec2 P = projectedCoordStart.xy;
    vec3 Q = Q0;
    float k = k0;
    float rayStartZ = -startPosition.z; // estimated ray start depth value
    float rayEndZ = -startPosition.z;   // estimated ray end depth value
    float prevEstimateZ = -startPosition.z;
    float rayDiffZ = 0.0;
    float dDepth;
    float depth;
    float rayDiffZOld = 0.0;

    // early outs
    if (dot(normal, dir) < 0.0 || dot(-viewDir, normal) < 0.0)
      return vec3(P, 0.0);

    for(int i = 0; i < maxSteps-1; i++)
    {
      depth = -linearDepthFromTexture(depthMap, P); // get linear depth from the depth buffer

      // estimate depth of the marching ray
      rayStartZ = prevEstimateZ;
      dDepth = -rayStartZ - depth;
      rayEndZ = (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));
      rayDiffZ = rayEndZ- rayStartZ;
      prevEstimateZ = rayEndZ;

      if(-rayEndZ > nearFar[1] || -rayEndZ < nearFar[0] || P.y < 0.0  || P.y > 1.0 )
      {
        return vec3(P, 0.);
      }

      // If we detect a hit - return the intersection point, two conditions:
      //  - dDepth > 0.0 - sampled point depth is in front of estimated depth
      //  - if difference between dDepth and rayDiffZOld is not too large
      //  - if difference between dDepth and 0.025/abs(k) is not too large
      //  - if the sampled depth is not behind far plane or in front of near plane

      if((dDepth) < 0.025/abs(k) + abs(rayDiffZ) && dDepth > 0.0 && depth > nearFar[0] && depth < nearFar[1] && abs(P.y - projectedCoordStart.y) > invResolutionHeight)
      {
        return vec3(P, depth);
      }

      // continue with ray marching
      P = clamp(P + dP, vec2(0.0), vec2(0.999));
      Q.z += dQ.z;
      k += dk;
      rayDiffZOld = rayDiffZ;
    }
    return vec3(P, 0.0);
  }
  `)}var p=i(32501),g=i(43587),v=i(1616),m=i(75256),y=i(58192),_=i(42426),b=i(45937),w=i(82598),x=i(65312),T=i(54516);class A extends x.n{constructor(t,e){super(t,"samplerCube",T.c.Pass,((i,n,r)=>i.bindTexture(t,e(n,r))))}}function M(t){const e=t.fragment;e.constants.add("radiusCloudsSquared","float",S).code.add(r.H`vec3 intersectWithCloudLayer(vec3 dir, vec3 cameraPosition, vec3 spherePos) {
float B = 2.0 * dot(cameraPosition, dir);
float C = dot(cameraPosition, cameraPosition) - radiusCloudsSquared;
float det = B * B - 4.0 * C;
float pointIntDist = max(0.0, 0.5 *(-B + sqrt(det)));
return (cameraPosition + dir * pointIntDist) - spherePos;
}`),e.uniforms.add(new c.m("radiusCurvatureCorrection",((t,e)=>e.clouds.parallax.radiusCurvatureCorrection))).code.add(r.H`vec3 correctForPlanetCurvature(vec3 dir) {
dir.z = dir.z * (1.0 - radiusCurvatureCorrection) + radiusCurvatureCorrection;
return dir;
}`),e.code.add(r.H`vec3 rotateDirectionToAnchorPoint(mat4 rotMat, vec3 inVec) {
return (rotMat * vec4(inVec, 0.0)).xyz;
}`),(0,_.Gc)(e),(0,_.O4)(e);const i=(0,p.fA)(.28,.175,.035);e.constants.add("RIM_COLOR","vec3",i),e.code.add(r.H`
    vec3 calculateCloudColor(vec3 cameraPosition, vec3 worldSpaceRay, vec4 clouds) {
      float upDotLight = dot(cameraPosition, mainLightDirection);
      float dirDotLight = max(dot(worldSpaceRay, mainLightDirection), 0.0);
      float sunsetTransition = clamp(pow(max(upDotLight, 0.0), ${r.H.float(.3)}), 0.0, 1.0);

      // Base color of the clouds that depends on lighting of the sun and sky
      vec3 ambientLight = calculateAmbientIrradiance(cameraPosition,  0.0);
      vec3 combinedLight = clamp((mainLightIntensity + ambientLight )/PI, vec3(0.0), vec3(1.0));
      vec3 baseCloudColor = pow(combinedLight * pow(clouds.xyz, vec3(GAMMA)), vec3(INV_GAMMA));

      // Rim light around the edge of the clouds simulating scattering of the direct lun light
      float scatteringMod = max(clouds.a < 0.5 ? clouds.a / 0.5 : - clouds.a / 0.5 + 2.0, 0.0);
      float rimLightIntensity = 0.5 + 0.5 * pow(max(upDotLight, 0.0), 0.35);
      vec3 directSunScattering = RIM_COLOR * rimLightIntensity * (pow(dirDotLight, ${r.H.float(140)})) * scatteringMod;

      // Brighten the clouds around the sun at the sunsets
      float additionalLight = ${r.H.float(.2)} * pow(dirDotLight, ${r.H.float(10)}) * (1. - pow(sunsetTransition, ${r.H.float(.3)})) ;

      return vec3(baseCloudColor * (1.0 + additionalLight) + directSunScattering);
    }
  `),e.uniforms.add(new b.e("readChannelsRG",((t,e)=>e.clouds.readChannels===v.c.RG)),new A("cubeMap",((t,e)=>e.clouds.data?.cubeMap?.colorTexture??null))).code.add(r.H`vec4 sampleCloud(vec3 rayDir, bool readOtherChannel) {
vec4 s = texture(cubeMap, rayDir);
bool readRG = readChannelsRG ^^ readOtherChannel;
s = readRG ? vec4(vec3(s.r), s.g) : vec4(vec3(s.b), s.a);
return length(s) == 0.0 ? vec4(s.rgb, 1.0) : s;
}`),e.uniforms.add(new w.t("anchorPoint",((t,e)=>e.clouds.parallax.anchorPoint)),new w.t("anchorPointNew",((t,e)=>e.clouds.parallaxNew.anchorPoint)),new u.X("rotationClouds",((t,e)=>e.clouds.parallax.transform)),new u.X("rotationCloudsNew",((t,e)=>e.clouds.parallaxNew.transform)),new c.m("cloudsOpacity",((t,e)=>e.clouds.opacity)),new c.m("fadeFactor",((t,e)=>e.clouds.fadeFactor)),new b.e("crossFade",((t,e)=>e.clouds.fadeState===m.c.CROSS_FADE))).code.add(r.H`vec4 renderClouds(vec3 worldRay, vec3 cameraPosition) {
vec3 intersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPoint);
vec3 worldRayRotated = rotateDirectionToAnchorPoint(rotationClouds, normalize(intersectionPoint));
vec3 worldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);
vec4 cloudData = sampleCloud(worldRayRotatedCorrected, crossFade);
vec3 cameraPositionN = normalize(cameraPosition);
vec4 cloudColor = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);
if(crossFade) {
intersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPointNew);
worldRayRotated = rotateDirectionToAnchorPoint(rotationCloudsNew, normalize(intersectionPoint));
worldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);
cloudData = sampleCloud(worldRayRotatedCorrected, false);
vec4 cloudColorNew = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);
cloudColor = mix(cloudColor, cloudColorNew, fadeFactor);
}
float totalTransmittance = length(cloudColor.rgb) == 0.0 ?
1.0 :
clamp(cloudColor.a * cloudsOpacity + (1.0 - cloudsOpacity), 0.0 , 1.0);
return vec4(cloudColor.rgb, totalTransmittance);
}`)}const S=(g.$O.radius+y.k9)**2;function E(t){t.code.add(r.H`vec3 tonemapACES(vec3 x) {
return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
}`)}function C(t,e){t.include(o.f,e),t.include(s),t.include(n.v),e.cloudReflections&&t.include(M),t.include(f,e);const i=t.fragment;i.include(E),i.constants.add("fresnelSky","vec3",[.02,1,15]),i.constants.add("fresnelMaterial","vec2",[.02,.1]),i.constants.add("roughness","float",.015),i.constants.add("foamIntensityExternal","float",1.7),i.constants.add("ssrIntensity","float",.65),i.constants.add("ssrHeightFadeStart","float",a.O),i.constants.add("ssrHeightFadeEnd","float",a.b),i.constants.add("waterDiffusion","float",.92),i.constants.add("waterSeaColorMod","float",.8),i.constants.add("correctionViewingPowerFactor","float",.4),i.constants.add("skyZenitColor","vec3",[.52,.68,.9]),i.constants.add("skyColor","vec3",[.67,.79,.9]),i.constants.add("cloudFresnelModifier","vec2",[1.2,.01]),i.code.add(r.H`PBRShadingWater shadingInfo;
vec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {
float exponent = pow((1.0 - cosTheta), fresnelSky[2]);
return mix(zenit, horizon, exponent);
}`),i.uniforms.add(new c.m("lightingSpecularStrength",((t,e)=>e.lighting.mainLight.specularStrength)),new c.m("lightingEnvironmentStrength",((t,e)=>e.lighting.mainLight.environmentStrength))),i.code.add(r.H`vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 viewPosition, vec3 position) {
float reflectionHit = 0.0;
float reflectionHitDiffused = 0.0;
vec3 seaWaterColor = linearizeGamma(color);
vec3 h = normalize(l + v);
shadingInfo.NdotV = clamp(dot(n, v), 0.001, 1.0);
shadingInfo.VdotN = clamp(dot(v, n), 0.001, 1.0);
shadingInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);
shadingInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);
shadingInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);
float upDotV = max(dot(localUp,v), 0.0);
vec3 skyHorizon = linearizeGamma(skyColor);
vec3 skyZenit = linearizeGamma(skyZenitColor);
vec3 skyColor = getSkyGradientColor(upDotV, skyHorizon, skyZenit );
float upDotL = max(dot(localUp,l),0.0);
float daytimeMod = 0.1 + upDotL * 0.9;
skyColor *= daytimeMod;
float shadowModifier = clamp(shadow, 0.8, 1.0);
vec3 fresnelModifier = fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);
vec3 reflSky = lightingEnvironmentStrength * fresnelModifier * skyColor * shadowModifier;
vec3 reflSea = seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;
vec3 specular = vec3(0.0);
if(upDotV > 0.0 && upDotL > 0.0) {
vec3 specularSun = brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);
vec3 incidentLight = lightIntensity * LIGHT_NORMALIZATION * shadow;
float NdotL = clamp(dot(n, l), 0.0, 1.0);
specular = lightingSpecularStrength * NdotL * incidentLight * specularSun;
}
vec3 foam = vec3(0.0);
if(upDotV > 0.0) {
foam = foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);
}
float correctionViewingFactor = pow(max(dot(v, localUp), 0.0), correctionViewingPowerFactor);
vec3 normalCorrectedClouds = mix(localUp, n, correctionViewingFactor);
vec3 reflectedWorld = normalize(reflect(-v, normalCorrectedClouds));`),e.cloudReflections&&i.uniforms.add(new c.m("cloudsOpacity",((t,e)=>e.clouds.opacity))).code.add(r.H`vec4 cloudsColor = renderClouds(reflectedWorld, position);
cloudsColor.a = 1.0 - cloudsColor.a;
cloudsColor = pow(cloudsColor, vec4(GAMMA));
cloudsColor *= clamp(fresnelModifier.y * cloudFresnelModifier[0] - cloudFresnelModifier[1], 0.0, 1.0) * cloudsOpacity;`),e.screenSpaceReflections?i.uniforms.add(new u.X("view",((t,e)=>e.camera.viewMatrix)),new d.N("lastFrameColorTexture",((t,e)=>e.ssr.lastFrameColor?.getTexture())),new c.m("fadeFactorSSR",((t,e)=>e.ssr.fadeFactor))).code.add(r.H`vec3 viewDir = normalize(viewPosition);
vec4 viewNormalVectorCoordinate = view * vec4(n, 0.0);
vec3 viewNormal = normalize(viewNormalVectorCoordinate.xyz);
vec4 viewUp = view * vec4(localUp, 0.0);
vec3 viewNormalCorrectedSSR = mix(viewUp.xyz, viewNormal, correctionViewingFactor);
vec3 reflected = normalize(reflect(viewDir, viewNormalCorrectedSSR));
vec3 hitCoordinate = screenSpaceIntersection(reflected, viewPosition, viewDir, viewUp.xyz);
vec3 reflectedColor = vec3(0.0);
if (hitCoordinate.z > 0.0)
{
vec2 reprojectedCoordinate = reprojectionCoordinate(hitCoordinate);
vec2 dCoords = smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));
float heightMod = smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -viewPosition.z);
reflectionHit = clamp(1.0 - (1.3 * dCoords.y), 0.0, 1.0) * heightMod * fadeFactorSSR;
reflectionHitDiffused = waterDiffusion * reflectionHit;
reflectedColor = linearizeGamma(texture(lastFrameColorTexture, reprojectedCoordinate).xyz) *
reflectionHitDiffused * fresnelModifier.y * ssrIntensity;
}
float seaColorMod =  mix(waterSeaColorMod, waterSeaColorMod * 0.5, reflectionHitDiffused);
vec3 waterRenderedColor = tonemapACES((1.0 - reflectionHitDiffused) * reflSky + reflectedColor +
reflSea * seaColorMod + specular + foam);`):i.code.add(r.H`vec3 waterRenderedColor = tonemapACES(reflSky + reflSea * waterSeaColorMod + specular + foam);`),e.cloudReflections?e.screenSpaceReflections?i.code.add(r.H`return waterRenderedColor * (1.0 - (1.0 - reflectionHit) * cloudsColor.a) + (1.0 - reflectionHit) * cloudsColor.xyz;
}`):i.code.add(r.H`return waterRenderedColor * (1.0 - cloudsColor.a) + cloudsColor.xyz;
}`):i.code.add(r.H`return waterRenderedColor;
}`)}},28686:function(t,e,i){"use strict";i.d(e,{Q:function(){return n}});const n=1/255.5},82316:function(t,e,i){"use strict";i.d(e,{Ir:function(){return c}});var n=i(13786),r=i(1932),s=i(33400),o=i(41546),a=i(11687),h=i(38917),l=i(39506);function c(t){t.fragment.uniforms.add(new h.E("projInfo",((t,e)=>function(t){const e=t.projectionMatrix;return 0===e[11]?(0,s.s)(u,2/(t.fullWidth*e[0]),2/(t.fullHeight*e[5]),(1+e[12])/e[0],(1+e[13])/e[5]):(0,s.s)(u,-2/(t.fullWidth*e[0]),-2/(t.fullHeight*e[5]),(1-e[8])/e[0],(1-e[9])/e[5])}(e.camera)))),t.fragment.uniforms.add(new a.G("zScale",((t,e)=>function(t){return 0===t.projectionMatrix[11]?(0,n.hZ)(d,0,1):(0,n.hZ)(d,1,0)}(e.camera)))),t.fragment.code.add(l.H`vec3 reconstructPosition(vec2 fragCoord, float depth) {
return vec3((fragCoord * projInfo.xy + projInfo.zw) * (zScale.x * depth + zScale.y), depth);
}`)}const u=(0,o.vt)(),d=(0,r.vt)()},23864:function(t,e,i){"use strict";i.d(e,{a:function(){return r}});var n=i(39506);function r(t){t.code.add(n.H`vec4 premultiplyAlpha(vec4 v) {
return vec4(v.rgb * v.a, v.a);
}
vec3 rgb2hsv(vec3 c) {
vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);
vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);
vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);
float d = q.x - min(q.w, q.y);
float e = 1.0e-10;
return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);
}
vec3 hsv2rgb(vec3 c) {
vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}
float rgb2v(vec3 c) {
return max(c.x, max(c.y, c.z));
}`)}},90576:function(t,e,i){"use strict";i.d(e,{u:function(){return r}});var n=i(39506);function r({code:t},e){e.doublePrecisionRequiresObfuscation?t.add(n.H`vec3 dpPlusFrc(vec3 a, vec3 b) {
return mix(a, a + b, vec3(notEqual(b, vec3(0))));
}
vec3 dpMinusFrc(vec3 a, vec3 b) {
return mix(vec3(0), a - b, vec3(notEqual(a, b)));
}
vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = dpPlusFrc(hiA, hiB);
vec3 e = dpMinusFrc(t1, hiA);
vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
return t1 + t2;
}`):t.add(n.H`vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
vec3 t1 = hiA + hiB;
vec3 e = t1 - hiA;
vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
return t1 + t2;
}`)}},52766:function(t,e,i){"use strict";i.d(e,{W:function(){return r}});var n=i(39506);function r(t){t.code.add(n.H`const float MAX_RGBA_FLOAT =
255.0 / 256.0 +
255.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 +
255.0 / 256.0 / 256.0 / 256.0 / 256.0;
const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);
vec4 float2rgba(const float value) {
float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);
vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);
const float toU8AsFloat = 1.0 / 255.0;
return fixedPointU8 * toU8AsFloat;
}`),t.code.add(n.H`const vec4 RGBA_2_FLOAT_FACTORS = vec4(
255.0 / (256.0),
255.0 / (256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0),
255.0 / (256.0 * 256.0 * 256.0 * 256.0)
);
float rgba2float(vec4 rgba) {
return dot(rgba, RGBA_2_FLOAT_FACTORS);
}`),t.code.add(n.H`const vec4 uninterpolatedRGBAToFloatFactors = vec4(
1.0 / 256.0,
1.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0,
1.0 / 256.0 / 256.0 / 256.0 / 256.0
);
float uninterpolatedRGBAToFloat(vec4 rgba) {
return (dot(round(rgba * 255.0), uninterpolatedRGBAToFloatFactors) - 0.5) * 2.0;
}`)}},19202:function(t,e,i){"use strict";i.d(e,{OH:function(){return l},Y6:function(){return a},pM:function(){return h}});var n=i(20551),r=i(32501),s=i(82598),o=i(39506);function a(t){t.vertex.code.add(o.H`float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {
return absCosAngle * absCosAngle * absCosAngle;
}`),t.vertex.code.add(o.H`vec3 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec3 params) {
return vec3(
min(params.x / (distanceToCamera - params.y), 1.0),
screenSizePerspectiveViewAngleDependentFactor(absCosAngle),
params.z
);
}`),t.vertex.code.add(o.H`float applyScreenSizePerspectiveScaleFactorFloat(float size, vec3 factor) {
return mix(size * clamp(factor.x, factor.z, 1.0), size, factor.y);
}`),t.vertex.code.add(o.H`float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorFloat(
size,
screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)
);
}`),t.vertex.code.add(o.H`vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec3 factor) {
return mix(size * clamp(factor.x, factor.z, 1.0), size, factor.y);
}`),t.vertex.code.add(o.H`vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec3 params) {
return applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));
}`)}function h(t){t.uniforms.add(new s.t("screenSizePerspective",(t=>c(t.screenSizePerspective))))}function l(t){t.uniforms.add(new s.t("screenSizePerspectiveAlignment",(t=>c(t.screenSizePerspectiveAlignment||t.screenSizePerspective))))}function c(t){return(0,n.i)(u,t.parameters.divisor,t.parameters.offset,t.minScaleFactor)}const u=(0,r.vt)()},20830:function(t,e,i){"use strict";i.d(e,{yu:function(){return p},Nz:function(){return _},NB:function(){return g},S7:function(){return y}});var n=i(73364),r=i(39714),s=i(20551),o=i(32501),a=i(4435),h=i(82598),l=i(14543),c=i(65312),u=i(54516);class d extends c.n{constructor(t,e){super(t,"mat4",u.c.Draw,((i,n,r)=>i.setUniformMatrix4fv(t,e(n,r))))}}var f=i(70340);function p(t,e){e.instancedDoublePrecision?t.constants.add("cameraPosition","vec3",o.uY):t.uniforms.add(new a.W("cameraPosition",((t,e)=>(0,s.i)(m,e.camera.viewInverseTransposeMatrix[3]-t.origin[0],e.camera.viewInverseTransposeMatrix[7]-t.origin[1],e.camera.viewInverseTransposeMatrix[11]-t.origin[2]))))}function g(t,e){if(!e.instancedDoublePrecision)return void t.uniforms.add(new f.X("proj",((t,e)=>e.camera.projectionMatrix)),new d("view",((t,e)=>(0,n.Tl)(v,e.camera.viewMatrix,t.origin))),new a.W("localOrigin",(t=>t.origin)));const i=t=>(0,s.i)(m,t.camera.viewInverseTransposeMatrix[3],t.camera.viewInverseTransposeMatrix[7],t.camera.viewInverseTransposeMatrix[11]);t.uniforms.add(new f.X("proj",((t,e)=>e.camera.projectionMatrix)),new f.X("view",((t,e)=>(0,n.Tl)(v,e.camera.viewMatrix,i(e)))),new h.t("localOrigin",((t,e)=>i(e))))}const v=(0,r.vt)(),m=(0,o.vt)();function y(t){t.uniforms.add(new f.X("viewNormal",((t,e)=>e.camera.viewInverseTransposeMatrix)))}function _(t){t.uniforms.add(new l.m("pixelRatio",((t,e)=>e.camera.pixelRatio/e.overlayStretch)))}},45937:function(t,e,i){"use strict";i.d(e,{e:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"bool",r.c.Pass,((i,n,r)=>i.setUniform1b(t,e(n,r))))}}},30262:function(t,e,i){"use strict";i.d(e,{t:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec2",r.c.Draw,((i,n,r,s)=>i.setUniform2fv(t,e(n,r,s))))}}},11687:function(t,e,i){"use strict";i.d(e,{G:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec2",r.c.Pass,((i,n,r)=>i.setUniform2fv(t,e(n,r))))}}},4435:function(t,e,i){"use strict";i.d(e,{W:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec3",r.c.Draw,((i,n,r,s)=>i.setUniform3fv(t,e(n,r,s))))}}},82598:function(t,e,i){"use strict";i.d(e,{t:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec3",r.c.Pass,((i,n,r)=>i.setUniform3fv(t,e(n,r))))}}},41356:function(t,e,i){"use strict";i.d(e,{V:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec4",r.c.Draw,((i,n,r)=>i.setUniform4fv(t,e(n,r))))}}},38917:function(t,e,i){"use strict";i.d(e,{E:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"vec4",r.c.Pass,((i,n,r)=>i.setUniform4fv(t,e(n,r))))}}},30636:function(t,e,i){"use strict";i.d(e,{F:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e,i){super(t,"vec4",r.c.Pass,((i,n,r)=>i.setUniform4fv(t,e(n,r))),i)}}},14543:function(t,e,i){"use strict";i.d(e,{m:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"float",r.c.Pass,((i,n,r)=>i.setUniform1f(t,e(n,r))))}}},454:function(t,e,i){"use strict";i.d(e,{x:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e,i){super(t,"float",r.c.Pass,((i,n,r)=>i.setUniform1fv(t,e(n,r))),i)}}},12511:function(t,e,i){"use strict";i.d(e,{g:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"ivec2",r.c.Pass,((i,n,r)=>i.setUniform2iv(t,e(n,r))))}}},50295:function(t,e,i){"use strict";i.d(e,{c:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"int",r.c.Pass,((i,n,r)=>i.setUniform1i(t,e(n,r))))}}},31190:function(t,e,i){"use strict";i.d(e,{h:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"mat3",r.c.Draw,((i,n,r)=>i.setUniformMatrix3fv(t,e(n,r))))}}},78567:function(t,e,i){"use strict";i.d(e,{k:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"mat3",r.c.Pass,((i,n,r)=>i.setUniformMatrix3fv(t,e(n,r))))}}},70340:function(t,e,i){"use strict";i.d(e,{X:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"mat4",r.c.Pass,((i,n,r)=>i.setUniformMatrix4fv(t,e(n,r))))}}},62988:function(t,e,i){"use strict";i.d(e,{N5:function(){return h}});var n=i(39819),r=(i(58941),i(40633)),s=i(54516),o=i(90553);class a{constructor(){this._includedModules=new Map}include(t,e){this._includedModules.has(t)?this._includedModules.get(t):(this._includedModules.set(t,e),t(this.builder,e))}}class h extends a{constructor(){super(...arguments),this.vertex=new d,this.fragment=new d,this.attributes=new f,this.varyings=new p,this.extensions=new g,this.outputs=new v}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(t){const e=this.extensions.generateSource(t),i=this.attributes.generateSource(t),n=this.varyings.generateSource(t),r="vertex"===t?this.vertex:this.fragment,s=r.uniforms.generateSource(),o=r.code.generateSource(),a=r.main.generateSource(),h="vertex"===t?_:y,l=r.constants.generateSource(),c=this.outputs.generateSource(t);return`#version 300 es\n${e.join("\n")}\n\n${h}\n\n${l.join("\n")}\n\n${s.join("\n")}\n\n${i.join("\n")}\n\n${n.join("\n")}\n\n${c.join("\n")}\n\n${o.join("\n")}\n\n${a.join("\n")}`}generateBindPass(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const i=t.bind[s.c.Pass];i&&e.set(t.name,i)})),this.fragment.uniforms.entries.forEach((t=>{const i=t.bind[s.c.Pass];i&&e.set(t.name,i)}));const i=Array.from(e.values()),n=i.length;return(e,r)=>{for(let s=0;s<n;++s)i[s](t,e,r)}}generateBindDraw(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const i=t.bind[s.c.Draw];i&&e.set(t.name,i)})),this.fragment.uniforms.entries.forEach((t=>{const i=t.bind[s.c.Draw];i&&e.set(t.name,i)}));const i=Array.from(e.values()),n=i.length;return(e,r,s)=>{for(let o=0;o<n;++o)i[o](t,s,e,r)}}}class l{constructor(t){this._stage=t,this._entries=new Map}add(...t){for(const e of t)this._add(e);return this._stage}get(t){return this._entries.get(t)}_add(t){if(null!=t){if(this._entries.has(t.name)&&!this._entries.get(t.name).equals(t))throw new n.A(`Duplicate uniform name ${t.name} for different uniform type`);this._entries.set(t.name,t)}else r.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder").error(`Trying to add null Uniform from ${(new Error).stack}.`)}generateSource(){return Array.from(this._entries.values()).map((t=>null!=t.arraySize?`uniform ${t.type} ${t.name}[${t.arraySize}];`:`uniform ${t.type} ${t.name};`))}get entries(){return Array.from(this._entries.values())}}class c{constructor(t){this._stage=t,this._bodies=new Array}add(t){return this._bodies.push(t),this._stage}generateSource(){if(this._bodies.length>0)return[`void main() {\n ${this._bodies.join("\n")||""} \n}`];throw new n.A("Shader does not contain main function body.")}}class u{constructor(t){this._stage=t,this._entries=new Array}add(t){return this._entries.push(t),this._stage}generateSource(){return this._entries}}class d extends a{constructor(){super(...arguments),this.uniforms=new l(this),this.main=new c(this),this.code=new u(this),this.constants=new m(this)}get builder(){return this}}class f{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map((t=>`in ${t[1]} ${t[0]};`))}}class p{constructor(){this._entries=new Map}add(t,e){this._entries.has(t)&&(0,o.vA)(this._entries.get(t)===e),this._entries.set(t,e)}generateSource(t){const e=new Array;return this._entries.forEach(((i,n)=>e.push("vertex"===t?`out ${i} ${n};`:`in ${i} ${n};`))),e}}class g{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?g.ALLOWLIST_VERTEX:g.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((t=>e.includes(t))).map((t=>`#extension ${t} : enable`))}}g.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],g.ALLOWLIST_VERTEX=[];class v{constructor(){this._entries=new Map}add(t,e,i=0){const n=this._entries.get(i);n?(0,o.vA)(n.name===t&&n.type===e,`Fragment shader output location ${i} occupied`):this._entries.set(i,{name:t,type:e})}generateSource(t){if("vertex"===t)return[];0===this._entries.size&&this._entries.set(0,{name:v.DEFAULT_NAME,type:v.DEFAULT_TYPE});const e=new Array;return this._entries.forEach(((t,i)=>e.push(`layout(location = ${i}) out ${t.type} ${t.name};`))),e}}v.DEFAULT_TYPE="vec4",v.DEFAULT_NAME="fragColor";class m{constructor(t){this._stage=t,this._entries=new Set}add(t,e,i){let n="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":n=m._numberToFloatStr(i);break;case"int":n=m._numberToIntStr(i);break;case"bool":n=i.toString();break;case"vec2":n=`vec2(${m._numberToFloatStr(i[0])},                            ${m._numberToFloatStr(i[1])})`;break;case"vec3":n=`vec3(${m._numberToFloatStr(i[0])},                            ${m._numberToFloatStr(i[1])},                            ${m._numberToFloatStr(i[2])})`;break;case"vec4":n=`vec4(${m._numberToFloatStr(i[0])},                            ${m._numberToFloatStr(i[1])},                            ${m._numberToFloatStr(i[2])},                            ${m._numberToFloatStr(i[3])})`;break;case"ivec2":n=`ivec2(${m._numberToIntStr(i[0])},                             ${m._numberToIntStr(i[1])})`;break;case"ivec3":n=`ivec3(${m._numberToIntStr(i[0])},                             ${m._numberToIntStr(i[1])},                             ${m._numberToIntStr(i[2])})`;break;case"ivec4":n=`ivec4(${m._numberToIntStr(i[0])},                             ${m._numberToIntStr(i[1])},                             ${m._numberToIntStr(i[2])},                             ${m._numberToIntStr(i[3])})`;break;case"mat2":case"mat3":case"mat4":n=`${e}(${Array.prototype.map.call(i,(t=>m._numberToFloatStr(t))).join(", ")})`}return this._entries.add(`const ${e} ${t} = ${n};`),this._stage}static _numberToIntStr(t){return t.toFixed(0)}static _numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const y="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",_="precision highp float;\nprecision highp sampler2D;"},40075:function(t,e,i){"use strict";i.d(e,{o:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"sampler2D",r.c.Draw,((i,n,r)=>i.bindTexture(t,e(n,r))))}}},39838:function(t,e,i){"use strict";i.d(e,{N:function(){return s}});var n=i(65312),r=i(54516);class s extends n.n{constructor(t,e){super(t,"sampler2D",r.c.Pass,((i,n,r)=>i.bindTexture(t,e(n,r))))}}},65312:function(t,e,i){"use strict";i.d(e,{n:function(){return r}});var n=i(54516);class r{constructor(t,e,i,r,s=null){if(this.name=t,this.type=e,this.arraySize=s,this.bind={[n.c.Pass]:null,[n.c.Draw]:null},r)switch(i){case n.c.Pass:this.bind[n.c.Pass]=r;break;case n.c.Draw:this.bind[n.c.Draw]=r}}equals(t){return this.type===t.type&&this.name===t.name&&this.arraySize===t.arraySize}}},39506:function(t,e,i){"use strict";i.d(e,{H:function(){return r},If:function(){return s},Y:function(){return n}});const n=class{};function r(t,...e){let i="";for(let n=0;n<e.length;n++)i+=t[n]+e[n];return i+=t[t.length-1],i}function s(t,e,i=""){return t?e:i}var o;(o=r||(r={})).int=function(t){return Math.round(t).toString()},o.float=function(t){return t.toPrecision(8)}},54516:function(t,e,i){"use strict";var n;i.d(e,{c:function(){return n}}),function(t){t[t.Pass=0]="Pass",t[t.Draw=1]="Draw"}(n||(n={}))},34615:function(t,e,i){"use strict";i.d(e,{$:function(){return n}});class n{constructor(t,e){this._module=t,this._load=e}get(){return this._module}async reload(){return this._module=await this._load(),this._module}}},82273:function(t,e,i){"use strict";i.d(e,{w:function(){return c}});var n=i(95929),r=i(40502),s=i(7187),o=i(41835);class a{constructor(t,e,i){this._context=t,this._locations=i,this._textures=new Map,this._freeTextureUnits=new s.A({deallocator:null}),this._glProgram=t.programCache.acquire(e.generate("vertex"),e.generate("fragment"),i),this._glProgram.stop=()=>{throw new Error("Wrapped _glProgram used directly")},this.bindPass=e.generateBindPass(this),this.bindDraw=e.generateBindDraw(this),this._fragmentUniforms=(0,o.en)()?e.fragmentUniforms:null}dispose(){this._glProgram.dispose()}get glName(){return this._glProgram.glName}get hasTransformFeedbackVaryings(){return this._glProgram.hasTransformFeedbackVaryings}get compiled(){return this._glProgram.compiled}setUniform1b(t,e){this._glProgram.setUniform1i(t,e?1:0)}setUniform1i(t,e){this._glProgram.setUniform1i(t,e)}setUniform1f(t,e){this._glProgram.setUniform1f(t,e)}setUniform2fv(t,e){this._glProgram.setUniform2fv(t,e)}setUniform3fv(t,e){this._glProgram.setUniform3fv(t,e)}setUniform4fv(t,e){this._glProgram.setUniform4fv(t,e)}setUniformMatrix3fv(t,e){this._glProgram.setUniformMatrix3fv(t,e)}setUniformMatrix4fv(t,e){this._glProgram.setUniformMatrix4fv(t,e)}setUniform1fv(t,e){this._glProgram.setUniform1fv(t,e)}setUniform1iv(t,e){this._glProgram.setUniform1iv(t,e)}setUniform2iv(t,e){this._glProgram.setUniform2iv(t,e)}setUniform3iv(t,e){this._glProgram.setUniform3iv(t,e)}setUniform4iv(t,e){this._glProgram.setUniform4iv(t,e)}assertCompatibleVertexAttributeLocations(t){t.locations!==this._locations&&console.error("VertexAttributeLocations are incompatible")}stop(){this._textures.clear(),this._freeTextureUnits.clear()}bindTexture(t,e){if(null==e?.glName){const e=this._textures.get(t);return e&&(this._context.bindTexture(null,e.unit),this._freeTextureUnit(e),this._textures.delete(t)),null}let i=this._textures.get(t);return null==i?(i=this._allocTextureUnit(e),this._textures.set(t,i)):i.texture=e,this._context.useProgram(this),this.setUniform1i(t,i.unit),this._context.bindTexture(e,i.unit),i.unit}rebindTextures(){this._context.useProgram(this),this._textures.forEach(((t,e)=>{this._context.bindTexture(t.texture,t.unit),this.setUniform1i(e,t.unit)})),this._fragmentUniforms?.forEach((t=>{"sampler2D"!==t.type&&"samplerCube"!==t.type||this._textures.has(t.name)||console.error(`Texture sampler ${t.name} has no bound texture`)}))}_allocTextureUnit(t){return{texture:t,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}_freeTextureUnit(t){this._freeTextureUnits.push(t.unit)}}var h=i(85456),l=i(57087);class c{constructor(t,e,i,s,o=r.D){this.release=s,this.locations=o,this.primitiveType=h.WR.TRIANGLES,this.key=e.key,this._program=new a(t.rctx,i.get().build(e),o),this._pipeline=this.initializePipeline(e),this.reload=async r=>{if(r&&await i.reload(),!this.key.equals(e.key))throw new Error("Configuration was changed after construction, cannot reload shader");(0,n.WD)(this._program),this._program=new a(t.rctx,i.get().build(e),o),this._pipeline=this.initializePipeline(e)}}destroy(){this._program=(0,n.WD)(this._program),this._pipeline=null}get program(){return this._program}get compiled(){return this.program.compiled}ensureAttributeLocations(t){this.program.assertCompatibleVertexAttributeLocations(t)}getPipeline(t,e){return this._pipeline}initializePipeline(t){return(0,l.Ey)({blending:l.Os,colorWrite:l.kn})}}},65875:function(t,e,i){"use strict";i.d(e,{K:function(){return a},W:function(){return h}});var n=i(39819),r=i(39506),s=i(50659);class o{constructor(t){this._bits=[...t]}equals(t){return(0,s.aI)(this._bits,t.bits)}get code(){return this._code??=String.fromCharCode(...this._bits),this._code}get bits(){return this._bits}}class a extends r.Y{constructor(){super(),this._parameterBits=this._parameterBits?.map((()=>0))??[],this._parameterNames??=[]}get key(){return this._key??=new o(this._parameterBits),this._key}decode(t=this.key){const e=this._parameterBits;this._parameterBits=[...t.bits];const i=this._parameterNames.map((t=>`    ${t}: ${this[t]}`)).join("\n");return this._parameterBits=e,i}}function h(t={}){return(e,i)=>{e.hasOwnProperty("_parameterNames")||Object.defineProperty(e,"_parameterNames",{value:e._parameterNames?.slice()??[],configurable:!0,writable:!0}),e.hasOwnProperty("_parameterBits")||Object.defineProperty(e,"_parameterBits",{value:e._parameterBits?.slice()??[0],configurable:!0,writable:!0}),e._parameterNames.push(i);const r=t.count||2,s=Math.ceil(Math.log2(r)),o=e._parameterBits;let a=0;for(;o[a]+s>16;)a++,a>=o.length&&o.push(0);const h=o[a],l=(1<<s)-1<<h;o[a]+=s,t.count?Object.defineProperty(e,i,{get(){return(this._parameterBits[a]&l)>>h},set(e){if(this[i]!==e){if(this._key=null,this._parameterBits[a]=this._parameterBits[a]&~l|+e<<h&l,"number"!=typeof e)throw new n.A(`Configuration value for ${i} must be a number, got ${typeof e}`);if(null==t.count)throw new n.A(`Configuration value for ${i} must provide a count option`)}}}):Object.defineProperty(e,i,{get(){return!!((this._parameterBits[a]&l)>>h)},set(t){if(this[i]!==t&&(this._key=null,this._parameterBits[a]=this._parameterBits[a]&~l|+t<<h&l,"boolean"!=typeof t))throw new n.A(`Configuration value for ${i} must be boolean, got ${typeof t}`)}})}}},67521:function(t,e,i){"use strict";i.d(e,{Cc:function(){return h},RW:function(){return a},VM:function(){return l}});var n=i(83525),r=i(27264);const s={required:[]};r.V.Depth;class o extends n.A{precompile(t){const e=this.acquireTechniques(t);return l(e),null!=e}consumes(){return s}get usedMemory(){return 0}get isDecoration(){return!1}get running(){return!1}modify(t){}get numGeometries(){return 0}get hasOccludees(){return!1}get hasEmissions(){return!1}forEachGeometry(t){}queryRenderOccludedState(t){return!1}}class a extends o{}class h extends o{}function l(t){Array.isArray(t)?t.forEach((t=>t?.release())):t?.release()}},39534:function(t,e,i){"use strict";i.d(e,{E:function(){return r}});var n=i(58941);function r(){return!!(0,n.A)("enable-feature:objectAndLayerId-rendering")}},14905:function(t,e,i){"use strict";i.d(e,{K:function(){return n},n:function(){return r}});class n{constructor(t,e,i=e){this.data=t,this.size=e,this.stride=i}}class r extends n{constructor(t,e,i,n=!1,r=i){super(t,i,r),this.indices=e,this.exclusive=n}}},89932:function(t,e,i){"use strict";i.d(e,{S:function(){return r}});var n=i(24540);function r(t){if(t.length<n.y9)return Array.from(t);if((0,n.cy)(t))return Float64Array.from(t);if(!("BYTES_PER_ELEMENT"in t))return Array.from(t);switch(t.BYTES_PER_ELEMENT){case 1:return Uint8Array.from(t);case 2:return(0,n.jq)(t)?Uint16Array.from(t):Int16Array.from(t);case 4:return Float32Array.from(t);default:return Float64Array.from(t)}}},53905:function(t,e,i){"use strict";i.d(e,{j:function(){return a}});var n=i(7187),r=i(20551),s=i(32501),o=i(90553);class a{constructor(t,e,i){this.primitiveIndices=t,this._numIndexPerPrimitive=e,this.position=i,this._children=void 0,(0,o.vA)(t.length>=1),(0,o.vA)(3===i.size||4===i.size);const{data:n,size:a,indices:l}=i;(0,o.vA)(l.length%this._numIndexPerPrimitive==0),(0,o.vA)(l.length>=t.length*this._numIndexPerPrimitive);const c=t.length;let u=a*l[this._numIndexPerPrimitive*t[0]];h.clear(),h.push(u);const d=(0,s.fA)(n[u],n[u+1],n[u+2]),f=(0,s.o8)(d);for(let e=0;e<c;++e){const i=this._numIndexPerPrimitive*t[e];for(let t=0;t<this._numIndexPerPrimitive;++t){u=a*l[i+t],h.push(u);let e=n[u];d[0]=Math.min(e,d[0]),f[0]=Math.max(e,f[0]),e=n[u+1],d[1]=Math.min(e,d[1]),f[1]=Math.max(e,f[1]),e=n[u+2],d[2]=Math.min(e,d[2]),f[2]=Math.max(e,f[2])}}this.bbMin=d,this.bbMax=f;const p=(0,r.m)((0,s.vt)(),this.bbMin,this.bbMax,.5);this.radius=.5*Math.max(Math.max(f[0]-d[0],f[1]-d[1]),f[2]-d[2]);let g=this.radius*this.radius;for(let t=0;t<h.length;++t){u=h.at(t);const e=n[u]-p[0],i=n[u+1]-p[1],r=n[u+2]-p[2],s=e*e+i*i+r*r;if(s<=g)continue;const o=Math.sqrt(s),a=.5*(o-this.radius);this.radius=this.radius+a,g=this.radius*this.radius;const l=a/o;p[0]+=e*l,p[1]+=i*l,p[2]+=r*l}this.center=p,h.clear()}getChildren(){if(this._children||(0,r.s)(this.bbMin,this.bbMax)<=1)return this._children;const t=(0,r.m)((0,s.vt)(),this.bbMin,this.bbMax,.5),e=this.primitiveIndices.length,i=new Uint8Array(e),n=new Array(8);for(let t=0;t<8;++t)n[t]=0;const{data:o,size:h,indices:l}=this.position;for(let r=0;r<e;++r){let e=0;const s=this._numIndexPerPrimitive*this.primitiveIndices[r];let a=h*l[s],c=o[a],u=o[a+1],d=o[a+2];for(let t=1;t<this._numIndexPerPrimitive;++t){a=h*l[s+t];const e=o[a],i=o[a+1],n=o[a+2];e<c&&(c=e),i<u&&(u=i),n<d&&(d=n)}c<t[0]&&(e|=1),u<t[1]&&(e|=2),d<t[2]&&(e|=4),i[r]=e,++n[e]}let c=0;for(let t=0;t<8;++t)n[t]>0&&++c;if(c<2)return;const u=new Array(8);for(let t=0;t<8;++t)u[t]=n[t]>0?new Uint32Array(n[t]):void 0;for(let t=0;t<8;++t)n[t]=0;for(let t=0;t<e;++t){const e=i[t];u[e][n[e]++]=this.primitiveIndices[t]}this._children=new Array;for(let t=0;t<8;++t)void 0!==u[t]&&this._children.push(new a(u[t],this._numIndexPerPrimitive,this.position));return this._children}static prune(){h.prune()}}const h=new n.A({deallocator:null})},23545:function(t,e,i){"use strict";i.d(e,{VR:function(){return r},a0:function(){return o}});var n=i(7187);class r{constructor(){this.adds=new n.A,this.removes=new n.A,this.updates=new n.A({allocator:t=>t||new s,deallocator:t=>(t.renderGeometry=null,t)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}get empty(){return 0===this.adds.length&&0===this.removes.length&&0===this.updates.length}}class s{}class o{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}}},48015:function(t,e,i){"use strict";i.d(e,{J:function(){return r}});var n=i(11231);class r{constructor(){this.id=(0,n.c)()}}},40359:function(t,e,i){"use strict";var n;i.d(e,{X:function(){return n}}),function(t){t[t.Layer=0]="Layer",t[t.Object=1]="Object",t[t.Mesh=2]="Mesh",t[t.Line=3]="Line",t[t.Point=4]="Point",t[t.Material=5]="Material",t[t.Texture=6]="Texture",t[t.COUNT=7]="COUNT"}(n||(n={}))},40502:function(t,e,i){"use strict";i.d(e,{D:function(){return r}});var n=i(65839);const r=new Map([[n.r.POSITION,0],[n.r.NORMAL,1],[n.r.NORMALCOMPRESSED,1],[n.r.UV0,2],[n.r.COLOR,3],[n.r.COLORFEATUREATTRIBUTE,3],[n.r.SIZE,4],[n.r.TANGENT,4],[n.r.CENTEROFFSETANDDISTANCE,5],[n.r.SYMBOLCOLOR,5],[n.r.FEATUREATTRIBUTE,6],[n.r.INSTANCEFEATUREATTRIBUTE,6],[n.r.INSTANCECOLOR,7],[n.r.OBJECTANDLAYERIDCOLOR,7],[n.r.INSTANCEOBJECTANDLAYERIDCOLOR,7],[n.r.ROTATION,8],[n.r.INSTANCEMODEL,8],[n.r.INSTANCEMODELNORMAL,12],[n.r.INSTANCEMODELORIGINHI,11],[n.r.INSTANCEMODELORIGINLO,15]])},4875:function(t,e,i){"use strict";i.d(e,{A:function(){return r}});var n=i(54407);class r{constructor(t){this._material=t.material,this._techniques=t.techniques,this._output=t.output}dispose(){}get _stippleTextures(){return this._techniques.context.stippleTextures}get _markerTextures(){return this._techniques.context.markerTextures}acquireTechnique(t,e){return this._techniques.acquire(t,this._material.getConfiguration(this._output,e))}ensureResources(t){return n.Am.LOADED}}},52798:function(t,e,i){"use strict";i.d(e,{c:function(){return r}});var n=i(54407);class r{constructor(t,e){this._material=t,this._repository=e,this._map=new Map}dispose(){this._map.forEach(((t,e)=>{null!=t&&this._repository.release(this._material,e)}))}load(t,e,i){const r=this._material.produces.get(e);if(!r?.(i))return null;this._map.has(i)||this._map.set(i,this._repository.acquire(this._material,e,i));const s=this._map.get(i);if(null!=s){if(s.ensureResources(t)===n.Am.LOADED)return s;this._repository.requestRender()}return null}}},36634:function(t,e,i){"use strict";i.d(e,{NV:function(){return c},m8:function(){return h}});var n=i(95929),r=i(60539),s=i(39506),o=i(54407),a=i(4875);class h extends a.A{constructor(t){super(t),this._numLoading=0,this._disposed=!1,this._textures=t.textures,this._textureId=t.textureId,this._acquire(t.textureId,(t=>this._texture=t)),this._acquire(t.normalTextureId,(t=>this._textureNormal=t)),this._acquire(t.emissiveTextureId,(t=>this._textureEmissive=t)),this._acquire(t.occlusionTextureId,(t=>this._textureOcclusion=t)),this._acquire(t.metallicRoughnessTextureId,(t=>this._textureMetallicRoughness=t))}dispose(){super.dispose(),this._texture=(0,n.Gz)(this._texture),this._textureNormal=(0,n.Gz)(this._textureNormal),this._textureEmissive=(0,n.Gz)(this._textureEmissive),this._textureOcclusion=(0,n.Gz)(this._textureOcclusion),this._textureMetallicRoughness=(0,n.Gz)(this._textureMetallicRoughness),this._disposed=!0}ensureResources(t){return 0===this._numLoading?o.Am.LOADED:o.Am.LOADING}get textureBindParameters(){return new c(null!=this._texture?this._texture.glTexture:null,null!=this._textureNormal?this._textureNormal.glTexture:null,null!=this._textureEmissive?this._textureEmissive.glTexture:null,null!=this._textureOcclusion?this._textureOcclusion.glTexture:null,null!=this._textureMetallicRoughness?this._textureMetallicRoughness.glTexture:null)}updateTexture(t){null!=this._texture&&t===this._texture.id||(this._texture=(0,n.Gz)(this._texture),this._textureId=t,this._acquire(this._textureId,(t=>this._texture=t)))}_acquire(t,e){if(null==t)return void e(null);const i=this._textures.acquire(t);if((0,r.$X)(i))return++this._numLoading,void i.then((t=>{if(this._disposed)return(0,n.Gz)(t),void e(null);e(t)})).finally((()=>--this._numLoading));e(i)}}class l extends s.Y{constructor(t=null){super(),this.textureEmissive=t}}class c extends l{constructor(t=null,e=null,i=null,n=null,r=null,s,o){super(i),this.texture=t,this.textureNormal=e,this.textureOcclusion=n,this.textureMetallicRoughness=r,this.scale=s,this.normalTextureTransformMatrix=o}}},89769:function(t,e,i){"use strict";i.d(e,{V:function(){return _}});var n=i(39714),r=i(20551),s=i(37819),o=i(89932),a=i(53905),h=i(48015),l=i(40359),c=i(32501),u=i(67496);const d=(0,c.vt)(),f=(0,c.vt)(),p=(0,c.vt)(),g=(0,c.vt)();var v=i(84321),m=i(90553),y=i(65839);class _ extends h.J{constructor(t,e,i=null,n=l.X.Mesh,r=null,o=-1){super(),this.material=t,this.mapPositions=i,this.type=n,this.objectAndLayerIdColor=r,this.edgeIndicesLength=o,this.highlights=new Set,this._highlightGroupCounts=new Map,this.visible=!0,this._attributes=new Map,this._boundingInfo=null;for(const[t,i]of e)this._attributes.set(t,{...i,indices:(0,s.Dg)(i.indices)}),t===y.r.POSITION&&(this.edgeIndicesLength=this.edgeIndicesLength<0?this._attributes.get(t).indices.length:this.edgeIndicesLength)}instantiate(t={}){const e=new _(t.material||this.material,[],this.mapPositions,this.type,this.objectAndLayerIdColor,this.edgeIndicesLength);return this._attributes.forEach(((t,i)=>{t.exclusive=!1,e._attributes.set(i,t)})),e._boundingInfo=this._boundingInfo,e.transformation=t.transformation||this.transformation,e}get attributes(){return this._attributes}getMutableAttribute(t){let e=this._attributes.get(t);return e&&!e.exclusive&&(e={...e,exclusive:!0,data:(0,o.S)(e.data)},this._attributes.set(t,e)),e}setAttributeData(t,e){const i=this._attributes.get(t);i&&this._attributes.set(t,{...i,exclusive:!0,data:e})}get indexCount(){const t=this._attributes.values().next().value.indices;return t?.length??0}get faceCount(){return this.indexCount/3}get boundingInfo(){return null==this._boundingInfo&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}computeAttachmentOrigin(t){return!!(this.type===l.X.Mesh?this._computeAttachmentOriginTriangles(t):this.type===l.X.Line?this._computeAttachmentOriginLines(t):this._computeAttachmentOriginPoints(t))&&(null!=this._transformation&&(0,r.t)(t,t,this._transformation),!0)}_computeAttachmentOriginTriangles(t){return function(t,e){if(!t)return!1;const{size:i,data:n,indices:s}=t;(0,r.i)(e,0,0,0),(0,r.i)(g,0,0,0);let o=0,a=0;for(let t=0;t<s.length-2;t+=3){const h=s[t]*i,l=s[t+1]*i,c=s[t+2]*i;(0,r.i)(d,n[h],n[h+1],n[h+2]),(0,r.i)(f,n[l],n[l+1],n[l+2]),(0,r.i)(p,n[c],n[c+1],n[c+2]);const v=(0,u.Q7)(d,f,p);v?((0,r.g)(d,d,f),(0,r.g)(d,d,p),(0,r.h)(d,d,1/3*v),(0,r.g)(e,e,d),o+=v):((0,r.g)(g,g,d),(0,r.g)(g,g,f),(0,r.g)(g,g,p),a+=3)}return!(0===a&&0===o||(0!==o?((0,r.h)(e,e,1/o),0):0===a||((0,r.h)(e,g,1/a),0)))}(this.attributes.get(y.r.POSITION),t)}_computeAttachmentOriginLines(t){const e=this.attributes.get(y.r.POSITION);return function(t,e,i){if(!t)return!1;(0,r.i)(i,0,0,0),(0,r.i)(g,0,0,0);let n=0,s=0;const{size:o,data:a,indices:h}=t,l=h.length-1,c=l+(e?2:0);for(let t=0;t<c;t+=2){const e=t<l?t+1:0,c=h[t<l?t:l]*o,u=h[e]*o;d[0]=a[c],d[1]=a[c+1],d[2]=a[c+2],f[0]=a[u],f[1]=a[u+1],f[2]=a[u+2],(0,r.h)(d,(0,r.g)(d,d,f),.5);const p=(0,r.F)(d,f);p>0?((0,r.g)(i,i,(0,r.h)(d,d,p)),n+=p):0===n&&((0,r.g)(g,g,d),s++)}return 0!==n?((0,r.h)(i,i,1/n),!0):0!==s&&((0,r.h)(i,g,1/s),!0)}(e,function(t,e){return!(!("isClosed"in t)||!t.isClosed)&&e.indices.length>2}(this.material.parameters,e),t)}_computeAttachmentOriginPoints(t){return function(t,e){if(!t)return!1;const{size:i,data:n,indices:s}=t;(0,r.i)(e,0,0,0);let o=-1,a=0;for(let t=0;t<s.length;t++){const r=s[t]*i;o!==r&&(e[0]+=n[r],e[1]+=n[r+1],e[2]+=n[r+2],a++),o=r}return a>1&&(0,r.h)(e,e,1/a),a>0}(this.attributes.get(y.r.POSITION),t)}invalidateBoundingInfo(){this._boundingInfo=null}_calculateBoundingInfo(){const t=this.attributes.get(y.r.POSITION);if(!t||0===t.indices.length)return null;const e=this.type===l.X.Mesh?3:1;(0,m.vA)(t.indices.length%e==0,"Indexing error: "+t.indices.length+" not divisible by "+e);const i=(0,s.tM)(t.indices.length/e);return new a.j(i,e,t)}get transformation(){return this._transformation??n.zK}set transformation(t){this._transformation=t&&t!==n.zK?(0,n.o8)(t):null}get highlightGroups(){return this._highlightGroupCounts}get hasHighlights(){return this._highlightGroupCounts.size>0}foreachHighlightGroup(t){this._highlightGroupCounts.forEach(((e,i)=>t(i)))}allocateIdAndHighlight(t){const e=new v.h(t);return this.addHighlight(e)}addHighlight(t){this.highlights.add(t);const{highlightGroupName:e}=t,i=(this._highlightGroupCounts.get(e)??0)+1;return this._highlightGroupCounts.set(e,i),t}removeHighlight(t){if(this.highlights.delete(t)){const{highlightGroupName:e}=t,i=this._highlightGroupCounts.get(e)??0;i<=1?this._highlightGroupCounts.delete(e):this._highlightGroupCounts.set(e,i-1)}}}},8470:function(t,e,i){"use strict";i.d(e,{zC:function(){return nt},C1:function(){return A},EE:function(){return X},YG:function(){return Y},nW:function(){return K},td:function(){return O},_B:function(){return et},Nq:function(){return Q},DJ:function(){return W},uX:function(){return $},Z8:function(){return tt},CM:function(){return U},Gj:function(){return Z},Ho:function(){return V},Nb:function(){return J},Xl:function(){return st},xh:function(){return it}});var n,r=i(20551),s=i(43274),o=i(32501),a=i(50240),h=i(5047),l=i(37819),c=i(5596),u=i(79578),d=i(14905);!function(t){t.length=function(t,e){const i=t[e],n=t[e+1],r=t[e+2];return Math.sqrt(i*i+n*n+r*r)},t.normalize=function(t,e){const i=t[e],n=t[e+1],r=t[e+2],s=1/Math.sqrt(i*i+n*n+r*r);t[e]*=s,t[e+1]*=s,t[e+2]*=s},t.scale=function(t,e,i){t[e]*=i,t[e+1]*=i,t[e+2]*=i},t.add=function(t,e,i,n,r,s=e){(r=r||t)[s]=t[e]+i[n],r[s+1]=t[e+1]+i[n+1],r[s+2]=t[e+2]+i[n+2]},t.subtract=function(t,e,i,n,r,s=e){(r=r||t)[s]=t[e]-i[n],r[s+1]=t[e+1]-i[n+1],r[s+2]=t[e+2]-i[n+2]}}(n||(n={}));var f=i(40359),p=i(89769),g=i(90553),v=i(65839);const m=n,y=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],_=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],b=[0,0,1,0,1,1,0,1],w=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],x=new Array(36);for(let t=0;t<6;t++)for(let e=0;e<6;e++)x[6*t+e]=t;const T=new Array(36);for(let t=0;t<6;t++)T[6*t]=0,T[6*t+1]=1,T[6*t+2]=2,T[6*t+3]=2,T[6*t+4]=3,T[6*t+5]=0;function A(t,e){Array.isArray(e)||(e=[e,e,e]);const i=new Array(24);for(let t=0;t<8;t++)i[3*t]=y[t][0]*e[0],i[3*t+1]=y[t][1]*e[1],i[3*t+2]=y[t][2]*e[2];return new p.V(t,[[v.r.POSITION,new d.n(i,w,3,!0)],[v.r.NORMAL,new d.n(_,x,3)],[v.r.UV0,new d.n(b,T,2)]])}const M=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],S=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],E=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],C=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function O(t,e){Array.isArray(e)||(e=[e,e,e]);const i=new Array(18);for(let t=0;t<6;t++)i[3*t]=M[t][0]*e[0],i[3*t+1]=M[t][1]*e[1],i[3*t+2]=M[t][2]*e[2];return new p.V(t,[[v.r.POSITION,new d.n(i,E,3,!0)],[v.r.NORMAL,new d.n(S,C,3)]])}const R=(0,s.fA)(-.5,0,-.5),I=(0,s.fA)(.5,0,-.5),P=(0,s.fA)(0,0,.5),N=(0,s.fA)(0,.5,0),D=(0,s.vt)(),L=(0,s.vt)(),z=(0,s.vt)(),j=(0,s.vt)(),k=(0,s.vt)();(0,r.d)(D,R,N),(0,r.d)(L,R,I),(0,r.e)(z,D,L),(0,r.n)(z,z),(0,r.d)(D,I,N),(0,r.d)(L,I,P),(0,r.e)(j,D,L),(0,r.n)(j,j),(0,r.d)(D,P,N),(0,r.d)(L,P,R),(0,r.e)(k,D,L),(0,r.n)(k,k);const F=[R,I,P,N],H=[0,-1,0,z[0],z[1],z[2],j[0],j[1],j[2],k[0],k[1],k[2]],B=[0,1,2,3,1,0,3,2,1,3,0,2],G=[0,0,0,1,1,1,2,2,2,3,3,3];function V(t,e){Array.isArray(e)||(e=[e,e,e]);const i=new Array(12);for(let t=0;t<4;t++)i[3*t]=F[t][0]*e[0],i[3*t+1]=F[t][1]*e[1],i[3*t+2]=F[t][2]*e[2];return new p.V(t,[[v.r.POSITION,new d.n(i,B,3,!0)],[v.r.NORMAL,new d.n(H,G,3)]])}function U(t,e,i,n,r={uv:!0}){const s=-Math.PI,o=2*Math.PI,a=-Math.PI/2,c=Math.PI,u=Math.max(3,Math.floor(i)),f=Math.max(2,Math.floor(n)),g=(u+1)*(f+1),m=(0,h.oe)(3*g),y=(0,h.oe)(3*g),_=(0,h.oe)(2*g),b=[];let w=0;for(let t=0;t<=f;t++){const i=[],n=t/f,r=a+n*c,h=Math.cos(r);for(let t=0;t<=u;t++){const a=t/u,l=s+a*o,c=Math.cos(l)*h,d=Math.sin(r),f=-Math.sin(l)*h;m[3*w]=c*e,m[3*w+1]=d*e,m[3*w+2]=f*e,y[3*w]=c,y[3*w+1]=d,y[3*w+2]=f,_[2*w]=a,_[2*w+1]=n,i.push(w),++w}b.push(i)}const x=new Array;for(let t=0;t<f;t++)for(let e=0;e<u;e++){const i=b[t][e],n=b[t][e+1],r=b[t+1][e+1],s=b[t+1][e];0===t?(x.push(i),x.push(r),x.push(s)):t===f-1?(x.push(i),x.push(n),x.push(r)):(x.push(i),x.push(n),x.push(r),x.push(r),x.push(s),x.push(i))}const T=[[v.r.POSITION,new d.n(m,x,3,!0)],[v.r.NORMAL,new d.n(y,x,3,!0)]];return r.uv&&T.push([v.r.UV0,new d.n(_,x,2,!0)]),r.offset&&(T[0][0]=v.r.OFFSET,T.push([v.r.POSITION,new d.n(Float64Array.from(r.offset),(0,l.EH)(x.length),3,!0)])),new p.V(t,T)}function $(t,e,i,n){const r=function(t,e,i){const n=t;let r,s;if(i)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],s=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{const t=n*(1+Math.sqrt(5))/2;r=[-n,t,0,n,t,0,-n,-t,0,n,-t,0,0,-n,t,0,n,t,0,-n,-t,0,n,-t,t,0,-n,t,0,n,-t,0,-n,-t,0,n],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let e=0;e<r.length;e+=3)m.scale(r,e,t/m.length(r,e));let o={};function a(e,i){e>i&&([e,i]=[i,e]);const n=e.toString()+"."+i.toString();if(o[n])return o[n];let s=r.length;return r.length+=3,m.add(r,3*e,r,3*i,r,s),m.scale(r,s,t/m.length(r,s)),s/=3,o[n]=s,s}for(let t=0;t<e;t++){const t=s.length,e=new Array(4*t);for(let i=0;i<t;i+=3){const t=s[i],n=s[i+1],r=s[i+2],o=a(t,n),h=a(n,r),l=a(r,t),c=4*i;e[c]=t,e[c+1]=o,e[c+2]=l,e[c+3]=n,e[c+4]=h,e[c+5]=o,e[c+6]=r,e[c+7]=l,e[c+8]=h,e[c+9]=o,e[c+10]=h,e[c+11]=l}s=e,o={}}const l=(0,h.Wz)(r);for(let t=0;t<l.length;t+=3)m.normalize(l,t);return[[v.r.POSITION,new d.n((0,h.Wz)(r),s,3,!0)],[v.r.NORMAL,new d.n(l,s,3,!0)]]}(e,i,n);return new p.V(t,r)}function W(t,e,i,n,r,s,a,h,c,u=null){const g=i?(0,o.o8)(i):(0,o.vt)(),m=e?(0,o.o8)(e):(0,o.fA)(0,0,1),y=n?[255*n[0],255*n[1],255*n[2],n.length>3?255*n[3]:255]:[255,255,255,255],_=null!=s&&2===s.length?s:[1,1],b=null!=r?[r]:[0],w=(0,l.EH)(1),x=[[v.r.POSITION,new d.n(g,w,3,!0)],[v.r.NORMAL,new d.n(m,w,3,!0)],[v.r.COLOR,new d.n(y,w,4,!0)],[v.r.SIZE,new d.n(_,w,2)],[v.r.ROTATION,new d.n(b,w,1,!0)]];if(h&&x.push([v.r.UV0,new d.n(h,w,h.length)]),null!=a&&(a=[a[0],a[1],a[2],a[3]],x.push([v.r.CENTEROFFSETANDDISTANCE,new d.n(a,w,4)])),c){const t=[c[0],c[1],c[2],c[3]];x.push([v.r.FEATUREATTRIBUTE,new d.n(t,w,4)])}return new p.V(t,x,null,f.X.Point,u)}const q=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function Z(t,e=q){const i=new Array(12);for(let t=0;t<4;t++)for(let n=0;n<3;n++)i[3*t+n]=e[t][n];const n=[0,1,2,2,3,0],r=[0,0,0,0,0,0],s=[[v.r.POSITION,new d.n(i,n,3,!0)],[v.r.NORMAL,new d.n([0,0,1],r,3,!0)],[v.r.UV0,new d.n([0,0,1,0,1,1,0,1],n,2,!0)],[v.r.COLOR,new d.n([255,255,255,255],r,4,!0)]];return new p.V(t,s)}function Y(t,e,i,n,r=!0,o=!0){let a=0;const l=e,c=t;let u=(0,s.fA)(0,a,0),f=(0,s.fA)(0,a+c,0),p=(0,s.fA)(0,-1,0),g=(0,s.fA)(0,1,0);n&&(a=c,f=(0,s.fA)(0,0,0),u=(0,s.fA)(0,a,0),p=(0,s.fA)(0,1,0),g=(0,s.fA)(0,-1,0));const m=[f,u],y=[p,g],_=i+2,b=Math.sqrt(c*c+l*l);if(n)for(let t=i-1;t>=0;t--){const e=t*(2*Math.PI/i),n=(0,s.fA)(Math.cos(e)*l,a,Math.sin(e)*l);m.push(n);const r=(0,s.fA)(c*Math.cos(e)/b,-l/b,c*Math.sin(e)/b);y.push(r)}else for(let t=0;t<i;t++){const e=t*(2*Math.PI/i),n=(0,s.fA)(Math.cos(e)*l,a,Math.sin(e)*l);m.push(n);const r=(0,s.fA)(c*Math.cos(e)/b,l/b,c*Math.sin(e)/b);y.push(r)}const w=new Array,x=new Array;if(r){for(let t=3;t<m.length;t++)w.push(1),w.push(t-1),w.push(t),x.push(0),x.push(0),x.push(0);w.push(m.length-1),w.push(2),w.push(1),x.push(0),x.push(0),x.push(0)}if(o){for(let t=3;t<m.length;t++)w.push(t),w.push(t-1),w.push(0),x.push(t),x.push(t-1),x.push(1);w.push(0),w.push(2),w.push(m.length-1),x.push(1),x.push(2),x.push(y.length-1)}const T=(0,h.oe)(3*_);for(let t=0;t<_;t++)T[3*t]=m[t][0],T[3*t+1]=m[t][1],T[3*t+2]=m[t][2];const A=(0,h.oe)(3*_);for(let t=0;t<_;t++)A[3*t]=y[t][0],A[3*t+1]=y[t][1],A[3*t+2]=y[t][2];return[[v.r.POSITION,new d.n(T,w,3,!0)],[v.r.NORMAL,new d.n(A,x,3,!0)]]}function X(t,e,i,n,r,s=!0,o=!0){return new p.V(t,Y(e,i,n,r,s,o))}function K(t,e,i,n,o,a,l){const c=o?(0,s.o8)(o):(0,s.fA)(1,0,0),u=a?(0,s.o8)(a):(0,s.fA)(0,0,0);l??=!0;const f=(0,s.vt)();(0,r.n)(f,c);const g=(0,s.vt)();(0,r.h)(g,f,Math.abs(e));const m=(0,s.vt)();(0,r.h)(m,g,-.5),(0,r.g)(m,m,u);const y=(0,s.fA)(0,1,0);Math.abs(1-(0,r.f)(f,y))<.2&&(0,r.i)(y,0,0,1);const _=(0,s.vt)();(0,r.e)(_,f,y),(0,r.n)(_,_),(0,r.e)(y,_,f);const b=2*n+(l?2:0),w=n+(l?2:0),x=(0,h.oe)(3*b),T=(0,h.oe)(3*w),A=(0,h.oe)(2*b),M=new Array(3*n*(l?4:2)),S=new Array(3*n*(l?4:2));l&&(x[3*(b-2)]=m[0],x[3*(b-2)+1]=m[1],x[3*(b-2)+2]=m[2],A[2*(b-2)]=0,A[2*(b-2)+1]=0,x[3*(b-1)]=x[3*(b-2)]+g[0],x[3*(b-1)+1]=x[3*(b-2)+1]+g[1],x[3*(b-1)+2]=x[3*(b-2)+2]+g[2],A[2*(b-1)]=1,A[2*(b-1)+1]=1,T[3*(w-2)]=-f[0],T[3*(w-2)+1]=-f[1],T[3*(w-2)+2]=-f[2],T[3*(w-1)]=f[0],T[3*(w-1)+1]=f[1],T[3*(w-1)+2]=f[2]);const E=(t,e,i)=>{M[t]=e,S[t]=i};let C=0;const O=(0,s.vt)(),R=(0,s.vt)();for(let t=0;t<n;t++){const e=t*(2*Math.PI/n);(0,r.h)(O,y,Math.sin(e)),(0,r.h)(R,_,Math.cos(e)),(0,r.g)(O,O,R),T[3*t]=O[0],T[3*t+1]=O[1],T[3*t+2]=O[2],(0,r.h)(O,O,i),(0,r.g)(O,O,m),x[3*t]=O[0],x[3*t+1]=O[1],x[3*t+2]=O[2],A[2*t]=t/n,A[2*t+1]=0,x[3*(t+n)]=x[3*t]+g[0],x[3*(t+n)+1]=x[3*t+1]+g[1],x[3*(t+n)+2]=x[3*t+2]+g[2],A[2*(t+n)]=t/n,A[2*t+1]=1;const s=(t+1)%n;E(C++,t,t),E(C++,t+n,t),E(C++,s,s),E(C++,s,s),E(C++,t+n,t),E(C++,s+n,s)}if(l){for(let t=0;t<n;t++){const e=(t+1)%n;E(C++,b-2,w-2),E(C++,t,w-2),E(C++,e,w-2)}for(let t=0;t<n;t++){const e=(t+1)%n;E(C++,t+n,w-1),E(C++,b-1,w-1),E(C++,e+n,w-1)}}const I=[[v.r.POSITION,new d.n(x,M,3,!0)],[v.r.NORMAL,new d.n(T,S,3,!0)],[v.r.UV0,new d.n(A,M,2,!0)]];return new p.V(t,I)}function J(t,e,i,n,r,s){n=n||10,r=null==r||r,(0,g.vA)(e.length>1);const o=[],a=[];for(let t=0;t<n;t++){o.push([0,-t-1,-(t+1)%n-1]);const e=t/n*2*Math.PI;a.push([Math.cos(e)*i,Math.sin(e)*i])}return Q(t,a,e,[[0,0,0]],o,r,s)}function Q(t,e,i,n,a,l,f=(0,s.fA)(0,0,0)){const g=e.length,m=(0,h.oe)(i.length*g*3+(6*n.length||0)),y=(0,h.oe)(i.length*g*3+(n?6:0)),_=new Array,b=new Array;let w=0,x=0;const T=(0,o.vt)(),A=(0,o.vt)(),M=(0,o.vt)(),S=(0,o.vt)(),E=(0,o.vt)(),C=(0,o.vt)(),O=(0,o.vt)(),R=(0,o.vt)(),I=(0,o.vt)(),P=(0,o.vt)(),N=(0,o.vt)(),D=(0,o.vt)(),L=(0,o.vt)(),z=(0,c.vt)();(0,r.i)(I,0,1,0),(0,r.d)(A,i[1],i[0]),(0,r.n)(A,A),l?((0,r.g)(R,i[0],f),(0,r.n)(M,R)):(0,r.i)(M,0,0,1),st(A,M,I,I,E,M,ot),(0,r.c)(S,M),(0,r.c)(D,E);for(let t=0;t<n.length;t++)(0,r.h)(C,E,n[t][0]),(0,r.h)(R,M,n[t][2]),(0,r.g)(C,C,R),(0,r.g)(C,C,i[0]),m[w++]=C[0],m[w++]=C[1],m[w++]=C[2];y[x++]=-A[0],y[x++]=-A[1],y[x++]=-A[2];for(let t=0;t<a.length;t++)_.push(a[t][0]>0?a[t][0]:-a[t][0]-1+n.length),_.push(a[t][1]>0?a[t][1]:-a[t][1]-1+n.length),_.push(a[t][2]>0?a[t][2]:-a[t][2]-1+n.length),b.push(0),b.push(0),b.push(0);let j=n.length;const k=n.length-1;for(let t=0;t<i.length;t++){let n=!1;t>0&&((0,r.c)(T,A),t<i.length-1?((0,r.d)(A,i[t+1],i[t]),(0,r.n)(A,A)):n=!0,(0,r.g)(P,T,A),(0,r.n)(P,P),(0,r.g)(N,i[t-1],S),(0,c.O_)(i[t],P,z),(0,c.Ui)(z,(0,u.LV)(N,T),R)?((0,r.d)(R,R,i[t]),(0,r.n)(M,R),(0,r.e)(E,P,M),(0,r.n)(E,E)):st(P,S,D,I,E,M,ot),(0,r.c)(S,M),(0,r.c)(D,E)),l&&((0,r.g)(R,i[t],f),(0,r.n)(L,R));for(let s=0;s<g;s++)if((0,r.h)(C,E,e[s][0]),(0,r.h)(R,M,e[s][1]),(0,r.g)(C,C,R),(0,r.n)(O,C),y[x++]=O[0],y[x++]=O[1],y[x++]=O[2],(0,r.g)(C,C,i[t]),m[w++]=C[0],m[w++]=C[1],m[w++]=C[2],!n){const t=(s+1)%g;_.push(j+s),_.push(j+g+s),_.push(j+t),_.push(j+t),_.push(j+g+s),_.push(j+g+t);for(let t=0;t<6;t++){const e=_.length-6;b.push(_[e+t]-k)}}j+=g}const F=i[i.length-1];for(let t=0;t<n.length;t++)(0,r.h)(C,E,n[t][0]),(0,r.h)(R,M,n[t][1]),(0,r.g)(C,C,R),(0,r.g)(C,C,F),m[w++]=C[0],m[w++]=C[1],m[w++]=C[2];const H=x/3;y[x++]=A[0],y[x++]=A[1],y[x++]=A[2];const B=j-g;for(let t=0;t<a.length;t++)_.push(a[t][0]>=0?j+a[t][0]:-a[t][0]-1+B),_.push(a[t][2]>=0?j+a[t][2]:-a[t][2]-1+B),_.push(a[t][1]>=0?j+a[t][1]:-a[t][1]-1+B),b.push(H),b.push(H),b.push(H);const G=[[v.r.POSITION,new d.n(m,_,3,!0)],[v.r.NORMAL,new d.n(y,b,3,!0)]];return new p.V(t,G)}function tt(t,e,i,n){(0,g.vA)(e.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),(0,g.vA)(3===e[0].length,"createPolylineGeometry(): malformed vertex"),(0,g.vA)(null==i||i.length===e.length,"createPolylineGeometry: need same number of points and normals"),(0,g.vA)(null==i||3===i[0].length,"createPolylineGeometry(): malformed normal");const r=(0,a.jh)(3*e.length),s=new Array(2*(e.length-1));let o=0,c=0;for(let t=0;t<e.length;t++){for(let i=0;i<3;i++)r[o++]=e[t][i];t>0&&(s[c++]=t-1,s[c++]=t)}const u=[[v.r.POSITION,new d.n(r,s,3,!0)]];if(i){const t=(0,h.oe)(3*i.length);let n=0;for(let r=0;r<e.length;r++)for(let e=0;e<3;e++)t[n++]=i[r][e];u.push([v.r.NORMAL,new d.n(t,s,3,!0)])}return n&&u.push([v.r.COLOR,new d.n(n,(0,l.tM)(n.length/4),4)]),new p.V(t,u,null,f.X.Line)}function et(t,e,i,n,r,s=0){const o=new Array(18),a=[[-i,s,r/2],[n,s,r/2],[0,e+s,r/2],[-i,s,-r/2],[n,s,-r/2],[0,e+s,-r/2]];for(let t=0;t<6;t++)o[3*t]=a[t][0],o[3*t+1]=a[t][1],o[3*t+2]=a[t][2];return new p.V(t,[[v.r.POSITION,new d.n(o,[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5],3,!0)]])}function it(t,e){const i=t.getMutableAttribute(v.r.POSITION).data;for(let t=0;t<i.length;t+=3){const n=i[t],s=i[t+1],o=i[t+2];(0,r.i)(at,n,s,o),(0,r.t)(at,at,e),i[t]=at[0],i[t+1]=at[1],i[t+2]=at[2]}}function nt(t,e=t){const i=t.attributes,n=i.get(v.r.POSITION).data,r=i.get(v.r.NORMAL).data;if(r){const t=e.getMutableAttribute(v.r.NORMAL).data;for(let e=0;e<r.length;e+=3){const i=r[e+1];t[e+1]=-r[e+2],t[e+2]=i}}if(n){const t=e.getMutableAttribute(v.r.POSITION).data;for(let e=0;e<n.length;e+=3){const i=n[e+1];t[e+1]=-n[e+2],t[e+2]=i}}}function rt(t,e,i,n,s){return!(Math.abs((0,r.f)(e,t))>s||((0,r.e)(i,t,e),(0,r.n)(i,i),(0,r.e)(n,i,t),(0,r.n)(n,n),0))}function st(t,e,i,n,r,s,o){return rt(t,e,r,s,o)||rt(t,i,r,s,o)||rt(t,n,r,s,o)}const ot=.99619469809,at=(0,o.vt)()},19860:function(t,e,i){"use strict";i.d(e,{g:function(){return m}}),i(58941);var n=i(11231),r=i(20551),s=i(32501),o=i(41546),a=i(57617),h=i(14905),l=i(40359),c=i(89769),u=i(79068),d=i(10713),f=i(10228),p=i(65839),g=i(1296),v=i(65352);class m{constructor(t){this._originSR=t,this._rootOriginId="root/"+(0,n.c)(),this._origins=new Map,this._objects=new Map,this._gridSize=5e5}getOrigin(t){const e=this._origins.get(this._rootOriginId);if(null==e){const e=f.Q.rootOrigin;if(null!=e)return this._origins.set(this._rootOriginId,(0,u.f)(e[0],e[1],e[2],this._rootOriginId)),this.getOrigin(t);const i=(0,u.f)(t[0]+Math.random()-.5,t[1]+Math.random()-.5,t[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,i),i}const i=this._gridSize,n=Math.round(t[0]/i),s=Math.round(t[1]/i),o=Math.round(t[2]/i),a=`${n}/${s}/${o}`;let h=this._origins.get(a);const l=.5*i;if((0,r.d)(y,t,e.vec3),y[0]=Math.abs(y[0]),y[1]=Math.abs(y[1]),y[2]=Math.abs(y[2]),y[0]<l&&y[1]<l&&y[2]<l){if(h){const e=Math.max(...y);if((0,r.d)(y,t,h.vec3),y[0]=Math.abs(y[0]),y[1]=Math.abs(y[1]),y[2]=Math.abs(y[2]),Math.max(...y)<e)return h}return e}return h||(h=(0,u.f)(n*i,s*i,o*i,a),this._origins.set(a,h)),h}_drawOriginBox(t,e=(0,o.fA)(1,1,0,1)){const i=window.view,n=i._stage,r=e.toString();if(!this._objects.has(r)){this._material=new v.W({width:2,color:e}),n.add(this._material);const t=new g.x(n,{pickable:!1}),i=new d.B({castShadow:!1});n.add(i),t.add(i),this._objects.set(r,i)}const s=this._objects.get(r),u=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],f=u.length,m=new Array(3*f),y=new Array,_=.5*this._gridSize;for(let e=0;e<f;e++)m[3*e]=t[0]+(1&u[e]?_:-_),m[3*e+1]=t[1]+(2&u[e]?_:-_),m[3*e+2]=t[2]+(4&u[e]?_:-_),e>0&&y.push(e-1,e);(0,a.projectBuffer)(m,this._originSR,0,m,i.renderSpatialReference,0,f);const b=new c.V(this._material,[[p.r.POSITION,new h.n(m,y,3,!0)]],null,l.X.Line);n.add(b),s.addGeometry(b)}get test(){}}const y=(0,s.vt)()},49845:function(t,e,i){"use strict";i.d(e,{G7:function(){return x},hz:function(){return y}});var n=i(73364),r=i(39714),s=i(20551),o=i(32501),a=i(33400),h=i(41546),l=i(79578),c=i(65420),u=i(38177),d=i(50456),f=i(59356),p=i(22323);const g=1e-5;class v{constructor(t){this.options=new u.H6,this._results=new _,this.transform=new p.dg,this.tolerance=g,this.verticalOffset=null,this._ray=(0,l.vt)(),this._rayEnd=(0,o.vt)(),this._rayBeginTransformed=(0,o.vt)(),this._rayEndTransformed=(0,o.vt)(),this.viewingMode=t??c.RT.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(t,e,i){this.resetWithRay((0,l.Cr)(t,e,this._ray),i)}resetWithRay(t,e){this.camera=e,t!==this._ray&&(0,l.C)(t,this._ray),0!==this.options.verticalOffset?this.viewingMode===c.RT.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,(0,s.g)(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(t=null,e,i,n,r){this.point=e,this.filterPredicate=n,this.tolerance=i??g;const s=(0,p.ou)(this.verticalOffset);if(t&&t.length>0){const e=r?t=>{r(t)&&this.intersectObject(t)}:t=>{this.intersectObject(t)};for(const i of t){const t=i.getSpatialQueryAccelerator?.();null!=t?(null!=s?t.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,e,s):t.forEachAlongRay(this._ray.origin,this._ray.direction,e),this.options.selectionMode&&this.options.hud&&t.forEachDegenerateObject(e)):i.objects.forAll((t=>e(t)))}}this.sortResults()}intersectObject(t){const e=t.geometries;if(!e)return;const i=t.effectiveTransformation,n=(0,p.ou)(this.verticalOffset);for(const o of e){if(!o.visible)continue;const{material:e,id:a}=o;if(!e.visible)continue;this.transform.setAndInvalidateLazyTransforms(i,o.transformation),(0,s.t)(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),(0,s.t)(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const h=this.transform.transform;null!=n&&(n.objectTransform=this.transform),e.intersect(o,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,((e,i,n,s,o,l)=>{if(e>=0){if(null!=this.filterPredicate&&!this.filterPredicate(this._ray.origin,this._rayEnd,e))return;const c=s?this._results.hud:this._results,f=s?s=>{const h=new d.B$(t,a,n,l);s.set(u.dz.HUD,h,e,i,r.zK,o)}:r=>r.set(u.dz.OBJECT,{object:t,geometryId:a,triangleNr:n},e,i,h,o);if((null==c.min.drapedLayerOrder||o>=c.min.drapedLayerOrder)&&(null==c.min.dist||e<c.min.dist)&&f(c.min),this.options.store!==u.oH.MIN&&(null==c.max.drapedLayerOrder||o<c.max.drapedLayerOrder)&&(null==c.max.dist||e>c.max.dist)&&f(c.max),this.options.store===u.oH.ALL)if(s){const t=new w(this._ray);f(t),this._results.hud.all.push(t)}else{const t=new b(this._ray);f(t),this._results.all.push(t)}}}))}}sortResults(t=this._results.all){t.sort(((t,e)=>t.dist!==e.dist?(t.dist??0)-(e.dist??0):t.drapedLayerOrder!==e.drapedLayerOrder?m(t.drapedLayerOrder,e.drapedLayerOrder):m(t.drapedLayerGraphicOrder,e.drapedLayerGraphicOrder)))}}function m(t,e){return(e??-Number.MAX_VALUE)-(t??-Number.MAX_VALUE)}function y(t){return new v(t)}class _{constructor(){this.min=new b((0,l.vt)()),this.max=new b((0,l.vt)()),this.hud={min:new w((0,l.vt)()),max:new w((0,l.vt)()),all:new Array},this.ground=new b((0,l.vt)()),this.all=[]}init(t){this.min.init(t),this.max.init(t),this.ground.init(t),this.all.length=0,this.hud.min.init(t),this.hud.max.init(t),this.hud.all.length=0}}class b{get ray(){return this._ray}get distanceInRenderSpace(){return null!=this.dist?((0,s.h)(T,this.ray.direction,this.dist),(0,s.l)(T)):null}getIntersectionPoint(t){return!!(0,f.i3)(this)&&((0,s.h)(T,this.ray.direction,this.dist),(0,s.g)(t,this.ray.origin,T),!0)}getTransformedNormal(t){return(0,s.c)(A,this.normal),A[3]=0,(0,a.t)(A,A,this.transformation),(0,s.c)(t,A),(0,s.n)(t,t)}constructor(t){this.intersector=u.dz.OBJECT,this.normal=(0,o.vt)(),this.transformation=(0,r.vt)(),this._ray=(0,l.vt)(),this.init(t)}init(t){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=u.dz.OBJECT,(0,l.C)(t,this._ray)}set(t,e,i,a,h,l,c){this.intersector=t,this.dist=i,(0,s.c)(this.normal,a??o.Cb),(0,n.C)(this.transformation,h??r.zK),this.target=e,this.drapedLayerOrder=l,this.drapedLayerGraphicOrder=c}copy(t){(0,l.C)(t.ray,this._ray),this.intersector=t.intersector,this.dist=t.dist,this.target=t.target,this.drapedLayerOrder=t.drapedLayerOrder,this.drapedLayerGraphicOrder=t.drapedLayerGraphicOrder,(0,s.c)(this.normal,t.normal),(0,n.C)(this.transformation,t.transformation)}}class w extends b{constructor(){super(...arguments),this.intersector=u.dz.HUD}}function x(t){return new b(t)}const T=(0,o.vt)(),A=(0,h.vt)()},38177:function(t,e,i){"use strict";var n,r;i.d(e,{H6:function(){return s},dz:function(){return n},oH:function(){return r}}),function(t){t[t.OBJECT=0]="OBJECT",t[t.HUD=1]="HUD",t[t.TERRAIN=2]="TERRAIN",t[t.OVERLAY=3]="OVERLAY",t[t.I3S=4]="I3S",t[t.PCL=5]="PCL",t[t.LOD=6]="LOD",t[t.VOXEL=7]="VOXEL",t[t.TILES3D=8]="TILES3D"}(n||(n={}));class s{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.filteredLayerUids=[],this.store=r.ALL,this.normalRequired=!0,this.excludeLabels=!1}}!function(t){t[t.MIN=0]="MIN",t[t.MINMAX=1]="MINMAX",t[t.ALL=2]="ALL"}(r||(r={}))},50456:function(t,e,i){"use strict";i.d(e,{B$:function(){return s},HE:function(){return o},R6:function(){return a}});var n=i(32501);class r{constructor(t,e,i){this.object=t,this.geometryId=e,this.triangleNr=i}}class s extends r{constructor(t,e,i,r){super(t,e,i),this.center=null!=r?(0,n.o8)(r):null}}class o{constructor(t){this.layerUid=t}}class a extends o{constructor(t,e){super(t),this.graphicUid=e}}},79068:function(t,e,i){"use strict";i.d(e,{f:function(){return s}});var n=i(32501);class r{constructor(t,e){this.vec3=t,this.id=e}}function s(t,e,i,s){return new r((0,n.fA)(t,e,i),s)}},24100:function(t,e,i){"use strict";i.d(e,{im:function(){return u},m$:function(){return n},qA:function(){return d}});var n,r,s=i(32501),o=i(39506),a=i(48015),h=i(40359),l=i(40502),c=i(84887);class u extends a.J{constructor(t,e){super(),this.type=h.X.Material,this.supportsEdges=!1,this._renderPriority=0,this.vertexAttributeLocations=l.D,this._pp0=(0,s.fA)(0,0,1),this._pp1=(0,s.fA)(0,0,0),this._parameters=new e,(0,c.MB)(this._parameters,t),this.validateParameters(this._parameters)}get parameters(){return this._parameters}update(t){return!1}setParameters(t,e=!0){(0,c.MB)(this._parameters,t)&&(this.validateParameters(this._parameters),e&&this._parametersChanged())}validateParameters(t){}shouldRender(t){return this.visible&&this.isVisibleForOutput(t.output)&&(!this.parameters.isDecoration||t.bind.decorations)&&!!(this.parameters.renderOccluded&t.renderOccludedMask)}isVisibleForOutput(t){return!0}get renderPriority(){return this._renderPriority}set renderPriority(t){t!==this._renderPriority&&(this._renderPriority=t,this._parametersChanged())}_parametersChanged(){this.repository?.materialChanged(this)}queryRenderOccludedState(t){return this.visible&&this.parameters.renderOccluded===t}get hasEmissions(){return!1}intersectDraped(t,e,i,n,r,s){return this._pp0[0]=this._pp1[0]=n[0],this._pp0[1]=this._pp1[1]=n[1],this.intersect(t,e,i,this._pp0,this._pp1,r)}}(r=n||(n={}))[r.None=0]="None",r[r.Occlude=1]="Occlude",r[r.Transparent=2]="Transparent",r[r.OccludeAndTransparent=4]="OccludeAndTransparent",r[r.OccludeAndTransparentStencil=8]="OccludeAndTransparentStencil",r[r.Opaque=16]="Opaque";class d extends o.Y{constructor(){super(...arguments),this.renderOccluded=n.Occlude,this.isDecoration=!1}}},96253:function(t,e,i){"use strict";var n,r;i.d(e,{k:function(){return r},q:function(){return n}}),function(t){t[t.ADD=0]="ADD",t[t.UPDATE=1]="UPDATE",t[t.REMOVE=2]="REMOVE"}(n||(n={})),function(t){t[t.NONE=0]="NONE",t[t.VISIBILITY=1]="VISIBILITY",t[t.GEOMETRY=2]="GEOMETRY",t[t.TRANSFORMATION=4]="TRANSFORMATION",t[t.HIGHLIGHT=8]="HIGHLIGHT",t[t.OCCLUDEE=16]="OCCLUDEE"}(r||(r={}))},54840:function(t,e,i){"use strict";var n;i.d(e,{Y:function(){return n}}),function(t){t[t.NONE=0]="NONE",t[t.ColorAlpha=1]="ColorAlpha",t[t.FrontFace=2]="FrontFace",t[t.COUNT=3]="COUNT"}(n||(n={}))},10713:function(t,e,i){"use strict";i.d(e,{B:function(){return v}}),i(58941);var n=i(73364),r=i(39714),s=i(20551),o=i(32501),a=i(13794),h=i(76185),l=i(54407),c=i(48015),u=i(40359),d=i(84321),f=i(90553),p=i(65839),g=i(84738);class v extends c.J{get geometries(){return this._geometries}get transformation(){return this._transformation??r.zK}set transformation(t){this._transformation=(0,n.C)(this._transformation??(0,r.vt)(),t),this._invalidateBoundingVolume(),this._emit("transformationChanged",this)}get shaderTransformation(){return this._shaderTransformation}set shaderTransformation(t){this._shaderTransformation=t?(0,n.C)(this._shaderTransformation??(0,r.vt)(),t):null,this._invalidateBoundingVolume(),this._emit("shaderTransformationChanged",this)}get effectiveTransformation(){return this.shaderTransformation??this.transformation}constructor(t={}){super(),this.type=u.X.Object,this._shaderTransformation=null,this._parentLayer=null,this._visible=!0,this.castShadow=t.castShadow??!0,this.usesVerticalDistanceToGround=t.usesVerticalDistanceToGround??!1,this.graphicUid=t.graphicUid,this.layerUid=t.layerUid,t.isElevationSource&&(this.lastValidElevationBB=new m),this._geometries=t.geometries?Array.from(t.geometries):new Array}dispose(){this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(t){(0,f.vA)(null==this._parentLayer||null==t,"Object3D can only be added to a single Layer"),this._parentLayer=t}addGeometry(t){t.visible=this._visible,this._geometries.push(t),this._emit("geometryAdded",{object:this,geometry:t}),this._invalidateBoundingVolume()}removeGeometry(t){const e=this._geometries.splice(t,1)[0];e&&(this._emit("geometryRemoved",{object:this,geometry:e}),this._invalidateBoundingVolume())}removeAllGeometries(){for(;this._geometries.length>0;)this.removeGeometry(0)}geometryVertexAttributeUpdated(t,e,i=!1){this._emit("attributesChanged",{object:this,geometry:t,attribute:e,sync:i}),(0,p.b)(e)&&this._invalidateBoundingVolume()}get visible(){return this._visible}set visible(t){if(this._visible!==t){this._visible=t;for(const t of this._geometries)t.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const t=new d.p;for(const e of this._geometries)e.occludees=(0,g.Ci)(e.occludees,t);return this._emit("occlusionChanged",this),t}removeOcclude(t){for(const e of this._geometries)e.occludees=(0,g.PC)(e.occludees,t);this._emit("occlusionChanged",this)}highlight(t){const e=new d.h(t);for(const t of this._geometries)t.addHighlight(e);return this._emit("highlightChanged",this),e}removeHighlight(t){for(const e of this._geometries)e.removeHighlight(t);this._emit("highlightChanged",this)}removeStateID(t){t.channel===l.Mg.Highlight?this.removeHighlight(t):this.removeOcclude(t)}getCombinedStaticTransformation(t,e){return(0,n.lw)(e,this.transformation,t.transformation)}getCombinedShaderTransformation(t,e=(0,r.vt)()){return(0,n.lw)(e,this.effectiveTransformation,t.transformation)}get boundingVolumeWorldSpace(){return this._bvWorldSpace||(this._bvWorldSpace=this._bvWorldSpace||new y,this._validateBoundingVolume(this._bvWorldSpace,A.WorldSpace)),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._bvObjectSpace||(this._bvObjectSpace=this._bvObjectSpace||new y,this._validateBoundingVolume(this._bvObjectSpace,A.ObjectSpace)),this._bvObjectSpace}_validateBoundingVolume(t,e){const i=e===A.ObjectSpace;for(const e of this._geometries){const n=e.boundingInfo;n&&_(n,t,i?e.transformation:this.getCombinedShaderTransformation(e))}(0,s.m)((0,a.a)(t.bounds),t.min,t.max,.5);for(const e of this._geometries){const n=e.boundingInfo;if(null==n)continue;const r=i?e.transformation:this.getCombinedShaderTransformation(e),o=(0,h.hG)(r);(0,s.t)(T,n.center,r);const l=(0,s.j)(T,(0,a.a)(t.bounds)),c=n.radius*o;t.bounds[3]=Math.max(t.bounds[3],l+c)}}_invalidateBoundingVolume(){const t=this._bvWorldSpace?.bounds;this._bvObjectSpace=this._bvWorldSpace=void 0,this._parentLayer&&t&&this._parentLayer.notifyObjectBBChanged(this,t)}_emit(t,e){this._parentLayer&&this._parentLayer.events.emit(t,e)}get test(){}}class m{constructor(){this.min=(0,o.fA)(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=(0,o.fA)(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}}class y extends m{constructor(){super(...arguments),this.bounds=(0,a.c)()}}function _(t,e,i){const r=t.bbMin,o=t.bbMax;if((0,n.tZ)(i)){const t=(0,s.i)(b,i[12],i[13],i[14]);(0,s.g)(w,r,t),(0,s.g)(x,o,t);for(let t=0;t<3;++t)e.min[t]=Math.min(e.min[t],w[t]),e.max[t]=Math.max(e.max[t],x[t])}else if((0,s.t)(w,r,i),(0,s.p)(r,o))for(let t=0;t<3;++t)e.min[t]=Math.min(e.min[t],w[t]),e.max[t]=Math.max(e.max[t],w[t]);else{(0,s.t)(x,o,i);for(let t=0;t<3;++t)e.min[t]=Math.min(e.min[t],w[t],x[t]),e.max[t]=Math.max(e.max[t],w[t],x[t]);for(let t=0;t<3;++t){(0,s.c)(w,r),(0,s.c)(x,o),w[t]=o[t],x[t]=r[t],(0,s.t)(w,w,i),(0,s.t)(x,x,i);for(let t=0;t<3;++t)e.min[t]=Math.min(e.min[t],w[t],x[t]),e.max[t]=Math.max(e.max[t],w[t],x[t])}}}const b=(0,o.vt)(),w=(0,o.vt)(),x=(0,o.vt)(),T=(0,o.vt)();var A,M;(M=A||(A={}))[M.WorldSpace=0]="WorldSpace",M[M.ObjectSpace=1]="ObjectSpace"},84321:function(t,e,i){"use strict";i.d(e,{h:function(){return o},p:function(){return a}});var n=i(11231),r=i(54407);class s{constructor(){this.uid=(0,n.c)()}}class o extends s{constructor(t){super(),this.highlightGroupName=t,this.channel=r.Mg.Highlight}}class a extends s{constructor(){super(...arguments),this.channel=r.Mg.MaskOccludee}}},35363:function(t,e,i){"use strict";i.d(e,{A:function(){return V}});var n,r,s=i(56996),o=i(7187),a=i(20551),h=i(32501),l=i(69508),c=i(79578),u=i(13794),d=i(90553);class f{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(t,e){this.objectToBoundingSphere=t,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new p,this._objectCount=0,e&&(void 0!==e.maximumObjectsPerNode&&(this._maximumObjectsPerNode=e.maximumObjectsPerNode),void 0!==e.maximumDepth&&(this._maximumDepth=e.maximumDepth))}destroy(){this._degenerateObjects.clear(),p.clearPool(),R[0]=null,L.prune(),B.prune()}add(t,e=t.length){this._objectCount+=e,this._grow(t,e);const i=p.acquire();for(let n=0;n<e;n++){const e=t[n];this._isDegenerate(e)?this._degenerateObjects.add(e):(i.init(this._root),this._add(e,i))}p.release(i)}remove(t,e=null){this._objectCount-=t.length;const i=p.acquire();for(const n of t){const t=e??(0,u.e)(this.objectToBoundingSphere(n),z);S(t[3])?(i.init(this._root),m(n,t,i)):this._degenerateObjects.delete(n)}p.release(i),this._shrink()}update(t,e){if(!S(e[3])&&this._isDegenerate(t))return;const i=function(t){return R[0]=t,R}(t);this.remove(i,e),this.add(i)}forEachAlongRay(t,e,i){const n=(0,c.LV)(t,e);g(this._root,(t=>{if(!function(t,e){return x((0,u.a)(e.bounds),2*-e.halfSize,N),x((0,u.a)(e.bounds),2*e.halfSize,D),(0,d.O_)(t.origin,t.direction,N,D)}(n,t))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObject(n,t)&&i(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObject(n,t)&&i(t)})),!0}))}forEachAlongRayWithVerticalOffset(t,e,i,n){const r=(0,c.LV)(t,e);g(this._root,(t=>{if(!function(t,e,i){return x((0,u.a)(e.bounds),2*-e.halfSize,N),x((0,u.a)(e.bounds),2*e.halfSize,D),i.applyToMinMax(N,D),(0,d.O_)(t.origin,t.direction,N,D)}(r,t,n))return!1;const e=t.node;return e.terminals.forAll((t=>{this._intersectsObjectWithOffset(r,t,n)&&i(t)})),null!==e.residents&&e.residents.forAll((t=>{this._intersectsObjectWithOffset(r,t,n)&&i(t)})),!0}))}forEach(t){g(this._root,(e=>{const i=e.node;return i.terminals.forAll(t),null!==i.residents&&i.residents.forAll(t),!0})),this._degenerateObjects.forEach(t)}forEachDegenerateObject(t){this._degenerateObjects.forEach(t)}findClosest(t,e,i,n=()=>!0,r=1/0){let s=1/0,o=1/0,h=null;const c=A(t,e),d=a=>{if(--r,!n(a))return;const c=this.objectToBoundingSphere(a);if(!(0,l.m7)(i,c))return;const d=M(t,e,(0,u.a)(c)),f=d-c[3],p=d+c[3];f<s&&(s=f,o=p,h=a)};return v(this._root,(n=>{if(r<=0||!(0,l.m7)(i,n.bounds))return!1;if((0,a.h)(P,c,n.halfSize),(0,a.g)(P,P,(0,u.a)(n.bounds)),M(t,e,P)>o)return!1;const s=n.node;return s.terminals.forAll((t=>d(t))),null!==s.residents&&s.residents.forAll((t=>d(t))),!0}),t,e),h}forEachInDepthRange(t,e,i,n,r,s,o){let h=-1/0,c=1/0;const d={setRange:t=>{i===f.DepthOrder.FRONT_TO_BACK?(h=Math.max(h,t.near),c=Math.min(c,t.far)):(h=Math.max(h,-t.far),c=Math.min(c,-t.near))}};d.setRange(n);const p=M(e,i,t),g=A(e,i),m=A(e,-i),y=t=>{if(!o(t))return;const n=this.objectToBoundingSphere(t),a=(0,u.a)(n),f=M(e,i,a)-p,g=f-n[3],v=f+n[3];g>c||v<h||!(0,l.m7)(s,n)||r(t,d)};v(this._root,(t=>{if(!(0,l.m7)(s,t.bounds))return!1;if((0,a.h)(P,g,t.halfSize),(0,a.g)(P,P,(0,u.a)(t.bounds)),M(e,i,P)-p>c)return!1;if((0,a.h)(P,m,t.halfSize),(0,a.g)(P,P,(0,u.a)(t.bounds)),M(e,i,P)-p<h)return!1;const n=t.node;return n.terminals.forAll((t=>y(t))),null!==n.residents&&n.residents.forAll((t=>y(t))),!0}),e,i)}forEachNode(t){g(this._root,(e=>t(e.node,e.bounds,e.halfSize,e.depth)))}forEachNeighbor(t,e){const i=(0,u.g)(e),n=(0,u.a)(e),r=e=>{const r=this.objectToBoundingSphere(e),s=(0,u.g)(r),o=i+s;return!((0,a.s)((0,u.a)(r),n)-o*o<=0)||t(e)};let s=!0;const o=t=>{s&&(s=r(t))};g(this._root,(t=>{const e=(0,u.g)(t.bounds),r=i+e;if((0,a.s)((0,u.a)(t.bounds),n)-r*r>0)return!1;const h=t.node;return h.terminals.forAll(o),s&&null!==h.residents&&h.residents.forAll(o),s})),s&&this.forEachDegenerateObject(o)}_intersectsObject(t,e){const i=this.objectToBoundingSphere(e);return!(i[3]>0)||(0,u.k)(i,t)}_intersectsObjectWithOffset(t,e,i){const n=this.objectToBoundingSphere(e);return!(n[3]>0)||(0,u.k)(i.applyToBoundingSphere(n),t)}_add(t,e){e.advanceTo(this.objectToBoundingSphere(t))?e.node.terminals.push(t):(e.node.residents.push(t),e.node.residents.length>this._maximumObjectsPerNode&&e.depth<this._maximumDepth&&this._split(e))}_split(t){const e=t.node.residents;t.node.residents=null;for(let i=0;i<e.length;i++){const n=p.acquire().init(t);this._add(e.at(i),n),p.release(n)}}_grow(t,e){if(0!==e&&(T(t,e,(t=>this.objectToBoundingSphere(t)),j),S(j[3])&&!this._fitsInsideTree(j)))if(_(this._root.node))(0,u.e)(j,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{const t=this._rootBoundsForRootAsSubNode(j);this._placingRootViolatesMaxDepth(t)?this._rebuildTree(j,t):this._growRootAsSubNode(t),p.release(t)}}_rebuildTree(t,e){(0,a.c)((0,u.a)(k),(0,u.a)(e.bounds)),k[3]=e.halfSize,T([t,k],2,(t=>t),F);const i=p.acquire().init(this._root);this._root.initFrom(null,F,F[3]),this._root.increaseHalfSize(1.25),g(i,(t=>(this.add(t.node.terminals.data,t.node.terminals.length),null!==t.node.residents&&this.add(t.node.residents.data,t.node.residents.length),!0))),p.release(i)}_placingRootViolatesMaxDepth(t){const e=Math.log(t.halfSize/this._root.halfSize)*Math.LOG2E;let i=0;return g(this._root,(t=>(i=Math.max(i,t.depth),i+e<=this._maximumDepth))),i+e>this._maximumDepth}_rootBoundsForRootAsSubNode(t){const e=t[3],i=t;let n=-1/0;const r=this._root.bounds,s=this._root.halfSize;for(let t=0;t<3;t++){const o=r[t]-s-(i[t]-e),a=i[t]+e-(r[t]+s),h=Math.max(0,Math.ceil(o/(2*s))),l=Math.max(0,Math.ceil(a/(2*s)))+1,c=2**Math.ceil(Math.log(h+l)*Math.LOG2E);n=Math.max(n,c),H[t].min=h,H[t].max=l}for(let t=0;t<3;t++){let e=H[t].min,i=H[t].max;const o=(n-(e+i))/2;e+=Math.ceil(o),i+=Math.floor(o);const a=r[t]-s-e*s*2;I[t]=a+(i+e)*s}const o=n*s;return I[3]=o*O,p.acquire().initFrom(null,I,o,0)}_growRootAsSubNode(t){const e=this._root.node;(0,a.c)((0,u.a)(j),(0,u.a)(this._root.bounds)),j[3]=this._root.halfSize,this._root.init(t),t.advanceTo(j,null,!0),t.node.children=e.children,t.node.residents=e.residents,t.node.terminals=e.terminals}_shrink(){for(;;){const t=this._findShrinkIndex();if(-1===t)break;this._root.advance(t),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let t=null;const e=this._root.node.children;let i=0,n=0;for(;n<e.length&&null==t;)i=n++,t=e[i];for(;n<e.length;)if(e[n++])return-1;return i}_isDegenerate(t){return!S(this.objectToBoundingSphere(t)[3])}_fitsInsideTree(t){const e=this._root.bounds,i=this._root.halfSize;return t[3]<=i&&t[0]>=e[0]-i&&t[0]<=e[0]+i&&t[1]>=e[1]-i&&t[1]<=e[1]+i&&t[2]>=e[2]-i&&t[2]<=e[2]+i}toJSON(){const{maximumDepth:t,maximumObjectsPerNode:e,_objectCount:i}=this,n=this._nodeToJSON(this._root.node);return{maximumDepth:t,maximumObjectsPerNode:e,objectCount:i,root:{bounds:this._root.bounds,halfSize:this._root.halfSize,depth:this._root.depth,node:n}}}_nodeToJSON(t){const e=t.children.map((t=>t?this._nodeToJSON(t):null)),i=t.residents?.map((t=>this.objectToBoundingSphere(t))),n=t.terminals?.map((t=>this.objectToBoundingSphere(t)));return{children:e,residents:i,terminals:n}}static fromJSON(t){const e=new f((t=>t),{maximumDepth:t.maximumDepth,maximumObjectsPerNode:t.maximumObjectsPerNode});return e._objectCount=t.objectCount,e._root.initFrom(t.root.node,t.root.bounds,t.root.halfSize,t.root.depth),e}}class p{constructor(){this.bounds=(0,u.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(t){return this.initFrom(t.node,t.bounds,t.halfSize,t.depth)}initFrom(t,e,i,n=this.depth){return this.node=null!=t?t:p.createEmptyNode(),e&&(0,u.e)(e,this.bounds),this.halfSize=i,this.depth=n,this}increaseHalfSize(t){this.halfSize*=t,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*O}advance(t){let e=this.node.children[t];e||(e=p.createEmptyNode(),this.node.children[t]=e),this.node=e,this.halfSize/=2,this.depth++;const i=E[t];return this.bounds[0]+=i[0]*this.halfSize,this.bounds[1]+=i[1]*this.halfSize,this.bounds[2]+=i[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(t,e,i=!1){for(;;){if(this.isTerminalFor(t))return e&&e(this,-1),!0;if(this.isLeaf()){if(!i)return e&&e(this,-1),!1;this.node.residents=null}const n=this._childIndex(t);e&&e(this,n),this.advance(n)}}isLeaf(){return null!=this.node.residents}isTerminalFor(t){return t[3]>this.halfSize/2}_childIndex(t){const e=this.bounds;return(e[0]<t[0]?1:0)+(e[1]<t[1]?2:0)+(e[2]<t[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new o.A({shrink:!0}),residents:new o.A({shrink:!0})}}static acquire(){return p._pool.acquire()}static release(t){p._pool.release(t)}static clearPool(){p._pool.prune()}}function g(t,e){let i=p.acquire().init(t);const n=[i];for(;0!==n.length;){if(i=n.pop(),e(i)&&!i.isLeaf())for(let t=0;t<i.node.children.length;t++)i.node.children[t]&&n.push(p.acquire().init(i).advance(t));p.release(i)}}function v(t,e,i,n=f.DepthOrder.FRONT_TO_BACK){let r=p.acquire().init(t);const s=[r];for(function(t,e,i){if(!B.length)for(let t=0;t<8;++t)B.push({index:0,distance:0});for(let i=0;i<8;++i){const n=E[i];B.data[i].index=i,B.data[i].distance=M(t,e,n)}B.sort(((t,e)=>t.distance-e.distance));for(let t=0;t<8;++t)i[t]=B.data[t].index}(i,n,G);0!==s.length;){if(r=s.pop(),e(r)&&!r.isLeaf())for(let t=7;t>=0;--t){const e=G[t];r.node.children[e]&&s.push(p.acquire().init(r).advance(e))}p.release(r)}}function m(t,e,i){L.clear();const n=i.advanceTo(e,((t,e)=>{L.push(t.node),L.push(e)}))?i.node.terminals:i.node.residents;if(n.removeUnordered(t),0===n.length)for(let t=L.length-2;t>=0&&y(L.data[t],L.data[t+1]);t-=2);}function y(t,e){return e>=0&&(t.children[e]=null),!!_(t)&&(null===t.residents&&(t.residents=new o.A({shrink:!0})),!0)}function _(t){if(0!==t.terminals.length)return!1;if(null!==t.residents)return 0===t.residents.length;for(let e=0;e<t.children.length;e++)if(t.children[e])return!1;return!0}function b(t,e){t[0]=Math.min(t[0],e[0]-e[3]),t[1]=Math.min(t[1],e[1]-e[3]),t[2]=Math.min(t[2],e[2]-e[3])}function w(t,e){t[0]=Math.max(t[0],e[0]+e[3]),t[1]=Math.max(t[1],e[1]+e[3]),t[2]=Math.max(t[2],e[2]+e[3])}function x(t,e,i){i[0]=t[0]+e,i[1]=t[1]+e,i[2]=t[2]+e}function T(t,e,i,n){if(1===e){const e=i(t[0]);(0,u.e)(e,n)}else{N[0]=1/0,N[1]=1/0,N[2]=1/0,D[0]=-1/0,D[1]=-1/0,D[2]=-1/0;for(let n=0;n<e;n++){const e=i(t[n]);S(e[3])&&(b(N,e),w(D,e))}(0,a.m)((0,u.a)(n),N,D,.5),n[3]=Math.max(D[0]-N[0],D[1]-N[1],D[2]-N[2])/2}}function A(t,e){let i,n=1/0;for(let r=0;r<8;++r){const s=M(t,e,C[r]);s<n&&(n=s,i=C[r])}return i}function M(t,e,i){return e*(t[0]*i[0]+t[1]*i[1]+t[2]*i[2])}function S(t){return!isNaN(t)&&t!==-1/0&&t!==1/0&&t>0}p._pool=new s.A(p),n=f||(f={}),(r=n.DepthOrder||(n.DepthOrder={}))[r.FRONT_TO_BACK=1]="FRONT_TO_BACK",r[r.BACK_TO_FRONT=-1]="BACK_TO_FRONT";const E=[(0,h.fA)(-1,-1,-1),(0,h.fA)(1,-1,-1),(0,h.fA)(-1,1,-1),(0,h.fA)(1,1,-1),(0,h.fA)(-1,-1,1),(0,h.fA)(1,-1,1),(0,h.fA)(-1,1,1),(0,h.fA)(1,1,1)],C=[(0,h.fA)(-1,-1,-1),(0,h.fA)(-1,-1,1),(0,h.fA)(-1,1,-1),(0,h.fA)(-1,1,1),(0,h.fA)(1,-1,-1),(0,h.fA)(1,-1,1),(0,h.fA)(1,1,-1),(0,h.fA)(1,1,1)],O=Math.sqrt(3),R=[null],I=(0,u.c)(),P=(0,h.vt)(),N=(0,h.vt)(),D=(0,h.vt)(),L=new o.A,z=(0,u.c)(),j=(0,u.c)(),k=(0,u.c)(),F=(0,u.c)(),H=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],B=new o.A,G=[0,0,0,0,0,0,0,0],V=f},46921:function(t,e,i){"use strict";i.d(e,{K_:function(){return p},SE:function(){return d},Yf:function(){return l},aB:function(){return f},ez:function(){return h},m6:function(){return g},xt:function(){return u},z5:function(){return c}});var n=i(27264),r=i(54840),s=i(85456),o=i(57087);const a=(0,o.p3)(s.dn.ONE,s.dn.ZERO,s.dn.ONE,s.dn.ONE_MINUS_SRC_ALPHA);function h(t){return t===r.Y.FrontFace?null:a}function l(t){switch(t){case r.Y.NONE:return o.Ky;case r.Y.ColorAlpha:return a;case r.Y.FrontFace:case r.Y.COUNT:return null}}function c(t){if(t.draped)return null;switch(t.oitPass){case r.Y.NONE:case r.Y.FrontFace:return t.writeDepth?o.Uy:null;case r.Y.ColorAlpha:case r.Y.COUNT:return null}}const u=5e5,d={factor:-1,units:-2};function f(t){return t?d:null}function p(t,e=s.MT.LESS){return t===r.Y.NONE||t===r.Y.FrontFace?e:s.MT.LEQUAL}function g(t,e){const i=(0,n.LG)(e);return t===r.Y.ColorAlpha?i?{buffers:[s.Nm.COLOR_ATTACHMENT0,s.Nm.COLOR_ATTACHMENT1,s.Nm.COLOR_ATTACHMENT2]}:{buffers:[s.Nm.COLOR_ATTACHMENT0,s.Nm.COLOR_ATTACHMENT1]}:i?{buffers:[s.Nm.COLOR_ATTACHMENT0,s.Nm.COLOR_ATTACHMENT1]}:null}},45079:function(t,e,i){"use strict";i.d(e,{JG:function(){return l},Uy:function(){return u},Wb:function(){return A},Z$:function(){return g}});var n=i(20551),r=i(32501),s=i(24761),o=i(40359),a=i(90553),h=i(65839);class l{constructor(t=!1,e=!0){this.isVerticalRay=t,this.normalRequired=e}}const c=(0,s.vt)();function u(t,e,i,r,s,c){if(!t.visible)return;const u=(0,n.a)(E,r,i),d=(t,e,i)=>{c(t,i,e,!1)},p=new l(!1,e.options.normalRequired);if(t.boundingInfo){(0,a.vA)(t.type===o.X.Mesh);const n=e.tolerance;f(t.boundingInfo,i,u,n,s,p,d)}else{const e=t.attributes.get(h.r.POSITION),n=e.indices;v(i,u,0,n.length/3,n,e.data,e.stride,s,p,d)}}const d=(0,r.vt)();function f(t,e,i,r,o,a,h){if(null==t)return;const l=function(t,e){return(0,n.i)(e,1/t[0],1/t[1],1/t[2])}(i,d);if((0,s.Ne)(c,t.bbMin),(0,s.vI)(c,t.bbMax),null!=o&&o.applyToAabb(c),A(c,e,l,r)){const{primitiveIndices:n,position:s}=t,l=n?n.length:s.indices.length/3;if(l>M){const n=t.getChildren();if(void 0!==n){for(const t of n)f(t,e,i,r,o,a,h);return}}!function(t,e,i,n,r,s,o,a,h,l,c){const u=t[0],d=t[1],f=t[2],g=e[0],v=e[1],m=e[2],{normalRequired:y}=l;for(let t=0;t<n;++t){const e=a[t],i=3*e,n=o*r[i];let l=s[n],_=s[n+1],w=s[n+2];const x=o*r[i+1];let T=s[x],A=s[x+1],M=s[x+2];const E=o*r[i+2];let C=s[E],O=s[E+1],R=s[E+2];null!=h&&([l,_,w]=h.applyToVertex(l,_,w,t),[T,A,M]=h.applyToVertex(T,A,M,t),[C,O,R]=h.applyToVertex(C,O,R,t));const I=T-l,P=A-_,N=M-w,D=C-l,L=O-_,z=R-w,j=v*z-L*m,k=m*D-z*g,F=g*L-D*v,H=I*j+P*k+N*F;if(Math.abs(H)<=S)continue;const B=u-l,G=d-_,V=f-w,U=B*j+G*k+V*F;if(H>0){if(U<0||U>H)continue}else if(U>0||U<H)continue;const $=G*N-P*V,W=V*I-N*B,q=B*P-I*G,Z=g*$+v*W+m*q;if(H>0){if(Z<0||U+Z>H)continue}else if(Z>0||U+Z<H)continue;const Y=(D*$+L*W+z*q)/H;Y>=0&&c(Y,e,y?b(I,P,N,D,L,z,p):null)}}(e,i,0,l,s.indices,s.data,s.stride,n,o,a,h)}}const p=(0,r.vt)();function g(t,e,i,r,s,o,a,h,l){const{data:c,stride:u}=o;v(t,(0,n.a)(E,e,t),i,r,s,c,u,a,h,l)}function v(t,e,i,r,s,o,a,h,l,c){const u=e,d=C,f=Math.abs(u[0]),p=Math.abs(u[1]),g=Math.abs(u[2]),v=f>=p?f>=g?0:2:p>=g?1:2,b=v,x=u[b]<0?2:1,T=(v+x)%3,A=(v+(3-x))%3,M=u[T]/u[b],S=u[A]/u[b],E=1/u[b],O=m,R=y,I=_,{normalRequired:P}=l;for(let e=i;e<r;++e){const i=3*e,r=a*s[i];(0,n.i)(d[0],o[r+0],o[r+1],o[r+2]);const l=a*s[i+1];(0,n.i)(d[1],o[l+0],o[l+1],o[l+2]);const u=a*s[i+2];(0,n.i)(d[2],o[u+0],o[u+1],o[u+2]),h&&((0,n.c)(d[0],h.applyToVertex(d[0][0],d[0][1],d[0][2],e)),(0,n.c)(d[1],h.applyToVertex(d[1][0],d[1][1],d[1][2],e)),(0,n.c)(d[2],h.applyToVertex(d[2][0],d[2][1],d[2][2],e))),(0,n.a)(O,d[0],t),(0,n.a)(R,d[1],t),(0,n.a)(I,d[2],t);const f=O[T]-M*O[b],p=O[A]-S*O[b],g=R[T]-M*R[b],v=R[A]-S*R[b],m=I[T]-M*I[b],y=I[A]-S*I[b],_=m*v-y*g,x=f*y-p*m,C=g*p-v*f;if((_<0||x<0||C<0)&&(_>0||x>0||C>0))continue;const N=_+x+C;if(0===N)continue;const D=_*(E*O[b])+x*(E*R[b])+C*(E*I[b]);if(D*Math.sign(N)<0)continue;const L=D/N;L>=0&&c(L,e,P?w(d):null)}}const m=(0,r.vt)(),y=(0,r.vt)(),_=(0,r.vt)();function b(t,e,i,r,s,o,a){return(0,n.i)(x,t,e,i),(0,n.i)(T,r,s,o),(0,n.e)(a,x,T),(0,n.n)(a,a),a}function w(t){return(0,n.a)(x,t[1],t[0]),(0,n.a)(T,t[2],t[0]),(0,n.e)(p,x,T),(0,n.n)(p,p),p}const x=(0,r.vt)(),T=(0,r.vt)();function A(t,e,i,n){return function(t,e,i,n){const r=(t[0]-n-e[0])*i[0],s=(t[3]+n-e[0])*i[0];let o=Math.min(r,s),a=Math.max(r,s);const h=(t[1]-n-e[1])*i[1],l=(t[4]+n-e[1])*i[1];if(a=Math.min(a,Math.max(h,l)),a<0)return!1;if(o=Math.max(o,Math.min(h,l)),o>a)return!1;const c=(t[2]-n-e[2])*i[2],u=(t[5]+n-e[2])*i[2];return a=Math.min(a,Math.max(c,u)),!(a<0)&&(o=Math.max(o,Math.min(c,u)),!(o>a)&&o<1/0)}(t,e,i,n)}const M=1e3,S=1e-7,E=(0,r.vt)(),C=[(0,r.vt)(),(0,r.vt)(),(0,r.vt)()]},15389:function(t,e,i){"use strict";i.d(e,{$:function(){return l}});var n=i(11231),r=i(73364),s=i(39714),o=i(20551),a=i(13794),h=i(76185);class l{constructor(t,e={}){this.geometry=t,this.screenToWorldRatio=1,this._transformation=(0,s.vt)(),this._shaderTransformation=null,this._boundingSphere=null,this.id=(0,n.c)(),this.layerUid=e.layerUid,this.graphicUid=e.graphicUid,this.castShadow=e.castShadow??!1,e.objectShaderTransformation&&this.objectShaderTransformationChanged(e.objectShaderTransformation)}get transformation(){return this._transformation}set transformation(t){(0,r.C)(this._transformation,t),this._boundingSphere=null}get boundingInfo(){return this.geometry.boundingInfo}objectShaderTransformationChanged(t){null==t?this._shaderTransformation=null:(this._shaderTransformation??=(0,s.vt)(),(0,r.lw)(this._shaderTransformation,t,this.geometry.transformation)),this._boundingSphere=null}get boundingSphere(){return this.boundingInfo?(null==this._boundingSphere&&(this._boundingSphere??=(0,a.c)(),(0,o.t)((0,a.a)(this._boundingSphere),this.boundingInfo.center,this.shaderTransformation),this._boundingSphere[3]=this.boundingInfo.radius*(0,h.hG)(this.shaderTransformation)),this._boundingSphere):a.N}get material(){return this.geometry.material}get type(){return this.geometry.type}get shaderTransformation(){return this._shaderTransformation??this.transformation}get attributes(){return this.geometry.attributes}get highlight(){return this.geometry.highlights}foreachHighlightGroup(t){this.geometry.foreachHighlightGroup(t)}get hasHighlights(){return this.geometry.hasHighlights}get occludees(){return this.geometry.occludees}get visible(){return this.geometry.visible}set visible(t){this.geometry.visible=t}}},29165:function(t,e,i){"use strict";var n;i.d(e,{N:function(){return n}}),function(t){t[t.INTEGRATED_MESH=0]="INTEGRATED_MESH",t[t.OPAQUE_TERRAIN=1]="OPAQUE_TERRAIN",t[t.OPAQUE_MATERIAL=2]="OPAQUE_MATERIAL",t[t.OPAQUE_MATERIAL_WITHOUT_NORMALS=3]="OPAQUE_MATERIAL_WITHOUT_NORMALS",t[t.TRANSPARENT_MATERIAL=4]="TRANSPARENT_MATERIAL",t[t.TRANSPARENT_MATERIAL_WITHOUT_NORMALS=5]="TRANSPARENT_MATERIAL_WITHOUT_NORMALS",t[t.TRANSPARENT_TERRAIN=6]="TRANSPARENT_TERRAIN",t[t.TRANSPARENT_MATERIAL_WITHOUT_DEPTH=7]="TRANSPARENT_MATERIAL_WITHOUT_DEPTH",t[t.OCCLUDED_TERRAIN=8]="OCCLUDED_TERRAIN",t[t.OCCLUDER_MATERIAL=9]="OCCLUDER_MATERIAL",t[t.TRANSPARENT_OCCLUDER_MATERIAL=10]="TRANSPARENT_OCCLUDER_MATERIAL",t[t.OCCLUSION_PIXELS=11]="OCCLUSION_PIXELS",t[t.HUD_MATERIAL=12]="HUD_MATERIAL",t[t.LABEL_MATERIAL=13]="LABEL_MATERIAL",t[t.LINE_CALLOUTS=14]="LINE_CALLOUTS",t[t.LINE_CALLOUTS_HUD_DEPTH=15]="LINE_CALLOUTS_HUD_DEPTH",t[t.DRAPED_MATERIAL=16]="DRAPED_MATERIAL",t[t.DRAPED_WATER=17]="DRAPED_WATER",t[t.VOXEL=18]="VOXEL",t[t.MAX_SLOTS=19]="MAX_SLOTS"}(n||(n={}))},6200:function(t,e,i){"use strict";i.d(e,{I$:function(){return u},a9:function(){return c},m:function(){return s},mK:function(){return d},qh:function(){return l},r8:function(){return h},sf:function(){return o},v0:function(){return a}});var n=i(54407),r=i(85456);const s={func:r.MT.LESS},o={func:r.MT.ALWAYS},a={mask:255},h={mask:0},l={function:{func:r.MT.ALWAYS,ref:n.dd.OutlineVisualElementMask,mask:n.dd.OutlineVisualElementMask},operation:{fail:r.eA.KEEP,zFail:r.eA.KEEP,zPass:r.eA.ZERO}},c={function:{func:r.MT.ALWAYS,ref:n.dd.OutlineVisualElementMask,mask:n.dd.OutlineVisualElementMask},operation:{fail:r.eA.KEEP,zFail:r.eA.KEEP,zPass:r.eA.REPLACE}},u={function:{func:r.MT.EQUAL,ref:n.dd.OutlineVisualElementMask,mask:n.dd.OutlineVisualElementMask},operation:{fail:r.eA.KEEP,zFail:r.eA.KEEP,zPass:r.eA.KEEP}},d={function:{func:r.MT.NOTEQUAL,ref:n.dd.OutlineVisualElementMask,mask:n.dd.OutlineVisualElementMask},operation:{fail:r.eA.KEEP,zFail:r.eA.KEEP,zPass:r.eA.KEEP}}},59552:function(t,e,i){"use strict";i.d(e,{g:function(){return F}}),i(58941);var n=i(39819),r=i(48996),s=i(95929),o=i(60539),a=i(24540),h=i(90683),l=i(9030),c=i(86419),u=i(54407),d=i(53216);let f;var p,g;(g=p||(p={}))[g.ETC1_RGB=0]="ETC1_RGB",g[g.ETC2_RGBA=1]="ETC2_RGBA",g[g.BC1_RGB=2]="BC1_RGB",g[g.BC3_RGBA=3]="BC3_RGBA",g[g.BC4_R=4]="BC4_R",g[g.BC5_RG=5]="BC5_RG",g[g.BC7_M6_RGB=6]="BC7_M6_RGB",g[g.BC7_M5_RGBA=7]="BC7_M5_RGBA",g[g.PVRTC1_4_RGB=8]="PVRTC1_4_RGB",g[g.PVRTC1_4_RGBA=9]="PVRTC1_4_RGBA",g[g.ASTC_4x4_RGBA=10]="ASTC_4x4_RGBA",g[g.ATC_RGB=11]="ATC_RGB",g[g.ATC_RGBA=12]="ATC_RGBA",g[g.FXT1_RGB=17]="FXT1_RGB",g[g.PVRTC2_4_RGB=18]="PVRTC2_4_RGB",g[g.PVRTC2_4_RGBA=19]="PVRTC2_4_RGBA",g[g.ETC2_EAC_R11=20]="ETC2_EAC_R11",g[g.ETC2_EAC_RG11=21]="ETC2_EAC_RG11",g[g.RGBA32=13]="RGBA32",g[g.RGB565=14]="RGB565",g[g.BGR565=15]="BGR565",g[g.RGBA4444=16]="RGBA4444";var v=i(85456),m=i(12285),y=i(93380);let _=null,b=null;async function w(){return null==b&&(f??=(async()=>{const t=await i.e(5090).then(i.bind(i,90830)),e=await t.default({locateFile:t=>(0,d.s)(`esri/libs/basisu/${t}`)});return e.initializeBasis(),e})(),b=f,_=await b),b}function x(t,e,i,n,r){const s=(0,y.IB)(e?v.CQ.COMPRESSED_RGBA8_ETC2_EAC:v.CQ.COMPRESSED_RGB8_ETC2),o=r&&t>1?(4**t-1)/(3*4**(t-1)):1;return Math.ceil(i*n*s*o)}function T(t){return t.getNumImages()>=1&&!t.isUASTC()}function A(t){return t.getFaces()>=1&&t.isETC1S()}function M(t,e,i,n,r,s,o,a){const{compressedTextureETC:h,compressedTextureS3TC:l}=t.capabilities,[c,u]=h?n?[p.ETC2_RGBA,v.CQ.COMPRESSED_RGBA8_ETC2_EAC]:[p.ETC1_RGB,v.CQ.COMPRESSED_RGB8_ETC2]:l?n?[p.BC3_RGBA,v.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT]:[p.BC1_RGB,v.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT]:[p.RGBA32,v.Ab.RGBA],d=e.hasMipmap?i:Math.min(1,i),f=[];for(let t=0;t<d;t++)f.push(new Uint8Array(o(t,c))),a(t,c,f[t]);return e.internalFormat=u,e.hasMipmap=f.length>1,e.samplingMode=e.hasMipmap?v.Cj.LINEAR_MIPMAP_LINEAR:v.Cj.LINEAR,e.width=r,e.height=s,new m.g(t,e,{type:"compressed",levels:f})}var S=i(48015),E=i(40359),C=i(40633);const O=()=>C.A.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil");function R(t){return t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)}const I=R("DXT1"),P=R("DXT3"),N=R("DXT5");var D,L,z=i(12569),j=i(90553),k=i(10956);class F extends S.J{get parameters(){return this._parameters}constructor(t,e){super(),this._data=t,this.type=E.X.Texture,this._glTexture=null,this._loadingPromise=null,this._loadingController=null,this.events=new r.A,this._parameters={...B,...e},this._startPreload(t)}dispose(){this.unload(),this._data=this.frameUpdate=void 0}_startPreload(t){null!=t&&(t instanceof HTMLVideoElement?(this.frameUpdate=e=>this._frameUpdate(t,e),this._startPreloadVideoElement(t)):t instanceof HTMLImageElement&&this._startPreloadImageElement(t))}_startPreloadVideoElement(t){if(!((0,h.w8)(t.src)||"auto"===t.preload&&t.crossOrigin)){t.preload="auto",t.crossOrigin="anonymous";const e=!t.paused;if(t.src=t.src,e&&t.autoplay){const e=()=>{t.removeEventListener("canplay",e),t.play()};t.addEventListener("canplay",e)}}}_startPreloadImageElement(t){(0,h.DB)(t.src)||(0,h.w8)(t.src)||t.crossOrigin||(t.crossOrigin="anonymous",t.src=t.src)}_createDescriptor(t){const e=new k.R;return e.wrapMode=this._parameters.wrap??v.pF.REPEAT,e.flipped=!this._parameters.noUnpackFlip,e.samplingMode=this._parameters.mipmap?v.Cj.LINEAR_MIPMAP_LINEAR:v.Cj.LINEAR,e.hasMipmap=!!this._parameters.mipmap,e.preMultiplyAlpha=!!this._parameters.preMultiplyAlpha,e.maxAnisotropy=this._parameters.maxAnisotropy??(this._parameters.mipmap?t.parameters.maxMaxAnisotropy:1),e}get glTexture(){return this._glTexture}get memoryEstimate(){return this._glTexture?.usedMemory||function(t,e){if(null==t)return 0;if((0,a.mw)(t)||(0,a.mg)(t))return e.encoding===u.JS.KTX2_ENCODING?function(t,e){if(null==_)return t.byteLength;const i=new _.KTX2File(new Uint8Array(t)),n=A(i)?x(i.getLevels(),i.getHasAlpha(),i.getWidth(),i.getHeight(),e):0;return i.close(),i.delete(),n}(t,!!e.mipmap):e.encoding===u.JS.BASIS_ENCODING?function(t,e){if(null==_)return t.byteLength;const i=new _.BasisFile(new Uint8Array(t)),n=T(i)?x(i.getNumLevels(0),i.getHasAlpha(),i.getImageWidth(0,0),i.getImageHeight(0,0),e):0;return i.close(),i.delete(),n}(t,!!e.mipmap):t.byteLength;const{width:i,height:n}=t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?H(t):e;return(e.mipmap?4/3:1)*i*n*(e.components||4)||0}(this._data,this._parameters)}load(t){if(this._glTexture)return this._glTexture;if(this._loadingPromise)return this._loadingPromise;const e=this._data;return null==e?(this._glTexture=new m.g(t,this._createDescriptor(t),null),this._glTexture):(this._parameters.reloadable||(this._data=void 0),"string"==typeof e?this._loadFromURL(t,e):e instanceof Image?this._loadFromImageElement(t,e):e instanceof HTMLVideoElement?this._loadFromVideoElement(t,e):e instanceof ImageData||e instanceof HTMLCanvasElement?this._loadFromImage(t,e):(0,a.mg)(e)&&this._parameters.encoding===u.JS.DDS_ENCODING?this._loadFromDDSData(t,e):(0,a.mw)(e)&&this._parameters.encoding===u.JS.DDS_ENCODING?this._loadFromDDSData(t,new Uint8Array(e)):((0,a.mw)(e)||(0,a.mg)(e))&&this._parameters.encoding===u.JS.KTX2_ENCODING?this._loadFromKTX2(t,e):((0,a.mw)(e)||(0,a.mg)(e))&&this._parameters.encoding===u.JS.BASIS_ENCODING?this._loadFromBasis(t,e):(0,a.mg)(e)?this._loadFromPixelData(t,e):(0,a.mw)(e)?this._loadFromPixelData(t,new Uint8Array(e)):null)}_frameUpdate(t,e){return null==this._glTexture||t.readyState<D.HAVE_CURRENT_DATA||e===t.currentTime?e:(this._glTexture.setData(t),this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this._parameters.updateCallback&&this._parameters.updateCallback(),t.currentTime)}_loadFromDDSData(t,e){return this._glTexture=function(t,e,i){const n=function(t,e){const i=new Int32Array(t.buffer,t.byteOffset,31);if(542327876!==i[0])return O().error("Invalid magic number in DDS header"),null;if(!(4&i[20]))return O().error("Unsupported format, must contain a FourCC code"),null;const n=i[21];let r,s;switch(n){case I:r=8,s=v.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case P:r=16,s=v.CQ.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case N:r=16,s=v.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return O().error("Unsupported FourCC code:",function(t){return String.fromCharCode(255&t,t>>8&255,t>>16&255,t>>24&255)}(n)),null}let o=1,a=i[4],h=i[3];(3&a||3&h)&&(O().warn("Rounding up compressed texture size to nearest multiple of 4."),a=a+3&-4,h=h+3&-4);const l=a,c=h;let u,d;131072&i[2]&&!1!==e&&(o=Math.max(1,i[7]));let f=t.byteOffset+i[1]+4;const p=[];for(let e=0;e<o;++e)d=(a+3>>2)*(h+3>>2)*r,u=new Uint8Array(t.buffer,f,d),p.push(u),f+=d,a=Math.max(1,a>>1),h=Math.max(1,h>>1);return{textureData:{type:"compressed",levels:p},internalFormat:s,width:l,height:c}}(i,e.hasMipmap??!1);if(null==n)throw new Error("DDS texture data is null");const{textureData:r,internalFormat:s,width:o,height:a}=n;return e.samplingMode=r.levels.length>1?v.Cj.LINEAR_MIPMAP_LINEAR:v.Cj.LINEAR,e.hasMipmap=r.levels.length>1,e.internalFormat=s,e.width=o,e.height=a,new m.g(t,e,r)}(t,this._createDescriptor(t),e),this._glTexture}_loadFromKTX2(t,e){return this._loadAsync((()=>async function(t,e,i){null==_&&(_=await w());const n=new _.KTX2File(new Uint8Array(i));if(!A(n))return null;n.startTranscoding();const r=M(t,e,n.getLevels(),n.getHasAlpha(),n.getWidth(),n.getHeight(),((t,e)=>n.getImageTranscodedSizeInBytes(t,0,0,e)),((t,e,i)=>n.transcodeImage(i,t,0,0,e,0,-1,-1)));return n.close(),n.delete(),r}(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromBasis(t,e){return this._loadAsync((()=>async function(t,e,i){null==_&&(_=await w());const n=new _.BasisFile(new Uint8Array(i));if(!T(n))return null;n.startTranscoding();const r=M(t,e,n.getNumLevels(0),n.getHasAlpha(),n.getImageWidth(0,0),n.getImageHeight(0,0),((t,e)=>n.getImageTranscodedSizeInBytes(0,t,e)),((t,e,i)=>n.transcodeImage(i,0,t,e,0,0)));return n.close(),n.delete(),r}(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromPixelData(t,e){(0,j.vA)(this._parameters.width>0&&this._parameters.height>0);const i=this._createDescriptor(t);return i.pixelFormat=1===this._parameters.components?v.Ab.LUMINANCE:3===this._parameters.components?v.Ab.RGB:v.Ab.RGBA,i.width=this._parameters.width??0,i.height=this._parameters.height??0,this._glTexture=new m.g(t,i,e),this._glTexture}_loadFromURL(t,e){return this._loadAsync((async i=>{const n=await(0,l.D)(e,{signal:i});return(0,o.Te)(i),this._loadFromImage(t,n)}))}_loadFromImageElement(t,e){return e.complete?this._loadFromImage(t,e):this._loadAsync((async i=>{const n=await(0,c.Sx)(e,e.src,!1,i);return(0,o.Te)(i),this._loadFromImage(t,n)}))}_loadFromVideoElement(t,e){return e.readyState>=D.HAVE_CURRENT_DATA?this._loadFromImage(t,e):this._loadFromVideoElementAsync(t,e)}_loadFromVideoElementAsync(t,e){return this._loadAsync((i=>new Promise(((r,a)=>{const h=()=>{e.removeEventListener("loadeddata",l),e.removeEventListener("error",c),(0,s.xt)(u)},l=()=>{e.readyState>=D.HAVE_CURRENT_DATA&&(h(),r(this._loadFromImage(t,e)))},c=t=>{h(),a(t||new n.A("Failed to load video"))};e.addEventListener("loadeddata",l),e.addEventListener("error",c);const u=(0,o.u7)(i,(()=>c((0,o.NK)())))}))))}_loadFromImage(t,e){let i=e;if(!(i instanceof HTMLVideoElement)){const{maxTextureSize:e}=t.parameters;i=this._parameters.downsampleUncompressed?(0,z.IR)(i,e):(0,z.vM)(i,e)}const n=H(i);this._parameters.width=n.width,this._parameters.height=n.height;const r=this._createDescriptor(t);return r.pixelFormat=3===this._parameters.components?v.Ab.RGB:v.Ab.RGBA,r.width=n.width,r.height=n.height,this._glTexture=new m.g(t,r,i),this._glTexture}_loadAsync(t){const e=new AbortController;this._loadingController=e;const i=t(e.signal);this._loadingPromise=i;const n=()=>{this._loadingController===e&&(this._loadingController=null),this._loadingPromise===i&&(this._loadingPromise=null)};return i.then(n,n),i}unload(){if(this._glTexture=(0,s.WD)(this._glTexture),null!=this._loadingController){const t=this._loadingController;this._loadingController=null,this._loadingPromise=null,t.abort()}this.events.emit("unloaded")}}function H(t){return t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t}(L=D||(D={}))[L.HAVE_NOTHING=0]="HAVE_NOTHING",L[L.HAVE_METADATA=1]="HAVE_METADATA",L[L.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",L[L.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",L[L.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA";const B={wrap:{s:v.pF.REPEAT,t:v.pF.REPEAT},mipmap:!0,noUnpackFlip:!1,preMultiplyAlpha:!1,downsampleUncompressed:!1}},91998:function(t,e,i){"use strict";var n;i.d(e,{q:function(){return n}}),function(t){t[t.ASYNC=0]="ASYNC",t[t.SYNC=1]="SYNC"}(n||(n={}))},90553:function(t,e,i){"use strict";i.d(e,{L:function(){return h},MX:function(){return o},O_:function(){return a},kL:function(){return l},vA:function(){return s},zH:function(){return c}});var n=i(1932);i(33400),(0,i(41546).vt)();class r{constructor(t){this.message=t}toString(){return`AssertException: ${this.message}`}}function s(t,e="Assertion"){if(!t){const t=new Error(e).stack;throw new r(`${e} at ${t}`)}}function o(t,e){t||(e=e||"",console.warn("Verify failed: "+e+"\n"+new Error("verify").stack))}function a(t,e,i,n){let r,s=(i[0]-t[0])/e[0],o=(n[0]-t[0])/e[0];s>o&&(r=s,s=o,o=r);let a=(i[1]-t[1])/e[1],h=(n[1]-t[1])/e[1];if(a>h&&(r=a,a=h,h=r),s>h||a>o)return!1;a>s&&(s=a),h<o&&(o=h);let l=(i[2]-t[2])/e[2],c=(n[2]-t[2])/e[2];return l>c&&(r=l,l=c,c=r),!(s>c||l>o||(c<o&&(o=c),o<0))}function h(t,e,i,r,s,o=(0,n.vt)()){const a=(r[s]-i[s])*(e[0]-t[0])-(r[0]-i[0])*(e[s]-t[s]),h=(r[0]-i[0])*(t[s]-i[s])-(r[s]-i[s])*(t[0]-i[0]);if(0===a)return!1;const l=h/a;return o[0]=t[0]+l*(e[0]-t[0]),o[1]=t[s]+l*(e[s]-t[s]),!0}function l(t,e){return Math.log(t)/Math.log(e)}function c(t){return 1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&1===t[15]}},69445:function(t,e,i){"use strict";i.d(e,{Z:function(){return r}});var n=i(81438);class r extends n.Z{}},65839:function(t,e,i){"use strict";var n;function r(t){return t===n.POSITION}i.d(e,{b:function(){return r},r:function(){return n}}),function(t){t.POSITION="position",t.NORMAL="normal",t.NORMALCOMPRESSED="normalCompressed",t.UV0="uv0",t.COLOR="color",t.SYMBOLCOLOR="symbolColor",t.SIZE="size",t.ROTATION="rotation",t.TANGENT="tangent",t.OFFSET="offset",t.PERSPECTIVEDIVIDE="perspectiveDivide",t.CENTEROFFSETANDDISTANCE="centerOffsetAndDistance",t.LENGTH="length",t.PREVPOSITION="prevPosition",t.NEXTPOSITION="nextPosition",t.SUBDIVISIONFACTOR="subdivisionFactor",t.COLORFEATUREATTRIBUTE="colorFeatureAttribute",t.SIZEFEATUREATTRIBUTE="sizeFeatureAttribute",t.OPACITYFEATUREATTRIBUTE="opacityFeatureAttribute",t.DISTANCETOSTART="distanceToStart",t.UVMAPSPACE="uvMapSpace",t.BOUNDINGRECT="boundingRect",t.UVREGION="uvRegion",t.PROFILERIGHT="profileRight",t.PROFILEUP="profileUp",t.PROFILEVERTEXANDNORMAL="profileVertexAndNormal",t.FEATUREVALUE="featureValue",t.INSTANCEMODELORIGINHI="instanceModelOriginHi",t.INSTANCEMODELORIGINLO="instanceModelOriginLo",t.INSTANCEMODEL="instanceModel",t.INSTANCEMODELNORMAL="instanceModelNormal",t.INSTANCECOLOR="instanceColor",t.INSTANCEFEATUREATTRIBUTE="instanceFeatureAttribute",t.LOCALTRANSFORM="localTransform",t.GLOBALTRANSFORM="globalTransform",t.BOUNDINGSPHERE="boundingSphere",t.MODELORIGIN="modelOrigin",t.MODELSCALEFACTORS="modelScaleFactors",t.FEATUREATTRIBUTE="featureAttribute",t.STATE="state",t.LODLEVEL="lodLevel",t.POSITION0="position0",t.POSITION1="position1",t.NORMAL2COMPRESSED="normal2Compressed",t.COMPONENTINDEX="componentIndex",t.VARIANTOFFSET="variantOffset",t.VARIANTSTROKE="variantStroke",t.VARIANTEXTENSION="variantExtension",t.SIDENESS="sideness",t.START="start",t.END="end",t.UP="up",t.START_UP="startUp",t.END_UP="endUp",t.EXTRUDE="extrude",t.OBJECTANDLAYERIDCOLOR="objectAndLayerIdColor",t.INSTANCEOBJECTANDLAYERIDCOLOR="instanceObjectAndLayerIdColor"}(n||(n={}))},1296:function(t,e,i){"use strict";i.d(e,{x:function(){return d}});var n=i(48996),r=i(14606),s=i(95929),o=i(7187),a=i(48015),h=i(40359);const l=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","transformationChanged","shaderTransformationChanged","visibilityChanged","occlusionChanged","highlightChanged","geometryAdded","geometryRemoved","attributesChanged"];var c=i(35363),u=i(91998);class d extends a.J{constructor(t,e,i=""){super(),this.stage=t,this.apiLayerUid=i,this.type=h.X.Layer,this.events=new n.A,this.visible=!0,this.sliceable=!1,this._objectsAdded=new o.A,this._handles=new r.A,this._objects=new o.A,this._pickable=!0,this.visible=e?.visible??!0,this._pickable=e?.pickable??!0,this.updatePolicy=e?.updatePolicy??u.q.ASYNC,this._disableOctree=e?.disableOctree??!1,t.add(this);for(const e of l)this._handles.add(this.events.on(e,(i=>t.handleEvent(e,i))))}destroy(){this._handles.size&&(this._handles.destroy(),this.stage.remove(this),this.invalidateSpatialQueryAccelerator())}get objects(){return this._objects}set pickable(t){this._pickable=t}get pickable(){return this._pickable&&this.visible}add(t){this._objects.push(t),t.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:t}),null!=this._octree&&this._objectsAdded.push(t)}remove(t){this._objects.removeUnordered(t)&&(t.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:t}),null!=this._octree&&(this._objectsAdded.removeUnordered(t)||this._octree.remove([t])))}addMany(t){this._objects.pushArray(t);for(const e of t)e.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:t}),null!=this._octree&&this._objectsAdded.pushArray(t)}removeMany(t){const e=new Array;if(this._objects.removeUnorderedMany(t,t.length,e),0!==e.length){for(const t of e)t.parentLayer=null;if(this.events.emit("layerObjectsRemoved",{layer:this,objects:e}),null!=this._octree){for(let t=0;t<e.length;)this._objectsAdded.removeUnordered(e[t])?(e[t]=e[e.length-1],e.length-=1):++t;this._octree.remove(e)}}}sync(){this.updatePolicy!==u.q.SYNC&&this.stage.syncLayer(this.id)}notifyObjectBBChanged(t,e){null==this._octree||this._objectsAdded.includes(t)||this._octree.update(t,e)}getSpatialQueryAccelerator(){return null==this._octree&&this._objects.length>50&&!this._disableOctree?(this._octree=new c.A((t=>t.boundingVolumeWorldSpace.bounds)),this._octree.add(this._objects.data,this._objects.length)):null!=this._octree&&this._objectsAdded.length>0&&(this._octree.add(this._objectsAdded.data,this._objectsAdded.length),this._objectsAdded.clear()),this._octree}invalidateSpatialQueryAccelerator(){this._octree=(0,s.pR)(this._octree),this._objectsAdded.clear()}}},54407:function(t,e,i){"use strict";var n,r,s,o,a,h,l,c;i.d(e,{Am:function(){return o},C7:function(){return s},JS:function(){return c},Mg:function(){return h},dd:function(){return a},it:function(){return r},s2:function(){return n},sf:function(){return l}}),function(t){t[t.None=0]="None",t[t.Front=1]="Front",t[t.Back=2]="Back",t[t.COUNT=3]="COUNT"}(n||(n={})),function(t){t[t.Less=0]="Less",t[t.Lequal=1]="Lequal",t[t.COUNT=2]="COUNT"}(r||(r={})),function(t){t[t.BACKGROUND=0]="BACKGROUND",t[t.UPDATE=1]="UPDATE"}(s||(s={})),function(t){t[t.NOT_LOADED=0]="NOT_LOADED",t[t.LOADING=1]="LOADING",t[t.LOADED=2]="LOADED"}(o||(o={})),function(t){t[t.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",t[t.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(a||(a={})),function(t){t[t.Highlight=0]="Highlight",t[t.MaskOccludee=1]="MaskOccludee"}(h||(h={})),function(t){t[t.Blend=0]="Blend",t[t.Opaque=1]="Opaque",t[t.Mask=2]="Mask",t[t.MaskBlend=3]="MaskBlend",t[t.COUNT=4]="COUNT"}(l||(l={})),function(t){t.DDS_ENCODING="image/vnd-ms.dds",t.KTX2_ENCODING="image/ktx2",t.BASIS_ENCODING="image/x.basis"}(c||(c={}))},59356:function(t,e,i){"use strict";i.d(e,{i3:function(){return r}}),i(20551);var n=i(32501);function r(t){return null!=t?.dist}i(2075),i(38177),(0,n.vt)()},57701:function(t,e,i){"use strict";i.d(e,{$T:function(){return a},zj:function(){return r}});var n,r,s,o=i(23545);function a(t){const e=new Map,i=t=>{let i=e.get(t);return i||(i=new o.a0,e.set(t,i)),i};return t.removes.forAll((t=>{h(t)&&i(t.material).removes.push(t)})),t.adds.forAll((t=>{h(t)&&i(t.material).adds.push(t)})),t.updates.forAll((t=>{h(t.renderGeometry)&&i(t.renderGeometry.material).updates.push(t)})),e}function h(t){return t.geometry.indexCount>=1}(s=n||(n={}))[s.Default=0]="Default",s[s.Screenshot=1]="Screenshot",s[s.ObjectAndLayerID=2]="ObjectAndLayerID",function(t){t[t.TOP=0]="TOP",t[t.RIGHT=1]="RIGHT",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT"}(r||(r={}))},54035:function(t,e,i){"use strict";i.d(e,{MD:function(){return h},cJ:function(){return a},hs:function(){return l},m0:function(){return o}});var n=i(15774),r=(i(2075),i(13794));function s(t,e,i){const n=i.parameters;return c.scale=Math.min(n.divisor/(e-n.offset),1),c.factor=function(t){return Math.abs(t*t*t)}(t),c}function o(t,e){return(0,n.Cc)(t*Math.max(e.scale,e.minScaleFactor),t,e.factor)}function a(t,e,i,n){n.scale=function(t,e,i){const n=s(t,e,i);return n.minScaleFactor=0,o(1,n)}(t,e,i),n.factor=0,n.minScaleFactor=i.minScaleFactor}function h(t,e,i=[0,0]){const n=Math.min(Math.max(e.scale,e.minScaleFactor),1);return i[0]=t[0]*n,i[1]=t[1]*n,i}function l(t,e,i,n){return o(t,s(e,i,n))}i(65420),(0,n.kU)(10),(0,n.kU)(12),(0,n.kU)(70),(0,n.kU)(40);const c={scale:0,factor:0,minScaleFactor:0};(0,r.c)()},10228:function(t,e,i){"use strict";i.d(e,{G:function(){return n},Q:function(){return r}});const n={stableRendering:!1},r={rootOrigin:null}},12569:function(t,e,i){"use strict";i.d(e,{IR:function(){return a},Mv:function(){return s},uT:function(){return o},vM:function(){return h}});var n=i(39819);const r=16;function s(t){return Math.ceil(t/r)*r}function o(t){return Math.floor(t/r)*r}function a(t,e){let i=t.width*t.height;if(i<4096)return t instanceof ImageData?c(t):t;let n=t.width,r=t.height;do{n=Math.ceil(n/2),r=Math.ceil(r/2),i=n*r}while(i>1048576||null!=e&&(n>e||r>e));return l(t,n,r)}function h(t,e){const i=Math.max(t.width,t.height);if(i<=e)return t;const n=e/i;return l(t,Math.round(t.width*n),Math.round(t.height*n))}function l(t,e,i){if(t instanceof ImageData)return l(c(t),e,i);const n=document.createElement("canvas");return n.width=e,n.height=i,n.getContext("2d").drawImage(t,0,0,n.width,n.height),n}function c(t){const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");if(null==i)throw new n.A("Failed to create 2d context from HTMLCanvasElement");return i.putImageData(t,0,0),e}},22323:function(t,e,i){"use strict";i.d(e,{dg:function(){return d},ou:function(){return g}});var n=i(44705),r=i(87725),s=i(73364),o=i(39714),a=i(20551),h=i(32501),l=i(13794),c=i(65420),u=i(89765);class d{constructor(){this._transform=(0,o.vt)(),this._transformInverse=new f({value:this._transform},s.B8,o.vt),this._transformInverseTranspose=new f(this._transformInverse,s.mg,o.vt),this._transformTranspose=new f({value:this._transform},s.mg,o.vt),this._transformInverseRotation=new f({value:this._transform},n.dR,r.vt)}_invalidateLazyTransforms(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}get transform(){return this._transform}get inverse(){return this._transformInverse.value}get inverseTranspose(){return this._transformInverseTranspose.value}get inverseRotation(){return this._transformInverseRotation.value}get transpose(){return this._transformTranspose.value}setTransformMatrix(t){(0,s.C)(this._transform,t)}multiplyTransform(t){(0,s.lw)(this._transform,this._transform,t)}set(t){(0,s.C)(this._transform,t),this._invalidateLazyTransforms()}setAndInvalidateLazyTransforms(t,e){this.setTransformMatrix(t),this.multiplyTransform(e),this._invalidateLazyTransforms()}}class f{constructor(t,e,i){this._original=t,this._update=e,this._dirty=!0,this._transform=i()}invalidate(){this._dirty=!0}get value(){return this._dirty&&(this._update(this._transform,this._original.value),this._dirty=!1),this._transform}}const p=new class{constructor(t=0){this.offset=t,this.sphere=(0,l.c)(),this.tmpVertex=(0,h.vt)()}applyToVertex(t,e,i){const n=this.objectTransform.transform,r=(0,a.i)(v,t,e,i),s=(0,a.t)(r,r,n),o=this.offset/(0,a.l)(s);(0,a.b)(s,s,s,o);const h=this.objectTransform.inverse;return(0,a.t)(this.tmpVertex,s,h),this.tmpVertex}applyToMinMax(t,e){const i=this.offset/(0,a.l)(t);(0,a.b)(t,t,t,i);const n=this.offset/(0,a.l)(e);(0,a.b)(e,e,e,n)}applyToAabb(t){const e=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*e,t[1]+=t[1]*e,t[2]+=t[2]*e;const i=this.offset/Math.sqrt(t[3]*t[3]+t[4]*t[4]+t[5]*t[5]);return t[3]+=t[3]*i,t[4]+=t[4]*i,t[5]+=t[5]*i,t}applyToBoundingSphere(t){const e=(0,a.l)((0,l.a)(t)),i=this.offset/e;return(0,a.b)((0,l.a)(this.sphere),(0,l.a)(t),(0,l.a)(t),i),this.sphere[3]=t[3]+t[3]*this.offset/e,this.sphere}};function g(t){return null!=t?(p.offset=t,p):null}new class{constructor(t=0){this.componentLocalOriginLength=0,this._totalOffset=0,this._offset=0,this._tmpVertex=(0,h.vt)(),this._tmpMbs=(0,l.c)(),this._tmpObb=new u.ab,this._resetOffset(t)}_resetOffset(t){this._offset=t,this._totalOffset=t}set offset(t){this._resetOffset(t)}get offset(){return this._offset}set componentOffset(t){this._totalOffset=this._offset+t}set localOrigin(t){this.componentLocalOriginLength=(0,a.l)(t)}applyToVertex(t,e,i){const n=(0,a.i)(v,t,e,i),r=(0,a.i)(m,t,e,i+this.componentLocalOriginLength),s=this._totalOffset/(0,a.l)(r);return(0,a.b)(this._tmpVertex,n,r,s),this._tmpVertex}applyToAabb(t){const e=this.componentLocalOriginLength,i=t[0],n=t[1],r=t[2]+e,s=t[3],o=t[4],a=t[5]+e,h=Math.abs(i),l=Math.abs(n),c=Math.abs(r),u=Math.abs(s),d=Math.abs(o),f=Math.abs(a),p=.5*(1+Math.sign(i*s))*Math.min(h,u),g=.5*(1+Math.sign(n*o))*Math.min(l,d),v=.5*(1+Math.sign(r*a))*Math.min(c,f),m=Math.max(h,u),y=Math.max(l,d),_=Math.max(c,f),b=Math.sqrt(p*p+g*g+v*v),w=Math.sign(h+i),x=Math.sign(l+n),T=Math.sign(c+r),A=Math.sign(u+s),M=Math.sign(d+o),S=Math.sign(f+a),E=this._totalOffset;if(b<E)return t[0]-=(1-w)*E,t[1]-=(1-x)*E,t[2]-=(1-T)*E,t[3]+=A*E,t[4]+=M*E,t[5]+=S*E,t;const C=E/Math.sqrt(m*m+y*y+_*_),O=E/b,R=O-C,I=-R;return t[0]+=i*(w*I+O),t[1]+=n*(x*I+O),t[2]+=r*(T*I+O),t[3]+=s*(A*R+C),t[4]+=o*(M*R+C),t[5]+=a*(S*R+C),t}applyToMbs(t){const e=(0,a.l)((0,l.a)(t)),i=this._totalOffset/e;return(0,a.b)((0,l.a)(this._tmpMbs),(0,l.a)(t),(0,l.a)(t),i),this._tmpMbs[3]=t[3]+t[3]*this._totalOffset/e,this._tmpMbs}applyToObb(t){return(0,u.gm)(t,this._totalOffset,this._totalOffset,c.RT.Global,this._tmpObb),this._tmpObb}},new class{constructor(t=0){this.offset=t,this.tmpVertex=(0,h.vt)()}applyToVertex(t,e,i){const n=(0,a.i)(v,t,e,i),r=(0,a.g)(m,n,this.localOrigin),s=this.offset/(0,a.l)(r);return(0,a.b)(this.tmpVertex,n,r,s),this.tmpVertex}applyToAabb(t){const e=y,i=_,n=b;for(let r=0;r<3;++r)e[r]=t[0+r]+this.localOrigin[r],i[r]=t[3+r]+this.localOrigin[r],n[r]=e[r];const r=this.applyToVertex(e[0],e[1],e[2]);for(let e=0;e<3;++e)t[e]=r[e],t[e+3]=r[e];const s=e=>{const i=this.applyToVertex(e[0],e[1],e[2]);for(let e=0;e<3;++e)t[e]=Math.min(t[e],i[e]),t[e+3]=Math.max(t[e+3],i[e])};for(let t=1;t<8;++t){for(let r=0;r<3;++r)n[r]=t&1<<r?i[r]:e[r];s(n)}let o=0;for(let t=0;t<3;++t)e[t]*i[t]<0&&(o|=1<<t);if(0!==o&&7!==o)for(let t=0;t<8;++t)if(!(o&t)){for(let r=0;r<3;++r)n[r]=o&1<<r?0:t&1<<r?e[r]:i[r];s(n)}for(let e=0;e<3;++e)t[e]-=this.localOrigin[e],t[e+3]-=this.localOrigin[e];return t}};const v=(0,h.vt)(),m=(0,h.vt)(),y=(0,h.vt)(),_=(0,h.vt)(),b=(0,h.vt)()},35910:function(t,e,i){"use strict";i.d(e,{$p:function(){return r},Qx:function(){return o},_y:function(){return s},e_:function(){return a}});var n=i(32501);class r{constructor(t=(0,n.Ul)()){this.intensity=t}}class s{constructor(t=(0,n.Ul)(),e=(0,n.fA)(.57735,.57735,.57735)){this.intensity=t,this.direction=e}}class o{constructor(t=(0,n.Ul)(),e=(0,n.fA)(.57735,.57735,.57735),i=!0,r=1,s=1){this.intensity=t,this.direction=e,this.castShadows=i,this.specularStrength=r,this.environmentStrength=s}}class a{constructor(){this.r=[0],this.g=[0],this.b=[0]}}},95629:function(t,e,i){"use strict";i.d(e,{TA:function(){return M},uH:function(){return A}});var n=i(15774),r=i(20551),s=i(32501),o=i(35910);function a(t,e,i){(i=i||t).length=t.length;for(let n=0;n<t.length;n++)i[n]=t[n]*e[n];return i}function h(t,e,i){(i=i||t).length=t.length;for(let n=0;n<t.length;n++)i[n]=t[n]*e;return i}function l(t,e,i){(i=i||t).length=t.length;for(let n=0;n<t.length;n++)i[n]=t[n]+e[n];return i}function c(t){return(t+1)*(t+1)}function u(t,e,i){const n=t[0],r=t[1],s=t[2],o=i||[];return o.length=c(e),e>=0&&(o[0]=.28209479177),e>=1&&(o[1]=.4886025119*n,o[2]=.4886025119*s,o[3]=.4886025119*r),e>=2&&(o[4]=1.09254843059*n*r,o[5]=1.09254843059*r*s,o[6]=.31539156525*(3*s*s-1),o[7]=1.09254843059*n*s,o[8]=.54627421529*(n*n-r*r)),o}function d(t,e){const i=c(t),n=e||{r:[],g:[],b:[]};n.r.length=n.g.length=n.b.length=i;for(let t=0;t<i;t++)n.r[t]=n.g[t]=n.b[t]=0;return n}function f(t,e){const i=function(t){return(0,n.qE)(Math.floor(Math.sqrt(t)-1),0,2)}(e.r.length);for(const n of t)(0,r.v)(b,n.direction),u(b,i,y),a(y,w),h(y,n.intensity[0],_),l(e.r,_),h(y,n.intensity[1],_),l(e.g,_),h(y,n.intensity[2],_),l(e.b,_);return e}function p(t,e){u(b,0,y);for(const i of t)e.r[0]+=y[0]*w[0]*i.intensity[0]*4*Math.PI,e.g[0]+=y[0]*w[0]*i.intensity[1]*4*Math.PI,e.b[0]+=y[0]*w[0]*i.intensity[2]*4*Math.PI;return e}const g=[],v=[],m=[],y=[0],_=[0],b=(0,s.vt)(),w=[3.141593,2.094395,2.094395,2.094395,.785398,.785398,.785398,.785398,.785398];class x{constructor(){this.color=(0,s.vt)(),this.intensity=1}}class T{constructor(){this.direction=(0,s.vt)(),this.ambient=new x,this.diffuse=new x}}const A=.4;class M{constructor(){this._shOrder=2,this._legacy=new T,this.globalFactor=.5,this.noonFactor=.5,this._sphericalHarmonics=new o.e_,this._mainLight=new o.Qx((0,s.vt)(),(0,s.fA)(1,0,0),!1)}get legacy(){return this._legacy}get sh(){return this._sphericalHarmonics}get mainLight(){return this._mainLight}set(t){(function(t,e,i,n){d(e,n),(0,r.i)(i.intensity,0,0,0);let s=!1;const a=g,h=v,c=m;a.length=0,h.length=0,c.length=0;for(const e of t)e instanceof o.Qx&&!s?((0,r.c)(i.direction,e.direction),(0,r.c)(i.intensity,e.intensity),i.specularStrength=e.specularStrength,i.environmentStrength=e.environmentStrength,i.castShadows=e.castShadows,s=!0):e instanceof o.Qx||e instanceof o._y?a.push(e):e instanceof o.$p?h.push(e):e instanceof o.e_&&c.push(e);f(a,n),p(h,n);for(const t of c)l(n.r,t.r),l(n.g,t.g),l(n.b,t.b)})(t,this._shOrder,this._mainLight,this._sphericalHarmonics),(0,r.c)(this._legacy.direction,this._mainLight.direction);const e=1/Math.PI;this._legacy.ambient.color[0]=.282095*this._sphericalHarmonics.r[0]*e,this._legacy.ambient.color[1]=.282095*this._sphericalHarmonics.g[0]*e,this._legacy.ambient.color[2]=.282095*this._sphericalHarmonics.b[0]*e,(0,r.h)(this._legacy.diffuse.color,this._mainLight.intensity,e),(0,r.c)(S,this._legacy.diffuse.color),(0,r.h)(S,S,A*this.globalFactor),(0,r.g)(this._legacy.ambient.color,this._legacy.ambient.color,S)}copyFrom(t){this._sphericalHarmonics.r=Array.from(t.sh.r),this._sphericalHarmonics.g=Array.from(t.sh.g),this._sphericalHarmonics.b=Array.from(t.sh.b),(0,r.c)(this._mainLight.direction,t.mainLight.direction),(0,r.c)(this._mainLight.intensity,t.mainLight.intensity),this._mainLight.castShadows=t.mainLight.castShadows,this._mainLight.specularStrength=t.mainLight.specularStrength,this._mainLight.environmentStrength=t.mainLight.environmentStrength,this.globalFactor=t.globalFactor,this.noonFactor=t.noonFactor}lerpLighting(t,e,i){if((0,r.m)(this._mainLight.intensity,t.mainLight.intensity,e.mainLight.intensity,i),this._mainLight.environmentStrength=(0,n.Cc)(t.mainLight.environmentStrength,e.mainLight.environmentStrength,i),this._mainLight.specularStrength=(0,n.Cc)(t.mainLight.specularStrength,e.mainLight.specularStrength,i),(0,r.c)(this._mainLight.direction,e.mainLight.direction),this._mainLight.castShadows=e.mainLight.castShadows,this.globalFactor=(0,n.Cc)(t.globalFactor,e.globalFactor,i),this.noonFactor=(0,n.Cc)(t.noonFactor,e.noonFactor,i),t.sh.r.length===e.sh.r.length)for(let r=0;r<e.sh.r.length;r++)this._sphericalHarmonics.r[r]=(0,n.Cc)(t.sh.r[r],e.sh.r[r],i),this._sphericalHarmonics.g[r]=(0,n.Cc)(t.sh.g[r],e.sh.g[r],i),this._sphericalHarmonics.b[r]=(0,n.Cc)(t.sh.b[r],e.sh.b[r],i);else for(let t=0;t<e.sh.r.length;t++)this._sphericalHarmonics.r[t]=e.sh.r[t],this._sphericalHarmonics.g[t]=e.sh.g[t],this._sphericalHarmonics.b[t]=e.sh.b[t]}}const S=(0,s.vt)()},48042:function(t,e,i){"use strict";i.d(e,{v:function(){return I}});var n=i(41546),r=i(65856),s=i(27264),o=i(28686),a=i(39534),h=i(54407),l=i(4875),c=i(46921),u=i(29165),d=i(65839),f=i(84264),p=i(27291),g=i(77971),v=i(34615),m=i(82273),y=i(54840),_=i(6200),b=i(38474),w=i(85456),x=i(57087);g.S;class T extends m.w{constructor(t,e,n){super(t,e,new v.$(b.C,(()=>i.e(2523).then(i.bind(i,62970)))),n)}_createPipeline(t,e){const{oitPass:i,output:n,transparent:r,cullFace:o,draped:a,hasOccludees:h,polygonOffset:l,enableOffset:u}=t,d=i===y.Y.NONE,f=i===y.Y.FrontFace;return(0,x.Ey)({blending:n===s.V.Color&&r?(0,c.Yf)(i):null,culling:(0,x.Xt)(o),depthTest:a?null:{func:(0,c.K_)(i)},depthWrite:(0,c.z5)(t),drawBuffers:n===s.V.Depth?{buffers:[w.Hr.NONE]}:(0,c.m6)(i,n),colorWrite:x.kn,stencilWrite:h?_.v0:null,stencilTest:h?e?_.a9:_.qh:null,polygonOffset:d||f?l?A:null:(0,c.aB)(u)})}initializePipeline(t){return this._occludeePipelineState=this._createPipeline(t,!0),this._createPipeline(t,!1)}getPipeline(t){return t?this._occludeePipelineState:super.getPipeline()}}const A={factor:1,units:1};var M=i(53804),S=i(2457),E=i(38130),C=i(65875),O=i(22095);class R extends O.E{constructor(){super(...arguments),this.cullFace=h.s2.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=S.I.None,this.emissionSource=E.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}(0,M._)([(0,C.W)({count:h.s2.COUNT})],R.prototype,"cullFace",void 0),(0,M._)([(0,C.W)()],R.prototype,"hasSlicePlane",void 0),(0,M._)([(0,C.W)()],R.prototype,"hasVertexColors",void 0),(0,M._)([(0,C.W)()],R.prototype,"transparent",void 0),(0,M._)([(0,C.W)()],R.prototype,"discardInvisibleFragments",void 0),(0,M._)([(0,C.W)()],R.prototype,"polygonOffset",void 0),(0,M._)([(0,C.W)()],R.prototype,"enableOffset",void 0),(0,M._)([(0,C.W)()],R.prototype,"writeDepth",void 0),(0,M._)([(0,C.W)()],R.prototype,"hasOccludees",void 0),(0,M._)([(0,C.W)()],R.prototype,"terrainDepthTest",void 0),(0,M._)([(0,C.W)()],R.prototype,"cullAboveTerrain",void 0),(0,M._)([(0,C.W)()],R.prototype,"objectAndLayerIdColorInstanced",void 0),(0,M._)([(0,C.W)()],R.prototype,"vvColor",void 0),(0,M._)([(0,C.W)()],R.prototype,"draped",void 0);class I extends p.W{constructor(t){super(t,N),this._configuration=new R,this.supportsEdges=!0,this.produces=new Map([[u.N.OPAQUE_MATERIAL,t=>this._isOpaqueMaterialPass(t)],[u.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,t=>this._isOpaqueNoSSAODepthPass(t)],[u.N.TRANSPARENT_MATERIAL,t=>(0,s.zW)(t)&&this._transparent&&this.parameters.writeDepth],[u.N.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,t=>(0,s.eh)(t)&&this._transparent&&this.parameters.writeDepth],[u.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>(0,s.zW)(t)&&this._transparent&&!this.parameters.writeDepth],[u.N.DRAPED_MATERIAL,t=>(0,s.i3)(t)]])}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(t)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=e.hasOccludees,this._configuration.oitPass=e.oitPass,this._configuration.enableOffset=e.camera.relativeElevation<c.xt,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=o.Q}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(t){return this._isOpaqueMaterialPass(t)||this._isOpaqueNoSSAODepthPass(t)}_isOpaqueMaterialPass(t){return t===s.V.Highlight||(0,s.zW)(t)&&!this._transparent}_isOpaqueNoSSAODepthPass(t){return(0,s.eh)(t)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(t){return new P(t)}createBufferWriter(){const t=(0,r.BP)().vec3f(d.r.POSITION);return(0,a.E)()&&t.vec4u8(d.r.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?t.f32(d.r.COLORFEATUREATTRIBUTE):t.vec4u8(d.r.COLOR),new f.Z(t)}}class P extends l.A{beginSlot(t){return this.acquireTechnique(T,t)}}class N extends g.S{constructor(){super(...arguments),this.color=n.uY,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=h.s2.None,this.draped=!1,this.discardInvisibleFragments=!1}}},84264:function(t,e,i){"use strict";i.d(e,{Z:function(){return s}});var n=i(65839),r=i(93678);class s{constructor(t){this.vertexBufferLayout=t}elementCount(t){return t.get(n.r.POSITION).indices.length}write(t,e,i,n,s,o){(0,r.SA)(i,n,this.vertexBufferLayout,t,e,s,o)}}},73318:function(t,e,i){"use strict";i.d(e,{Ci:function(){return s},Dq:function(){return h},dB:function(){return a},zK:function(){return o}});var n=i(65856),r=i(65839);const s=(0,n.BP)().vec3f(r.r.POSITION),o=(0,n.BP)().vec3f(r.r.POSITION).vec2f(r.r.UV0),a=(0,n.BP)().vec3f(r.r.POSITION).vec4u8(r.r.COLOR),h=(0,n.BP)().vec3f(r.r.POSITION).vec2f(r.r.UV0).vec4u8(r.r.OBJECTANDLAYERIDCOLOR)},22095:function(t,e,i){"use strict";i.d(e,{E:function(){return l}});var n=i(53804),r=i(27264),s=i(65875);class o extends s.K{constructor(){super(...arguments),this.instancedDoublePrecision=!1,this.hasModelTransformation=!1}}(0,n._)([(0,s.W)()],o.prototype,"instancedDoublePrecision",void 0),(0,n._)([(0,s.W)()],o.prototype,"hasModelTransformation",void 0);var a=i(54516),h=i(54840);class l extends o{constructor(){super(...arguments),this.output=r.V.Color,this.oitPass=h.Y.NONE,this.hasSliceHighlight=!0,this.hasSliceInVertexProgram=!1,this.bindType=a.c.Pass,this.writeDepth=!0}}(0,n._)([(0,s.W)({count:r.V.COUNT})],l.prototype,"output",void 0),(0,n._)([(0,s.W)({count:h.Y.COUNT})],l.prototype,"oitPass",void 0)},51564:function(t,e,i){"use strict";i.d(e,{P:function(){return s}});var n=i(32501),r=i(94211);class s extends r.gy{constructor(t=(0,n.vt)()){super(),this.origin=t}get slicePlaneLocalOrigin(){return this.origin}}},6955:function(t,e,i){"use strict";i.d(e,{R:function(){return W}});var n=i(15774),r=i(44705),s=i(87725),o=i(73364),a=i(39714),h=i(13786),l=i(1932),c=i(20551),u=i(32501),d=i(41546);var f=i(87416),p=i(92754),g=i(24129),v=i(70974),m=i(65856),y=i(27264),_=i(1143),b=i(28686),w=i(39534),x=i(36634),T=i(24100),A=i(29165),M=i(54035),S=i(90553),E=i(65839);class C{constructor(){this.scale=0,this.factor=0,this.minScaleFactor=0}}var O=i(93678),R=i(84887),I=i(88008),P=i(34615),N=i(82273),D=i(54840),L=i(46921),z=i(85456),j=i(57087);class k extends N.w{constructor(t,e,n){super(t,e,new P.$(I.H,(()=>i.e(8121).then(i.bind(i,47416)))),n),this.primitiveType=e.occlusionPass?z.WR.POINTS:z.WR.TRIANGLES}initializePipeline(t){const{oitPass:e,hasPolygonOffset:i,draped:n,output:r,depthTestEnabled:s}=t,o=e===D.Y.NONE,a=i?F:null,h=e===D.Y.ColorAlpha,l=n||!s||h||r===y.V.Highlight?null:j.Uy;return(0,j.Ey)({blending:r===y.V.Color?o?j.Os:(0,L.ez)(e):null,depthTest:s&&!n?{func:z.MT.LEQUAL}:null,depthWrite:l,drawBuffers:(0,L.m6)(e,r),colorWrite:j.kn,polygonOffset:a})}}const F={factor:0,units:-4};var H=i(53804),B=i(2457),G=i(38130),V=i(65875),U=i(22095);class $ extends U.E{constructor(t){super(),this.spherical=t,this.screenCenterOffsetUnitsEnabled=!1,this.occlusionTestEnabled=!0,this.signedDistanceFieldEnabled=!1,this.sampleSignedDistanceFieldTexelCenter=!1,this.vvSize=!1,this.vvColor=!1,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.hasRotation=!1,this.debugDrawLabelBorder=!1,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.depthTestEnabled=!0,this.pixelSnappingEnabled=!0,this.draped=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.occlusionPass=!1,this.occludedFragmentFade=!1,this.objectAndLayerIdColorInstanced=!1,this.horizonCullingEnabled=!0,this.textureCoordinateType=B.I.None,this.emissionSource=G.ZX.None,this.discardInvisibleFragments=!0,this.hasSliceInVertexProgram=!0,this.hasVvInstancing=!1}}(0,H._)([(0,V.W)()],$.prototype,"screenCenterOffsetUnitsEnabled",void 0),(0,H._)([(0,V.W)()],$.prototype,"occlusionTestEnabled",void 0),(0,H._)([(0,V.W)()],$.prototype,"signedDistanceFieldEnabled",void 0),(0,H._)([(0,V.W)()],$.prototype,"sampleSignedDistanceFieldTexelCenter",void 0),(0,H._)([(0,V.W)()],$.prototype,"vvSize",void 0),(0,H._)([(0,V.W)()],$.prototype,"vvColor",void 0),(0,H._)([(0,V.W)()],$.prototype,"hasVerticalOffset",void 0),(0,H._)([(0,V.W)()],$.prototype,"hasScreenSizePerspective",void 0),(0,H._)([(0,V.W)()],$.prototype,"hasRotation",void 0),(0,H._)([(0,V.W)()],$.prototype,"debugDrawLabelBorder",void 0),(0,H._)([(0,V.W)()],$.prototype,"hasSlicePlane",void 0),(0,H._)([(0,V.W)()],$.prototype,"hasPolygonOffset",void 0),(0,H._)([(0,V.W)()],$.prototype,"depthTestEnabled",void 0),(0,H._)([(0,V.W)()],$.prototype,"pixelSnappingEnabled",void 0),(0,H._)([(0,V.W)()],$.prototype,"draped",void 0),(0,H._)([(0,V.W)()],$.prototype,"terrainDepthTest",void 0),(0,H._)([(0,V.W)()],$.prototype,"cullAboveTerrain",void 0),(0,H._)([(0,V.W)()],$.prototype,"occlusionPass",void 0),(0,H._)([(0,V.W)()],$.prototype,"occludedFragmentFade",void 0),(0,H._)([(0,V.W)()],$.prototype,"objectAndLayerIdColorInstanced",void 0),(0,H._)([(0,V.W)()],$.prototype,"horizonCullingEnabled",void 0);class W extends T.im{constructor(t,e){super(t,gt),this.produces=new Map([[A.N.HUD_MATERIAL,t=>(0,y.dX)(t)&&!this.parameters.drawInSecondSlot],[A.N.LABEL_MATERIAL,t=>(0,y.dX)(t)&&this.parameters.drawInSecondSlot],[A.N.OCCLUSION_PIXELS,()=>this.parameters.occlusionTest],[A.N.DRAPED_MATERIAL,t=>this.parameters.draped&&(0,y.dX)(t)]]),this._visible=!0,this._configuration=new $(e)}getConfiguration(t,e){return this._configuration.output=t,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVerticalOffset=!!this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=!!this.parameters.screenSizePerspective,this._configuration.screenCenterOffsetUnitsEnabled="screen"===this.parameters.centerOffsetUnits,this._configuration.hasPolygonOffset=this.parameters.polygonOffset,this._configuration.draped=this.parameters.draped,this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.pixelSnappingEnabled=this.parameters.pixelSnappingEnabled,this._configuration.signedDistanceFieldEnabled=this.parameters.textureIsSignedDistanceField,this._configuration.sampleSignedDistanceFieldTexelCenter=this.parameters.sampleSignedDistanceFieldTexelCenter,this._configuration.hasRotation=this.parameters.hasRotation,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.occlusionPass=e.slot===A.N.OCCLUSION_PIXELS,this._configuration.occludedFragmentFade=this.parameters.occludedFragmentFade,this._configuration.horizonCullingEnabled=this.parameters.horizonCullingEnabled,this._configuration.depthTestEnabled=this.parameters.depthEnabled||e.slot===A.N.OCCLUSION_PIXELS,t===y.V.Color&&(this._configuration.debugDrawLabelBorder=!!v.b.LABELS_SHOW_BORDER),this._configuration.oitPass=e.oitPass,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration}intersect(t,e,i,n,s,a){const{options:{selectionMode:h,hud:l,excludeLabels:d},point:f,camera:p}=i,{parameters:g}=this;if(!h||!l||d&&g.isLabel||!t.visible||!f)return;const{scaleX:v,scaleY:m}=this._getScreenScale(t,p.pixelRatio);(0,r.z0)(rt,e),t.attributes.has(E.r.FEATUREATTRIBUTE)&&function(t){const e=t[0],i=t[1],n=t[2],r=t[3],s=t[4],o=t[5],a=t[6],h=t[7],l=t[8],c=1/Math.sqrt(e*e+i*i+n*n),u=1/Math.sqrt(r*r+s*s+o*o),d=1/Math.sqrt(a*a+h*h+l*l);t[0]=e*c,t[1]=i*c,t[2]=n*c,t[3]=r*u,t[4]=s*u,t[5]=o*u,t[6]=a*d,t[7]=h*d,t[8]=l*d}(rt);const y=t.attributes.get(E.r.POSITION),_=t.attributes.get(E.r.SIZE),b=t.attributes.get(E.r.NORMAL),w=t.attributes.get(E.r.ROTATION),x=t.attributes.get(E.r.CENTEROFFSETANDDISTANCE);(0,S.vA)(y.size>=3);const T=(0,I.c)(g),A="screen"===this.parameters.centerOffsetUnits;for(let t=0;t<y.data.length/y.size;t++){const n=t*y.size;(0,c.i)(K,y.data[n],y.data[n+1],y.data[n+2]),(0,c.t)(K,K,e),(0,c.t)(K,K,p.viewMatrix);const r=t*x.size;if((0,c.i)(at,x.data[r],x.data[r+1],x.data[r+2]),!A&&(K[0]+=at[0],K[1]+=at[1],0!==at[2])){const t=at[2];(0,c.n)(at,K),(0,c.d)(K,K,(0,c.h)(at,at,t))}const s=t*b.size;if((0,c.i)(J,b.data[s],b.data[s+1],b.data[s+2]),Z(J,rt,p,ct),this._applyVerticalOffsetTransformationView(K,ct,p,X),p.applyProjection(K,Q),Q[0]>-1){A&&(at[0]||at[1])&&(Q[0]+=at[0]*p.pixelRatio,0!==at[1]&&(Q[1]+=(0,M.m0)(at[1],X.factorAlignment)*p.pixelRatio),p.unapplyProjection(Q,K)),Q[0]+=this.parameters.screenOffset[0]*p.pixelRatio,Q[1]+=this.parameters.screenOffset[1]*p.pixelRatio,Q[0]=Math.floor(Q[0]),Q[1]=Math.floor(Q[1]);const e=t*_.size;ft[0]=_.data[e],ft[1]=_.data[e+1],(0,M.MD)(ft,X.factor,ft);const n=ut*p.pixelRatio;let r=0;g.textureIsSignedDistanceField&&(r=Math.min(g.outlineSize,.5*ft[0])*p.pixelRatio/2),ft[0]*=v,ft[1]*=m;const s=t*w.size,h=g.rotation+w.data[s];if(Y(f,Q[0],Q[1],ft,n,r,h,g,T)){const t=i.ray;if((0,c.t)(et,K,(0,o.B8)(ot,p.viewMatrix)),Q[0]=f[0],Q[1]=f[1],p.unprojectFromRenderScreen(Q,K)){const e=(0,u.vt)();(0,c.c)(e,t.direction);const i=1/(0,c.l)(e);(0,c.h)(e,e,i),a((0,c.j)(t.origin,K)*i,e,-1,!0,1,et)}}}}}intersectDraped(t,e,i,n,r,s){const o=t.attributes.get(E.r.POSITION),a=t.attributes.get(E.r.SIZE),h=t.attributes.get(E.r.ROTATION),l=this.parameters,c=(0,I.c)(l),{scaleX:u,scaleY:d}=this._getScreenScale(t,t.screenToWorldRatio),f=dt*t.screenToWorldRatio;for(let e=0;e<o.data.length/o.size;e++){const i=e*o.size,p=o.data[i],g=o.data[i+1],v=e*a.size;ft[0]=a.data[v],ft[1]=a.data[v+1];let m=0;l.textureIsSignedDistanceField&&(m=Math.min(l.outlineSize,.5*ft[0])*t.screenToWorldRatio/2),ft[0]*=u,ft[1]*=d;const y=e*h.size,_=l.rotation+h.data[y];Y(n,p,g,ft,f,m,_,l,c)&&r(s.dist,s.normal,-1,!1)}}createBufferWriter(){return new yt}_updateScaleInfo(t,e,i){const n=this.parameters;null!=n.screenSizePerspective?(0,M.cJ)(i,e,n.screenSizePerspective,t.factor):(t.factor.scale=1,t.factor.factor=0,t.factor.minScaleFactor=0),null!=n.screenSizePerspectiveAlignment?(0,M.cJ)(i,e,n.screenSizePerspectiveAlignment,t.factorAlignment):(t.factorAlignment.factor=t.factor.factor,t.factorAlignment.scale=t.factor.scale,t.factorAlignment.minScaleFactor=t.factor.minScaleFactor)}applyShaderOffsetsView(t,e,i,n,r,s,o){const a=Z(e,i,r,ct);return this._applyVerticalGroundOffsetView(t,a,r,o),this._applyVerticalOffsetTransformationView(o,a,r,s),this._applyPolygonOffsetView(o,a,n[3],r,o),this._applyCenterOffsetView(o,n,o),o}applyShaderOffsetsNDC(t,e,i,n,r){return this._applyCenterOffsetNDC(t,e,i,n),null!=r&&(0,c.c)(r,n),this._applyPolygonOffsetNDC(n,e,i,n),n}_applyPolygonOffsetView(t,e,i,r,s){const o=r.aboveGround?1:-1;let a=Math.sign(i);0===a&&(a=o);const h=o*a;if(this.parameters.shaderPolygonOffset<=0)return(0,c.c)(s,t);const l=(0,n.qE)(Math.abs(e.cosAngle),.01,1),u=1-Math.sqrt(1-l*l)/l/r.viewport[2];return(0,c.h)(s,t,h>0?u:1/u),s}_applyVerticalGroundOffsetView(t,e,i,n){const r=(0,c.l)(t),s=i.aboveGround?1:-1,o=i.computeRenderPixelSizeAtDist(r)*_.R,a=(0,c.h)(K,e.normal,s*o);return(0,c.g)(n,t,a),n}_applyVerticalOffsetTransformationView(t,e,i,n){const r=this.parameters;if(!r.verticalOffset?.screenLength){if(r.screenSizePerspective||r.screenSizePerspectiveAlignment){const i=(0,c.l)(t);this._updateScaleInfo(n,i,e.cosAngle)}else n.factor.scale=1,n.factorAlignment.scale=1;return t}const s=(0,c.l)(t),o=r.screenSizePerspectiveAlignment??r.screenSizePerspective,a=(0,R.kE)(i,s,r.verticalOffset,e.cosAngle,o);return this._updateScaleInfo(n,s,e.cosAngle),(0,c.h)(e.normal,e.normal,a),(0,c.g)(t,t,e.normal)}_applyCenterOffsetView(t,e,i){const n="screen"!==this.parameters.centerOffsetUnits;return i!==t&&(0,c.c)(i,t),n&&(i[0]+=e[0],i[1]+=e[1],e[2]&&((0,c.n)(J,i),(0,c.g)(i,i,(0,c.h)(J,J,e[2])))),i}_applyCenterOffsetNDC(t,e,i,n){const r="screen"!==this.parameters.centerOffsetUnits;return n!==t&&(0,c.c)(n,t),r||(n[0]+=e[0]/i.fullWidth*2,n[1]+=e[1]/i.fullHeight*2),n}_applyPolygonOffsetNDC(t,e,i,n){const r=this.parameters.shaderPolygonOffset;if(t!==n&&(0,c.c)(n,t),r){const t=i.aboveGround?1:-1,s=t*Math.sign(e[3]);n[2]-=(s||t)*r}return n}set visible(t){this._visible=t}get visible(){const{color:t,outlineSize:e,outlineColor:i}=this.parameters,n=t[3]>=b.Q||e>=b.Q&&i[3]>=b.Q;return this._visible&&n}createGLMaterial(t){return new q(t)}calculateRelativeScreenBounds(t,e,i=(0,f.vt)()){return function(t,e,i,n){n[0]=t.anchorPosition[0]*-e[0]+t.screenOffset[0]*i,n[1]=t.anchorPosition[1]*-e[1]+t.screenOffset[1]*i}(this.parameters,t,e,i),i[2]=i[0]+t[0],i[3]=i[1]+t[1],i}_getScreenScale(t,e){const i=t.attributes.get(E.r.FEATUREATTRIBUTE);if(null==i)return{scaleX:e,scaleY:e};const n=(0,d.ci)(i.data,lt);return(0,g.VC)(ht,this.parameters,n),{scaleX:ht[0]*e,scaleY:ht[1]*e}}}class q extends x.m8{constructor(t){super({...t,...t.material.parameters})}beginSlot(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.acquireTechnique(k,t)}}function Z(t,e,i,n){return function(t){return(e=t)instanceof Float32Array&&e.length>=16||function(t){return Array.isArray(t)&&t.length>=16}(t);var e}(e)&&(e=(0,r.z0)(st,e)),(0,c.q)(n.normal,t,e),(0,c.t)(n.normal,n.normal,i.viewInverseTransposeMatrix),n.cosAngle=(0,c.f)(tt,pt),n}function Y(t,e,i,r,s,o,a,l,c){let u=e-s-r[0]*c[0],d=u+r[0]+2*s,f=i-s-r[1]*c[1],p=f+r[1]+2*s;const g=l.distanceFieldBoundingBox;return l.textureIsSignedDistanceField&&null!=g&&(u+=r[0]*g[0],f+=r[1]*g[1],d-=r[0]*(1-g[2]),p-=r[1]*(1-g[3]),u-=o,d+=o,f-=o,p+=o),(0,h.hZ)(nt,e,i),(0,h.e$)(it,t,nt,(0,n.kU)(a)),it[0]>u&&it[0]<d&&it[1]>f&&it[1]<p}const X=new class{constructor(){this.factor=new C,this.factorAlignment=new C}},K=(0,u.vt)(),J=(0,u.vt)(),Q=(0,d.vt)(),tt=(0,u.vt)(),et=(0,u.vt)(),it=(0,l.vt)(),nt=(0,l.vt)(),rt=(0,s.vt)(),st=(0,s.vt)(),ot=(0,a.vt)(),at=(0,u.vt)(),ht=(0,u.vt)(),lt=(0,d.vt)(),ct={normal:tt,cosAngle:0},ut=1,dt=2,ft=[0,0],pt=(0,u.fA)(0,0,1);class gt extends x.NV{constructor(){super(...arguments),this.renderOccluded=T.m$.Occlude,this.isDecoration=!1,this.color=(0,d.CN)(1,1,1,1),this.polygonOffset=!1,this.anchorPosition=(0,l.fA)(.5,.5),this.screenOffset=[0,0],this.shaderPolygonOffset=1e-5,this.textureIsSignedDistanceField=!1,this.sampleSignedDistanceFieldTexelCenter=!1,this.outlineColor=(0,d.CN)(1,1,1,1),this.outlineSize=0,this.rotation=0,this.hasRotation=!1,this.vvSizeEnabled=!1,this.vvSize=null,this.vvColor=null,this.vvOpacity=null,this.vvSymbolAnchor=null,this.vvSymbolRotationMatrix=null,this.hasSlicePlane=!1,this.pixelSnappingEnabled=!0,this.occlusionTest=!0,this.occludedFragmentFade=!1,this.horizonCullingEnabled=!1,this.centerOffsetUnits="world",this.drawInSecondSlot=!1,this.depthEnabled=!0,this.draped=!1,this.isLabel=!1}}const vt=(0,m.BP)().vec3f(E.r.POSITION).vec3f(E.r.NORMAL).vec2f(E.r.UV0).vec4u8(E.r.COLOR).vec2f(E.r.SIZE).f32(E.r.ROTATION).vec4f(E.r.CENTEROFFSETANDDISTANCE).vec4f(E.r.FEATUREATTRIBUTE),mt=vt.clone().vec4u8(E.r.OBJECTANDLAYERIDCOLOR);class yt{constructor(){this.vertexBufferLayout=(0,w.E)()?mt:vt}elementCount(t){return 6*t.get(E.r.POSITION).indices.length}write(t,e,i,n,r,s){(0,O.Hk)(i.get(E.r.POSITION),t,r.position,s,6),(0,O.p1)(i.get(E.r.NORMAL),e,r.normal,s,6);const o=i.get(E.r.UV0)?.data;let a=0,h=0,l=1,c=1;o&&o.length>=4&&(a=o[0],h=o[1],l=o[2],c=o[3]),l=Math.min(1.99999,l+1),c=Math.min(1.99999,c+1);let u=i.get(E.r.POSITION).indices.length,d=s;const f=r.uv0;for(let t=0;t<u;++t)f.set(d,0,a),f.set(d,1,h),d++,f.set(d,0,l),f.set(d,1,h),d++,f.set(d,0,l),f.set(d,1,c),d++,f.set(d,0,l),f.set(d,1,c),d++,f.set(d,0,a),f.set(d,1,c),d++,f.set(d,0,a),f.set(d,1,h),d++;(0,O.tb)(i.get(E.r.COLOR),4,r.color,s,6);const{data:g,indices:v}=i.get(E.r.SIZE);u=v.length;const m=r.size;d=s;for(let t=0;t<u;++t){const e=g[2*v[t]],i=g[2*v[t]+1];for(let t=0;t<6;++t)m.set(d,0,e),m.set(d,1,i),d++}if((0,O.uO)(i.get(E.r.ROTATION),r.rotation,s,6),i.get(E.r.CENTEROFFSETANDDISTANCE)?(0,O.Ut)(i.get(E.r.CENTEROFFSETANDDISTANCE),r.centerOffsetAndDistance,s,6):(0,O.Pq)(r.centerOffsetAndDistance,s,6*u),i.get(E.r.FEATUREATTRIBUTE)?(0,O.Ut)(i.get(E.r.FEATUREATTRIBUTE),r.featureAttribute,s,6):(0,O.Pq)(r.featureAttribute,s,6*u),null!=n){const t=i.get(E.r.POSITION)?.indices;if(t){const e=t.length,i=r.getField(E.r.OBJECTANDLAYERIDCOLOR,p.XP);(0,O.tH)(n,i,e,s,6)}}}}},65352:function(t,e,i){"use strict";i.d(e,{W:function(){return k}});var n=i(40633),r=i(15774),s=i(13520),o=i(13786),a=i(20551),h=i(32501),l=i(41546),c=i(69508),u=i(73313),d=i(5596),f=i(65856),p=i(27264),g=i(28686),v=i(39534),m=i(4875),y=i(24100),_=i(29165),b=i(90553),w=i(65839),x=i(77971),T=i(50678),A=i(35904),M=(i(58941),i(34615)),S=i(82273),E=i(54840),C=i(46921),O=i(6200),R=i(85456),I=i(57087);class P extends S.w{constructor(t,e,n){super(t,e,new M.$(A.R,(()=>i.e(3569).then(i.bind(i,75312)))),n,D),this.primitiveType=e.wireframe?R.WR.LINES:R.WR.TRIANGLE_STRIP}_makePipelineState(t,e){const{oitPass:i,output:n,hasOccludees:r,hasPolygonOffset:s}=t,o=i===E.Y.NONE,a=i===E.Y.FrontFace;return(0,I.Ey)({blending:t.output===p.V.Color?(0,C.Yf)(i):null,depthTest:{func:(0,C.K_)(i)},depthWrite:(0,C.z5)(t),drawBuffers:n===p.V.Depth?{buffers:[R.Hr.NONE]}:(0,C.m6)(i,n),colorWrite:I.kn,stencilWrite:r?O.v0:null,stencilTest:r?e?O.a9:O.qh:null,polygonOffset:o||a?s?N:null:C.SE})}initializePipeline(t){if(t.occluder){const e=t.hasPolygonOffset?N:null;this._occluderPipelineTransparent=(0,I.Ey)({blending:I.Ky,polygonOffset:e,depthTest:O.sf,depthWrite:null,colorWrite:I.kn,stencilWrite:null,stencilTest:O.mK,drawBuffers:t.output===p.V.Depth?{buffers:[R.Hr.NONE]}:null}),this._occluderPipelineOpaque=(0,I.Ey)({blending:I.Ky,polygonOffset:e,depthTest:O.sf,depthWrite:null,colorWrite:I.kn,stencilWrite:O.r8,stencilTest:O.I$,drawBuffers:t.output===p.V.Depth?{buffers:[R.Hr.NONE]}:null}),this._occluderPipelineMaskWrite=(0,I.Ey)({blending:null,polygonOffset:e,depthTest:O.m,depthWrite:null,colorWrite:null,stencilWrite:O.v0,stencilTest:O.a9,drawBuffers:t.output===p.V.Depth?{buffers:[R.Hr.NONE]}:null})}return this._occludeePipeline=this._makePipelineState(t,!0),this._makePipelineState(t,!1)}getPipeline(t,e){if(t)return this._occludeePipeline;switch(e){case _.N.TRANSPARENT_OCCLUDER_MATERIAL:return this._occluderPipelineTransparent??super.getPipeline();case _.N.OCCLUDER_MATERIAL:return this._occluderPipelineOpaque??super.getPipeline();default:return this._occluderPipelineMaskWrite??super.getPipeline()}}}const N={factor:0,units:-4},D=new Map([[w.r.POSITION,0],[w.r.PREVPOSITION,1],[w.r.NEXTPOSITION,2],[w.r.SUBDIVISIONFACTOR,3],[w.r.UV0,4],[w.r.COLOR,5],[w.r.COLORFEATUREATTRIBUTE,5],[w.r.SIZE,6],[w.r.SIZEFEATUREATTRIBUTE,6],[w.r.OPACITYFEATUREATTRIBUTE,7],[w.r.OBJECTANDLAYERIDCOLOR,8]]);var L,z,j=i(95736);(z=L||(L={}))[z.LEFT_JOIN_START=-2]="LEFT_JOIN_START",z[z.LEFT_JOIN_END=-1]="LEFT_JOIN_END",z[z.LEFT_CAP_START=-4]="LEFT_CAP_START",z[z.LEFT_CAP_END=-5]="LEFT_CAP_END",z[z.RIGHT_JOIN_START=2]="RIGHT_JOIN_START",z[z.RIGHT_JOIN_END=1]="RIGHT_JOIN_END",z[z.RIGHT_CAP_START=4]="RIGHT_CAP_START",z[z.RIGHT_CAP_END=5]="RIGHT_CAP_END";class k extends y.im{constructor(t){super(t,H),this._configuration=new j.Q,this.vertexAttributeLocations=D,this.produces=new Map([[_.N.OPAQUE_MATERIAL,t=>(0,p.CL)(t)||(0,p._o)(t)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.OPAQUE_MATERIAL_WITHOUT_NORMALS,t=>(0,p.eh)(t)],[_.N.OCCLUDER_MATERIAL,t=>(0,p.MO)(t)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_OCCLUDER_MATERIAL,t=>(0,p.MO)(t)&&this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_MATERIAL,t=>t===p.V.Color&&this.parameters.writeDepth&&this.parameters.renderOccluded!==y.m$.OccludeAndTransparentStencil],[_.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>t===p.V.Color&&!this.parameters.writeDepth&&this.parameters.renderOccluded!==y.m$.OccludeAndTransparentStencil],[_.N.DRAPED_MATERIAL,t=>(0,p.i3)(t)]])}getConfiguration(t,e){this._configuration.output=t,this._configuration.oitPass=e.oitPass,this._configuration.draped=e.slot===_.N.DRAPED_MATERIAL;const i=null!=this.parameters.stipplePattern&&t!==p.V.Highlight;return this._configuration.stippleEnabled=i,this._configuration.stippleOffColorEnabled=i&&null!=this.parameters.stippleOffColor,this._configuration.stipplePreferContinuous=i&&this.parameters.stipplePreferContinuous,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.roundJoins="round"===this.parameters.join,this._configuration.capType=this.parameters.cap,this._configuration.applyMarkerOffset=null!=this.parameters.markerParameters&&function(t){return t.anchor===T.kJ.Tip&&t.hideOnShortSegments&&"begin-end"===t.placement&&t.worldSpace}(this.parameters.markerParameters),this._configuration.hasPolygonOffset=this.parameters.hasPolygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.vvOpacity=!!this.parameters.vvOpacity,this._configuration.innerColorEnabled=this.parameters.innerWidth>0&&null!=this.parameters.innerColor,this._configuration.falloffEnabled=this.parameters.falloff>0,this._configuration.hasOccludees=e.hasOccludees,this._configuration.occluder=this.parameters.renderOccluded===y.m$.OccludeAndTransparentStencil,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration.wireframe=this.parameters.wireframe,this._configuration}get visible(){return this.parameters.color[3]>=g.Q||null!=this.parameters.stipplePattern&&(this.parameters.stippleOffColor?.[3]??0)>g.Q}intersectDraped({attributes:t,screenToWorldRatio:e},i,n,s,o,a){if(!n.options.selectionMode)return;const h=t.get(w.r.SIZE);let l=this.parameters.width;if(this.parameters.vvSize){const e=t.get(w.r.SIZEFEATUREATTRIBUTE).data[0];l*=(0,r.qE)(this.parameters.vvSize.offset[0]+e*this.parameters.vvSize.factor[0],this.parameters.vvSize.minSize[0],this.parameters.vvSize.maxSize[0])}else h&&(l*=h.data[0]);const c=s[0],u=s[1],d=(l/2+4)*e;let f=Number.MAX_VALUE,p=0;const g=t.get(w.r.POSITION).data,v=V(this.parameters,t)?g.length-2:g.length-5;for(let t=0;t<v;t+=3){const e=g[t],i=g[t+1],n=(t+3)%g.length,s=c-e,o=u-i,a=g[n]-e,h=g[n+1]-i,l=(0,r.qE)((a*s+h*o)/(a*a+h*h),0,1),d=a*l-s,v=h*l-o,m=d*d+v*v;m<f&&(f=m,p=t/3)}f<d*d&&o(a.dist,a.normal,p,!1)}intersect(t,e,i,s,h,l){if(!i.options.selectionMode||!t.visible)return;if(!(0,b.zH)(e))return void n.A.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial").error("intersection assumes a translation-only matrix");const f=t.attributes,p=f.get(w.r.POSITION).data;let g=this.parameters.width;if(this.parameters.vvSize){const t=f.get(w.r.SIZEFEATUREATTRIBUTE).data[0];g*=(0,r.qE)(this.parameters.vvSize.offset[0]+t*this.parameters.vvSize.factor[0],this.parameters.vvSize.minSize[0],this.parameters.vvSize.maxSize[0])}else f.has(w.r.SIZE)&&(g*=f.get(w.r.SIZE).data[0]);const v=i.camera,m=Z;(0,o.C)(m,i.point);const y=g*v.pixelRatio/2+4*v.pixelRatio;(0,a.i)(rt[0],m[0]-y,m[1]+y,0),(0,a.i)(rt[1],m[0]+y,m[1]+y,0),(0,a.i)(rt[2],m[0]+y,m[1]-y,0),(0,a.i)(rt[3],m[0]-y,m[1]-y,0);for(let t=0;t<4;t++)if(!v.unprojectFromRenderScreen(rt[t],st[t]))return;(0,d.Cr)(v.eye,st[0],st[1],ot),(0,d.Cr)(v.eye,st[1],st[2],at),(0,d.Cr)(v.eye,st[2],st[3],ht),(0,d.Cr)(v.eye,st[3],st[0],lt);let _=Number.MAX_VALUE,x=0;const T=V(this.parameters,f)?p.length-2:p.length-5;for(let t=0;t<T;t+=3){U[0]=p[t]+e[12],U[1]=p[t+1]+e[13],U[2]=p[t+2]+e[14];const i=(t+3)%p.length;if($[0]=p[i]+e[12],$[1]=p[i+1]+e[13],$[2]=p[i+2]+e[14],(0,d.mN)(ot,U)<0&&(0,d.mN)(ot,$)<0||(0,d.mN)(at,U)<0&&(0,d.mN)(at,$)<0||(0,d.mN)(ht,U)<0&&(0,d.mN)(ht,$)<0||(0,d.mN)(lt,U)<0&&(0,d.mN)(lt,$)<0)continue;if(v.projectToRenderScreen(U,Y),v.projectToRenderScreen($,X),Y[2]<0&&X[2]>0){(0,a.d)(W,U,$);const t=v.frustum,e=-(0,d.mN)(t[c.FB.NEAR],U)/(0,a.f)(W,(0,d.Qj)(t[c.FB.NEAR]));(0,a.h)(W,W,e),(0,a.g)(U,U,W),v.projectToRenderScreen(U,Y)}else if(Y[2]>0&&X[2]<0){(0,a.d)(W,$,U);const t=v.frustum,e=-(0,d.mN)(t[c.FB.NEAR],$)/(0,a.f)(W,(0,d.Qj)(t[c.FB.NEAR]));(0,a.h)(W,W,e),(0,a.g)($,$,W),v.projectToRenderScreen($,X)}else if(Y[2]<0&&X[2]<0)continue;Y[2]=0,X[2]=0;const n=(0,u.kb)((0,u.Cr)(Y,X,Q),m);n<_&&(_=n,(0,a.c)(K,U),(0,a.c)(J,$),x=t/3)}const A=i.rayBegin,M=i.rayEnd;if(_<y*y){let t=Number.MAX_VALUE;if((0,u.ld)((0,u.Cr)(K,J,Q),(0,u.Cr)(A,M,tt),q)){(0,a.d)(q,q,A);const e=(0,a.l)(q);(0,a.h)(q,q,1/e),t=e/(0,a.j)(A,M)}l(t,q,x,!1)}}get _layout(){const t=(0,f.BP)().vec3f(w.r.POSITION).vec3f(w.r.PREVPOSITION).vec3f(w.r.NEXTPOSITION).f32(w.r.SUBDIVISIONFACTOR).vec2f(w.r.UV0);return this.parameters.vvSize?t.f32(w.r.SIZEFEATUREATTRIBUTE):t.f32(w.r.SIZE),this.parameters.vvColor?t.f32(w.r.COLORFEATUREATTRIBUTE):t.vec4f(w.r.COLOR),this.parameters.vvOpacity&&t.f32(w.r.OPACITYFEATUREATTRIBUTE),(0,v.E)()&&t.vec4u8(w.r.OBJECTANDLAYERIDCOLOR),t}createBufferWriter(){return new B(this._layout,this.parameters)}createGLMaterial(t){return new F(t)}validateParameters(t){"miter"!==t.join&&(t.miterLimit=0),null!=t.markerParameters&&(t.markerScale=t.markerParameters.width/t.width)}}class F extends m.A{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextures.release(this._stipplePattern),this._stipplePattern=null}beginSlot(t){const e=this._material.parameters.stipplePattern;return this._stipplePattern!==e&&(this._material.setParameters({stippleTexture:this._stippleTextures.swap(e,this._stipplePattern)}),this._stipplePattern=e),this.acquireTechnique(P,t)}}class H extends x.S{constructor(){super(...arguments),this.width=0,this.color=l.Un,this.join="miter",this.cap=j.x.BUTT,this.miterLimit=5,this.writeDepth=!0,this.hasPolygonOffset=!1,this.stippleTexture=null,this.stipplePreferContinuous=!0,this.markerParameters=null,this.markerScale=1,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.isClosed=!1,this.falloff=0,this.innerWidth=0,this.wireframe=!1}get transparent(){return this.color[3]<1||null!=this.stipplePattern&&(this.stippleOffColor?.[3]??0)<1}}class B{constructor(t,e){this.vertexBufferLayout=t,this._parameters=e,this.numJoinSubdivisions=0;const i=e.stipplePattern?1:0;switch(this._parameters.join){case"miter":case"bevel":this.numJoinSubdivisions=i;break;case"round":this.numJoinSubdivisions=A.r+i}}_isClosed(t){return V(this._parameters,t)}allocate(t){return this.vertexBufferLayout.createBuffer(t)}elementCount(t){const e=t.get(w.r.POSITION).indices.length/2+1,i=this._isClosed(t);let n=i?2:4;return n+=((i?e:e-1)-(i?0:1))*(2*this.numJoinSubdivisions+4),n+=2,this._parameters.wireframe&&(n=2+4*(n-2)),n}write(t,e,i,n,r,s){const o=et,h=it,l=nt,c=i.get(w.r.POSITION),u=c.indices,d=c.data.length/3,f=i.get(w.r.DISTANCETOSTART)?.data;u&&u.length!==2*(d-1)&&console.warn("RibbonLineMaterial does not support indices");const p=i.get(w.r.SIZEFEATUREATTRIBUTE)?.data[0]??i.get(w.r.SIZE)?.data[0]??1;let g=[1,1,1,1],m=0;const y=this.vertexBufferLayout.fields.has(w.r.COLORFEATUREATTRIBUTE);y?m=i.get(w.r.COLORFEATUREATTRIBUTE).data[0]:i.has(w.r.COLOR)&&(g=i.get(w.r.COLOR).data);const _=this.vertexBufferLayout.fields.has(w.r.OPACITYFEATUREATTRIBUTE),b=_?i.get(w.r.OPACITYFEATUREATTRIBUTE).data[0]:0,x=new Float32Array(r.buffer),T=(0,v.E)()?new Uint8Array(r.buffer):null,A=this.vertexBufferLayout.stride/4;let M=s*A;const S=M;let E=0;const C=f?(t,e,i)=>E=f[i]:(t,e,i)=>E+=(0,a.j)(t,e),O=(t,e,i,r,s,o,a)=>{if(x[M++]=e[0],x[M++]=e[1],x[M++]=e[2],x[M++]=t[0],x[M++]=t[1],x[M++]=t[2],x[M++]=i[0],x[M++]=i[1],x[M++]=i[2],x[M++]=r,x[M++]=a,x[M++]=s,x[M++]=p,y)x[M++]=m;else{const t=Math.min(4*o,g.length-4);x[M++]=g[t],x[M++]=g[t+1],x[M++]=g[t+2],x[M++]=g[t+3]}_&&(x[M++]=b),(0,v.E)()&&(n&&(T[4*M]=n[0],T[4*M+1]=n[1],T[4*M+2]=n[2],T[4*M+3]=n[3]),M++)};M+=A,(0,a.i)(h,c.data[0],c.data[1],c.data[2]),t&&(0,a.t)(h,h,t);const R=this._isClosed(i);if(R){const e=c.data.length-3;(0,a.i)(o,c.data[e],c.data[e+1],c.data[e+2]),t&&(0,a.t)(o,o,t)}else(0,a.i)(l,c.data[3],c.data[4],c.data[5]),t&&(0,a.t)(l,l,t),O(h,h,l,1,L.LEFT_CAP_START,0,0),O(h,h,l,1,L.RIGHT_CAP_START,0,0),(0,a.c)(o,h),(0,a.c)(h,l);const I=R?0:1,P=R?d:d-1;for(let e=I;e<P;e++){const i=(e+1)%d*3;(0,a.i)(l,c.data[i],c.data[i+1],c.data[i+2]),t&&(0,a.t)(l,l,t),C(o,h,e),O(o,h,l,0,L.LEFT_JOIN_END,e,E),O(o,h,l,0,L.RIGHT_JOIN_END,e,E);const n=this.numJoinSubdivisions;for(let t=0;t<n;++t){const i=(t+1)/(n+1);O(o,h,l,i,L.LEFT_JOIN_END,e,E),O(o,h,l,i,L.RIGHT_JOIN_END,e,E)}O(o,h,l,1,L.LEFT_JOIN_START,e,E),O(o,h,l,1,L.RIGHT_JOIN_START,e,E),(0,a.c)(o,h),(0,a.c)(h,l)}R?((0,a.i)(l,c.data[3],c.data[4],c.data[5]),t&&(0,a.t)(l,l,t),E=C(o,h,P),O(o,h,l,0,L.LEFT_JOIN_END,I,E),O(o,h,l,0,L.RIGHT_JOIN_END,I,E)):(E=C(o,h,P),O(o,h,h,0,L.LEFT_CAP_END,P,E),O(o,h,h,0,L.RIGHT_CAP_END,P,E)),G(x,S+A,x,S,A),M=G(x,M-A,x,M,A),this._parameters.wireframe&&this._addWireframeVertices(r,S,M,A)}_addWireframeVertices(t,e,i,n){const r=new Float32Array(t.buffer,i*Float32Array.BYTES_PER_ELEMENT),s=new Float32Array(t.buffer,e*Float32Array.BYTES_PER_ELEMENT,i-e);let o=0;const a=t=>o=G(s,t,r,o,n);for(let t=0;t<s.length-1;t+=2*n)a(t),a(t+2*n),a(t+1*n),a(t+2*n),a(t+1*n),a(t+3*n)}}function G(t,e,i,n,r){for(let s=0;s<r;s++)i[n++]=t[e++];return n}function V(t,e){return!!t.isClosed&&e.get(w.r.POSITION).indices.length>2}const U=(0,h.vt)(),$=(0,h.vt)(),W=(0,h.vt)(),q=(0,h.vt)(),Z=(0,h.vt)(),Y=(0,s.r_)(),X=(0,s.r_)(),K=(0,h.vt)(),J=(0,h.vt)(),Q=(0,u.vt)(),tt=(0,u.vt)(),et=(0,h.vt)(),it=(0,h.vt)(),nt=(0,h.vt)(),rt=[(0,s.r_)(),(0,s.r_)(),(0,s.r_)(),(0,s.r_)()],st=[(0,h.vt)(),(0,h.vt)(),(0,h.vt)(),(0,h.vt)()],ot=(0,d.vt)(),at=(0,d.vt)(),ht=(0,d.vt)(),lt=(0,d.vt)()},27291:function(t,e,i){"use strict";i.d(e,{W:function(){return s}});var n=i(24100),r=i(45079);class s extends n.im{intersect(t,e,i,n,s,o){return(0,r.Uy)(t,i,n,s,void 0,o)}}},77971:function(t,e,i){"use strict";i.d(e,{S:function(){return s},p:function(){return o}});var n=i(24129),r=i(24100);class s extends n.Gd{constructor(){super(...arguments),this.renderOccluded=r.m$.Occlude,this.isDecoration=!1}}const o=8},84887:function(t,e,i){"use strict";i.d(e,{MB:function(){return a},Um:function(){return h},kE:function(){return o}});var n=i(50659),r=i(15774),s=i(54035);function o(t,e,i,n,o){let a=(i.screenLength||0)*t.pixelRatio;null!=o&&(a=(0,s.hs)(a,n,e,o));const h=a*Math.tan(.5*t.fovY)/(.5*t.fullHeight);return(0,r.qE)(h*e,i.minWorldLength||0,null!=i.maxWorldLength?i.maxWorldLength:1/0)}function a(t,e){let i=!1;for(const r in e){const s=e[r];void 0!==s&&(Array.isArray(s)?Array.isArray(t[r])&&(0,n.aI)(s,t[r])||(t[r]=s.slice(),i=!0):t[r]!==s&&(i=!0,t[r]=s))}return i}const h={multiply:1,ignore:2,replace:3,tint:4}},93678:function(t,e,i){"use strict";i.d(e,{Hk:function(){return d},Pq:function(){return u},SA:function(){return v},Ut:function(){return c},p1:function(){return f},tH:function(){return g},tb:function(){return p},uO:function(){return a},zC:function(){return m}});var n=i(73364),r=i(92754),s=i(90553),o=i(65839);function a(t,e,i,n=1){const{data:r,indices:s}=t,o=e.typedBuffer,a=e.typedBufferStride,h=s.length;if(i*=a,1===n)for(let t=0;t<h;++t)o[i]=r[s[t]],i+=a;else for(let t=0;t<h;++t){const e=r[s[t]];for(let t=0;t<n;t++)o[i]=e,i+=a}}function h(t,e,i){const{data:n,indices:r}=t,s=e.typedBuffer,o=e.typedBufferStride,a=r.length;i*=o;for(let t=0;t<a;++t){const e=2*r[t];s[i]=n[e],s[i+1]=n[e+1],i+=o}}function l(t,e,i,n){const{data:r,indices:s}=t,o=e.typedBuffer,a=e.typedBufferStride,h=s.length;if(i*=a,null==n||1===n)for(let t=0;t<h;++t){const e=3*s[t];o[i]=r[e],o[i+1]=r[e+1],o[i+2]=r[e+2],i+=a}else for(let t=0;t<h;++t){const e=3*s[t];for(let t=0;t<n;++t)o[i]=r[e],o[i+1]=r[e+1],o[i+2]=r[e+2],i+=a}}function c(t,e,i,n=1){const{data:r,indices:s}=t,o=e.typedBuffer,a=e.typedBufferStride,h=s.length;if(i*=a,1===n)for(let t=0;t<h;++t){const e=4*s[t];o[i]=r[e],o[i+1]=r[e+1],o[i+2]=r[e+2],o[i+3]=r[e+3],i+=a}else for(let t=0;t<h;++t){const e=4*s[t];for(let t=0;t<n;++t)o[i]=r[e],o[i+1]=r[e+1],o[i+2]=r[e+2],o[i+3]=r[e+3],i+=a}}function u(t,e,i){const n=t.typedBuffer,r=t.typedBufferStride;e*=r;for(let t=0;t<i;++t)n[e]=0,n[e+1]=0,n[e+2]=0,n[e+3]=0,e+=r}function d(t,e,i,r,s=1){if(!e)return void l(t,i,r,s);const{data:o,indices:a}=t,h=i.typedBuffer,c=i.typedBufferStride,u=a.length,d=e[0],f=e[1],p=e[2],g=e[4],v=e[5],m=e[6],y=e[8],_=e[9],b=e[10],w=e[12],x=e[13],T=e[14];r*=c;let A=0,M=0,S=0;const E=(0,n.tZ)(e)?t=>{A=o[t]+w,M=o[t+1]+x,S=o[t+2]+T}:t=>{const e=o[t],i=o[t+1],n=o[t+2];A=d*e+g*i+y*n+w,M=f*e+v*i+_*n+x,S=p*e+m*i+b*n+T};if(1===s)for(let t=0;t<u;++t)E(3*a[t]),h[r]=A,h[r+1]=M,h[r+2]=S,r+=c;else for(let t=0;t<u;++t){E(3*a[t]);for(let t=0;t<s;++t)h[r]=A,h[r+1]=M,h[r+2]=S,r+=c}}function f(t,e,i,r,s=1){if(!e)return void l(t,i,r,s);const{data:o,indices:a}=t,h=e,c=i.typedBuffer,u=i.typedBufferStride,d=a.length,f=h[0],p=h[1],g=h[2],v=h[4],m=h[5],y=h[6],_=h[8],b=h[9],w=h[10],x=!(0,n.ut)(h),T=1e-6,A=1-T;r*=u;let M=0,S=0,E=0;const C=(0,n.tZ)(h)?t=>{M=o[t],S=o[t+1],E=o[t+2]}:t=>{const e=o[t],i=o[t+1],n=o[t+2];M=f*e+v*i+_*n,S=p*e+m*i+b*n,E=g*e+y*i+w*n};if(1===s)if(x)for(let t=0;t<d;++t){C(3*a[t]);const e=M*M+S*S+E*E;if(e<A&&e>T){const t=1/Math.sqrt(e);c[r]=M*t,c[r+1]=S*t,c[r+2]=E*t}else c[r]=M,c[r+1]=S,c[r+2]=E;r+=u}else for(let t=0;t<d;++t)C(3*a[t]),c[r]=M,c[r+1]=S,c[r+2]=E,r+=u;else for(let t=0;t<d;++t){if(C(3*a[t]),x){const t=M*M+S*S+E*E;if(t<A&&t>T){const e=1/Math.sqrt(t);M*=e,S*=e,E*=e}}for(let t=0;t<s;++t)c[r]=M,c[r+1]=S,c[r+2]=E,r+=u}}function p(t,e,i,n,r=1){const{data:s,indices:o}=t,a=i.typedBuffer,h=i.typedBufferStride,l=o.length;if(n*=h,e!==s.length||4!==e)if(1!==r)if(4!==e)for(let t=0;t<l;++t){const e=3*o[t];for(let t=0;t<r;++t)a[n]=s[e],a[n+1]=s[e+1],a[n+2]=s[e+2],a[n+3]=255,n+=h}else for(let t=0;t<l;++t){const e=4*o[t];for(let t=0;t<r;++t)a[n]=s[e],a[n+1]=s[e+1],a[n+2]=s[e+2],a[n+3]=s[e+3],n+=h}else{if(4===e){for(let t=0;t<l;++t){const e=4*o[t];a[n]=s[e],a[n+1]=s[e+1],a[n+2]=s[e+2],a[n+3]=s[e+3],n+=h}return}for(let t=0;t<l;++t){const e=3*o[t];a[n]=s[e],a[n+1]=s[e+1],a[n+2]=s[e+2],a[n+3]=255,n+=h}}else{a[n]=s[0],a[n+1]=s[1],a[n+2]=s[2],a[n+3]=s[3];const t=new Uint32Array(i.typedBuffer.buffer,i.start),e=h/4,o=t[n/=4];n+=e;const c=l*r;for(let i=1;i<c;++i)t[n]=o,n+=e}}function g(t,e,i,n,r=1){const s=e.typedBuffer,o=e.typedBufferStride;if(n*=o,1===r)for(let e=0;e<i;++e)s[n]=t[0],s[n+1]=t[1],s[n+2]=t[2],s[n+3]=t[3],n+=o;else for(let e=0;e<i;++e)for(let e=0;e<r;++e)s[n]=t[0],s[n+1]=t[1],s[n+2]=t[2],s[n+3]=t[3],n+=o}function v(t,e,i,n,s,a,h){for(const l of i.fields.keys()){const i=t.get(l),c=i?.indices;if(i&&c)m(l,i,n,s,a,h);else if(l===o.r.OBJECTANDLAYERIDCOLOR&&null!=e){const i=t.get(o.r.POSITION)?.indices;if(i){const t=i.length;g(e,a.getField(l,r.XP),t,h)}}}}function m(t,e,i,a,l,u){switch(t){case o.r.POSITION:{(0,s.vA)(3===e.size);const n=l.getField(t,r.xs);(0,s.vA)(!!n,`No buffer view for ${t}`),n&&d(e,i,n,u);break}case o.r.NORMAL:{(0,s.vA)(3===e.size);const i=l.getField(t,r.xs);(0,s.vA)(!!i,`No buffer view for ${t}`),i&&f(e,a,i,u);break}case o.r.NORMALCOMPRESSED:{(0,s.vA)(2===e.size);const i=l.getField(t,r.mJ);(0,s.vA)(!!i,`No buffer view for ${t}`),i&&h(e,i,u);break}case o.r.UV0:{(0,s.vA)(2===e.size);const i=l.getField(t,r.gH);(0,s.vA)(!!i,`No buffer view for ${t}`),i&&h(e,i,u);break}case o.r.COLOR:case o.r.SYMBOLCOLOR:{const i=l.getField(t,r.XP);(0,s.vA)(!!i,`No buffer view for ${t}`),(0,s.vA)(3===e.size||4===e.size),!i||3!==e.size&&4!==e.size||p(e,e.size,i,u);break}case o.r.COLORFEATUREATTRIBUTE:{const i=l.getField(t,r.Y$);(0,s.vA)(!!i,`No buffer view for ${t}`),(0,s.vA)(1===e.size),i&&1===e.size&&function(t,e,i){const{data:n,indices:r}=t,s=e.typedBuffer,o=e.typedBufferStride,a=r.length,h=n[0];i*=o;for(let t=0;t<a;++t)s[i]=h,i+=o}(e,i,u);break}case o.r.TANGENT:{(0,s.vA)(4===e.size);const o=l.getField(t,r.Eq);(0,s.vA)(!!o,`No buffer view for ${t}`),o&&function(t,e,i,r,s=1){if(!e)return void c(t,i,r,s);const{data:o,indices:a}=t,h=e,l=i.typedBuffer,u=i.typedBufferStride,d=a.length,f=h[0],p=h[1],g=h[2],v=h[4],m=h[5],y=h[6],_=h[8],b=h[9],w=h[10],x=!(0,n.ut)(h),T=1e-6,A=1-T;if(r*=u,1===s)for(let t=0;t<d;++t){const e=4*a[t],i=o[e],n=o[e+1],s=o[e+2],h=o[e+3];let c=f*i+v*n+_*s,d=p*i+m*n+b*s,M=g*i+y*n+w*s;if(x){const t=c*c+d*d+M*M;if(t<A&&t>T){const e=1/Math.sqrt(t);c*=e,d*=e,M*=e}}l[r]=c,l[r+1]=d,l[r+2]=M,l[r+3]=h,r+=u}else for(let t=0;t<d;++t){const e=4*a[t],i=o[e],n=o[e+1],h=o[e+2],c=o[e+3];let d=f*i+v*n+_*h,M=p*i+m*n+b*h,S=g*i+y*n+w*h;if(x){const t=d*d+M*M+S*S;if(t<A&&t>T){const e=1/Math.sqrt(t);d*=e,M*=e,S*=e}}for(let t=0;t<s;++t)l[r]=d,l[r+1]=M,l[r+2]=S,l[r+3]=c,r+=u}}(e,i,o,u);break}case o.r.PROFILERIGHT:case o.r.PROFILEUP:case o.r.PROFILEVERTEXANDNORMAL:case o.r.FEATUREVALUE:{(0,s.vA)(4===e.size);const i=l.getField(t,r.Eq);(0,s.vA)(!!i,`No buffer view for ${t}`),i&&c(e,i,u)}}}},20794:function(t,e,i){"use strict";i.d(e,{Xq:function(){return a},wk:function(){return o}});const n={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},r={dash:n.dash,"dash-dot":[...n.dash,...n.dot],dot:n.dot,"long-dash":n["long-dash"],"long-dash-dot":[...n["long-dash"],...n.dot],"long-dash-dot-dot":[...n["long-dash"],...n.dot,...n.dot],none:null,"short-dash":n["short-dash"],"short-dash-dot":[...n["short-dash"],...n["short-dot"]],"short-dash-dot-dot":[...n["short-dash"],...n["short-dot"],...n["short-dot"]],"short-dot":n["short-dot"],solid:null},s=8;function o(t){return{pattern:[t,t],pixelRatio:2}}function a(t){return"style"===t?.type?function(t){return null!=t?function(t,e){return null==t?t:{pattern:t.slice(),pixelRatio:e}}(r[t],s):null}(t.style):null}},27539:function(t,e,i){"use strict";i.d(e,{Bt:function(){return a},Jr:function(){return s},SY:function(){return h},mb:function(){return o}});var n=i(20551),r=i(32501);function s({normalTexture:t,metallicRoughnessTexture:e,metallicFactor:i,roughnessFactor:s,emissiveTexture:o,emissiveFactor:a,occlusionTexture:h}){return null==t&&null==e&&null==o&&(null==a||(0,n.p)(a,r.uY))&&null==h&&(null==s||1===s)&&(null==i||1===i)}const o=(0,r.CN)(1,1,.5),a=(0,r.CN)(0,.6,.2),h=(0,r.CN)(0,1,.2)},26347:function(t,e,i){"use strict";i.d(e,{y:function(){return R},N:function(){return V}});var n=i(53804),r=i(50659),s=(i(58941),i(15774)),o=i(95929),a=i(7970),h=i(7187),l=i(17660),c=i(23502),u=(i(40633),i(65953)),d=i(73364),f=i(39714),p=i(69550),g=i(27264),v=i(67521),m=i(52798),y=i(96253),_=i(29165),b=i(90553),w=i(51564);class x{constructor(t=0,e=0){this.from=t,this.to=e}get numElements(){return this.to-this.from}}function T(t){const e=new Map;t.forAll((t=>e.set(t.from,t)));let i=!0;for(;i;){i=!1;for(let n=0;n<t.length;++n){const r=t.data[n],s=e.get(r.to);if(!s)return;r.to=s.to,e.delete(s.from),t.removeUnordered(s),i=!0}}}class A extends x{constructor(t,e,i){super(e,i),this.geometry=t}get isVisible(){return this.geometry.visible}get hasHighlights(){return this.isVisible&&this.geometry.hasHighlights}foreachHighlightGroup(t){this.isVisible&&this.geometry.foreachHighlightGroup(t)}get hasOccludees(){return null!=this.geometry.occludees}}class M{constructor(){this.first=0,this.count=0}}class S{constructor(){this._numElements=0,this._instances=new Map,this.holes=new h.A({allocator:t=>t||new x,deallocator:null}),this.hasHiddenInstances=!1,this.hasOccludees=!1,this.drawCommandsDirty=!0,this.highlightGroups=new Set,this.drawCommandsDefault=E(),this.drawCommandsHighlights=new Map,this.drawCommandsOccludees=E(),this.drawCommandsShadowHighlightRest=E()}get numElements(){return this._numElements}get instances(){return this._instances}get hasHighlights(){return this.highlightGroups.size>0}resetInstanceSummary(){this.hasHiddenInstances=!1,this.hasOccludees=!1,this.highlightGroups.clear()}updateIfDrawCommandsDirty(t){if(this.drawCommandsDirty){this.resetInstanceSummary();for(const t of this.instances.values())this.updateDrawState(t);this.updateDrawCommands(t)}}addInstance(t,e){this.deleteInstance(t),this._instances.set(t,e),this._numElements+=e.numElements}deleteInstance(t){const e=this._instances.get(t);e&&(this._numElements-=e.numElements,this._instances.delete(t))}updateInstance(t,e,i){const n=this._instances.get(t);n&&(this._numElements-=n.numElements,n.from=e,n.to=i,this._numElements+=n.numElements)}updateDrawState(t){t.isVisible?(t.foreachHighlightGroup((t=>this.highlightGroups.add(t))),t.hasOccludees&&(this.hasOccludees=!0)):this.hasHiddenInstances=!0}updateDrawCommands(t){if(this.drawCommandsDefault.clear(),this.drawCommandsHighlights.clear(),this.drawCommandsOccludees.clear(),this.drawCommandsShadowHighlightRest.clear(),this.drawCommandsDirty=!1,0===this._instances.size)return;if(!this.needsMultipleCommands()){const e=this.drawCommandsDefault.pushNew(),i=this.holes.front();return null!=this.vao&&1===this.holes.length&&i.to===Math.floor(this.vao.byteSize/t)?(e.first=0,void(e.count=i.from)):(e.first=1/0,e.count=0,this._instances.forEach((t=>{e.first=Math.min(e.first,t.from),e.count=Math.max(e.count,t.to)})),void(e.count-=e.first))}const e=Array.from(this._instances.values()).sort(((t,e)=>t.from===e.from?t.to-e.to:t.from-e.from)),{drawCommandsHighlights:i}=this;for(const t of e)t.isVisible&&(C(t.hasOccludees?this.drawCommandsOccludees:this.drawCommandsDefault,t),t.hasHighlights?t.foreachHighlightGroup((e=>{let n=i.get(e);n||(n=E(),i.set(e,n)),C(n,t)})):C(this.drawCommandsShadowHighlightRest,t))}needsMultipleCommands(){return this.hasOccludees||this.hasHighlights||this.hasHiddenInstances}}function E(){return new h.A({allocator:t=>t||new M,deallocator:t=>t})}function C(t,e){const i=t.back();if(null==i){const i=t.pushNew();return i.first=e.from,void(i.count=e.numElements)}if(function(t,e){return t.first+t.count>=e.from}(i,e)){const t=e.from-i.first+e.numElements;i.count=t}else{const i=t.pushNew();i.first=e.from,i.count=e.numElements}}class O{constructor(t){this.origin=t,this.buffers=new Array}dispose(){this.buffers.forEach((t=>t.vao.dispose())),this.buffers.length=0}findBuffer(t){return this.buffers.find((e=>e.instances.has(t)))}}let R=class extends v.RW{get _hasAnyHighlight(){return this._highlightGroups.size>0}constructor(t){super(t),this._dataByOrigin=new Map,this._drawParameters=new w.P,this._highlightGroups=new Set,this.drapedPriority=0,this._produces=new Map,this._hasOccludees=!1}destroy(){this._glMaterials=(0,o.WD)(this._glMaterials),this._dataByOrigin.forEach((t=>t.dispose())),this._dataByOrigin.clear(),this._vaoCache=null}initialize(){this.material.produces.forEach(((t,e)=>{this._produces.set(e,(e=>!(0===this._dataByOrigin.size||!(e!==g.V.Highlight&&e!==g.V.ShadowHighlight||this._hasAnyHighlight))&&t(e)))}))}initializeRenderContext(t,e){this._glMaterials=new m.c(this.material,e??t.materials),this._bufferWriter=this.material.createBufferWriter(),this._vaoCache=t.renderContext.rctx.getVaoCache(this.material.vertexAttributeLocations,(0,p.U)(this._bufferWriter.vertexBufferLayout))}uninitializeRenderContext(){}get produces(){return this._produces}get hasOccludees(){return this._hasOccludees}get hasEmissions(){return this.material.hasEmissions}get isDecoration(){return this.material.parameters.isDecoration}queryRenderOccludedState(t){return this.material.queryRenderOccludedState(t)}get numGeometries(){let t=0;return this._dataByOrigin.forEach((e=>t+=e.buffers.reduce(((t,e)=>t+e.instances.size),0))),t}get usedMemory(){let t=0;return this._dataByOrigin.forEach((e=>t+=e.buffers.reduce(((t,e)=>t+e.vao.usedMemory),0))),t}forEachGeometry(t){this._dataByOrigin.forEach((e=>e.buffers.forEach((e=>e.instances.forEach((({geometry:e})=>t(e)))))))}modify(t){this._updateGeometries(t.updates),this._addAndRemoveGeometries(t.adds,t.removes),this._updateDrawCommands()}_updateGeometries(t){const e=this._bufferWriter;if(null==e)return;const i=e.vertexBufferLayout.stride/4;for(const n of t){const t=n.renderGeometry,r=this._dataByOrigin.get(t.localOrigin.id),s=r?.findBuffer(t.id);if(null==s)return;const o=s.instances.get(t.id);if(n.updateType&(y.k.GEOMETRY|y.k.TRANSFORMATION)){const n=G(e.elementCount(o.geometry.geometry.attributes)*i),r=e.vertexBufferLayout.createView(n.buffer);this._writeGeometry(t,r,0),s.vao.vertexBuffers.get("geometry").setSubData(n,o.from*i,0,o.numElements*i)}n.updateType&(y.k.HIGHLIGHT|y.k.OCCLUDEE|y.k.VISIBILITY)&&(s.drawCommandsDirty=!0)}}_computeDeltas(t,e){const i=new a.O;for(const e of t){const t=e.localOrigin;if(null==t)continue;let n=i.get(t.id,null);null==n&&(n=new I(t.vec3),i.set(t.id,null,n)),n.changes.push(e)}for(const t of e){const e=t.localOrigin;if(null==e)continue;const n=this._dataByOrigin.get(e.id),r=n?.findBuffer(t.id);if(null==r)continue;let s=i.get(e.id,r);null==s&&(s=new I(e.vec3),i.set(e.id,r,s)),s.changes.push(t)}return i}_addAndRemoveGeometries(t,e){if(null==this._bufferWriter||null==this._vaoCache)return;const{_bufferWriter:i,_dataByOrigin:n}=this,s=i.vertexBufferLayout.stride/4,o=this._computeDeltas(t,e);o.forEach(((t,e)=>{const a=t.get(null),h=a?.changes??[];o.delete(e,null);let l=n.get(e);if(t.forEach(((t,a)=>{if(o.delete(e,a),null==a)return void(0,b.vA)(!1,"No VAO for removed geometries");if(a.instances.size===t.changes.length)return this._vaoCache.deleteVao(a.vao),(0,r.Xy)(l.buffers,a),void(0===l.buffers.length&&0===h.length&&n.delete(e));const c=a.numElements,u=a.vao.byteSize/4,d=h.reduce(((t,e)=>t+i.elementCount(e.geometry.attributes)),0),f=t.changes.reduce(((t,e)=>t+i.elementCount(e.geometry.attributes)),0),p=Math.min((c+d-f)*s,H),g=p>u;p>z&&p<u/2?(t.changes.forEach((({id:t})=>a.deleteInstance(t))),a.instances.forEach((({geometry:t})=>h.push(t))),this._vaoCache.deleteVao(a.vao),(0,r.Xy)(l.buffers,a)):g?this._applyAndRebuild(a,h,t):this._applyRemoves(a,t)})),h.length>0)for(null==l&&(l=new O(a.origin),n.set(e,l)),l.buffers.forEach((t=>this._applyAdds(t,h)));h.length>0;)l.buffers.push(this._applyAndRebuild(new S,h,null))}))}_updateDrawCommands(){this._highlightGroups.clear(),this._hasOccludees=!1,this._dataByOrigin.forEach((t=>{t.buffers.forEach((t=>{t.updateIfDrawCommandsDirty(this._bufferWriter.vertexBufferLayout.stride),t.hasHighlights&&(0,l.FB)(this._highlightGroups,t.highlightGroups),this._hasOccludees=this._hasOccludees||t.hasOccludees}))}))}_applyAndRebuild(t,e,i){if(i)for(const e of i.changes)t.deleteInstance(e.id);const n=this._bufferWriter,r=n.vertexBufferLayout.stride,s=r/4,o=Math.floor(H/s);let a=t.numElements;for(;e.length>0;){const i=e.pop(),r=n.elementCount(i.geometry.attributes);if(a+r>o&&a>0){e.push(i);break}a+=r;const s=new A(i,0,0);(0,b.vA)(null==t.instances.get(i.id)),t.addInstance(i.id,s)}const h=a*s,l=G(h),c=n.vertexBufferLayout.createView(l.buffer);let u=0;t.resetInstanceSummary(),t.instances.forEach(((e,i)=>{this._writeGeometry(e.geometry,c,u);const r=u;u+=n.elementCount(e.geometry.geometry.attributes),t.updateInstance(i,r,u),t.updateDrawState(e)})),this._vaoCache.deleteVao(t.vao),t.vao=this._vaoCache.newVao(V(h)),t.vao.vertexBuffers.get("geometry").setSubData(l,0,0,u*s),t.holes.clear();const d=t.holes.pushNew();return d.from=u,d.to=Math.floor(t.vao.byteSize/r),t.updateDrawCommands(r),t}_applyRemoves(t,e){if(0===e.changes.length||null==this._bufferWriter)return;for(const i of e.changes){const e=i.id,n=t.instances.get(e);if(!n)continue;t.deleteInstance(e);const r=L.back();if(r){if(r.to===n.from){r.to=n.to;continue}if(r.from===n.to){r.from=n.from;continue}}const s=L.pushNew();s.from=n.from,s.to=n.to}T(L);const i=this._bufferWriter.vertexBufferLayout.stride/4,n=L.reduce(((t,e)=>Math.max(t,e.numElements)),0)*i,r=G(n);r.fill(0,0,n);const s=t.vao.vertexBuffers.get("geometry");L.forAll((t=>s.setSubData(r,t.from*i,0,t.numElements*i))),t.holes.pushArray(L.data,L.length),L.forAll(((t,e)=>L.data[e]=null)),L.clear(),t.drawCommandsDirty=!0}_applyAdds(t,e){if(0===e.length||null==this._bufferWriter)return;if(!function(t){return null!=t.vao}(t))return void this._applyAndRebuild(t,e,null);const i=this._bufferWriter,n=i.vertexBufferLayout.stride/4,s=t.numElements,o=e.reduce(((t,e)=>t+i.elementCount(e.geometry.attributes)),0),a=Math.min((s+o)*n,H),h=4*a;if(t.vao.byteSize<V(H-z)&&h>t.vao.byteSize)return void this._applyAndRebuild(t,e,null);T(t.holes);const l=new Array;for(const n of e){const e=i.elementCount(n.geometry.attributes),r=P(t.holes,e);l.push(r)}const c=t.vao.vertexBuffers.get("geometry");let u=0,d=0,f=0;const p=G(a),g=i.vertexBufferLayout.createView(p.buffer);e.forEach(((e,r)=>{const s=l[r];if(null==s)return;if(f!==s){const t=f-d;t>0&&c.setSubData(p,d*n,0,t*n),d=s,u=0}const o=i.elementCount(e.geometry.attributes);this._writeGeometry(e,g,u),u+=o,f=s+o;const a=new A(e,s,s+o);(0,b.vA)(null==t.instances.get(e.id)),t.addInstance(e.id,a),t.drawCommandsDirty=!0}));const v=f-d;v>0&&c.setSubData(p,d*n,0,v*n),(0,r.$i)(e,((t,e)=>null==l[e]))}_writeGeometry(t,e,i){null!=this._bufferWriter&&((0,d.C)(N,t.transformation),N[12]-=t.localOrigin.vec3[0],N[13]-=t.localOrigin.vec3[1],N[14]-=t.localOrigin.vec3[2],(0,d.B8)(D,N),(0,d.mg)(D,D),this._bufferWriter.write(N,D,t.geometry.attributes,t.geometry.objectAndLayerIdColor,e,i))}updateAnimation(t){return this.material.update(t)}acquireTechniques(t){if(!this.material.shouldRender(t))return null;const{output:e,bind:i}=t,n=this.material.produces.get(i.slot);if(!n?.(e))return null;const{highlightGroupName:r,slot:s}=i,o=e===g.V.ShadowHighlight,a=e===g.V.Highlight,h=a||o,l=t=>h&&(0===this._highlightGroups.size||a&&!!r&&!t.has(r));if(l(this._highlightGroups))return null;const c=e===g.V.ShadowExcludeHighlight,u=!(h||c);for(const{buffers:n}of this._dataByOrigin.values())for(const a of n){if(l(a.highlightGroups))continue;const n=o?a.drawCommandsHighlights.size>0:h?r?a.drawCommandsHighlights.get(r):a.drawCommandsHighlights.size>0:((c&&a.needsMultipleCommands()?a.drawCommandsShadowHighlightRest:a.drawCommandsDefault)||null)?.length??!1,d=u&&a.drawCommandsOccludees||null;if(n||d?.length){const n=this._glMaterials.load(t.rctx,s,e),r=n?.beginSlot(i);if(r)return r}}return null}render(t,e){const{output:i,bind:n}=t,{slot:r,highlightGroupName:s}=n,o=i===g.V.Highlight;if(o&&!s)return;const a=i===g.V.ShadowHighlight,h=o||a,l=i===g.V.ShadowExcludeHighlight,c=!(h||l),u=r===_.N.OCCLUDER_MATERIAL||r===_.N.TRANSPARENT_OCCLUDER_MATERIAL?r:null,{rctx:d}=t;d.runAppleAmdDriverHelper();const f=d.bindTechnique(e,n,this.material.parameters);for(const t of this._dataByOrigin.values())for(const i of t.buffers){if(o&&(!i.hasHighlights||!i.drawCommandsHighlights.has(s)))continue;if(a&&!i.hasHighlights)continue;const r=()=>{const t=[];for(const e of i.drawCommandsHighlights.values())t.push(e);return t},p=h&&!a?i.drawCommandsHighlights.get(s)??null:null,g=a?r():h?p?[p]:U:(l&&i.needsMultipleCommands()?[i.drawCommandsShadowHighlightRest]:[i.drawCommandsDefault])||U,v=g.some((t=>t.length>0)),m=c&&i.drawCommandsOccludees||null;if(v||m?.length){if(this._drawParameters.origin=t.origin,f.bindDraw(n,this.material.parameters,this._drawParameters),e.ensureAttributeLocations(i.vao),d.bindVAO(i.vao),v)for(const t of g)d.setPipelineState(e.getPipeline(!1,u)),t.forAll((t=>d.drawArrays(e.primitiveType,t.first,t.count)));m?.length&&(d.setPipelineState(e.getPipeline(!0,u)),m.forAll((t=>d.drawArrays(e.primitiveType,t.first,t.count))))}}}get test(){}};(0,n._)([(0,c.MZ)({constructOnly:!0})],R.prototype,"material",void 0),R=(0,n._)([(0,u.$)("esri.views.3d.webgl-engine.materials.renderers.MergedRenderer")],R);class I{constructor(t){this.origin=t,this.changes=new Array}}function P(t,e){const i=t.find((t=>t.numElements>=e));if(null==i)return null;const n=i.from;return i.from+=e,i.from>=i.to&&t.removeUnordered(i),n}const N=(0,f.vt)(),D=(0,f.vt)(),L=new h.A({allocator:t=>t||new x,deallocator:null}),z=65536,j=4*z,k=1024,F=16777216,H=F/4;let B=new Float32Array(z);function G(t){return B.length<t&&(B=new Float32Array(t)),B}function V(t){const e=4*t;return e<=k?k:e<j?(0,s.cU)(e):Math.max(Math.min(Math.ceil(1.5*e/j)*j,F),e)}const U=[]},84738:function(t,e,i){"use strict";i.d(e,{Ci:function(){return s},PC:function(){return o},Vk:function(){return a}});var n=i(32501),r=i(44476);function s(t,e){return null==t&&(t=[]),t.push(e),t}function o(t,e){if(null==t)return null;const i=t.filter((t=>t!==e));return 0===i.length?null:i}function a(t,e,i,n,s){h[0]=t.get(e,0),h[1]=t.get(e,1),h[2]=t.get(e,2),(0,r.jS)(h,l,3),i.set(s,0,l[0]),n.set(s,0,l[1]),i.set(s,1,l[2]),n.set(s,1,l[3]),i.set(s,2,l[4]),n.set(s,2,l[5])}const h=(0,n.vt)(),l=new Float32Array(6)},54204:function(t,e,i){"use strict";i.d(e,{N:function(){return a},d:function(){return n}});var n,r,s=i(53804),o=i(65875);(r=n||(n={}))[r.None=0]="None",r[r.Alpha=1]="Alpha",r[r.PremultipliedAlpha=2]="PremultipliedAlpha",r[r.Depth=3]="Depth",r[r.COUNT=4]="COUNT";class a extends o.K{constructor(){super(...arguments),this.blitMode=n.None,this.hasOpacityFactor=!1}}(0,s._)([(0,o.W)({count:n.COUNT})],a.prototype,"blitMode",void 0),(0,s._)([(0,o.W)()],a.prototype,"hasOpacityFactor",void 0)},50678:function(t,e,i){"use strict";i.d(e,{Dt:function(){return u},kJ:function(){return r},lM:function(){return n}});var n,r,s,o=i(53804),a=i(2457),h=i(38130),l=i(65875),c=i(22095);(s=n||(n={}))[s.Draped=0]="Draped",s[s.Screen=1]="Screen",s[s.World=2]="World",s[s.COUNT=3]="COUNT",function(t){t[t.Center=0]="Center",t[t.Tip=1]="Tip",t[t.COUNT=2]="COUNT"}(r||(r={}));class u extends c.E{constructor(){super(...arguments),this.space=n.Screen,this.anchor=r.Center,this.occluder=!1,this.hasSlicePlane=!1,this.writeDepth=!1,this.hideOnShortSegments=!1,this.hasCap=!1,this.hasTip=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=a.I.None,this.emissionSource=h.ZX.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.hasVvInstancing=!0,this.hasSliceTranslatedView=!0,this.objectAndLayerIdColorInstanced=!1}get draped(){return this.space===n.Draped}}(0,o._)([(0,l.W)({count:n.COUNT})],u.prototype,"space",void 0),(0,o._)([(0,l.W)({count:r.COUNT})],u.prototype,"anchor",void 0),(0,o._)([(0,l.W)()],u.prototype,"occluder",void 0),(0,o._)([(0,l.W)()],u.prototype,"hasSlicePlane",void 0),(0,o._)([(0,l.W)()],u.prototype,"writeDepth",void 0),(0,o._)([(0,l.W)()],u.prototype,"hideOnShortSegments",void 0),(0,o._)([(0,l.W)()],u.prototype,"hasCap",void 0),(0,o._)([(0,l.W)()],u.prototype,"hasTip",void 0),(0,o._)([(0,l.W)()],u.prototype,"vvSize",void 0),(0,o._)([(0,l.W)()],u.prototype,"vvColor",void 0),(0,o._)([(0,l.W)()],u.prototype,"vvOpacity",void 0),(0,o._)([(0,l.W)()],u.prototype,"hasOccludees",void 0),(0,o._)([(0,l.W)()],u.prototype,"terrainDepthTest",void 0),(0,o._)([(0,l.W)()],u.prototype,"cullAboveTerrain",void 0)},25124:function(t,e,i){"use strict";i.d(e,{z:function(){return c}});var n=i(27264),r=i(38130),s=i(84435),o=i(28686),a=i(23864),h=i(39506),l=i(54840);function c(t,e){t.include(s.Q,e),t.include(r.NL,e),t.fragment.include(a.a);const i=e.output===n.V.ObjectAndLayerIdColor,c=(0,n.LG)(e.output),u=(0,n.RN)(e.output)&&e.oitPass===l.Y.ColorAlpha,d=(0,n.RN)(e.output)&&e.oitPass!==l.Y.ColorAlpha,f=e.discardInvisibleFragments;let p=0;(d||c||u)&&t.outputs.add("fragColor","vec4",p++),c&&t.outputs.add("fragEmission","vec4",p++),u&&t.outputs.add("fragAlpha","float",p++),t.fragment.code.add(h.H`
    void outputColorHighlightOID(vec4 finalColor, const in vec3 vWorldPosition) {
      ${(0,h.If)(i,h.H`finalColor.a = 1.0;`)}

      ${(0,h.If)(f,h.H`if (finalColor.a < ${h.H.float(o.Q)}){
              discard;
              return;
            }`)}

      finalColor = highlightSlice(finalColor, vWorldPosition);
      ${(0,h.If)(u,h.H`fragColor = premultiplyAlpha(finalColor);
             fragAlpha = finalColor.a;`)}
      ${(0,h.If)(d,"fragColor = finalColor;")}
      ${(0,h.If)(c,"fragEmission = getEmissions();")}
      calculateOcclusionAndOutputHighlight();
      ${(0,h.If)(i,"outputObjectAndLayerIdColor();")}
    }
  `)}},95736:function(t,e,i){"use strict";i.d(e,{Q:function(){return c},x:function(){return n}});var n,r,s=i(53804),o=i(2457),a=i(38130),h=i(65875),l=i(22095);(r=n||(n={}))[r.BUTT=0]="BUTT",r[r.SQUARE=1]="SQUARE",r[r.ROUND=2]="ROUND",r[r.COUNT=3]="COUNT";class c extends l.E{constructor(){super(...arguments),this.capType=n.BUTT,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.writeDepth=!1,this.draped=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stipplePreferContinuous=!0,this.roundJoins=!1,this.applyMarkerOffset=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.falloffEnabled=!1,this.innerColorEnabled=!1,this.hasOccludees=!1,this.occluder=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.wireframe=!1,this.discardInvisibleFragments=!1,this.objectAndLayerIdColorInstanced=!1,this.textureCoordinateType=o.I.None,this.emissionSource=a.ZX.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.hasSliceTranslatedView=!0}}(0,s._)([(0,h.W)({count:n.COUNT})],c.prototype,"capType",void 0),(0,s._)([(0,h.W)()],c.prototype,"hasSlicePlane",void 0),(0,s._)([(0,h.W)()],c.prototype,"hasPolygonOffset",void 0),(0,s._)([(0,h.W)()],c.prototype,"writeDepth",void 0),(0,s._)([(0,h.W)()],c.prototype,"draped",void 0),(0,s._)([(0,h.W)()],c.prototype,"stippleEnabled",void 0),(0,s._)([(0,h.W)()],c.prototype,"stippleOffColorEnabled",void 0),(0,s._)([(0,h.W)()],c.prototype,"stipplePreferContinuous",void 0),(0,s._)([(0,h.W)()],c.prototype,"roundJoins",void 0),(0,s._)([(0,h.W)()],c.prototype,"applyMarkerOffset",void 0),(0,s._)([(0,h.W)()],c.prototype,"vvSize",void 0),(0,s._)([(0,h.W)()],c.prototype,"vvColor",void 0),(0,s._)([(0,h.W)()],c.prototype,"vvOpacity",void 0),(0,s._)([(0,h.W)()],c.prototype,"falloffEnabled",void 0),(0,s._)([(0,h.W)()],c.prototype,"innerColorEnabled",void 0),(0,s._)([(0,h.W)()],c.prototype,"hasOccludees",void 0),(0,s._)([(0,h.W)()],c.prototype,"occluder",void 0),(0,s._)([(0,h.W)()],c.prototype,"terrainDepthTest",void 0),(0,s._)([(0,h.W)()],c.prototype,"cullAboveTerrain",void 0),(0,s._)([(0,h.W)()],c.prototype,"wireframe",void 0),(0,s._)([(0,h.W)()],c.prototype,"discardInvisibleFragments",void 0),(0,s._)([(0,h.W)()],c.prototype,"objectAndLayerIdColorInstanced",void 0)},46671:function(t,e,i){"use strict";var n,r,s;i.d(e,{OG:function(){return r},hM:function(){return n}}),i(39714),i(7456),i(57617),(s=n||(n={})).OPAQUE="opaque-color",s.TRANSPARENT="transparent-color",s.COMPOSITE="composite-color",s.FINAL="final-color",function(t){t.SSAO="ssao",t.LASERLINES="laserline-color",t.ANTIALIASING="aa-color",t.HIGHLIGHTS="highlight-color",t.MAGNIFIER="magnifier-color",t.OCCLUDED="occluded-color",t.VIEWSHED="viewshed-color",t.OPAQUE_ENVIRONMENT="opaque-environment-color",t.TRANSPARENT_ENVIRONMENT="transparent-environment-color"}(r||(r={}))},65631:function(t,e,i){"use strict";i.d(e,{A:function(){return M}});var n,r=i(53804),s=i(83525),o=i(40633),a=i(15774),h=i(13520),l=i(23502),c=(i(58941),i(13798),i(65953)),u=i(73364),d=i(39714),f=i(13786),p=i(1932),g=i(20551),v=i(32501),m=i(33400),y=i(41546),_=i(69508),b=i(79578),w=i(29531),x=i(65420),T=i(57701);let A=n=class extends s.A{constructor(t){super(t),this._ray=(0,b.vt)(),this._viewport=(0,y.fA)(0,0,1,1),this._padding=(0,y.fA)(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=(0,p.fA)(1,1e3),this._viewDirty=!0,this._viewMatrix=(0,d.vt)(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=(0,d.vt)(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=(0,d.vt)(),this._frustumDirty=!0,this._frustum=(0,_.vt)(),this._fullViewport=(0,y.vt)(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=(0,v.vt)(),this._up=(0,v.vt)(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(t){this._pixelRatio=t>0?t:1}get rows(){return this._rows}set rows(t){this._rows=Math.max(1,t)}get columns(){return this._columns}set columns(t){this._columns=Math.max(1,t)}get eye(){return this._ray.origin}set eye(t){this._compareAndSetView(t,this._ray.origin)}get center(){return this._center}set center(t){this._compareAndSetView(t,this._center,"_center")}get ray(){return(0,g.d)(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(t){this._compareAndSetView(t,this._up,"_up")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(t){(0,u.C)(this._viewMatrix,t),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),(0,g.i)((0,v.vt)(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),(0,g.i)((0,v.vt)(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),(0,g.i)((0,v.vt)(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get far(){return this._nearFar[1]}set far(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_nearFar"))}get viewport(){return this._viewport}set viewport(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}get screenViewport(){if(1===this.pixelRatio)return this._viewport;const t=(0,m.d)((0,y.vt)(),this._viewport,1/this.pixelRatio),e=this._get("screenViewport");return e&&(0,m.e)(t,e)?e:t}get screenPadding(){if(1===this.pixelRatio)return this._padding;const t=(0,m.d)((0,y.vt)(),this._padding,1/this.pixelRatio),e=this._get("screenPadding");return e&&(0,m.e)(t,e)?e:t}get x(){return this._viewport[0]}set x(t){t+=this._padding[T.zj.LEFT],this._viewport[0]!==t&&(this._viewport[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get y(){return this._viewport[1]}set y(t){t+=this._padding[T.zj.BOTTOM],this._viewport[1]!==t&&(this._viewport[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get width(){return this._viewport[2]}set width(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get height(){return this._viewport[3]}set height(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_viewport"))}get fullWidth(){return this._viewport[2]+this._padding[T.zj.RIGHT]+this._padding[T.zj.LEFT]}set fullWidth(t){this.width=t-(this._padding[T.zj.RIGHT]+this._padding[T.zj.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[T.zj.TOP]+this._padding[T.zj.BOTTOM]}set fullHeight(t){this.height=t-(this._padding[T.zj.TOP]+this._padding[T.zj.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[T.zj.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[T.zj.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(t){(0,m.a)(this._padding,t)||(this._viewport[0]+=t[T.zj.LEFT]-this._padding[T.zj.LEFT],this._viewport[1]+=t[T.zj.BOTTOM]-this._padding[T.zj.BOTTOM],this._viewport[2]-=t[T.zj.RIGHT]+t[T.zj.LEFT]-(this._padding[T.zj.RIGHT]+this._padding[T.zj.LEFT]),this._viewport[3]-=t[T.zj.TOP]+t[T.zj.BOTTOM]-(this._padding[T.zj.TOP]+this._padding[T.zj.BOTTOM]),(0,m.c)(this._padding,t),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange("_padding"),this.notifyChange("_viewport"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&((0,u.lw)(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return(0,u.B8)((0,d.vt)(),this.projectionMatrix)||this._get("inverseProjectionMatrix")||(0,d.vt)()}get fov(){return this._fov}set fov(t){this._fov=t,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return t=this._fov,e=this.width,i=this.height,2*Math.atan(e*Math.tan(.5*t)/Math.sqrt(e*e+i*i));var t,e,i}set fovX(t){this._fov=function(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/e)}(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return t=this._fov,e=this.width,i=this.height,2*Math.atan(i*Math.tan(.5*t)/Math.sqrt(e*e+i*i));var t,e,i}set fovY(t){this._fov=function(t,e,i){return 2*Math.atan(Math.sqrt(e*e+i*i)*Math.tan(.5*t)/i)}(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return(0,g.j)(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&((0,u.B8)(this._viewInverseTransposeMatrix,this.viewMatrix),(0,u.mg)(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(t){const e=2*t-1;return 2*this.near*this.far/(this.far+this.near-e*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return null!=this.relativeElevation&&this.relativeElevation>=0}get _projectionMatrixInternal(){const t=this.width,e=this.height,i=this.near*Math.tan(this.fovY/2)*2,n=i*this._aspect,r=i/this.rows,s=n/this.columns,o=-n/2+this.column*s,a=o+s,h=-i/2+this.row*r,l=h+r,c=(0,u.$h)((0,d.vt)(),o*(1+2*this._padding[T.zj.LEFT]/t),a*(1+2*this._padding[T.zj.RIGHT]/t),h*(1+2*this._padding[T.zj.BOTTOM]/e),l*(1+2*this._padding[T.zj.TOP]/e),this.near,this.far),f=this._get("projectionMatrix");return f&&(0,u.aI)(f,c)?f:c}copyFrom(t){(0,g.c)(this._ray.origin,t.eye),this.center=t.center,this.up=t.up,(0,m.c)(this._viewport,t.viewport),this.notifyChange("_viewport"),(0,m.c)(this._padding,t.padding),this.notifyChange("_padding"),(0,f.C)(this._nearFar,t.nearFar),this.notifyChange("_nearFar"),this._fov=t.fov,this.row=t.row,this.column=t.column,this.rows=t.rows,this.columns=t.columns,this.relativeElevation=t.relativeElevation;const e=t;return this._viewDirty=e._viewDirty,this._viewDirty||((0,u.C)(this._viewMatrix,t.viewMatrix),this.notifyChange("_viewMatrix")),this._viewProjectionDirty=!0,this._frustumDirty=e._frustumDirty,this._frustumDirty||((0,_.C)(this._frustum,t.frustum),this._frustumDirty=!1),e._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:((0,u.C)(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),(0,m.c)(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}copyViewFrom(t){this.eye=t.eye,this.center=t.center,this.up=t.up,this.fov=t.fov}clone(){return(new n).copyFrom(this)}equals(t){return(0,g.p)(this.eye,t.eye)&&(0,g.p)(this.center,t.center)&&(0,g.p)(this.up,t.up)&&(0,m.a)(this._viewport,t.viewport)&&(0,m.a)(this._padding,t.padding)&&(0,f.t2)(this.nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation&&this.row===t.row&&this.column===t.column&&this.rows===t.rows&&this.columns===t.columns}almostEquals(t){const e=Math.max(1,1/this.pixelRatio,1/t.pixelRatio);if(Math.abs(t.fov-this._fov)>=.001||(0,m.f)(t.screenPadding,this.screenPadding)>=e||(0,m.f)(this.screenViewport,t.screenViewport)>=e||this.row!==t.row||this.column!==t.column||this.rows!==t.rows||this.columns!==t.columns)return!1;(0,g.a)(C,t.eye,t.center),(0,g.a)(O,this.eye,this.center);const i=(0,g.f)(C,O),n=(0,g.z)(C),r=(0,g.z)(O),s=5e-4;return i*i>=(1-1e-10)*n*r&&(0,g.y)(t.eye,this.eye)<Math.max(n,r)*s*s}computeRenderPixelSizeAt(t){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(t))}computeRenderPixelSizeAtDist(t){return t*this.perRenderPixelRatio}computeScreenPixelSizeAt(t){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(t))}_viewDirectionDistance(t){return Math.abs((0,w.gr)(this.viewForward,(0,g.d)(C,t,this.eye)))}computeScreenPixelSizeAtDist(t){return t*this.perScreenPixelRatio}computeDistanceFromRadius(t,e){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(e||1)))}getScreenCenter(t=(0,h.gs)()){return t[0]=(this.padding[T.zj.LEFT]+this.width/2)/this.pixelRatio,t[1]=(this.padding[T.zj.TOP]+this.height/2)/this.pixelRatio,t}getRenderCenter(t,e=.5,i=.5){return t[0]=this.padding[T.zj.LEFT]+this.width*e,t[1]=this.padding[T.zj.BOTTOM]+this.height*i,t[2]=.5,t}setGLViewport(t){const e=this.viewport,i=this.padding;t.setViewport(e[0]-i[3],e[1]-i[2],e[2]+i[1]+i[3],e[3]+i[0]+i[2])}applyProjection(t,e){t!==S&&(0,g.c)(S,t),S[3]=1,(0,m.t)(S,S,this.projectionMatrix);const i=Math.abs(S[3]);(0,g.h)(S,S,1/i);const n=this.fullViewport;e[0]=(0,a.Cc)(0,n[0]+n[2],.5+.5*S[0]),e[1]=(0,a.Cc)(0,n[1]+n[3],.5+.5*S[1]),e[2]=.5*(S[2]+1),e[3]=i}unapplyProjection(t,e){const i=this.fullViewport;S[0]=(t[0]/(i[0]+i[2])*2-1)*t[3],S[1]=(t[1]/(i[1]+i[3])*2-1)*t[3],S[2]=(2*t[2]-1)*t[3],S[3]=t[3],null!=this.inverseProjectionMatrix&&((0,m.t)(S,S,this.inverseProjectionMatrix),e[0]=S[0],e[1]=S[1],e[2]=S[2])}projectToScreen(t,e){return this.projectToRenderScreen(t,R),this.renderToScreen(R,e),e}projectToRenderScreen(t,e){if(S[0]=t[0],S[1]=t[1],S[2]=t[2],S[3]=1,(0,m.t)(S,S,this.viewProjectionMatrix),0===S[3])return null;const i=S;(0,g.h)(i,i,1/Math.abs(S[3]));const n=this.fullViewport,r=(0,a.Cc)(0,n[0]+n[2],.5+.5*i[0]),s=(0,a.Cc)(0,n[1]+n[3],.5+.5*i[1]);return"x"in e?(e.x=r,e.y=s):(e[0]=r,e[1]=s,e.length>2&&(e[2]=.5*(i[2]+1))),e}unprojectFromScreen(t,e){return this.unprojectFromRenderScreen(this.screenToRender(t,R),e)}unprojectFromRenderScreen(t,e){if((0,u.lw)(E,this.projectionMatrix,this.viewMatrix),!(0,u.B8)(E,E))return null;const i=this.fullViewport;return S[0]=2*(t[0]-i[0])/i[2]-1,S[1]=2*(t[1]-i[1])/i[3]-1,S[2]=2*t[2]-1,S[3]=1,(0,m.t)(S,S,E),0===S[3]?null:(e[0]=S[0]/S[3],e[1]=S[1]/S[3],e[2]=S[2]/S[3],e)}constrainWindowSize(t,e,i,n){const r=t*this.pixelRatio,s=e*this.pixelRatio,o=Math.max(r-i/2,0),a=Math.max(this.fullHeight-s-n/2,0),h=-Math.min(r-i/2,0),l=-Math.min(this.fullHeight-s-n/2,0),c=i-h- -Math.min(this.fullWidth-r-i/2,0),u=n-l- -Math.min(s-n/2,0);return[Math.round(o),Math.round(a),Math.round(c),Math.round(u)]}computeUp(t){t===x.RT.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(t,e){const i=t[0]*this.pixelRatio,n=this.fullHeight-t[1]*this.pixelRatio;return e[0]=i,e[1]=n,e}renderToScreen(t,e){const i=t[0]/this.pixelRatio,n=(this.fullHeight-t[1])/this.pixelRatio;e[0]=i,e[1]=n}_computeUpGlobal(){(0,g.d)(C,this.center,this.eye);const t=(0,g.l)(this.center);t<1?((0,g.i)(this._up,0,0,1),this._markViewDirty(),this.notifyChange("_up")):Math.abs((0,g.f)(C,this.center))>.9999*(0,g.l)(C)*t||((0,g.e)(this._up,C,this.center),(0,g.e)(this._up,this._up,C),(0,g.n)(this._up,this._up),this.notifyChange("_up"),this._markViewDirty())}_computeUpLocal(){(0,g.o)(C,this.eye,this.center),Math.abs(C[2])<=.9999&&((0,g.h)(C,C,C[2]),(0,g.i)(this._up,-C[0],-C[1],1-C[2]),(0,g.n)(this._up,this._up),this.notifyChange("_up"),this._markViewDirty())}_compareAndSetView(t,e,i=""){"number"==typeof t[0]&&isFinite(t[0])&&"number"==typeof t[1]&&isFinite(t[1])&&"number"==typeof t[2]&&isFinite(t[2])?(0,g.p)(t,e)||((0,g.c)(e,t),this._markViewDirty(),i.length&&this.notifyChange(i)):o.A.getLogger("esri.views.3d.webgl-engine.lib.RenderCamera").warn("RenderCamera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&((0,_.ui)(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&((0,u.t5)(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange("_viewMatrix"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};(0,r._)([(0,l.MZ)()],A.prototype,"_viewport",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_padding",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_fov",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_nearFar",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_viewDirty",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_viewMatrix",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_pixelRatio",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"pixelRatio",null),(0,r._)([(0,l.MZ)()],A.prototype,"row",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"column",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"_rows",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"rows",null),(0,r._)([(0,l.MZ)()],A.prototype,"_columns",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"columns",null),(0,r._)([(0,l.MZ)()],A.prototype,"eye",null),(0,r._)([(0,l.MZ)()],A.prototype,"center",null),(0,r._)([(0,l.MZ)()],A.prototype,"_center",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"up",null),(0,r._)([(0,l.MZ)()],A.prototype,"_up",void 0),(0,r._)([(0,l.MZ)()],A.prototype,"viewMatrix",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"viewForward",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"viewUp",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"viewRight",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"nearFar",null),(0,r._)([(0,l.MZ)()],A.prototype,"near",null),(0,r._)([(0,l.MZ)()],A.prototype,"far",null),(0,r._)([(0,l.MZ)()],A.prototype,"viewport",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"screenViewport",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"screenPadding",null),(0,r._)([(0,l.MZ)()],A.prototype,"x",null),(0,r._)([(0,l.MZ)()],A.prototype,"y",null),(0,r._)([(0,l.MZ)()],A.prototype,"width",null),(0,r._)([(0,l.MZ)()],A.prototype,"height",null),(0,r._)([(0,l.MZ)()],A.prototype,"fullWidth",null),(0,r._)([(0,l.MZ)()],A.prototype,"fullHeight",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"_aspect",null),(0,r._)([(0,l.MZ)()],A.prototype,"padding",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"projectionMatrix",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"inverseProjectionMatrix",null),(0,r._)([(0,l.MZ)()],A.prototype,"fov",null),(0,r._)([(0,l.MZ)()],A.prototype,"fovX",null),(0,r._)([(0,l.MZ)()],A.prototype,"fovY",null),(0,r._)([(0,l.MZ)()],A.prototype,"viewInverseTransposeMatrix",null),(0,r._)([(0,l.MZ)({readOnly:!0})],A.prototype,"_projectionMatrixInternal",null),(0,r._)([(0,l.MZ)()],A.prototype,"relativeElevation",void 0),A=n=(0,r._)([(0,c.$)("esri.views.3d.webgl.RenderCamera")],A);const M=A,S=(0,y.vt)(),E=(0,d.vt)(),C=(0,v.vt)(),O=(0,v.vt)(),R=(0,h.r_)()},74174:function(t,e,i){"use strict";i.d(e,{A:function(){return d}});var n=i(53804),r=i(83525),s=i(39819),o=i(28181),a=i(23502),h=i(65953),l=i(46671),c=i(54407);let u=class extends r.A{constructor(t){super(t),this.view=null,this.consumes={required:[]},this.produces=l.hM.COMPOSITE,this.requireGeometryDepth=!1,this._dirty=!0}initialize(){this.addHandles([(0,o.watch)((()=>this.view.ready),(t=>{t&&this.view._stage?.renderer.addRenderNode(this)}),o.Vh)])}destroy(){this.view._stage?.renderer?.removeRenderNode(this)}precompile(){}render(){throw new s.A("RenderNode:render-function-not-implemented","render() is not implemented.")}get camera(){return this.view.state.camera.clone()}get sunLight(){return this.bindParameters.lighting.legacy}get gl(){return this.view._stage.renderView.renderingContext.gl}acquireOutputFramebuffer(){const t=this._frameBuffer?.getTexture()?.descriptor,e=this.view._stage.renderer.fboCache.acquire(t?.width??640,t?.height??480,this.produces);return e.fbo?.initializeAndBind(),e}bindRenderTarget(){return this._frameBuffer?.fbo?.initializeAndBind(),this._frameBuffer}requestRender(t){t===c.C7.UPDATE&&this.view._stage?.renderView.requestRender(t),this._dirty=!0}resetWebGLState(){this.renderingContext.resetState(),this.renderingContext.bindFramebuffer(this._frameBuffer?.fbo)}get fboCache(){return this.view._stage.renderer.fboCache}get bindParameters(){return this.renderContext.bind}get renderingContext(){return this.view._stage.renderView.renderingContext}get renderContext(){return this.view._stage?.renderer.renderContext}updateAnimation(t){return!!this._dirty&&(this._dirty=!1,!0)}doRender(t){this._frameBuffer=t.find((({name:t})=>t===this.produces));try{return this.render(t)}finally{this._frameBuffer=null}}};(0,n._)([(0,a.MZ)({constructOnly:!0})],u.prototype,"view",void 0),(0,n._)([(0,a.MZ)({constructOnly:!0})],u.prototype,"consumes",void 0),(0,n._)([(0,a.MZ)()],u.prototype,"produces",void 0),u=(0,n._)([(0,h.$)("esri.views.3d.webgl.RenderNode")],u);const d=u},98680:function(t,e,i){"use strict";var n,r;i.d(e,{N:function(){return n},z:function(){return r}}),function(t){t[t.RED=0]="RED",t[t.RG=1]="RG",t[t.RGBA4=2]="RGBA4",t[t.RGBA=3]="RGBA",t[t.RGBA_MIPMAP=4]="RGBA_MIPMAP",t[t.R16F=5]="R16F",t[t.RGBA16F=6]="RGBA16F"}(n||(n={})),function(t){t[t.DEPTH_STENCIL_TEXTURE=0]="DEPTH_STENCIL_TEXTURE",t[t.DEPTH16_BUFFER=1]="DEPTH16_BUFFER"}(r||(r={}))},65420:function(t,e,i){"use strict";var n;i.d(e,{RT:function(){return n}}),function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"}(n||(n={}))},93336:function(t,e,i){"use strict";i.d(e,{N:function(){return Jt},l:function(){return ee}});var n,r,s=i(53804),o=i(59469),a=i(83525),h=i(78879),l=i(28181),c=i(23502),u=(i(58941),i(40633),i(13798),i(65953)),d=i(20248);!function(t){t[t.NeverApplied=0]="NeverApplied",t[t.Applied=1]="Applied",t[t.Undone=2]="Undone"}(n||(n={})),function(t){t.UndoRedoUpdating="UndoRedoUpdating",t.UndoInvalidError="UndoInvalidError",t.RedoInvalidError="RedoInvalidError",t.ApplyInvalidError="ApplyInvalidError"}(r||(r={}));const f={[r.UndoRedoUpdating]:"Cannot perform operation whilst undo redo is updating",[r.UndoInvalidError]:"There are no items to Undo",[r.RedoInvalidError]:"There are no items to Redo",[r.ApplyInvalidError]:"Cannot apply an item that is already applied"};class p extends Error{constructor(){super(f[r.UndoRedoUpdating]),this.type="undo-redo-updating-error"}}class g extends Error{constructor(){super(f[r.UndoInvalidError]),this.type="undo-redo-undo-error"}}class v extends Error{constructor(){super(f[r.RedoInvalidError]),this.type="undo-redo-redo-error"}}class m extends Error{constructor(){super(f[r.ApplyInvalidError]),this.type="undo-redo-apply-error"}}var y,_;(_=y||(y={}))[_.Apply=0]="Apply",_[_.Undo=1]="Undo",_[_.Redo=2]="Redo";let b=class extends a.A{constructor(){super(...arguments),this.name="",this.tag=Symbol(),this.status=n.NeverApplied}get canUndo(){return this.status===n.Applied}get canRedo(){return this.status===n.Undone}async executeUndoRedoOperation(t){switch(t){case y.Apply:if(this.status!==n.NeverApplied)throw new m;return await this.apply(),void(this.status=n.Applied);case y.Undo:if(this.status!==n.Applied)throw new g;return await this.undo(),void(this.status=n.Undone);case y.Redo:if(this.status!==n.Undone)throw new g;return await this.redo(),void(this.status=n.Applied)}}};(0,s._)([(0,c.MZ)()],b.prototype,"name",void 0),(0,s._)([(0,c.MZ)()],b.prototype,"tag",void 0),b=(0,s._)([(0,u.$)("esri.undoredo.UndoableOperation")],b);let w=class extends a.A{constructor(){super(...arguments),this._stack=new h.A,this._stackPosition=-1,this._updatingHandles=new d.U}get updating(){return this._updatingHandles.updating}get canUndo(){return this.hasUndo&&!this.updating}get hasUndo(){return this._stackPosition>=0}get canRedo(){return this.hasRedo&&!this.updating}get hasRedo(){return this._stackPosition<this._stack.length-1}_truncateForwardStack(){this._stack.splice(this._stackPosition+1,this._stack.length-this._stackPosition).forEach((t=>t.destroy()))}_drainStack(){this._stack.drain((t=>t.destroy())),this._stackPosition=-1}async undo(){if(!this.hasUndo)throw new g;if(this.updating)throw new p;const t=this._stack.getItemAt(this._stackPosition);t&&await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(y.Undo),--this._stackPosition,t.canRedo||this._truncateForwardStack()})())}async redo(){if(!this.hasRedo)throw new v;if(this.updating)throw new p;const t=this._stack.getItemAt(this._stackPosition+1);if(!t)throw new v;await this._updatingHandles.addPromise((async()=>{await t.executeUndoRedoOperation(y.Redo),++this._stackPosition})())}peekUndo(){if(this.canUndo)return this._stack.getItemAt(this._stackPosition)}peekRedo(){if(this.canRedo)return this._stack.getItemAt(this._stackPosition+1)}async inject(t){if(this.updating)throw new p;await this._updatingHandles.addPromise((async()=>{t.status===n.NeverApplied&&await t.executeUndoRedoOperation(y.Apply),t.canUndo?(this._stack.splice(this._stackPosition+1,0,t),this._stackPosition++):this._stackPosition>-1&&(this._stack.splice(0,this._stackPosition+1).forEach((t=>t.destroy())),this._stackPosition=-1)})())}async add(t){if(this.updating)throw new p;await this._updatingHandles.addPromise((async()=>{t.status===n.NeverApplied&&await t.executeUndoRedoOperation(y.Apply),this._stackPosition>=-1&&this._truncateForwardStack(),t.canUndo?(this._stack.push(t),this._stackPosition=this._stack.length-1):this._drainStack()})())}async removeTagged(t,e=!1){if(this.updating&&!e)return;await(0,l.C_)((()=>!this.updating));const i=new h.A;for(let e=0;e<this._stack.length;e++){const n=this._stack.getItemAt(e);n&&(n.tag===t?(n.destroy(),e===this._stackPosition&&(this._stackPosition=i.length-1)):i.push(n))}this._stack=i,this._stackPosition>i.length-1&&(this._stackPosition=i.length-1)}async clear(t=!1){if(this.updating&&!t)throw new p;await(0,l.C_)((()=>!this.updating)),this._drainStack()}};(0,s._)([(0,c.MZ)()],w.prototype,"_stack",void 0),(0,s._)([(0,c.MZ)()],w.prototype,"_stackPosition",void 0),(0,s._)([(0,c.MZ)()],w.prototype,"updating",null),(0,s._)([(0,c.MZ)({readOnly:!0})],w.prototype,"canUndo",null),(0,s._)([(0,c.MZ)({readOnly:!0})],w.prototype,"hasUndo",null),(0,s._)([(0,c.MZ)({readOnly:!0})],w.prototype,"canRedo",null),(0,s._)([(0,c.MZ)({readOnly:!0})],w.prototype,"hasRedo",null),w=(0,s._)([(0,u.$)("esri.UndoRedo")],w);var x=i(77472),T=i(48996),A=i(61226),M=i(95929),S=i(6338),E=i(19702),C=i(42413);class O{constructor(){this.committedVertices=null,this.cursorVertex=null,this.full=null,this.outline=null,this.cursorEdge=null,this.circle=null,this.rectangle=null}}i(50917);var R,I=i(50659),P=i(21609),N=i(62938),D=i(20551),L=i(32501),z=i(61714),j=i(45532),k=i(44740),F=i(57165),H=i(57862),B=i(1644),G=i(94757);let V=R=class extends k.A{constructor(t){super(t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=t?.hasZ??!1,0!==this.rings.length||!t)return;const i=(0,N.oU)(this.radius,this.radiusUnit,"meters"),n=t.spatialReference;let r,s="geographic";if(n.isWebMercator?s="webMercator":(null!=(n.wkid&&G.A[n.wkid])||(n.wkt2||n.wkt)&&(0,N.x1)(n.wkt2||n.wkt))&&(s="projected"),this.geodesic){let n;switch(s){case"webMercator":n=(0,B.ci)(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":n=t}r=this._createGeodesicCircle(n,i,e),"webMercator"===s&&(r=(0,B.Gh)(r))}else{let n;"webMercator"===s||"projected"===s?n=i/(0,N.Ao)(t.spatialReference):"geographic"===s&&(n=(0,N.vl)(i,"meters",(0,z.tO)(t.spatialReference).radius)),r=this._createPlanarCircle(t,n,e)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:i,radiusUnit:n,geodesic:r}=this;return new R({center:t?.clone(),numberOfPoints:e,radius:i,radiusUnit:n,geodesic:r})}_createGeodesicCircle(t,e,i){let n=0;const r=[];for(;n<360;){const s=[0,0],o=[t.x,t.y];(0,H.vN)(s,o,n,e,F.A.WGS84),this.hasZ&&s.push(t.z),r.push(s),n+=360/i}return r.push(r[0]),new k.A({rings:[r]})}_createPlanarCircle(t,e,i){const n=[],r=2*Math.PI/i;for(let s=0;s<i;++s){const i=r*s,o=[t.x+Math.cos(-i)*e,t.y+Math.sin(-i)*e];this.hasZ&&o.push(t.z),n.push(o)}return n.push(n[0]),new k.A({spatialReference:t.spatialReference,rings:[n]})}};(0,s._)([(0,c.MZ)({type:j.default})],V.prototype,"center",void 0),(0,s._)([(0,c.MZ)()],V.prototype,"geodesic",void 0),(0,s._)([(0,c.MZ)()],V.prototype,"numberOfPoints",void 0),(0,s._)([(0,c.MZ)()],V.prototype,"radius",void 0),(0,s._)([(0,c.MZ)()],V.prototype,"radiusUnit",void 0),V=R=(0,s._)([(0,u.$)("esri.geometry.Circle")],V);const U=V;var $=i(22162),W=i(38441),q=i(57652),Z=i(67348),Y=i(12978),X=i(32237),K=i(61769),J=i(72485);function Q(t,e,i=null){return null!=i?[t,e,i]:[t,e]}function tt(t,e,i=null){return null!=i?{x:t,y:e,z:i}:{x:t,y:e}}class et{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return t.map((t=>this.mapToLocal(t))).filter(I.Ru)}get doUnnormalization(){return!1}}class it extends et{constructor(t,e,i=null){super(e),this._defaultZ=i,this.transform=(0,Y.vt)(),this.transformInv=(0,Y.vt)(),this.transform=(0,Y.o8)(t),(0,Z.B8)(this.transformInv,this.transform)}makeMapPoint(t,e){return Q(t,e,this._defaultZ)}mapToLocal(t){return tt(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return Q(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class nt extends et{constructor(t,e){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=(0,L.vt)(),this.tangentFrameUpWS=(0,L.vt)(),this.tangentFrameRightWS=(0,L.vt)(),this.tangentFrameForwardWS=(0,L.vt)(),this.localFrameRightWS=(0,L.vt)(),this.localFrameUpWS=(0,L.vt)(),this.worldToLocalTransform=(0,K.vt)(),this.localToWorldTransform=(0,K.vt)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=e,this.defaultZ=e.hasZ?e.z:null;const i=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,J._.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,J._.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,J._.Z,this.tangentFrameForwardWS);const n=(0,L.vt)();(0,D.h)(n,this.tangentFrameForwardWS,(0,D.f)(i,this.tangentFrameForwardWS)),(0,D.d)(this.localFrameRightWS,i,n),(0,D.n)(this.localFrameRightWS,this.localFrameRightWS),(0,D.e)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,X.Yc)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,X.B8)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,e){return Q(t,e,this.defaultZ)}mapToLocal(t){const e=(0,L.vt)();this.view.renderCoordsHelper.toRenderCoords(new j.default({x:t[0],y:t[1],spatialReference:this.spatialReference}),e),(0,D.w)(e,e,this.worldToLocalTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(e,new j.default({spatialReference:this.view.spatialReference}));return null!=i?tt(i.x/this.scale,i.y/this.scale):null}localToMap(t){const e=(0,L.vt)();this.view.renderCoordsHelper.toRenderCoords(new j.default({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),e),(0,D.w)(e,e,this.localToWorldTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(e,new j.default({spatialReference:this.view.spatialReference}));return null!=i?Q(i.x,i.y,this.defaultZ):null}}var rt=i(71673),st=i(91508);function ot(t,e){const i=new j.default({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(i.z=t[2]),i}function at(t,e,i){const n=new st.A({paths:t,spatialReference:e});return i&&(0,W._7)(n),n}function ht(t,e,i,n=!0){const r=(0,P.o8)(t);r.forEach((t=>{const e=t[0],i=t[t.length-1];(0,I.aI)(e,i)&&1!==t.length||t.push(t[0])}));let s=new k.A({rings:r,spatialReference:e});return s.rings.forEach((t=>{(0,W.$3)(t)||t.reverse()})),i&&(0,W._7)(s),n&&s.isSelfIntersecting&&(0,q.fn)(e)&&(s=(0,$.simplify)(s)),s}function lt(t,e,i){const n=e.mapToLocalMultiple(t),r=[],s={x:n[0].x,y:n[0].y},o=n[1].x,a=n[1].y,h=Math.round(o-s.x),l=Math.round(a-s.y),c=Math.max(Math.abs(h),Math.abs(l));if(i){const t={x:s.x+c,y:s.y+c},e={x:s.x-c,y:s.y-c};r.push(tt(t.x,e.y),tt(e.x,e.y),tt(e.x,t.y),tt(t.x,t.y))}else{const t={x:h>0?s.x+c:s.x-c,y:l>0?s.y+c:s.y-c};r.push(tt(s.x,s.y),tt(t.x,s.y),tt(t.x,t.y),tt(s.x,t.y))}return ct(ht([r.map((t=>e.localToMap(t))).filter(I.Ru)],e.spatialReference,e.doUnnormalization,!0),r,e)}function ct(t,e,i){const n=ut(e[3],e[2],i),r=ut(e[1],e[2],i),s=ut(e[0],e[1],i),o=ut(e[0],e[3],i);return{geometry:t,midpoints:null!=n&&null!=r&&null!=s&&null!=o?{top:n,right:r,bottom:s,left:o}:null}}function ut(t,e,i){ft[0]=t.x,ft[1]=t.y,ft[2]=0,pt[0]=e.x,pt[1]=e.y,pt[2]=0,(0,D.m)(ft,ft,pt,.5),dt.x=ft[0],dt.y=pt[1],dt.z=pt[2];const n=i.localToMap(dt);return null!=n?ot(n,i.spatialReference):null}const dt=tt(0,0,0),ft=(0,L.vt)(),pt=(0,L.vt)();function gt(t,e,i,n){const r=e.mapToLocalMultiple(t);let s=null,o=null;if(i)s=r[0],o=r[1];else{const t=r[0],e=r[1],i=Math.round(e.x-t.x),n=Math.round(e.y-t.y),a=Math.max(Math.abs(i),Math.abs(n));s=tt(i>0?t.x+a/2:t.x-a/2,n>0?t.y+a/2:t.y-a/2),o=tt(Math.abs(i)>Math.abs(n)?s.x-a/2:s.x,Math.abs(i)>Math.abs(n)?s.y:s.y-a/2)}const a=e.localToMap(s),h=e.localToMap(o);if(null==a||null==h)return null;e.doUnnormalization&&(0,W.JM)([[a,h]],e.spatialReference);const l=ot(a,e.spatialReference),c=ot(h,e.spatialReference),u=(0,N.GA)(e.spatialReference);let d=0;if((0,q.fn)(e.spatialReference))d=u*(0,$.distance)(l,c,null);else{const t=s.x-o.x,e=s.y-o.y;d=u*Math.sqrt(t*t+e*e)*(n||1)}const f=new U({center:l,radius:d,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:ht(f.rings,f.spatialReference,!1),center:l,edge:c}}var vt=i(56275),mt=i(68945);function yt(t,e){switch(t){case"point":case"multipoint":return"point";case"polyline":return function(t){return(null!=t&&"polyline"===t.type&&t.paths.length?t.paths[0].length:0)<2?"polylineZeroVertices":"polylineOneVertex"}(e);case"polygon":return function(t){const e=null!=t&&"polygon"===t.type&&t.rings.length?t.rings[0].length:0;return e<3?"polylineZeroVertices":e<4?"polygonOneVertex":"polygonTwoVertices"}(e);default:return}}const _t=(0,L.vt)();var bt=i(7768),wt=i(24148),xt=i(90858);let Tt=class extends xt.w{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=vt.iT}get allFields(){return[]}};(0,s._)([(0,c.MZ)()],Tt.prototype,"type",void 0),(0,s._)([(0,c.MZ)()],Tt.prototype,"radius",void 0),(0,s._)([(0,c.MZ)()],Tt.prototype,"xSize",void 0),(0,s._)([(0,c.MZ)()],Tt.prototype,"ySize",void 0),(0,s._)([(0,c.MZ)()],Tt.prototype,"area",void 0),(0,s._)([(0,c.MZ)()],Tt.prototype,"allFields",null),Tt=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawCircleTooltipInfo")],Tt);var At=i(87265),Mt=i(73919);let St=class extends((0,Mt.B)(xt.w)){constructor(t){super(t),this.type="draw-mesh",this.orientation=(0,At.LJ)({lockable:!1}),this.scale=(0,At.dy)({lockable:!1})}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,this.orientation,this.scale]}};(0,s._)([(0,c.MZ)()],St.prototype,"helpMessage",void 0),(0,s._)([(0,c.MZ)()],St.prototype,"allFields",null),St=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawMeshTooltipInfo")],St);let Et=class extends((0,Mt.B)(xt.w)){constructor(t){super(t),this.type="draw-point"}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,s._)([(0,c.MZ)()],Et.prototype,"helpMessage",void 0),(0,s._)([(0,c.MZ)()],Et.prototype,"allFields",null),Et=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawPointTooltipInfo")],Et);let Ct=class extends((0,Mt.B)(xt.w)){constructor(t){super(t),this.type="draw-polygon",this.direction=(0,At.Gk)(),this.distance=(0,At.Ku)(),this.area=(0,At.Am)(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.area]}};(0,s._)([(0,c.MZ)()],Ct.prototype,"xyMode",void 0),(0,s._)([(0,c.MZ)()],Ct.prototype,"helpMessage",void 0),(0,s._)([(0,c.MZ)()],Ct.prototype,"allFields",null),Ct=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawPolygonTooltipInfo")],Ct);let Ot=class extends((0,Mt.B)(xt.w)){constructor(t){super(t),this.type="draw-polyline",this.direction=(0,At.Gk)(),this.distance=(0,At.Ku)(),this.totalLength=(0,At.fr)(),this.xyMode="direction-distance"}get allFields(){return[this.direction,this.distance,this.longitude,this.latitude,this.x,this.y,this.elevation,this.totalLength]}};(0,s._)([(0,c.MZ)()],Ot.prototype,"helpMessage",void 0),(0,s._)([(0,c.MZ)()],Ot.prototype,"xyMode",void 0),(0,s._)([(0,c.MZ)()],Ot.prototype,"allFields",null),Ot=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawPolylineTooltipInfo")],Ot);let Rt=class extends xt.w{constructor(t){super(t),this.type="draw-rectangle",this.xSize=vt.r7,this.ySize=vt.r7,this.area=vt.iT}get allFields(){return[]}};(0,s._)([(0,c.MZ)()],Rt.prototype,"type",void 0),(0,s._)([(0,c.MZ)()],Rt.prototype,"xSize",void 0),(0,s._)([(0,c.MZ)()],Rt.prototype,"ySize",void 0),(0,s._)([(0,c.MZ)()],Rt.prototype,"area",void 0),(0,s._)([(0,c.MZ)()],Rt.prototype,"allFields",null),Rt=(0,s._)([(0,u.$)("esri.views.interactive.tooltip.infos.DrawRectangleTooltipInfo")],Rt);var It=i(99675),Pt=i(70474),Nt=i(9862),Dt=i(46517);function Lt(t){const{directionOptions:e,geometryType:i,sketchOptions:n,tooltipInfos:r}=t,s=e=>{const i=$t(t).mode,n=r[e].elevation;"relative-to-ground"===i||"relative-to-scene"===i||"on-the-ground"===i?n.lock(qt(t)):n.unlock()};switch(i){case"polygon":case"polyline":s(i),(t=>{if(e){const i=r[t].direction;i.committed=e.angle,i.unlockOnVertexPlacement=!1,n.values.directionMode=e.mode}})(i);break;case"point":case"mesh":s(i)}}function zt(t){jt(t)?.allFields.forEach((t=>{t.unlockOnVertexPlacement&&t.unlock()}))}function jt({geometryType:t,graphic:e,tooltipInfos:i}){return"multipoint"===t||e?.geometry?.type!==kt[t]?null:i[t]}const kt={point:"point",mesh:"mesh",polyline:"polyline",polygon:"polygon",circle:"polygon",rectangle:"polygon"};function Ft(t,e,i){const{drawOperation:n,view:r,sketchOptions:s}=i,{cursorVertex:o}=n;if(t.sketchOptions=s,t.viewType=r.type,t.setLocationFromPoint(e,Wt(i)),Bt(t.elevation,i),!o)return void(n.constraints=void 0);const a=o;n.constraints={context:Zt(a,i),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:null,direction:null}}function Ht(t,e){const{drawOperation:i,sketchOptions:n,view:r}=e,{cursorVertex:s,lastVertex:o,secondToLastVertex:a}=i,h=n.values.effectiveDirectionMode;t.sketchOptions=n,t.viewType=r.type;const l=o&&s?(0,Nt.Kt)(o,s)??vt.r7:null;if(t.distance.actual=l,t.distance.readOnly=null==o,t.direction.actual=null,t.direction.readOnly=!0,o&&s&&("absolute"===h||a)){const e=(0,It.uR)(a,o,s,h);t.direction.actual=e??vt.n0,t.direction.readOnly=!1}t.setLocationFromPoint(s,Wt(e)),Bt(t.elevation,e);const c=function(t,{sketchOptions:e}){const i=e.tooltips.xyMode;return"auto"===i?t?"direction-distance":"coordinates":i}(o,e);t.xyMode=c,t.direction.visible="direction-distance"===c,t.distance.visible="direction-distance"===c,t.effectiveX.visible="coordinates"===c,t.effectiveY.visible="coordinates"===c;const u=s??o;i.constraints=u?{context:Zt(u,e),x:t.x.committed,y:t.y.committed,longitude:t.longitude.committed,latitude:t.latitude.committed,elevation:t.elevation.committed,distance:t.distance.committed,direction:t.direction.committed}:void 0}function Bt(t,e){const{drawOperation:i}=e,n=i?.cursorVertex??i?.lastVertex;t.actual=(0,Dt.Of)(n)??qt(e),t.visible=i.hasZ,t.readOnly=!1,t.showAsZ=!0}function Gt(t){const e=t.createOperationGeometry?.full;return"polygon"!==e?.type?vt.iT:(0,Pt.n)(e)??vt.iT}function Vt(t){const e=t.createOperationGeometry?.rectangle?.midpoints;return(null!=e?(0,Nt.Kt)(e.left,e.right):null)??vt.r7}function Ut(t){const e=t.createOperationGeometry?.rectangle?.midpoints;return(null!=e?(0,Nt.Kt)(e.top,e.bottom):null)??vt.r7}function $t(t){return t.drawOperation.elevationInfo??mt.qt}function Wt(t){return t.drawOperation.coordinateHelper.spatialReference}function qt(t){const e=(0,N.G9)(Wt(t));return(0,vt.d_)(t.defaultZ*e,"meters")}function Zt(t,e){return(0,bt.hj)(t,e.view,Wt(e),$t(e),e.drawOperation.coordinateHelper.hasZ(),e.sketchOptions.values.effectiveDirectionMode)}var Yt=i(83202),Xt=i(37102),Kt=i(25638);let Jt=class extends(T.A.EventedMixin(Yt.g)){constructor(t){super(t),this._graphic=null,this._coordinateFormatterLoadTask=null,this._createOperationGeometry=null,this.defaultZ=0,this.directionOptions=null,this.geometryType=null,this.hasZ=!0,this.geometryToPlace=null,this.snappingManager=null,this.snapToScene=!1,this.sketchOptions=new Xt.A}initialize(){const{view:t}=this;this.internalGraphicsLayer=new E.default({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer);const e=this.drawOperation=this.makeDrawOperation();this.tooltipInfos=function(t,e){return{point:new Et({sketchOptions:e,viewType:t}),polyline:new Ot({sketchOptions:e,viewType:t}),polygon:new Ct({sketchOptions:e,viewType:t}),mesh:new St({sketchOptions:e,viewType:t}),rectangle:new Rt({sketchOptions:e}),circle:new Tt({sketchOptions:e})}}(t.type,this.sketchOptions);const i=(0,wt.A)((()=>({view:t,options:this.sketchOptions.tooltips})));this.tooltip=i,Lt(this._tooltipsContext),this._coordinateFormatterLoadTask=(0,x.UT)((()=>(0,S.Hh)())),this.addHandles([e.on("vertex-add",(t=>this.onVertexAdd(t))),e.on("vertex-remove",(t=>this.onVertexRemove(t))),e.on("vertex-update",(t=>this.onVertexUpdate(t))),e.on("cursor-update",(t=>this.onCursorUpdate(t))),e.on("cursor-remove",(()=>this._updateGraphic())),e.on("complete",(t=>this.onComplete(t))),this._coordinateFormatterLoadTask,i.on("paste",(t=>(0,wt.HA)(t,this.activeTooltipInfo))),(0,l.watch)((()=>this.cursor),(t=>{e.cursor=t}),l.pc),(0,Kt.fm)((()=>{const{activeTooltipInfo:t,sketchOptions:e}=this;(function(t,e){switch(t?.type){case"draw-point":!function(t,e){const i=e.graphic?.geometry;"point"===i?.type&&(Ft(t,i,e),t.helpMessage=yt("point",i))}(t,e);break;case"draw-polyline":!function(t,e){const{createOperationGeometry:i,drawOperation:n}=e,r=null!=i?i.full:null;r&&"polyline"!==r.type||(Ht(t,e),t.totalLength.actual=n.lastVertex?(r?(0,Nt.ob)(r):null)??vt.r7:null,t.helpMessage=yt("polyline",r))}(t,e);break;case"draw-polygon":!function(t,e){const{createOperationGeometry:i,drawOperation:n}=e,r=null!=i?i.full:null;r&&"polygon"!==r.type||(Ht(t,e),t.area.actual=n.lastVertex?(r?(0,Pt.n)(r):null)??vt.iT:null,t.helpMessage=yt("polygon",r))}(t,e);break;case"draw-rectangle":!function(t,e){t.sketchOptions=e.sketchOptions,t.xSize=Vt(e),t.ySize=Ut(e),t.area=Gt(e)}(t,e);break;case"draw-circle":!function(t,e){const{forceUniformSize:i,sketchOptions:n}=e;t.sketchOptions=n,t.radius=i?function({createOperationGeometry:t}){return(null!=t?.circle?.center&&null!=t.circle.edge?(0,Nt.Kt)(t.circle.center,t.circle.edge):null)??vt.r7}(e):null,t.xSize=i?null:Vt(e),t.ySize=i?null:Ut(e),t.area=Gt(e)}(t,e);break;case"draw-mesh":!function(t,e){const{graphic:i,view:n}=e,r=i?.geometry;"3d"!==n.type||r&&"mesh"!==r.type||(Ft(t,r?.origin,e),r&&(0,wt.Ue)(t,r),t.helpMessage=function(t,e){const i=t?.geometry;if(!t||"mesh"!==i?.type||!e)return;const{renderCoordsHelper:n,elevationProvider:r}=e,{camera:s}=e.state,{extent:o}=i,{center:a,spatialReference:h}=o,l=(0,N.GA)(h),c=(0,N.G9)(h),u=(0,N.GA)(n.spatialReference),d=o.width*l,f=o.height*c,p=(o.zmax??0)*c,g=p-(o.zmin??0)*c,v=Math.max(d,f,g)/u,{x:m,y:y}=a,_=a.z??0;(0,D.i)(_t,m,y,_),n.toRenderCoords(_t,h,_t);const b=v/s.computeScreenPixelSizeAt(_t);if(b>1*s.width)return"meshTooClose";if(b<20)return"meshTooFar";const w=(0,mt.bh)(t),{absoluteZ:x}=(0,mt.Q5)(m,y,p,h,e,w);return x<(r.getElevation(m,y,_,h,"ground")??0)*c+.1*g?"meshUnderground":"mesh"}(i,n))}(t,e)}})(t,this._tooltipsContext),i.info=e.tooltips.effectiveEnabled?t:null})),(0,Kt.fm)((()=>{e.constraintZ=function(t){const{geometryType:e,tooltipInfos:i}=t;switch(e){case"point":case"mesh":case"polyline":case"polygon":{const n=i[e].elevation.committed;if(!n)return;return(0,vt.l3)(n,"meters")/(0,N.G9)(Wt(t))}default:return}}(this._tooltipsContext)}),l.OH)]),this.finishToolCreation()}destroy(){this.drawOperation=(0,M.pR)(this.drawOperation),this.tooltip=(0,M.pR)(this.tooltip),this._destroyAllVisualizations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=(0,M.pR)(this.internalGraphicsLayer),this._set("view",null)}get _drawSpatialReference(){return this.drawOperation.coordinateHelper.spatialReference}get _tooltipsContext(){return{createOperationGeometry:this._createOperationGeometry,defaultZ:this.defaultZ,directionOptions:this.directionOptions,drawOperation:this.drawOperation,forceUniformSize:this.forceUniformSize,geometryType:this.geometryType,graphic:this.graphic,sketchOptions:this.sketchOptions,tooltipInfos:this.tooltipInfos,view:this.view}}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(t){this._set("cursor",t)}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),null!=this._graphic&&(this._graphic.symbol=t)}set mode(t){const e=this.drawOperation;e&&(e.drawingMode=t),this._set("mode",t)}get updating(){return this.drawOperation?.updating??!1}get undoRedo(){const{view:{type:t,map:e}}=this;return"2d"===t&&e&&"undoRedo"in e&&e.undoRedo instanceof w?e.undoRedo:null}set undoRedo(t){this._override("undoRedo",t)}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.destroyed||(0,wt.wG)(t,this.tooltip)||this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo(),0===this.drawOperation.numCommittedVertices&&Lt(this._tooltipsContext)}_destroyAllVisualizations(){this.removeHandles(te.outline),this.removeHandles(te.regularVertices),this.removeHandles(te.activeVertex),this.removeHandles(te.activeEdge),this.removeHandles(Qt)}_createOrUpdateGraphic(t){if(null!=this._graphic)return this.updateGraphicGeometry(t),this._graphic;const e=new o.default({...this.graphicProperties,symbol:this.graphicSymbol});return this._graphic=e,this.updateGraphicGeometry(t),this.internalGraphicsLayer.add(e),this.addHandles(this.initializeGraphic(e)),this.notifyChange("graphic"),this.addHandles((0,A.hA)((()=>{this.internalGraphicsLayer.remove(e),this._graphic===e&&(this._graphic=null)})),Qt),e}updateGraphicGeometry(t){this._graphic.geometry=t}_getCreateOperationGeometry(t={operationComplete:!1}){if(null==this.drawOperation)return;const{coordinateHelper:e,view:i,visualizationCursorVertex:n,lastVertex:r,committedVertices:s,geometryIncludingUncommittedVertices:o,numCommittedVertices:a}=this.drawOperation;if(!(a>0||null!=n))return;const h=t.operationComplete?s:o,l=h.length,c=null!=n?e.pointToArray(n):null,u=this._drawSpatialReference,d="3d"===i.type&&"global"===i.viewingMode,f=new O;f.committedVertices=s,f.cursorVertex=c;const{geometryType:p}=this;switch(p){case"point":case"mesh":f.full=e.arrayToPoint(h[0]);break;case"multipoint":f.full=l>0?function(t,e){return new rt.A({points:t,spatialReference:e})}(h,u):null;break;case"polyline":case"polygon":l>0&&(f.full="polygon"===p?ht([h],u,d,!0):at([h],u,d),f.cursorEdge=null!=c&&r&&!(0,C.CI)(n,r)?at([[c,e.pointToArray(r)]],u,d):null,f.outline=l>1?f.full:null);break;case"circle":case"rectangle":{if(f.committedVertices=f.cursorVertex=null,!l)break;const e=function(t,e){if("2d"===t.type)return new it(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if("3d"===t.type){const i=e.length>2?new j.default({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new j.default({x:e[0],y:e[1],spatialReference:t.spatialReference});return new nt(t,i)}return null}(i,h[0]),n=h[0],r=e.makeMapPoint(n[0]+ie*i.resolution,n[1]);"circle"===p?1===l&&t.operationComplete?f.circle=gt([n,r],e,!0):2===l&&(this.forceUniformSize?f.circle=gt(h,e,this.centered):f.rectangle=function(t,e,i){const n=e.mapToLocalMultiple(t),r=n[0],s=n[1],o=Math.round(s.x-r.x),a=Math.round(s.y-r.y),h=tt(i?r.x:r.x+o/2,i?r.y:r.y+a/2),l=i?o:o/2,c=i?a:a/2,u=[],d=2*Math.PI/60;function f(t){const e=Math.cos(t),i=Math.sin(t);return tt(l*e+h.x,c*i+h.y)}for(let t=0;t<60;t++)u.push(f(t*d));u.push(u[0]);const{spatialReference:p,doUnnormalization:g}=e,v=ht([u.map((t=>e.localToMap(t))).filter(I.Ru)],p,g,!1),m=e.localToMap(f(Math.PI/2)),y=e.localToMap(f(0)),_=e.localToMap(f(-Math.PI/2)),b=e.localToMap(f(Math.PI));return{geometry:v,midpoints:null!=m&&null!=y&&null!=_&&null!=b?{top:ot(m,p),right:ot(y,p),bottom:ot(_,p),left:ot(b,p)}:null}}(h,e,this.centered)):1===l&&t.operationComplete?f.rectangle=lt([n,r],e,!0):2===l&&(f.rectangle=this.forceUniformSize?lt(h,e,this.centered):function(t,e,i){let n=e.mapToLocalMultiple(t);if(1===n.length){const t=48,e=n[0];n=[tt(e.x-t,e.y+t),tt(e.x+t,e.y-t),tt(e.x+t,e.y-t),tt(e.x-t,e.y+t)]}const r=[],s={x:n[0].x,y:n[0].y},o={x:n[1].x,y:n[1].y};if(i){const t=Math.round(o.x-s.x),e=Math.round(o.y-s.y);r.push(tt(s.x-t,s.y-e),tt(o.x,s.y-e),tt(o.x,o.y),tt(s.x-t,o.y))}else r.push(tt(s.x,s.y),tt(o.x,s.y),tt(o.x,o.y),tt(s.x,o.y));return ct(ht([r.map((t=>e.localToMap(t))).filter(I.Ru)],e.spatialReference,e.doUnnormalization,!0),r,e)}(h,e,this.centered)),f.full=null!=f.circle?f.circle.geometry:f.rectangle?.geometry,f.outline="polygon"===f.full?.type?f.full:null;break}default:return null}return f}initializeGraphic(t){return(0,A.hA)()}onComplete(t){if(!this.drawOperation)return;this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const t=this._getCreateOperationGeometry({operationComplete:!0});null!=t&&(e=this._createOrUpdateGraphic(t.full))}this._createOperationGeometry=null,this.emit("complete",{graphic:e,...t})}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){const{drawOperation:t}=this;t&&(t.isCompleted||t.cancel())}onOutlineChanged(t){return(0,A.hA)()}onCursorEdgeChanged(t){return(0,A.hA)()}onVertexAdd(t){zt(this._tooltipsContext),this._updateGraphic(),function(t,e){const{drawOperation:i,view:n}=e,r=jt(e),s=$t(e);if("2d"===n.type||!t||"absolute-height"!==s.mode||1!==i?.numCommittedVertices||!r||"draw-polyline"!==r.type&&"draw-polygon"!==r.type||r.elevation.locked)return;const[o,a,h]=t,l=function(t,e,i,n,r){const{view:s,drawOperation:o}=r;if("3d"!==s.type||!o)return;i??=0;const a=Wt(r),h=$t(r),l=(0,mt.Fo)(s,t,e,i,a,h,n);return(0,Dt.Qc)(l,a)??qt(r)}(o,a,h,s,e);null!=l&&r.elevation.lock(l)}(t.vertices.at(0)?.coordinates,this._tooltipsContext),this.emit("vertex-add",t)}onVertexRemove(t){zt(this._tooltipsContext),this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();this._createOperationGeometry=t,null!=t?(null!=t.cursorEdge?this.addHandles(this.onCursorEdgeChanged(t.cursorEdge),te.activeEdge):this.removeHandles(te.activeEdge),null!=t.outline?this.addHandles(this.onOutlineChanged(t.outline),te.outline):this.removeHandles(te.outline),null!=t.committedVertices?this.addHandles(this.onRegularVerticesChanged(t.committedVertices),te.regularVertices):this.removeHandles(te.regularVertices),null!=t.cursorVertex?this.addHandles(this.onActiveVertexChanged(t.cursorVertex),te.activeVertex):this.removeHandles(te.activeVertex),null!=t.full?this._createOrUpdateGraphic(t.full):this.removeHandles(Qt)):this._destroyAllVisualizations()}get activeTooltipInfo(){return this._coordinateFormatterLoadTask?.finished?jt(this._tooltipsContext):null}};(0,s._)([(0,c.MZ)()],Jt.prototype,"_coordinateFormatterLoadTask",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"_createOperationGeometry",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"_tooltipsContext",null),(0,s._)([(0,c.MZ)({value:!0})],Jt.prototype,"centered",null),(0,s._)([(0,c.MZ)()],Jt.prototype,"cursor",null),(0,s._)([(0,c.MZ)({nonNullable:!0})],Jt.prototype,"defaultZ",void 0),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"directionOptions",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"drawOperation",void 0),(0,s._)([(0,c.MZ)({value:!0})],Jt.prototype,"enabled",null),(0,s._)([(0,c.MZ)({value:!0})],Jt.prototype,"forceUniformSize",null),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"geometryType",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"graphic",null),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"graphicProperties",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"graphicSymbol",null),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"hasZ",void 0),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"geometryToPlace",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"mode",null),(0,s._)([(0,c.MZ)()],Jt.prototype,"snappingManager",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"snapToScene",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"tooltip",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"tooltipInfos",void 0),(0,s._)([(0,c.MZ)({constructOnly:!0,type:Xt.A})],Jt.prototype,"sketchOptions",void 0),(0,s._)([(0,c.MZ)()],Jt.prototype,"updating",null),(0,s._)([(0,c.MZ)({constructOnly:!0,nonNullable:!0})],Jt.prototype,"view",void 0),(0,s._)([(0,c.MZ)({constructOnly:!0})],Jt.prototype,"undoRedo",null),(0,s._)([(0,c.MZ)()],Jt.prototype,"activeTooltipInfo",null),Jt=(0,s._)([(0,u.$)("esri.views.draw.DrawGraphicTool")],Jt);const Qt=Symbol("create-operation-graphic"),te={outline:Symbol("outline-visual"),regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};function ee(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";case"mesh":return"point"}}const ie=48},85499:function(t,e,i){"use strict";i.d(e,{O0:function(){return z}});var n=i(53804),r=i(83525),s=i(48996),o=i(21609),a=i(95929),h=i(7213),l=i(60539),c=i(85876),u=i(28181),d=i(13520),f=i(23502),p=(i(58941),i(40633),i(65953)),g=i(72952),v=i(20248),m=i(42413),y=i(68945),_=i(65420);const b="click";class w{constructor({consumesClicks:t,grabbableForEvent:e}){this.events=new s.A,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.consumesClicks=t,this.grabbableForEvent=e}destroy(){}intersectionDistance(t,e){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}var x=i(50517),T=i(2831),A=i(2623),M=i(7819),S=i(92100),E=i(7768),C=i(50822),O=i(58144),R=i(45908),I=(i(13798),i(48961));let P=class extends r.A{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,l.sg)((async(t,e,i,n)=>{const r=this._frameTask;if(null==r)return;const s=await r.schedule((()=>e.snap({...t,context:i,signal:n})),n);s.valid&&await r.schedule((()=>{this.stagedPoint=s.apply(),t!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=e.update({...this._snapPoints,context:i}))}),n)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){const t="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=t?t.registerTask(I.W6.SNAPPING):I.nu}destroy(){this._abortController=(0,a.DC)(this._abortController),this._frameTask=(0,a.xt)(this._frameTask)}update(t,e,i){this._snapPoints=t;const{point:n,scenePoint:r}=t,s=e.update({point:n,scenePoint:r,context:i});return this.stagedPoint=s,s}async snap(t,e,i){const{point:n,scenePoint:r}=t;return this.stagedPoint=e.update({point:n,scenePoint:r,context:i}),this._snapPoints=t,null==this._abortController&&(this._abortController=new AbortController),this._snap(t,e,i,this._abortController.signal)}async snapAgainNearPreviousMapPoint(t,e){null!=this._snapPoints&&await this.snap(this._snapPoints,t,e)}abort(){this._abortController=(0,a.DC)(this._abortController),this._snapPoints=null}};(0,n._)([(0,f.MZ)({constructOnly:!0})],P.prototype,"view",void 0),(0,n._)([(0,f.MZ)()],P.prototype,"stagedPoint",null),(0,n._)([(0,f.MZ)()],P.prototype,"constrainResult",void 0),(0,n._)([(0,f.MZ)()],P.prototype,"_stagedPoint",void 0),P=(0,n._)([(0,p.$)("esri.views.interactive.snapping.SnappingOperation")],P);var N=i(44425);const D=Symbol(),L=Symbol();let z=class extends(s.A.EventedMixin(r.A)){constructor(t){super(t),this._createOperationCompleted=!1,this._hideDefaultCursor=!1,this._pointerDownStates=new c.A,this._stagedScreenPoint=null,this._stagedPointerType=null,this._updatingHandles=new v.U,this._stagedPointerId=null,this.constraintsEnabled=!1,this.constraints=void 0,this._getPointConstraint=(0,h.B)(E.cx),this._getPolylineOrPolygonConstraint=(0,h.B)(E.lJ),this.constraintZ=null,this.defaultZ=null,this.isDraped=!0,this.labelOptions=new C.A,this.cursor=null,this.loading=!1,this.snapToSceneEnabled=null,this.firstVertex=null,this.lastVertex=null,this.secondToLastVertex=null,null==t.elevationInfo&&(this.elevationInfo=(0,y.bK)(!!t.hasZ))}initialize(){const{geometryType:t,view:e}=this,i=e.spatialReference,n="viewingMode"in e.state?e.state.viewingMode:_.RT.Local,r="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=(0,x.BV)(this.hasZ,this.hasM,i),this._editGeometryOperations=new M.p(new A.ZE(r,this.coordinateHelper),n),this._snappingOperation=new P({view:e}),this.addHandles([(0,u.watch)((()=>({stagedPoint:this._snappingOperation.stagedPoint,constraint:this._constraint})),(({stagedPoint:t,constraint:e},i)=>{const{snappingOptions:n}=this;if(n&&(n.forceDisabled=null!=e&&(0,S.fT)(e)),null!=i&&t===i.stagedPoint&&e!==i.constraint)return this._onKeyboardBasedChange();this._processCursor(t??this._screenToMap(this._stagedScreenPoint))}),{equals:(t,e)=>t.stagedPoint===e.stagedPoint&&(0,a.CM)(t.constraint,e.constraint)}),(0,u.watch)((()=>this.view.viewpoint),((t,e)=>{t&&e&&(0,g.Ui)(t,e)&&this._onKeyboardBasedChange()}))]),this._activeComponent=new A.uA(i,n),this._editGeometryOperations.data.components.push(this._activeComponent);const s=this.segmentLabels;null!=s&&(s.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles((0,u.watch)((()=>this.labelOptions.enabled),(t=>{s.visible=t}),u.pc))),this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{const e=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),i=e.map((t=>t.coordinates)),n=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;(0,m.CI)(n,this.firstVertex)||(this.firstVertex=n);const r=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;(0,m.CI)(r,this.lastVertex)||(this.lastVertex=r);const s=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??null;switch((0,m.CI)(s,this.secondToLastVertex)||(this.secondToLastVertex=s),this._processCursor(this.cursorVertex),t.type){case"vertex-add":this.emit(t.type,{...t,added:i,vertices:e});break;case"vertex-update":this.emit(t.type,{...t,updated:i,vertices:e});break;case"vertex-remove":this.emit(t.type,{...t,removed:i,vertices:e})}})));const o=this._manipulator=new w({consumesClicks:!1,grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size});this.manipulators.add(o),o.grabbable="point"!==t,this.addHandles([o.events.on("immediate-click",(t=>this._onImmediateClick(t))),o.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t))),(0,u.watch)((()=>this.drawingMode),(()=>{this.removeHandles(D),this.addHandles(this._createManipulatorDragPipeline(o),D)}),u.pc),(0,u.watch)((()=>({effectiveCursor:this.effectiveCursor})),(({effectiveCursor:t})=>{o.cursor=t}),u.pc)]),(0,N.BY)(this,(()=>{const t=this.view.inputManager.latestPointerType??"mouse",e=this._getSnappingContext(t);if(null!=this.snappingManager){const t=this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,e);this._updatingHandles.addPromise((0,l.QZ)(t))}}))}destroy(){(0,a.pR)(this.segmentLabels),(0,a.pR)(this._snappingOperation),this._editGeometryOperations=(0,a.pR)(this._editGeometryOperations),this._updatingHandles.destroy()}get _isDragging(){const{_stagedPointerId:t,_manipulator:e}=this;return null!=t&&this._pointerDownStates.has(t)||e.grabbing||!e.interactive}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const t=this._updateAndGetEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}get _constraint(){const{constraints:t,constraintsEnabled:e}=this;if(t&&e)switch(this.geometryType){case"point":return this._getPointConstraint(t);case"polygon":case"polyline":return this._getPolylineOrPolygonConstraint(this.lastVertex,this.secondToLastVertex,t)}}set drawingMode(t){this._set("drawingMode",t??b)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const{cursorVertex:t,lastVertex:e,firstVertex:i,geometryType:n}=this;return"polygon"===n&&(0,m.fk)(t,i)||(0,m.fk)(t,e)?null:t}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const{committedVertices:t,committableVertex:e,coordinateHelper:i}=this,n=t.slice();return null!=e&&n.push(i.pointToArray(e)),n}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();const{committableVertex:t}=this;null!=t&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}complete(t){const e=t?.aborted||!1;this._snappingOperation.abort(),this.snappingManager?.doneSnapping();const{geometryType:i,numCommittedVertices:n}=this,r="multipoint"===i&&0===n||"polyline"===i&&n<2||"polygon"===i&&n<3;"segment"!==i&&"point"!==i||this.commitStagedVertex(),this._createOperationCompleted=!r,(this.isCompleted||e)&&(this._stagedScreenPoint=null,this._stagedPointerId=null,this._stagedPointerType=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:e,type:"complete"}))}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_processCursor(t){const e=(0,o.o8)(this.cursorVertex),i=(0,o.o8)(t),n=i&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(i)??i),r=this._snapToClosingVertex(n),s=this._applyConstraints(r);(0,m.fk)(e,s)||(this._set("cursorVertex",s),this.segmentLabels?.set("stagedVertex",null!=s?this.coordinateHelper.pointToVector(s):null),null==s||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(s)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(t){if(null==t||this._isDragging||"polygon"!==this.geometryType||this.numCommittedVertices<=2)return t;const e=this._mapToScreen(t);if(!e)return t;const i=this._activeComponent;return this._vertexWithinPointerDistance(i.vertices[0].pos,e)?this.firstVertex:this._vertexWithinPointerDistance(i.vertices.at(-1).pos,e)?this.lastVertex:t}_createManipulatorDragPipeline(t){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return(0,T.Xt)(t,((t,e,i,n)=>{const r="touch"===n&&this._snappingEnabled;if(this.isCompleted||!r)return;const{snappingStep:s,cancelSnapping:o}=(0,R.L)({predicate:()=>r,snappingManager:this.snappingManager,snappingContext:new O.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:n,visualizer:this.snappingVisualizer,drawConstraints:this.constraints}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});i=i.next((t=>(r&&null!=this.snappingManager&&this.snappingManager.doneSnapping(),t))).next(o),e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._processCursor(t.mapStart),("segment"===this.geometryType||r&&!this.numCommittedVertices)&&this.commitStagedVertex()),t))).next((0,T.pg)(this.view,this.elevationInfo)).next(...s).next((t=>(r&&(this._processCursor(t.mapEnd),"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t)))}))}_createManipulatorDragPipelineFreehand(t){return(0,T.Xt)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return(0,T.Xt)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this._snappingOperation.abort(),this.addHandles(this._editGeometryOperations.createUndoGroup(),L),this._processCursor(t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this._processCursor(t.mapEnd),"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),this.removeHandles(L),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}get _drawAtFixedElevation(){const{constraintsEnabled:t,constraintZ:e,geometryType:i,numCommittedVertices:n}=this;return t?null!=e||"segment"===i&&n>0:("segment"===i||"polygon"===i)&&n>0}_updateAndGetEffectiveDrawSurface(){const{constraintsEnabled:t,coordinateHelper:e,drawSurface:i,elevationDrawSurface:n,snapToSceneEnabled:r}=this;if(null==n)return i;if(!this.hasZ)return n.defaultZ=null,n;const s=this.elevationInfo?.mode;let o=this.defaultZ,a=t||"absolute-height"===s;return null!=r&&(a=r),"on-the-ground"===s&&(a=!1),this._drawAtFixedElevation&&(o=(t?this.constraintZ:null)??e.getZ(this._activeComponent.vertices[0].pos),a=!1),a?i:(n.defaultZ=o,n)}_mapToScreen(t){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&this._processCursor(t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if(!("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging))try{const{drawingMode:e,geometryType:i}=this;this._stagedPointerType=t.pointerType,this._stagedScreenPoint=t.screenPoint;const n=this._screenToMap(t.screenPoint);if(null==n)return;if(null==n||"freehand"===e&&"point"!==i)return;if(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(n),null==this.committableVertex)return void this.complete();this.commitStagedVertex(),"mouse"!==t.pointerType&&this._processCursor(null),("freehand"===e||"point"===i||"segment"===i&&2===this.numCommittedVertices||"segment"===i&&"hybrid"===e&&1===this.numCommittedVertices)&&this.complete()}finally{t.stopPropagation()}}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=(0,d.tc)(t.x,t.y);this._stagedScreenPoint=e,this._stagedPointerType=t.pointerType,this._stagedPointerId=t.pointerId,this._isDragging?this._snappingOperation.abort():(t.stopPropagation(),this._processCursorMovementRelativeToSurface(e,t.pointerType))}_onKeyboardBasedChange(){"mouse"===this._stagedPointerType&&this._stagedScreenPoint&&null!=this._stagedPointerId&&!this._isDragging?this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType):this._snappingOperation.abort()}_processCursorMovementRelativeToSurface(t,e){const i=this._snappingOperation,n=this._screenToMap(t),r=this._requiresScenePoint?this.drawSurface?.screenToMap(t):null;if(null==n)return this._hideDefaultCursor=!0,this._processCursor(null),void i.abort();this._hideDefaultCursor=!1;const s=this.snappingManager;if(null==s)return this._processCursor(n),void i.abort();const o=this._getSnappingContext(e);this._updatingHandles.addPromise((0,l.QZ)(i.snap({point:n,scenePoint:r},s,o)))}_applyConstraints(t){const{_constraint:e,constraints:i}=this;if(!t||!i||!e)return t;const{context:n}=i,r=(0,E.dz)(t,n),s=r?e.closestTo(r):void 0;if(!s)return t;const o=(0,E.tC)(s,t,n),a="2d"===this.view.type||"absolute-height"!==n.elevationInfo.mode;return null!=o&&a&&null!=this.constraintZ&&this.hasZ&&(o.z=this.constraintZ),o}_screenToMap(t){return t?this._updateAndGetEffectiveDrawSurface()?.screenToMap(t):null}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),null==t)return null;const i=this._screenToMap(e.screenEnd);return null!=i?{...e,mapStart:t,mapEnd:i}:null}}_vertexWithinPointerDistance(t,e){const i=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return null!=i&&function(t,e){const i=t.x-e.x,n=t.y-e.y;return i*i+n*n<=25}(i,e)}_getSnappingContext(t){const e=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new O.e({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=e?{value:e,elevationInfo:this.elevationInfo}:null,drawConstraints:this.constraints})}};(0,n._)([(0,f.MZ)()],z.prototype,"_hideDefaultCursor",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"_stagedPointerId",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"_isDragging",null),(0,n._)([(0,f.MZ)()],z.prototype,"_snappingOperation",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"_snappingEnabled",null),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"graphic",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"constraintsEnabled",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"constraints",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"_constraint",null),(0,n._)([(0,f.MZ)()],z.prototype,"constraintZ",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"defaultZ",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"isDraped",void 0),(0,n._)([(0,f.MZ)({value:b})],z.prototype,"drawingMode",null),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"elevationDrawSurface",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"elevationInfo",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0,type:C.A})],z.prototype,"labelOptions",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"geometryType",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"hasM",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"hasZ",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"cursor",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"effectiveCursor",null),(0,n._)([(0,f.MZ)()],z.prototype,"loading",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"manipulators",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"drawSurface",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"segmentLabels",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"snappingManager",void 0),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"snappingVisualizer",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"snapToSceneEnabled",void 0),(0,n._)([(0,f.MZ)({readOnly:!0})],z.prototype,"cursorVertex",null),(0,n._)([(0,f.MZ)({readOnly:!0})],z.prototype,"visualizationCursorVertex",null),(0,n._)([(0,f.MZ)()],z.prototype,"committableVertex",null),(0,n._)([(0,f.MZ)()],z.prototype,"firstVertex",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"lastVertex",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"secondToLastVertex",void 0),(0,n._)([(0,f.MZ)()],z.prototype,"updating",null),(0,n._)([(0,f.MZ)({constructOnly:!0})],z.prototype,"view",void 0),z=(0,n._)([(0,p.$)("esri.views.draw.DrawOperation")],z)},99113:function(t,e,i){"use strict";i.d(e,{IX:function(){return c},rT:function(){return l},uF:function(){return u}}),i(50917);var n=i(13520),r=i(46460),s=i(45328),o=i(68945),a=i(57165),h=i(45532);class l{constructor(t,e,i,n=null){this._elevationInfo=t,this.defaultZ=e,this._view=i,this._excludeGraphics=n}screenToMap(t){const{defaultZ:e,_view:i}=this,r=i.sceneIntersectionHelper.intersectElevationFromScreen((0,n.gs)(t.x,t.y),this._elevationInfo,e??0,this._excludeGraphics);return null==e&&null!=r&&(r.z=void 0),r}mapToScreen(t){const e=(0,r.T)(t.x,t.y,(0,o.wS)(this._view,t,this._elevationInfo),t.spatialReference);return this._view.toScreen(e)}constrainZ(t){const{defaultZ:e}=this;return null!=e&&t.z!==e&&((t=(0,s.EL)(t)).z=e),t}}class c{constructor(t,e,i=[]){this.view=t,this.elevationInfo=e,this.exclude=i}screenToMap(t){const e=this.view.toMap(t,{exclude:this.exclude,excludeLabels:!0});return null!=e&&(e.z=(0,o.id)(e,this.view,this.elevationInfo)),e}mapToScreen(t){let e=t;return null!=this.elevationInfo&&(e=(0,r.T)(t.x,t.y,(0,o.wS)(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(e)}constrainZ(t){return t}}class u{constructor(t,e=!1,i=0){this.view=t,this.hasZ=e,this.defaultZ=i,this.mapToScreen=e=>t.toScreen(e),this.screenToMap=e?e=>{const n=t.toMap(e);return n.z=i,n}:e=>t.toMap(e)}constrainZ(t){const{defaultZ:e}=this;return this.hasZ&&t.z!==e&&((t=(0,s.EL)(t)).z=e),t}}class d{screenToMap(t){const{x:e,y:i}=t;return new h.default({x:e,y:i,spatialReference:d.spatialReference})}mapToScreen(t){return(0,n.tc)(t.x,t.y)}constrainZ(t){return t}}d.spatialReference=new a.A},71168:function(t,e,i){"use strict";var n;i.d(e,{w:function(){return n}}),function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"}(n||(n={}))},82067:function(t,e,i){"use strict";i.d(e,{l:function(){return b}});var n=i(53804),r=i(83525),s=i(48996),o=i(28181),a=i(13520),h=i(23502),l=(i(58941),i(40633),i(13798),i(65953)),c=i(13786),u=i(20551),d=i(32501),f=i(46157),p=i(56763),g=i(68945),v=i(74661),m=i(6422),y=i(17921),_=i(33383);let b=class extends r.A{set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set("graphic",t),this.attachSymbolChanged()}get elevationInfo(){const{layer:t}=this.graphic,e=t&&"elevationInfo"in t?t.elevationInfo:null,i=(0,g.ky)(this.graphic),n=e?e.offset:0;return new m.A({mode:i,offset:n})}set focusedSymbol(t){t!==this._get("focusedSymbol")&&(this._set("focusedSymbol",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get("grabbing")&&(this._set("grabbing",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get("hovering")&&(this._set("hovering",t),this._updateGraphicSymbol())}set selected(t){t!==this._get("selected")&&(this._set("selected",t),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.consumesClicks=!0,this.events=new s.A.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const i=e.geometry;if(null==i)return null;const n=this._get("focusedSymbol"),r=null!=n?n:e.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,t,i,r):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=(0,o.watch)((()=>this.graphic?.symbol),(t=>{null!=t&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))}),o.OH)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,i,n){if(null==(n=n||(0,v.SF)(i)))return null;let r=this._circleCollisionCache;if("point"===i.type&&"cim"===n.type&&"CIMPointSymbol"===n.data.symbol?.type&&n.data.symbol.symbolLayers){const{offsetX:r,offsetY:s,size:o}=(0,y.T)(n),h=(0,a.WA)(e,x),l=o/2,u=t.toScreen(i),d=u.x+r,f=u.y+s;return(0,c.hG)(h,[d,f])<l*l?1:null}if("point"!==i.type||"simple-marker"!==n.type)return(0,_.t)(e,i,t)?1:null;if(null==r||!r.originalPoint.equals(i)){const e=i,s=t.spatialReference;if((0,f.canProjectWithoutEngine)(e.spatialReference,s)){const t=(0,f.project)(e,s);r={originalPoint:e.clone(),mapPoint:t,radiusPx:(0,a.Lz)(n.size)},this._circleCollisionCache=r}}if(null!=r){const i=(0,a.WA)(e,x),s=t.toScreen?.(r.mapPoint);if(!s)return null;const o=r.radiusPx,h=s.x+(0,a.Lz)(n.xoffset),l=s.y-(0,a.Lz)(n.yoffset);return(0,c.hG)(i,[h,l])<o*o?1:null}return null}_intersectDistance3D(t,e,i){const n=t.toMap(e,{include:[i]});return n&&(0,p.g)(n,w,t.renderSpatialReference)?(0,u.j)(w,t.state.camera.eye):null}};(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],b.prototype,"graphic",null),(0,n._)([(0,h.MZ)()],b.prototype,"elevationInfo",null),(0,n._)([(0,h.MZ)({constructOnly:!0,nonNullable:!0})],b.prototype,"view",void 0),(0,n._)([(0,h.MZ)({value:null})],b.prototype,"focusedSymbol",null),(0,n._)([(0,h.MZ)({constructOnly:!0})],b.prototype,"layer",void 0),(0,n._)([(0,h.MZ)()],b.prototype,"interactive",void 0),(0,n._)([(0,h.MZ)()],b.prototype,"selectable",void 0),(0,n._)([(0,h.MZ)()],b.prototype,"grabbable",void 0),(0,n._)([(0,h.MZ)({value:!1})],b.prototype,"grabbing",null),(0,n._)([(0,h.MZ)()],b.prototype,"dragging",void 0),(0,n._)([(0,h.MZ)()],b.prototype,"hovering",null),(0,n._)([(0,h.MZ)({value:!1})],b.prototype,"selected",null),(0,n._)([(0,h.MZ)()],b.prototype,"cursor",void 0),b=(0,n._)([(0,l.$)("esri.views.interactive.GraphicManipulator")],b);const w=(0,d.vt)(),x=(0,a.gs)()},83202:function(t,e,i){"use strict";i.d(e,{g:function(){return f}});var n,r,s=i(53804),o=i(83525),a=(i(58941),i(40633),i(60539)),h=i(23502),l=(i(13798),i(65953)),c=i(53551),u=i(78879);(r=n||(n={}))[r.WhenToolEditable=0]="WhenToolEditable",r[r.WhenToolNotEditable=1]="WhenToolNotEditable",r[r.Always=2]="Always";class d{constructor(){this._isToolEditable=!0,this._manipulators=new u.A,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(t){this._isToolEditable=t}get length(){return this._manipulators.length}add(t,e=n.WhenToolEditable){this.addMany([t],e)}addMany(t,e=n.WhenToolEditable){for(const i of t){const t={manipulator:i,visibilityPredicate:e,attached:!1};this._manipulators.add(t),this._attached&&this._updateManipulatorAttachment(t)}}remove(t){for(let e=0;e<this._manipulators.length;e++)if(this._manipulators.at(e).manipulator===t){const t=this._manipulators.splice(e,1)[0];this._detachManipulator(t);break}}removeAll(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._manipulators.removeAll()}attach(){this._manipulators.forEach((t=>{this._updateManipulatorAttachment(t)})),this._attached=!0}detach(){this._manipulators.forEach((t=>{this._detachManipulator(t)})),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach((({manipulator:t})=>t.destroy())),this._manipulators.destroy(),this._resourceContexts=null}on(t,e){return this._manipulators.on(t,(t=>{e(t)}))}forEach(t){for(const e of this._manipulators.items)t(e)}some(t){return this._manipulators.items.some(t)}toArray(){const t=[];return this.forEach((e=>t.push(e.manipulator))),t}intersect(t,e){let i=null,n=Number.MAX_VALUE;return this._manipulators.forEach((({manipulator:r,attached:s})=>{if(!s||!r.interactive)return;const o=r.intersectionDistance(t,e);null!=o&&o<n&&(n=o,i=r)})),i}_updateManipulatorAttachment(t){this._isManipulatorItemVisible(t)?this._attachManipulator(t):this._detachManipulator(t)}_attachManipulator(t){t.attached||(t.manipulator.attach&&t.manipulator.attach(this._resourceContexts),t.attached=!0)}_detachManipulator(t){if(!t.attached)return;const e=t.manipulator;e.grabbing=!1,e.dragging=!1,e.hovering=!1,e.selected=!1,e.detach&&e.detach(this._resourceContexts),t.attached=!1}_isManipulatorItemVisible(t){return t.visibilityPredicate===n.Always||(this._isToolEditable?t.visibilityPredicate===n.WhenToolEditable:t.visibilityPredicate===n.WhenToolNotEditable)}}let f=class extends o.A{constructor(t){super(t),this.manipulators=new d,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[c.PK.MANAGER,!0],[c.PK.USER,!0]]),this._creationFinishedResolver=(0,a.Tw)()}get active(){return null!=this.view&&this.view.activeTool===this}set visible(t){this._get("visible")!==t&&(this._set("visible",t),this._syncVisible())}get editable(){return this.getEditableFlag(c.PK.USER)}set editable(t){this.setEditableFlag(c.PK.USER,t)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){null!=this.view&&(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(t){this.onInputEvent(t)}handleInputEventAfter(t){this.onInputEventAfter(t)}setEditableFlag(t,e){this._editableFlags.set(t,e),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),t===c.PK.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(t){return this._editableFlags.get(t)??!1}endDrag(){const t=this.view.inputManager.latestPointerLocation;if(!t)return;let e=!1;this.manipulators.forEach((({manipulator:i})=>{i.dragging&&(e=!0,i.events.emit("drag",{action:"end",start:t,screenPoint:t}))})),e&&(this.view.toolViewManager.activeTool=null)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(t){}onInputEventAfter(t){}get internallyEditable(){return this.getEditableFlag(c.PK.USER)&&this.getEditableFlag(c.PK.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized)if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};(0,s._)([(0,h.MZ)({constructOnly:!0})],f.prototype,"view",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"active",null),(0,s._)([(0,h.MZ)({value:!0})],f.prototype,"visible",null),(0,s._)([(0,h.MZ)({value:!0})],f.prototype,"editable",null),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"manipulators",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"updating",null),(0,s._)([(0,h.MZ)()],f.prototype,"cursor",null),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"automaticManipulatorSelection",void 0),(0,s._)([(0,h.MZ)()],f.prototype,"hasFocusedManipulators",null),(0,s._)([(0,h.MZ)()],f.prototype,"hasGrabbedManipulators",void 0),(0,s._)([(0,h.MZ)()],f.prototype,"hasHoveredManipulators",void 0),(0,s._)([(0,h.MZ)()],f.prototype,"firstGrabbedManipulator",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"created",void 0),(0,s._)([(0,h.MZ)({readOnly:!0})],f.prototype,"removeIncompleteOnCancel",void 0),f=(0,s._)([(0,l.$)("esri.views.interactive.InteractiveToolBase")],f)},50517:function(t,e,i){"use strict";i.d(e,{BV:function(){return g}});var n,r,s=i(13786),o=i(1932),a=i(20551),h=i(32501),l=i(33400),c=i(41546),u=i(45532);(r=n||(n={}))[r.Z=0]="Z",r[r.M=1]="M";class d{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,o.vt)())}pointToVector(t){return this._tag((0,o.fA)(t.x,t.y))}arrayToVector(t){return this._tag((0,o.fA)(t[0],t[1]))}vectorToArray(t){return[t[0],t[1]]}pointToArray(t){return[t.x,t.y]}vectorToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){if(t)return e??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.hasZ=!1,e.hasM=!1,e.spatialReference=this.spatialReference,e}lerp(t,e,i,n){return(0,s.Cc)(n,t,e,i)}addDelta(t,e,i){t[0]+=e,t[1]+=i}distance(t,e){return(0,s.Io)(t,e)}getZ(t,e=void 0){return e}hasZ(){return!1}getM(t,e=void 0){return e}hasM(){return!1}clone(t){return this._tag((0,o.ci)(t))}copy(t,e){return(0,s.C)(e,t)}fromXYZ(t){return this._tag((0,o.fA)(t[0],t[1]))}toXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t[0],t[1],0)}pointToXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t.x,t.y,0)}equals(t,e){return(0,s.aI)(t,e)}_tag(t){return t}}class f{constructor(t,e){this._valueType=t,this.spatialReference=e}createVector(){return this._tag((0,h.vt)())}pointToVector(t){return this._tag((0,h.fA)(t.x,t.y,this._valueType===n.Z?t.z:t.m))}arrayToVector(t){return this._tag((0,h.fA)(t[0],t[1],t[2]||0))}vectorToArray(t){return[t[0],t[1],t[2]]}pointToArray(t){return this._valueType===n.Z?[t.x,t.y,t.z]:[t.x,t.y,t.m]}vectorToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=this._valueType===n.Z?t[2]:void 0,e.m=this._valueType===n.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=this._valueType===n.Z?t[2]:void 0,e.m=this._valueType===n.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){if(!t)return;e??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"};const i=this._valueType===n.Z,r=this._valueType===n.M;return e.x=t[0],e.y=t[1],e.z=i?t[2]:void 0,e.m=r?t[2]:void 0,e.hasZ=i,e.hasM=r,e.spatialReference=this.spatialReference,e}lerp(t,e,i,n){return(0,a.m)(n,t,e,i)}addDelta(t,e,i,r){t[0]+=e,t[1]+=i,this._valueType===n.Z&&(t[2]+=r)}distance(t,e){return this._valueType===n.Z?(0,a.j)(t,e):(0,s.Io)(t,e)}getZ(t,e=void 0){return this._valueType===n.Z?t[2]:e}hasZ(){return this._valueType===n.Z}getM(t,e=void 0){return this._valueType===n.M?t[2]:e}hasM(){return this._valueType===n.M}clone(t){return this._tag((0,h.ci)(t))}copy(t,e){return(0,a.c)(e,t)}fromXYZ(t,e=0,i=0){return this._tag((0,h.fA)(t[0],t[1],this._valueType===n.Z?t.length>2?t[2]:e:i))}toXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t[0],t[1],this._valueType===n.Z?t[2]:0)}pointToXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t.x,t.y,this._valueType===n.Z?t.z??0:0)}equals(t,e){return(0,a.H)(t,e)}_tag(t){return t}}class p{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,c.vt)())}pointToVector(t){return this._tag((0,c.fA)(t.x,t.y,t.z,t.m))}arrayToVector(t){return this._tag((0,c.fA)(t[0],t[1],t[2]||0,t[3]||0))}vectorToArray(t){return[t[0],t[1],t[2],t[3]]}pointToArray(t){return[t.x,t.y,t.z,t.m]}vectorToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new u.default){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e){if(t)return e??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.hasZ=!0,e.hasM=!0,e.spatialReference=this.spatialReference,e}lerp(t,e,i,n){return(0,l.l)(n,t,e,i)}addDelta(t,e,i,n){t[0]+=e,t[1]+=i,t[2]+=n}distance(t,e){return(0,a.j)(t,e)}getZ(t){return t[2]}hasZ(){return!0}getM(t){return t[3]}hasM(){return!0}clone(t){return this._tag((0,c.ci)(t))}copy(t,e){return(0,l.c)(e,t)}fromXYZ(t,e=0,i=0){return this._tag((0,c.fA)(t[0],t[1],t.length>2?t[2]:e,i))}toXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t[0],t[1],t[2])}pointToXYZ(t,e=(0,h.vt)()){return(0,a.i)(e,t.x,t.y,t.z??0)}equals(t,e){return(0,l.e)(t,e)}_tag(t){return t}}function g(t,e,i){return t&&e?new p(i):e?new f(n.M,i):t?new f(n.Z,i):new d(i)}},2831:function(t,e,i){"use strict";i.d(e,{EX:function(){return b},RS:function(){return E},Tp:function(){return x},Wp:function(){return f},Xt:function(){return u},an:function(){return d},bl:function(){return m},dp:function(){return y},mc:function(){return _},pg:function(){return M},rh:function(){return A},sO:function(){return w},y$:function(){return v}});var n=i(50659),r=(i(58941),i(21609),i(15774)),s=i(13520),o=i(46157),a=i(67376),h=i(45328),l=i(68945),c=i(7819);function u(t,e){return t.events.on("drag",function(t,e){let i=null,n=null;return r=>{if("cancel"===r.action)return void(null!=n&&(n.execute({action:"cancel"}),i=null,n=null));const s={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};"start"===r.action&&null==i&&(i=new A,n=new A,e(t,i,n,r.pointerType,s)),null!=i&&i.execute(s),"end"===r.action&&null!=i&&(i=null,n=null)}}(t,e))}function d(t,e){const i=[t.x,t.y,t.z??0],n=e,r=[Math.cos(n),Math.sin(n)],s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(0===s)return null;r[0]/=s,r[1]/=s;const o=t=>{const e=(t.x-i[0])*r[0]+(t.y-i[1])*r[1];t.x=i[0]+e*r[0],t.y=i[1]+e*r[1]};return t=>(o(t.mapStart),o(t.mapEnd),{...t,axis:r})}function f(t){let e=null;return i=>{if("start"===i.action&&(e=function(t,e){const i=t.operations;if(!i)return null;const n=i.data.geometry,r=(0,h.RS)(e);if(n.spatialReference.equals(r))return g(t,i,(()=>{}));if("mesh"!==n.type){const e=p(n,r);if(null==e)return null;const s=n.spatialReference;return g(t,c.p.fromGeometry(e,i.viewingMode),(()=>{const t=(0,o.project)(n,s);i.trySetGeometry(t)}))}if((0,a.CK)(n)){const e=p(n.origin,r);if(!e)return null;const s=n.spatialReference,a=c.p.fromGeometry(e,i.viewingMode);return g(t,i,(()=>{const t=(0,o.project)(a.data.geometry,s),e=t.x-n.origin.x,r=t.y-n.origin.y,h=(t.z??0)-(n.origin.z??0);i.move(e,r,h)}))}return null}(t,i.mapStart.spatialReference)),null==e)return null;const n=i.mapEnd.x-i.mapStart.x,r=i.mapEnd.y-i.mapStart.y,s=(i.mapEnd.z??0)-(i.mapStart.z??0);return e.move(n,r,s,i.action),{...i,translationX:n,translationY:r,translationZ:s}}}function p(t,e){return null==t?null:t.spatialReference.equals(e)?t.clone():(0,o.project)(t,e)}function g(t,e,i){let n=0,r=0,s=0;return{move:(o,a,h,l)=>{"start"===l&&(n=0,r=0,s=0);const c=o-n,u=a-r,d=h-s;e.move(c,u,d),n+=c,r+=u,s+=d,i(),"end"===l&&t.endInteraction?.()}}}function v(t,e=null,i){let n=null;const r=null==e||t.spatialReference?.equals(e)?t=>t:t=>null!=t?(0,o.project)(t,e):t,s={exclude:[],...i};return e=>{if("start"===e.action&&(n=r(t.toMap(e.screenStart,s))),null==n)return null;const i=r(t.toMap(e.screenEnd,s));return null!=i?{...e,mapStart:n,mapEnd:i}:null}}function m(t){const e=t.map((t=>f(t))).filter(n.Ru);return t=>{const i=t.mapEnd.x-t.mapStart.x,n=t.mapEnd.y-t.mapStart.y,r=t.mapEnd.z-t.mapStart.z;return e.forEach((e=>e(t))),{...t,translationX:i,translationY:n,translationZ:r}}}function y(t){const e=t.operations?.createResetState();return t=>(e?.remove(),t)}function _(t){const e=t.map((t=>y(t))).filter((t=>null!=t));return t=>(e.forEach((e=>e(t))),t)}function b(){let t=0,e=0,i=0;return n=>{"start"===n.action&&(t=n.mapStart.x,e=n.mapStart.y,i=n.mapStart.z);const r=n.mapEnd.x-t,s=n.mapEnd.y-e,o=n.mapEnd.z-i;return t=n.mapEnd.x,e=n.mapEnd.y,i=n.mapEnd.z,{...n,mapDeltaX:r,mapDeltaY:s,mapDeltaZ:o,mapDeltaSpatialReference:n.mapStart.spatialReference}}}function w(){let t=0,e=0;return i=>{"start"===i.action&&(t=i.screenStart.x,e=i.screenStart.y);const n=i.screenEnd.x-t,r=i.screenEnd.y-e;return t=i.screenEnd.x,e=i.screenEnd.y,{...i,screenDeltaX:n,screenDeltaY:r}}}function x(t,e){let i=null,n=0,o=0;return a=>{if("start"===a.action&&(i=t.toScreen?.(e),null!=i&&(i.x<0||i.x>t.width||i.y<0||i.y>t.height?i=null:(n=a.screenStart.x-i.x,o=a.screenStart.y-i.y))),null==i)return null;const h=(0,r.qE)(a.screenEnd.x-n,0,t.width),l=(0,r.qE)(a.screenEnd.y-o,0,t.height),c=(0,s.tc)(h,l);return a.screenStart=i,a.screenEnd=c,a}}const T=()=>{};class A{constructor(){this.execute=T}next(t,e=new A){return null!=t&&(this.execute=i=>{const n=t(i);null!=n&&e.execute(n)}),e}}function M(t,e,i=[]){if("2d"===t.type)return t=>t;let n=null;return r=>{"start"===r.action&&(n=t.toMap(r.screenStart,{exclude:i}),null!=n&&(n.z=(0,l.id)(n,t,e)));const s=t.toMap(r.screenEnd,{exclude:i});null!=s&&(s.z=(0,l.id)(s,t,e));const o=null!=n&&null!=s?{sceneStart:n,sceneEnd:s}:null;return{...r,scenePoints:o}}}function S(t,e,i){const n=e.elevationProvider.getElevation(t.x,t.y,t.z??0,t.spatialReference,"scene")??0,r=(0,h.EL)(t);return r.z=n,r.hasZ=!0,r.z=(0,l.id)(r,e,i),r}function E(t,e){if("2d"===t.type)return t=>t;let i=null;return n=>{"start"===n.action&&(i=S(n.mapStart,t,e));const r=S(n.mapEnd,t,e),s=null!=i&&null!=r?{sceneStart:i,sceneEnd:r}:null;return{...n,scenePoints:s}}}},2623:function(t,e,i){"use strict";i.d(e,{uA:function(){return f},oH:function(){return d},ZE:function(){return p},Li:function(){return u},oF:function(){return v}});var n=i(50659),r=i(82547),s=i(48996),o=i(44740),a=i(91508),h=i(50517),l=i(57652),c=i(65420);class u{constructor(t){this.component=t,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(t){this._pos=t,this.component.unnormalizeVertexPositions()}}class d{constructor(t,e,i){this.component=t,this.leftVertex=e,this.rightVertex=i,this.type="edge",e.rightEdge=this,i.leftEdge=this}}class f{constructor(t,e){this._spatialReference=t,this._viewingMode=e,this.vertices=[],this.edges=[],this.index=null}unnormalizeVertexPositions(){this.vertices.length<=1||function(t,e){if(!e.supported)return;let i=1/0,n=-1/0;const r=e.upperBoundX-e.lowerBoundX;t.forEach((t=>{let s=t.pos[0];for(;s<e.lowerBoundX;)s+=r;for(;s>e.upperBoundX;)s-=r;i=Math.min(i,s),n=Math.max(n,s),t.pos[0]=s}));const s=n-i;r-s<s&&t.forEach((t=>{t.pos[0]<0&&(t.pos[0]+=r)}))}(this.vertices,function(t,e){const i=(0,l.Vp)(t);return e===c.RT.Global&&i?{supported:!0,lowerBoundX:i.valid[0],upperBoundX:i.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}(this._spatialReference,this._viewingMode))}updateVertexIndex(t,e){if(0===this.vertices.length)return;const i=this.vertices[0];let n=null,r=t,s=e;do{n=r,n.index=s++,r=n.rightEdge?n.rightEdge.rightVertex:null}while(null!=r&&r!==i);n.leftEdge&&n!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(n),this.vertices.length-1)}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return this.vertices.length>2&&null!==this.vertices[0].leftEdge}swapVertices(t,e){const i=this.vertices[t];this.vertices[t]=this.vertices[e],this.vertices[e]=i}iterateVertices(t){if(0===this.vertices.length)return;const e=this.vertices[0];let i=e;do{t(i,i.index),i=null!=i.rightEdge?i.rightEdge.rightVertex:null}while(i!==e&&null!=i)}}class p extends s.A{constructor(t,e){super(),this.type=t,this.coordinateHelper=e,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon();break;case"mesh":break;default:(0,r.Xb)(this.type)}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}get allVertices(){return Array.from(this.iterateVertices())}*iterateVertices(){for(const t of this.components)for(const e of t.vertices)yield e}notifyChanges(t){this._dirty=!0,this.emit("change",t)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const t=[],e=this.coordinateHelper.vectorToArray;for(const i of this.components){if(i.vertices.length<1)continue;const n=[];let r=i.vertices.find((t=>null==t.leftEdge));const s=r;do{n.push(e(r.pos)),r=r.rightEdge?r.rightEdge.rightVertex:null}while(r&&r!==s);t.push(n)}return new a.A({paths:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const t=[],e=this.coordinateHelper.vectorToArray;for(const i of this.components){if(i.vertices.length<1)continue;const n=[],r=i.vertices[0];let s=r;const o=s;do{n.push(e(s.pos)),s=null!=s.rightEdge?s.rightEdge.rightVertex:null}while(s&&s!==o);i.isClosed()&&n.push(e(r.pos)),t.push(n)}return new o.A({rings:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(t,e){const i=t.spatialReference,r=(0,h.BV)(t.hasZ,t.hasM,i),s=new p(t.type,r);switch(t.type){case"polygon":!function(t,e,i){const r=e.spatialReference,s=t.coordinateHelper,o=e.rings;for(let e=0;e<o.length;++e){const a=o[e],h=new f(r,i);h.index=e;const l=a.length>2&&(0,n.aI)(a[0],a[a.length-1]),c=l?a.length-1:a.length;for(let t=0;t<c;++t){const e=s.arrayToVector(a[t]),i=new u(h);h.vertices.push(i),i.pos=e,i.index=t}const p=h.vertices.length-1;for(let t=0;t<p;++t){const e=h.vertices[t],i=h.vertices[t+1],n=new d(h,e,i);h.edges.push(n)}if(l){const t=new d(h,h.vertices[h.vertices.length-1],h.vertices[0]);h.edges.push(t)}t.components.push(h)}}(s,t,e);break;case"polyline":!function(t,e,i){const n=e.spatialReference,r=t.coordinateHelper,s=e.paths;for(let e=0;e<s.length;++e){const o=s[e],a=new f(n,i);a.index=e;const h=o.length;for(let t=0;t<h;++t){const e=r.arrayToVector(o[t]),i=new u(a);a.vertices.push(i),i.pos=e,i.index=t}const l=a.vertices.length-1;for(let t=0;t<l;++t){const e=a.vertices[t],i=a.vertices[t+1],n=new d(a,e,i);a.edges.push(n)}t.components.push(a)}}(s,t,e);break;case"point":g(s,t,e);break;case"mesh":g(s,t.origin,e),s._geometry=t,s._dirty=!1}return s}}function g(t,e,i){const n=e.spatialReference,r=t.coordinateHelper,s=new f(n,i);s.index=0;const o=new u(s);o.index=0,o.pos=r.pointToVector(e),s.vertices.push(o),t.components.push(s)}function v(t){return"mesh"===t.type}},7819:function(t,e,i){"use strict";i.d(e,{p:function(){return M}});var n=i(48996),r=i(61226),s=i(32501),o=i(38441),a=i(2623),h=i(34358);class l{constructor(t,e,i){this._editGeometry=t,this._component=e,this._pos=i,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let t="redo";null==this._addedVertex&&(t="apply",this._addedVertex=new a.Li(this._component));const e=this._component.getLastVertex();if(null==e)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let t=null;e.rightEdge&&(this._originalEdge=e.rightEdge,t=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,null==this._left&&(this._left=new a.oH(this._component,e,this._addedVertex)),this._component.edges.push(this._left),e.rightEdge=this._left,null!=this._originalEdge&&null!=t&&(null==this._right&&(this._right=new a.oH(this._component,this._addedVertex,t)),this._component.edges.push(this._right),t.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,e.index+1)}this._editGeometry.notifyChanges({operation:t,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}var c=i(57665);class u{constructor(t,e,i=0){this._editGeometry=t,this._vertices=e,this._minNumberOfVertices=i,this.removedVertices=null}apply(){let t="redo";if(null==this.removedVertices){const e=this.removedVertices=[];this._vertices.forEach((t=>{const i=this._removeVertex(t);null!=i&&e.push(i)})),t="apply"}else this.removedVertices.forEach((t=>{this._removeVertex(t.removedVertex)}));this._editGeometry.notifyChanges({operation:t,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach((t=>{this._undoRemoveVertex(t)})),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(t){const e=t.component;if(e.vertices.length<=this._minNumberOfVertices)return null;const i={removedVertex:t,createdEdge:null},n=t.leftEdge,r=t.rightEdge;return e.vertices.splice(e.vertices.indexOf(t),1),n&&(e.edges.splice(e.edges.indexOf(n),1),n.leftVertex.rightEdge=null),r&&(e.edges.splice(e.edges.indexOf(r),1),r.rightVertex.leftEdge=null),0===t.index&&r&&this._vertices.length>0&&e.swapVertices(e.vertices.indexOf(r.rightVertex),0),n&&r&&(i.createdEdge=new a.oH(e,n.leftVertex,r.rightVertex),e.edges.push(i.createdEdge)),r&&e.updateVertexIndex(r.rightVertex,r.rightVertex.index-1),i}_undoRemoveVertex(t){const e=t.removedVertex,i=t.removedVertex.component,n=e.leftEdge,r=e.rightEdge;t.createdEdge&&i.edges.splice(i.edges.indexOf(t.createdEdge),1),i.vertices.push(e),n&&(i.edges.push(n),n.leftVertex.rightEdge=n),r&&(i.edges.push(r),r.rightVertex.leftEdge=r),i.updateVertexIndex(e,e.index)}}class d{constructor(t,e,i){this._editGeometry=t,this._edge=e,this._t=i,this.createdVertex=null,this._left=null,this._right=null}apply(){let t="redo";const e=this._edge,i=e.component,n=e.leftVertex,r=e.rightVertex;i.edges.splice(i.edges.indexOf(e),1),null==this.createdVertex&&(t="apply",this.createdVertex=new a.Li(e.component)),i.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(e.leftVertex.pos,e.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),null==this._left&&(this._left=new a.oH(i,n,this.createdVertex)),this._left.leftVertex.leftEdge?i.edges.push(this._left):i.edges.unshift(this._left),n.rightEdge=this._left,null==this._right&&(this._right=new a.oH(i,this.createdVertex,r)),i.edges.push(this._right),r.leftEdge=this._right,i.updateVertexIndex(this.createdVertex,n.index+1),this._editGeometry.notifyChanges({operation:t,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const t=this._edge,e=t.component,i=this.createdVertex.leftEdge,n=this.createdVertex.rightEdge,r=i?.leftVertex,s=n?.rightVertex;e.vertices.splice(e.vertices.indexOf(this.createdVertex),1),e.edges.splice(e.edges.indexOf(this._left),1),e.edges.splice(e.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?e.edges.push(this._edge):e.edges.unshift(this._edge),r&&(r.rightEdge=t),s&&(s.leftEdge=t),r&&e.updateVertexIndex(r,r.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class f{constructor(t,e,i){this._editGeometry=t,this._vertex=e,this._pos=i}apply(){const t=null==this._originalPosition;t&&(this._originalPosition=this._vertex.pos),this._apply(t?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition,this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(t){return t instanceof f&&t._vertex===this._vertex&&(this._pos=t._pos,this._apply("apply"),!0)}_apply(t){this._vertex.pos=this._pos,this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:t,updatedVertices:[this._vertex]})}}var p=i(50659);class g{constructor(t,e){this._editGeometry=t,this._component=e,this._createdEdge=null}apply(){let t="redo";if(null==this._createdEdge){t="apply";const e=this._component.getFirstVertex(),i=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||null==e||null==i)return;this._createdEdge=new a.oH(this._component,i,e)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:t})}undo(){null!=this._createdEdge&&((0,p.TF)(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}class v{constructor(t,e,i,n){this._editGeometry=t,this.dx=e,this.dy=i,this.dz=n,this._firstTime=!0}apply(){const t=this._firstTime?"apply":"redo";this._firstTime=!1,this._apply(t,this.dx,this.dy,this.dz)}undo(){this._apply("undo",-this.dx,-this.dy,-this.dz)}accumulate(t){const e=this._editGeometry.geometry;return t instanceof v&&t._editGeometry.geometry===e&&(this._apply("apply",t.dx,t.dy,t.dz),this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz,!0)}_apply(t,e,i,n){const r=this._editGeometry.geometry;r.offset(e,i,n);const s=this._editGeometry.components[0].getFirstVertex();if(!s)return;const o=this._editGeometry.coordinateHelper;s.pos=o.pointToVector(r.origin),this._editGeometry.notifyChanges({operation:t,updatedVertices:[s]})}}var m,y=i(28080),_=i(63447),b=i(31966),w=i(76835);class x{constructor(t,e){this._editGeometry=t,this._newPositions=e}apply(){const t=null==this._originalPositions?"apply":"redo";if(!this._originalPositions){const t=this._editGeometry.coordinateHelper;this._originalPositions=this._editGeometry.allVertices.map((e=>t.clone(e.pos)))}this._apply(t,this._newPositions)}undo(){this._originalPositions&&this._apply("undo",this._originalPositions)}accumulate(t){return t instanceof x&&(this._newPositions=t._newPositions,this._apply("apply",this._newPositions),!0)}_apply(t,e){const i=this._editGeometry.coordinateHelper,n=this._editGeometry.allVertices;for(let t=0;t<n.length;t++)i.copy(e[t],n[t].pos);this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:t,updatedVertices:n})}}const T=Symbol();class A{constructor(t){this._operations=[],this._closed=!1,this[m]=!0,t&&(this._operations=t,this._closed=!0)}close(){this._closed=!0}apply(){for(const t of this._operations)t.apply()}undo(){for(let t=this._operations.length-1;t>=0;t--)this._operations[t].undo()}accumulate(t){if(this._closed)return!1;const e=this._operations.length?this._operations[this._operations.length-1]:null;return e&&e.accumulate(t)||(this._operations.push(t),t.apply()),!0}}m=T;class M extends n.A{constructor(t,e){super(),this.data=t,this.viewingMode=e,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",(t=>{t.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:t.addedVertices,operation:t.operation}),t.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:t.removedVertices,operation:t.operation}),t.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:t.updatedVertices,operation:t.operation})}))}destroy(){this._listener.remove()}splitEdge(t,e){return this._apply(new d(this.data,t,e))}updateVertices(t,e,i=h.Y.ACCUMULATE_STEPS){return this._apply(new c.D(this.data,t,e),i)}move(t,e,i,n=h.Y.ACCUMULATE_STEPS){return(0,a.oF)(this.data)?this._apply(new v(this.data,t,e,i),n):this.moveVertices(this.data.allVertices,t,e,i,n)}moveVertices(t,e,i,n,r=h.Y.ACCUMULATE_STEPS){return(0,a.oF)(this.data)?this._apply(new v(this.data,e,i,n),r):this.updateVertices(t,new y.a(this.data.coordinateHelper,e,i,n),r)}scale(t,e,i,n,r=h.Y.ACCUMULATE_STEPS,s=c.K.CUMULATIVE){return this.scaleVertices(this.data.allVertices,t,e,i,n,r,s)}scaleVertices(t,e,i,n,r,s=h.Y.ACCUMULATE_STEPS,o=c.K.CUMULATIVE){return this.updateVertices(t,new w.j(e,i,n,r,o),s)}rotate(t,e,i=h.Y.ACCUMULATE_STEPS,n=c.K.CUMULATIVE){return this.rotateVertices(this.data.allVertices,t,e,i,n)}rotateVertices(t,e,i,n=h.Y.ACCUMULATE_STEPS,r=c.K.CUMULATIVE){return this.updateVertices(t,new b.m(e,i,r),n)}removeVertices(t){return this._apply(new u(this.data,t,this._minNumVerticesPerType))}appendVertex(t){return 0===this.data.components.length?null:this._apply(new l(this.data,this.data.components[0],t))}setVertexPosition(t,e){return this._apply(new f(this.data,t,e))}offsetEdge(t,e,i,n=h.Y.ACCUMULATE_STEPS){return this.updateVertices([e.leftVertex,e.rightVertex],new _.L(this.data.coordinateHelper,t,e,i),n)}trySetGeometry(t,e=h.Y.ACCUMULATE_STEPS){const{data:i}=this,{coordinateHelper:n}=i;if(i.type!==t.type||!i.spatialReference.equals(t.spatialReference)||n.hasZ()!==t.hasZ||n.hasM()!==t.hasM||!(0,o.It)(i.geometry,t)||(0,a.oF)(i))return;const r=Array.from(a.ZE.fromGeometry(t,this.viewingMode).iterateVertices(),(t=>t.pos));return this.setVertexPositions(r,e)}setVertexPositions(t,e=h.Y.ACCUMULATE_STEPS){return this._apply(new x(this.data,t),e)}createResetState(){if((0,a.oF)(this.data))return this._createResetStateMesh();const t=this.data.geometry.clone();return(0,r.hA)((()=>this.trySetGeometry(t)))}closeComponent(t){return this.data.components.includes(t)?this._apply(new g(this.data,t)):null}canRemoveVertex(t){return t.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const t=new A;return this._apply(t),(0,r.hA)((()=>t.close()))}undo(){if(this._undoStack.length>0){const t=this._undoStack.pop();return t.undo(),this._redoStack.push(t),t}return null}redo(){if(this._redoStack.length>0){const t=this._redoStack.pop();return t.apply(),this._undoStack.push(t),t}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(t,e=h.Y.ACCUMULATE_STEPS){return e!==h.Y.NEW_STEP&&null!=this.lastOperation&&this.lastOperation.accumulate(t)||(t.apply(),this._undoStack.push(t),this._redoStack=[]),t}_createResetStateMesh(){if(!(0,a.oF)(this.data))return(0,r.hA)();const t=this.data.geometry,{vertexSpace:e}=t;if(e.origin){const i=(0,s.o8)(e.origin);return(0,r.hA)((()=>{t.vertexSpace.origin=i}))}const i=t.vertexAttributes.clonePositional();return(0,r.hA)((()=>{t.vertexAttributes=i,t.vertexAttributesChanged()}))}static fromGeometry(t,e){return new M(a.ZE.fromGeometry(t,e),e)}}},34358:function(t,e,i){"use strict";var n;i.d(e,{Y:function(){return n}}),function(t){t[t.NEW_STEP=0]="NEW_STEP",t[t.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"}(n||(n={}))},28080:function(t,e,i){"use strict";i.d(e,{a:function(){return n}});class n{constructor(t,e,i,n){this._helper=t,this.dx=e,this.dy=i,this.dz=n}_move(t,e,i,n){this._helper.addDelta(t.pos,e,i,n)}apply(t){this._move(t,this.dx,this.dy,this.dz)}undo(t){this._move(t,-this.dx,-this.dy,-this.dz)}canAccumulate(t){return t instanceof n}accumulate(t,e){this._move(t,e.dx,e.dy,e.dz)}accumulateParams(t){this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz}}},63447:function(t,e,i){"use strict";i.d(e,{B:function(){return p},L:function(){return u}});var n=i(15774),r=i(13786),s=i(1932),o=i(20551),a=i(32501),h=i(5596),l=i(29531),c=i(77363);class u{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(t,e,i,n=0,r=g.IMMEDIATE){this._helper=t,this._planeType=e,this._edge=i,this.distance=n,this._plane=(0,h.vt)(),this._offsetPlane=(0,h.vt)(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,r===g.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){const t=this._toXYZ(this._edge.leftVertex.pos),e=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),i=this._toXYZ(this._edge.rightVertex.pos),n=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=(0,o.o)((0,a.vt)(),t,i),e?(this._left=this._computeNeighbor(t,e,this._edgeDirection),this._right=this._computeNeighbor(i,n,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(i,n,this._edgeDirection),this._left=this._computeNeighbor(t,e,this._edgeDirection,this._right))}_toXYZ(t){return null!=t?this._helper.toXYZ(t):null}_pointToXYZ(t){return this._toXYZ(this._helper.pointToVector(t))}_computeNeighbor(t,e,i,n){const r=(0,a.vt)();if(e){(0,o.o)(r,t,e);const n=!this._passesBisectingAngleThreshold(r,i);return{start:t,end:e,direction:n?this._bisectVectorsPerpendicular(i,r):r,isOriginalDirection:!n}}return this._helper.hasZ()?n&&((0,o.e)(r,i,n.direction),(0,o.e)(r,r,i),(0,o.n)(r,r),Math.sign(r[1])!==Math.sign(i[0])&&(0,o.h)(r,r,-1)):(0,o.i)(r,-i[1],i[0],0),{start:t,end:e,direction:r,isOriginalDirection:!0}}_passesBisectingAngleThreshold(t,e){const i=Math.abs((0,l.g7)(e,t));return i>=d&&i<=Math.PI-d}_bisectVectorsPerpendicular(t,e){const i=(0,o.f)(t,e)<0?t:(0,o.v)((0,a.vt)(),t),n=Math.abs((0,o.f)(i,e));if(!(n<f||n>1-f))return this._bisectDirection(i,e);const r=(0,o.e)((0,a.vt)(),i,[0,0,1]);return(0,o.n)(r,r)}_bisectDirection(t,e){const i=(0,o.g)((0,a.vt)(),t,e);return(0,o.n)(i,i)}_initializePlane(){const t=this._computeNormalDirection(this._left),e=this._computeNormalDirection(this._right);(0,o.f)(t,e)<0&&(0,o.v)(e,e),(0,h.O_)(this._left.start,this._bisectDirection(t,e),this._plane)}_computeNormalDirection(t){const e=(0,o.e)((0,a.vt)(),t.direction,this._edgeDirection);(0,o.n)(e,e);const i=(0,o.e)((0,a.vt)(),this._edgeDirection,e);return this._planeType===p.XY&&(i[2]=0),(0,o.n)(i,i)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint((0,h.mN)(this._plane,this._left.end)),null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint((0,h.mN)(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(t){t<=0&&(this._minDistance=Math.max(this._minDistance,t)),t>=0&&(this._maxDistance=Math.min(this._maxDistance,t))}_updateIntersectDistanceConstraint(t){const e=(0,h.Qj)(t),i=this._edgeDirection,n=(0,o.g)((0,a.vt)(),this._left.start,this._left.direction),l=(0,o.g)((0,a.vt)(),this._right.start,this._right.direction),u=this._pointInBasis2D((0,s.vt)(),e,i,this._left.start),d=this._pointInBasis2D((0,s.vt)(),e,i,n),f=this._pointInBasis2D((0,s.vt)(),e,i,this._right.start),p=this._pointInBasis2D((0,s.vt)(),e,i,l),[g]=(0,c.jI)({start:d,end:u,type:c.Vv.LINE},{start:p,end:f,type:c.Vv.LINE});if(!g)return;const v=(0,r.Re)((0,s.vt)(),u,d);(0,r.S8)(v,v);const m=(0,r.Re)((0,s.vt)(),g,d),y=(0,r.Om)(v,m),_=(0,o.g)((0,a.vt)(),n,(0,o.h)((0,a.vt)(),this._left.direction,-y)),b=(0,h.mN)(t,_);this._updateDistanceConstraint(b)}_pointInBasis2D(t,e,i,n){return t[0]=(0,l.gr)(e,n),t[1]=(0,l.gr)(i,n),t}_offset(t,e){Number.isFinite(this._minDistance)&&(e=Math.max(this._minDistance,e)),Number.isFinite(this._maxDistance)&&(e=Math.min(this._maxDistance,e)),(0,h.C)(this._offsetPlane,this._plane),this._offsetPlane[3]-=e;const i=(t,e,i)=>null!=e&&(0,h.U5)(this._offsetPlane,t,(0,o.g)((0,a.vt)(),t,e),i),n=(0,a.vt)();(t===this._edge.leftVertex?i(this._left.start,this._left.direction,n):i(this._right.start,this._right.direction,n))&&this._helper.copy(this._helper.fromXYZ(n,void 0,this._helper.getM(t.pos)),t.pos)}selectArrowFromStartPoint(t){this._selectedArrow=(0,h.Tj)(this.plane,this._pointToXYZ(t))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(t){return(0,h.mN)(this.plane,this._pointToXYZ(t))}clampedStartAndEnd(t){const e=this._helper.toXYZ(this._helper.pointToVector(t)),i=(0,h._I)(this._plane,e,(0,a.vt)()),r=(0,h.mN)(this._plane,e),s=(0,n.qE)(r,this._minDistance,this._maxDistance);return(0,o.m)(e,i,e,s/r),{start:i,end:e}}apply(t){this._offset(t,this.distance)}undo(t){this._offset(t,0)}canAccumulate(t){return t instanceof u&&this._edge.leftVertex.index===t._edge.leftVertex.index&&this._edge.rightVertex.index===t._edge.rightVertex.index&&this._edge.component===t._edge.component&&this._maybeEqualsVec3(this._left.direction,t._left.direction)&&this._maybeEqualsVec3(this._right.direction,t._right.direction)&&(0,o.H)((0,h.Qj)(this._plane),(0,h.Qj)(t._plane))}accumulate(t,e){const i=this._plane[3]-e._plane[3]+e.distance;this._offset(t,i)}accumulateParams(t){const e=t.distance-t._plane[3];this.distance=e+this._plane[3]}clone(){const t=new u(this._helper,this._planeType,this._edge,this.distance,g.DEFERRED);return(0,h.C)(t._plane,this._plane),(0,h.C)(t._offsetPlane,this._offsetPlane),t._maxDistance=this._maxDistance,t._minDistance=this._minDistance,t._left=this._cloneNeighbor(this._left),t._right=this._cloneNeighbor(this._right),t._edgeDirection=(0,o.c)((0,a.vt)(),this._edgeDirection),t}_maybeEqualsVec3(t,e){return null==t&&null==e||null!=t&&null!=e&&(0,o.H)(t,e)}_cloneNeighbor({start:t,end:e,direction:i,isOriginalDirection:n}){return{start:(0,o.c)((0,a.vt)(),t),end:null!=e?(0,o.c)((0,a.vt)(),e):null,direction:(0,o.c)((0,a.vt)(),i),isOriginalDirection:n}}}const d=(0,n.kU)(15),f=.001;var p,g,v;(v=p||(p={}))[v.XYZ=0]="XYZ",v[v.XY=1]="XY",function(t){t[t.IMMEDIATE=0]="IMMEDIATE",t[t.DEFERRED=1]="DEFERRED"}(g||(g={}))},31966:function(t,e,i){"use strict";i.d(e,{m:function(){return o}});var n=i(50659),r=i(13786),s=i(57665);class o{constructor(t,e,i=s.K.CUMULATIVE){this.origin=t,this.angle=e,this._accumulationType=i}_rotate(t,e){(0,r.e$)(t.pos,t.pos,this.origin,e)}apply(t){this._rotate(t,this.angle)}undo(t){this._rotate(t,-this.angle)}canAccumulate(t){return t instanceof o&&(0,n.aI)(this.origin,t.origin)}accumulate(t,e){const i=e._accumulationType===s.K.REPLACE;this._rotate(t,i?e.angle-this.angle:e.angle)}accumulateParams(t){const e=t._accumulationType===s.K.REPLACE;this.angle=e?t.angle:this.angle+t.angle}}},76835:function(t,e,i){"use strict";i.d(e,{j:function(){return a}});var n=i(50659),r=i(1932),s=i(13786),o=i(57665);class a{constructor(t,e,i,n,s=o.K.CUMULATIVE){this.origin=t,this.axis1=e,this.factor1=i,this.factor2=n,this._accumulationType=s,this.axis2=(0,r.fA)(e[1],-e[0])}_scale(t,e,i){(0,s.Vj)(t.pos,t.pos,this.origin,this.axis1,e),(0,s.Vj)(t.pos,t.pos,this.origin,this.axis2,i)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof a&&(0,n.aI)(this.origin,t.origin)&&(0,n.aI)(this.axis1,t.axis1)}accumulate(t,e){e._accumulationType===o.K.REPLACE?this._scale(t,e.factor1/this.factor1,e.factor2/this.factor2):this._scale(t,e.factor1,e.factor2)}accumulateParams(t){const e=t._accumulationType===o.K.REPLACE;this.factor1=e?t.factor1:this.factor1*t.factor1,this.factor2=e?t.factor2:this.factor2*t.factor2}}},57665:function(t,e,i){"use strict";i.d(e,{D:function(){return n},K:function(){return r}});class n{constructor(t,e,i){this._editGeometry=t,this._vertices=e,this.operation=i,this._undone=!1}apply(){this._vertices.forEach((t=>this.operation.apply(t))),this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach((t=>this.operation.undo(t))),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices}),this._undone=!0}canAccumulate(t){if(this._undone||t._vertices.length!==this._vertices.length)return!1;for(let e=0;e<t._vertices.length;++e)if(t._vertices[e]!==this._vertices[e])return!1;return this.operation.canAccumulate(t.operation)}accumulate(t){return!!(t instanceof n&&this.canAccumulate(t))&&(this._vertices.forEach((e=>this.operation.accumulate(e,t.operation))),this.operation.accumulateParams(t.operation),this._editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0)}}var r;!function(t){t[t.CUMULATIVE=0]="CUMULATIVE",t[t.REPLACE=1]="REPLACE"}(r||(r={}))},41857:function(t,e,i){"use strict";i.d(e,{Bb:function(){return d},G3:function(){return g},fJ:function(){return f}});var n=i(13786),r=i(20551),s=i(32501),o=i(2075),a=i(50973),h=i(28080),l=i(31966),c=i(76835),u=i(57665);function d(t,e){return p(t,e,!1)}function f(t,e){return p(t,e,!0)}function p(t,e,i){if(t instanceof u.D){if(t.operation instanceof h.a)return function(t,e,i=!1){const n=i?-1:1,a=(0,s.fA)(n*t.dx,n*t.dy,n*t.dz);(0,r.g)(e.origin,e.origin,a),(0,o.u)(e)}(t.operation,e,i),!0;if(t.operation instanceof l.m)return function(t,e,i=!1){const n=i?-t.angle:t.angle;(0,r.K)(e.basis1,e.basis1,s.uY,n),(0,r.K)(e.basis2,e.basis2,s.uY,n),(0,o.u)(e)}(t.operation,e,i),!0;if(t.operation instanceof c.j)return function(t,e,i=!1){const s=i?1/t.factor1:t.factor1,a=i?1/t.factor2:t.factor2;(0,r.h)(e.basis1,e.basis1,s),(0,r.h)(e.basis2,e.basis2,a),(0,n.Vj)(e.origin,e.origin,t.origin,t.axis1,s),(0,n.Vj)(e.origin,e.origin,t.origin,t.axis2,a),(0,o.u)(e)}(t.operation,e,i),!0}return!1}function g(t,e,i,r){r||(r=(0,o.a)());const s=(0,n.hZ)(a.oG.get(),t[1],-t[0]),h=(0,n.hZ)(a.oG.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=(0,n.hZ)(a.oG.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),c=a.oG.get();e.components.forEach((e=>e.vertices.forEach((({pos:e})=>{(0,n.hZ)(c,(0,n.Om)(t,e),(0,n.Om)(s,e)),(0,n.jk)(h,h,c),(0,n.T9)(l,l,c)}))));const u=1e-6,d=(0,n.hZ)(a.oG.get(),l[0]-h[0]<u?i/2:0,l[1]-h[1]<u?i/2:0);return(0,n.Re)(h,h,d),(0,n.WQ)(l,l,d),(0,n.hs)(r.basis1,t,(l[0]-h[0])/2),(0,n.hs)(r.basis2,s,(l[1]-h[1])/2),(0,n.hZ)(r.origin,h[0]*t[0]+h[1]*s[0],h[0]*t[1]+h[1]*s[1]),(0,n.WQ)(r.origin,r.origin,r.basis1),(0,n.WQ)(r.origin,r.origin,r.basis2),(0,o.u)(r),r}},53551:function(t,e,i){"use strict";var n,r,s;i.d(e,{PK:function(){return n},SJ:function(){return s},p7:function(){return r}}),function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"}(n||(n={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(r||(r={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(s||(s={}))},7768:function(t,e,i){"use strict";i.d(e,{cx:function(){return _},dz:function(){return x},hj:function(){return p},lJ:function(){return b},tC:function(){return T}}),i(50917);var n=i(56275),r=i(62938),s=i(20551),o=i(68734),a=i(57862),h=i(46460),l=i(68945),c=i(92100),u=i(28397),d=i(99675),f=i(57165);function p(t,e,i,n,r,s){let h="geodesic",l=(0,a.Xn)(i);const c=(0,u.Hh)();return(0,u.vf)(t,e,n,c),c[2]=0,l&&(0,o.F)(c,i,c,l)||(h="euclidean",l=i),{mode:h,view:e,elevationInfo:n,hasZ:r,directionMode:s,spatialReference:t.spatialReference,measurementSR:l,origin:c}}function g(t,e,i){if(null==e||null==t)return;const s=(0,r._H)(i.measurementSR);if(null==s)return;const o=x(t,i);if(null==o)return;const a=(0,n.l3)(e,s);return new c.ej(o,a)}function v(t,e,i,r){if(null==i||null==t)return;const s=x(t,r);if(null==s)return;const o=(0,d.hF)(i),a=t=>{if(null==t)return;const e=(0,u.Hh)(),i=(0,n.Wq)(t,"degrees","geographic");return(0,d.rT)(e,s,r.measurementSR,10,i,r.mode)?new c.FX(s,e):void 0},h=()=>{if(null!=e&&null!=t)return(0,d.hF)((0,d.$h)(e,t))};switch(r.directionMode){case d.rZ.Absolute:return a(o);case d.rZ.Relative:{const t=h();if(null==t)return;return a(t+o)}case d.rZ.RelativeBilateral:{const t=h();if(null==t)return;return(0,c.xW)([a(t+o),a(t-o)])}}}function m(t,e){const i=A(t,e);return null!=i?new c.qR(i):void 0}function y(t,e,i){const{context:r,longitude:s,latitude:a,direction:h,distance:l,elevation:f}=i;if(null!=s||null!=a||null!=l||null!=f||null!=h){if(null!=s||null!=a){const t=(0,d.hF)(s),e=(0,d.hF)(a),i=A(f,r);return new c.QT(t,e,i)}return function(t,e,{context:i,direction:r,distance:s,elevation:a}){if(null==e)return m(a,i);const{view:h,elevationInfo:l,measurementSR:f}=i,p=(0,u.vf)(e,h,l);if(!f||!(0,o.F)(p,e.spatialReference,M,f))return;const[g,v]=M,y=null!=s?(0,n.l3)(s,"meters"):void 0,_=(0,d.hF)(r),b=A(a,i),w=t=>{const e=new c.jf([g,v],f,y,b,t);return null==y||null==t||null==b&&i.hasZ?e:new c.i7(e.closestTo(p))};if(null==_)return w(void 0);const x=()=>{if(null!=t&&null!=e)return(0,d.hF)((0,d.$h)(t,e))};switch(i.directionMode){case d.rZ.Absolute:return w(_);case d.rZ.Relative:{const t=x();if(null==t)return;return w(t+_)}case d.rZ.RelativeBilateral:{const t=x();if(null==t)return;return(0,c.xW)([w(t+_),w(t-_)])}}}(t,e,i)}}function _(t){return"geodesic"===t.context.mode?y(null,null,t):w(t)}function b(t,e,i){const{context:n,x:r,y:s,distance:o,direction:a,elevation:h}=i;return"geodesic"===n.mode?y(e,t,i):null!=r||null!=s?w(i):function(t){let e;for(const i of t)i&&(e=e?.intersect(i)??i);return e}([g(t,o,n),v(t,e,a,n),m(h,n)])}function w({x:t,y:e,elevation:i,context:n}){C.x=t?.value??0,C.y=e?.value??0,C.spatialReference=n.spatialReference;const r=x(C,n,S);return new c.QT(null!=t&&null!=r?r[0]:void 0,null!=e&&null!=r?r[1]:void 0,A(i,n))}function x(t,e,i=(0,u.Hh)()){const{view:n,elevationInfo:r,measurementSR:a,origin:h,mode:l}=e;if((0,u.vf)(t,n,r,i),(0,o.F)(i,t.spatialReference,i,a))return"geodesic"!==l&&(0,s.d)(i,i,h),i}function T(t,e,i,n){const{view:r,measurementSR:a,spatialReference:h,origin:l,mode:c}=i;if("geodesic"===c?(0,s.c)(E,t):(0,s.g)(E,t,l),(0,o.F)(E,a,E,h))return(0,u.xF)(E,r,e,i,n)}function A(t,e){return function(t,{view:e,origin:i,elevationInfo:s,hasZ:o,measurementSR:a}){if(null==t||!o)return;const h=(0,r.mq)(a);if(null==h)return;const[c,u]=i,d=(0,n.l3)(t,h),f="3d"===e?.type?(0,l.Fo)(e,c,u,d,a,s):d;return null!=f?(0,n.d_)(f,h):void 0}(t,e)?.value??void 0}const M=(0,u.Hh)(),S=(0,u.Hh)(),E=(0,u.Hh)(),C=(0,h.T)(0,0,0,f.A.WGS84)},58144:function(t,e,i){"use strict";i.d(e,{e:function(){return n}});class n{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.drawConstraints=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.feature=t.feature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ,this.drawConstraints=t.drawConstraints}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}},45908:function(t,e,i){"use strict";i.d(e,{L:function(){return d}});var n=i(95929),r=i(60539),s=i(28181),o=i(42413),a=i(45328),h=i(68945),l=i(2831),c=i(58144),u=i(48961);function d({predicate:t=()=>!0,snappingManager:e,snappingContext:i,updatingHandles:a,useZ:d=!0}){const m=new l.rh;if(null==e)return{snappingStep:[v,m],cancelSnapping:v};let y,_=null,b=null,w=null;const x=()=>{_=(0,n.DC)(_),e.doneSnapping(),b?.frameTask.remove(),b=null,y=(0,n.xt)(y),w=null},T=(A=e,M=d,S=m,(0,r.sg)((async({frameTask:t,point:e,scenePoint:i,context:n,event:r,delta:s,getLastState:a},h)=>{const l=await t.schedule((()=>A.snap({point:e,scenePoint:i,context:n,signal:h})),h);if(l.valid){let i=await t.schedule((()=>l.apply()),h);const c=a();null!=c.point&&e!==c.point&&(i=A.update({point:c.point,scenePoint:c.scenePoint,context:n})),null!=c.updatePoint&&(0,o.CI)(i,c.updatePoint)||(g(r.mapEnd,i,s,M),S.execute(r))}})));var A,M,S;let E=null,C=null,O=null;return{snappingStep:[n=>{if(!t(n))return n;const{action:o}=n;if("start"===o){const{info:t}=n,r=function(t){return"3d"===t.type?t.resourceController.scheduler.registerTask(u.W6.SNAPPING):u.nu}(e.view);if(b=function(t,e,i){return{context:new c.e({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:null!=e.info?e.info.handle:null,excludeFeature:t.excludeFeature,feature:t.feature,visualizer:t.visualizer}),originalPos:null!=e.snapOrigin?t.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:null!=e.scenePoints?e.scenePoints.sceneStart:null,frameTask:i}}(i,n,r),b.context.selfSnappingZ=null,!d&&null!=t){const e=function(t,e){if(!t.hasZ())return null;const i=e.vertices;let n=null;for(const e of i){const i=t.getZ(e.pos);if(null!=n&&null!=i&&Math.abs(i-n)>1e-6)return null;null==n&&(n=i)}return n}(i.coordinateHelper,t.handle.component);null!=e&&(b.context.selfSnappingZ={value:e,elevationInfo:i.elevationInfo??h.qt})}}if(null!=b){const{context:t,originalScenePos:i,originalPos:h}=b,{mapEnd:l,mapStart:c,scenePoints:u}=n,v=f(h,p(l,c)),m=p(c,h),x={...n,action:"update"},A=b.context,M=function(t,e){return null==t||null==e?null:f(t,p(e.sceneEnd,e.sceneStart))}(i,u),S=e.update({point:v,scenePoint:M,context:t});if(O=S,g(l,S,m,d),E=v,C=M,"end"!==o){const{frameTask:t}=b;null==_&&(_=new AbortController),w=e=>{a.addPromise((0,r.QZ)(T({frameTask:t,event:x,context:A,point:v,scenePoint:M,delta:m,getLastState:()=>({point:E,scenePoint:C,updatePoint:e.forceUpdate?null:O})},_.signal)))},w({forceUpdate:!1}),null==y&&(y=(0,s.watch)((()=>e.options.effectiveEnabled),(()=>w?.({forceUpdate:!0}))))}}return"end"===o&&x(),n},m],cancelSnapping:t=>(x(),t)}}function f(t,[e,i,n]){const r=(0,a.EL)(t);return r.x+=e,r.y+=i,r.hasZ&&(r.z+=n),r}function p(t,e){const i=t.hasZ&&e.hasZ?t.z-e.z:0;return[t.x-e.x,t.y-e.y,i]}function g(t,e,[i,n,r],s){t.x=e.x+i,t.y=e.y+n,s&&t.hasZ&&e.hasZ&&(t.z=e.z+r)}function v(t){return t}},21858:function(t,e,i){"use strict";i.d(e,{b:function(){return l}});var n=i(61226),r=i(97441),s=i(64330),o=i(92535),a=i(96942),h=i(98245);class l{draw(t,e){const i=function(t){const e=[];for(const i of t){let t=!0;for(const n of e)if(i.equals(n)){t=!1;break}t&&e.push(i)}return e}(t),l=this.sortUniqueHints(i),c=[];for(const t of l)t instanceof r.v&&c.push(this.visualizeIntersectionPoint(t,e)),t instanceof s.c&&c.push(this.visualizeLine(t,e)),t instanceof o.r&&c.push(this.visualizeParallelSign(t,e)),t instanceof h.l&&c.push(this.visualizeRightAngleQuad(t,e)),t instanceof a._&&c.push(this.visualizePoint(t,e));return(0,n.vE)(c)}sortUniqueHints(t){return t}}},96942:function(t,e,i){"use strict";i.d(e,{_:function(){return s}});var n=i(20551),r=i(94612);class s extends r.m{constructor(t,e,i){super(e,i),this.point=t}equals(t){return t instanceof s&&(0,n.p)(this.point,t.point)}}},17921:function(t,e,i){"use strict";i.d(e,{T:function(){return r}});var n=i(13520);function r(t){let e=0,i=0,r=0;return t?("cim"===t.type&&t.data.symbol&&"symbolLayers"in t.data.symbol&&t.data.symbol.symbolLayers&&t.data.symbol.symbolLayers.map((t=>{"CIMVectorMarker"===t.type&&t.anchorPoint&&(Math.abs(t.anchorPoint.x)>e&&(e=t.anchorPoint.x),Math.abs(t.anchorPoint.y)>i&&(i=t.anchorPoint.y),null!=t.size&&t.size>r&&(r=t.size))})),e=(0,n.Lz)(e),i=(0,n.Lz)(i),r=(0,n.Lz)(r),{offsetX:e,offsetY:i,size:r}):{offsetX:e,offsetY:i,size:r}}},87265:function(t,e,i){"use strict";i.d(e,{Am:function(){return S},Gk:function(){return m},Ku:function(){return b},S3:function(){return x},fL:function(){return C},em:function(){return E},LJ:function(){return T},Y3:function(){return w},dy:function(){return M},qP:function(){return A},fr:function(){return _},Hw:function(){return O},uf:function(){return R}});var n=i(56275),r=i(49634),s=i(53804),o=i(83525),a=i(66110),h=i(23502),l=(i(58941),i(40633),i(13798),i(65953));let c=class extends o.A{constructor(t){super(t),this.actual=null,this.lockable=!0,this.id=(0,a.lk)(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(t){this.lockable&&this._set("committed",t)}get dirty(){return null!=this.inputValue}get locked(){return this.lockable&&null!=this.committed}onInput(t){this.inputValue=t}onCommit(t,e,i){this.lockable?this._onCommitLockable(t,i):this._onCommitNonLockable(i),this.invalid&&"commit-and-exit"===t||i.onCommit(e,t)}_onCommitLockable(t,e){const{inputValue:i,locked:n}=this;n&&u(i)?this.unlock():("commit-and-exit"===t&&!n||null!=i)&&this._parseInputAndLock(e)}_onCommitNonLockable(t){const{inputValue:e}=this;u(e)?this.setActual(null):null!=e&&this._parseInputAndSetActual(t)}applyValue(t){this.lockable?this.lock(t):this.setActual(t)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(t){this.actual=t,this.clearInputValue()}lock(t){this.lockable&&(this.committed=t??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(t){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(t))}getSuffix(t){const{suffix:e}=this;return"function"==typeof e?e(t):e}getFormattedValue(t){const{actual:e,committed:i,format:n}=this;return null!=i?n(i,t):null!=e?n(e,t):null}getRawDisplayValue(t){const{actual:e,committed:i,inputValue:n}=this;return null!=n?n:this.lockable&&null!=i?this.formatForInputMode(i,t):null!=e?this.formatForInputMode(e,t):null}_parseInputAndSetActual(t){const{inputValue:e}=this;if(null==e||u(e))return this.setActual(null);const i=this.parse(e,t);null!=i?this.setActual(i):this.invalid=!0}_parseInputAndLock(t){const{inputValue:e,actual:i}=this;if(u(e))return this.unlock();if(null==e)return this.lock(i);const n=this.parse(e,t);null!=n?this.lock(n):this.invalid=!0}};function u(t){return null!=t&&""===t.trim()}(0,s._)([(0,h.MZ)()],c.prototype,"actual",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"committed",null),(0,s._)([(0,h.MZ)()],c.prototype,"dirty",null),(0,s._)([(0,h.MZ)()],c.prototype,"format",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"formatForInputMode",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"lockable",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"locked",null),(0,s._)([(0,h.MZ)()],c.prototype,"id",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"inputValue",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"name",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"parse",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"readOnly",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"suffix",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"title",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"visible",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"invalid",void 0),(0,s._)([(0,h.MZ)()],c.prototype,"unlockOnVertexPlacement",void 0),c=(0,s._)([(0,l.$)("esri.views.interactive.tooltip.fields.TooltipField")],c);let d=class extends c{constructor(t){super(t),this.showAsZ=!1}normalizeCtorArgs(t){const e=t=>t.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:n.r7,parse:(0,r.hw)({createQuantity:(t,i)=>(0,n.d_)(t,e(i))}),format:(t,e)=>e.formatters.verticalLength(t),formatForInputMode:(t,i)=>i.formatters.scalar((0,n.kM)(t,e(i))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...t}}};(0,s._)([(0,h.MZ)()],d.prototype,"showAsZ",void 0),d=(0,s._)([(0,l.$)("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],d);var f=i(88226),p=i(99675);let g=class extends c{constructor(t){super(t),this.precision=1}normalizeCtorArgs(t){return{name:"orientation",actual:null,parse:(0,r.hw)({createQuantity:(t,e)=>(0,n.Wq)(t,(t=>t.inputUnitInfos.angle.unit)(e),"geographic"),sanitize:r.D5}),format:t=>{const e=(0,p.P1)(t);return(0,f.Nk)(e,"geographic",this.precision)},formatForInputMode:(t,e)=>{const i=(0,p.P1)(t);return e.formatters.scalar(i)},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.orientation,...t}}};(0,s._)([(0,h.MZ)()],g.prototype,"precision",void 0),g=(0,s._)([(0,l.$)("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],g);let v=class extends c{constructor(t){super(t),this.precision=null}normalizeCtorArgs(t){const e=t=>t.inputUnitInfos.length.unit;return{name:"size",actual:null,parse:(0,r.hw)({createQuantity:(t,i)=>(0,n.d_)(t,e(i))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,i)=>i.formatters.scalar((0,n.kM)(t,e(i))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.size,...t}}};function m(t){const e=t=>t.inputUnitInfos.angle.unit,i=t=>t.sketchOptions.values.effectiveDirectionMode;return new c({name:"direction",actual:n.IV,parse:(0,r.hw)({createQuantity:(t,i)=>(0,n.Wq)(t,e(i),"geographic"),sanitize:r.D5}),format:(t,e)=>{const n=i(e),r=(0,p.jQ)(t,n);switch(n){case p.rZ.Absolute:return e.formatters.direction(r);case p.rZ.Relative:return e.formatters.directionRelative(r);case p.rZ.RelativeBilateral:return e.formatters.directionRelativeBilateral(r)}},formatForInputMode:(t,r)=>{const s=(0,p.jQ)(t,i(r));return r.formatters.scalar((0,n.kM)(s,e(r)))},suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>{const e=i(t),{absolute:n,relative:r}=t.messages.sketch.direction;switch(e){case p.rZ.Absolute:return n;case p.rZ.Relative:case p.rZ.RelativeBilateral:return r}},...t})}function y(t){const e=t=>t.inputUnitInfos.length.unit;return new c({name:"distance",actual:n.r7,parse:(0,r.hw)({createQuantity:(t,i)=>(0,n.d_)(Math.max(t,0),e(i))}),format:(t,e)=>e.formatters.length(t),formatForInputMode:(t,i)=>i.formatters.scalar((0,n.kM)(t,e(i))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...t})}function _(t){return y({format:(t,e)=>e.formatters.totalLength(t),title:t=>t.messages.sketch.totalLength,readOnly:!0,...t})}function b(t){return y({...t})}function w(t){return y({...t,parse:(0,r.hw)({createQuantity:(t,e)=>(0,n.d_)(t,(t=>t.inputUnitInfos.length.unit)(e))}),format:(t,e)=>e.formatters.lengthRelative(t)})}function x(t){return new d(t)}function T(t){return new g(t)}function A(t){return new v(t)}function M(t){return I("scale",{name:"scale",actual:null,parse:(0,r.hw)({createQuantity:t=>(0,n.LF)(Math.abs(t))}),...t})}function S(t){const e=t=>t.inputUnitInfos.area.unit;return new c({name:"area",actual:n.iT,parse:(0,r.hw)({createQuantity:(t,i)=>(0,n.gT)(t,e(i))}),format:(t,e)=>e.formatters.area(t),formatForInputMode:(t,i)=>i.formatters.scalar((0,n.kM)(t,e(i))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...t})}function E(t){return new c({name:"x",actual:n.IV,parse:r.L5,format:(t,e)=>e.formatters.longitudeDecimalDegrees(t),formatForInputMode:t=>(0,r.zX)(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.longitude,...t})}function C(t){return new c({name:"y",actual:n.IV,parse:r.A3,format:(t,e)=>e.formatters.latitudeDecimalDegrees(t),formatForInputMode:t=>(0,r.oZ)(t),suffix:t=>t.inputUnitInfos.angle.abbreviation,title:t=>t.messages.sketch.latitude,...t})}function O(t){return I("x",{name:"x",...t})}function R(t){return I("y",{name:"y",...t})}function I(t,e){return new c({actual:(0,n.LF)(0),parse:(0,r.hw)({createQuantity:t=>(0,n.LF)(t)}),format:(t,e)=>e.formatters.scalar(t),formatForInputMode:(t,e)=>e.formatters.scalar(t),title:e=>e.messages.sketch[t],...e})}(0,s._)([(0,h.MZ)()],v.prototype,"precision",void 0),v=(0,s._)([(0,l.$)("esri.views.interactive.tooltip.fields.TooltipFieldSize")],v)},49634:function(t,e,i){"use strict";i.d(e,{A3:function(){return D},D5:function(){return E},GC:function(){return u},L5:function(){return N},Nr:function(){return R},X3:function(){return P},hw:function(){return S},m6:function(){return L},oZ:function(){return _},zX:function(){return y}});var n=i(16691),r=i(88226),s=i(56275),o=i(6338),a=i(2900),h=i(99675);const l=1,c=6;function u(t,e){return{angleRelative:d,direction:f,directionRelative:p,directionRelativeBilateral:g,latitudeDecimalDegrees:m,longitudeDecimalDegrees:v,area:(i,n)=>(0,r.Jd)(t,i,n??e.area),length:(i,n,s)=>(0,r.ix)(t,i,n??e.length,s),lengthRelative:(i,n)=>(0,r.yh)(t,i,n??e.length),totalLength:(i,n)=>(0,r.ix)(t,i,n??e.length),verticalLength:(i,n)=>(0,r.Oo)(t,i,n??e.verticalLength),verticalLengthRelative:(i,n)=>(0,r.OM)(t,i,n??e.verticalLength),percentage:x,scalar:A,scale:T}}function d(t){return(0,a.ZV)(t,{signDisplay:"exceptZero",...M(l)})}function f(t){return(0,r.Nk)(t,t.rotationType,l)}function p(t){const e=(0,h.hF)(t);return(0,a.ZV)(e,{style:"unit",unitDisplay:"narrow",unit:"degree",signDisplay:e>0?"never":"exceptZero",...M(l)})}function g(t){return(0,r.Nk)(t,t.rotationType,l)}function v(t){return b(t,z)}function m(t){return b(t,j)}function y(t){return w(t,z)}function _(t){return w(t,j)}function b(t,e){return(0,r.Nk)((0,s.kM)(t,"degrees"),"geographic",c,e,!1)}function w(t,e){const i=e.normalize((0,s.kM)(t,"degrees").value,void 0,!1);return A((0,s.LF)(i),c)}function x(t){return(0,a.ZV)(t.value,{style:"percent"})}function T(t){return(0,a.ZV)(t,{style:"percent",maximumFractionDigits:0})}function A(t,e){return(0,a.ZV)(t.value,M(e))}function M(t){return{minimumFractionDigits:t,maximumFractionDigits:t}}function S({createQuantity:t,sanitize:e}){return(i,n)=>{if(null==i)return null;e&&(i=e(i));const r=(0,a.$J)(i);return null==r?null:t(r,n)}}function E(t){return t.replaceAll(/[*^~°º]/g,"")}const C=t=>{let e=`[-+]?[0-9${t.thousands}]+`;return""!==t.decimal&&(e+=`${t.decimal}[0-9]+`),new RegExp(`^(${e}\\s*)${t.separator}(\\s*${e})$`,"i")},O=[];for(const t of[",","\\|","\\s+"])for(const e of["\\.",",",""])for(const i of["",",","\\."," ","\\s+"])t!==e&&t!==i&&e!==i&&O.push({separator:t,decimal:e,thousands:i,pattern:C({decimal:e,thousands:i,separator:t})});function R(t){for(const{decimal:e,thousands:i,pattern:n}of O){n.lastIndex=0;const r=t.match(n);if(!r)continue;const o=(0,a.$J)(I(r[1],e,i)),h=(0,a.$J)(I(r[2],e,i));if(null!=o&&null!=h)return{x:(0,s.LF)(o),y:(0,s.LF)(h)}}return null}function I(t,e,i){let n=t.replaceAll(/[\s+]/g,"");return""!==i&&(n=n.replaceAll(i,"")),""!==e&&(n=n.replaceAll(e,".")),n}function P(t){if(!t||null!=(0,a.$J)(t)||!(0,o.s1)())return null;const e=(0,o.o6)(t),i=L(e?.latitude),n=L(e?.longitude);return null!=n&&null!=i?{latitude:i,longitude:n}:null}function N(t){return L((0,o.mT)(t))}function D(t){return L((0,o.ts)(t))}function L(t){return null!=t?(0,s.Wq)(t,"degrees","geographic"):null}const z=new n.hr(-180,180),j=new n.hr(-90,90)},60403:function(t,e,i){"use strict";i.d(e,{d:function(){return a}});var n=i(53804),r=i(23502),s=(i(58941),i(40633),i(13798),i(65953)),o=i(90858);let a=class extends o.w{constructor(t){super(t),this.type="extent-rotate",this.angle=0}};(0,n._)([(0,r.MZ)()],a.prototype,"type",void 0),(0,n._)([(0,r.MZ)()],a.prototype,"angle",void 0),a=(0,n._)([(0,s.$)("esri.views.interactive.tooltip.infos.ExtentRotateTooltipInfo")],a)},96632:function(t,e,i){"use strict";i.d(e,{c:function(){return h}});var n=i(53804),r=i(56275),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953)),a=i(90858);let h=class extends a.w{constructor(t){super(t),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=r.r7,this.ySize=r.r7}};(0,n._)([(0,s.MZ)()],h.prototype,"type",void 0),(0,n._)([(0,s.MZ)()],h.prototype,"xScale",void 0),(0,n._)([(0,s.MZ)()],h.prototype,"yScale",void 0),(0,n._)([(0,s.MZ)()],h.prototype,"xSize",void 0),(0,n._)([(0,s.MZ)()],h.prototype,"ySize",void 0),h=(0,n._)([(0,o.$)("esri.views.interactive.tooltip.infos.ExtentScaleTooltipInfo")],h)},18945:function(t,e,i){"use strict";i.d(e,{F:function(){return h}});var n=i(53804),r=i(23502),s=(i(58941),i(40633),i(13798),i(65953)),o=i(90858),a=i(73919);let h=class extends((0,a.B)(o.w)){constructor(t){super(t),this.type="move-point",this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation]}};(0,n._)([(0,r.MZ)()],h.prototype,"allFields",null),h=(0,n._)([(0,s.$)("esri.views.interactive.tooltip.infos.MovePointTooltipInfo")],h)},83931:function(t,e,i){"use strict";i.d(e,{d:function(){return l}});var n=i(53804),r=i(23502),s=(i(58941),i(40633),i(13798),i(65953)),o=i(87265),a=i(90858),h=i(73919);let l=class extends((0,h.B)(a.w)){constructor(t){super(t),this.type="selected-vertex",this.area=(0,o.Am)(),this.totalLength=(0,o.fr)(),this.geometryType="polyline",this.allFields.forEach((t=>{t.lockable=!1,t.setActual(null)}))}get allFields(){return[this.longitude,this.latitude,this.x,this.y,this.elevation,"polygon"===this.geometryType?this.area:this.totalLength]}};(0,n._)([(0,r.MZ)()],l.prototype,"geometryType",void 0),(0,n._)([(0,r.MZ)()],l.prototype,"allFields",null),l=(0,n._)([(0,s.$)("esri.views.interactive.tooltip.infos.SelectedVertexTooltipInfo")],l)},90858:function(t,e,i){"use strict";i.d(e,{w:function(){return a}});var n=i(53804),r=i(83525),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953));let a=class extends r.A{constructor(t){super(t),this.helpMessage=void 0,this.viewType=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter((t=>t.visible&&!t.readOnly))}clearInputValues(){this.allFields.forEach((t=>t.clearInputValue()))}};(0,n._)([(0,s.MZ)()],a.prototype,"sketchOptions",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"visibleElements",null),(0,n._)([(0,s.MZ)()],a.prototype,"helpMessage",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"viewType",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"allFields",null),(0,n._)([(0,s.MZ)()],a.prototype,"editableFields",null),a=(0,n._)([(0,o.$)("esri.views.interactive.tooltip.infos.SketchTooltipInfo")],a)},73919:function(t,e,i){"use strict";i.d(e,{B:function(){return u}});var n=i(53804),r=i(56275),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953)),a=i(74471),h=i(87265),l=i(49634),c=i(99368);const u=t=>{let e=class extends t{constructor(){super(...arguments),this.longitude=(0,h.em)(),this.latitude=(0,h.fL)(),this.x=(0,h.Hw)(),this.y=(0,h.uf)(),this.elevation=(0,h.S3)(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,e=t?.spatialReference){if(this.geographic=!!e&&(0,c.yF)(e),null==t)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const e=(0,a.QP)(t,d);this._setActualLonLat((0,l.m6)(e?.[0]),(0,l.m6)(e?.[1]))}else this._setActualXY((0,r.LF)(t.x),(0,r.LF)(t.y))}_setActualLonLat(t,e){this.longitude.actual=t,this.latitude.actual=e}_setActualXY(t,e){this.x.actual=t,this.y.actual=e}};return(0,n._)([(0,s.MZ)()],e.prototype,"geographic",void 0),(0,n._)([(0,s.MZ)()],e.prototype,"effectiveX",null),(0,n._)([(0,s.MZ)()],e.prototype,"effectiveY",null),(0,n._)([(0,s.MZ)()],e.prototype,"key",null),e=(0,n._)([(0,o.$)("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],e),e},d=[0,0]},94492:function(t,e,i){"use strict";i.d(e,{M:function(){return h}});var n=i(53804),r=i(56275),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953)),a=i(90858);let h=class extends a.w{constructor(t){super(t),this.type="translate",this.distance=r.r7}clear(){this.distance=r.r7}};(0,n._)([(0,s.MZ)()],h.prototype,"type",void 0),(0,n._)([(0,s.MZ)()],h.prototype,"distance",void 0),h=(0,n._)([(0,o.$)("esri.views.interactive.tooltip.infos.TranslateTooltipInfo")],h)},24148:function(t,e,i){"use strict";i.d(e,{sZ:function(){return $t},wG:function(){return Ut},mu:function(){return Ft},A:function(){return zt},HA:function(){return Wt},IA:function(){return kt},Ue:function(){return jt}});var n=i(77472),r=i(61226),s=i(15774),o=i(56275),a=i(28181),h=i(62938),l=i(20551),c=i(32501),u=i(6338),d=(i(45532),i(36405)),f=i(67376),p=i(57652),g=i(1644),v=i(37578),m=i(53804),y=i(48996),_=i(40212),b=i(95929),w=i(13520),x=i(23502),T=(i(58941),i(40633),i(13798),i(65953)),A=i(93839);const M="esri-tooltip",S=`${M}-content`,E=`${M}-content--input`,C=`${M}-content__header`,O=`${M}-content__header__spacer`,R=`${M}-content__header__actions`,I=`${M}-draw-header-actions`,P=`${M}-table`,N=`${M}-help-message`,D=`${M}-help-message__text`,L=`${M}-help-message__icon`;i(39819);var z=i(31267),j=i(10362),k=i(49146);const F=`${M}-field`,H={base:F,inputMode:`${F}--input`,title:`${F}__title`,value:`${F}__value`};let B=class extends z.A{constructor(){super(...arguments),this.hidden=!1,this.mode="feedback"}render(){return(0,k.K)("div",{class:this.classes({[H.base]:!0,[H.inputMode]:"input"===this.mode})},(0,k.K)("div",{class:H.title,key:"title"},this.title),(0,k.K)("div",{class:H.value,key:"value"},this.value))}};(0,m._)([(0,x.MZ)()],B.prototype,"hidden",void 0),(0,m._)([(0,x.MZ)()],B.prototype,"mode",void 0),(0,m._)([(0,x.MZ)()],B.prototype,"title",void 0),(0,m._)([(0,x.MZ)()],B.prototype,"value",void 0),B=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.components.TooltipField")],B);const G={base:`${M}-value-by-value`};let V=class extends z.A{constructor(){super(...arguments),this.divider="×"}render(){return(0,k.K)("div",{class:G.base},(0,k.K)("span",null,this.left),(0,k.K)("span",null,this.divider),(0,k.K)("span",null,this.right))}};(0,m._)([(0,x.MZ)()],V.prototype,"left",void 0),(0,m._)([(0,x.MZ)()],V.prototype,"divider",void 0),(0,m._)([(0,x.MZ)()],V.prototype,"right",void 0),V=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.components.ValueByValue")],V);var U=i(84016),$=i(7213),W=i(60539),q=i(74087),Z=i(15999),Y=i(76722),X=i(49634),K=i(28754),J=i(90357);const Q=Symbol("dragHandles");let tt=class extends z.A{constructor(){super(...arguments),this._focusAbortController=new AbortController,this._transitionInfo=null,this._mode="feedback",this._getFormatters=(0,$.B)(X.GC),this._onHeaderPointerDown=t=>{const e=t.target;e instanceof HTMLElement&&"calcite-button"!==e?.tagName?.toLowerCase()&&(this.removeHandles(Q),e.setPointerCapture(t.pointerId),this.tooltip.onDragStart(t.clientX,t.clientY),this.addHandles([(0,_.on)(e,"pointermove",(({clientX:t,clientY:e})=>{this.tooltip.onDrag(t,e)})),(0,_.on)(e,["pointerup","pointercancel"],(i=>{this.removeHandles(Q),e.releasePointerCapture(t.pointerId),this.tooltip.onDragEnd()})),(0,_.on)(e,"touchstart",(t=>t.preventDefault()))],Q))},this._onDiscard=()=>{this.destroyed||(this.tooltip.emit("discard"),this.info.clearInputValues(),this.exitInputMode())},this._onCommit=(t,e)=>{if(this.destroyed)return;if(this.tooltip.emit("commit",{type:e}),"commit-and-exit"===e)return void this.exitInputMode();if("commit-on-blur"===e)return;const i=this._getFocusableElements(),n=i.length,r=i.indexOf(t);if(-1===r)return void this.exitInputMode();const s=((r+("commit-and-next"===e?1:-1))%n+n)%n;et(i.at(s))},this._onKeyDown=t=>{switch(t.code){case v.ac.next:return this._onNextKey(t);case v.ac.discard:return t.stopPropagation(),this._onDiscard()}}}get mode(){return this._mode}get _displayUnits(){const{displayUnits:t}=this.info.sketchOptions.values,e=(0,Y.c)(this.tooltip.view);return{length:t.length??e,verticalLength:t.verticalLength??e,area:t.area??e}}get _inputUnitInfos(){const t=this._messagesUnits,e=e=>({unit:e,abbreviation:(0,Z.Cq)(t,e,"abbr")}),{inputUnits:i}=this.info.sketchOptions.values,n=(0,Y.c)(this.tooltip.view),r=i.length??n,s=i.verticalLength??n,o=i.area??n;return{length:e((0,h.wL)(r)),verticalLength:e((0,h.m5)(s)),area:e((0,h.tW)(o)),angle:e("degrees")}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){const{visibleElements:t}=this.info.sketchOptions.tooltips,e=this._renderedContent,i=this._renderedActions,n=this._renderedHelpMessage,r=e.length>0,s=r||!!n,o="input"===this.mode;return(0,k.K)("div",{class:(0,j.Ly)(S,o&&E),onkeydown:this._onKeyDown,tabIndex:-1},o&&s&&t.header?(0,k.K)("div",{class:C,"data-testid":"tooltip-header",key:"header",onpointerdown:this._onHeaderPointerDown},(0,k.K)("calcite-button",{appearance:"transparent","data-testid":"tooltip-back-button",iconFlipRtl:"both",iconStart:"chevron-left",key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),i.length>0?(0,k.K)(k.w,null,(0,k.K)("div",{class:O,key:"spacer"}),(0,k.K)("div",{class:R,key:"actions"},i)):null):null,r?(0,k.K)("div",{class:P,key:"content"},...e):null,n)}destroy(){this._focusAbortController.abort(),this._transitionInfo?.transition.skipTransition()}_renderActions(){return null}loadDependencies(){return(0,K.W)({button:()=>i.e(2974).then(i.bind(i,45399)),icon:()=>i.e(2525).then(i.bind(i,50855)),input:()=>i.e(2498).then(i.bind(i,21512))})}async enterInputMode(t,e){try{await this._transitionTo("input",e),await this._focusField(t)}catch(t){(0,W.jH)(t)}}async exitInputMode({focusOnView:t=!0}={}){try{const{container:e,info:i}=this;i.clearInputValues();const n=t?e?.closest(".esri-view")?.querySelector(".esri-view-surface"):null;await this._transitionTo("feedback"),n instanceof HTMLElement&&n.focus()}catch(t){(0,W.jH)(t)}}_onNextKey(t){const e=this._getFocusableElements(),i=e.at(0),n=e.at(-1);i&&n&&(t.shiftKey?document.activeElement===i&&(t.preventDefault(),t.stopPropagation(),et(n)):document.activeElement===n&&(t.preventDefault(),t.stopPropagation(),et(i)))}get _renderedContent(){return it(this._renderContent())}get _renderedActions(){return it(this._renderActions())}get _renderedHelpMessage(){const{sketchOptions:t,visibleElements:e}=this.info;if(!e.helpMessage)return null;const i=t.tooltips.helpMessage??this._defaultHelpMessage;if(!i)return null;const n=t.tooltips.helpMessageIcon??"information";return(0,k.K)("div",{class:N,key:"help-message"},n?(0,k.K)("calcite-icon",{class:L,icon:n,scale:"s"}):null,(0,k.K)("div",{class:D},i))}get _defaultHelpMessage(){const{helpMessage:t,viewType:e}=this.info;if(null==t)return null;const i="3d"===e?"helpMessages3d":"helpMessages2d";return this._messagesTooltip?.sketch?.[i]?.[t]}async _focusField(t){this._focusAbortController?.abort(),this._focusAbortController=new AbortController;const{signal:e}=this._focusAbortController;await this._waitForInputs(),(0,W.Te)(e);const i=this._getFocusableInputs(),n=t?i.find((e=>e.getAttribute("data-field-name")===t)):i.at(0);await et(n)}async _transitionTo(t,e){if(this._mode===t&&!this._transitionInfo)return;if(this._transitionInfo?.mode===t)return this._transitionInfo.transition.finished;this._transitionInfo?.transition.skipTransition();const i=async()=>{this.destroyed||(this._mode=t,await(0,q.NO)(),this.destroyed||(this.renderNow(),await(0,q.NO)(),this.destroyed||e?.()))};if(!this.domNode?.firstChild||!document.startViewTransition||(0,U.O)())return void await i();this.autoRenderingEnabled=!1;const n=this._transitionInfo={transition:document.startViewTransition((async()=>{this.destroyed||n!==this._transitionInfo||(this.autoRenderingEnabled=!0,await i())})),mode:t};try{await n.transition.finished}finally{n===this._transitionInfo&&(this._transitionInfo=null)}}async _waitForInputs(){const t=()=>Array.from(this.domNode?.querySelectorAll("calcite-input")??[]);for(;0===t().length;)await(0,W.Pl)(nt);await(0,q.$m)()}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("calcite-input:not([read-only]):not([disabled])")??[])}_getFocusableElements(){const t=this.domNode?.querySelector(`.${I}`);return[...Array.from(t?.querySelectorAll(`.${R} calcite-button:not([disabled])`)??[]),...this._getFocusableInputs()]}};async function et(t){await(t?.setFocus())}function it(t){return(Array.isArray(t)?t:[t]).flat(10).filter((t=>!!t))}(0,m._)([(0,J.G)("esri/core/t9n/Units"),(0,x.MZ)()],tt.prototype,"_messagesUnits",void 0),(0,m._)([(0,J.G)("esri/views/interactive/tooltip/t9n/Tooltip"),(0,x.MZ)()],tt.prototype,"_messagesTooltip",void 0),(0,m._)([(0,x.MZ)()],tt.prototype,"info",void 0),(0,m._)([(0,x.MZ)()],tt.prototype,"tooltip",void 0),(0,m._)([(0,x.MZ)()],tt.prototype,"_mode",void 0),(0,m._)([(0,x.MZ)()],tt.prototype,"mode",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_displayUnits",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_inputUnitInfos",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_formatters",null),(0,m._)([(0,x.MZ)()],tt.prototype,"fieldContext",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_renderedContent",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_renderedActions",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_renderedHelpMessage",null),(0,m._)([(0,x.MZ)()],tt.prototype,"_defaultHelpMessage",null),tt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContent")],tt);const nt=20;let rt=class extends tt{_renderContent(){const{area:t,radius:e,xSize:i,ySize:n,visibleElements:r}=this.info,s=this._messagesTooltip.sketch,o=this._formatters;return(0,k.K)(k.w,null,r.radius&&null!=e?(0,k.K)(B,{title:s.radius,value:o.length(e)}):null,r.size&&null!=i&&null!=n?(0,k.K)(B,{title:s.size,value:(0,k.K)(V,{left:o.length(i),right:o.length(n)})}):null,r.area?(0,k.K)(B,{title:s.area,value:o.area(t)}):null)}};rt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],rt);const st=`${M}-editable-field`,ot={base:st,inputMode:`${st}--input`,feedbackMode:`${st}--feedback`,readOnly:`${st}--read-only`,locked:`${st}--locked`,title:`${st}__title`,value:`${st}__value`,valueContent:`${st}__value__content`,valueContentReadOnly:`${st}__value__content--read-only`,lockIcon:`${st}__lock-icon`,input:`${st}__input`,inputSuffix:`${st}__input-suffix`,button:`${st}__button`},at="lock";let ht=class extends z.A{constructor(){super(...arguments),this._input=null,this._lock=null,this._onLockClick=()=>{this.field.toggleLock(this.context)},this._onLockAfterCreate=t=>{this._lock=t},this._onLockAfterRemoved=()=>{this._lock=null},this._onKeyDown=t=>{t.key===v.ac.discard&&"input"===this.mode&&this._input&&this.context.onDiscard(this._input)},this._onInputKeyDown=t=>{const e=this._input;if(e)switch(t.key){case v.ac.commit:return this.field.onCommit("commit-and-exit",e,this.context);case v.ac.next:{t.preventDefault(),t.stopPropagation();const i=t.shiftKey?"commit-and-previous":"commit-and-next";return this.field.onCommit(i,e,this.context)}}},this._onInput=t=>{this.field.onInput(t.target.value)},this._onInputBlur=t=>{const e=this._input;e&&t.relatedTarget!==this._lock&&this.field.onCommit("commit-on-blur",e,this.context)},this._selectText=()=>{const t=()=>{this._input===document.activeElement&&this._input?.selectText()};t(),(0,q.$m)().then(t)},this._onAfterCreate=t=>{this._input=t,t.addEventListener("paste",this._onPaste),t.addEventListener("beforeinput",this._onBeforeInput)},this._onAfterRemoved=t=>{t.removeEventListener("paste",this._onPaste),t.removeEventListener("beforeinput",this._onBeforeInput)},this._onPaste=t=>{const e=t.clipboardData?.getData("text");e&&null!=this.field.parse(e,this.context)&&(t.stopPropagation(),this.field.onInput(e))},this._onBeforeInput=t=>{("historyUndo"===t.inputType||"historyRedo"===t.inputType)&&!this.field.dirty&&t.preventDefault()}}initialize(){this.addHandles((0,a.watch)((()=>this._rawDisplayValue),(()=>{const{committed:t,inputValue:e}=this.field;t||e||this._input!==document.activeElement||this._selectText()})))}loadDependencies(){return(0,K.W)({button:()=>i.e(2974).then(i.bind(i,45399)),icon:()=>i.e(2525).then(i.bind(i,50855)),input:()=>i.e(2498).then(i.bind(i,21512))})}render(){const{field:t,mode:e}=this,i="input"===e,{locked:n,readOnly:r}=t;return(0,k.K)("div",{class:this.classes({[ot.base]:!0,[ot.feedbackMode]:"feedback"===e,[ot.inputMode]:"input"===e,[ot.locked]:n,[ot.readOnly]:r})},(0,k.K)("div",{class:ot.title,key:"title"},this._title),(0,k.K)("div",{class:ot.value,key:"value",onkeydown:this._onKeyDown},i?this._renderValueInputMode():this._renderValueFeedbackMode()))}get _formattedValue(){return this.field.getFormattedValue(this.context)||lt}get _rawDisplayValue(){return this.field.getRawDisplayValue(this.context)}get _suffix(){return this.field.getSuffix(this.context)}get _title(){const{title:t}=this.field;return"string"==typeof t?t:t(this.context)}_renderValueFeedbackMode(){return(0,k.K)(k.w,null,(0,k.K)("div",{class:ot.valueContent,key:"value-feedback"},this._formattedValue),this.field.locked&&"input"!==this.mode?(0,k.K)("calcite-icon",{class:ot.lockIcon,icon:at,key:"icon",scale:"s"}):null)}_renderValueInputMode(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return(0,k.K)("div",{class:this.classes(ot.valueContent,ot.valueContentReadOnly),key:"value-read-only"},this._formattedValue)}_renderValueWritable(){const{field:t}=this,{name:e,invalid:i,locked:n}=t,r=this.context?.messages.sketch??{},s=n?r.unlockConstraint:r.lockConstraint;return(0,k.K)(k.w,null,(0,k.K)("calcite-input",{afterCreate:this._onAfterCreate,afterRemoved:this._onAfterRemoved,class:ot.input,"data-field-name":e,"data-testid":`tooltip-field-${e}`,key:"input",onblur:this._onInputBlur,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",status:i?"invalid":"idle",type:"text",value:this._rawDisplayValue??lt,onCalciteInputInput:this._onInput}),(0,k.K)("div",{class:ot.inputSuffix,key:"suffix"},this._suffix),t.lockable?(0,k.K)("calcite-button",{afterCreate:this._onLockAfterCreate,afterRemoved:this._onLockAfterRemoved,alignment:"center",appearance:"transparent",class:ot.button,"data-testid":`tooltip-field-${e}-lock`,iconStart:n?at:"unlock",key:"lock",kind:"neutral",label:s,onclick:this._onLockClick,scale:"s",tabIndex:-1,title:s}):(0,k.K)("div",{key:"lock-empty"}))}};(0,m._)([(0,x.MZ)()],ht.prototype,"field",void 0),(0,m._)([(0,x.MZ)()],ht.prototype,"context",void 0),(0,m._)([(0,x.MZ)()],ht.prototype,"mode",void 0),(0,m._)([(0,x.MZ)()],ht.prototype,"_input",void 0),(0,m._)([(0,x.MZ)()],ht.prototype,"_lock",void 0),(0,m._)([(0,x.MZ)()],ht.prototype,"_formattedValue",null),(0,m._)([(0,x.MZ)()],ht.prototype,"_rawDisplayValue",null),(0,m._)([(0,x.MZ)()],ht.prototype,"_suffix",null),(0,m._)([(0,x.MZ)()],ht.prototype,"_title",null),ht=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.components.TooltipEditableField")],ht);const lt="—";function ct(t){const e=t.fields.filter((t=>!0===t?.visible));return 0===e.length?null:(0,k.K)(k.w,null,e.map((e=>(0,k.K)(ht,{context:t.context,field:e,key:e.id,mode:t.mode}))))}let ut=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?e.elevation:void 0,n.orientation?e.orientation:void 0,n.scale?e.scale:void 0],mode:i})}};ut=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],ut);let dt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{elevation:n,visibleElements:r}=e;return(0,k.K)(ct,{context:t,fields:[r.coordinates?e.effectiveX:void 0,r.coordinates?e.effectiveY:void 0,r.elevation?n:void 0],mode:i})}};dt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],dt);const ft={absolute:"absolute-direction",relative:"relative-direction"};let pt=class extends z.A{constructor(t){super(t),this.visibleElements={}}render(){return(0,k.K)("div",{class:I},this._isElementVisible("direction")?(0,k.K)(gt,{messages:this.messages,sketchOptions:this.sketchOptions}):null)}loadDependencies(){return(0,K.W)({button:()=>i.e(2974).then(i.bind(i,45399)),dropdown:()=>i.e(7209).then(i.bind(i,94794)),"dropdown-item":()=>i.e(2547).then(i.bind(i,79383)),"dropdown-group":()=>i.e(951).then(i.bind(i,96361))})}_isElementVisible(t){return this.visibleElements?.[t]??this.sketchOptions.tooltips.visibleElements[t]}};function gt(t){const{directionMode:e}=t.sketchOptions.values,i=t.messages?.sketch,n=i?.directionModeSelect?.title,r="absolute",s="relative";return(0,k.K)("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:e=>{const i=e.target.selectedItems?.[0]?.getAttribute("data-mode");t.sketchOptions.values.directionMode=i??"absolute"}},(0,k.K)("calcite-button",{alignment:"end",appearance:"transparent",iconStart:ft[e],kind:"neutral",label:n,scale:"s",slot:"trigger",title:n}),(0,k.K)("calcite-dropdown-group",{selectionMode:"single"},(0,k.K)("calcite-dropdown-item",{"data-mode":s,"data-testid":"tooltip-direction-mode-relative",iconStart:ft.relative,key:"relative",selected:e===s},i?.directionModeSelect?.relative),(0,k.K)("calcite-dropdown-item",{"data-mode":r,"data-testid":"tooltip-direction-mode-absolute",iconStart:ft.absolute,key:"absolute",selected:e===r},i?.directionModeSelect?.absolute)))}(0,m._)([(0,J.G)("esri/views/interactive/tooltip/t9n/Tooltip"),(0,x.MZ)()],pt.prototype,"messages",void 0),(0,m._)([(0,x.MZ)()],pt.prototype,"sketchOptions",void 0),(0,m._)([(0,x.MZ)()],pt.prototype,"visibleElements",void 0),pt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.components.DrawHeaderActions")],pt);let vt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{xyMode:n,visibleElements:r}=e;return(0,k.K)(ct,{context:t,fields:[..."direction-distance"===n?[r.direction?e.direction:void 0,r.distance?e.distance:void 0]:[r.coordinates?e.effectiveX:void 0,r.coordinates?e.effectiveY:void 0],r.elevation?e.elevation:void 0,r.area?e.area:void 0],mode:i})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return(0,k.K)(pt,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};vt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],vt);let mt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{xyMode:n,visibleElements:r}=e;return(0,k.K)(ct,{context:t,fields:[..."direction-distance"===n?[r.direction?e.direction:void 0,r.distance?e.distance:void 0]:[r.coordinates?e.effectiveX:void 0,r.coordinates?e.effectiveY:void 0],r.elevation?e.elevation:void 0,r.totalLength?e.totalLength:void 0],mode:i})}_renderActions(){const{xyMode:t,sketchOptions:e}=this.info;return(0,k.K)(pt,{sketchOptions:e,visibleElements:{direction:"direction-distance"===t}})}};mt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],mt);let yt=class extends tt{_renderContent(){const{area:t,xSize:e,ySize:i,visibleElements:n}=this.info,r=this._messagesTooltip.sketch,s=this._formatters;return(0,k.K)(k.w,null,n.size&&null!=e&&null!=i?(0,k.K)(B,{title:r.size,value:(0,k.K)(V,{left:s.length(e),right:s.length(i)})}):null,n.area?(0,k.K)(B,{title:r.area,value:s.area(t)}):null)}};yt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],yt);let _t=class extends tt{_renderContent(){const{angle:t,visibleElements:e}=this.info,i=this._messagesTooltip.sketch;return(0,k.K)(k.w,null,e.rotation?(0,k.K)(B,{title:i.rotation,value:this._formatters.angleRelative(t)}):null)}};_t=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],_t);let bt=class extends tt{_renderContent(){const t=this.info,{visibleElements:e}=t,i=this._messagesTooltip.sketch,n=this._formatters;return(0,k.K)(k.w,null,e.size?(0,k.K)(B,{title:i.size,value:(0,k.K)(V,{left:n.length(t.xSize),right:n.length(t.ySize)})}):null,e.scale?(0,k.K)(B,{title:i.scale,value:(0,k.K)(V,{left:n.scale(t.xScale),right:n.scale(t.yScale)})}):null)}};bt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],bt);let wt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?e.elevation:void 0],mode:i})}};wt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentMovePoint")],wt);let xt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.distance?e.distance:void 0,n.area?e.area:void 0,n.totalLength?e.totalLength:void 0],mode:i})}};xt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],xt);let Tt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?e.elevation:void 0,n.area&&"polygon"===e.geometryType?e.area:null,n.totalLength&&"polyline"===e.geometryType?e.totalLength:null],mode:i})}};Tt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentSelectedVertex")],Tt);let At=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?e.elevation:void 0,n.orientation?e.orientation:void 0,n.scale?e.scale:void 0],mode:i})}};At=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTransformMesh")],At);let Mt=class extends tt{_renderContent(){const{fieldContext:t,info:e,mode:i}=this,{visibleElements:n}=e;return(0,k.K)(ct,{context:t,fields:[n.coordinates?e.effectiveX:void 0,n.coordinates?e.effectiveY:void 0,n.elevation?e.elevation:void 0,n.orientation?e.orientation:void 0,n.size?e.size:void 0],mode:i})}};Mt=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTransformPoint")],Mt);let St=class extends tt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,i=this._messagesTooltip.sketch,n=this._formatters;return(0,k.K)(k.w,null,e.distance?(0,k.K)(B,{title:i.distance,value:n.length(t.distance)}):null)}};St=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTranslate")],St);let Et=class extends tt{_renderContent(){const{distance:t,elevation:e,area:i,totalLength:n,visibleElements:r}=this.info,s=this._messagesTooltip.sketch,o=this._formatters;return(0,k.K)(k.w,null,r.distance?(0,k.K)(B,{title:s.distance,value:o.length(t)}):null,r.elevation&&null!=e?.actual?(0,k.K)(B,{title:s.elevation,value:o.verticalLength(e.actual)}):null,r.area&&null!=i?(0,k.K)(B,{title:s.area,value:o.area(i)}):null,r.totalLength&&null!=n?(0,k.K)(B,{title:s.totalLength,value:o.length(n)}):null)}};Et=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],Et);let Ct=class extends tt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,i=this._messagesTooltip.sketch,n=this._formatters;return(0,k.K)(k.w,null,e.distance?(0,k.K)(B,{title:i.distance,value:n.length(t.distance)}):null)}};Ct=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTranslateXY")],Ct);let Ot=class extends tt{_renderContent(){const{info:t}=this,{visibleElements:e}=t,i=this._messagesTooltip.sketch;return(0,k.K)(k.w,null,e.distance?(0,k.K)(B,{title:i.distance,value:this._formatters.verticalLengthRelative(t.distance)}):null)}};Ot=(0,m._)([(0,T.$)("esri.views.interactive.tooltip.content.TooltipContentTranslateZ")],Ot);const Rt={base:`${M}`,ltr:`${M}--ltr`,rtl:`${M}--rtl`,debug:`${M}--debug`};let It=class extends y.A.EventedAccessor{constructor(t){super(t),this.info=null,this.options=null,this.position=null,this.content=null,this._focused=!1,this.outerContainer=document.createElement("div"),this.debug=!1,this._lastPosition=null,this._rtl=!1,this._prevXY=[0,0]}initialize(){const{outerContainer:t}=this;this.addHandles([(0,a.watch)((()=>this.view.overlay?.surface),(e=>{t.remove(),e?.appendChild(t),this._rtl=(0,j.V8)(e)}),a.pc),(0,a.watch)((()=>this.info),((e,i)=>{if(null!=this.content&&null!=e&&null!=i&&e.type===i.type)this.content.info=e;else{(0,b.pR)(this.content);const i=function(t,e){if(null==e)return null;const i=document.createElement("div");switch(e.type){case"draw-point":return new dt({tooltip:t,info:e,container:i});case"draw-polygon":return new vt({tooltip:t,info:e,container:i});case"draw-polyline":return new mt({tooltip:t,info:e,container:i});case"draw-mesh":return new ut({tooltip:t,info:e,container:i});case"draw-rectangle":return new yt({tooltip:t,info:e,container:i});case"draw-circle":return new rt({tooltip:t,info:e,container:i});case"extent-rotate":return new _t({tooltip:t,info:e,container:i});case"extent-scale":return new bt({tooltip:t,info:e,container:i});case"move-point":return new wt({tooltip:t,info:e,container:i});case"selected-vertex":return new Tt({tooltip:t,info:e,container:i});case"transform-point":return new Mt({tooltip:t,info:e,container:i});case"transform-mesh":return new At({tooltip:t,info:e,container:i});case"translate":return new St({tooltip:t,info:e,container:i});case"translate-vertex":return new Et({tooltip:t,info:e,container:i});case"translate-z":return new Ot({tooltip:t,info:e,container:i});case"translate-xy":return new Ct({tooltip:t,info:e,container:i});case"reshape-edge-offset":return new xt({tooltip:t,info:e,container:i})}}(this,e);i?(this.content=i,i.container&&t.appendChild(i.container),this.exitInputMode()):this.content=null}}),a.pc),(0,a.watch)((()=>({container:this.outerContainer,style:this._outerContainerStyle})),(({container:t,style:e})=>{Object.assign(t.style,e)}),a.Vh),(0,a.watch)((()=>({outerContainer:this.outerContainer,placement:this.effectivePlacement,effectiveOffset:this._effectiveOffset,rtl:this._rtl,debug:this.debug})),(({outerContainer:t,placement:e,effectiveOffset:i,rtl:n,debug:r})=>{const{classList:s}=t;s.add(Rt.base),s.toggle(Rt.rtl,n),s.toggle(Rt.ltr,!n),s.toggle(Rt.debug,r),this.outerContainer.style.setProperty("--offset",`${i}px`),(0,A.hY)(t),function({classList:t},e){Pt.forEach((e=>t.remove(e))),t.add(Nt(e))}(t,e)}),a.Vh),(0,a.when)((()=>"feedback"===this.mode),(()=>{this.position=null,this._clearOverride("effectivePlacement")}),a.OH),(0,_.on)(this.outerContainer,"paste",(t=>{this.emit("paste",t)})),(0,_.on)(this.outerContainer,["focusin","focusout"],(()=>{setTimeout((()=>{this._focused=this.content?.container?.contains(document.activeElement)??!1}))}))])}destroy(){this.info=null,this.content=(0,b.pR)(this.content),this.outerContainer.remove()}get mode(){return this.content?.mode??"feedback"}get focused(){return this._focused}get visible(){return"none"!==this._outerContainerStyle.display}get contentContainer(){return this.content?.container}get effectivePlacement(){const t=this.options?.placement;return"auto"===t?"bottom-end":t??"bottom-end"}get _screenPoint(){const{inputManager:t}=this.view;return t?.multiTouchActive?null:t?.latestPointerLocation}get _effectiveOffset(){return this.options?.offset??20}get _outerContainerStyle(){const t=this.position??this._screenPoint;return this._lastPosition=(0,w.y8)(t),null!=t&&null!=this.content?{display:"block",transform:`translate(${Math.round(t.x)}px, ${Math.round(t.y)}px)`}:{display:"none",transform:"none"}}clear(){this.info=null}async enterInputMode(t){const e=this.position??this._lastPosition??this._screenPoint,i=this.position=(0,w.y8)(e),{effectivePlacement:n}=this;this._override("effectivePlacement",n),await(this.content?.enterInputMode(t,(()=>{i&&(this.position=function(t,e,i,n){if(!t||!n.container)return e;const r=t.getBoundingClientRect(),{left:s,top:o}=n.container.getBoundingClientRect();let{x:a,y:h}=e;const l=r.left-s-i;l<0&&(a-=l);const c=r.right-s+i-n.width;c>0&&(a-=c);const u=r.top-o-i;u<0&&(h-=u);const d=r.bottom-o+i-n.height;return d>0&&(h-=d),(0,w.tc)(a,h)}(this.contentContainer,i,this._effectiveOffset,this.view),Object.assign(this.outerContainer.style,this._outerContainerStyle))})))}async exitInputMode(t){await(this.content?.exitInputMode(t))}onDragStart(t,e){this._prevXY=[t,e]}onDrag(t,e){const i=t-this._prevXY[0],n=e-this._prevXY[1];this._prevXY=[t,e];const{position:r}=this;if(r){const{view:s}=this,o=t-s.position[0],a=e-s.position[1];if(o<0||o>s.width||a<0||a>s.height-16)return;this.position=(0,w.tc)(r.x+i,r.y+n)}}onDragEnd(){this._prevXY=[0,0]}};(0,m._)([(0,x.MZ)({nonNullable:!0})],It.prototype,"view",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"info",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"options",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"position",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"content",void 0),(0,m._)([(0,x.MZ)({readOnly:!0})],It.prototype,"mode",null),(0,m._)([(0,x.MZ)()],It.prototype,"_focused",void 0),(0,m._)([(0,x.MZ)({readOnly:!0})],It.prototype,"focused",null),(0,m._)([(0,x.MZ)({readOnly:!0})],It.prototype,"outerContainer",void 0),(0,m._)([(0,x.MZ)({readOnly:!0})],It.prototype,"contentContainer",null),(0,m._)([(0,x.MZ)({readOnly:!0})],It.prototype,"effectivePlacement",null),(0,m._)([(0,x.MZ)()],It.prototype,"debug",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"_lastPosition",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"_screenPoint",null),(0,m._)([(0,x.MZ)()],It.prototype,"_rtl",void 0),(0,m._)([(0,x.MZ)()],It.prototype,"_effectiveOffset",null),(0,m._)([(0,x.MZ)()],It.prototype,"_outerContainerStyle",null),It=(0,m._)([(0,T.$)("esri.views.interactive.Tooltip")],It);const Pt=["top","bottom","leading","trailing"].flatMap((t=>[Nt(`${t}-start`),Nt(t),Nt(`${t}-end`)]));function Nt(t){return`${Rt.base}--${t}`}const Dt=It;var Lt=i(99675);function zt(t){const e=new Dt(t());return e.addHandles((0,a.watch)((()=>t()),(({view:t,options:i,info:n})=>{e.view=t,void 0!==i&&(e.options=i),void 0!==n&&(e.info=n)}))),e}function jt(t,e){const i=(0,f.Hq)(e.vertexSpace),{scale:n,orientation:r}=t,{transform:s}=e,a=function(t){if(!t)return 0;const e=Bt(t.rotationAxis);return null!=e?e*t.rotationAngle:null}(s);i&&null!=a?(r.actual=(0,o.Wq)(a,"degrees","arithmetic"),r.visible=!0):(r.actual=null,r.visible=!1),i?(n.actual=(0,o.LF)(Vt(s)),n.visible=!0):(n.actual=null,n.visible=!1)}function kt(t,e,i){if(!e||!(0,f.Hq)(e.vertexSpace))return;const n=e.transform??=new d.A;(function(t,e,i){const n=(0,Lt.Ef)(t.orientation.actual),r=Bt(e.rotationAxis);if(null==n||null==r)return;const s=e.rotationAngle,o=n*r,a=(n-s)*r;s!==o&&(i?.onRotateStart(0),e.rotationAngle=o,i?.onRotate(a),i?.onRotateStop(a))})(t,n,i),function(t,e,i){const n=t.scale.actual?.value,r=Vt(e);if(null==n||n===r)return;const{scale:s}=e;let o;if(0===r)o=(0,c.o8)(c.Un);else{const t=n/r;o=(0,l.h)((0,c.vt)(),s,t)}i?.onScaleStart(s[0],s[1],s[2]),e.scale=o,i?.onScale(o[0],o[1],o[2]),i?.onScaleStop(o[0],o[1],o[2])}(t,n,i)}function Ft(t,e){const{x:i,y:n,z:r}=e,{x:a,y:l,z:c}=function(t,e){let i,n;t.geographic?(i=(0,Lt.hF)(t.longitude.actual),n=(0,Lt.hF)(t.latitude.actual),(0,p.K8)(e)&&(null!=i&&null!=n?[i,n]=(0,g.je)(i,n,Ht):null!=i?i=(0,g.je)(i,0,Ht)[0]:null!=n&&(n=(0,g.je)(0,n,Ht)[1]))):(i=t.x.actual?.value,n=t.y.actual?.value);const r=t.elevation.actual,s=(0,h.mq)(e);return{x:i,y:n,z:null!=s&&null!=r?(0,o.l3)(r,s):void 0}}(t,e.spatialReference);return{dx:null==a||(0,s.Io)(a,i)?0:a-i,dy:null==l||(0,s.Io)(l,n)?0:l-n,dz:null==c||null==r||(0,s.Io)(c,r)?0:c-r}}const Ht=[0,0];function Bt(t){return(0,l.H)(t,c.Cb)?1:(0,l.H)(t,Gt)?-1:null}const Gt=(0,l.v)((0,c.vt)(),c.Cb);function Vt(t){return t?Math.max(...t.scale):1}function Ut(t,e){return!("key-down"!==t.type||t.key!==v.ac.enterInputMode||!e||!function(t){const e=t?.sketchOptions;if(!e)return!1;const{inputEnabled:i,visibleElements:n}=e.tooltips;return i&&!0===t.editableFields.some((({name:t})=>"x"===t||"y"===t?n.coordinates:n[t]))}(e.info)||(e.enterInputMode(),t.preventDefault(),t.stopPropagation(),0))}function $t(t,e){let i=null;return(0,r.vE)([t.on("paste",(async r=>{i?.abort(),i=(0,n.UT)((async()=>{(0,u.s1)()||await(0,u.Hh)(),Wt(r,t.info,e)}))})),(0,n.UT)((()=>(0,u.Hh)())),(0,r.hA)((()=>i?.abort()))])}function Wt(t,e,i){if(!e||!("geographic"in e))return;const n=t.clipboardData?.getData("text");if(!n)return;const r=e=>{t.stopPropagation(),t.preventDefault(),i?.onBeforePaste(),e(),i?.onAfterPaste()};if(e.geographic){const t=(0,X.X3)(n);t&&r((()=>{e.longitude.applyValue(t.longitude),e.latitude.applyValue(t.latitude)}))}else{const t=(0,X.Nr)(n);t&&r((()=>{e.x.applyValue(t.x),e.y.applyValue(t.y)}))}}},82854:function(t,e,i){"use strict";i.d(e,{Tv:function(){return h},Zs:function(){return s},cD:function(){return a},cz:function(){return u},fT:function(){return r},lH:function(){return c},mA:function(){return o},n4:function(){return l}});var n=i(52874);const r=new n.A("cyan"),s=1,o=.25,a=(new n.A("black"),.25),h="default",l="temporary",c=new n.A("yellow"),u=8},81197:function(t,e,i){"use strict";var n;i.d(e,{M:function(){return n}}),function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"}(n||(n={}))},48961:function(t,e,i){"use strict";i.d(e,{Bb:function(){return C},W6:function(){return n},mj:function(){return y},nu:function(){return O}});var n,r,s=i(14606),o=(i(58941),i(40633)),a=i(95929),h=i(69739),l=i(7187),c=i(60539),u=i(28181),d=i(85445),f=i(38504),p=i(47558),g=i(16164),v=i(81197),m=i(55213);function y(){return new S.Scheduler}(r=n||(n={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",r.RESOURCE_CONTROLLER="schedule",r.SLIDE="slide",r.STREAM_DATA_LOADER="stream loader",r.ELEVATION_QUERY="elevation query",r.TERRAIN_SURFACE="terrain",r.SURFACE_GEOMETRY_UPDATES="surface geometry updates",r.LOD_RENDERER="LoD renderer",r.GRAPHICS_CORE="Graphics3D",r.I3S_CONTROLLER="I3S",r.POINT_CLOUD_LAYER="point cloud",r.FEATURE_TILE_FETCHER="feature fetcher",r.OVERLAY="overlay",r.STAGE="stage",r.GRAPHICS_DECONFLICTOR="graphics deconflictor",r.FILTER_VISIBILITY="Graphics3D filter visibility",r.SCALE_VISIBILITY="Graphics3D scale visibility",r.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",r.POINT_OF_INTEREST_FREQUENT="POI frequent",r.POINT_OF_INTEREST_INFREQUENT="POI infrequent",r.LABELER="labeler",r.FEATURE_QUERY_ENGINE="feature query",r.FEATURE_TILE_TREE="feature tile tree",r.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",r.ELEVATION_ALIGNMENT="elevation alignment",r.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",r.TEXT_TEXTURE_ATLAS="text texture atlas",r.TEXTURE_UNLOAD="texture unload",r.LINE_OF_SIGHT_TOOL="line of sight tool",r.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",r.ELEVATION_PROFILE="elevation profile",r.SNAPPING="snapping",r.SHADOW_ACCUMULATOR="shadow accumulator",r.CLOUDS_GENERATOR="clouds generator",r.MAPVIEW_FETCH_QUEUE="mapview fetch queue",r.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",r.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",r[r.NONE=0]="NONE",r[r.TEST_PRIO=1]="TEST_PRIO";const _=new Map([[n.RESOURCE_CONTROLLER_IMMEDIATE,0],[n.RESOURCE_CONTROLLER,4],[n.SLIDE,0],[n.STREAM_DATA_LOADER,0],[n.ELEVATION_QUERY,0],[n.TERRAIN_SURFACE,1],[n.SURFACE_GEOMETRY_UPDATES,1],[n.LOD_RENDERER,2],[n.GRAPHICS_CORE,2],[n.I3S_CONTROLLER,2],[n.POINT_CLOUD_LAYER,2],[n.FEATURE_TILE_FETCHER,2],[n.CLOUDS_GENERATOR,2],[n.OVERLAY,4],[n.STAGE,4],[n.GRAPHICS_DECONFLICTOR,4],[n.FILTER_VISIBILITY,4],[n.SCALE_VISIBILITY,4],[n.FRUSTUM_VISIBILITY,4],[n.POINT_OF_INTEREST_FREQUENT,6],[n.POINT_OF_INTEREST_INFREQUENT,30],[n.LABELER,8],[n.FEATURE_QUERY_ENGINE,8],[n.FEATURE_TILE_TREE,16],[n.FEATURE_TILE_TREE_ACTIVE,0],[n.ELEVATION_ALIGNMENT,12],[n.ELEVATION_ALIGNMENT_SCENE,14],[n.TEXT_TEXTURE_ATLAS,12],[n.TEXTURE_UNLOAD,12],[n.LINE_OF_SIGHT_TOOL,16],[n.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[n.SNAPPING,0],[n.SHADOW_ACCUMULATOR,30],[n.MAPVIEW_FETCH_QUEUE,0],[n.MAPVIEW_LAYERVIEW_UPDATE,2],[n.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,0]]);function b(t){return _.has(t)?_.get(t):"number"==typeof t?t:1}const w=(0,f.l5)(6.5),x=(0,f.l5)(1),T=(0,f.l5)(30),A=(0,f.l5)(1e3/30),M=(0,f.l5)(100);var S,E;!function(t){t.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((t=>t.needsUpdate))}constructor(){this._updating=(0,d.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new h.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new i,this._state=v.M.INTERACTING,this._tasks=new l.A,this._runQueue=new l.A,this._load=0,this._idleStateCallbacks=new l.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,u.watch)((()=>g.A.SCHEDULER_LOG_SLOW_TASKS),(t=>this._debug=t),u.Vh);for(const t of Object.keys(n))this.performanceInfo.tasks.set(n[t],new h.A(n[t]))}destroy(){this._tasks.toArray().forEach((t=>t.remove())),this._tasks.clear(),(0,a.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(t){this._updatingChanged(),t&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(t,i){const n=new e(this,t,i);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new h.A(t)),n}registerIdleStateCallbacks(t,e){const i={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(i),this.state===v.M.IDLE&&this._idleUpdatesStartFired&&i.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(t){n._idleUpdatesStartFired&&(i.idleEnd(),n._state===v.M.IDLE&&t()),i.idleBegin=t},set idleEnd(t){i.idleEnd=t}}}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,this.state!==v.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return this._state}updateBudget(t){this._test&&(this._test.usedBudget=0),++this._frameNumber;let e=w,i=t.frameDuration,n=x;switch(this.state){case v.M.IDLE:e=(0,f.l5)(0),i=(0,f.l5)(Math.max(M,t.frameDuration)),n=T;break;case v.M.INTERACTING:i=(0,f.l5)(Math.max(A,t.frameDuration));case v.M.ANIMATING:}return i=(0,f.l5)(i-t.elapsedFrameTime-e),this.state!==v.M.IDLE&&i<x&&!this._forceTask?(this._forceTask=!0,!1):(i=(0,f.l5)(Math.max(i,n)),this._budget.reset(i,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case v.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case v.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset((0,f.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t),this._updatingChanged()}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return E.SCHEDULED;let e=E.IDLE;return this._tasks.forAll((i=>{i.name===t&&i.needsUpdate&&(i.schedulePriority<=1?e=E.READY:e!==E.READY&&(e=E.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((i=>{i.name===t&&(e+=i.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,i)=>{e+=t>1?` ${t}x ${i}`:` ${i}`})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=.9*this._load+t*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{0===t.basePriority&&t.needsUpdate&&!this._runQueue.includes(t)&&t.blockFrame!==this._frameNumber&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1,e=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&i.blockFrame!==this._frameNumber&&(t=!0,e=Math.max(e,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!t)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const e=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)===m.G&&(i.blockFrame=this._frameNumber)}catch(t){o.A.getLogger("esri.views.support.Scheduler").error(`Exception in task "${i.name}"`,t),i.blockFrame=this._frameNumber}!this._budget.hasProgressed&&i.blockFrame!==this._frameNumber&&i.needsUpdate&&(i.name,n.I3S_CONTROLLER,i.blockFrame=this._frameNumber),i.schedulePriority=i.basePriority;const r=this._budget.now()-e;if(i.runtime+=r,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+r),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(n))this._frameTaskTimes.set(n[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).push(t))),this.performanceInfo.total.push(t)}get test(){return this._test}};class e{get task(){return this._task.value}get updating(){return this._queue.running}constructor(t,e,i){this._scheduler=t,this.name=e,this.blockFrame=0,this.runtime=0,this._queue=new p.T,this._handles=new s.A,this._basePriority=b(e),this.schedulePriority=this._basePriority,this._task=(0,d.v)(null!=i?i:this._queue),this._handles.add((0,u.when)((()=>this.task.running),(e=>t.taskRunningChanged(e))))}remove(){this.processQueue(C),this._scheduler.removeTask(this),this.schedule=O.schedule,this.reschedule=O.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){if(this.name===t)return;this.name=t;const e=b(t);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,i){return this._queue.push(t,e,i)}reschedule(t,e,i){return this._queue.unshift(t,e,i)}processQueue(t){return this._queue.runTask(t)}}class i{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=v.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=i}(S||(S={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(E||(E={}));const C=(()=>{const t=new S.Budget;return t.enabled=!1,t})(),O=new class{remove(){}processQueue(){}schedule(t,e,i){try{if((0,c.G4)(e)){const t=(0,c.NK)();return i?Promise.resolve(i(t)):Promise.reject(t)}return(0,c.z7)(t(C))}catch(t){return Promise.reject(t)}}reschedule(t,e,i){return this.schedule(t,e,i)}}},55213:function(t,e,i){"use strict";i.d(e,{G:function(){return n}});const n=Symbol("Yield")},70474:function(t,e,i){"use strict";i.d(e,{n:function(){return x}});var n=i(56275),r=i(62938),s=i(59122),o=i(20551),a=i(32501),h=i(68734),l=i(5596),c=i(67496),u=i(19271);function d(t,e,i=t.hasZ){const s=(0,u.l)(t.spatialReference),d=(0,r.B5)(s);if(null==d)return null;const v=(t,e)=>!(e.length<2||((0,o.i)(t,e[0],e[1],i&&e[2]||0),0));let m=0;for(const i of t.rings){const n=i.length;if(n<3)continue;const{positionsWorldCoords:r}=e;for(;r.length<n;)r.push((0,a.vt)());const u=f,d=(0,o.i)(p,0,0,0),y=1/n;for(let e=0;e<n;e++){if(!v(u,i[e]))return null;if(!(0,h.F)(u,t.spatialReference,r[e],s))return null;(0,o.b)(d,d,r[e],y)}const _=(0,l.Cr)(r[0],r[1],d,(0,l.LV)());if(0===(0,o.k)((0,l.Qj)(_)))continue;for(let t=0;t<n;t++)(0,l.Z1)(_,d,r[t],r[t]);const b=g(r);for(let t=0;t<b.length;t+=3)m+=(0,c.Fm)(r[b[t]],r[b[t+1]],r[b[t+2]])}return(0,n.gT)(m,d)}const f=(0,a.vt)(),p=(0,a.vt)();function g(t){return(0,s.e)(function(t){const e=new Float64Array(2*t.length);for(let i=0;i<t.length;++i){const n=t[i],r=2*i;e[r]=n[0],e[r+1]=n[1]}return e}(t),[],2)}var v=i(22162),m=i(57862),y=i(99368);function _(t){const{spatialReference:e}=t;return(0,y.M0)(e,b,w,t)}function b(t){return(0,n.gT)(Math.abs((0,m.qy)([t],"square-meters")[0]),"square-meters")}function w(t){try{return(0,n.gT)(Math.abs((0,v.geodesicArea)(t,"square-meters")),"square-meters")}catch(t){return null}}function x(t,e={positionsWorldCoords:[]}){return function(t,e,i={positionsWorldCoords:[]}){if("on-the-ground"===e){const e=_(t);return null!=e?e:function(t,e={positionsWorldCoords:[]}){return d(t,e,!1)}(t,i)}return function(t,e={positionsWorldCoords:[]}){return d(t,e)}(t,i)}(t,"on-the-ground",e)}},9862:function(t,e,i){"use strict";i.d(e,{Do:function(){return h},Kt:function(){return a},ob:function(){return o}});var n=i(32501),r=i(46517),s=i(1428);function o(t){return(0,s.mh)(t)??(0,r.Xg)(t)}function a(t,e){return(0,s.Og)(t,e)??(0,r.ll)(t,e)}function h(t,e,i){return l[0]=t[0],l[1]=t[1],l[2]=3===t.length?t[2]:0,c[0]=e[0],c[1]=e[1],c[2]=3===e.length?e[2]:0,(0,s.n3)(l,c,i)??(0,r.sT)(l,c,i)}const l=(0,n.vt)(),c=(0,n.vt)()},16164:function(t,e,i){"use strict";i.d(e,{A:function(){return h}});var n=i(53804),r=i(83525),s=i(23502),o=(i(58941),i(40633),i(13798),i(65953));let a=class extends r.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,n._)([(0,s.MZ)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,n._)([(0,o.$)("esri.views.support.debugFlags")],a);const h=new a},33383:function(t,e,i){"use strict";i.d(e,{V:function(){return o},t:function(){return a}}),i(50917);var n=i(62938),r=i(82418),s=i(91484);function o(t,e,i,r=new s.default){let o=0;if("2d"===i.type)o=e*(i.resolution??0);else if("3d"===i.type){const r=i.overlayPixelSizeInMapUnits(t),s=i.basemapSpatialReference;o=null==s||s.equals(i.spatialReference)?e*r:(0,n.GA)(s)/(0,n.GA)(i.spatialReference)}const a=t.x-o,h=t.y-o,l=t.x+o,c=t.y+o,{spatialReference:u}=i;return r.xmin=Math.min(a,l),r.ymin=Math.min(h,c),r.xmax=Math.max(a,l),r.ymax=Math.max(h,c),r.spatialReference=u,r}function a(t,e,i){const n=i.toMap(t);return null!=n&&o(n,(0,r.o)(),i,h).intersects(e)}const h=new s.default},46517:function(t,e,i){"use strict";i.d(e,{Of:function(){return g},Qc:function(){return v},Xg:function(){return d},cL:function(){return _},e5:function(){return p},ll:function(){return f},sT:function(){return y}});var n,r,s=i(56275),o=i(62938),a=i(20551),h=i(32501),l=i(68734),c=i(57652),u=i(19271);function d(t){return function(t,e){const{hasZ:i,spatialReference:r}=t,a=(0,u.l)(r);let h=0;const l=(0,o._H)(a);if(null==l)return null;const c=e===n.Direct?m:y;for(const e of t.paths){if(e.length<2)continue;const t=e.length-1;for(let n=0;n<t;++n){const t=e[n];w[0]=t[0],w[1]=t[1],w[2]=i?t[2]:0;const s=e[n+1];x[0]=s[0],x[1]=s[1],x[2]=i?s[2]:0;const o=c(w,x,r);if(null==o)return null;h+=o.value}}return(0,s.d_)(h,l)}(t,n.Horizontal)}function f(t,e){const{spatialReference:i}=t;return(0,c.aI)(i,e.spatialReference)?(w[0]=t.x,w[1]=t.y,w[2]=t.hasZ?t.z:0,x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,y(w,x,i)):null}function p(t,e){const{spatialReference:i}=t;return(0,c.aI)(i,e.spatialReference)?(w[0]=t.x,w[1]=t.y,w[2]=t.hasZ?t.z:0,x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,_(w,x,i)):null}function g(t){return null!=t?v(t.hasZ?t.z:0,t.spatialReference):null}function v(t,e){const i=(0,o.mq)(e);return null!=i?(0,s.d_)(t??0,i):null}function m(t,e,i){const r=b(t,e,i,n.Direct);return null!=r?(0,s.d_)(r.direct,r.unit):null}function y(t,e,i){const r=b(t,e,i,n.Horizontal);return null!=r?(0,s.d_)(r.horizontal,r.unit):null}function _(t,e,i){const r=b(t,e,i,n.Vertical);return null!=r?(0,s.d_)(r.verticalSigned,r.unit):null}function b(t,e,i,r){const s=(0,u.l)(i),h=(0,o._H)(s);if(null==h)return null;const c=e[2]-t[2];if(r===n.Vertical)return{verticalSigned:c,unit:h};if(!(0,l.F)(t,i,T,s)||!(0,l.F)(e,i,A,s))return null;if(r===n.Direct)return{direct:(0,a.j)(A,T),unit:h};if((0,a.i)(M,t[0],t[1],e[2]),!(0,l.F)(M,i,M,s))return null;const d=(0,a.j)(M,A);return r===n.Horizontal?{horizontal:d,unit:h}:{direct:(0,a.j)(A,T),horizontal:d,vertical:Math.abs(c),unit:h}}(r=n||(n={}))[r.Direct=0]="Direct",r[r.Horizontal=1]="Horizontal",r[r.Vertical=2]="Vertical";const w=(0,h.vt)(),x=(0,h.vt)(),T=(0,h.vt)(),A=(0,h.vt)(),M=(0,h.vt)()},16633:function(t,e,i){"use strict";i.d(e,{b:function(){return s}});var n=i(56275),r=i(9862);function s({topLeft:t,topRight:e,bottomRight:i,bottomLeft:s,spatialReference:o}){const a=(0,n.T9)((0,r.Do)(s,i,o),(0,r.Do)(t,e,o));if(null==a)return null;const h=(0,n.T9)((0,r.Do)(i,e,o),(0,r.Do)(s,t,o));return null==h?null:{xSize:a,ySize:h}}},1428:function(t,e,i){"use strict";i.d(e,{Og:function(){return c},mh:function(){return l},n3:function(){return u}});var n=i(56275),r=i(32501),s=i(22162),o=i(57862),a=i(57652),h=i(99368);function l(t){const{spatialReference:e}=t;return(0,h.M0)(e,p,g,t)}function c(t,e){if(!(0,a.aI)(t.spatialReference,e.spatialReference))return null;const{spatialReference:i}=t;return m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,y[0]=e.x,y[1]=e.y,y[2]=e.hasZ?e.z:0,u(m,y,i)}function u(t,e,i){return(0,h.M0)(i,d,f,t,e,i)}function d(t,e,i){return(0,n.d_)((0,o._3)(v,t,e,i).distance,"meters")}function f(t,e,i){return(0,n.d_)((0,s.geodesicLength)(function(t,e,i){return{type:"polyline",spatialReference:i,paths:[[[...t],[...e]]]}}(t,e,i),"meters"),"meters")}function p(t){return(0,n.d_)((0,o.l1)([t],"meters")[0],"meters")}function g(t){return(0,n.d_)((0,s.geodesicLength)(t,"meters"),"meters")}const v=new o.Zj,m=(0,r.vt)(),y=(0,r.vt)()},99368:function(t,e,i){"use strict";i.d(e,{M0:function(){return o},yF:function(){return s}});var n=i(57862),r=i(57652);function s(t){return(0,n.TT)(t)||(0,r.K8)(t)}function o(t,e,i,...s){return(0,n.TT)(t)?e.apply(void 0,s):(0,r.K8)(t)?i.apply(void 0,s):null}},19271:function(t,e,i){"use strict";i.d(e,{l:function(){return o}});var n=i(61714),r=i(96611),s=i(57652);function o(t){return(0,s.B3)(t)?(0,s.oT)(t)||(0,s.K8)(t)||(0,s.x1)(t)||(0,n.jA)(t)?r.Y0:t:(0,r.lO)(t)}},86305:function(t,e,i){"use strict";i.d(e,{g:function(){return l}});var n=i(50659),r=(i(58941),i(40633)),s=i(24540),o=i(41835),a=i(85456);const h=()=>r.A.getLogger("esri.views.webgl.BufferObject");class l{static createIndex(t,e,i){return new l(t,a.NZ.ELEMENT_ARRAY_BUFFER,e,i)}static createVertex(t,e,i){return new l(t,a.NZ.ARRAY_BUFFER,e,i)}static createUniform(t,e,i){return new l(t,a.NZ.UNIFORM_BUFFER,e,i)}static createPixelPack(t,e=a._U.STREAM_READ,i){const n=new l(t,a.NZ.PIXEL_PACK_BUFFER,e);return i&&n.setSize(i),n}static createPixelUnpack(t,e=a._U.STREAM_DRAW,i){return new l(t,a.NZ.PIXEL_UNPACK_BUFFER,e,i)}static createTransformFeedback(t,e=a._U.STATIC_DRAW,i){const n=new l(t,a.NZ.TRANSFORM_FEEDBACK_BUFFER,e);return n.setSize(i),n}constructor(t,e,i,n){this._context=t,this.bufferType=e,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(a.vt.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,o.Y2)(this._context.gl),n&&this.setData(n)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get usedMemory(){if(this.bufferType===a.NZ.ELEMENT_ARRAY_BUFFER){if(this._indexType===a.pe.UNSIGNED_INT)return 4*this._size;if(this._indexType===a.pe.UNSIGNED_SHORT)return 2*this._size}return this._size}get _isVAOAware(){return this.bufferType===a.NZ.ELEMENT_ARRAY_BUFFER||this.bufferType===a.NZ.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(a.vt.BufferObject,this),this._context=null):this._glName&&h().warn("Leaked WebGL buffer object")}setSize(t,e=null){if(this.bufferType===a.NZ.ELEMENT_ARRAY_BUFFER&&null!=e)switch(this._indexType=e,e){case a.pe.UNSIGNED_SHORT:t*=2;break;case a.pe.UNSIGNED_INT:t*=4}this._setBufferData(t)}setData(t){if(!t)return;let e=t.byteLength;this.bufferType===a.NZ.ELEMENT_ARRAY_BUFFER&&((0,s.mg)(t)?this._indexType=a.pe.UNSIGNED_BYTE:(0,s.jq)(t)?(e/=2,this._indexType=a.pe.UNSIGNED_SHORT):(0,s.XJ)(t)&&(e/=4,this._indexType=a.pe.UNSIGNED_INT)),this._setBufferData(e,t)}_setBufferData(t,e=null){this._size=t;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const n=this._context.gl;null!=e?n.bufferData(this.bufferType,e,this.usage):n.bufferData(this.bufferType,t,this.usage),(0,o.Y2)(n),this._isVAOAware&&this._context.bindVAO(i)}setSubData(t,e,i,n){if(!t)return;const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const{gl:s}=this._context;s.bufferSubData(this.bufferType,e*t.BYTES_PER_ELEMENT,t,i,n-i),(0,o.Y2)(s),this._isVAOAware&&this._context.bindVAO(r)}getSubData(t,e=0,i,r){if(i<0||r<0)return;const s=function(t){return(0,n.Xj)(t)}(t)?t.BYTES_PER_ELEMENT:1;if(s*((i??0)+(r??0))>t.byteLength)return;e+s*(r??0)>this.usedMemory&&h().warn("Potential problem getting subdata: requested data exceeds buffer size!");const o=this._context.gl;this.bufferType===a.NZ.TRANSFORM_FEEDBACK_BUFFER?(this._context.bindBuffer(this,a.NZ.TRANSFORM_FEEDBACK_BUFFER),o.getBufferSubData(a.NZ.TRANSFORM_FEEDBACK_BUFFER,e,t,i,r),this._context.unbindBuffer(a.NZ.TRANSFORM_FEEDBACK_BUFFER)):(this._context.bindBuffer(this,a.NZ.COPY_READ_BUFFER),o.getBufferSubData(a.NZ.COPY_READ_BUFFER,e,t,i,r),this._context.unbindBuffer(a.NZ.COPY_READ_BUFFER))}async getSubDataAsync(t,e=0,i,n){await this._context.clientWaitAsync(),this.getSubData(t,e,i,n)}}},69452:function(t,e,i){"use strict";var n;i.d(e,{p:function(){return n}}),function(t){t[t.Texture=0]="Texture",t[t.RenderBuffer=1]="RenderBuffer"}(n||(n={}))},12285:function(t,e,i){"use strict";i.d(e,{g:function(){return l}});var n=i(39819),r=(i(58941),i(41835)),s=i(85456),o=i(69452),a=i(10956),h=i(31516);let l=class t{constructor(t,e=null,i=null){if(this.type=o.p.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in t)this._descriptor=t,i=e;else{const i=h.z.validate(t,e);if(!i)throw new n.A("Texture descriptor invalid");this._descriptor=i}this._descriptor.target===s.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return(0,a.e)(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(s.vt.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(t,e){const i=this._descriptor;if(i.width!==t||i.height!==e){if(this._wasImmutablyAllocated)throw new n.A("Immutable textures can't be resized!");i.width=t,i.height=e,this._descriptor.target===s.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(t=null){for(let e=s.Ap.TEXTURE_CUBE_MAP_POSITIVE_X;e<=s.Ap.TEXTURE_CUBE_MAP_NEGATIVE_Z;e++)this._setData(t,e)}setData(t){this._setData(t)}_setData(e,i){const o=this._descriptor.context?.gl;if(!o)return;(0,r.Y2)(o),this._glName||(this._glName=o.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(s.vt.Texture,this));const a=this._descriptor,h=i??a.target,l=g(h),m=this._descriptor.context.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),c(a),this._configurePixelStorage(),(0,r.Y2)(o);const y=this._deriveInternalFormat();if(p(e)){let t="width"in e?e.width:e.codedWidth,i="height"in e?e.height:e.codedHeight;const n=1;e instanceof HTMLVideoElement&&(t=e.videoWidth,i=e.videoHeight),a.width&&a.height,l&&a.depth,a.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(h,y,a.hasMipmap,t,i,n),this._texImage(h,0,y,t,i,n,e),(0,r.Y2)(o),a.hasMipmap&&(this.generateMipmap(),(0,r.Y2)(o)),a.width||(a.width=t),a.height||(a.height=i),l&&!a.depth&&(a.depth=n)}else{const{width:t,height:i,depth:c}=a;if(null==t||null==i)throw new n.A("Width and height must be specified!");if(l&&null==c)throw new n.A("Depth must be specified!");if(a.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(h,y,a.hasMipmap,t,i,c),f(e)){const r=e.levels,l=v(h,t,i,c),u=Math.min(l-1,r.length-1);o.texParameteri(a.target,this._descriptor.context.gl.TEXTURE_MAX_LEVEL,u);const d=y;if(!(d in s.CQ))throw new n.A("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel(((t,e,i,n)=>{const s=r[Math.min(t,r.length-1)];this._compressedTexImage(h,t,d,e,i,n,s)}),u)}else this._texImage(h,0,y,t,i,c,e),(0,r.Y2)(o),a.hasMipmap&&this.generateMipmap()}u(o,this._descriptor),d(o,this._descriptor),function(t,e){const i=t.capabilities.textureFilterAnisotropic;i&&t.gl.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}(this._descriptor.context,this._descriptor),(0,r.Y2)(o),this._descriptor.context.bindTexture(m,t.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,i,r,s,o,a,h=0){a||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const l=this._descriptor,c=this._deriveInternalFormat(),{context:u,pixelFormat:d,dataType:g,target:v,isImmutable:m}=l;if(m&&!this._wasImmutablyAllocated)throw new n.A("Cannot update immutable texture before allocation!");const y=u.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||r<0||i+s>l.width||r+o>l.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=u;h&&_.pixelStorei(_.UNPACK_SKIP_ROWS,h),p(a)?_.texSubImage2D(v,e,i,r,s,o,d,g,a):f(a)?_.compressedTexSubImage2D(v,e,i,r,s,o,c,a.levels[e]):_.texSubImage2D(v,e,i,r,s,o,d,g,a),h&&_.pixelStorei(_.UNPACK_SKIP_ROWS,0),u.bindTexture(y,t.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,i,r,s,o,a,h,l){l||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const c=this._descriptor,u=this._deriveInternalFormat(),{context:d,pixelFormat:p,dataType:v,isImmutable:m,target:y}=c;if(m&&!this._wasImmutablyAllocated)throw new n.A("Cannot update immutable texture before allocation!");g(y)||console.warn("Attempting to set 3D texture data on a non-3D texture");const _=d.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);d.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),(i<0||r<0||s<0||i+o>c.width||r+a>c.height||s+h>c.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:b}=d;if(f(l))l=l.levels[e],b.compressedTexSubImage3D(y,e,i,r,s,o,a,h,u,l);else{const t=l;b.texSubImage3D(y,e,i,r,s,o,a,h,p,v,t)}d.bindTexture(_,t.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new n.A("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,c(e)}e.samplingMode===s.Cj.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=s.Cj.LINEAR_MIPMAP_NEAREST):e.samplingMode===s.Cj.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=s.Cj.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,t.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(t.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(i,t.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const t=this._descriptor;if(t.hasMipmap){if(this._wasImmutablyAllocated)throw new n.A("Cannot delete mipmaps to immutable texture after allocation");t.hasMipmap=!1,this._samplingModeDirty=!0,c(t)}t.samplingMode===s.Cj.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,t.samplingMode=s.Cj.LINEAR):t.samplingMode===s.Cj.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,t.samplingMode=s.Cj.NEAREST)}setSamplingMode(t){t!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=t,this._samplingModeDirty=!0)}setWrapMode(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,c(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const t=this._descriptor,e=t.context.gl;this._samplingModeDirty&&(u(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(d(e,t),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(null!=this._descriptor.internalFormat)return this._descriptor.internalFormat===s.Ab.DEPTH_STENCIL&&(this._descriptor.internalFormat=s.Ab.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case s.ld.FLOAT:switch(this._descriptor.pixelFormat){case s.Ab.RGBA:return this._descriptor.internalFormat=s.H0.RGBA32F;case s.Ab.RGB:return this._descriptor.internalFormat=s.H0.RGB32F;default:throw new n.A("Unable to derive format")}case s.ld.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case s.Ab.RGBA:return this._descriptor.internalFormat=s.H0.RGBA8;case s.Ab.RGB:return this._descriptor.internalFormat=s.H0.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===s.Ab.DEPTH_STENCIL?s.Ab.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const t=this._descriptor.context.gl,{unpackAlignment:e,flipped:i,preMultiplyAlpha:n}=this._descriptor;t.pixelStorei(t.UNPACK_ALIGNMENT,e),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,i?1:0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n?1:0)}_texStorage(t,e,i,r,o,a){const{gl:h}=this._descriptor.context;if(!(e in s.H0))throw new n.A("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=i?v(t,r,o,a):1;if(g(t)){if(null==a)throw new n.A("Missing depth dimension for 3D texture upload");h.texStorage3D(t,l,e,r,o,a)}else h.texStorage2D(t,l,e,r,o);this._wasImmutablyAllocated=!0}_texImage(t,e,i,r,s,o,a){const h=this._descriptor.context.gl,l=g(t),{isImmutable:c,pixelFormat:u,dataType:d}=this._descriptor;if(c){if(null!=a){const i=a;if(l){if(null==o)throw new n.A("Missing depth dimension for 3D texture upload");h.texSubImage3D(t,e,0,0,0,r,s,o,u,d,i)}else h.texSubImage2D(t,e,0,0,r,s,u,d,i)}}else{const c=a;if(l){if(null==o)throw new n.A("Missing depth dimension for 3D texture upload");h.texImage3D(t,e,i,r,s,o,0,u,d,c)}else h.texImage2D(t,e,i,r,s,0,u,d,c)}}_compressedTexImage(t,e,i,r,s,o,a){const h=this._descriptor.context.gl,l=g(t);if(this._descriptor.isImmutable){if(null!=a)if(l){if(null==o)throw new n.A("Missing depth dimension for 3D texture upload");h.compressedTexSubImage3D(t,e,0,0,0,r,s,o,i,a)}else h.compressedTexSubImage2D(t,e,0,0,r,s,i,a)}else if(l){if(null==o)throw new n.A("Missing depth dimension for 3D texture upload");h.compressedTexImage3D(t,e,i,r,s,o,0,a)}else h.compressedTexImage2D(t,e,i,r,s,0,a)}_forEachMipmapLevel(t,e=1/0){let{width:i,height:r,depth:o,hasMipmap:a,target:h}=this._descriptor;const l=h===s.Ap.TEXTURE_3D;if(null==i||null==r||l&&null==o)throw new n.A("Missing texture dimensions for mipmap calculation");for(let n=0;t(n,i,r,o),a&&(1!==i||1!==r||l&&1!==o)&&!(n>=e);++n)i=Math.max(1,i>>1),r=Math.max(1,r>>1),l&&(o=Math.max(1,o>>1))}};function c(t){(null!=t.width&&t.width<0||null!=t.height&&t.height<0||null!=t.depth&&t.depth<0)&&console.error("Negative dimension parameters are not allowed!")}function u(t,e){let i=e.samplingMode,n=e.samplingMode;i===s.Cj.LINEAR_MIPMAP_NEAREST||i===s.Cj.LINEAR_MIPMAP_LINEAR?(i=s.Cj.LINEAR,e.hasMipmap||(n=s.Cj.LINEAR)):i!==s.Cj.NEAREST_MIPMAP_NEAREST&&i!==s.Cj.NEAREST_MIPMAP_LINEAR||(i=s.Cj.NEAREST,e.hasMipmap||(n=s.Cj.NEAREST)),t.texParameteri(e.target,t.TEXTURE_MAG_FILTER,i),t.texParameteri(e.target,t.TEXTURE_MIN_FILTER,n)}function d(t,e){"number"==typeof e.wrapMode?(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode)):(t.texParameteri(e.target,t.TEXTURE_WRAP_S,e.wrapMode.s),t.texParameteri(e.target,t.TEXTURE_WRAP_T,e.wrapMode.t))}function f(t){return null!=t&&"type"in t&&"compressed"===t.type}function p(t){return null!=t&&!f(t)&&!function(t){return null!=t&&"byteLength"in t}(t)}function g(t){return t===s.Ap.TEXTURE_3D||t===s.Ap.TEXTURE_2D_ARRAY}function v(t,e,i,n=1){let r=Math.max(e,i);return t===s.Ap.TEXTURE_3D&&(r=Math.max(r,n)),Math.round(Math.log(r)/Math.LN2)+1}l.TEXTURE_UNIT_FOR_UPDATES=0},10956:function(t,e,i){"use strict";i.d(e,{R:function(){return s},e:function(){return o}});var n=i(85456),r=i(93380);class s{constructor(t=0,e=t){this.width=t,this.height=e,this.target=n.Ap.TEXTURE_2D,this.pixelFormat=n.Ab.RGBA,this.dataType=n.ld.UNSIGNED_BYTE,this.samplingMode=n.Cj.LINEAR,this.wrapMode=n.pF.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}}function o(t){return t.width<=0||t.height<=0?0:Math.round(t.width*t.height*(t.hasMipmap?4/3:1)*(null==t.internalFormat?4:(0,r.IB)(t.internalFormat))*(t.target===n.Ap.TEXTURE_CUBE_MAP?6:1))}},93380:function(t,e,i){"use strict";i.d(e,{Hi:function(){return h},IB:function(){return l},WH:function(){return o},yu:function(){return a}}),i(58941);var n=i(41835),r=i(85456),s=i(48347);function o(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function a(t,e,i,r,a=0){const h=t.gl;t.bindBuffer(i);for(const i of r){const r=e.get(i.name);if(null==r){console.warn(`There is no location for vertex attribute '${i.name}' defined.`);continue}const l=a*i.stride;if(i.count<=4)h.vertexAttribPointer(r,i.count,i.type,i.normalized,i.stride,i.offset+l),h.enableVertexAttribArray(r),i.divisor>0&&t.gl.vertexAttribDivisor(r,i.divisor);else if(9===i.count)for(let e=0;e<3;e++)h.vertexAttribPointer(r+e,3,i.type,i.normalized,i.stride,i.offset+12*e+l),h.enableVertexAttribArray(r+e),i.divisor>0&&t.gl.vertexAttribDivisor(r+e,i.divisor);else if(16===i.count)for(let e=0;e<4;e++)h.vertexAttribPointer(r+e,4,i.type,i.normalized,i.stride,i.offset+16*e+l),h.enableVertexAttribArray(r+e),i.divisor>0&&t.gl?.vertexAttribDivisor(r+e,i.divisor);else console.error("Unsupported vertex attribute element count: "+i.count);if((0,n.en)()){const e=o(t),n=(0,s._)(i.type),r=i.offset,a=Math.round(n/r)!==n/r?`. Offset not a multiple of stride. DataType requires ${n} bytes, but descriptor has an offset of ${r}`:"";e&&console.error(`Unable to bind vertex attribute "${i.name}" with baseInstanceOffset ${l}${a}:`,e,i)}}}function h(t,e,i,n){const s=t.gl;t.bindBuffer(i);for(const i of n){const n=e.get(i.name);if(i.count<=4)s.disableVertexAttribArray(n),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n,0);else if(9===i.count)for(let e=0;e<3;e++)s.disableVertexAttribArray(n+e),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n+e,0);else if(16===i.count)for(let e=0;e<4;e++)s.disableVertexAttribArray(n+e),i.divisor&&i.divisor>0&&t.gl?.vertexAttribDivisor(n+e,0);else console.error("Unsupported vertex attribute element count: "+i.count)}t.unbindBuffer(r.NZ.ARRAY_BUFFER)}function l(t){switch(t){case r.Ab.ALPHA:case r.Ab.LUMINANCE:case r.Ab.RED:case r.Ab.RED_INTEGER:case r.H0.R8:case r.H0.R8I:case r.H0.R8UI:case r.H0.R8_SNORM:case r.yQ.STENCIL_INDEX8:return 1;case r.Ab.LUMINANCE_ALPHA:case r.Ab.RG:case r.Ab.RG_INTEGER:case r.H0.RGBA4:case r.H0.R16F:case r.H0.R16I:case r.H0.R16UI:case r.H0.RG8:case r.H0.RG8I:case r.H0.RG8UI:case r.H0.RG8_SNORM:case r.H0.RGB565:case r.H0.RGB5_A1:case r.yQ.DEPTH_COMPONENT16:return 2;case r.Ab.DEPTH_COMPONENT:case r.Ab.RGB:case r.Ab.RGB_INTEGER:case r.H0.RGB8:case r.H0.RGB8I:case r.H0.RGB8UI:case r.H0.RGB8_SNORM:case r.H0.SRGB8:case r.yQ.DEPTH_COMPONENT24:return 3;case r.Ab.DEPTH_STENCIL:case r.Ab.DEPTH24_STENCIL8:case r.Ab.RGBA:case r.Ab.RGBA_INTEGER:case r.H0.RGBA8:case r.H0.R32F:case r.H0.R11F_G11F_B10F:case r.H0.RG16F:case r.H0.R32I:case r.H0.R32UI:case r.H0.RG16I:case r.H0.RG16UI:case r.H0.RGBA8I:case r.H0.RGBA8UI:case r.H0.RGBA8_SNORM:case r.H0.SRGB8_ALPHA8:case r.H0.RGB9_E5:case r.H0.RGB10_A2UI:case r.H0.RGB10_A2:case r.yQ.DEPTH_STENCIL:case r.yQ.DEPTH_COMPONENT32F:case r.yQ.DEPTH24_STENCIL8:return 4;case r.yQ.DEPTH32F_STENCIL8:return 5;case r.H0.RGB16F:case r.H0.RGB16I:case r.H0.RGB16UI:return 6;case r.H0.RG32F:case r.H0.RG32I:case r.H0.RG32UI:case r.H0.RGBA16F:case r.H0.RGBA16I:case r.H0.RGBA16UI:return 8;case r.H0.RGB32F:case r.H0.RGB32I:case r.H0.RGB32UI:return 12;case r.H0.RGBA32F:case r.H0.RGBA32I:case r.H0.RGBA32UI:return 16;case r.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT:case r.CQ.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case r.CQ.COMPRESSED_RGBA_S3TC_DXT3_EXT:case r.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case r.CQ.COMPRESSED_R11_EAC:case r.CQ.COMPRESSED_SIGNED_R11_EAC:case r.CQ.COMPRESSED_RGB8_ETC2:case r.CQ.COMPRESSED_SRGB8_ETC2:case r.CQ.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case r.CQ.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case r.CQ.COMPRESSED_RG11_EAC:case r.CQ.COMPRESSED_SIGNED_RG11_EAC:case r.CQ.COMPRESSED_RGBA8_ETC2_EAC:case r.CQ.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}},31516:function(t,e,i){"use strict";i.d(e,{z:function(){return s}});var n=i(85456),r=i(10956);class s extends r.R{constructor(t,e){switch(super(),this.context=t,Object.assign(this,e),this.internalFormat){case n.H0.R16F:case n.H0.R16I:case n.H0.R16UI:case n.H0.R32F:case n.H0.R32I:case n.H0.R32UI:case n.H0.R8_SNORM:case n.H0.R8:case n.H0.R8I:case n.H0.R8UI:this.pixelFormat=n.Ab.RED}}static validate(t,e){return new s(t,e)}}},81438:function(t,e,i){"use strict";i.d(e,{Z:function(){return l}});var n=i(40633),r=i(95929),s=i(24540),o=i(85456),a=i(93380);const h=()=>n.A.getLogger("esri.views.webgl.VertexArrayObject");let l=class{constructor(t,e,i,n,r=null){this._context=t,this._locations=e,this._layout=i,this._buffers=n,this._indexBuffer=r,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Array.from(this._buffers.values()).reduce(((t,e)=>t+e.usedMemory),null!=this._indexBuffer?this._indexBuffer.usedMemory:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*s.zQ}dispose(){this._context?(this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this._indexBuffer=(0,r.WD)(this._indexBuffer),this.disposeVAOOnly()):(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&h().warn("Leaked WebGL VAO")}disposeVAOOnly(){this._glName&&(this._context.gl.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(o.vt.VertexArrayObject,this)),this._context=null}initialize(){if(this._initialized)return;const{gl:t}=this._context,e=t.createVertexArray();t.bindVertexArray(e),this._bindLayout(),t.bindVertexArray(null),this._glName=e,this._context.instanceCounter.increment(o.vt.VertexArrayObject,this),this._initialized=!0}bind(){this.initialize(),this._context.gl.bindVertexArray(this.glName)}_bindLayout(){const{_buffers:t,_layout:e,_indexBuffer:i}=this;t||h().error("Vertex buffer dictionary is empty!");const n=this._context.gl;this._buffers.forEach(((t,i)=>{const n=e.get(i);n?(0,a.yu)(this._context,this._locations,t,n):h().error("Vertex element descriptor is empty!")})),null!=i&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.glName)}unbind(){this.initialize(),this._context.gl.bindVertexArray(null)}}},3817:function(t,e,i){"use strict";i.d(e,{_:function(){return n}});class n{constructor(t,e,i,n,r,s=!1,o=0){this.name=t,this.count=e,this.type=i,this.offset=n,this.stride=r,this.normalized=s,this.divisor=o}}},41835:function(t,e,i){"use strict";i.d(e,{Xc:function(){return l},Y2:function(){return c},en:function(){return h}});var n=i(39819),r=i(58941),s=i(40633);const o=()=>s.A.getLogger("esri.views.webgl.checkWebGLError"),a=!!(0,r.A)("enable-feature:webgl-debug");function h(){return a}function l(){return a}function c(t){if(h()){const e=t.getError();if(e){const i=function(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(t,e),r=(new Error).stack;o().error(new n.A("webgl-error","WebGL error occurred",{message:i,stack:r}))}}}},44476:function(t,e,i){"use strict";function n(t,e,i){for(let n=0;n<i;++n)e[2*n]=t[n],e[2*n+1]=t[n]-e[2*n]}function r(t,e){const i=t.length;for(let n=0;n<i;++n)o[0]=t[n],e[n]=o[0];return e}function s(t,e){const i=t.length;for(let n=0;n<i;++n)o[0]=t[n],o[1]=t[n]-o[0],e[n]=o[1];return e}i.d(e,{Zo:function(){return r},jA:function(){return s},jS:function(){return n}});const o=new Float32Array(2)},85456:function(t,e,i){"use strict";var n,r,s,o,a,h,l,c,u,d,f,p,g,v,m,y,_,b,w,x;i.d(e,{Ab:function(){return v},Ac:function(){return l},Ap:function(){return g},CQ:function(){return C},Cj:function(){return f},Co:function(){return w},H0:function(){return m},Hr:function(){return S},MT:function(){return u},NV:function(){return n},NZ:function(){return a},Nm:function(){return M},R:function(){return x},Tb:function(){return o},WR:function(){return r},Y7:function(){return h},_U:function(){return b},dn:function(){return s},eA:function(){return d},ld:function(){return y},nI:function(){return E},pF:function(){return p},pe:function(){return c},sS:function(){return P},tx:function(){return N},vt:function(){return A},xM:function(){return T},xV:function(){return O},yQ:function(){return _}}),function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"}(n||(n={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(r||(r={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(s||(s={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(o||(o={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(a||(a={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(h||(h={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(l||(l={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"}(c||(c={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(u||(u={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(d||(d={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(f||(f={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(p||(p={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(g||(g={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(v||(v={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(m||(m={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(y||(y={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(_||(_={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(b||(b={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(w||(w={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(x||(x={}));const T=33984;var A,M,S;!function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.TransformFeedback=7]="TransformFeedback",t[t.Sync=8]="Sync",t[t.UNCOUNTED=9]="UNCOUNTED",t[t.LinesOfCode=9]="LinesOfCode",t[t.Uniform=10]="Uniform",t[t.COUNT=11]="COUNT"}(A||(A={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(M||(M={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(S||(S={}));const E=33306;var C,O,R,I,P,N,D;!function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"}(C||(C={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(O||(O={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}(R||(R={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(I||(I={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(P||(P={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(N||(N={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(D||(D={}))},48347:function(t,e,i){"use strict";i.d(e,{_:function(){return r}});var n=i(85456);function r(t){switch(t){case n.pe.BYTE:case n.pe.UNSIGNED_BYTE:return 1;case n.pe.SHORT:case n.pe.UNSIGNED_SHORT:case n.pe.HALF_FLOAT:return 2;case n.pe.FLOAT:case n.pe.INT:case n.pe.UNSIGNED_INT:return 4}}},57087:function(t,e,i){"use strict";i.d(e,{Ey:function(){return A},Ky:function(){return l},Ms:function(){return W},Os:function(){return h},Uy:function(){return f},Xt:function(){return d},gh:function(){return a},hG:function(){return u},kn:function(){return p},p3:function(){return o}});var n=i(54407),r=i(85456);function s(t,e,i=r.Tb.ADD,n=[0,0,0,0]){return{srcRgb:t,srcAlpha:t,dstRgb:e,dstAlpha:e,opRgb:i,opAlpha:i,color:{r:n[0],g:n[1],b:n[2],a:n[3]}}}function o(t,e,i,n,s=r.Tb.ADD,o=r.Tb.ADD,a=[0,0,0,0]){return{srcRgb:t,srcAlpha:e,dstRgb:i,dstAlpha:n,opRgb:s,opAlpha:o,color:{r:a[0],g:a[1],b:a[2],a:a[3]}}}const a=s(r.dn.ZERO,r.dn.ONE_MINUS_SRC_ALPHA),h=(s(r.dn.ONE,r.dn.ZERO),s(r.dn.ONE,r.dn.ONE),s(r.dn.ONE,r.dn.ONE_MINUS_SRC_ALPHA)),l=o(r.dn.SRC_ALPHA,r.dn.ONE,r.dn.ONE_MINUS_SRC_ALPHA,r.dn.ONE_MINUS_SRC_ALPHA),c={face:r.Y7.BACK,mode:r.Ac.CCW},u={face:r.Y7.FRONT,mode:r.Ac.CCW},d=t=>t===n.s2.Back?c:t===n.s2.Front?u:null,f={zNear:0,zFar:1},p={r:!0,g:!0,b:!0,a:!0};function g(t){return E.intern(t)}function v(t){return O.intern(t)}function m(t){return I.intern(t)}function y(t){return N.intern(t)}function _(t){return L.intern(t)}function b(t){return j.intern(t)}function w(t){return F.intern(t)}function x(t){return B.intern(t)}function T(t){return V.intern(t)}function A(t){return $.intern(t)}class M{constructor(t,e){this._makeKey=t,this._makeRef=e,this._interns=new Map}intern(t){if(!t)return null;const e=this._makeKey(t),i=this._interns;return i.has(e)||i.set(e,this._makeRef(t)),i.get(e)??null}}function S(t){return"["+t.join(",")+"]"}const E=new M(C,(t=>({__tag:"Blending",...t})));function C(t){return t?S([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}const O=new M(R,(t=>({__tag:"Culling",...t})));function R(t){return t?S([t.face,t.mode]):null}const I=new M(P,(t=>({__tag:"PolygonOffset",...t})));function P(t){return t?S([t.factor,t.units]):null}const N=new M(D,(t=>({__tag:"DepthTest",...t})));function D(t){return t?S([t.func]):null}const L=new M(z,(t=>({__tag:"StencilTest",...t})));function z(t){return t?S([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}const j=new M(k,(t=>({__tag:"DepthWrite",...t})));function k(t){return t?S([t.zNear,t.zFar]):null}const F=new M(H,(t=>({__tag:"ColorWrite",...t})));function H(t){return t?S([t.r,t.g,t.b,t.a]):null}const B=new M(G,(t=>({__tag:"StencilWrite",...t})));function G(t){return t?S([t.mask]):null}const V=new M(U,(t=>({__tag:"DrawBuffers",...t})));function U(t){return t?S(t.buffers):null}const $=new M((function(t){return t?S([C(t.blending),R(t.culling),P(t.polygonOffset),D(t.depthTest),z(t.stencilTest),k(t.depthWrite),H(t.colorWrite),G(t.stencilWrite),U(t.drawBuffers)]):null}),(t=>({blending:g(t.blending),culling:v(t.culling),polygonOffset:m(t.polygonOffset),depthTest:y(t.depthTest),stencilTest:_(t.stencilTest),depthWrite:b(t.depthWrite),colorWrite:w(t.colorWrite),stencilWrite:x(t.stencilWrite),drawBuffers:T(t.drawBuffers)})));class W{constructor(t){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=t}setPipeline(t){(this._pipelineInvalid||t!==this._pipeline)&&(this._setBlending(t.blending),this._setCulling(t.culling),this._setPolygonOffset(t.polygonOffset),this._setDepthTest(t.depthTest),this._setStencilTest(t.stencilTest),this._setDepthWrite(t.depthWrite),this._setColorWrite(t.colorWrite),this._setStencilWrite(t.stencilWrite),this._setDrawBuffers(t.drawBuffers),this._pipeline=t),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(t){this._blending=this._setSubState(t,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(t){this._culling=this._setSubState(t,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(t){this._polygonOffset=this._setSubState(t,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(t){this._depthTest=this._setSubState(t,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(t){this._stencilTest=this._setSubState(t,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(t){this._depthWrite=this._setSubState(t,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(t){this._colorWrite=this._setSubState(t,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(t){this._stencilWrite=this._setSubState(t,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(t){this._drawBuffers=this._setSubState(t,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(t,e,i,n){return(i||t!==e)&&(n(t),this._pipelineInvalid=!0),t}}},31267:function(t,e,i){"use strict";i.d(e,{A:function(){return k}});var n=i(53804),r=(i(64122),i(88022)),s=i(88264),o=i(48996),a=i(40212),h=(i(58941),i(21609)),l=i(40633),c=i(95929),u=i(62560),d=i(60539),f=i(28181),p=i(66110),g=i(23502),v=i(77560),m=i(65953),y=i(44567),_=i(6792),b=i(92781);i(81401);const w={handleInterceptedEvent:(t,e,i,n)=>(t.scheduleRender(),e.properties[`on${n.type}`].apply(e.properties.bind||i,[n]))},x={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}},T=(t,e,i=!1)=>{let n=t;return e.forEach(((t,r)=>{const s=n?.children?((t,e)=>t.find(e))(n.children,(e=>e.domNode===t)):void 0;i&&!s&&r!==e.length-1||(n=s)})),n};var A=i(28754),M=i(69987),S=i(50074);const E=new Set;var C,O=i(15351),R=i(10362),I=i(22739),P=i(38225);let N=0;function D(t,e){const i=Object.prototype.hasOwnProperty;for(const n in e)i.call(e,n)&&i.call(t,n)&&(null!=t[n]&&null!=e[n]&&"object"==typeof t[n]&&"object"==typeof e[n]?D(t[n],e[n]):t[n]=e[n]);return t}const L=(t=>{let e;const i={...w,...t},n=(s=i,{...x,...s}),r=n.performanceLogger;var s;let o,a=!0,h=!1;const l=[],c=[],u=(t,s,o)=>{let a;n.eventHandlerInterceptor=(t,n,s,o)=>function(t){let n;r("domEvent",t);const s=((t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i})(t.currentTarget,a.domNode),o=s.some((t=>customElements.get(t?.tagName?.toLowerCase())));if(t.eventPhase!==Event.CAPTURING_PHASE&&o){const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).reverse();n=T(a.getLastRender(),i,!0)}else s.reverse(),n=T(a.getLastRender(),s);let h;return n&&(h=i.handleInterceptedEvent(e,n,this,t)),r("domEventProcessed",t),h},i.postProcessProjectionOptions?.(n);const h=o();a=t(s,h,n),n.eventHandlerInterceptor=void 0,l.push(a),c.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,h)};let d=()=>{if(o=void 0,a){a=!1,r("renderStart",void 0);for(let t=0;t<l.length;t++){const e=c[t]();r("rendered",void 0);try{l[t].update(e)}catch(t){console.error(t)}r("patched",void 0)}r("renderDone",void 0),a=!0}};return i.modifyDoRenderImplementation&&(d=i.modifyDoRenderImplementation(d,l,c)),e={renderNow:d,scheduleRender:()=>{o||h||(o=requestAnimationFrame(d))},stop:()=>{o&&(cancelAnimationFrame(o),o=void 0),h=!0},resume:()=>{h=!1,a=!0,e.scheduleRender()},append:(t,e)=>{u(b.t.append,t,e)},insertBefore:(t,e)=>{u(b.t.insertBefore,t,e)},merge:(t,e)=>{u(b.t.merge,t,e)},replace:(t,e)=>{u(b.t.replace,t,e)},detach:t=>{for(let e=0;e<c.length;e++)if(c[e]===t)return c.splice(e,1),l.splice(e,1)[0];throw new Error("renderFunction was not found")}},e})({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,n,r,s)=>{const o=e?.(t,n,r,s),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in r)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o?.call(r,t);r.addEventListener(e,i,a);const n=()=>r.removeEventListener(e,i,a),h=s.afterRemoved;s.afterRemoved=t=>{h?.(t),n()}}return o}},handleInterceptedEvent(t,e,i,n){const{eventPhase:r,type:s}=n,o=r===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const h=e.properties;(h&&a in h||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,h&&a in h))&&((0,O.Sh)(),t.scheduleRender(),h[a].call(h.bind||i,n))}});let z=!1,j=class extends((0,u.g)(o.A.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._projector=L,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=(0,d.sg)((async()=>{if(this._messageBundleProps?.length){const t=await Promise.allSettled(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{if(this.destroyed)return;let i=await(0,P.ud)(t);this.uiStrings&&Object.keys(this.uiStrings)&&(i=D((0,h.o8)(i),this.uiStrings)),this[e]=i})));if(this.destroyed)return;for(const e of t)"rejected"===e.status&&l.A.getLogger(this).error("widget-intl:locale-error",this.declaredClass,e.reason)}await this.loadLocale()})),(0,A.V)();const i="esri-widget-uid-"+(0,p.lk)(),n=this.render.bind(this);this._trackingTarget=new _.r((()=>{this.autoRenderingEnabled&&this.scheduleRender()}));const r=()=>({vnodeSelector:"div",properties:{key:`${i}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),s=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const t=n()??r(),e=t.properties??={};if(e.key??=i,(0,M.b)(t.vnodeSelector)){if(!this.visible)return r()}else this.visible?e.styles||(e.styles={}):(e.class="",e.styles={display:"none"}),e.styles.display??="";let s=0;return t.children?.forEach((t=>{(0,M.b)(t.vnodeSelector)||(t.properties??={},t.properties.key??=`${this.id}--${s++}`)})),(0,M.d)(this,t)};this.render=()=>{if(z)return s();let t=(0,O.rE)(this)??null;if(t)return t;this._trackingTarget.clear(),z=!0;try{t=(0,y.a)(this._trackingTarget,s)}catch(t){throw l.A.getLogger(this).error(t),t}finally{z=!1}return t&&(0,O.$U)(this,t),t};const o=this.beforeFirstRender();var a;o?this._resourcesFetch=o.then((()=>{this._readyForTrueRender=!0,this._postInitialize()})):(this._resourcesFetch=Promise.resolve().then((()=>{this._postInitialize()})),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),a=this._resourcesFetch,E.add(a),a.finally((()=>E.delete(a)))}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){const t=this.loadDependencies();return this._messageBundleProps?.length||t?Promise.all([t,this._loadLocale()]).then((()=>{})).catch(d.jH):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||((0,c.pR)(this._trackingTarget),(0,c.pR)(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,(0,O.Qw)(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return(0,s.$)(t)}get domNode(){return this.container}set domNode(t){this.container=t}get icon(){return null}set icon(t){this._overrideIfSome("icon",t)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+N++}set id(t){t&&this._set("id",t)}get label(){return this.declaredClass.split(".").pop()}set label(t){this._overrideIfSome("label",t)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(t){this._set("visible",t)}get[(C=S.x,S.D)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||((0,O.Qw)(this),this._projector.scheduleRender())}own(t){(0,r.eO)(l.A.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(t)}classes(...t){return R.Ly.apply(this,t)}renderNow(){(0,O.Qw)(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles((0,f.watch)((()=>this.viewModel),((t,e)=>{e&&this.removeHandles("delegated-events"),t&&(0,a.wb)(t)&&this.addHandles(this._delegatedEventNames.map((e=>(0,a.on)(t,e,(t=>{this.emit(e,t)})))),"delegated-events")}),f.pc)),this.postInitialize();const t=async()=>{await this._loadLocale().catch(d.jH),this.scheduleRender()};this.addHandles([(0,I.oQ)(t),(0,f.watch)((()=>this.uiStrings),t),(0,f.when)((()=>this.container),(t=>{this.destroyed||this._attach(t)}),{initial:!0,once:!0})])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){this._attached&&(this._projector.detach(this.render),this._attached=!1),t?.parentNode?.removeChild(t)}};j[C]=!0,j.vnodeSelector="div",(0,n._)([(0,g.MZ)()],j.prototype,"_readyForTrueRender",void 0),(0,n._)([(0,g.MZ)({value:null})],j.prototype,"container",null),(0,n._)([(0,v.w)("container")],j.prototype,"castContainer",null),(0,n._)([(0,g.MZ)()],j.prototype,"icon",null),(0,n._)([(0,g.MZ)()],j.prototype,"id",null),(0,n._)([(0,g.MZ)()],j.prototype,"label",null),(0,n._)([(0,g.MZ)()],j.prototype,"renderable",null),(0,n._)([(0,g.MZ)()],j.prototype,"uiStrings",void 0),(0,n._)([(0,g.MZ)()],j.prototype,"viewModel",void 0),(0,n._)([(0,g.MZ)({value:!0})],j.prototype,"visible",null),(0,n._)([(0,g.MZ)()],j.prototype,"key",void 0),(0,n._)([(0,g.MZ)()],j.prototype,"children",void 0),(0,n._)([(0,g.MZ)()],j.prototype,"afterCreate",void 0),(0,n._)([(0,g.MZ)()],j.prototype,"afterUpdate",void 0),(0,n._)([(0,g.MZ)()],j.prototype,"afterRemoved",void 0),j=(0,n._)([(0,m.$)("esri.widgets.Widget")],j);const k=j},28754:function(t,e,i){"use strict";i.d(e,{V:function(){return u},W:function(){return d}});var n=i(96367),r=i(67646),s=i(54038),o=i(3102);function a(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(n.d)||t.contains(n.a)&&e?"dark":"light",r=t=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:t}})),s=t=>{o!==t&&r(t),o=t};let o=i();r(o),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(t=>s(t.matches?"dark":"light"))),new MutationObserver((()=>s(i()))).observe(document.body,{attributes:!0,attributeFilter:["class"]})}(0,s.i)()&&("interactive"===document.readyState?a():document.addEventListener("DOMContentLoaded",(()=>a()),{once:!0})),(0,r.s)();var h=i(53216),l=(i(58941),i(90683));let c;function u(){try{(0,o.OX)(".")}catch{(0,o.Qu)((0,l.s2)((0,h.s)(c)))}}function d(t){const e=[];for(const i of Object.keys(t))customElements.get(`calcite-${i}`)||e.push(t[i]?.());return e.length>0?Promise.all(e):null}c="components/assets"},90357:function(t,e,i){"use strict";function n(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}i.d(e,{G:function(){return n}})},49146:function(t,e,i){"use strict";i.d(e,{K:function(){return a},w:function(){return h}});var n=i(69987),r=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},s=function(t,e){for(var i=0,n=t.length;i<n;i++){var o=t[i];Array.isArray(o)?s(o,e):null!=o&&!1!==o&&(o.hasOwnProperty("vnodeSelector")||(o=r(o)),e.push(o))}},o=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var r=[];return s(i,r),{vnodeSelector:t,properties:e||void 0,children:r,text:void 0,domNode:null}};function a(t,e,...i){return"function"!=typeof t||(0,n.b)(t)?o(t,e,...i):t(e,...i)}function h(...t){return t}},69987:function(t,e,i){"use strict";i.d(e,{b:function(){return d},d:function(){return h}});var n=i(61226),r=i(50074);const s=[],o={},a=new WeakMap;function h(t,e){let i=e.children;if(i?.length)for(let e=0;e<i.length;++e)i[e]=h(t,i[e]);else i=s;const n=e.vnodeSelector;if(d(n)){const r=e.properties||o,s=r.key||n,a={key:s,afterCreate:l,afterUpdate:c,afterRemoved:u,parentWidget:t,widgetConstructor:n,widgetProperties:{...r,key:s,children:i}};return{vnodeSelector:n.vnodeSelector,properties:a,children:void 0,text:void 0,domNode:null}}return e}function l(t,e,i,{parentWidget:s,widgetConstructor:o,widgetProperties:h}){const l=new o(h);l.container=t,a.set(t,l),l.afterCreate?.(l,t),s.addHandles((0,n.hA)((()=>u(t)))),queueMicrotask((()=>{l[r.D].projector.renderNow()}))}function c(t,e,i,{widgetProperties:n}){const r=a.get(t);r&&(r.set(n),r.afterUpdate?.(r,t))}function u(t){const e=a.get(t);e&&(e.afterRemoved?.(e,t),e.destroy(),a.delete(t))}function d(t){return"function"==typeof t&&t[r.x]}},50074:function(t,e,i){"use strict";i.d(e,{D:function(){return r},x:function(){return n}});const n=Symbol("widget"),r=Symbol("widget-test-data")},15351:function(t,e,i){"use strict";i.d(e,{$U:function(){return o},Qw:function(){return a},Sh:function(){return r},rE:function(){return s}});const n=new Map;function r(){n.clear()}function s(t){return n.get(t)}function o(t,e){n.set(t,e)}function a(t){n.delete(t)}},10362:function(t,e,i){"use strict";i.d(e,{Ly:function(){return ut},N_:function(){return ft},OU:function(){return yt},V8:function(){return dt},W5:function(){return mt},Z6:function(){return _t},cA:function(){return pt}});var n=function(){return n=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},n.apply(this,arguments)},r={exports:{}},s={},o={exports:{}},a={};function h(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var l=/javascript\s*\:/gim;a.whiteList={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},a.getDefaultWhiteList=h,a.onAttr=function(t,e,i){},a.onIgnoreAttr=function(t,e,i){},a.safeAttrValue=function(t,e){return l.test(e)?"":e};var c=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},u=function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")},d=a,f=function(t,e){";"!==(t=u(t))[t.length-1]&&(t+=";");var i=t.length,n=!1,r=0,s=0,o="";function a(){if(!n){var i=c(t.slice(r,s)),a=i.indexOf(":");if(-1!==a){var h=c(i.slice(0,a)),l=c(i.slice(a+1));if(h){var u=e(r,o.length,h,l,i);u&&(o+=u+"; ")}}}r=s+1}for(;s<i;s++){var h=t[s];if("/"===h&&"*"===t[s+1]){var l=t.indexOf("*/",s+2);if(-1===l)break;r=(s=l+1)+1,n=!1}else"("===h?n=!0:")"===h?n=!1:";"===h?n||a():"\n"===h&&a()}return c(o)};function p(t){return null==t}function g(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||d.whiteList,t.onAttr=t.onAttr||d.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||d.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||d.safeAttrValue,this.options=t}g.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onAttr,r=e.onIgnoreAttr,s=e.safeAttrValue;return f(t,(function(t,e,o,a,h){var l=i[o],c=!1;if(!0===l?c=l:"function"==typeof l?c=l(a):l instanceof RegExp&&(c=l.test(a)),!0!==c&&(c=!1),a=s(o,a)){var u,d={position:e,sourcePosition:t,source:h,isWhite:c};return c?p(u=n(o,a,d))?o+":"+a:u:p(u=r(o,a,d))?void 0:u}}))};var v=g;!function(t,e){var i=a,n=v;for(var r in(e=t.exports=function(t,e){return new n(e).process(t)}).FilterCSS=n,i)e[r]=i[r]}(o,o.exports);var m=o.exports,y={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,r;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,r=t.length;n<r;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}},_=m.FilterCSS,b=m.getDefaultWhiteList,w=y;var x=new _;function T(t){return t.replace(A,"&lt;").replace(M,"&gt;")}var A=/</g,M=/>/g,S=/"/g,E=/&quot;/g,C=/&#([a-zA-Z0-9]*);?/gim,O=/&colon;?/gim,R=/&newline;?/gim,I=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,P=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,N=/u\s*r\s*l\s*\(.*/gi;function D(t){return t.replace(S,"&quot;")}function L(t){return t.replace(E,'"')}function z(t){return t.replace(C,(function(t,e){return"x"===e[0]||"X"===e[0]?String.fromCharCode(parseInt(e.substr(1),16)):String.fromCharCode(parseInt(e,10))}))}function j(t){return t.replace(O,":").replace(R," ")}function k(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return w.trim(e)}function F(t){return k(t=j(t=z(t=L(t))))}function H(t){return T(t=D(t))}s.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},s.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},s.onTag=function(t,e,i){},s.onIgnoreTag=function(t,e,i){},s.onTagAttr=function(t,e,i){},s.onIgnoreTagAttr=function(t,e,i){},s.safeAttrValue=function(t,e,i,n){if(i=F(i),"href"===e||"src"===e){if("#"===(i=w.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(I.lastIndex=0,I.test(i))return""}else if("style"===e){if(P.lastIndex=0,P.test(i))return"";if(N.lastIndex=0,N.test(i)&&(I.lastIndex=0,I.test(i)))return"";!1!==n&&(i=(n=n||x).process(i))}return H(i)},s.escapeHtml=T,s.escapeQuote=D,s.unescapeQuote=L,s.escapeHtmlEntities=z,s.escapeDangerHtml5Entities=j,s.clearNonPrintableCharacter=k,s.friendlyAttrValue=F,s.escapeAttrValue=H,s.onIgnoreTagStripAll=function(){return""},s.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),n=[],r=!1;return{onIgnoreTag:function(s,o,a){if(function(e){return!!i||-1!==w.indexOf(t,e)}(s)){if(a.isClosing){var h=a.position+10;return n.push([!1!==r?r:a.position,h]),r=!1,"[/removed]"}return r||(r=a.position),"[removed]"}return e(s,o,a)},remove:function(t){var e="",i=0;return w.forEach(n,(function(n){e+=t.slice(i,n[0]),i=n[1]})),e+=t.slice(i)}}},s.stripCommentTag=function(t){for(var e="",i=0;i<t.length;){var n=t.indexOf("\x3c!--",i);if(-1===n){e+=t.slice(i);break}e+=t.slice(i,n);var r=t.indexOf("--\x3e",n);if(-1===r)break;i=r+3}return e},s.stripBlankChar=function(t){var e=t.split("");return(e=e.filter((function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)}))).join("")},s.cssFilter=x,s.getDefaultCSSWhiteList=b;var B={},G=y;function V(t){var e,i=G.spaceIndex(t);return e=-1===i?t.slice(1,-1):t.slice(1,i+1),"/"===(e=G.trim(e).toLowerCase()).slice(0,1)&&(e=e.slice(1)),"/"===e.slice(-1)&&(e=e.slice(0,-1)),e}function U(t){return"</"===t.slice(0,2)}var $=/[^a-zA-Z0-9\\_:.-]/gim;function W(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function q(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"'"===i||'"'===i?e:-1}}function Z(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function Y(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}B.parseTag=function(t,e,i){var n="",r=0,s=!1,o=!1,a=0,h=t.length,l="",c="";t:for(a=0;a<h;a++){var u=t.charAt(a);if(!1===s){if("<"===u){s=a;continue}}else if(!1===o){if("<"===u){n+=i(t.slice(r,a)),s=a,r=a;continue}if(">"===u){n+=i(t.slice(r,s)),l=V(c=t.slice(s,a+1)),n+=e(s,n.length,l,c,U(c)),r=a+1,s=!1;continue}if('"'===u||"'"===u)for(var d=1,f=t.charAt(a-d);""===f.trim()||"="===f;){if("="===f){o=u;continue t}f=t.charAt(a-++d)}}else if(u===o){o=!1;continue}}return r<t.length&&(n+=i(t.substr(r))),n},B.parseAttr=function(t,e){var i=0,n=0,r=[],s=!1,o=t.length;function a(t,i){if(!((t=(t=G.trim(t)).replace($,"").toLowerCase()).length<1)){var n=e(t,i||"");n&&r.push(n)}}for(var h=0;h<o;h++){var l,c=t.charAt(h);if(!1!==s||"="!==c)if(!1===s||h!==n){if(/\s|\n|\t/.test(c)){if(t=t.replace(/\s|\n|\t/g," "),!1===s){if(-1===(l=W(t,h))){a(G.trim(t.slice(i,h))),s=!1,i=h+1;continue}h=l-1;continue}if(-1===(l=Z(t,h-1))){a(s,Y(G.trim(t.slice(i,h)))),s=!1,i=h+1;continue}}}else{if(-1===(l=t.indexOf(c,h+1)))break;a(s,G.trim(t.slice(n+1,l))),s=!1,i=(h=l)+1}else s=t.slice(i,h),i=h+1,n='"'===t.charAt(i)||"'"===t.charAt(i)?i:q(t,h+1)}return i<t.length&&(!1===s?a(t.slice(i)):a(s,Y(G.trim(t.slice(i))))),G.trim(r.join(" "))};var X=m.FilterCSS,K=s,J=B,Q=J.parseTag,tt=J.parseAttr,et=y;function it(t){return null==t}function nt(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=K.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=function(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map((function(t){return t.toLowerCase()})):e[i.toLowerCase()]=t[i];return e}(t.whiteList||t.allowList):t.whiteList=K.whiteList,t.onTag=t.onTag||K.onTag,t.onTagAttr=t.onTagAttr||K.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||K.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||K.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||K.safeAttrValue,t.escapeHtml=t.escapeHtml||K.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new X(t.css))}nt.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onTag,r=e.onIgnoreTag,s=e.onTagAttr,o=e.onIgnoreTagAttr,a=e.safeAttrValue,h=e.escapeHtml,l=this.cssFilter;e.stripBlankChar&&(t=K.stripBlankChar(t)),e.allowCommentTag||(t=K.stripCommentTag(t));var c=!1;e.stripIgnoreTagBody&&(c=K.StripTagBody(e.stripIgnoreTagBody,r),r=c.onIgnoreTag);var u=Q(t,(function(t,e,c,u,d){var f={sourcePosition:t,position:e,isClosing:d,isWhite:Object.prototype.hasOwnProperty.call(i,c)},p=n(c,u,f);if(!it(p))return p;if(f.isWhite){if(f.isClosing)return"</"+c+">";var g=function(t){var e=et.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=et.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=et.trim(t.slice(0,-1))),{html:t,closing:i}}(u),v=i[c],m=tt(g.html,(function(t,e){var i=-1!==et.indexOf(v,t),n=s(c,t,e,i);return it(n)?i?(e=a(c,t,e,l))?t+'="'+e+'"':t:it(n=o(c,t,e,i))?void 0:n:n}));return u="<"+c,m&&(u+=" "+m),g.closing&&(u+=" /"),u+">"}return it(p=r(c,u,f))?h(u):p}),h);return c&&(u=c.remove(u)),u};var rt=nt;!function(t,e){var i=s,n=B,r=rt;function o(t,e){return new r(e).process(t)}(e=t.exports=o).filterXSS=o,e.FilterXSS=r,function(){for(var t in i)e[t]=i[t];for(var r in n)e[r]=n[r]}(),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=t.exports)}(r,r.exports);var st=r.exports,ot=function(){function t(t,e){var i,r=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=n(n({},st.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(t,e,i,n){return"a"===t&&"href"===e||("img"===t||"source"===t)&&"src"===e?r.sanitizeUrl(i):st.safeAttrValue(t,e,i,n)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"},t&&!e?i=t:t&&e?((i=Object.create(this.arcgisFilterOptions)).css={whiteList:this.arcgisCSSWhiteList},Object.keys(t).forEach((function(e){if("whiteList"===e)i.whiteList=r._extendObjectOfArrays([r.arcgisWhiteList,t.whiteList||{}]);else if("css"===e){var n=t.css.whiteList;null!=n&&t.css instanceof Object&&Object.keys(n).forEach((function(t){return i.css.whiteList[t]=n[t]}))}else i[e]=t[e]}))):((i=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,i.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=i,this._xssFilter=new st.FilterXSS(i)}return t.prototype.sanitize=function(t,e){switch(void 0===e&&(e={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&void 0===t)return;return null}},t.prototype.sanitizeUrl=function(t,e){var i=(null!=e?e:{}).isProtocolRequired,n=void 0===i||i,r=this._trim(t.substring(0,t.indexOf(":"))),s="/"===t,o=/^#/.test(t),a=r&&this.allowedProtocols.indexOf(r.toLowerCase())>-1;return s||o||a?st.escapeAttrValue(t):r||n?"":st.escapeAttrValue("https://".concat(t))},t.prototype.sanitizeHTMLAttribute=function(t,e,i,n){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(t,e,i,n):st.safeAttrValue(t,e,i,n)},t.prototype.validate=function(t,e){void 0===e&&(e={});var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}},t.prototype.encodeHTML=function(t){var e=this;return String(t).replace(/[&<>"'\/]/g,(function(t){return e._entityMap[t]}))},t.prototype.encodeAttrValue=function(t){var e=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,(function(i,n){return e.test(i)?i:"&#x".concat(Number(t.charCodeAt(n)).toString(16),";")}))},t.prototype._extendObjectOfArrays=function(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){Array.isArray(t[i])&&Array.isArray(e[i])?e[i]=e[i].concat(t[i]):e[i]=t[i]}))})),e},t.prototype._iterateOverObject=function(t,e){var i=this;void 0===e&&(e={});try{var n=!1,r=void 0;if(Array.isArray(t))r=t.reduce((function(t,r){var s=i.validate(r,e);return s.isValid?t.concat([r]):(n=!0,t.concat([s.sanitized]))}),[]);else{if(!function(t){if("object"!=typeof t||null===t)return!1;if("[object Object]"!==Object.prototype.toString.call(t))return!1;var e=Object.getPrototypeOf(t);if(null===e)return!0;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}(t)){if(e.allowUndefined&&void 0===t)return;return null}r=Object.keys(t).reduce((function(r,s){var o=t[s],a=i.validate(o,e);return a.isValid?r[s]=o:(n=!0,r[s]=a.sanitized),r}),{})}return n?r:t}catch(t){return null}},t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},t}(),at=i(14130),ht=(i(61226),i(58941),i(40633),i(60539)),lt=(i(28181),i(74087)),ct=i(15351);function ut(...t){const e=at.A.acquire();for(let i=0;i<t.length;i++){const n=t[i],r=typeof n;if("string"===r)e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if("object"===r)for(const t in n)n[t]&&e.push(t)}const i=e.join(" ");return at.A.release(e),i}function dt(t){const e=t?.closest("[dir]");return null!==e&&e instanceof HTMLElement&&"rtl"===e.dir||"rtl"===document.dir}function ft(t){this[t.getAttribute("data-node-ref")]=null}function pt(t){this[t.getAttribute("data-node-ref")]=t}(()=>{const t=new Map;new ResizeObserver((e=>{(0,ct.Sh)();for(const i of e)t.get(i.target)?.(i)}))})();const gt=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce(((t,e)=>(t[e]=[],t)),{}),vt=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],mt=new ot({whiteList:gt,onTagAttr:(t,e,i)=>{const n=`${e}="${i}"`;if(vt.includes(e))return n},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function yt(t){return"Enter"===t||" "===t}async function _t(t,e){await(0,lt.$m)((0,ht.Mq)(e));const i="function"==typeof t?t():t;i&&("setFocus"in i&&"function"==typeof i.setFocus?await i.setFocus():i instanceof HTMLElement&&i.focus())}}}]);
//# sourceMappingURL=views-3d-interactive-editingTools.js.map