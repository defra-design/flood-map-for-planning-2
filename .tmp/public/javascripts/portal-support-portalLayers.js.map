{"version":3,"file":"portal-support-portalLayers.js","mappings":"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","sources":["webpack://defra/./node_modules/@arcgis/core/layers/support/LayerLoadContext.js","webpack://defra/./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js","webpack://defra/./node_modules/@arcgis/core/layers/support/associatedFeatureServiceUtils.js","webpack://defra/./node_modules/@arcgis/core/layers/support/fetchService.js","webpack://defra/./node_modules/@arcgis/core/layers/support/lazyLayerLoader.js","webpack://defra/./node_modules/@arcgis/core/portal/PortalItem.js","webpack://defra/./node_modules/@arcgis/core/portal/PortalItemResource.js","webpack://defra/./node_modules/@arcgis/core/portal/PortalRating.js","webpack://defra/./node_modules/@arcgis/core/portal/support/loadUtils.js","webpack://defra/./node_modules/@arcgis/core/portal/support/portalItemUtils.js","webpack://defra/./node_modules/@arcgis/core/portal/support/portalLayers.js","webpack://defra/./node_modules/@arcgis/core/support/requestPresets.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as t}from\"../../support/requestPresets.js\";class e{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}async fetchServiceMetadata(e,a){const s=this._serviceMetadatas.get(e);if(s)return s;const r=await t(e,a);return this._serviceMetadatas.set(e,r),r}async fetchItemData(t){const{id:e}=t;if(!e)return null;const{_itemDatas:a}=this;if(a.has(e))return a.get(e);const s=await t.fetchData();return a.set(e,s),s}async fetchCustomParameters(t,e){const a=await this.fetchItemData(t);return a&&\"object\"==typeof a&&(e?e(a):a.customParameters)||null}}export{e as LayerLoadContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{urlToObject as e,getOrigin as r,removeTrailingSlash as t,removeQueryParameters as s,join as n,Url as l,makeAbsolute as i}from\"../../core/urlUtils.js\";import{w as u}from\"../../chunks/persistableUrlUtils.js\";const o={mapserver:\"MapServer\",imageserver:\"ImageServer\",featureserver:\"FeatureServer\",knowledgegraphserver:\"KnowledgeGraphServer\",sceneserver:\"SceneServer\",streamserver:\"StreamServer\",vectortileserver:\"VectorTileServer\",\"3dtilesserver\":\"3DTilesServer\",videoserver:\"VideoServer\"},a=Object.values(o),c=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/rest\\\\/services\\\\/(.+?)\\\\/(${a.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),v=new RegExp(`^((?:https?:)?\\\\/\\\\/\\\\S+?\\\\/([^/\\\\n]+)\\\\/(${a.join(\"|\")}))(?:\\\\/(?:layers\\\\/)?(\\\\d+))?`,\"i\"),f=/(.*?)\\/(?:layers\\/)?(\\d+)\\/?$/i;function p(e){return c.test(e)}function d(r){if(null==r)return null;const t=e(r),s=t?.path.match(c)||t?.path.match(v);if(!s)return null;const[,n,l,i,u]=s,a=l.indexOf(\"/\");return{title:m(-1!==a?l.slice(a+1):l),serverType:o[i.toLowerCase()],sublayer:null!=u&&\"\"!==u?parseInt(u,10):null,url:{path:n}}}function h(r){const t=e(r).path.match(f);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function m(e){return(e=e.replaceAll(/\\s*[/_]+\\s*/g,\" \"))[0].toUpperCase()+e.slice(1)}function w(e,r){const t=[];if(e){const r=d(e);null!=r&&r.title&&t.push(r.title)}if(r){const e=m(r);t.push(e)}if(2===t.length){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(\" - \")}function g(e){let t=r(e,!0);return!!t&&(t=t.toLowerCase(),t.endsWith(\".arcgis.com\")&&(t.startsWith(\"services\")||t.startsWith(\"tiles\")||t.startsWith(\"features\")))}function y(e,r){return e?t(s(e,r)):e}function S(r){let{url:n}=r;if(!n)return{url:n};n=s(n,r.logger);const l=e(n),i=d(l.path);let u;if(null!=i)null!=i.sublayer&&null==r.layer.layerId&&(u=i.sublayer),n=i.url.path;else if(r.nonStandardUrlAllowed){const e=h(l.path);null!=e&&(n=e.serviceUrl,u=e.sublayerId)}return{url:t(n),layerId:u}}function C(e,r,t,s,l){u(r,s,\"url\",l),s.url&&null!=e.layerId&&(s.url=n(s.url,t,e.layerId.toString()))}function b(e){if(!e)return!1;const r=e.toLowerCase(),t=r.includes(\"/services/\"),s=r.includes(\"/mapserver/wmsserver\"),n=r.includes(\"/imageserver/wmsserver\"),l=r.includes(\"/wmsserver\");return t&&(s||n||l)}function I(e){if(!e)return!1;const r=new l(i(e)),t=r.authority?.toLowerCase();return\"server.arcgisonline.com\"===t||\"services.arcgisonline.com\"===t}export{m as cleanTitle,p as isArcGISUrl,g as isHostedAgolService,I as isServerOrServicesAGOLUrl,b as isWmsServer,d as parse,h as parseNonStandardSublayerUrl,y as sanitizeUrl,S as sanitizeUrlWithLayerId,a as serverTypes,w as titleFromUrlAndName,C as writeUrlWithLayerId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{id as e}from\"../../kernel.js\";import r from\"../../request.js\";import t from\"../../core/Error.js\";import{throwIfAbortError as n}from\"../../core/promiseUtils.js\";import{parse as a}from\"./arcgisLayerUrl.js\";import o from\"../../portal/Portal.js\";import i from\"../../portal/PortalItem.js\";async function s(e,r){const n=a(e);if(!n)throw new t(\"invalid-url\",\"Invalid scene service url\");const o={...r,sceneServerUrl:n.url.path,layerId:n.sublayer??void 0};if(o.sceneLayerItem??=await l(o),null==o.sceneLayerItem)return f(o.sceneServerUrl.replace(\"/SceneServer\",\"/FeatureServer\"),o);const i=await y(o);if(!i?.url)throw new t(\"related-service-not-found\",\"Could not find feature service through portal item relationship\");o.featureServiceItem=i;const s=await f(i.url,o);return s.portalItem=i,s}async function l(e){const r=(await c(e)).serviceItemId;if(!r)return null;const t=new i({id:r,apiKey:e.apiKey}),a=await u(e);null!=a&&(t.portal=new o({url:a}));try{return await t.load({signal:e.signal})}catch(s){return n(s),null}}async function c(e){if(e.rootDocument)return e.rootDocument;const t={query:{f:\"json\",...e.customParameters,token:e.apiKey},responseType:\"json\",signal:e.signal};try{const n=await r(e.sceneServerUrl,t);e.rootDocument=n.data}catch{e.rootDocument={}}return e.rootDocument}async function u(t){const a=e?.findServerInfo(t.sceneServerUrl);if(a?.owningSystemUrl)return a.owningSystemUrl;const o=t.sceneServerUrl.replace(/(.*\\/rest)\\/.*/i,\"$1\")+\"/info\";try{const e=(await r(o,{query:{f:\"json\"},responseType:\"json\",signal:t.signal})).data.owningSystemUrl;if(e)return e}catch(i){n(i)}return null}async function f(e,n){const o=a(e);if(!o)throw new t(\"invalid-feature-service-url\",\"Invalid feature service url\");const i=o.url.path,s=n.layerId;if(null==s)return{serverUrl:i};const l=c(n),u=n.featureServiceItem?await n.featureServiceItem.fetchData(\"json\"):null,f=(u?.layers?.[0]||u?.tables?.[0])?.customParameters,y=e=>{const t={query:{f:\"json\",...f},responseType:\"json\",authMode:e,signal:n.signal};return r(i,t)},m=y(\"anonymous\").catch((()=>y(\"no-prompt\"))),[p,d]=await Promise.all([m,l]),v=d?.layers,w=p.data&&p.data.layers;if(!Array.isArray(w))throw new Error(\"expected layers array\");if(Array.isArray(v))for(let r=0;r<Math.min(v.length,w.length);r++){if(v[r].id===s)return{serverUrl:i,layerId:w[r].id}}else if(null!=s&&s<w.length)return{serverUrl:i,layerId:w[s].id};throw new Error(\"could not find matching associated sublayer\")}async function y({sceneLayerItem:e,signal:r}){if(!e)return null;try{const t=(await e.fetchRelatedItems({relationshipType:\"Service2Service\",direction:\"reverse\"},{signal:r})).find((e=>\"Feature Service\"===e.type))||null;if(!t)return null;const n=new i({portal:t.portal,id:t.id});return await n.load(),n}catch(t){return n(t),null}}export{s as findAssociatedFeatureService};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fetchArcGISServiceJSON as e}from\"../../support/requestPresets.js\";const a=new Set([\"Catalog Layer\",\"Feature Layer\",\"Oriented Imagery Layer\"]);async function t(a,t){const{loadContext:r,...n}=t||{},c=r?await r.fetchServiceMetadata(a,n):await e(a,n);o(c),s(c);const y={serviceJSON:c};if((c.currentVersion??0)<10.5)return y;const i=`${a}/layers`,u=r?await r.fetchServiceMetadata(i,n):await e(i,n);return o(u),s(u),y.layersJSON={layers:u.layers,tables:u.tables},y}function r(e){const{type:t}=e;return!!t&&a.has(t)}function n(e){return\"Table\"===e.type}function s(e){e.layers=e.layers?.filter(r),e.tables=e.tables?.filter(n)}function c(e){e.type||=\"Feature Layer\"}function y(e){e.type||=\"Table\"}function o(e){e.layers?.forEach(c),e.tables?.forEach(y)}function i(e){switch(e){case\"Feature Layer\":case\"Table\":return\"FeatureLayer\";case\"Oriented Imagery Layer\":return\"OrientedImageryLayer\";case\"Catalog Layer\":return\"CatalogLayer\"}return\"FeatureLayer\"}export{t as fetchFeatureService,i as getLayerModuleType};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst a={BingMapsLayer:async()=>(await import(/* webpackChunkName: \"BingMapsLayer\" */ \"../BingMapsLayer.js\")).default,BuildingSceneLayer:async()=>(await import(/* webpackChunkName: \"BuildingSceneLayer\" */ \"../BuildingSceneLayer.js\")).default,CSVLayer:async()=>(await import(/* webpackChunkName: \"CSVLayer\" */ \"../CSVLayer.js\")).default,CatalogLayer:async()=>(await import(/* webpackChunkName: \"CatalogLayer\" */ \"../CatalogLayer.js\")).default,DimensionLayer:async()=>(await import(/* webpackChunkName: \"DimensionLayer\" */ \"../DimensionLayer.js\")).default,ElevationLayer:async()=>(await import(/* webpackChunkName: \"ElevationLayer\" */ \"../ElevationLayer.js\")).default,FeatureLayer:async()=>(await import(/* webpackChunkName: \"FeatureLayer\" */ \"../FeatureLayer.js\")).default,GeoJSONLayer:async()=>(await import(/* webpackChunkName: \"GeoJSONLayer\" */ \"../GeoJSONLayer.js\")).default,GeoRSSLayer:async()=>(await import(/* webpackChunkName: \"GeoRSSLayer\" */ \"../GeoRSSLayer.js\")).default,GroupLayer:async()=>(await import(/* webpackChunkName: \"GroupLayer\" */ \"../GroupLayer.js\")).default,ImageryLayer:async()=>(await import(/* webpackChunkName: \"ImageryLayer\" */ \"../ImageryLayer.js\")).default,ImageryTileLayer:async()=>(await import(/* webpackChunkName: \"ImageryTileLayer\" */ \"../ImageryTileLayer.js\")).default,IntegratedMesh3DTilesLayer:async()=>(await import(/* webpackChunkName: \"IntegratedMesh3DTilesLayer\" */ \"../IntegratedMesh3DTilesLayer.js\")).default,IntegratedMeshLayer:async()=>(await import(/* webpackChunkName: \"IntegratedMeshLayer\" */ \"../IntegratedMeshLayer.js\")).default,KMLLayer:async()=>(await import(/* webpackChunkName: \"KMLLayer\" */ \"../KMLLayer.js\")).default,KnowledgeGraphLayer:async()=>(await import(/* webpackChunkName: \"KnowledgeGraphLayer\" */ \"../KnowledgeGraphLayer.js\")).default,LineOfSightLayer:async()=>(await import(/* webpackChunkName: \"LineOfSightLayer\" */ \"../LineOfSightLayer.js\")).default,LinkChartLayer:async()=>(await import(/* webpackChunkName: \"LinkChartLayer\" */ \"../LinkChartLayer.js\")).default,MapImageLayer:async()=>(await import(/* webpackChunkName: \"MapImageLayer\" */ \"../MapImageLayer.js\")).default,MapNotesLayer:async()=>(await import(/* webpackChunkName: \"MapNotesLayer\" */ \"../MapNotesLayer.js\")).default,MediaLayer:async()=>(await import(/* webpackChunkName: \"MediaLayer\" */ \"../MediaLayer.js\")).default,OGCFeatureLayer:async()=>(await import(/* webpackChunkName: \"OGCFeatureLayer\" */ \"../OGCFeatureLayer.js\")).default,OpenStreetMapLayer:async()=>(await import(/* webpackChunkName: \"OpenStreetMapLayer\" */ \"../OpenStreetMapLayer.js\")).default,OrientedImageryLayer:async()=>(await import(/* webpackChunkName: \"OrientedImageryLayer\" */ \"../OrientedImageryLayer.js\")).default,PointCloudLayer:async()=>(await import(/* webpackChunkName: \"PointCloudLayer\" */ \"../PointCloudLayer.js\")).default,RouteLayer:async()=>(await import(/* webpackChunkName: \"RouteLayer\" */ \"../RouteLayer.js\")).default,SceneLayer:async()=>(await import(/* webpackChunkName: \"SceneLayer\" */ \"../SceneLayer.js\")).default,StreamLayer:async()=>(await import(/* webpackChunkName: \"StreamLayer\" */ \"../StreamLayer.js\")).default,SubtypeGroupLayer:async()=>(await import(/* webpackChunkName: \"SubtypeGroupLayer\" */ \"../SubtypeGroupLayer.js\")).default,TileLayer:async()=>(await import(/* webpackChunkName: \"TileLayer\" */ \"../TileLayer.js\")).default,UnknownLayer:async()=>(await import(/* webpackChunkName: \"UnknownLayer\" */ \"../UnknownLayer.js\")).default,UnsupportedLayer:async()=>(await import(/* webpackChunkName: \"UnsupportedLayer\" */ \"../UnsupportedLayer.js\")).default,VectorTileLayer:async()=>(await import(/* webpackChunkName: \"VectorTileLayer\" */ \"../VectorTileLayer.js\")).default,VideoLayer:async()=>(await import(/* webpackChunkName: \"VideoLayer\" */ \"../VideoLayer.js\")).default,ViewshedLayer:async()=>(await import(/* webpackChunkName: \"ViewshedLayer\" */ \"../ViewshedLayer.js\")).default,VoxelLayer:async()=>(await import(/* webpackChunkName: \"VoxelLayer\" */ \"../VoxelLayer.js\")).default,WFSLayer:async()=>(await import(/* webpackChunkName: \"WFSLayer\" */ \"../WFSLayer.js\")).default,WMSLayer:async()=>(await import(/* webpackChunkName: \"WMSLayer\" */ \"../WMSLayer.js\")).default,WMTSLayer:async()=>(await import(/* webpackChunkName: \"WMTSLayer\" */ \"../WMTSLayer.js\")).default,WebTileLayer:async()=>(await import(/* webpackChunkName: \"WebTileLayer\" */ \"../WebTileLayer.js\")).default};export{a as layerLookupMap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import{getAssetUrl as t}from\"../assets.js\";import i from\"../core/Error.js\";import{JSONSupportMixin as r}from\"../core/JSONSupport.js\";import{clone as o,fixJson as s}from\"../core/lang.js\";import a from\"../core/Loadable.js\";import{isDataProtocol as n,makeAbsolute as l}from\"../core/urlUtils.js\";import{property as p}from\"../core/accessorSupport/decorators/property.js\";import{ensureClass as c}from\"../core/accessorSupport/ensureType.js\";import{reader as d}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as u}from\"../core/accessorSupport/decorators/subclass.js\";import m from\"../geometry/Extent.js\";import h from\"./Portal.js\";import g from\"./PortalItemResource.js\";import y from\"./PortalRating.js\";import{a as w}from\"../chunks/persistableUrlUtils.js\";var v;const f=new Set([\"3DTiles Service\",\"CSV\",\"Feature Collection\",\"Feature Service\",\"Feed\",\"GeoJson\",\"Group Layer\",\"Image Service\",\"KML\",\"Map Service\",\"Media Layer\",\"Scene Service\",\"Stream Service\",\"Vector Tile Service\",\"WFS\",\"WMS\",\"WMTS\"]),b=new Set([\"KML\",\"GeoJson\",\"CSV\"]);let k=v=class extends(r(a)){static from(e){return c(v,e)}constructor(e){super(e),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const e=this.type,t=this.typeKeywords||[];let i=e;return\"Feature Service\"===e||\"Feature Collection\"===e?i=t.includes(\"Table\")?\"Table\":t.includes(\"Route Layer\")?\"Route Layer\":t.includes(\"Markup\")?\"Markup\":\"Feature Layer\":\"Image Service\"===e?i=t.includes(\"Elevation 3D Layer\")?\"Elevation Layer\":t.includes(\"Tiled Imagery\")?\"Tiled Imagery Layer\":\"Imagery Layer\":\"Scene Service\"===e?i=\"Scene Layer\":\"Video Service\"===e?i=\"Video Layer\":\"Scene Package\"===e?i=\"Scene Layer Package\":\"Stream Service\"===e?i=\"Feature Layer\":\"Geoprocessing Service\"===e?i=t.includes(\"Web Tool\")?\"Tool\":\"Geoprocessing Service\":\"Geoenrichment Service\"===e?i=\"GeoEnrichment Service\":\"Geocoding Service\"===e?i=\"Locator\":\"Microsoft Powerpoint\"===e?i=\"Microsoft PowerPoint\":\"GeoJson\"===e?i=\"GeoJSON\":\"Globe Service\"===e?i=\"Globe Layer\":\"Vector Tile Service\"===e?i=\"Tile Layer\":\"netCDF\"===e?i=\"NetCDF\":\"Map Service\"===e?i=t.includes(\"Spatiotemporal\")||!t.includes(\"Hosted Service\")&&!t.includes(\"Tiled\")||t.includes(\"Relational\")?\"Map Image Layer\":\"Tile Layer\":e?.toLowerCase().includes(\"add in\")?i=e.replaceAll(/(add in)/gi,\"Add-In\"):\"datastore catalog service\"===e?i=\"Big Data File Share\":\"Compact Tile Package\"===e?i=\"Tile Package (tpkx)\":\"Raster function template\"===e?i=\"Raster Function Template\":\"OGCFeatureServer\"===e?i=\"OGC Feature Layer\":\"web mapping application\"===e&&t.includes(\"configurableApp\")?i=\"Instant App\":\"Insights Page\"===e?i=\"Insights Report\":\"Excalibur Imagery Project\"===e?i=\"Excalibur Project\":\"3DTiles Service\"===e?i=\"3D tiles layer\":\"3DTiles Package\"===e&&(i=\"3D tiles package\"),i}readExtent(e){return e&&e.length?new m(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){const e=this.type?.toLowerCase()||\"\",i=this.typeKeywords||[],r=\"esri/images/portal/\",o=\"16\";let s,a=!1,n=!1,l=!1,p=!1,c=!1,d=!1,u=!1,m=!1;return e.indexOf(\"service\")>0||\"feature collection\"===e||\"kml\"===e||\"wms\"===e||\"wmts\"===e||\"wfs\"===e?(a=i.includes(\"Hosted Service\"),\"feature service\"===e||\"feature collection\"===e||\"kml\"===e||\"wfs\"===e?(n=i.includes(\"Table\"),l=i.includes(\"Route Layer\"),p=i.includes(\"Markup\"),c=i.includes(\"Spatiotemporal\"),d=i.includes(\"UtilityNetwork\"),s=c&&n?\"spatiotemporaltable\":n?\"table\":l?\"routelayer\":p?\"markup\":c?\"spatiotemporal\":d?\"utilitynetwork\":a?\"featureshosted\":\"features\"):\"map service\"===e||\"wms\"===e||\"wmts\"===e?(c=i.includes(\"Spatiotemporal\"),u=i.includes(\"Relational\"),s=c||u?\"mapimages\":a||i.includes(\"Tiled\")||\"wmts\"===e?\"maptiles\":\"mapimages\"):s=\"scene service\"===e?i.includes(\"Line\")?\"sceneweblayerline\":i.includes(\"3DObject\")?\"sceneweblayermultipatch\":i.includes(\"Point\")?\"sceneweblayerpoint\":i.includes(\"IntegratedMesh\")?\"sceneweblayermesh\":i.includes(\"PointCloud\")?\"sceneweblayerpointcloud\":i.includes(\"Polygon\")?\"sceneweblayerpolygon\":i.includes(\"Building\")?\"sceneweblayerbuilding\":i.includes(\"Voxel\")?\"sceneweblayervoxel\":\"sceneweblayer\":\"image service\"===e?i.includes(\"Elevation 3D Layer\")?\"elevationlayer\":i.includes(\"Tiled Imagery\")?\"tiledimagerylayer\":\"imagery\":\"stream service\"===e?\"streamlayer\":\"vector tile service\"===e?\"vectortile\":\"datastore catalog service\"===e?\"datastorecollection\":\"geocoding service\"===e?\"geocodeservice\":\"video service\"===e?i.includes(\"Live Stream\")?\"livestreamvideolayer\":\"videolayer\":\"geoprocessing service\"===e?i.includes(\"Web Tool\")?\"tool\":\"layers\":\"geodata service\"===e?\"geodataservice\":\"3dtiles service\"===e?i.includes(\"3DObject\")?\"3dobjecttileslayer\":i.includes(\"IntegratedMesh\")?\"integratedmeshtileslayer\":\"3dtileslayer\":\"layers\"):\"web map\"===e||\"cityengine web scene\"===e?s=\"maps\":\"web scene\"===e?s=i.includes(\"ViewingMode-Local\")?\"webscenelocal\":\"websceneglobal\":\"web mapping application\"===e&&i.includes(\"configurableApp\")?s=\"instantapps\":\"web mapping application\"===e||\"mobile application\"===e||\"application\"===e||\"operation view\"===e||\"desktop application\"===e?s=\"apps\":\"map document\"===e||\"map package\"===e||\"published map\"===e||\"scene document\"===e||\"globe document\"===e||\"basemap package\"===e||\"mobile basemap package\"===e||\"mobile map package\"===e||\"project package\"===e||\"project template\"===e||\"pro map\"===e||\"layout\"===e||\"layer\"===e&&i.includes(\"ArcGIS Pro\")||\"explorer map\"===e&&i.indexOf(\"Explorer Document\")?s=\"mapsgray\":\"service definition\"===e||\"shapefile\"===e||\"cad drawing\"===e||\"geojson\"===e||\"netcdf\"===e||\"administrative report\"===e?s=\"datafiles\":\"360 vr experience\"===e?s=\"360vr\":\"explorer add in\"===e||\"desktop add in\"===e||\"windows viewer add in\"===e||\"windows viewer configuration\"===e?s=\"appsgray\":\"arcgis pro add in\"===e||\"arcgis pro configuration\"===e?s=\"addindesktop\":\"pdf\"===e?s=\"pdf\":\"microsoft word\"===e?s=\"word\":\"microsoft excel\"===e?s=\"excel\":\"microsoft powerpoint\"===e?s=\"ppt\":\"rule package\"===e||\"file geodatabase\"===e||\"sqlite geodatabase\"===e||\"csv collection\"===e||\"kml collection\"===e||\"windows mobile package\"===e||\"map template\"===e||\"desktop application template\"===e||\"gml\"===e||\"arcpad package\"===e||\"code sample\"===e||\"document link\"===e||\"earth configuration\"===e||\"operations dashboard add in\"===e||\"rules package\"===e||\"workflow manager package\"===e||\"explorer map\"===e&&i.includes(\"Explorer Mapping Application\")||i.includes(\"Document\")?s=\"datafilesgray\":\"network analysis service\"===e||\"geoprocessing service\"===e||\"geodata service\"===e||\"geometry service\"===e||\"geoprocessing package\"===e||\"locator package\"===e||\"geoprocessing sample\"===e||\"workflow manager service\"===e?s=\"toolsgray\":\"layer\"===e||\"layer package\"===e||\"explorer layer\"===e?s=\"layersgray\":\"analysis model\"===e?s=\"analysismodel\":\"scene package\"===e?s=\"scenepackage\":\"3dtiles package\"===e?s=\"3dtileslayerpackage\":\"3dtiles service\"===e?s=\"3dtileslayer\":\"mobile scene package\"===e?s=\"mobilescenepackage\":\"tile package\"===e||\"compact tile package\"===e?s=\"tilepackage\":\"task file\"===e?s=\"taskfile\":\"report template\"===e?s=\"report-template\":\"statistical data collection\"===e?s=\"statisticaldatacollection\":\"insights workbook\"===e?s=\"workbook\":\"insights model\"===e?s=\"insightsmodel\":\"insights page\"===e?s=\"insightspage\":\"insights theme\"===e?s=\"insightstheme\":\"hub initiative\"===e?s=\"hubinitiative\":\"hub page\"===e?s=\"hubpage\":\"hub site application\"===e?s=\"hubsite\":\"hub event\"===e?s=\"hubevent\":\"hub project\"===e?s=\"hubproject\":\"relational database connection\"===e?s=\"relationaldatabaseconnection\":\"big data file share\"===e?s=\"datastorecollection\":\"image collection\"===e?s=\"imagecollection\":\"desktop style\"===e?s=\"desktopstyle\":\"style\"===e?s=i.includes(\"Dictionary\")?\"dictionarystyle\":\"style\":\"dashboard\"===e?s=\"dashboard\":\"raster function template\"===e?s=\"rasterprocessingtemplate\":\"vector tile package\"===e?s=\"vectortilepackage\":\"ortho mapping project\"===e?s=\"orthomappingproject\":\"ortho mapping template\"===e?s=\"orthomappingtemplate\":\"solution\"===e?s=\"solutions\":\"geopackage\"===e?s=\"geopackage\":\"deep learning package\"===e?s=\"deeplearningpackage\":\"real time analytic\"===e?s=\"realtimeanalytics\":\"reality mapping project\"===e?s=\"realitymappingproject\":\"big data analytic\"===e?s=\"bigdataanalytics\":\"feed\"===e?s=\"feed\":\"excalibur imagery project\"===e?s=\"excaliburimageryproject\":\"notebook\"===e?s=\"notebook\":\"storymap\"===e?s=\"storymap\":\"survey123 add in\"===e?s=\"survey123addin\":\"mission\"===e?s=\"mission\":\"mission report\"===e?s=\"missionreport\":\"mission template\"===e?s=\"missiontemplate\":\"quickcapture project\"===e?s=\"quickcaptureproject\":\"pro report\"===e?s=\"proreport\":\"pro report template\"===e?s=\"proreporttemplate\":\"urban model\"===e?s=\"urbanmodel\":\"urban project\"===e?s=\"urbanproject\":\"web experience\"===e?s=\"experiencebuilder\":\"web experience template\"===e?s=\"webexperiencetemplate\":\"experience builder widget\"===e?s=\"experiencebuilderwidget\":\"experience builder widget package\"===e?s=\"experiencebuilderwidgetpackage\":\"workflow\"===e?s=\"workflow\":\"kernel gateway connection\"===e?s=\"kernelgatewayconnection\":\"insights script\"===e?s=\"insightsscript\":\"hub initiative template\"===e?s=\"hubinitiativetemplate\":\"storymap theme\"===e?s=\"storymaptheme\":\"knowledge graph\"===e?s=\"knowledgegraph\":\"knowledge graph layer\"===e?s=\"knowledgegraphlayer\":\"knowledge studio project\"===e?s=\"knowledgestudio\":\"native application\"===e?s=\"nativeapp\":\"native application installer\"===e?s=\"nativeappinstaller\":\"web link chart\"===e?s=\"linkchart\":\"knowledge graph web investigation\"===e?s=\"investigation\":\"ogcfeatureserver\"===e?s=\"features\":\"pro presentation\"===e?s=\"propresentation\":\"pro project\"===e?s=\"proproject\":\"insights workbook package\"===e?s=\"insightsworkbookpackage\":\"apache parquet\"===e?s=\"apacheparquet\":\"notebook code snippet library\"===e?s=\"notebookcodesnippets\":\"suitability model\"===e?s=\"suitabilitymodel\":\"esri classifier definition\"===e?s=\"classifierdefinition\":\"esri classification schema\"===e?s=\"classificationschema\":\"insights data engineering workbook\"===e?s=\"dataengineeringworkbook\":\"insights data engineering model\"===e?s=\"dataengineeringmodel\":\"deep learning studio project\"===e?s=\"deeplearningproject\":\"discussion\"===e?s=\"discussion\":\"allsource project\"===e?s=\"allsourceproject\":\"api key\"===e?s=\"apikey\":\"data pipeline\"===e?s=\"datapipelines\":\"group layer\"===e?(m=i.includes(\"Map\"),s=m?\"layergroup2d\":\"layergroup\"):s=\"media layer\"===e?\"onlinemedialayer\":\"form\"===e?i.includes(\"Survey123\")?\"survey\":\"datafilesgray\":\"csv\"===e?\"csv\":\"image\"===e?\"image\":\"maps\",s?t(r+s+o+\".png\"):null}get isLayer(){return null!=this.type&&f.has(this.type)}get itemCdnUrl(){return w(this.itemUrl)}get itemPageUrl(){const e=this.portal?.itemPageUrl;return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){const e=this.portal?.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){const e=this.itemUrl,t=this.thumbnail;return e&&t?this.portal?.normalizeUrl(`${e}/info/${t}?f=json`)??null:null}get userItemUrl(){const e=this.portal?.restUrl;if(!e)return null;const t=this.owner||this.portal?.user?.username;if(!t)return null;return`${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`}load(e){const t=this.portal??(this.portal=h.getDefault()),i=t.load(e).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?t.request(this.itemUrl,{signal:null!=e?e.signal:null,query:{token:this.apiKey}}):{})).then((e=>{this.sourceJSON=e,this.read(e)}));return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(e){const t={method:\"post\",query:{}};return e instanceof y&&(e=e.rating),null==e||isNaN(e)||\"number\"!=typeof e||(t.query.rating=e),this.portal?(await this.portal.request(this.itemUrl+\"/addRating\",t),new y({rating:e,created:new Date})):null}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:o(this.applicationProxies),avgRating:this.avgRating,categories:o(this.categories),classification:o(this.classification),created:o(this.created),culture:this.culture,description:this.description,extent:o(this.extent),groupCategories:o(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:o(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:o(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:o(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:o(this.typeKeywords),url:this.url};this.loaded&&(e.loadStatus=\"loaded\");const t=new v({sourceJSON:this.sourceJSON}).set(e);return t._set(\"isOrgItem\",this.isOrgItem),t}createPostQuery(){const e=this.toJSON();for(const t of[\"tags\",\"typeKeywords\",\"categories\"])e[t]=e[t]?.join(\", \");for(const t of[\"extent\",\"classification\"]){const i=e[t];i&&(e[t]=JSON.stringify(i))}return e}async deleteRating(){await this.portal.request(this.itemUrl+\"/deleteRating\",{method:\"post\"})}fetchData(e=\"json\",t){return this.portal.request(this.itemUrl+\"/data\",{responseType:e,...t,query:{token:this.apiKey}})}async fetchRating(e){const t=await this.portal.request(this.itemUrl+\"/rating\",{query:{token:this.apiKey},...e});return null!=t.rating?(t.created=new Date(t.created),new y(t)):null}fetchRelatedItems(e,t){return this.portal.requestToTypedArray(this.itemUrl+\"/relatedItems\",{query:{...e,token:this.apiKey},...t},v)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){return this.portal.request(this.itemUrl??\"\",{cacheBust:!0,query:{token:this.apiKey}}).then((e=>(this.applicationProxies&&!Object.hasOwn(e,\"appProxies\")&&(this.applicationProxies=null),this.sourceJSON=e,this.read(e),this)))}update(e){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const t=e?.data,i={method:\"post\"};i.query=this.createPostQuery();for(const e in i.query)null===i.query[e]&&(i.query[e]=\"\");return i.query.clearEmptyFields=!0,null!=t&&(\"string\"==typeof t?i.query.text=t:\"object\"==typeof t&&(i.query.text=JSON.stringify(t))),this.portal.request(`${this.userItemUrl}/update`,i).then((()=>this.reload()))})):Promise.reject(new i(\"portal:item-does-not-exist\",\"The item does not exist yet and cannot be updated\"))}async copy(e){if(!this.id)throw new i(\"portal:item-does-not-exist\",\"The item does not exist yet\");await this.load();const{portal:t,itemUrl:r}=this;await t.signIn();const{copyResources:o,folder:s,tags:a,title:n}=e||{},l={method:\"post\",query:{copyPrivateResources:\"all\"===o,folder:\"string\"==typeof s?s:s?.id,includeResources:!!o,tags:a?.join(\",\"),title:n}},{itemId:p}=await t.request(`${r}/copy`,l);return new v({id:p,portal:t})}updateThumbnail(e){return this.id?this.load().then((()=>this.portal.signIn())).then((()=>{const t=e.thumbnail,i=e.filename,r={method:\"post\"};if(\"string\"==typeof t)n(t)?r.query={data:t}:r.query={url:l(t)},null!=i&&(r.query.filename=i);else{const e=new FormData;null!=i?e.append(\"file\",t,i):e.append(\"file\",t),r.body=e}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,r).then((()=>this.reload()))})):Promise.reject(new i(\"portal:item-does-not-exist\",\"The item does not exist yet and cannot be updated\"))}async fetchResources(e={},t){const{fetchResources:i}=await import(/* webpackChunkName: \"support-resourceUtils\" */ \"./support/resourceUtils.js\");return i(this,e,t)}async addResource(e,t,i){const{addOrUpdateResources:r}=await import(/* webpackChunkName: \"support-resourceUtils\" */ \"./support/resourceUtils.js\");return e.portalItem=this,await r(this,[{resource:e,content:t,compress:i?.compress,access:i?.access}],\"add\",i),e}async removeResource(e,t){const{removeResource:r}=await import(/* webpackChunkName: \"support-resourceUtils\" */ \"./support/resourceUtils.js\");if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new i(\"removeresource:portal-item-mismatch\",\"The portal item associated with the provided resource does not match the item\");return r(this,e,t)}async removeAllResources(e){const{removeAllResources:t}=await import(/* webpackChunkName: \"support-resourceUtils\" */ \"./support/resourceUtils.js\");return t(this,e)}resourceFromPath(e){return new g({portalItem:this,path:e})}toJSON(){const e=this.extent,t={accessInformation:this.accessInformation,categories:o(this.categories),classification:o(this.classification),created:this.created?.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:this.modified?.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:o(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:o(this.typeKeywords),url:this.url};return s(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error(\"JSON object is already hydrated\");return new v({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)\"tags\"===t&&null!==e[t]&&(e[t]=e[t].join(\", \")),\"typeKeywords\"===t&&null!==e[t]&&(e[t]=e[t].join(\", \")),\"extent\"===t&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};e([p({type:[\"private\",\"shared\",\"org\",\"public\"]})],k.prototype,\"access\",void 0),e([p()],k.prototype,\"accessInformation\",void 0),e([p({type:String})],k.prototype,\"apiKey\",void 0),e([p({json:{read:{source:\"appProxies\"}}})],k.prototype,\"applicationProxies\",void 0),e([p()],k.prototype,\"avgRating\",void 0),e([p()],k.prototype,\"categories\",void 0),e([p()],k.prototype,\"classification\",void 0),e([p({type:Date})],k.prototype,\"created\",void 0),e([p()],k.prototype,\"culture\",void 0),e([p()],k.prototype,\"description\",void 0),e([p({readOnly:!0})],k.prototype,\"displayName\",null),e([p({type:m})],k.prototype,\"extent\",void 0),e([d(\"extent\")],k.prototype,\"readExtent\",null),e([p()],k.prototype,\"groupCategories\",void 0),e([p({readOnly:!0})],k.prototype,\"iconUrl\",null),e([p()],k.prototype,\"id\",void 0),e([p({readOnly:!0})],k.prototype,\"isLayer\",null),e([p({type:Boolean,readOnly:!0})],k.prototype,\"isOrgItem\",void 0),e([p()],k.prototype,\"itemControl\",void 0),e([p({readOnly:!0})],k.prototype,\"itemPageUrl\",null),e([p({readOnly:!0})],k.prototype,\"itemUrl\",null),e([p()],k.prototype,\"licenseInfo\",void 0),e([p({type:Date})],k.prototype,\"modified\",void 0),e([p()],k.prototype,\"name\",void 0),e([p()],k.prototype,\"numComments\",void 0),e([p()],k.prototype,\"numRatings\",void 0),e([p()],k.prototype,\"numViews\",void 0),e([p()],k.prototype,\"owner\",void 0),e([p()],k.prototype,\"ownerFolder\",void 0),e([p({type:h})],k.prototype,\"portal\",void 0),e([p()],k.prototype,\"screenshots\",void 0),e([p()],k.prototype,\"size\",void 0),e([p()],k.prototype,\"snippet\",void 0),e([p()],k.prototype,\"sourceJSON\",void 0),e([p({type:String})],k.prototype,\"sourceUrl\",void 0),e([p({type:String})],k.prototype,\"spatialReference\",void 0),e([p()],k.prototype,\"tags\",void 0),e([p()],k.prototype,\"thumbnail\",void 0),e([p({readOnly:!0})],k.prototype,\"thumbnailUrl\",null),e([p()],k.prototype,\"title\",void 0),e([p()],k.prototype,\"type\",void 0),e([p()],k.prototype,\"typeKeywords\",void 0),e([p({type:String,json:{read(e,t){if(b.has(t.type)){const t=this.portal?.restUrl;e||=t&&this.id?`${t}/content/items/${this.id}/data`:null}return e}}})],k.prototype,\"url\",void 0),e([p({readOnly:!0})],k.prototype,\"userItemUrl\",null),k=v=e([u(\"esri.portal.PortalItem\")],k);const S=k;export{S as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../chunks/tslib.es6.js\";import r from\"../core/Accessor.js\";import e from\"../core/Error.js\";import o from\"../core/Logger.js\";import{isAbsolute as s,makeRelative as a}from\"../core/urlUtils.js\";import{property as l}from\"../core/accessorSupport/decorators/property.js\";import{cast as p}from\"../core/accessorSupport/decorators/cast.js\";import\"../core/RandomLCG.js\";import\"../core/has.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";let c=class extends r{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t?.portalItem&&t.path?{...t,path:n(t.path,t.portalItem)}:t}set path(t){null!=t&&s(t)?o.getLogger(this).error(\"portalitemresource:invalid-path\",\"A portal item resource path must be relative\"):this._set(\"path\",t)}_castPath(t){return n(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t=\"json\",r){const o=this.cdnUrl;if(null==o)throw new e(\"portal-item-resource:fetch\",\"Portal item resource does not refer to a valid item or path\");return this.portalItem.portal.request(o,{responseType:t,query:{token:this.portalItem.apiKey,_ts:r?.cacheBust?Date.now():null},signal:r?.signal})}async update(t,r){const{addOrUpdateResources:e}=await import(/* webpackChunkName: \"support-resourceUtils\" */ \"./support/resourceUtils.js\");return await e(this.portalItem,[{resource:this,content:t,compress:r?.compress,access:r?.access}],\"update\",r),this}hasPath(){return null!=this.path}};function n(t,r){return null==t?t:(t=t.replace(/^\\/+/,\"\"),null!=r&&s(t)&&(t=a(t,r.itemUrl)),t?.replace(/^\\/+/,\"\").replace(/^(\\.\\/)?resources\\//,\"\"))}t([l()],c.prototype,\"portalItem\",void 0),t([l({type:String,value:null})],c.prototype,\"path\",null),t([p(\"path\")],c.prototype,\"_castPath\",null),t([l({type:String,readOnly:!0})],c.prototype,\"url\",null),t([l({type:String,readOnly:!0})],c.prototype,\"cdnUrl\",null),t([l({type:String,readOnly:!0})],c.prototype,\"itemRelativeUrl\",null),c=t([i(\"esri.portal.PortalItemResource\")],c);const u=c;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../chunks/tslib.es6.js\";import o from\"../core/Accessor.js\";import{property as s}from\"../core/accessorSupport/decorators/property.js\";import\"../core/has.js\";import\"../core/Logger.js\";import\"../core/RandomLCG.js\";import{subclass as t}from\"../core/accessorSupport/decorators/subclass.js\";let e=class extends o{constructor(r){super(r),this.created=null,this.rating=null}};r([s()],e.prototype,\"created\",void 0),r([s()],e.prototype,\"rating\",void 0),e=r([t(\"esri.portal.PortalRating\")],e);const c=e;export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{findAssociatedFeatureService as e}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";function t(e){const t={id:e.id,name:e.name},a=r(e.type);return\"FeatureLayer\"!==a&&(t.layerType=a),t}async function a(e,r,a){if(null==e?.layers||null==e?.tables){const s=await a.fetchServiceMetadata(r,{customParameters:l(e)?.customParameters});(e=e||{}).layers=e.layers||s?.layers?.map(t),e.tables=e.tables||s?.tables?.map(t)}return e}function l(e){if(!e)return null;const{layers:r,tables:t}=e;return r?.length?r[0]:t?.length?t[0]:null}function s(e,r){if(null==r)return null;return[...e.layers||[],...e.tables||[]].find((e=>e.id===r))}function n(e,r){return[...e.layers||[],...e.tables||[]].filter((({layerType:e})=>e?e===r:\"ArcGISFeatureLayer\"===r))}function u(e){return(e?.layers?.length??0)+(e?.tables?.length??0)}function c(e){switch(e){case\"catalog\":return\"CatalogLayer\";case\"feature\":return\"ArcGISFeatureLayer\";case\"oriented-imagery\":return\"OrientedImageryLayer\";case\"subtype-group\":return\"SubtypeGroupLayer\"}return null}function i(e){switch(e){case\"CatalogLayer\":return\"CatalogLayer\";case\"OrientedImageryLayer\":return\"OrientedImageryLayer\";case\"SubtypeGroupLayer\":return\"SubtypeGroupLayer\"}return\"FeatureLayer\"}async function o(r,a,s){if(!r?.url)return a??{};if(a??={},!a.layers){const e=await s.fetchServiceMetadata(r.url);a.layers=e.layers?.map(t)}const{serverUrl:n,portalItem:u}=await e(r.url,{sceneLayerItem:r,customParameters:l(a)?.customParameters}).catch((()=>({serverUrl:null,portalItem:null})));if(null==n)return a.tables=[],a;if(!a.tables&&u){const e=await u.fetchData().catch((()=>null));if(e?.tables)a.tables=e.tables.map(t);else{const r=await s.fetchServiceMetadata(n,{customParameters:l(e)?.customParameters}).catch((()=>null));a.tables=r?.tables?.map(t)}}if(a.tables)for(const e of a.tables)e.url=`${n}/${e.id}`;return a}export{t as createSublayerData,l as getFirstLayerOrTable,s as getLayerOrTable,u as getNumLayersAndTables,n as getSublayersByLayerType,c as instanceTypeToLayerType,i as layerTypeToLayerModuleType,o as populateSceneServiceItemData,a as preprocessFSItemData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{initializeProjection as e,project as t}from\"../../geometry/projection.js\";import r from\"../../geometry/SpatialReference.js\";import{webMercatorToGeographic as n}from\"../../geometry/support/webMercatorUtils.js\";async function o(o){const i=o.spatialReference;if(i.isWGS84)return o.clone();if(i.isWebMercator)return n(o);const s=r.WGS84;return await e(i,s),t(o,s)}function i(e,t){if(!s(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function s(e,t){return!!e.typeKeywords?.includes(t)}function c(e){return s(e,f.HOSTED_SERVICE)}function a(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}function u(e,t,r){r?i(e,t):a(e,t)}async function l(e){const t=e.clone().normalize();let r;if(t.length>1)for(const n of t)r?n.width>r.width&&(r=n):r=n;else r=t[0];return o(r)}const f={DEVELOPER_BASEMAP:\"DeveloperBasemap\",JSAPI:\"ArcGIS API for JavaScript\",METADATA:\"Metadata\",MULTI_LAYER:\"Multilayer\",SINGLE_LAYER:\"Singlelayer\",TABLE:\"Table\",HOSTED_SERVICE:\"Hosted Service\",LOCAL_SCENE:\"ViewingMode-Local\",TILED_IMAGERY:\"Tiled Imagery\",GROUP_LAYER_MAP:\"Map\",ORIENTED_IMAGERY_LAYER:\"OrientedImageryLayer\"};function E(e){const{portal:t,isOrgItem:r,itemControl:n}=e,o=t.user?.privileges;let i=!o||o.includes(\"features:user:edit\"),s=!!r&&!!o?.includes(\"features:user:fullEdit\");const c=\"update\"===n||\"admin\"===n;return c?s=i=!0:s&&(i=!0),{features:{edit:i,fullEdit:s},content:{updateItem:c}}}export{i as addTypeKeyword,E as getUserPrivileges,l as getWGS84ExtentForItem,s as hasTypeKeyword,c as isHostedLayer,a as removeTypeKeyword,u as toggleTypeKeyword,f as typeKeyword};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{findAssociatedFeatureService as a}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";import{LayerLoadContext as t}from\"../../layers/support/LayerLoadContext.js\";import{sceneServiceLayerTypeToClassName as s}from\"../../layers/support/layerUtils.js\";import{layerLookupMap as c}from\"../../layers/support/lazyLayerLoader.js\";import n from\"../PortalItem.js\";import{getFirstLayerOrTable as o,getNumLayersAndTables as i,preprocessFSItemData as u,getLayerOrTable as l,layerTypeToLayerModuleType as m,populateSceneServiceItemData as y}from\"./loadUtils.js\";import{hasTypeKeyword as f}from\"./portalItemUtils.js\";async function p(e){let{portalItem:a}=e;!a||a instanceof n||(a=new n(a));const r=await d(a);return new(0,r.constructor)({portalItem:a,...r.properties})}async function d(e){await e.load();const a=new t;return w(await L(e,a))}async function L(a,r){switch(a.type){case\"3DTiles Service\":return j();case\"CSV\":return C();case\"Feature Collection\":return v(a);case\"Feature Service\":return S(a,r);case\"Feed\":return U();case\"GeoJson\":return T();case\"Group Layer\":return V();case\"Image Service\":return I(a,r);case\"KML\":return G();case\"Knowledge Graph Layer\":return P();case\"Map Service\":return N(a,r);case\"Media Layer\":return W();case\"Scene Service\":return h(a,r);case\"Stream Service\":return M();case\"Vector Tile Service\":return g();case\"WFS\":return F();case\"WMS\":return b();case\"WMTS\":return K();default:throw new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:a.type})}}async function w(e){const a=e.className,r=c[a];return{constructor:await r(),properties:e.properties}}async function N(e,a){return await x(e,a)?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}}async function S(e,a){const r=await D(e,a);if(\"object\"==typeof r){const{sourceJSON:e,className:a}=r,t={sourceJSON:e};return null!=r.id&&(t.layerId=r.id),{className:a||\"FeatureLayer\",properties:t}}return{className:\"GroupLayer\"}}async function h(e,r){const t=await D(e,r,(async()=>{try{if(!e.url)return[];const{serverUrl:t}=await a(e.url,{sceneLayerItem:e}),s=await r.fetchServiceMetadata(t);return s?.tables??[]}catch{return[]}}));if(\"object\"==typeof t){const a={};let c;if(null!=t.id?(a.layerId=t.id,c=`${e.url}/layers/${t.id}`):c=e.url,e.typeKeywords?.length)for(const r of Object.keys(s))if(e.typeKeywords.includes(r))return{className:s[r]};const n=await r.fetchServiceMetadata(c,{customParameters:await r.fetchCustomParameters(e,(e=>o(e)?.customParameters))});return{className:s[n?.layerType]||\"SceneLayer\",properties:a}}if(!1===t){const a=await r.fetchServiceMetadata(e.url);if(\"Voxel\"===a?.layerType)return{className:\"VoxelLayer\"}}return{className:\"GroupLayer\"}}async function v(e){await e.load();const a=f(e,\"Map Notes\"),r=f(e,\"Markup\");if(a||r)return{className:\"MapNotesLayer\"};if(f(e,\"Route Layer\"))return{className:\"RouteLayer\"};const t=await e.fetchData();return 1===i(t)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function I(e,a){await e.load();const r=e.typeKeywords?.map((e=>e.toLowerCase()))??[];if(r.includes(\"elevation 3d layer\"))return{className:\"ElevationLayer\"};if(r.includes(\"tiled imagery\"))return{className:\"ImageryTileLayer\"};const t=await a.fetchItemData(e),s=t?.layerType;if(\"ArcGISTiledImageServiceLayer\"===s)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===s)return{className:\"ImageryLayer\"};const c=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)}),n=c.cacheType?.toLowerCase(),o=c.capabilities?.toLowerCase().includes(\"tilesonly\"),i=c.tileInfo?.format?.toLowerCase()??\"\",u=null==n&&[\"jpg\",\"jpeg\",\"png\",\"png8\",\"png24\",\"png32\",\"mixed\"].includes(i);return\"map\"===n||u||o?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function M(){return{className:\"StreamLayer\"}}function g(){return{className:\"VectorTileLayer\"}}function T(){return{className:\"GeoJSONLayer\"}}function j(){return{className:\"IntegratedMesh3DTilesLayer\"}}function C(){return{className:\"CSVLayer\"}}function G(){return{className:\"KMLLayer\"}}function P(){return{className:\"KnowledgeGraphLayer\"}}function F(){return{className:\"WFSLayer\"}}function b(){return{className:\"WMSLayer\"}}function K(){return{className:\"WMTSLayer\"}}function U(){return{className:\"StreamLayer\"}}function V(){return{className:\"GroupLayer\"}}function W(){return{className:\"MediaLayer\"}}async function x(e,a){const{tileInfo:r}=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)});return r}async function D(e,a,t){const{url:s,type:c}=e,n=\"Feature Service\"===c;if(!s)return{};if(/\\/\\d+$/.test(s)){if(n){const t=await a.fetchServiceMetadata(s,{customParameters:await a.fetchCustomParameters(e,(e=>o(e)?.customParameters))});return{id:t.id,className:r(t.type),sourceJSON:t}}return{}}await e.load();let f=await a.fetchItemData(e);if(n){const e=await u(f,s,a),r=J(e);if(\"object\"==typeof r){const a=l(e,r.id);r.className=m(a?.layerType)}return r}\"Scene Service\"===c&&(f=await y(e,f,a));if(i(f)>0)return J(f);const p=await a.fetchServiceMetadata(s);return t&&(p.tables=await t()),J(p)}function J(e){return 1===i(e)&&{id:o(e)?.id}}export{p as fromItem,L as selectLayerClassPath};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../request.js\";async function t(t,o){const{data:r}=await e(t,{responseType:\"json\",query:{f:\"json\",...o?.customParameters,token:o?.apiKey}});return r}export{t as fetchArcGISServiceJSON};\n"],"names":[],"sourceRoot":""}