"use strict";(self.webpackChunkdefra=self.webpackChunkdefra||[]).push([[6221],{90735:function(t,e,n){n.d(e,{J:function(){return i}});var r,o=n(32150),s={exports:{}};const i=(0,o.g)(function(){return r||(r=1,t=s,e=function(){var t=function(){function t(t){this.message="JPEG error: "+t}return t.prototype=new Error,t.prototype.name="JpegError",t.constructor=t,t}();return function(){if(!self||!self.Uint8ClampedArray)return null;var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),n=4017,r=799,o=3406,s=2276,i=1567,a=3784,l=5793,u=2896;function c(){this.decodeTransform=null,this.colorTransform=-1}function h(t,e){for(var n,r,o=0,s=[],i=16;i>0&&!t[i-1];)i--;s.push({children:[],index:0});var a,l=s[0];for(n=0;n<i;n++){for(r=0;r<t[n];r++){for((l=s.pop()).children[l.index]=e[o];l.index>0;)l=s.pop();for(l.index++,s.push(l);s.length<=n;)s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a;o++}n+1<i&&(s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a)}return s[0].children}function p(t,e,n){return 64*((t.blocksPerLine+1)*e+n)}function f(n,r,o,s,i,a,l,u,c){var h=o.mcusPerLine,f=o.progressive,d=r,m=0,y=0;function x(){if(y>0)return y--,m>>y&1;if(255===(m=n[r++])){var e=n[r++];if(e)throw new t("unexpected marker "+(m<<8|e).toString(16))}return y=7,m>>>7}function w(e){for(var n=e;;){if("number"==typeof(n=n[x()]))return n;if("object"!=typeof n)throw new t("invalid huffman sequence")}}function b(t){for(var e=0;t>0;)e=e<<1|x(),t--;return e}function v(t){if(1===t)return 1===x()?1:-1;var e=b(t);return e>=1<<t-1?e:e+(-1<<t)+1}var A,M=0,C=0;function k(t,e,n,r,o){var s=n%h;e(t,p(t,(n/h|0)*t.v+r,s*t.h+o))}function T(t,e,n){e(t,p(t,n/t.blocksPerLine|0,n%t.blocksPerLine))}var P,S,_,I,R,N,F=s.length;N=f?0===a?0===u?function(t,e){var n=w(t.huffmanTableDC),r=0===n?0:v(n)<<c;t.blockData[e]=t.pred+=r}:function(t,e){t.blockData[e]|=x()<<c}:0===u?function(t,n){if(M>0)M--;else for(var r=a,o=l;r<=o;){var s=w(t.huffmanTableAC),i=15&s,u=s>>4;if(0!==i){var h=e[r+=u];t.blockData[n+h]=v(i)*(1<<c),r++}else{if(u<15){M=b(u)+(1<<u)-1;break}r+=16}}}:function(n,r){for(var o,s,i=a,u=l,h=0;i<=u;){var p=e[i];switch(C){case 0:if(h=(s=w(n.huffmanTableAC))>>4,0==(o=15&s))h<15?(M=b(h)+(1<<h),C=4):(h=16,C=1);else{if(1!==o)throw new t("invalid ACn encoding");A=v(o),C=h?2:3}continue;case 1:case 2:n.blockData[r+p]?n.blockData[r+p]+=x()<<c:0==--h&&(C=2===C?3:0);break;case 3:n.blockData[r+p]?n.blockData[r+p]+=x()<<c:(n.blockData[r+p]=A<<c,C=0);break;case 4:n.blockData[r+p]&&(n.blockData[r+p]+=x()<<c)}i++}4===C&&0==--M&&(C=0)}:function(t,n){var r=w(t.huffmanTableDC),o=0===r?0:v(r);t.blockData[n]=t.pred+=o;for(var s=1;s<64;){var i=w(t.huffmanTableAC),a=15&i,l=i>>4;if(0!==a){var u=e[s+=l];t.blockData[n+u]=v(a),s++}else{if(l<15)break;s+=16}}};var E,B,O,G,D=0;for(B=1===F?s[0].blocksPerLine*s[0].blocksPerColumn:h*o.mcusPerColumn;D<B;){var L=i?Math.min(B-D,i):B;for(S=0;S<F;S++)s[S].pred=0;if(M=0,1===F)for(P=s[0],R=0;R<L;R++)T(P,N,D),D++;else for(R=0;R<L;R++){for(S=0;S<F;S++)for(O=(P=s[S]).h,G=P.v,_=0;_<G;_++)for(I=0;I<O;I++)k(P,N,D,_,I);D++}y=0,(E=g(n,r))&&E.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+E.invalid),r=E.offset);var U=E&&E.marker;if(!U||U<=65280)throw new t("marker was not found");if(!(U>=65488&&U<=65495))break;r+=2}return(E=g(n,r))&&E.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+E.invalid),r=E.offset),r-d}function d(e,c,h){var p,f,d,m,g,y,x,w,b,v,A,M,C,k,T,P,S,_=e.quantizationTable,I=e.blockData;if(!_)throw new t("missing required Quantization Table.");for(var R=0;R<64;R+=8)b=I[c+R],v=I[c+R+1],A=I[c+R+2],M=I[c+R+3],C=I[c+R+4],k=I[c+R+5],T=I[c+R+6],P=I[c+R+7],b*=_[R],v|A|M|C|k|T|P?(v*=_[R+1],A*=_[R+2],M*=_[R+3],C*=_[R+4],k*=_[R+5],T*=_[R+6],P*=_[R+7],f=(p=(p=l*b+128>>8)+(f=l*C+128>>8)+1>>1)-f,S=(d=A)*a+(m=T)*i+128>>8,d=d*i-m*a+128>>8,x=(g=(g=u*(v-P)+128>>8)+(x=k<<4)+1>>1)-x,y=(w=(w=u*(v+P)+128>>8)+(y=M<<4)+1>>1)-y,m=(p=p+(m=S)+1>>1)-m,d=(f=f+d+1>>1)-d,S=g*s+w*o+2048>>12,g=g*o-w*s+2048>>12,w=S,S=y*r+x*n+2048>>12,y=y*n-x*r+2048>>12,x=S,h[R]=p+w,h[R+7]=p-w,h[R+1]=f+x,h[R+6]=f-x,h[R+2]=d+y,h[R+5]=d-y,h[R+3]=m+g,h[R+4]=m-g):(S=l*b+512>>10,h[R]=S,h[R+1]=S,h[R+2]=S,h[R+3]=S,h[R+4]=S,h[R+5]=S,h[R+6]=S,h[R+7]=S);for(var N=0;N<8;++N)b=h[N],(v=h[N+8])|(A=h[N+16])|(M=h[N+24])|(C=h[N+32])|(k=h[N+40])|(T=h[N+48])|(P=h[N+56])?(f=(p=4112+((p=l*b+2048>>12)+(f=l*C+2048>>12)+1>>1))-f,S=(d=A)*a+(m=T)*i+2048>>12,d=d*i-m*a+2048>>12,m=S,x=(g=(g=u*(v-P)+2048>>12)+(x=k)+1>>1)-x,y=(w=(w=u*(v+P)+2048>>12)+(y=M)+1>>1)-y,S=g*s+w*o+2048>>12,g=g*o-w*s+2048>>12,w=S,S=y*r+x*n+2048>>12,y=y*n-x*r+2048>>12,b=(b=(p=p+m+1>>1)+w)<16?0:b>=4080?255:b>>4,v=(v=(f=f+d+1>>1)+(x=S))<16?0:v>=4080?255:v>>4,A=(A=(d=f-d)+y)<16?0:A>=4080?255:A>>4,M=(M=(m=p-m)+g)<16?0:M>=4080?255:M>>4,C=(C=m-g)<16?0:C>=4080?255:C>>4,k=(k=d-y)<16?0:k>=4080?255:k>>4,T=(T=f-x)<16?0:T>=4080?255:T>>4,P=(P=p-w)<16?0:P>=4080?255:P>>4,I[c+N]=b,I[c+N+8]=v,I[c+N+16]=A,I[c+N+24]=M,I[c+N+32]=C,I[c+N+40]=k,I[c+N+48]=T,I[c+N+56]=P):(S=(S=l*b+8192>>14)<-2040?0:S>=2024?255:S+2056>>4,I[c+N]=S,I[c+N+8]=S,I[c+N+16]=S,I[c+N+24]=S,I[c+N+32]=S,I[c+N+40]=S,I[c+N+48]=S,I[c+N+56]=S)}function m(t,e){for(var n=e.blocksPerLine,r=e.blocksPerColumn,o=new Int16Array(64),s=0;s<r;s++)for(var i=0;i<n;i++)d(e,p(e,s,i),o);return e.blockData}function g(t,e,n){function r(e){return t[e]<<8|t[e+1]}var o=t.length-1,s=n<e?n:e;if(e>=o)return null;var i=r(e);if(i>=65472&&i<=65534)return{invalid:null,marker:i,offset:e};for(var a=r(s);!(a>=65472&&a<=65534);){if(++s>=o)return null;a=r(s)}return{invalid:i.toString(16),marker:a,offset:s}}return c.prototype={parse:function(n){function r(){var t=n[l]<<8|n[l+1];return l+=2,t}function o(){var t=r(),e=l+t-2,o=g(n,e,l);o&&o.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+o.invalid),e=o.offset);var s=n.subarray(l,e);return l+=s.length,s}function s(t){for(var e=Math.ceil(t.samplesPerLine/8/t.maxH),n=Math.ceil(t.scanLines/8/t.maxV),r=0;r<t.components.length;r++){D=t.components[r];var o=Math.ceil(Math.ceil(t.samplesPerLine/8)*D.h/t.maxH),s=Math.ceil(Math.ceil(t.scanLines/8)*D.v/t.maxV),i=e*D.h,a=n*D.v*64*(i+1);D.blockData=new Int16Array(a),D.blocksPerLine=o,D.blocksPerColumn=s}t.mcusPerLine=e,t.mcusPerColumn=n}var i,a,l=0,u=null,c=null,p=[],d=[],y=[],x=r();if(65496!==x)throw new t("SOI not found");for(x=r();65497!==x;){var w,b,v;switch(x){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var A=o();65504===x&&74===A[0]&&70===A[1]&&73===A[2]&&70===A[3]&&0===A[4]&&(u={version:{major:A[5],minor:A[6]},densityUnits:A[7],xDensity:A[8]<<8|A[9],yDensity:A[10]<<8|A[11],thumbWidth:A[12],thumbHeight:A[13],thumbData:A.subarray(14,14+3*A[12]*A[13])}),65518===x&&65===A[0]&&100===A[1]&&111===A[2]&&98===A[3]&&101===A[4]&&(c={version:A[5]<<8|A[6],flags0:A[7]<<8|A[8],flags1:A[9]<<8|A[10],transformCode:A[11]});break;case 65499:for(var M=r()+l-2;l<M;){var C=n[l++],k=new Uint16Array(64);if(C>>4){if(C>>4!=1)throw new t("DQT - invalid table spec");for(b=0;b<64;b++)k[e[b]]=r()}else for(b=0;b<64;b++)k[e[b]]=n[l++];p[15&C]=k}break;case 65472:case 65473:case 65474:if(i)throw new t("Only single frame JPEGs supported");r(),(i={}).extended=65473===x,i.progressive=65474===x,i.precision=n[l++],i.scanLines=r(),i.samplesPerLine=r(),i.components=[],i.componentIds={};var T,P=n[l++],S=0,_=0;for(w=0;w<P;w++){T=n[l];var I=n[l+1]>>4,R=15&n[l+1];S<I&&(S=I),_<R&&(_=R);var N=n[l+2];v=i.components.push({h:I,v:R,quantizationId:N,quantizationTable:null}),i.componentIds[T]=v-1,l+=3}i.maxH=S,i.maxV=_,s(i);break;case 65476:var F=r();for(w=2;w<F;){var E=n[l++],B=new Uint8Array(16),O=0;for(b=0;b<16;b++,l++)O+=B[b]=n[l];var G=new Uint8Array(O);for(b=0;b<O;b++,l++)G[b]=n[l];w+=17+O,(E>>4?d:y)[15&E]=h(B,G)}break;case 65501:r(),a=r();break;case 65498:r();var D,L=n[l++],U=[];for(w=0;w<L;w++){var j=i.componentIds[n[l++]];D=i.components[j];var z=n[l++];D.huffmanTableDC=y[z>>4],D.huffmanTableAC=d[15&z],U.push(D)}var Z=n[l++],V=n[l++],W=n[l++],H=f(n,l,i,U,a,Z,V,W>>4,15&W);l+=H;break;case 65535:255!==n[l]&&l--;break;default:if(255===n[l-3]&&n[l-2]>=192&&n[l-2]<=254){l-=3;break}throw new t("unknown marker "+x.toString(16))}x=r()}for(this.width=i.samplesPerLine,this.height=i.scanLines,this.jfif=u,this.eof=l,this.adobe=c,this.components=[],w=0;w<i.components.length;w++){var J=p[(D=i.components[w]).quantizationId];J&&(D.quantizationTable=J),this.components.push({output:m(0,D),scaleX:D.h/i.maxH,scaleY:D.v/i.maxV,blocksPerLine:D.blocksPerLine,blocksPerColumn:D.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(t,e){var n,r,o,s,i,a,l,u,c,h,p,f=this.width/t,d=this.height/e,m=0,g=this.components.length,y=t*e*g,x=new Uint8ClampedArray(y),w=new Uint32Array(t),b=4294967288;for(l=0;l<g;l++){for(r=(n=this.components[l]).scaleX*f,o=n.scaleY*d,m=l,p=n.output,s=n.blocksPerLine+1<<3,i=0;i<t;i++)u=0|i*r,w[i]=(u&b)<<3|7&u;for(a=0;a<e;a++)for(h=s*((u=0|a*o)&b)|(7&u)<<3,i=0;i<t;i++)x[m]=p[h+w[i]],m+=g}var v=this.decodeTransform;if(v)for(l=0;l<y;)for(u=0,c=0;u<g;u++,l++,c+=2)x[l]=(x[l]*v[c]>>8)+v[c+1];return x},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this.colorTransform:1===this.colorTransform},_convertYccToRgb:function(t){for(var e,n,r,o=0,s=t.length;o<s;o+=3)e=t[o],n=t[o+1],r=t[o+2],t[o]=e-179.456+1.402*r,t[o+1]=e+135.459-.344*n-.714*r,t[o+2]=e-226.816+1.772*n;return t},_convertYcckToRgb:function(t){for(var e,n,r,o,s=0,i=0,a=t.length;i<a;i+=4)e=t[i],n=t[i+1],r=t[i+2],o=t[i+3],t[s++]=n*(-660635669420364e-19*n+.000437130475926232*r-54080610064599e-18*e+.00048449797120281*o-.154362151871126)-122.67195406894+r*(-.000957964378445773*r+.000817076911346625*e-.00477271405408747*o+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*o+.48357088451265)+o*(-.000336197177618394*o+.484791561490776),t[s++]=107.268039397724+n*(219927104525741e-19*n-.000640992018297945*r+.000659397001245577*e+.000426105652938837*o-.176491792462875)+r*(-.000778269941513683*r+.00130872261408275*e+.000770482631801132*o-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*o+.25802910206845)+o*(-.000318913117588328*o-.213742400323665),t[s++]=n*(-.000570115196973677*n-263409051004589e-19*r+.0020741088115012*e-.00288260236853442*o+.814272968359295)-20.810012546947+r*(-153496057440975e-19*r-.000132689043961446*e+.000560833691242812*o-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*o+.116935020465145)+o*(-.000343531996510555*o+.24165260232407);return t},_convertYcckToCmyk:function(t){for(var e,n,r,o=0,s=t.length;o<s;o+=4)e=t[o],n=t[o+1],r=t[o+2],t[o]=434.456-e-1.402*r,t[o+1]=119.541-e+.344*n+.714*r,t[o+2]=481.816-e-1.772*n;return t},_convertCmykToRgb:function(t){for(var e,n,r,o,s=0,i=1/255,a=0,l=t.length;a<l;a+=4)e=t[a]*i,n=t[a+1]*i,r=t[a+2]*i,o=t[a+3]*i,t[s++]=255+e*(-4.387332384609988*e+54.48615194189176*n+18.82290502165302*r+212.25662451639585*o-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*r-17.873870861415444*o-5.497006427196366)+r*(-2.5217340131683033*r-21.248923337353073*o+17.5119270841813)-o*(21.86122147463605*o+189.48180835922747),t[s++]=255+e*(8.841041422036149*e+60.118027045597366*n+6.871425592049007*r+31.159100130055922*o-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*r+131.35250912493976*o-190.9453302588951)+r*(4.444339102852739*r+9.8632861493405*o-24.86741582555878)-o*(20.737325471181034*o+187.80453709719578),t[s++]=255+e*(.8842522430003296*e+8.078677503112928*n+30.89978309703729*r-.23883238689178934*o-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*r+50.606957656360734*o-112.23884253719248)+r*(.03296041114873217*r+115.60384449646641*o-193.58209356861505)-o*(22.33816807309886*o+180.12613974708367);return t},getData:function(e,n,r){if(this.numComponents>4)throw new t("Unsupported color mode");var o=this._getLinearizedBlockData(e,n);if(1===this.numComponents&&r){for(var s=o.length,i=new Uint8ClampedArray(3*s),a=0,l=0;l<s;l++){var u=o[l];i[a++]=u,i[a++]=u,i[a++]=u}return i}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(o);if(4===this.numComponents){if(this._isColorConversionNeeded())return r?this._convertYcckToRgb(o):this._convertYcckToCmyk(o);if(r)return this._convertCmykToRgb(o)}return o}},c}()},void 0!==(n=e())&&(t.exports=n)),s.exports;var t,e,n}())},82499:function(t,e,n){n.d(e,{Z:function(){return i}});var r,o=n(32150),s={exports:{}};const i=(0,o.g)(function(){return r||(r=1,e=s,void 0!==(t=function(){function t(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return t.prototype={ensureBuffer:function(t){var e=this.buffer,n=e?e.byteLength:0;if(t<n)return e;for(var r=512;r<t;)r<<=1;for(var o=new Uint8Array(r),s=0;s<n;++s)o[s]=e[s];return this.buffer=o},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var e=this.pos;if(t){this.ensureBuffer(e+t);for(var n=e+t;!this.eof&&this.bufferLength<n;)this.readBlock();var r=this.bufferLength;n>r&&(n=r)}else{for(;!this.eof;)this.readBlock();n=this.bufferLength}return this.pos=n,this.buffer.subarray(e,n)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,e,n){for(var r=t+e;this.bufferLength<=r&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,e,n)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}},t}(),n=function(){if(!self||!self.Uint32Array)return null;var e=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),n=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),o=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],s=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function i(t){throw new Error(t)}function a(e){var n=0,r=e[n++],o=e[n++];-1!=r&&-1!=o||i("Invalid header in flate stream"),8!=(15&r)&&i("Unknown compression method in flate stream"),((r<<8)+o)%31!=0&&i("Bad FCHECK in flate stream"),32&o&&i("FDICT bit set in flate stream"),this.bytes=e,this.bytesPos=2,this.codeSize=0,this.codeBuf=0,t.call(this)}return a.prototype=Object.create(t.prototype),a.prototype.getBits=function(t){for(var e,n=this.codeSize,r=this.codeBuf,o=this.bytes,s=this.bytesPos;n<t;)void 0===(e=o[s++])&&i("Bad encoding in flate stream"),r|=e<<n,n+=8;return e=r&(1<<t)-1,this.codeBuf=r>>t,this.codeSize=n-=t,this.bytesPos=s,e},a.prototype.getCode=function(t){for(var e=t[0],n=t[1],r=this.codeSize,o=this.codeBuf,s=this.bytes,a=this.bytesPos;r<n;){var l;void 0===(l=s[a++])&&i("Bad encoding in flate stream"),o|=l<<r,r+=8}var u=e[o&(1<<n)-1],c=u>>16,h=65535&u;return(0==r||r<c||0==c)&&i("Bad encoding in flate stream"),this.codeBuf=o>>c,this.codeSize=r-c,this.bytesPos=a,h},a.prototype.generateHuffmanTable=function(t){for(var e=t.length,n=0,r=0;r<e;++r)t[r]>n&&(n=t[r]);for(var o=1<<n,s=new Uint32Array(o),i=1,a=0,l=2;i<=n;++i,a<<=1,l<<=1)for(var u=0;u<e;++u)if(t[u]==i){var c=0,h=a;for(r=0;r<i;++r)c=c<<1|1&h,h>>=1;for(r=c;r<o;r+=l)s[r]=i<<16|u;++a}return[s,n]},a.prototype.readBlock=function(){function t(t,e,n,r,o){for(var s=t.getBits(n)+r;s-- >0;)e[d++]=o}var a=this.getBits(3);if(1&a&&(this.eof=!0),0!=(a>>=1)){var l,u;if(1==a)l=o,u=s;else if(2==a){for(var c=this.getBits(5)+257,h=this.getBits(5)+1,p=this.getBits(4)+4,f=Array(e.length),d=0;d<p;)f[e[d++]]=this.getBits(3);for(var m=this.generateHuffmanTable(f),g=0,y=(d=0,c+h),x=new Array(y);d<y;){var w=this.getCode(m);16==w?t(this,x,2,3,g):17==w?t(this,x,3,3,g=0):18==w?t(this,x,7,11,g=0):x[d++]=g=w}l=this.generateHuffmanTable(x.slice(0,c)),u=this.generateHuffmanTable(x.slice(c,y))}else i("Unknown block type in flate stream");for(var b=(N=this.buffer)?N.length:0,v=this.bufferLength;;){var A=this.getCode(l);if(A<256)v+1>=b&&(b=(N=this.ensureBuffer(v+1)).length),N[v++]=A;else{if(256==A)return void(this.bufferLength=v);var M=(A=n[A-=257])>>16;M>0&&(M=this.getBits(M)),g=(65535&A)+M,A=this.getCode(u),(M=(A=r[A])>>16)>0&&(M=this.getBits(M));var C=(65535&A)+M;v+g>=b&&(b=(N=this.ensureBuffer(v+g)).length);for(var k=0;k<g;++k,++v)N[v]=N[v-C]}}}else{var T,P=this.bytes,S=this.bytesPos;void 0===(T=P[S++])&&i("Bad block header in flate stream");var _=T;void 0===(T=P[S++])&&i("Bad block header in flate stream"),_|=T<<8,void 0===(T=P[S++])&&i("Bad block header in flate stream");var I=T;void 0===(T=P[S++])&&i("Bad block header in flate stream"),(I|=T<<8)!=(65535&~_)&&i("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var R=this.bufferLength,N=this.ensureBuffer(R+_),F=R+_;this.bufferLength=F;for(var E=R;E<F;++E){if(void 0===(T=P[S++])){this.eof=!0;break}N[E]=T}this.bytesPos=S}},a}())&&(e.exports=n)),s.exports;var t,e,n}())},32150:function(t,e,n){n.d(e,{c:function(){return r},g:function(){return o}});var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}},75505:function(t,e,n){n.d(e,{$:function(){return x},IB:function(){return a},Iy:function(){return N},N2:function(){return w},QP:function(){return _},RH:function(){return v},Vl:function(){return S},Ws:function(){return A},ZD:function(){return b},_L:function(){return P},bJ:function(){return k},e$:function(){return T},f6:function(){return R},pW:function(){return M},pf:function(){return I}});var r=n(52874),o=n(50659),s=n(21609),i=(n(33400),n(41546));function a(t){return"r"in t&&"g"in t&&"b"in t}function l(t){return"h"in t&&"s"in t&&"v"in t}function u(t){return"l"in t&&"a"in t&&"b"in t}function c(t){return"l"in t&&"c"in t&&"h"in t}const h=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],p=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function f(t,e){const n=[];let r,o;if(t[0].length!==e.length)throw new Error("dimensions do not match");const s=t.length,i=t[0].length;let a=0;for(r=0;r<s;r++){for(a=0,o=0;o<i;o++)a+=t[r][o]*e[o];n.push(a)}return n}function d(t){const e=[t.r/255,t.g/255,t.b/255].map((t=>t<=.04045?t/12.92:((t+.055)/1.055)**2.4)),n=f(h,e);return{x:100*n[0],y:100*n[1],z:100*n[2]}}function m(t){const e=f(p,[t.x/100,t.y/100,t.z/100]).map((t=>{const e=t<=.0031308?12.92*t:1.055*t**(1/2.4)-.055;return Math.min(1,Math.max(e,0))}));return{r:Math.round(255*e[0]),g:Math.round(255*e[1]),b:Math.round(255*e[2])}}function g(t){const e=[t.x/95.047,t.y/100,t.z/108.883].map((t=>t>(6/29)**3?t**(1/3):1/3*(29/6)**2*t+4/29));return{l:116*e[1]-16,a:500*(e[0]-e[1]),b:200*(e[1]-e[2])}}function y(t){const e=t.l,n=[(e+16)/116+t.a/500,(e+16)/116,(e+16)/116-t.b/200].map((t=>t>6/29?t**3:3*(6/29)**2*(t-4/29)));return{x:95.047*n[0],y:100*n[1],z:108.883*n[2]}}function x(t){return a(t)?t:c(t)?function(t){return m(y(function(t){const e=t.l,n=t.c,r=t.h;return{l:e,a:n*Math.cos(r),b:n*Math.sin(r)}}(t)))}(t):u(t)?function(t){return m(y(t))}(t):function(t){return"x"in t&&"y"in t&&"z"in t}(t)?m(t):l(t)?function(t){const e=(t.h+360)%360/60,n=t.s/100,r=t.v/100*255,o=r*n,s=o*(1-Math.abs(e%2-1));let i;switch(Math.floor(e)){case 0:i={r:o,g:s,b:0};break;case 1:i={r:s,g:o,b:0};break;case 2:i={r:0,g:o,b:s};break;case 3:i={r:0,g:s,b:o};break;case 4:i={r:s,g:0,b:o};break;case 5:case 6:i={r:o,g:0,b:s};break;default:i={r:0,g:0,b:0}}return i.r=Math.round(i.r+r-o),i.g=Math.round(i.g+r-o),i.b=Math.round(i.b+r-o),i}(t):t}function w(t){return l(t)?t:function(t){const e=t.r,n=t.g,r=t.b,o=Math.max(e,n,r),s=o-Math.min(e,n,r);let i=o,a=0===s?0:o===e?(n-r)/s%6:o===n?(r-e)/s+2:(e-n)/s+4,l=0===s?0:s/i;return a<0&&(a+=6),a*=60,l*=100,i*=100/255,{h:a,s:l,v:i}}(x(t))}function b(t){return u(t)?t:function(t){return g(d(t))}(x(t))}function v(t){return c(t)?t:function(t){return function(t){const e=t.l,n=t.a,r=t.b,o=Math.sqrt(n*n+r*r);let s=Math.atan2(r,n);return s=s>0?s:s+2*Math.PI,{l:e,c:o,h:s}}(g(d(t)))}(x(t))}function A(t,e){const{r:n,g:o,b:s}=e?.ignoreAlpha?t:function(t){let{r:e,g:n,b:o,a:s}=t;return s<1&&(e=Math.round(s*e+255*(1-s)),n=Math.round(s*n+255*(1-s)),o=Math.round(s*o+255*(1-s))),new r.A({r:e,g:n,b:o})}(t);return.2126*n+.7152*o+.0722*s}var M,C;function k(t,e=M.High){return A(t,{ignoreAlpha:!0})>e?new r.A([0,0,0,t.a]):new r.A([255,255,255,t.a])}function T(t,e){const n=b(t);n.l*=1-e;const r=x(n),o=t.clone();return o.setColor(r),o.a=t.a,o}function P(t,e){const n=t.clone();return n.a*=e,n}function S(t,e){const n=w(t);n.s*=e;const r=x(n),o=t.clone();return o.setColor(r),o.a=t.a,o}function _(t){return r.A.toUnitRGBA(t)}function I(t){return(0,i.fA)(t[0],t[1],t[2],t.length>3?t[3]:1)}function R(t,e){const n=r.A.toUnitRGBA(t);return n[3]*=e,n}function N(t,e,n={}){if(0===t.length||e<=0)return[];if(1===(t=t.map((t=>"string"==typeof t?new r.A(t):t))).length||1===e){const n=[],r=t[0];for(let t=0;t<e;t++)n.push(r.clone());return n}if(n.shuffle&&(t=(0,o.k4)((0,s.o8)(t),n.seed)),t.length>=e){const n=[],r=(t.length-1)/(e-1);for(let o=0;o<e;o++){const e=Math.round(o*r);n.push(t[e].clone())}return n}return function(t,e,n={}){const r=[],s=t.length-1,i=Math.ceil((e-t.length)/s);t:for(let o=0;o<s;o++){const s=t[o],a=t[o+1];for(let o=1;o<=i;o++){const l=o/(i+1);if(r.push(E(s,a,l,n)),r.length+t.length===e)break t}}return[...t.map((t=>t.clone())),...(0,o.k4)(r,n.seed??1)]}(t,e,n)}(C=M||(M={}))[C.Low=160]="Low",C[C.High=225]="High";const F=(t,e)=>{const n=Math.floor(10*e())-5;return Math.min(255,Math.max(0,t+n))};function E(t,e,n,s={}){const i=t.r,a=t.g,l=t.b,u=e.r,c=e.g,h=e.b,p=Math.round(i+(u-i)*n),f=Math.round(a+(c-a)*n),d=Math.round(l+(h-l)*n);if(!s.offset)return new r.A([p,f,d]);const m=(0,o.Mo)(s.seed);return new r.A([F(p,m),F(f,m),F(d,m)])}},21327:function(t,e,n){n.d(e,{A:function(){return m}});var r,o=n(53804),s=n(39819),i=n(30905),a=n(21609),l=n(40633),u=n(23502),c=n(77560),h=n(65953),p=n(42568),f=n(95738);let d=r=class extends i.oY{static createEmptyBand(t,e){return new(r.getPixelArrayConstructor(t))(e)}static combineBandMasks(t){if(t.length<2)return t[0];const e=t[0].length,n=new Uint8Array(e).fill(255);for(let r=0;r<t.length;r++){const o=t[r];for(let t=0;t<e;t++)o[t]||(n[t]=0)}return n}static getPixelArrayConstructor(t){let e;switch(t){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":e=Float32Array;break;case"f64":e=Float64Array}return e}constructor(t){super(t),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(t){if(!t)return"f32";let e=t.toLowerCase();return["u1","u2","u4"].includes(e)?e="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(e)||(e="f32"),e}getPlaneCount(){return this.pixels?.length}addData(t){if(!t.pixels||t.pixels.length!==this.width*this.height)throw new s.A("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(t.pixels),this.statistics.push(t.statistics??new p.z)}getAsRGBA(){const t=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(t);break;default:this._fillFrom8Bit(t)}return new Uint8ClampedArray(t)}getAsRGBAFloat(){const t=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(t),t}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map((t=>function(t,e){let n=1/0,r=-1/0;const o=t.length;let s,i=0;if(null!=e)for(s=0;s<o;s++)e[s]&&(i=t[s],n=i<n?i:n,r=i>r?i:r);else for(s=0;s<o;s++)i=t[s],n=i<n?i:n,r=i>r?i:r;return new p.z(n,r)}(t,this.mask)));const t=this.mask;let e=0;if(null!=t)for(let n=0;n<t.length;n++)t[n]&&e++;else e=this.width*this.height;this.validPixelCount=e}clamp(t){if(!t||"f64"===t||"f32"===t||!this.pixels)return;const[e,n]=(0,f.hP)(t),o=this.pixels,s=this.width*this.height,i=o.length;let a,l,u;const c=[];for(let h=0;h<i;h++){u=r.createEmptyBand(t,s),a=o[h];for(let t=0;t<s;t++)l=a[t],u[t]=l>n?n:l<e?e:l;c.push(u)}this.pixels=c,this.pixelType=t}extractBands(t){const{pixels:e,statistics:n}=this;if(null==t||0===t.length||!e||0===e.length)return this;const o=e.length,s=t.some((t=>t>=e.length)),i=o===t.length&&!t.some(((t,e)=>t!==e));if(s||i)return this;const a=this.bandMasks?.length===o?t.map((t=>this.bandMasks[t])):void 0;let{mask:l,validPixelCount:u}=this;const{width:c,height:h}=this;return a?.length&&(l=r.combineBandMasks(a),u=l.filter((t=>!!t)).length),new r({pixelType:this.pixelType,width:c,height:h,mask:l,bandMasks:a,validPixelCount:u,maskIsAlpha:this.maskIsAlpha,pixels:t.map((t=>e[t])),statistics:n&&t.map((t=>n[t]))})}clone(){const t=new r({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});let e;null!=this.mask&&(t.mask=new Uint8Array(this.mask)),this.bandMasks&&(t.bandMasks=this.bandMasks.map((t=>new Uint8Array(t))));const n=r.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];const r=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=r?this.pixels[e].slice():new n(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=(0,a.o8)(this.statistics[e]);return t.premultiplyAlpha=this.premultiplyAlpha,t}_fillFrom8Bit(t){const{mask:e,maskIsAlpha:n,premultiplyAlpha:r,pixels:o}=this;if(!t||!o?.length)return void l.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let s,i,a,u;s=i=a=o[0],o.length>=3?(i=o[1],a=o[2]):2===o.length&&(i=o[1]);const c=new Uint32Array(t),h=this.width*this.height;if(s.length===h)if(null!=e&&e.length===h)if(n)for(u=0;u<h;u++){const t=e[u];if(t){const e=t/255;c[u]=r?t<<24|a[u]*e<<16|i[u]*e<<8|s[u]*e:t<<24|a[u]<<16|i[u]<<8|s[u]}}else for(u=0;u<h;u++)e[u]&&(c[u]=255<<24|a[u]<<16|i[u]<<8|s[u]);else for(u=0;u<h;u++)c[u]=255<<24|a[u]<<16|i[u]<<8|s[u];else l.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(t){const{pixels:e,mask:n,statistics:r}=this;if(!t||!e?.length)return void l.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const o=this.pixelType;let s=1,i=0,a=1;if(r&&r.length>0){for(const t of r)if(null!=t.minValue&&(i=Math.min(i,t.minValue)),null!=t.maxValue&&null!=t.minValue){const e=t.maxValue-t.minValue;a=Math.max(a,e)}s=255/a}else{let t=255;"s8"===o?(i=-128,t=127):"u16"===o?t=65535:"s16"===o?(i=-32768,t=32767):"u32"===o?t=4294967295:"s32"===o?(i=-2147483648,t=2147483647):"f32"===o?(i=-34e38,t=34e38):"f64"===o&&(i=-Number.MAX_VALUE,t=Number.MAX_VALUE),s=255/(t-i)}const u=new Uint32Array(t),c=this.width*this.height;let h,p,f,d,m;if(h=p=f=e[0],h.length!==c)return l.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(e.length>=2)if(p=e[1],e.length>=3&&(f=e[2]),null!=n&&n.length===c)for(d=0;d<c;d++)n[d]&&(u[d]=255<<24|(f[d]-i)*s<<16|(p[d]-i)*s<<8|(h[d]-i)*s);else for(d=0;d<c;d++)u[d]=255<<24|(f[d]-i)*s<<16|(p[d]-i)*s<<8|(h[d]-i)*s;else if(null!=n&&n.length===c)for(d=0;d<c;d++)m=(h[d]-i)*s,n[d]&&(u[d]=255<<24|m<<16|m<<8|m);else for(d=0;d<c;d++)m=(h[d]-i)*s,u[d]=255<<24|m<<16|m<<8|m}_fillFrom32Bit(t){const{pixels:e,mask:n}=this;if(!t||!e?.length)return l.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let r,o,s,i;r=o=s=e[0],e.length>=3?(o=e[1],s=e[2]):2===e.length&&(o=e[1]);const a=this.width*this.height;if(r.length!==a)return l.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let u=0;if(null!=n&&n.length===a)for(i=0;i<a;i++)t[u++]=r[i],t[u++]=o[i],t[u++]=s[i],t[u++]=1&n[i];else for(i=0;i<a;i++)t[u++]=r[i],t[u++]=o[i],t[u++]=s[i],t[u++]=1}};(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"width",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"height",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"pixelType",void 0),(0,o._)([(0,c.w)("pixelType")],d.prototype,"castPixelType",null),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"validPixelCount",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"mask",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"maskIsAlpha",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"pixels",void 0),(0,o._)([(0,u.MZ)()],d.prototype,"premultiplyAlpha",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"statistics",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"depthCount",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"noDataValues",void 0),(0,o._)([(0,u.MZ)({json:{write:!0}})],d.prototype,"bandMasks",void 0),d=r=(0,o._)([(0,h.$)("esri.layers.support.PixelBlock")],d);const m=d},98521:function(t,e,n){n.d(e,{A:function(){return M}});var r,o=n(53804),s=n(30905),i=n(21609),a=n(23502),l=(n(58941),n(40633),n(65953)),u=n(91484),c=n(57165);function h(t){return t=Number(t),isNaN(t)?void 0:t}n(13798);let p=r=class extends s.oY{constructor(){super(...arguments),this.name=null,this.minWavelength=void 0,this.maxWavelength=void 0,this.radianceBias=void 0,this.radianceGain=void 0,this.reflectanceBias=void 0,this.reflectanceGain=void 0,this.solarIrradiance=void 0}clone(){return new r({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};(0,o._)([(0,a.MZ)({json:{name:"BandName",write:!0}})],p.prototype,"name",void 0),(0,o._)([(0,a.MZ)({json:{name:"WavelengthMin",read:{reader:h},write:!0}})],p.prototype,"minWavelength",void 0),(0,o._)([(0,a.MZ)({json:{name:"WavelengthMax",read:{reader:h},write:!0}})],p.prototype,"maxWavelength",void 0),(0,o._)([(0,a.MZ)({json:{name:"RadianceBias",read:{reader:h},write:!0}})],p.prototype,"radianceBias",void 0),(0,o._)([(0,a.MZ)({json:{name:"RadianceGain",read:{reader:h},write:!0}})],p.prototype,"radianceGain",void 0),(0,o._)([(0,a.MZ)({json:{name:"ReflectanceBias",read:{reader:h},write:!0}})],p.prototype,"reflectanceBias",void 0),(0,o._)([(0,a.MZ)({json:{name:"ReflectanceGain",read:{reader:h},write:!0}})],p.prototype,"reflectanceGain",void 0),(0,o._)([(0,a.MZ)({json:{name:"SolarIrradiance",read:{reader:h},write:!0}})],p.prototype,"solarIrradiance",void 0),p=r=(0,o._)([(0,l.$)("esri.layers.support.RasterBandInfo")],p);const f=p;var d,m=n(47332),g=n(81392);function y(t){return t=Number(t),isNaN(t)?void 0:t}let x=d=class extends s.oY{constructor(){super(...arguments),this.acquisitionDate=void 0,this.cloudCover=void 0,this.productName=void 0,this.sensorName=null,this.sensorAzimuth=void 0,this.sensorElevation=void 0,this.sunAzimuth=void 0,this.sunElevation=void 0}readAcquisitionDate(t){return new Date(t)}writeAcquisitionDate(t,e){e.AcquisitionDate=t.getTime()}clone(){return new d({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};(0,o._)([(0,a.MZ)({json:{name:"AcquisitionDate",write:!0}})],x.prototype,"acquisitionDate",void 0),(0,o._)([(0,m.w)("acquisitionDate")],x.prototype,"readAcquisitionDate",null),(0,o._)([(0,g.K)("acquisitionDate")],x.prototype,"writeAcquisitionDate",null),(0,o._)([(0,a.MZ)({json:{name:"CloudCover",read:{reader:y},write:!0}})],x.prototype,"cloudCover",void 0),(0,o._)([(0,a.MZ)({json:{name:"ProductName",write:!0}})],x.prototype,"productName",void 0),(0,o._)([(0,a.MZ)({json:{name:"SensorName",write:!0}})],x.prototype,"sensorName",void 0),(0,o._)([(0,a.MZ)({json:{name:"SensorAzimuth",read:{reader:y},write:!0}})],x.prototype,"sensorAzimuth",void 0),(0,o._)([(0,a.MZ)({json:{name:"SensorElevation",read:{reader:y},write:!0}})],x.prototype,"sensorElevation",void 0),(0,o._)([(0,a.MZ)({json:{name:"SunAzimuth",read:{reader:y},write:!0}})],x.prototype,"sunAzimuth",void 0),(0,o._)([(0,a.MZ)({json:{name:"SunElevation",read:{reader:y},write:!0}})],x.prototype,"sunElevation",void 0),x=d=(0,o._)([(0,l.$)("esri.layers.support.RasterSensorInfo")],x);const w=x;var b,v=n(70850);let A=b=class extends s.oY{constructor(t){super(t),this.attributeTable=null,this.bandCount=null,this.colormap=null,this.extent=null,this.format=void 0,this.height=null,this.width=null,this.histograms=null,this.keyProperties={},this.multidimensionalInfo=null,this.noDataValue=null,this.pixelSize=null,this.pixelType=null,this.isPseudoSpatialReference=!1,this.spatialReference=null,this.statistics=null,this.storageInfo=null,this.transform=null}get bandInfos(){const t=this.keyProperties.BandProperties,{bandCount:e}=this;if(!t?.length||t.length<e){const t=[];for(let n=1;n<=e;n++)t.push(new f({name:"band_"+n}));return t}const n=t.map((t=>f.fromJSON(t)));for(let t=0;t<n.length;t++)n[t].name=n[t].name||"band_"+(t+1);return n}get dataType(){const t=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===t?"standard-time":t}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(t){t&&this._set("nativeExtent",t)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;const t=this.nativeExtent;return{x:t.width/this.width,y:t.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return w.fromJSON(this.keyProperties)}clone(){return new b({attributeTable:(0,i.o8)(this.attributeTable),bandCount:this.bandCount,colormap:(0,i.o8)(this.colormap),extent:(0,i.o8)(this.extent),format:this.format,height:this.height,width:this.width,histograms:(0,i.o8)(this.histograms),keyProperties:(0,i.o8)(this.keyProperties),multidimensionalInfo:(0,i.o8)(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:(0,i.o8)(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:(0,i.o8)(this.spatialReference),statistics:(0,i.o8)(this.statistics),storageInfo:(0,i.o8)(this.storageInfo),transform:(0,i.o8)(this.transform)})}};(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"attributeTable",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"bandCount",void 0),(0,o._)([(0,a.MZ)({readOnly:!0})],A.prototype,"bandInfos",null),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"colormap",void 0),(0,o._)([(0,a.MZ)({type:String,readOnly:!0})],A.prototype,"dataType",null),(0,o._)([(0,a.MZ)({type:u.default,json:{write:!0}})],A.prototype,"extent",void 0),(0,o._)([(0,a.MZ)({type:u.default,json:{write:!0}})],A.prototype,"nativeExtent",null),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"nativePixelSize",null),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"format",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"height",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"width",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"hasMultidimensionalTranspose",null),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"histograms",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"keyProperties",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"multidimensionalInfo",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"noDataValue",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"pixelSize",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"pixelType",void 0),(0,o._)([(0,a.MZ)()],A.prototype,"isPseudoSpatialReference",void 0),(0,o._)([(0,a.MZ)({readOnly:!0})],A.prototype,"sensorInfo",null),(0,o._)([(0,a.MZ)({type:c.A,json:{write:!0}})],A.prototype,"spatialReference",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"statistics",void 0),(0,o._)([(0,a.MZ)({type:v.A,json:{write:!0}})],A.prototype,"storageInfo",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],A.prototype,"transform",void 0),A=b=(0,o._)([(0,l.$)("esri.layers.support.RasterInfo")],A);const M=A},70850:function(t,e,n){n.d(e,{A:function(){return h}});var r,o=n(53804),s=n(30905),i=n(21609),a=n(23502),l=(n(58941),n(40633),n(65953)),u=n(45532);let c=r=class extends s.oY{constructor(){super(...arguments),this.blockWidth=void 0,this.blockHeight=void 0,this.compression=null,this.origin=null,this.firstPyramidLevel=null,this.maximumPyramidLevel=null,this.pyramidScalingFactor=2,this.pyramidBlockWidth=null,this.pyramidBlockHeight=null,this.isVirtualTileInfo=!1,this.tileInfo=null,this.transposeInfo=null,this.blockBoundary=null}clone(){return new r({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:(0,i.o8)(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:(0,i.o8)(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:(0,i.o8)(this.tileInfo),transposeInfo:(0,i.o8)(this.transposeInfo),blockBoundary:(0,i.o8)(this.blockBoundary)})}};(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"blockWidth",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"blockHeight",void 0),(0,o._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"compression",void 0),(0,o._)([(0,a.MZ)({type:u.default,json:{write:!0}})],c.prototype,"origin",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"firstPyramidLevel",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"maximumPyramidLevel",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"pyramidResolutions",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"pyramidScalingFactor",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"pyramidBlockWidth",void 0),(0,o._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"pyramidBlockHeight",void 0),(0,o._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],c.prototype,"isVirtualTileInfo",void 0),(0,o._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"tileInfo",void 0),(0,o._)([(0,a.MZ)()],c.prototype,"transposeInfo",void 0),(0,o._)([(0,a.MZ)()],c.prototype,"blockBoundary",void 0),c=r=(0,o._)([(0,l.$)("esri.layers.support.RasterStorageInfo")],c);const h=c},85563:function(t,e,n){n.r(e),n.d(e,{default:function(){return T}}),n(50917);var r,o=n(83004),s=n(21327),i=n(43008),a=n(43264),l=n(56991),u=n(80221),c=n(72567),h=n(53611),p=n(62710),f=n(53804),d=(n(40633),n(58941),n(13798),n(39819),n(74376)),m=n(65953),g=n(52477);let y=r=class extends g.A{constructor(){super(...arguments),this.type="identity"}clone(){return new r}};(0,f._)([(0,d.e)({IdentityXform:"identity"})],y.prototype,"type",void 0),y=r=(0,f._)([(0,m.$)("esri.layers.support.rasterTransforms.IdentityTransform")],y);const x=y;var w=n(85307);const b={GCSShiftXform:p.A,IdentityXform:x,PolynomialXform:w.A};function v(t){const e=t?.type;if(!e)return null;const n=b[t?.type];if(n){const e=new n;return e.read(t),e}return null}Object.keys(b);var A=n(31233),M=n(20106),C=n(91484),k=n(45532);class T{convertVectorFieldData(t){const e=s.A.fromJSON(t.pixelBlock),n=(0,h.FI)(e,t.type);return Promise.resolve(null!=n?n.toJSON():null)}computeStatisticsHistograms(t){const e=s.A.fromJSON(t.pixelBlock),n=(0,c.eH)(e);return Promise.resolve(n)}async decode(t){const e=await(0,i.D)(t.data,t.options);return e&&e.toJSON()}symbolize(t){t.pixelBlock=s.A.fromJSON(t.pixelBlock),t.extent=t.extent?C.default.fromJSON(t.extent):null;const e=this.symbolizer.symbolize(t);return Promise.resolve(null!=e?e.toJSON():null)}async updateSymbolizer(t){this.symbolizer=A.A.fromJSON(t.symbolizerJSON),t.histograms&&"rasterStretch"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=t.histograms)}async updateRasterFunction(t){this.rasterFunction=(0,l.vt)(t.rasterFunctionJSON)}async process(t){const e=this.rasterFunction.process({extent:C.default.fromJSON(t.extent),primaryPixelBlocks:t.primaryPixelBlocks.map((t=>null!=t?s.A.fromJSON(t):null)),primaryPixelSizes:t.primaryPixelSizes?.map((t=>null!=t?k.default.fromJSON(t):null)),primaryRasterIds:t.primaryRasterIds});return null!=e?e.toJSON():null}stretch(t){const e=this.symbolizer.simpleStretch(s.A.fromJSON(t.srcPixelBlock),t.stretchParams);return Promise.resolve(e?.toJSON())}estimateStatisticsHistograms(t){const e=(0,c.f4)(s.A.fromJSON(t.srcPixelBlock));return Promise.resolve(e)}split(t){const e=(0,a.lD)(s.A.fromJSON(t.srcPixelBlock),t.tileSize,t.maximumPyramidLevel??0,!1===t.useBilinear);return e&&e.forEach(((t,n)=>{e.set(n,t?.toJSON())})),Promise.resolve(e)}clipTile(t){const e=s.A.fromJSON(t.pixelBlock),n=(0,a.J$)({...t,pixelBlock:e});return Promise.resolve(n?.toJSON())}async mosaicAndTransform(t){const e=t.srcPixelBlocks.map((t=>t?new s.A(t):null)),n=(0,a.z7)(e,t.srcMosaicSize,{blockWidths:t.blockWidths,alignmentInfo:t.alignmentInfo,clipOffset:t.clipOffset,clipSize:t.clipSize});let r,o=n;return t.coefs&&(o=(0,a.$i)(n,t.destDimension,t.coefs,t.sampleSpacing,t.interpolation)),t.projectDirections&&t.gcsGrid&&(r=(0,a.QF)(t.destDimension,t.gcsGrid),o=(0,h.Y2)(o,t.isUV?"vector-uv":"vector-magdir",r)),{pixelBlock:o?.toJSON(),localNorthDirections:r}}async createFlowMesh(t,e){const n={data:new Float32Array(t.flowData.buffer),mask:new Uint8Array(t.flowData.maskBuffer),width:t.flowData.width,height:t.flowData.height},{vertexData:r,indexData:o}=await(0,M.CW)(t.meshType,t.simulationSettings,n,e.signal);return{result:{vertexBuffer:r.buffer,indexBuffer:o.buffer},transferList:[r.buffer,o.buffer]}}async getProjectionOffsetGrid(t){const e=C.default.fromJSON(t.projectedExtent),n=C.default.fromJSON(t.srcBufferExtent);let r=null;t.datumTransformationSteps&&(r=new o.A({steps:t.datumTransformationSteps})),(t.includeGCSGrid||(0,u.xh)(e.spatialReference,n.spatialReference,r))&&await(0,u.Hh)();const s=t.rasterTransform?v(t.rasterTransform):null;return(0,u.l0)({...t,projectedExtent:e,srcBufferExtent:n,datumTransformation:r,rasterTransform:s})}}},42568:function(t,e,n){n.d(e,{z:function(){return r}});class r{constructor(t=null,e=null,n=null){this.minValue=t,this.maxValue=e,this.noDataValue=n}}},11958:function(t,e,n){function r(t,e){let n=0,r="",o=0,s=0;const i=t.length;for(;n<i;)s=t[n++],o=s>>4,o<8?o=1:15===o?(o=4,s=(7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++]):14===o?(o=3,s=(15&s)<<12|(63&t[n++])<<6|63&t[n++]):(o=2,s=(31&s)<<6|63&t[n++]),(0!==s||e)&&(r+=String.fromCharCode(s));return r}n.d(e,{w:function(){return r}})},80426:function(t,e,n){n.d(e,{D4:function(){return c},Hh:function(){return i}});var r=n(53216);const o=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}];let s=null;function i(){return s||(s=n.e(7535).then(n.bind(n,65915)).then((t=>t.l)).then((({default:t})=>t({locateFile:t=>(0,r.s)(`esri/layers/support/rasterFormats/${t}`)}))).then((t=>{!function(t){const{_malloc:e,_free:n,_lerc_getBlobInfo:r,_lerc_getDataRanges:s,_lerc_decode_4D:i,asm:u}=t;let c;const h=Object.values(u).find((e=>e&&"buffer"in e&&e.buffer===t.HEAPU8.buffer)),p=t=>{const n=t.map((t=>function(t){return 16+(t>>3<<3)}(t))),r=n.reduce(((t,e)=>t+e)),o=e(r);c=new Uint8Array(h.buffer);let s=n[0];n[0]=o;for(let t=1;t<n.length;t++){const e=n[t];n[t]=n[t-1]+s,s=e}return n};a.getBlobInfo=t=>{const e=new Uint8Array(48),o=new Uint8Array(24),[i,a,u]=p([t.length,e.length,o.length]);c.set(t,i),c.set(e,a),c.set(o,u);let f=r(i,t.length,a,u,12,3);if(f)throw n(i),new Error(`lerc-getBlobInfo: error code is ${f}`);c=new Uint8Array(h.buffer),l(c,a,e),l(c,u,o);const d=new Uint32Array(e.buffer),m=new Float64Array(o.buffer),[g,y,,x,w,b,v,A,M,C,k]=d,T={version:g,depthCount:C,width:x,height:w,validPixelCount:v,bandCount:b,blobSize:A,maskCount:M,dataType:y,minValue:m[0],maxValue:m[1],maxZerror:m[2],statistics:[],bandCountWithNoData:k};if(k&&C>1)return n(i),T;if(1===C&&1===b)return n(i),T.statistics.push({minValue:m[0],maxValue:m[1]}),T;const P=C*b*8,S=new Uint8Array(P),_=new Uint8Array(P);let I=i,R=0,N=0,F=!1;if(c.byteLength<i+2*P?(n(i),F=!0,[I,R,N]=p([t.length,P,P]),c.set(t,I)):[R,N]=p([P,P]),c.set(S,R),c.set(_,N),f=s(I,t.length,C,b,R,N),f)throw n(I),F||n(R),new Error(`lerc-getDataRanges: error code is ${f}`);c=new Uint8Array(h.buffer),l(c,R,S),l(c,N,_);const E=new Float64Array(S.buffer),B=new Float64Array(_.buffer),O=T.statistics;for(let t=0;t<b;t++)if(C>1){const e=E.slice(t*C,(t+1)*C),n=B.slice(t*C,(t+1)*C),r=Math.min.apply(null,e),o=Math.max.apply(null,n);O.push({minValue:r,maxValue:o,depthStats:{minValues:e,maxValues:n}})}else O.push({minValue:E[t],maxValue:B[t]});return n(I),F||n(R),T},a.decode=(t,e)=>{const{maskCount:r,depthCount:s,bandCount:a,width:u,height:f,dataType:d,bandCountWithNoData:m}=e,g=o[d],y=u*f,x=new Uint8Array(y*a),w=y*s*a*g.size,b=new Uint8Array(w),v=new Uint8Array(a),A=new Uint8Array(8*a),[M,C,k,T,P]=p([t.length,x.length,b.length,v.length,A.length]);c.set(t,M),c.set(x,C),c.set(b,k),c.set(v,T),c.set(A,P);const S=i(M,t.length,r,C,s,u,f,a,d,k,T,P);if(S)throw n(M),new Error(`lerc-decode: error code is ${S}`);c=new Uint8Array(h.buffer),l(c,k,b),l(c,C,x);let _=null;if(m){l(c,T,v),l(c,P,A),_=[];const t=new Float64Array(A.buffer);for(let e=0;e<v.length;e++)_.push(v[e]?t[e]:null)}return n(M),{data:b,maskData:x,noDataValues:_}}}(t)})),s)}const a={getBlobInfo:null,decode:null};function l(t,e,n){n.set(t.slice(e,e+n.length))}function u(t,e,n,r,o){if(n<2)return t;const s=new r(e*n);for(let r=0,o=0;r<e;r++)for(let i=0,a=r;i<n;i++,a+=e)s[a]=t[o++];return s}function c(t,e={}){const n=e.inputOffset??0,r=t instanceof Uint8Array?t.subarray(n):new Uint8Array(t,n),s=a.getBlobInfo(r),{data:i,maskData:l,noDataValues:c}=a.decode(r,s),{width:h,height:p,bandCount:f,depthCount:d,dataType:m,maskCount:g,statistics:y}=s,x=o[m],w=new x.ctor(i.buffer),b=[],v=[],A=h*p,M=A*d;for(let t=0;t<f;t++){const n=w.subarray(t*M,(t+1)*M);if(e.returnInterleaved)b.push(n);else{const t=u(n,A,d,x.ctor);b.push(t)}v.push(l.subarray(t*M,(t+1)*M))}const C=0===g?null:1===g?v[0]:new Uint8Array(A);if(g>1){C.set(v[0]);for(let t=1;t<v.length;t++){const e=v[t];for(let t=0;t<A;t++)C[t]=C[t]&e[t]}}const{noDataValue:k}=e,T=null!=k&&x.range[0]<=k&&x.range[1]>=k;if(g>0&&T)for(let t=0;t<f;t++){const e=b[t],n=v[t]||C;for(let t=0;t<A;t++)0===n[t]&&(e[t]=k)}const P=g===f&&f>1?v:null,{pixelType:S}=x;return{width:h,height:p,bandCount:f,pixelType:S,depthCount:d,statistics:y,pixels:b,mask:C,bandMasks:P,noDataValues:c}}},94235:function(t,e,n){function r(){const t=[];for(let e=0;e<=257;e++)t[e]=[e];return t}function o(t,e){for(let n=0;n<e.length;n++)t.push(e[n])}n.d(e,{D:function(){return i}});const s=new Set;function i(t,e,n,i=!0){const a=function(t,e,n,r=!0){if(e%4!=0||n%4!=0){const o=new ArrayBuffer(4*Math.ceil(n/4)),s=new Uint8Array(o),i=new Uint8Array(t,e,n);if(r)for(let t=0;t<s.length;t+=4)s[t]=i[t+3],s[t+1]=i[t+2],s[t+2]=i[t+1],s[t+3]=i[t];else s.set(i);return new Uint32Array(s.buffer)}if(r){const r=new Uint8Array(t,e,n),o=new Uint8Array(r.length);for(let t=0;t<o.length;t+=4)o[t]=r[t+3],o[t+1]=r[t+2],o[t+2]=r[t+1],o[t+3]=r[t];return new Uint32Array(o.buffer)}return new Uint32Array(t,e,n/4)}(t,e,n,i);let l=9,u=r(),c=32,h=u.length,p=[],f=1,d=a[0],m=0;const g=a.length,y=8*(4*g-n),x=[];for(;null!=d;){if(c>=l)c-=l,m=d>>>32-l,d<<=l;else{m=d>>>32-c,d=a[f++];const t=l-c;c=32-t,m=(m<<t)+(d>>>c),d<<=t}if(257===m)break;if(256===m){l=9,u=r(),h=u.length,p=[];continue}const t=u[m];if(null==t){if(m>u.length)throw new Error("data integrity issue: code does not exist on code page");p.push(p[0]),u[h++]=p.slice(),o(x,p)}else o(x,t),p.push(t[0]),p.length>1&&(u[h++]=p.slice()),p=t.slice();if(s.has(h)&&l++,0===c&&(d=a[f++],c=32),f>g||f===g&&c<=y)break}return new Uint8Array(x)}s.add(511),s.add(1023),s.add(2047),s.add(4095),s.add(8191)},43008:function(t,e,n){n.d(e,{D:function(){return N},g:function(){return R}});var r=n(39819),o=n(95929),s=n(21327),i=n(42568),a=n(60539),l=n(82499);class u{constructor(t){this._canvas=null,this._ctx=null,t&&(this._canvas=t.canvas,this._ctx=t.ctx||t.canvas&&t.canvas.getContext("2d"))}decode(t,e,n){if(!t||t.byteLength<10)throw new r.A("imagecanvasdecoder: decode","required a valid encoded data as input.");let{width:o=0,height:s=0,format:i}=e;const{applyJpegMask:l}=e;if(l&&(!o||!s))throw new r.A("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise(((r,c)=>{let h=null;"jpg"===i&&l&&(h=u._getMask(t,{width:o,height:s}));const p=new Blob([new Uint8Array(t)],{type:"image/"+i=="jpg"?"jpeg":i}),f=URL.createObjectURL(p),d=new Image;let m;d.src=f,d.onload=()=>{if(URL.revokeObjectURL(f),(0,a.G4)(n))return void c((0,a.NK)());o=d.width,s=d.height,this._canvas&&this._ctx?(this._canvas.width===o&&this._canvas.height===s||(this._canvas.width=o,this._canvas.height=s),this._ctx.clearRect(0,0,o,s)):(this._canvas=document.createElement("canvas"),this._canvas.width=o,this._canvas.height=s,this._ctx=this._canvas.getContext("2d")),this._ctx.drawImage(d,0,0);const t=this._ctx.getImageData(0,0,o,s);let i;if(m=t.data,e.renderOnCanvas){if(h)for(i=0;i<h.length;i++)h[i]?m[4*i+3]=255:m[4*i+3]=0;return this._ctx.putImageData(t,0,0),void r(null)}const l=o*s,u=new Uint8Array(l),p=new Uint8Array(l),g=new Uint8Array(l);if(h)for(i=0;i<l;i++)u[i]=m[4*i],p[i]=m[4*i+1],g[i]=m[4*i+2];else for(h=new Uint8Array(l),i=0;i<l;i++)u[i]=m[4*i],p[i]=m[4*i+1],g[i]=m[4*i+2],h[i]=m[4*i+3];r({width:o,height:s,pixels:[u,p,g],mask:h,pixelType:"u8"})},d.onerror=()=>{URL.revokeObjectURL(f),c("cannot load image")}}))}static _getMask(t,e){let n=null;try{const r=new Uint8Array(t),o=Math.ceil(r.length/2);let s=0;const i=r.length-2;for(s=o;s<i&&(255!==r[s]||217!==r[s+1]);s++);if(s+=2,s<r.length-1){const t=new l.Z(r.subarray(s)).getBytes();n=new Uint8Array(e.width*e.height);let o=0;for(let e=0;e<t.length;e++)for(let r=7;r>=0;r--)n[o++]=t[e]>>r&1}}catch(t){}return n}}var c=n(90735);class h{static decode(t,e=!1){const n=new Uint8Array(t),r=new c.J;r.parse(n);const{width:o,height:s,numComponents:i,eof:a}=r,u=r.getData(o,s,!0),h=o*s;let p,f=null,d=0,m=0,g=0;if(!e&&a<n.length-1)try{const t=new l.Z(n.subarray(a)).getBytes();f=new Uint8Array(h);let e=0;for(d=0;d<t.length;d++)for(g=7;g>=0;g--)f[e++]=t[d]>>g&1}catch{}if(1===i&&u.length===o*s){const t=new Uint8Array(u.buffer);p=[t,t,t]}else{for(p=[],d=0;d<3;d++)p.push(new Uint8Array(h));for(g=0,m=0;m<h;m++)for(d=0;d<3;d++)p[d][m]=u[g++]}return{width:o,height:s,pixels:p,mask:f}}}var p=n(80426),f=n(94235),d=n(95738);const m=(t,e)=>{const n=e.width*e.height,r=e.pixelType;return Math.floor(t.byteLength/(n*g(r)))},g=t=>{let e=1;switch(t){case Uint8Array:case Int8Array:e=1;break;case Uint16Array:case Int16Array:e=2;break;case Uint32Array:case Int32Array:case Float32Array:e=4;break;case Float64Array:e=8}return e};class y{static decode(t,e){const n=e.pixelType,r=[],o=e.width*e.height,s=m(t,e),{bandIds:i,format:a}=e,l=i?.length||m(t,e),u=t.byteLength-t.byteLength%(o*g(n)),c=new n(t,0,o*s);let h,p,f,d,y=null;if("bip"===a)for(h=0;h<l;h++){for(f=new n(o),d=i?i[h]:h,p=0;p<o;p++)f[p]=c[p*s+d];r.push(f)}else if("bsq"===a)for(h=0;h<l;h++)d=i?i[h]:h,r.push(c.subarray(d*o,(d+1)*o));return u<t.byteLength-1&&(y=((t,e)=>{if(8*t.byteLength<e)return null;const n=new Uint8Array(t,0,Math.ceil(e/8)),r=new Uint8Array(e);let o=0,s=0,i=0,a=0;for(i=0;i<n.length-1;i++)for(s=n[i],a=7;a>=0;a--)r[o++]=s>>a&1;for(a=7;o<e-1;)s=n[n.length-1],r[o++]=s>>a&1,a--;return r})(t.slice(u),o)),{pixels:r,mask:y}}}var x=n(3685),w=n(70041),b=function(t){var e,n,r;function o(t){var e,n,r,o,s,i,a,l,u,c,h,p,f;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(e=this.readUInt32(),l=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join(""),l){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},o=this.readUInt16(),r=this.readUInt16()||100,s.delay=1e3*o/r,s.disposeOp=this.data[this.pos++],s.blendOp=this.data[this.pos++],s.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,e-=4),t=(null!=s?s.data:void 0)||this.imgData,h=0;0<=e?h<e:h>e;0<=e?++h:--h)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),(u=255-this.transparency.indexed.length)>0)for(p=0;0<=u?p<u:p>u;0<=u?++p:--p)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":i=(c=this.read(e)).indexOf(0),a=String.fromCharCode.apply(String,c.slice(0,i)),this.text[a]=String.fromCharCode.apply(String,c.slice(i+1));break;case"IEND":return s&&this.animation.frames.push(s),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(f=this.colorType)||6===f,n=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*n,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return o.load=function(t,e,n){var r;return"function"==typeof e&&(n=e),(r=new XMLHttpRequest).open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){var t;return t=new o(new Uint8Array(r.response||r.mozResponseArrayBuffer)),"function"==typeof(null!=e?e.getContext:void 0)&&t.render(e),"function"==typeof n?n(t):void 0},r.send(null)},o.prototype.read=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)n.push(this.data[this.pos++]);return n},o.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},o.prototype.decodePixels=function(t){var e,n,r,o,s,i,a,u,c,h,p,f,d,m,g,y,x,w,b,v,A,M,C;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=(t=new l.Z(t)).getBytes(),y=(f=this.pixelBitlength/8)*this.width,d=new Uint8Array(y*this.height),i=t.length,g=0,m=0,n=0;m<i;){switch(t[m++]){case 0:for(o=b=0;b<y;o=b+=1)d[n++]=t[m++];break;case 1:for(o=v=0;v<y;o=v+=1)e=t[m++],s=o<f?0:d[n-f],d[n++]=(e+s)%256;break;case 2:for(o=A=0;A<y;o=A+=1)e=t[m++],r=(o-o%f)/f,x=g&&d[(g-1)*y+r*f+o%f],d[n++]=(x+e)%256;break;case 3:for(o=M=0;M<y;o=M+=1)e=t[m++],r=(o-o%f)/f,s=o<f?0:d[n-f],x=g&&d[(g-1)*y+r*f+o%f],d[n++]=(e+Math.floor((s+x)/2))%256;break;case 4:for(o=C=0;C<y;o=C+=1)e=t[m++],r=(o-o%f)/f,s=o<f?0:d[n-f],0===g?x=w=0:(x=d[(g-1)*y+r*f+o%f],w=r&&d[(g-1)*y+(r-1)*f+o%f]),a=s+x-w,u=Math.abs(a-s),h=Math.abs(a-x),p=Math.abs(a-w),c=u<=h&&u<=p?s:h<=p?x:w,d[n++]=(e+c)%256;break;default:throw new Error("Invalid filter algorithm: "+t[m-1])}g++}return d},o.prototype.decodePalette=function(){var t,e,n,r,o,s,i,a,l;for(n=this.palette,s=this.transparency.indexed||[],o=new Uint8Array((s.length||0)+n.length),r=0,n.length,t=0,e=i=0,a=n.length;i<a;e=i+=3)o[r++]=n[e],o[r++]=n[e+1],o[r++]=n[e+2],o[r++]=null!=(l=s[t++])?l:255;return o},o.prototype.copyToImageData=function(t,e){var n,r,o,s,i,a,l,u,c,h,p;if(r=this.colors,c=null,n=this.hasAlphaChannel,this.palette.length&&(c=null!=(p=this._decodedPalette)?p:this._decodedPalette=this.decodePalette(),r=4,n=!0),u=(o=t.data||t).length,i=c||e,s=a=0,1===r)for(;s<u;)l=c?4*e[s/4]:a,h=i[l++],o[s++]=h,o[s++]=h,o[s++]=h,o[s++]=n?i[l++]:this.transparency.grayscale&&this.transparency.grayscale===h?0:255,a=l;else for(;s<u;)l=c?4*e[s/4]:a,o[s++]=i[l++],o[s++]=i[l++],o[s++]=i[l++],o[s++]=n?i[l++]:this.transparency.rgb&&this.transparency.rgb[1]===i[l-3]&&this.transparency.rgb[3]===i[l-2]&&this.transparency.rgb[5]===i[l-1]?0:255,a=l},o.prototype.decode=function(){var t;return t=new Uint8Array(this.width*this.height*4),this.copyToImageData(t,this.decodePixels()),t},n=t.document&&t.document.createElement("canvas"),r=n&&n.getContext("2d"),e=function(t){var e;return r.width=t.width,r.height=t.height,r.clearRect(0,0,t.width,t.height),r.putImageData(t,0,0),(e=new Image).src=n.toDataURL(),e},o.prototype.decodeFrames=function(t){var n,r,o,s,i,a,l,u;if(this.animation){for(u=[],r=i=0,a=(l=this.animation.frames).length;i<a;r=++i)n=l[r],o=t.createImageData(n.width,n.height),s=this.decodePixels(new Uint8Array(n.data)),this.copyToImageData(o,s),n.imageData=o,u.push(n.image=e(o));return u}},o.prototype.renderFrame=function(t,e){var n,r,o;return n=(r=this.animation.frames)[e],o=r[e-1],0===e&&t.clearRect(0,0,this.width,this.height),1===(null!=o?o.disposeOp:void 0)?t.clearRect(o.xOffset,o.yOffset,o.width,o.height):2===(null!=o?o.disposeOp:void 0)&&t.putImageData(o.imageData,o.xOffset,o.yOffset),0===n.blendOp&&t.clearRect(n.xOffset,n.yOffset,n.width,n.height),t.drawImage(n.image,n.xOffset,n.yOffset)},o.prototype.animate=function(t){var e,n,r,o,s,i,a=this;return n=0,i=this.animation,o=i.numFrames,r=i.frames,s=i.numPlays,(e=function(){var i,l;if(i=n++%o,l=r[i],a.renderFrame(t,i),o>1&&n/o<s)return a.animation._timeout=setTimeout(e,l.delay)})()},o.prototype.stopAnimation=function(){var t;return clearTimeout(null!=(t=this.animation)?t._timeout:void 0)},o.prototype.render=function(t){var e,n;return t._png&&t._png.stopAnimation(),t._png=this,t.width=this.width,t.height=this.height,e=t.getContext("2d"),this.animation?(this.decodeFrames(e),this.animate(e)):(n=e.createImageData(this.width,this.height),this.copyToImageData(n,this.decodePixels()),e.putImageData(n,0,0))},o}(self);const v=new Set(["jpg","png","bmp","gif"]);async function A(t,e){if(!w.Z)throw new r.A("rasterCoded:decode","lerc decoder is not supported on big endian platform");await(0,p.Hh)();const{offset:n}=e,{width:o,height:a,pixelType:l,statistics:u,depthCount:c,noDataValues:h,bandMasks:f,pixels:d,mask:m}=(0,p.D4)(t,{inputOffset:n,returnInterleaved:e.returnInterleaved}),g=new s.A({width:o,height:a,pixelType:l.toLowerCase(),pixels:d,mask:m,statistics:u.map((({minValue:t,maxValue:e})=>new i.z(t,e))),bandMasks:f,depthCount:c,noDataValues:h});return u?.length||g.updateStatistics(),g}async function M(t,e){const n=await(0,x.D4)(t,{...e,noDataValue:null});(0,o.Lw)(n);const r=new s.A({width:n.width,height:n.height,pixels:n.pixels,pixelType:n.pixelType.toLowerCase(),mask:n.mask,bandMasks:n.bandMasks,statistics:null});return r.updateStatistics(),r}function C(t,e){const n=e.pixelType||"u8",r=s.A.getPixelArrayConstructor(n),o="u8"===n?t:new r(t.buffer),i=[],a=e.planes||1;if(1===a)i.push(o);else for(let n=0;n<a;n++){const s=(e.width||1)*(e.height||t.length),l=new r(s);for(let t=0;t<s;t++)l[t]=o[t*a+n];i.push(l)}const l=new s.A({width:e.width||1,height:e.height||t.length,pixels:i,pixelType:n,statistics:null});return l.updateStatistics(),l}function k(t,e){return C(new l.Z(new Uint8Array(t)).getBytes(),e)}function T(t,e){return C((0,f.D)(t,e.offset,e.eof,!e.isInputBigEndian),e)}function P(t,e,n){const{pixelTypeCtor:r}=function(t){let e=null,n=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":n=255,e=Uint8Array;break;case"u16":n=n||65535,e=Uint16Array;break;case"u32":n=n||2**32-1,e=Uint32Array;break;case"s8":n=n||-128,e=Int8Array;break;case"s16":n=n||-32768,e=Int16Array;break;case"s32":n=n||0-2**31,e=Int32Array;break;default:e=Float32Array}return{pixelTypeCtor:e,noDataValue:n}}(e.pixelType),o=(0,y.decode)(t,{width:e.width,height:e.height,pixelType:r,format:n}),i=new s.A({width:e.width,height:e.height,pixels:o.pixels,pixelType:e.pixelType,mask:o.mask,statistics:null});return i.updateStatistics(),i}function S(t,e){const n=h.decode(t,e.hasNoZlibMask??void 0),r=new s.A({width:n.width,height:n.height,pixels:n.pixels,pixelType:"u8",mask:n.mask,statistics:null});return r.updateStatistics(),r}function _(t,e){const n=new Uint8Array(t),r=new b(n),{width:o,height:i}=e,a=o*i,l=r.decode();let u,c=0,h=0;const p=new Uint8Array(a);for(c=0;c<a;c++)p[c]=l[4*c+3];const f=new s.A({width:o,height:i,pixels:[],pixelType:"u8",mask:p,statistics:[]});for(c=0;c<3;c++){for(u=new Uint8Array(a),h=0;h<a;h++)u[h]=l[4*h+c];f.addData({pixels:u})}return f.updateStatistics(),f}function I(t){if(null==t)throw new r.A("rasterCodec:decode","parameter encodeddata is required.");const e=new Uint8Array(t,0,10);let n="";return 255===e[0]&&216===e[1]?n="jpg":137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]?n="png":67===e[0]&&110===e[1]&&116===e[2]&&90===e[3]&&73===e[4]&&109===e[5]&&97===e[6]&&103===e[7]&&101===e[8]&&32===e[9]?n="lerc":76===e[0]&&101===e[1]&&114===e[2]&&99===e[3]&&50===e[4]&&32===e[5]?n="lerc2":73===e[0]&&73===e[1]&&42===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&42===e[3]||73===e[0]&&73===e[1]&&43===e[2]&&0===e[3]||77===e[0]&&77===e[1]&&0===e[2]&&43===e[3]?n="tiff":71===e[0]&&73===e[1]&&70===e[2]?n="gif":66===e[0]&&77===e[1]?n="bmp":String.fromCharCode.apply(null,e).toLowerCase().includes("error")&&(n="error"),n}function R(t){let e=I(t);return"lerc2"===e?e="lerc":"error"===e&&(e=""),e}async function N(t,e={},n){if(null==t)throw new r.A("rasterCodec:decode","missing encodeddata parameter.");let o=e.format?.toLowerCase();if(!("bsq"!==o&&"bip"!==o||null!=e.width&&null!=e.height))throw new r.A("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===o&&e.customOptions)return async function(t,e){const n=await(0,x.s$)(t,e.customOptions),r=new s.A({width:n.width,height:n.height,pixels:n.pixels,pixelType:n.pixelType.toLowerCase(),mask:n.mask,statistics:null});return r.updateStatistics(),r}(t,e);if((!o||"bsq"!==o&&"bip"!==o&&"deflate"!==o&&"lzw"!==o)&&(o=I(t)),e.useCanvas&&v.has(o))return async function(t,e,n,r){const o=new u,i={applyJpegMask:!1,format:e,...n},a=await o.decode(t,i,r),l=new s.A(a);return l.updateStatistics(),l}(t,o,e,n);const i=function(t){let e=null;switch(t){case"lerc":case"lerc2":e=A;break;case"jpg":e=S;break;case"png":e=_;break;case"bsq":case"bip":e=(e,n)=>P(e,n,t);break;case"tiff":e=M;break;case"deflate":e=k;break;case"lzw":e=T;break;case"error":e=()=>{throw new r.A("rasterCodec:decode","input data contains error")};break;default:e=()=>{throw new r.A("rasterCodec:decode","unsupported raster format")}}return e}(o);let a;e.isPoint&&(null!=(e={...e}).width&&e.width++,null!=e.height&&e.height++);const{offsets:l}=e;if(l&&l.length>1){const n=l.map(((n,r)=>i(t.slice(n,l[r+1]),e))),r=await Promise.all(n);a=r[0],a.pixels=r.map((t=>t.pixels[0]));const o=r.map((t=>t.mask));r.some((t=>null!=t))&&(o.forEach(((t,e)=>{null==t&&(o[e]=new Uint8Array(a.width*a.height).fill(255))})),a.bandMasks=o,a.mask=s.A.combineBandMasks(o)),a.updateStatistics()}else a=await i(t,{...e,offset:l?.[0]??e.offset});return"jpg"!==o&&null!=e.noDataValue&&1===a.depthCount&&(0,d.Sp)(a,e.noDataValue,{customFloatTolerance:e.tolerance}),e.isPoint&&function(t,e=1){if(!t)return;const{pixels:n,width:r,height:o,mask:i}=t;if(!n||0===n.length)return;const a=n.length,l=r-1,u=o-1,c=[];let h,p,f,d,m,g,y=null;const x=s.A.getPixelArrayConstructor(t.pixelType);if(0===e){for(h=0;h<a;h++){for(m=n[h],g=new x(l*u),p=0;p<u;p++)for(d=p*r,f=0;f<l;f++)g[p*l+f]=m[d+f];c.push(g)}if(null!=i)for(y=new Uint8Array(l*u),p=0;p<u;p++)for(d=p*r,f=0;f<l;f++)y[p*l+f]=i[d+f]}else{for(h=0;h<a;h++){for(m=n[h],g=new x(l*u),p=0;p<u;p++)for(d=p*r,f=0;f<l;f++)g[p*l+f]=(m[d+f]+m[d+f+1]+m[d+r+f]+m[d+r+f+1])/4;c.push(g)}if(i)for(y=new Uint8Array(l*u),p=0;p<u;p++)for(d=p*r,f=0;f<l;f++)y[p*l+f]=Math.min.apply(null,[i[d+f],i[d+f+1],i[d+r+f],i[d+r+f+1]])}t.width=l,t.height=u,t.mask=y,t.pixels=c}(a),a}},3685:function(t,e,n){n.d(e,{Cr:function(){return I},D4:function(){return z},JM:function(){return L},XO:function(){return N},r9:function(){return E},s$:function(){return j},uT:function(){return D},uc:function(){return R},zS:function(){return F}}),n(58941);var r=n(11958),o=n(90735),s=n(80426),i=n(94235),a=n(95738),l=n(57328),u=n(70041),c=n(82499);const h=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],p=4294967296,f=new Set([1,5,6,7,8,34712,34887]);function d(t,e){let n="unknown";return 3===t?n=64===e?"f64":"f32":1===t?1===e?n="u1":2===e?n="u2":4===e?n="u4":e<=8?n="u8":e<=16?n="u16":e<=32&&(n="u32"):2===t&&(e<=8?n="s8":e<=16?n="s16":e<=32&&(n="s32")),n}function m(t){let e=null;switch(t?t.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f64":e=Float64Array;break;default:e=Float32Array}return e}function g(t,e){return{x:e[0]*t.x+e[1]*t.y+e[2],y:e[3]*t.x+e[4]*t.y+e[5]}}function y(t,e){return t.get(e)?.values}function x(t,e){return t.get(e)?.values}function w(t,e){return t.get(e)?.values?.[0]}function b(t,e){return t.get(e)?.values?.[0]}function v(t,e,n,r=0,o=l.A.tiffTags,s=4){const i=8===s,a=i?B(new DataView(t,n,8),0,e):new DataView(t,n,2).getUint16(0,e),u=4+2*s,c=i?8:2,h=c+a*u;if(n+h>t.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:h};const p=n+h+4<=t.byteLength?G(new DataView(t,n+h,8===s?8:4),0,e,8===s):null,f=n+c,d=new Map;let m,g,y,x,w,b=0,v=0;for(let n=0;n<a;n++){g=new DataView(t,f+u*n,u),y=g.getUint16(0,e),w=g.getUint16(2,e),x=l.A.getTagName(y,o);const i=[];2===s?(b=g.getUint16(4,e),v=g.getUint16(6,e)):4===s?(b=g.getUint32(4,e),v=g.getUint32(8,e)):8===s&&(b=G(g,4,e,!0),v=G(g,12,e,!0),i.push(g.getUint32(12,e)),i.push(g.getUint32(16,e))),m={id:y,type:w,valueCount:b,valueOffset:v,valueOffsets:i,values:null},I(t,e,m,r,!1,s),d.set(x,m)}return{success:!0,ifd:d,nextIFD:p,requiredBufferSize:h}}const A=(t,e)=>(0,s.D4)(t,{inputOffset:e}).pixels[0];function M(t,e){if(1!==e&&2!==e&&4!==e)return t;const n=new Uint8Array(t),r=8/e,o=new Uint8Array(t.byteLength*r);let s=0;const i=2**e-1;for(let t=0;t<n.length;t++){const a=n[t];for(let t=0;t<r;t++)o[s++]=a<<e*t>>>8-e&i}return o.buffer}function C(t,e,n){const r=new o.J;r.parse(t),r.colorTransform=6===n?-1:0;const s=r.getData(r.width,r.height,1!==e&&4!==e);return new Uint8Array(s.buffer)}function k(t){const e=new c.Z(t).getBytes(),n=new ArrayBuffer(e.length),r=new Uint8Array(n);return r.set(e),r}async function T(t,e,n,r,o){const a=u.Z===e,l=b(n,"BITSPERSAMPLE"),c=b(n,"SAMPLESPERPIXEL")??1,h=b(n,"PHOTOMETRICINTERPRETATION"),p=b(n,"SAMPLEFORMAT")??1,f=d(p,l),g=b(n,"COMPRESSION")??1,y=m(f);let x,w,v;if(34887===g)return await(0,s.Hh)(),A(t,r);if(1===g)x=t.slice(r,r+o),w=new Uint8Array(x);else if(8===g||32946===g)w=new Uint8Array(t,r,o),w=k(w),x=w.buffer;else if(6===g)w=new Uint8Array(t,r,o),w=C(w,c,h),x=w.buffer;else if(7===g){const e=n.get("JPEGTABLES").values,s=e.length-2;w=new Uint8Array(s+o-2);for(let t=0;t<s;t++)w[t]=e[t];const i=new Uint8Array(t,r+2,o-2);for(let t=0;t<i.length;t++)w[s+t]=i[t];w=C(w,c,h),x=w.buffer}else{if(5!==g)throw new Error("tiff-decode: unsupport compression "+g);w=(0,i.D)(t,r,o,e),x=w.buffer}if(x=M(x,l),"u8"===f||"s8"===f||a)v=new y(x);else{x=new ArrayBuffer(w.length);const t=new Uint8Array(x);switch(f){case"u16":case"s16":for(let e=0;e<w.length;e+=2)t[e]=w[e+1],t[e+1]=w[e];break;case"u32":case"s32":case"f32":for(let e=0;e<w.length;e+=4)t[e]=w[e+3],t[e+1]=w[e+2],t[e+2]=w[e+1],t[e+3]=w[e]}v=new y(x)}const T=b(n,"PREDICTOR")??1,P=b(n,"TILEWIDTH"),S=b(n,"TILELENGTH");if(T>1&&(5===g||8===g||32946===g)&&P&&S){const t=N(n),e=new y(v.length);e.set(v),v=function(t,e,n,r,o){const s=r?4:1,i=n*s*o;r&&(t=new Uint8Array(t.buffer));for(let n=0;n<e;n++){const e=n*i;for(let n=o;n<i;n++)t[e+n]+=t[e+n-o]}if(!r)return t;const a=new Uint8Array(t.length),l=n*o;for(let n=0;n<e;n++){const e=n*i;for(let n=0;n<l;n++)for(let r=0;r<s;r++)a[e+n*s+r]=t[e+n+(s-r-1)*l]}return new Float32Array(a.buffer)}(e,S,P,3===p&&3===T,t?1:c)}return v}const P=(t,e,n)=>{const r=u.Z===e.littleEndian,o=x(n,"STRIPOFFSETS");if(void 0===o)return null;const{width:s,height:a,pixelType:l}=R([n]),c=b(n,"SAMPLESPERPIXEL")||e.planes,h=b(n,"PHOTOMETRICINTERPRETATION"),p=s*a,f=b(n,"BITSPERSAMPLE"),d=m(l),g=new d(p*c),y=x(n,"STRIPBYTECOUNTS"),w=b(n,"ROWSPERSTRIP"),v=b(n,"COMPRESSION")??1;let A,T,P,S,_,I,N,F,E;if(f%8==0)for(A=0;A<o.length;A++){if(_=A*(w*s)*c,"u8"===l||"s8"===l||r)8===v||32946===v?(N=new Uint8Array(t,o[A],y[A]),N=k(N),I=N.buffer):6===v?(N=new Uint8Array(t,o[A],y[A]),N=C(N,c,h),I=N.buffer):5===v?(N=(0,i.D)(t,o[A],y[A],e.littleEndian),I=N.buffer):I=t.slice(o[A],o[A]+y[A]),I=M(I,f),S=new d(I);else{switch(6===v||8===v||32946===v?(N=new Uint8Array(t,o[A],y[A]),F=k(N),I=F.buffer):(I=new ArrayBuffer(y[A]),N=new Uint8Array(t,o[A],y[A]),F=new Uint8Array(I)),l){case"u16":case"s16":for(P=0;P<N.length;P+=2)F[P]=N[P+1],F[P+1]=N[P];break;case"u32":case"s32":case"f32":for(P=0;P<N.length;P+=4)F[P]=N[P+3],F[P+1]=N[P+2],F[P+2]=N[P+1],F[P+3]=N[P]}I=M(I,f),S=new d(I)}g.set(S,_)}const B=[];if(1===c)B.push(g);else for(A=0;A<c;A++){for(E=new d(p),T=0;T<p;T++)E[T]=g[T*c+A];B.push(E)}return{width:s,height:a,pixelType:l,pixels:B}},S=(t,e,n)=>{if(!(t&&t.length>0&&e&&n))return null;let r,o,s;const i=t[0].length,a=t.length,l=new Uint8Array(i);for(let u=0;u<a;u++)if(r=t[u],o=e[u],s=n[u],0===u)for(let t=0;t<i;t++)l[t]=r[t]<o||r[t]>s?0:1;else for(let t=0;t<i;t++)l[t]&&(l[t]=r[t]<o||r[t]>s?0:1);return l},_=t=>{if(!t)return null;const e=t.match(/<Item(.*?)Item>/gi);if(!e||0===e.length)return null;const n=new Map;let r,o,s,i,a;for(let t=0;t<e.length;t++)r=e[t],o=r.slice(6,r.indexOf(">")),i=r.indexOf("sample="),i>-1&&(a=r.slice(i+8,r.indexOf('"',i+8))),i=r.indexOf("name="),i>-1&&(o=r.slice(i+6,r.indexOf('"',i+6))),o&&(s=r.slice(r.indexOf(">")+1,r.indexOf("</Item>")).trim(),null!=a?n.has(o)?n.get(o)[a]=s:n.set(o,[s]):n.set(o,s)),a=null;const l=n.get("STATISTICS_MINIMUM"),u=n.get("STATISTICS_MAXIMUM"),c=n.get("STATISTICS_MEAN"),h=n.get("STATISTICS_STDDEV");let p=null;if(l&&u){p=[];for(let t=0;t<l.length;t++)p.push({min:parseFloat(l[t]),max:parseFloat(u[t]),avg:c&&parseFloat(c[t]),stddev:h&&parseFloat(h[t])})}const f=n.get("BandName"),d=n.get("WavelengthMin"),m=n.get("WavelengthMax");let g=null;if(f){g=[];for(let t=0;t<f.length;t++)g.push({BandName:f[t],WavelengthMin:d&&parseFloat(d[t]),WavelengthMax:m&&parseFloat(m[t])})}return{statistics:p,bandProperties:g,dataType:n.get("DataType"),rawMetadata:n}};function I(t,e,n,r=0,o=!1,s=4){if(n.values)return!0;const i=n.type,a=n.valueCount;let l=n.valueOffset,u=[];const c=h[i],f=8*c,d=a*c,m=a*h[i]*8;let g,y;const x=8===s?64:32,w=n.valueOffsets;if(m>x&&d>(o?t.byteLength:t?t.byteLength-l+r:0))return n.offlineOffsetSize=[l,d],n.values=null,!1;if(m<=x){if(!e)if(x<=32)l>>>=32-m;else{const t=w?.length?w[0]:l>>>0,e=w?.length?w[1]:Math.round((l-t)/p);m<=32?(l=t>>>32-m,w[0]=l):(l=t*2**(32-m)+(e>>>32-m),w[0]=t,w[1]=e>>>32-m)}if(1===a&&f===x)u=[l];else if(64===x){const t=w?.length?w[0]:l>>>0,e=w?.length?w[1]:Math.round((l-t)/p);let n=t,r=32;for(y=1;y<=a;y++){const t=32-f*y%32;if(r<f){const o=n<<t>>>32-r,s=e<<32-r>>>32-r;n=e,u.push(o+s*2**(f-r)),r-=32-(f-r)}else u.push(n<<t>>>32-f),r-=f;0===r&&(r=32,n=e)}}else for(y=1;y<=a;y++){const t=32-f*y;u.push(l<<t>>>32-f)}}else{l-=r,o&&(l=0);for(let n=l;n<l+d;n+=c){switch(i){case 1:case 2:case 7:g=new DataView(t,n,1).getUint8(0);break;case 3:g=new DataView(t,n,2).getUint16(0,e);break;case 4:case 13:g=new DataView(t,n,4).getUint32(0,e);break;case 5:g=new DataView(t,n,4).getUint32(0,e)/new DataView(t,n+4,4).getUint32(0,e);break;case 6:g=new DataView(t,n,1).getInt8(0);break;case 8:g=new DataView(t,n,2).getInt16(0,e);break;case 9:g=new DataView(t,n,4).getInt32(0,e);break;case 10:g=new DataView(t,n,4).getInt32(0,e)/new DataView(t,n+4,4).getInt32(0,e);break;case 11:g=new DataView(t,n,4).getFloat32(0,e);break;case 12:g=new DataView(t,n,8).getFloat64(0,e);break;case 16:case 18:g=B(new DataView(t,n,8),0,e);break;case 17:g=O(new DataView(t,n,8),0,e);break;default:g=null}u.push(g)}}if(2===i){let t="";const e=u;for(u=[],y=0;y<e.length;y++)0===e[y]&&""!==t?(u.push(t),t=""):t+=String.fromCharCode(e[y]);""===t&&0!==u.length||u.push(t)}return n.values=u,!0}function R(t){const e=t[0],n=b(e,"TILEWIDTH"),r=b(e,"TILELENGTH"),o=b(e,"IMAGEWIDTH"),s=b(e,"IMAGELENGTH"),i=b(e,"BITSPERSAMPLE"),a=b(e,"SAMPLESPERPIXEL"),l=b(e,"SAMPLEFORMAT")??1,u=d(l,i),c=N(e),h=y(e,"GDAL_NODATA");let p=null;h?.length&&(p=h.map((t=>parseFloat(t))),p.some((t=>isNaN(t)))&&(p=null));const m=b(e,"COMPRESSION")??1;let v;switch(m){case 1:v="NONE";break;case 2:case 3:case 4:case 32771:v="CCITT";break;case 5:v="LZW";break;case 6:case 7:v="JPEG";break;case 32773:v="PACKBITS";break;case 8:case 32946:v="DEFLATE";break;case 34712:v="JPEG2000";break;case 34887:v="LERC";break;default:v=String(m)}let A=!0,M="";f.has(m)||(A=!1,M+="unsupported tag compression "+m),l>3&&(A=!1,M+="unsupported tag sampleFormat "+l),1!==i&&2!==i&&4!==i&&i%8!=0&&(A=!1,M+="unsupported tag bitsPerSample "+i);const C=w(e,"GEOASCIIPARAMS");let k;if(C){const t=C.split("|").find((t=>t.includes("ESRI PE String = "))),e=t?t.replace("ESRI PE String = ",""):"";k=e.startsWith("COMPD_CS")||e.startsWith("PROJCS")||e.startsWith("GEOGCS")?{wkid:null,wkt:e}:null}const T=x(e,"GEOTIEPOINTS"),P=x(e,"GEOPIXELSCALE"),S=x(e,"GEOTRANSMATRIX"),I=e.has("GEOKEYDIRECTORY")?e.get("GEOKEYDIRECTORY").data:null;let R,B,O=!1,G=!1;if(I){O=2===b(I,"GTRasterTypeGeoKey");const t=b(I,"GTModelTypeGeoKey");if(2===t){const t=b(I,"GeographicTypeGeoKey");t>=1024&&t<=32766&&(k={wkid:t}),k||32767!==t||(G=!0,k={wkid:4326})}else if(1===t){const t=b(I,"ProjectedCSTypeGeoKey");t>=1024&&t<=32766&&(k={wkid:t})}}if(P&&T&&T.length>=6?(R=[P[0],0,T[3]-T[0]*P[0],0,-Math.abs(P[1]),T[4]-T[1]*P[1]],O&&(R[2]-=.5*R[0]+.5*R[1],R[5]-=.5*R[3]+.5*R[4])):S&&16===S.length&&(R=O?[S[0],S[1],S[3]-.5*S[0],S[4],S[5],S[7]-.5*S[5]]:[S[0],S[1],S[3],S[4],S[5],S[7]]),R){const t=[{x:0,y:s},{x:0,y:0},{x:o,y:s},{x:o,y:0}];let e,n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY;for(let o=0;o<t.length;o++)e=g(t[o],R),n=e.x>n?n:e.x,i=e.x<i?i:e.x,r=e.y>r?r:e.y,a=e.y<a?a:e.y;B={xmin:n,xmax:i,ymin:r,ymax:a,spatialReference:k}}else B={xmin:-.5,ymin:.5-s,xmax:o-.5,ymax:.5,spatialReference:k};G&&(B.xmax-B.xmin>400||Math.max(Math.abs(B.xmin),Math.abs(B.xmax))>361)&&(k=null,B.spatialReference=null);const D=F(t);let L,j,z,Z,V;if(D.length>0){z=Math.round(Math.log(o/b(D[0],"IMAGEWIDTH"))/Math.LN2);const t=D[D.length-1];Z=D.length,L=b(t,"TILEWIDTH"),j=b(t,"TILELENGTH")}L=null!=Z&&Z>0?L||n:null,j=null!=Z&&Z>0?j||r:null,n&&(V=[{maxCol:Math.ceil(o/n)-1,maxRow:Math.ceil(s/r)-1,minRow:0,minCol:0}],D.forEach((t=>{V.push({maxCol:Math.ceil(b(t,"IMAGEWIDTH")/b(t,"TILEWIDTH"))-1,maxRow:Math.ceil(b(t,"IMAGELENGTH")/b(t,"TILELENGTH"))-1,minRow:0,minCol:0})})));const W=w(t[0],"GDAL_METADATA"),H=_(W);M+=" "+U({width:o,height:s,tileWidth:n,tileHeight:r,planes:a,ifds:t});const J=E(t).length===D.length+1,q=D?.length?D.map((t=>({x:o/b(t,"IMAGEWIDTH"),y:s/b(t,"IMAGELENGTH")}))):void 0;return{width:o,height:s,tileWidth:n,tileHeight:r,planes:a,isBSQ:c,pixelType:u,compression:v,noData:p,hasMaskBand:J,isSupported:A,pyramidResolutions:q,message:M,extent:B,isPseudoGeographic:G,affine:P?null:R,firstPyramidLevel:z,maximumPyramidLevel:Z,pyramidBlockWidth:L,pyramidBlockHeight:j,tileBoundary:V,metadata:H}}function N(t,e){const n=y(t,"PLANARCONFIGURATION");return n?2===n[0]:!!e&&e.isBSQ}function F(t){return t.filter((t=>1===b(t,"NEWSUBFILETYPE")))}function E(t){return t.filter((t=>{const e=!(4&~(b(t,"NEWSUBFILETYPE")??0)),n=4===b(t,"PHOTOMETRICINTERPRETATION");return e&&n}))}function B(t,e,n){const r=t.getUint32(e,n),o=t.getUint32(e+4,n);return n?o*p+r:r*p+o}function O(t,e,n){let r=n?t.getInt32(e,n):t.getUint32(e,n),o=n?t.getUint32(e+4,n):t.getInt32(e+4,n);const s=(n?r:o)>=0?1:-1;return n?r*=s:o*=s,s*(n?o*p+r:r*p+o)}function G(t,e,n,r){return r?B(t,e,n):t.getUint32(e,n)}function D(t){const e=new DataView(t,0,16),n=e.getUint16(0,!1);let r=null;if(18761===n)r=!0;else{if(19789!==n)throw new Error("unexpected endianess byte");r=!1}const o=e.getUint16(2,r);if(42!==o&&43!==o)throw new Error("unexpected tiff identifier");let s=4;const i=43===o;if(i){const t=e.getUint16(s,r);if(s+=2,8!==t)throw new Error("unsupported bigtiff version");if(0!==e.getUint16(s,r))throw new Error("unsupported bigtiff version");s+=2}return{littleEndian:r,isBigTiff:i,firstIFDPos:G(e,s,r,i)}}function L(t,e,n,o=0,s=l.A.tiffTags,i=4){const a=v(t,e,n,o,s,i);let u;const c=a.ifd;if(c){if(l.A.ifdTags.forEach(((n,r)=>{c.has(r)&&(u=c.get(r),u.data=v(t,e,u.valueOffset-o,o,n).ifd)})),c.has("GEOKEYDIRECTORY")){u=c.get("GEOKEYDIRECTORY");const n=u.values;if(n&&n.length>4){const r=n[0]+"."+n[1]+"."+n[2];u.data=v(t,e,u.valueOffset+6-o,o,l.A.geoKeys,2).ifd,u.data&&u.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[r]})}}if(c.has("XMP")){u=c.get("XMP");const t=u.values;"number"==typeof t[0]&&7===u.type&&(u.values=[(0,r.w)(new Uint8Array(t))])}}return a}function U(t){const{width:e,height:n,tileHeight:r,tileWidth:o}=t,s=t.planes,i=o?o*r:e*n,a=b(t.ifds[0],"BITSPERSAMPLE");let l="";return i*s>2**30/(a>8?a/8:1)&&(l=o?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),l}async function j(t,e){const{headerInfo:n,ifd:r,offsets:o,sizes:s}=e,i=[];for(let e=0;e<o.length;e++){s[e];const a=await T(t,n.littleEndian,r,o[e],s[e]||t.byteLength);i.push(a)}const l=N(r,n),u=b(r,"BITSPERSAMPLE"),c=d(b(r,"SAMPLEFORMAT")??1,u),h=b(r,"SAMPLESPERPIXEL")||n.planes,p=m(c),f=b(r,"TILEWIDTH"),g=b(r,"TILELENGTH"),y=b(r,"COMPRESSION")??1,x=f*g;let w;const v=[];let A=i[0];const M=34887===y;for(let t=0;t<h;t++){if(w=new p(x),i.length===h)A=i[t],A.length===x&&(w=A);else if(A.length)if(l||M)w=A.length===x?A:A.slice(x*t,x*(t+1));else for(let e=0;e<x;e++)w[e]=A[e*h+t];v.push(w)}const C=n.noData?n.noData[0]:e.noDataValue,k=n.metadata?n.metadata.statistics:null,P=k?k.map((t=>t.min)):null,_=k?k.map((t=>t.max)):null,I={pixelType:c,width:f,height:g,pixels:v,noDataValue:C};return null!=C?(0,a.Sp)(I,C):P&&_&&e.applyMinMaxConstraint&&(I.mask=S(v,P,_)),I}async function z(t,e={}){const n=e.pyramidLevel||0,r=e.headerInfo||function(t){const{littleEndian:e,isBigTiff:n,firstIFDPos:r}=D(t);let o=r;const s=[];do{const r=L(t,e,o,0,l.A.tiffTags,n?8:4);if(!r.success)break;s.push(r.ifd),o=r.nextIFD}while(o>0);return{...R(s),littleEndian:e,isBigTiff:n,ifds:s,pyramidIFDs:F(s),maskIFDs:E(s)}}(t),{ifds:o,noData:s}=r;if(0===o.length)throw new Error("no valid image file directory");const i=U(r);if(i)throw i;let u=null;const c=-1===n?o[o.length-1]:o[n],h=s??e.noDataValue;return u=r.tileWidth?await async function(t,e,n){const r=x(n,"TILEOFFSETS");if(void 0===r)return null;const o=x(n,"TILEBYTECOUNTS"),{width:s,height:i,pixelType:a,tileWidth:l,tileHeight:u}=R([n]),c=N(n,e),h=b(n,"SAMPLESPERPIXEL")||e.planes,p=s*i,f=b(n,"BITSPERSAMPLE"),d=34887===(b(n,"COMPRESSION")??1),g=m(a),y=[];for(let t=0;t<h;t++)y.push(new g(p));let w,v,A,M,C,k,P,S,_,I,F,E,B;const O=Math.ceil(s/l),G=new Uint8Array(p).fill(255);let D=!1;if(f%8==0)if(d&&c&&h>1){const a=Math.round(r.length/h);for(w=0;w<a;w++){k=Math.floor(w/O)*u,P=w%O*l,S=k*s+P;for(let a=0;a<h;a++){const c=w*h+a;for(0===o[c]?(A=null,D=!0):A=await T(t,e.littleEndian,n,r[c],o[c]),I=0,_=S,E=Math.min(l,s-P),F=Math.min(u,i-k),B=y[a],M=0;M<F;M++)for(_=S+M*s,I=M*l,C=0;C<E;C++,_++,I++)A?B[_]=A[I]:G[_]=0}}}else for(w=0;w<r.length;w++)for(k=Math.floor(w/O)*u,P=w%O*l,S=k*s+P,0===o[w]?(A=null,D=!0):A=await T(t,e.littleEndian,n,r[w],o[w]),I=0,_=S,E=Math.min(l,s-P),F=Math.min(u,i-k),v=0;v<h;v++)if(B=y[v],c||d)for(M=0;M<F;M++)for(_=S+M*s,I=l*u*v+M*l,C=0;C<E;C++,_++,I++)A?B[_]=A[I]:G[_]=0;else for(M=0;M<F;M++)for(_=S+M*s,I=M*l*h+v,C=0;C<E;C++,_++,I+=h)A?B[_]=A[I]:G[_]=0;return{width:s,height:i,pixelType:a,pixels:y,mask:D?G:void 0}}(t,r,c):P(t,r,c),u?(null!=h&&(0,a.Sp)(u,h),u):u}},57328:function(t,e,n){n.d(e,{A:function(){return a}});const r=(()=>{const t=[];return t[254]="NEWSUBFILETYPE",t[255]="SUBFILETYPE",t[256]="IMAGEWIDTH",t[257]="IMAGELENGTH",t[258]="BITSPERSAMPLE",t[259]="COMPRESSION",t[262]="PHOTOMETRICINTERPRETATION",t[263]="THRESHHOLDING",t[264]="CELLWIDTH",t[265]="CELLLENGTH",t[266]="FILLORDER",t[269]="DOCUMENTNAME",t[270]="IMAGEDESCRIPTION",t[271]="MAKE",t[272]="MODEL",t[273]="STRIPOFFSETS",t[274]="ORIENTATION",t[277]="SAMPLESPERPIXEL",t[278]="ROWSPERSTRIP",t[279]="STRIPBYTECOUNTS",t[280]="MINSAMPLEVALUE",t[281]="MAXSAMPLEVALUE",t[282]="XRESOLUTION",t[283]="YRESOLUTION",t[284]="PLANARCONFIGURATION",t[285]="PAGENAME",t[286]="XPOSITION",t[287]="YPOSITION",t[288]="FREEOFFSETS",t[289]="FREEBYTECOUNTS",t[290]="GRAYRESPONSEUNIT",t[291]="GRAYRESPONSECURVE",t[292]="T4OPTIONS",t[293]="T6OPTIONS",t[296]="RESOLUTIONUNIT",t[297]="PAGENUMBER",t[300]="COLORRESPONSEUNIT",t[301]="TRANSFERFUNCTION",t[305]="SOFTWARE",t[306]="DATETIME",t[315]="ARTIST",t[316]="HOSTCOMPUTER",t[317]="PREDICTOR",t[318]="WHITEPOINT",t[319]="PRIMARYCHROMATICITIES",t[320]="COLORMAP",t[321]="HALFTONEHINTS",t[322]="TILEWIDTH",t[323]="TILELENGTH",t[324]="TILEOFFSETS",t[325]="TILEBYTECOUNTS",t[326]="BADFAXLINES",t[327]="CLEANFAXDATA",t[328]="CONSECUTIVEBADFAXLINES",t[330]="SUBIFD",t[332]="INKSET",t[333]="INKNAMES",t[334]="NUMBEROFINKS",t[336]="DOTRANGE",t[337]="TARGETPRINTER",t[338]="EXTRASAMPLES",t[339]="SAMPLEFORMAT",t[340]="SMINSAMPLEVALUE",t[341]="SMAXSAMPLEVALUE",t[342]="TRANSFERRANGE",t[347]="JPEGTABLES",t[512]="JPEGPROC",t[513]="JPEGIFOFFSET",t[514]="JPEGIFBYTECOUNT",t[515]="JPEGRESTARTINTERVAL",t[517]="JPEGLOSSLESSPREDICTORS",t[518]="JPEGPOINTTRANSFORM",t[519]="JPEGQTABLES",t[520]="JPEGDCTABLES",t[521]="JPEGACTABLES",t[529]="YCBCRCOEFFICIENTS",t[530]="YCBCRSUBSAMPLING",t[531]="YCBCRPOSITIONING",t[532]="REFERENCEBLACKWHITE",t[700]="XMP",t[33550]="GEOPIXELSCALE",t[33922]="GEOTIEPOINTS",t[33432]="COPYRIGHT",t[42112]="GDAL_METADATA",t[42113]="GDAL_NODATA",t[50844]="RPCCOEFFICIENT",t[34264]="GEOTRANSMATRIX",t[34735]="GEOKEYDIRECTORY",t[34736]="GEODOUBLEPARAMS",t[34737]="GEOASCIIPARAMS",t[34665]="EXIFIFD",t[34853]="GPSIFD",t[40965]="INTEROPERABILITYIFD",t})(),o=(()=>{const t=r.slice();return t[36864]="ExifVersion",t[40960]="FlashpixVersion",t[40961]="ColorSpace",t[42240]="Gamma",t[37121]="ComponentsConfiguration",t[37122]="CompressedBitsPerPixel",t[40962]="PixelXDimension",t[40963]="PixelYDimension",t[37500]="MakerNote",t[37510]="UserComment",t[40964]="RelatedSoundFile",t[36867]="DateTimeOriginal",t[36868]="DateTimeDigitized",t[36880]="OffsetTime",t[36881]="OffsetTimeOriginal",t[36882]="OffsetTimeDigitized",t[37520]="SubSecTime",t[37521]="SubSecTimeOriginal",t[37522]="SubSecTimeDigitized",t[37888]="Temperature",t[37889]="Humidity",t[37890]="Pressure",t[37891]="WaterDepth",t[37892]="Acceleration",t[37893]="CameraElevationAngle",t[42016]="ImageUniqueID",t[42032]="CameraOwnerName",t[42033]="BodySerialNumber",t[42034]="LensSpecification",t[42035]="LensMake",t[42036]="LensModel",t[42037]="LensSerialNumber",t[33434]="ExposureTime",t[33437]="FNumber",t[34850]="ExposureProgram",t[34852]="SpectralSensitivity",t[34855]="PhotographicSensitivity",t[34856]="OECF",t[34864]="SensitivityType",t[34865]="StandardOutputSensitivity",t[34866]="RecommendedExposureIndex",t[34867]="ISOSpeed",t[34868]="ISOSpeedLatitudeyyy",t[34869]="ISOSpeedLatitudezzz",t[37377]="ShutterSpeedValue",t[37378]="ApertureValue",t[37379]="BrightnessValue",t[37380]="ExposureBiasValue",t[37381]="MaxApertureValue",t[37382]="SubjectDistance",t[37383]="MeteringMode",t[37384]="LightSource",t[37385]="Flash",t[37386]="FocalLength",t[37396]="SubjectArea",t[41483]="FlashEnergy",t[41484]="SpatialFrequencyResponse",t[41486]="FocalPlaneXResolution",t[41487]="FocalPlaneYResolution",t[41488]="FocalPlaneResolutionUnit",t[41492]="SubjectLocation",t[41493]="ExposureIndex",t[41495]="SensingMethod",t[41728]="FileSource",t[41729]="SceneType",t[41730]="CFAPattern",t[41985]="CustomRendered",t[41986]="ExposureMode",t[41987]="WhiteBalance",t[41988]="DigitalZoomRatio",t[41989]="FocalLengthIn35mmFilm",t[41990]="SceneCaptureType",t[41991]="GainControl",t[41992]="Contrast",t[41993]="Saturation",t[41994]="Sharpness",t[41995]="DeviceSettingDescription",t[41996]="SubjectDistanceRange",t})(),s=(()=>{const t=[];return t[1024]="GTModelTypeGeoKey",t[1025]="GTRasterTypeGeoKey",t[1026]="GTCitationGeoKey",t[2048]="GeographicTypeGeoKey",t[2049]="GeogCitationGeoKey",t[2050]="GeogGeodeticDatumGeoKey",t[2051]="GeogPrimeMeridianGeoKey",t[2052]="GeogLinearUnitsGeoKey",t[2053]="GeogLinearUnitSizeGeoKey",t[2054]="GeogAngularUnitsGeoKey",t[2055]="GeogAngularUnitSizeGeoKey",t[2056]="GeogEllipsoidGeoKey",t[2057]="GeogSemiMajorAxisGeoKey",t[2058]="GeogSemiMinorAxisGeoKey",t[2059]="GeogInvFlatteningGeoKey",t[2061]="GeogPrimeMeridianLongGeoKey",t[2060]="GeogAzimuthUnitsGeoKey",t[3072]="ProjectedCSTypeGeoKey",t[3073]="PCSCitationGeoKey",t[3074]="ProjectionGeoKey",t[3075]="ProjCoordTransGeoKey",t[3076]="ProjLinearUnitsGeoKey",t[3077]="ProjLinearUnitSizeGeoKey",t[3078]="ProjStdParallel1GeoKey",t[3079]="ProjStdParallel2GeoKey",t[3080]="ProjNatOriginLongGeoKey",t[3081]="ProjNatOriginLatGeoKey",t[3082]="ProjFalseEastingGeoKey",t[3083]="ProjFalseNorthingGeoKey",t[3084]="ProjFalseOriginLongGeoKey",t[3085]="ProjFalseOriginLatGeoKey",t[3086]="ProjFalseOriginEastingGeoKey",t[3087]="ProjFalseOriginNorthingGeoKey",t[3088]="ProjCenterLongGeoKey",t[3090]="ProjCenterEastingGeoKey",t[3091]="ProjCenterNorthingGeoKey",t[3092]="ProjScaleAtNatOriginGeoKey",t[3093]="ProjScaleAtCenterGeoKey",t[3094]="ProjAzimuthAngleGeoKey",t[3095]="ProjStraightVertPoleLongGeoKey",t[4096]="VerticalCSTypeGeoKey",t[4097]="VerticalCitationGeoKey",t[4098]="VerticalDatumGeoKey",t[4099]="VerticalUnitsGeoKey",t})(),i=new Map;i.set("EXIFIFD",o),i.set("GPSIFD",["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"]);const a={tiffTags:r,ifdTags:i,geoKeys:s,getTagName:(t,e)=>{let n=(e||r)[t];return void 0===n&&(n="unknown"+String(t)),n}}},95738:function(t,e,n){n.d(e,{$p:function(){return c},Sp:function(){return h},X1:function(){return a},hP:function(){return i},yM:function(){return u},zw:function(){return l}});const r=9999999e31,o=2e-7,s={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function i(t){return s[t]??[-34028234663852886e22,34028234663852886e22]}function a(t,e){return null==t||null==e?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function l(t){return(t?.startsWith("s")||t?.startsWith("u"))??!1}function u(t,e,n,r){let[o,s]=i(n);const a=l(n);return a&&(o-=1e-5,s+=1e-5),a?n.startsWith("u")?function(t,e,n,r){const[o,s]=r;for(let r=0;r<e.length;r++)if(e[r]){const i=t[r];i<o||i>s?e[r]=0:n[r]=i+.5|0}}(t,e,r,[o,s]):function(t,e,n,r){const[o,s]=r;for(let r=0;r<e.length;r++)if(e[r]){const i=t[r];i<o||i>s?e[r]=0:n[r]=i+(i>0?.5:-.5)|0}}(t,e,r,[o,s]):function(t,e,n,r){const[o,s]=r;for(let r=0;r<e.length;r++)if(e[r]){const i=t[r];i<o||i>s?e[r]=0:n[r]=i}}(t,e,r,[o,s])}function c(t,e){for(let n=0;n<e.length;n++)e[n]&&isNaN(t[n])&&(e[n]=0,t[n]=0)}function h(t,e,n){if(t.depthCount&&t.depthCount>1)return;const{pixels:s,statistics:a,pixelType:l}=t,u=s[0].length,c=t.bandMasks??[],h=t.mask??new Uint8Array(u).fill(255),p="f32"===l||"f64"===l,f=i(l);let d=!1;for(let t=0;t<s.length;t++){const i="number"==typeof e?e:e[t];if(null==i)continue;const u=a?.[t]?.minValue??f[0],m=a?.[t]?.maxValue??f[1];if(u>i+Number.EPSILON||m<i-Number.EPSILON)continue;const g=c[t]||h.slice(),y=s[t],x=n?.customFloatTolerance;if(p&&0!==x){let t=x;t||(t=Math.abs(i)>=r?o*Math.abs(i):"f32"===l?2**-23:Number.EPSILON);for(let e=0;e<y.length;e++)g[e]&&Math.abs(y[e]-i)<t&&(y[e]=0,g[e]=0,h[e]=0,d=!0)}else for(let t=0;t<y.length;t++)g[t]&&y[t]===i&&(y[t]=0,g[t]=0,h[t]=0,d=!0);c[t]=g}d&&(t.bandMasks=t.bandMasks||t.pixels.length>1?c:null,t.mask=h),d&&"updateStatistics"in t&&t.updateStatistics()}},70041:function(t,e,n){n.d(e,{Z:function(){return r}});const r=(()=>{const t=new ArrayBuffer(4),e=new Uint8Array(t);return new Uint32Array(t)[0]=1,1===e[0]})()},67090:function(t,e,n){n.d(e,{$Q:function(){return a},Sd:function(){return l},b7:function(){return u}});var r=n(62938),o=n(91484),s=n(45532),i=n(21327);async function a(t,e,r){if("extent"===r.type)return function(t,e,n){const{width:r,height:o}=t,s=new Uint8Array(r*o),a=e.width/r,l=e.height/o;if(n.width/a<.5||n.height/l<.5)return new i.A({pixelType:t.pixelType,width:r,height:o,mask:s,pixels:[...t.pixels]});const{xmin:u,xmax:c,ymin:h,ymax:p}=e,{xmin:f,xmax:d,ymin:m,ymax:g}=n,y=Math.max(u,f),x=Math.min(c,d),w=Math.max(h,m),b=Math.min(p,g),v=.5*a,A=.5*l;if(x-y<v||b-w<A||x<u+v||y>c-v||w>p-A||b<h+A)return new i.A({pixelType:t.pixelType,width:r,height:o,mask:s,pixels:[...t.pixels]});const M=Math.max(0,(y-u)/a),C=Math.min(r,Math.max(0,(x-u)/a)),k=Math.max(0,(p-b)/l),T=Math.min(o,Math.max(0,(p-w)/l)),P=Math.round(M),S=Math.round(C)-1,_=Math.round(k),I=Math.round(T)-1;if(P===S&&M%1>.5&&C%1<.5||_===I&&k%1>.5&&T%1<.5)return new i.A({pixelType:t.pixelType,width:r,height:o,mask:s,pixels:[...t.pixels]});if(0===P&&0===_&&S===r&&I===o)return t;const R=t.mask;for(let t=_;t<=I;t++)for(let e=P;e<=S;e++){const n=t*r+e;s[n]=R?R[n]:255}return new i.A({pixelType:t.pixelType,width:r,height:o,mask:s,pixels:[...t.pixels]})}(t,e,r);const{width:o,height:s}=t,a=new Uint8Array(o*s),{contains:l,intersects:u}=await n.e(5418).then(n.bind(n,22162));return u(e,r)?"polyline"===r.type?function(t,e,n){const{width:r,height:o}=t,s=new Uint8Array(r*o),a=e.width/r,l=e.height/o,{xmin:u,ymax:c}=e,{paths:h}=n,p=t.mask;for(let t=0;t<h.length;t++){const e=h[t];for(let t=0;t<e.length-1;t++){const[n,i]=e[t],[h,f]=e[t+1];let d=Math.floor((c-i)/l),m=Math.floor((c-f)/l);if(m<d){const t=d;d=m,m=t}d=Math.max(0,d),m=Math.min(o-1,m);const g=(h-n)/(f-i);for(let t=d;t<=m;t++){const e=t===d?Math.max(i,f):(o+1-t)*l,c=t===m?Math.min(i,f):e-l;let y=f===i?Math.floor((n-u)/a):Math.floor((g*(e-i)+n-u)/a),x=f===i?Math.floor((h-u)/a):Math.floor((g*(c-i)+n-u)/a);if(x<y){const t=y;y=x,x=t}const w=t*r;y=Math.max(0,y),x=Math.min(r-1,x);for(let t=w+y;t<=w+x;t++)s[t]=p?p[t]:255}}}return new i.A({pixelType:t.pixelType,width:r,height:o,mask:s,pixels:[...t.pixels]})}(t,e,r):l(r,e)?t:function(t,e,n){if(!t)return t;const{width:r,height:o}=t,s=e.width/r,a=e.height/o,{xmin:l,ymax:u}=e;let c;if("extent"===n.type){const t=(n.xmin-l)/s,e=(n.xmax-l)/s,r=(u-n.ymax)/a,o=(u-n.ymin)/a;c=[[[t,r],[t,o],[e,o],[e,r],[t,r]]]}else c=n.rings.map((t=>t.map((([t,e])=>[(t-l)/s,(u-e)/a]))));const h=document.createElement("canvas");h.width=r,h.height=o;const p=h.getContext("2d");p.fillStyle="#f00",p.beginPath(),c.forEach((t=>{p.moveTo(t[0][0],t[0][1]);for(let e=0;e<t.length;e++)p.lineTo(t[e][0],t[e][1]);p.closePath()})),p.fill();const f=p.getImageData(0,0,r,o).data,d=t.mask,m=r*o,g=new Uint8Array(m);for(let t=0;t<m;t++)d&&!d[t]||(g[t]=f[4*t+3]>127?255:0);return new i.A({pixelType:t.pixelType,width:r,height:o,mask:g,maskIsAlpha:!1,pixels:[...t.pixels]})}(t,e,r):new i.A({pixelType:t.pixelType,width:o,height:s,mask:a,maskIsAlpha:!1,pixels:[...t.pixels]})}function l(t,e){const{extent:n}=u(t,e,new s.default({x:t.pixelSize.x,y:t.pixelSize.y,spatialReference:t.spatialReference})),{extent:r}=t.extent;if(n.xmax=Math.min(n.xmax,r.xmax),n.ymax=Math.min(n.ymax,r.ymax),n.xmin<n.xmax&&n.ymin<n.ymax){const{x:e,y:r}=t.pixelSize,o=Math.round(n.width/e),s=Math.round(n.height/r);t.extent=n,t.width=o,t.height=s}}function u(t,e,n,s=!0){const{spatialReference:i}=t,{x:a,y:l}=function(t,e){if(t.spatialReference.equals(e))return t;const n=(0,r.GA)(t.spatialReference),o=(0,r.GA)(e);if(n===o)return t;const s=n/o;return{x:t.x*s,y:t.y*s}}(n,i);let u,c,h;const p="extent"===e.type?e:e.extent;let{xmin:f,xmax:d,ymax:m,ymin:g}=p;const{xmin:y,ymax:x}=t.extent;return s?(f=y+(f>y?a*Math.round((f-y)/a):0),m=x-(m<x?l*Math.round((x-m)/l):0),d=y+(d>y?a*Math.round((d-y)/a):0),g=x-(g<x?l*Math.round((x-g)/l):0),u=new o.default({xmin:f,ymax:m,xmax:d,ymin:g,spatialReference:i}),c=Math.round(u.width/a),h=Math.round(u.height/l)):(c=Math.floor((d-f)/a+.8),h=Math.floor((m-g)/l+.8),f=y+(f>y?a*Math.floor((f-y)/a+.1):0),m=x-(m<x?l*Math.floor((x-m)/l+.1):0),d=f+c*a,g=m-h*l,u=new o.default({xmin:f,ymax:m,xmax:d,ymin:g,spatialReference:i})),{extent:u,width:c,height:h}}},43264:function(t,e,n){n.d(e,{$i:function(){return G},AB:function(){return u},Ew:function(){return g},Hx:function(){return m},IB:function(){return r},J$:function(){return E},LY:function(){return M},QF:function(){return O},UK:function(){return d},Wb:function(){return o},Wt:function(){return A},Wy:function(){return c},XU:function(){return v},dK:function(){return b},eH:function(){return f},et:function(){return l},lD:function(){return F},qL:function(){return p},z$:function(){return T},z7:function(){return k},zg:function(){return h}});var r,o,s,i=n(21327),a=n(95738);(s=r||(r={}))[s.matchAny=0]="matchAny",s[s.matchAll=1]="matchAll",function(t){t[t.bestMatch=0]="bestMatch",t[t.fail=1]="fail"}(o||(o={}));const l=6;function u(t){return null!=t&&"esri.layers.support.PixelBlock"===t.declaredClass&&t.pixels&&t.pixels.length>0}function c(t){if(!t?.length||t.some((t=>!u(t))))return null;if(1===t.length)return t[0]?.clone()??null;const e=t,{width:n,height:r,pixelType:o}=e[0];if(e.some((t=>t.width!==n||t.height!==r)))return null;const s=e.map((({mask:t})=>t)).filter((t=>null!=t));let a=null;s.length&&(a=new Uint8Array(n*r),a.set(s[0]),s.length>1&&w(s.slice(1),a));const l=[];e.forEach((({pixels:t})=>l.push(...t)));const c=e.map((({statistics:t})=>t)).filter((t=>t?.length)),h=[];return c.forEach((t=>h.push(...t))),new i.A({pixelType:o,width:n,height:r,mask:a,pixels:l,statistics:h.length?h:null})}function h(t){if(!t)return;const e=t.colormap;if(!e||0===e.length)return;const n=e.sort(((t,e)=>t[0]-e[0]));let r=0;n[0][0]<0&&(r=n[0][0]);const o=Math.max(256,n[n.length-1][0]-r+1),s=new Uint8Array(4*o),i=[];let a,l=0,u=0;const c=5===n[0].length;if(o>65536)return n.forEach((t=>{i[t[0]-r]=c?t.slice(1):t.slice(1).concat([255])})),{indexed2DColormap:i,offset:r,alphaSpecified:c};if(t.fillUnspecified)for(a=n[u],l=a[0]-r;l<o;l++)s[4*l]=a[1],s[4*l+1]=a[2],s[4*l+2]=a[3],s[4*l+3]=c?a[4]:255,l===a[0]-r&&(a=u===n.length-1?a:n[++u]);else for(l=0;l<n.length;l++)a=n[l],u=4*(a[0]-r),s[u]=a[1],s[u+1]=a[2],s[u+2]=a[3],s[u+3]=c?a[4]:255;return{indexedColormap:s,offset:r,alphaSpecified:c}}function p(t,e){if(!u(t))return t;if(!e||!e.indexedColormap&&!e.indexed2DColormap)return t;const n=t.clone(),r=n.pixels;let o=n.mask;const s=n.width*n.height;if(1!==r.length)return t;const{indexedColormap:i,indexed2DColormap:a,offset:l,alphaSpecified:c}=e;let h=0;const p=r[0],f=new Uint8Array(p.length),d=new Uint8Array(p.length),m=new Uint8Array(p.length);let g,y=0;if(i){const t=i.length-1;if(null!=o)for(h=0;h<s;h++)o[h]&&(y=4*(p[h]-l),y<l||y>t?o[h]=0:(f[h]=i[y],d[h]=i[y+1],m[h]=i[y+2],o[h]=i[y+3]));else{for(o=new Uint8Array(s),h=0;h<s;h++)y=4*(p[h]-l),y<l||y>t?o[h]=0:(f[h]=i[y],d[h]=i[y+1],m[h]=i[y+2],o[h]=i[y+3]);n.mask=o}}else if(a)if(null!=o)for(h=0;h<s;h++)o[h]&&(g=a[p[h]],f[h]=g[0],d[h]=g[1],m[h]=g[2],o[h]=g[3]);else{for(o=new Uint8Array(s),h=0;h<s;h++)g=a[p[h]],f[h]=g[0],d[h]=g[1],m[h]=g[2],o[h]=g[3];n.mask=o}return n.pixels=[f,d,m],n.statistics=null,n.pixelType="u8",n.maskIsAlpha=c,n}function f(t,e){if(!u(t))return null;const{pixels:n,mask:r}=t,o=n.length;let s=e.lut;const{offset:a}=e;s&&1===s[0].length&&(s=n.map((()=>s)));const l=[],c=e.outputPixelType||"u8";for(let t=0;t<o;t++){const e=d(n[t],r,s[t],a||0,c);l.push(e)}const h=new i.A({width:t.width,height:t.height,pixels:l,mask:r,pixelType:c});return h.updateStatistics(),h}function d(t,e,n,r,o){const s=t.length,a=i.A.createEmptyBand(o,s);if(e)for(let o=0;o<s;o++)e[o]&&(a[o]=n[t[o]-r]);else for(let e=0;e<s;e++)a[e]=n[t[e]-r];return a}function m(t,e){if(!u(t))return null;const n=t.clone(),{pixels:r}=n,o=n.width*n.height,s=e.length,i=Math.floor(s/2),a=e[Math.floor(i)],l=r[0];let c,h,p,f,d,m,g=!1;const y=new Uint8Array(o),x=new Uint8Array(o),w=new Uint8Array(o);let b=n.mask;const v=4===e[0].mappedColor.length;for(b||(b=new Uint8Array(o),b.fill(v?255:1),n.mask=b),d=0;d<o;d++)if(b[d]){for(c=l[d],g=!1,m=i,h=a,p=0,f=s-1;f-p>1;){if(c===h.value){g=!0;break}c>h.value?p=m:f=m,m=Math.floor((p+f)/2),h=e[Math.floor(m)]}g||(c===e[p].value?(h=e[p],g=!0):c===e[f].value?(h=e[f],g=!0):c<e[p].value?(g=!1,h=null):c>e[p].value&&(c<e[f].value?(h=e[p],g=!0):f===s-1?(g=!1,h=null):(h=e[f],g=!0))),g?(y[d]=h.mappedColor[0],x[d]=h.mappedColor[1],w[d]=h.mappedColor[2],b[d]=h.mappedColor[3]):y[d]=x[d]=w[d]=b[d]=0}return n.pixels=[y,x,w],n.mask=b,n.pixelType="u8",n.maskIsAlpha=v,n}function g(t,e){if(!u(t))return null;const{width:n,height:r}=t,{inputRanges:o,outputValues:s,outputPixelType:l,noDataRanges:c,allowUnmatched:h,isLastInputRangeInclusive:p}=e,f=t.pixels[0],d=i.A.createEmptyBand(l,f.length),m=t.mask,g=new Uint8Array(n*r);m?g.set(m):g.fill(255);const y=t.pixelType.startsWith("f")?1e-6:0,x=o.map((t=>t-y));x[0]=o[0],x[x.length-1]=o[o.length-1]+(p?1e-6:0);const w=o.length/2,[b,v]=(0,a.hP)(l);for(let t=0;t<r;t++)for(let e=0;e<n;e++){const r=t*n+e;if(g[r]){const t=f[r];let e=!1;for(let n=w-1;n>=0;n--)if(t===x[2*n]||t>x[2*n]&&t<x[2*n+1]){d[r]=s[n],e=!0;break}e||(h?d[r]=t>v?v:t<b?b:t:g[r]=0)}}const A=c?.length;if(A)for(let t=0;t<r;t++)for(let e=0;e<n;e++){const r=t*n+e;if(!m||m[r]){const t=f[r];for(let e=0;e<A;e+=2)if(t>=c[e]&&t<=c[e+1]){d[r]=0,g[r]=0;break}}}return new i.A({width:n,height:r,pixelType:l,pixels:[d],mask:g})}function y(t,e,n,r){const o=null!=n&&n.length>=2?new Set(n):null,s=1===n?.length?n[0]:null,i=!!e?.length;for(let n=0;n<t.length;n++)if(r[n]){const a=t[n];if(i){let t=!1;for(let n=0;n<e.length;n+=2)if(a>=e[n]&&a<=e[n+1]){t=!0;break}t||(r[n]=0)}r[n]&&(a===s||o?.has(a))&&(r[n]=0)}}function x(t,e){const n=t[0].length;for(let r=0;r<n;r++)if(e[r]){let n=!1;for(let e=0;e<t.length;e++)if(t[e][r]){n=!0;break}n||(e[r]=0)}}function w(t,e){const n=t[0].length;for(let r=0;r<n;r++)if(e[r]){let n=!1;for(let e=0;e<t.length;e++)if(0===t[e][r]){n=!0;break}n&&(e[r]=0)}}function b(t,e){if(!u(t))return null;const{width:n,height:r,pixels:o}=t,s=n*r,a=new Uint8Array(s);t.mask?a.set(t.mask):a.fill(255);const l=o.length,{includedRanges:c,noDataValues:h,outputPixelType:p,matchAll:f,lookups:m}=e;if(m){const t=[];for(let e=0;e<l;e++){const n=m[e],r=d(o[e],a,n.lut,n.offset||0,"u8");t.push(r)}1===t.length?a.set(t[0]):f?x(t,a):w(t,a)}else if(f){const t=[];for(let e=0;e<l;e++){const n=new Uint8Array(s);n.set(a),y(o[e],c?.slice(2*e,2*e+2),h?.[e],n),t.push(n)}1===t.length?a.set(t[0]):x(t,a)}else for(let t=0;t<l;t++)y(o[t],c?.slice(2*t,2*t+2),h?.[t],a);return new i.A({width:n,height:r,pixelType:p,pixels:o,mask:a})}function v(t){const{srcPixelType:e,inputRanges:n,outputValues:r,allowUnmatched:o,noDataRanges:s,isLastInputRangeInclusive:l,outputPixelType:u}=t;if("u8"!==e&&"s8"!==e&&"u16"!==e&&"s16"!==e)return null;const c=e.includes("16")?65536:256,h=e.includes("s")?-c/2:0,p=i.A.createEmptyBand(u,c),f=new Uint8Array(c);o&&f.fill(255);const[d,m]=(0,a.hP)(u);if(n?.length&&r?.length){const t=1e-6,e=n.map((e=>e-t));e[0]=n[0],l&&(e[e.length-1]=n[n.length-1]);for(let t=0;t<e.length;t++){const n=r[t]>m?m:r[t]<d?d:r[t],o=Math.ceil(e[2*t]-h),s=Math.floor(e[2*t+1]-h);for(let t=o;t<=s;t++)p[t]=n,f[t]=255}}if(s?.length)for(let t=0;t<s.length;t++){const e=Math.ceil(s[2*t]-h),n=Math.floor(s[2*t+1]-h);for(let t=e;t<=n;t++)f[t]=0}return{lut:p,offset:h,mask:f}}function A(t,e,n){if("u8"!==t&&"s8"!==t&&"u16"!==t&&"s16"!==t)return null;const r=t.includes("16")?65536:256,o=t.includes("s")?-r/2:0,s=new Uint8Array(r);if(e)for(let t=0;t<e.length;t++){const n=Math.ceil(e[2*t]-o),r=Math.floor(e[2*t+1]-o);for(let t=n;t<=r;t++)s[t]=255}else s.fill(255);if(n)for(let t=0;t<n.length;t++)s[n[t]-o]=0;return{lut:s,offset:o}}function M(t,e){if(!t||0===t.length)return null;const n=t.find((t=>t.pixelBlock));if(null==n?.pixelBlock)return null;const r=(n.extent.xmax-n.extent.xmin)/n.pixelBlock.width,o=(n.extent.ymax-n.extent.ymin)/n.pixelBlock.height,s=.01*Math.min(r,o),i=t.sort(((t,e)=>Math.abs(t.extent.ymax-e.extent.ymax)>s?e.extent.ymax-t.extent.ymax:Math.abs(t.extent.xmin-e.extent.xmin)>s?t.extent.xmin-e.extent.xmin:0)),a=Math.min.apply(null,i.map((t=>t.extent.xmin))),l=Math.min.apply(null,i.map((t=>t.extent.ymin))),u=Math.max.apply(null,i.map((t=>t.extent.xmax))),c=Math.max.apply(null,i.map((t=>t.extent.ymax))),h={x:Math.round((e.xmin-a)/r),y:Math.round((c-e.ymax)/o)},p={width:Math.round((u-a)/r),height:Math.round((c-l)/o)},f={width:Math.round((e.xmax-e.xmin)/r),height:Math.round((e.ymax-e.ymin)/o)};return Math.round(p.width/n.pixelBlock.width)*Math.round(p.height/n.pixelBlock.height)!==i.length||h.x<0||h.y<0||p.width<f.width||p.height<f.height?null:{extent:e,pixelBlock:k(i.map((t=>t.pixelBlock)),p,{clipOffset:h,clipSize:f})}}function C(t,e,n,r,o,s){const{width:i,height:a}=n.block,{x:l,y:u}=n.offset,{width:c,height:h}=n.mosaic,p=function(t,e,n,r,o,s,i,a){return{xmin:o<=n*t?0:o<n*t+t?o-n*t:t,ymin:s<=r*e?0:s<r*e+e?s-r*e:e,xmax:o+i<=n*t?0:o+i<n*t+t?o+i-n*t:t,ymax:s+a<=r*e?0:s+a<r*e+e?s+a-r*e:e}}(i,a,r,o,l,u,c,h);let f=0,d=0;if(s){const t=s.hasGCSSShiftTransform?360:s.halfWorldWidth??0,e=i*s.resolutionX,n=s.startX+r*e;n<t&&n+e>t?d=s.rightPadding:n>=t&&(f=s.leftMargin-s.rightPadding,d=0)}if(p.xmax-=d,"number"!=typeof e)for(let n=p.ymin;n<p.ymax;n++){const s=(o*a+n-u)*c+(r*i-l)+f,h=n*i;for(let n=p.xmin;n<p.xmax;n++)t[s+n]=e[h+n]}else for(let n=p.ymin;n<p.ymax;n++){const s=(o*a+n-u)*c+(r*i-l)+f;for(let n=p.xmin;n<p.xmax;n++)t[s+n]=e}}function k(t,e,n={}){const{clipOffset:r,clipSize:o,alignmentInfo:s,blockWidths:a}=n;if(a)return function(t,e,n){const r=t.find((t=>null!=t));if(null==r)return null;const o=t.some((t=>null==t||!!t.mask)),{width:s,height:a}=e,l=o?new Uint8Array(s*a):null,{blockWidths:c}=n,h=[],p=r.getPlaneCount(),f=i.A.getPixelArrayConstructor(r.pixelType);if(o)for(let e=0,n=0;e<t.length;n+=c[e],e++){const r=t[e];if(!u(r))continue;const o=r.mask;for(let t=0;t<a;t++)for(let i=0;i<c[e];i++)l[t*s+i+n]=null==o?255:o[t*r.width+i]}const d=t.some((t=>t?.bandMasks&&t.bandMasks.length>1)),m=d?[]:void 0,g=s*a;for(let e=0;e<p;e++){const n=new f(g),r=d?new Uint8Array(g):void 0;for(let o=0,i=0;o<t.length;i+=c[o],o++){const l=t[o];if(!u(l))continue;const h=l.pixels[e];if(null!=h){for(let t=0;t<a;t++)for(let e=0;e<c[o];e++)n[t*s+e+i]=h[t*l.width+e];if(r){const t=l.bandMasks?.[e]??l.mask;for(let e=0;e<a;e++)for(let n=0;n<c[o];n++)r[e*s+n+i]=t?t[e*l.width+n]:255}}}h.push(n),m&&r&&m.push(r)}const y=new i.A({width:s,height:a,mask:l,bandMasks:m,pixels:h,pixelType:r.pixelType});return y.updateStatistics(),y}(t,e,{blockWidths:a});const l=t.find((t=>u(t)));if(null==l)return null;const c=o?o.width:e.width,h=o?o.height:e.height,p=l.width,f=l.height,d=e.width/p,m=e.height/f,g={offset:r||{x:0,y:0},mosaic:o||e,block:{width:p,height:f}},y=l.pixelType,x=i.A.getPixelArrayConstructor(y),w=l.pixels.length,b=[];let v,A;for(let e=0;e<w;e++){A=new x(c*h);for(let n=0;n<m;n++)for(let r=0;r<d;r++){const o=t[n*d+r];u(o)&&(v=o.pixels[e],C(A,v,g,r,n,s))}b.push(A)}const M=t.some((t=>null==t||null!=t.mask&&t.mask.length>0)),k=t.some((t=>t?.bandMasks&&t.bandMasks.length>1)),T=M?new Uint8Array(c*h):void 0,P=k?[]:void 0;if(T){for(let e=0;e<m;e++)for(let n=0;n<d;n++){const r=t[e*d+n],o=null!=r?r.mask:null;C(T,null!=o?o:r?255:0,g,n,e,s)}if(P)for(let e=0;e<w;e++){const n=new Uint8Array(c*h);for(let r=0;r<m;r++)for(let o=0;o<d;o++){const i=t[r*d+o],a=i?.bandMasks?.[e]??i?.mask;C(n,null!=a?a:i?255:0,g,o,r,s)}P.push(n)}}const S=new i.A({width:c,height:h,pixels:b,pixelType:y,bandMasks:P,mask:T});return S.updateStatistics(),S}function T(t,e,n){if(!u(t))return null;const{width:r,height:o}=t,s=e.x,i=e.y,a=n.width+s,l=n.height+i;if(s<0||i<0||a>r||l>o)return t;if(0===s&&0===i&&a===r&&l===o)return t;t.mask||(t.mask=new Uint8Array(r*o));const c=t.mask;for(let t=0;t<o;t++){const e=t*r;for(let n=0;n<r;n++)c[e+n]=t<i||t>=l||n<s||n>=a?0:1}return t.updateStatistics(),t}function P(t){if(!u(t))return null;const e=t.clone(),{width:n,height:r,pixels:o}=t,s=o[0],i=e.pixels[0],a=t.mask;for(let t=2;t<r-1;t++){const e=new Map;for(let r=t-2;r<t+2;r++)for(let t=0;t<4;t++){const o=r*n+t;I(e,s[o],a?a[o]:1)}i[t*n]=S(e),i[t*n+1]=i[t*n+2]=i[t*n];let r=3;for(;r<n-1;r++){let o=(t-2)*n+r+1;I(e,s[o],a?a[o]:1),o=(t-1)*n+r+1,I(e,s[o],a?a[o]:1),o=t*n+r+1,I(e,s[o],a?a[o]:1),o=(t+1)*n+r+1,I(e,s[o],a?a[o]:1),o=(t-2)*n+r-3,_(e,s[o],a?a[o]:1),o=(t-1)*n+r-3,_(e,s[o],a?a[o]:1),o=t*n+r-3,_(e,s[o],a?a[o]:1),o=(t+1)*n+r-3,_(e,s[o],a?a[o]:1),i[t*n+r]=S(e)}i[t*n+r+1]=i[t*n+r]}for(let t=0;t<n;t++)i[t]=i[n+t]=i[2*n+t],i[(r-1)*n+t]=i[(r-2)*n+t];return e.updateStatistics(),e}function S(t){if(0===t.size)return 0;let e=0,n=-1,r=0;const o=t.keys();let s=o.next();for(;!s.done;)r=t.get(s.value),r>e&&(n=s.value,e=r),s=o.next();return n}function _(t,e,n){if(0===n)return;const r=t.get(e);1===r?t.delete(e):t.set(e,r-1)}function I(t,e,n){0!==n&&t.set(e,t.has(e)?t.get(e)+1:1)}function R(t,e,n){let{x:r,y:o}=e;const{width:s,height:a}=n;if(0===r&&0===o&&a===t.height&&s===t.width)return t;const{width:l,height:c}=t,h=Math.max(0,o),p=Math.max(0,r),f=Math.min(r+s,l),d=Math.min(o+a,c);if(f<0||d<0||!u(t))return null;r=Math.max(0,-r),o=Math.max(0,-o);const{pixels:m}=t,g=s*a,y=m.length,x=[];for(let e=0;e<y;e++){const n=m[e],a=i.A.createEmptyBand(t.pixelType,g);for(let t=h;t<d;t++){const e=t*l;let i=(t+o-h)*s+r;for(let t=p;t<f;t++)a[i++]=n[e+t]}x.push(a)}const w=new Uint8Array(g),b=t.mask;for(let t=h;t<d;t++){const e=t*l;let n=(t+o-h)*s+r;for(let t=p;t<f;t++)w[n++]=b?b[e+t]:1}const v=new i.A({width:n.width,height:n.height,pixelType:t.pixelType,pixels:x,mask:w});return v.updateStatistics(),v}function N(t,e=!0){if(!u(t))return null;const{pixels:n,width:r,height:o,mask:s,pixelType:a}=t,l=[],c=Math.round(r/2),h=Math.round(o/2),p=o-1,f=r-1;for(let t=0;t<n.length;t++){const s=n[t],u=i.A.createEmptyBand(a,c*h);let d=0;for(let t=0;t<o;t+=2)for(let n=0;n<r;n+=2){const o=s[t*r+n];if(e){const e=n===f?o:s[t*r+n+1],i=t===p?o:s[t*r+n+r],a=n===f?i:t===p?e:s[t*r+n+r+1];u[d++]=(o+e+i+a)/4}else u[d++]=o}l.push(u)}let d=null;if(null!=s){d=new Uint8Array(c*h);let t=0;for(let n=0;n<o;n+=2)for(let o=0;o<r;o+=2){const i=s[n*r+o];if(e){const e=o===f?i:s[n*r+o+1],a=n===p?i:s[n*r+o+r],l=o===f?a:n===p?e:s[n*r+o+r+1];d[t++]=i*e*a*l?1:0}else d[t++]=i}}return new i.A({width:c,height:h,pixelType:a,pixels:l,mask:d})}function F(t,e,n=0,r=!0){if(!u(t))return null;const{width:o,height:s}=e;let{width:i,height:a}=t;const l=new Map,c={x:0,y:0},h=1+n;let p=t;for(let t=0;t<h;t++){const n=Math.ceil(i/o),u=Math.ceil(a/s);for(let r=0;r<u;r++){c.y=r*s;for(let s=0;s<n;s++){c.x=s*o;const n=R(p,c,e);l.set(`${t}/${r}/${s}`,n)}}t<h-1&&(p=N(p,r)),i=Math.round(i/2),a=Math.round(a/2)}return l}function E(t){const{pixelBlock:e,tileSize:n,level:r,row:o,col:s,useBilinear:i}=t;if(!u(e))return null;const{width:a,height:l}=n,c=2**r,h=c*a,p=c*l;let f=R(e,{y:o*p,x:s*h},{width:h,height:p});if(!f)return null;for(let t=r;t>0;t--)f=N(f,i);return f}function B(t,e,n,r,o=0){const{width:s,height:i}=t,{width:a,height:l}=e,u=r.cols,c=r.rows,h=Math.ceil(a/u-.1/u),p=Math.ceil(l/c-.1/c);let f,d,m,g,y,x,w;const b=h*u,v=b*p*c,A=new Float32Array(v),M=new Float32Array(v),C=new Uint32Array(v),k=new Uint32Array(v);let T,P,S=0;for(let t=0;t<p;t++)for(let e=0;e<h;e++){f=12*(t*h+e),d=n[f],m=n[f+1],g=n[f+2],y=n[f+3],x=n[f+4],w=n[f+5];for(let n=0;n<c;n++){S=(t*c+n)*b+e*u,P=(n+.5)/c;for(let t=0;t<n;t++)T=(t+.5)/u,A[S+t]=(d*T+m*P+g)*s+o,M[S+t]=(y*T+x*P+w)*i+o,C[S+t]=Math.floor(A[S+t]),k[S+t]=Math.floor(M[S+t])}f+=6,d=n[f],m=n[f+1],g=n[f+2],y=n[f+3],x=n[f+4],w=n[f+5];for(let n=0;n<c;n++){S=(t*c+n)*b+e*u,P=(n+.5)/c;for(let t=n;t<u;t++)T=(t+.5)/u,A[S+t]=(d*T+m*P+g)*s+o,M[S+t]=(y*T+x*P+w)*i+o,C[S+t]=Math.floor(A[S+t]),k[S+t]=Math.floor(M[S+t])}}return{offsets_x:A,offsets_y:M,offsets_xi:C,offsets_yi:k,gridWidth:b}}function O(t,e){const{coefficients:n,spacing:r}=e,{offsets_x:o,offsets_y:s,gridWidth:i}=B(t,t,n,{rows:r[0],cols:r[1]}),{width:a,height:l}=t,u=new Float32Array(a*l),c=180/Math.PI;for(let t=0;t<l;t++)for(let e=0;e<a;e++){const n=t*i+e,r=0===t?n:n-i,h=t===l-1?n:n+i,p=o[r]-o[h],f=s[h]-s[r];if(isNaN(p)||isNaN(f))u[t*a+e]=90;else{let n=Math.atan2(f,p)*c;n=(360+n)%360,u[t*a+e]=n}}return u}function G(t,e,n,r,o="nearest"){if(!u(t))return null;"majority"===o&&(t=P(t));const{pixels:s,mask:a,bandMasks:l,pixelType:c}=t,h=t.width,p=t.height,f=i.A.getPixelArrayConstructor(c),d=s.length,{width:m,height:g}=e;let y=!1;for(let t=0;t<n.length;t+=3)-1===n[t]&&-1===n[t+1]&&-1===n[t+2]&&(y=!0);const{offsets_x:x,offsets_y:w,offsets_xi:b,offsets_yi:v,gridWidth:A}=B({width:h,height:p},e,n,r,"majority"===o?.5:0);let M;const C=(t,e,n,r)=>{const o=t instanceof Float32Array||t instanceof Float64Array?0:.5;for(let s=0;s<g;s++){M=s*A;for(let i=0;i<m;i++){if(x[M]<0||w[M]<0)t[s*m+i]=0;else if(r)t[s*m+i]=e[b[M]+v[M]*h];else{const r=Math.floor(x[M]),a=Math.floor(w[M]),l=Math.ceil(x[M]),u=Math.ceil(w[M]),c=x[M]-r,p=w[M]-a;if(!n||n[r+a*h]&&n[l+a*h]&&n[r+u*h]&&n[l+u*h]){const n=(1-c)*e[r+a*h]+c*e[l+a*h],f=(1-c)*e[r+u*h]+c*e[l+u*h];t[s*m+i]=(1-p)*n+p*f+o}else t[s*m+i]=e[b[M]+v[M]*h]}M++}}},k=[];let T;const S=l?.length===d,_=[];for(let t=0;t<d;t++){if(S){const e=new Uint8Array(m*g);C(e,l[t],l[t],!0),_.push(e)}T=new f(m*g),C(T,s[t],S?l[t]:a,"nearest"===o||"majority"===o),k.push(T)}const I=new i.A({width:m,height:g,pixelType:c,pixels:k,bandMasks:S?_:void 0});if(null!=a)I.mask=new Uint8Array(m*g),C(I.mask,a,a,!0);else if(y){I.mask=new Uint8Array(m*g);for(let t=0;t<m*g;t++)I.mask[t]=x[t]<0||w[t]<0?0:1}return I.updateStatistics(),I}},56991:function(t,e,n){n.d(e,{vt:function(){return Lr},UD:function(){return Dr}});var r=n(75505),o=n(39819),s=n(21609),i=n(53804),a=n(23502),l=(n(58941),n(40633),n(13798),n(65953)),u=n(95738),c=n(30905);let h=class extends c.oY{constructor(){super(...arguments),this.raster=void 0}};(0,i._)([(0,a.MZ)({json:{write:!0}})],h.prototype,"raster",void 0),h=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.BaseFunctionArguments")],h);const p=h;var f;let d=f=class extends p{constructor(){super(...arguments),this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new f({raster:this.raster,raster2:this.raster2,operation:this.operation})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],d.prototype,"operation",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],d.prototype,"raster2",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],d.prototype,"rasters",null),d=f=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],d);const m=d;var g=n(77560),y=n(21327),x=n(98521);const w=new Set(["slope","aspect","curvature","hillshade","shadedrelief","statistics"]);let b=class extends c.oY{constructor(){super(...arguments),this.functionArguments=null,this.readingBufferSize=0,this.id=-1,this.isNoopProcess=!1,this.rawInputBandIds=[],this.rawSourceRasterInfos=null,this.isInputBandIdsSwizzled=!1,this.swizzledBandSelection=[],this.isBranch=!1,this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){const t=this.getWebGLProcessorDefinition();if(!t)return null;const e=[t],{parameters:n}=t;let r=n.rasters||n.raster&&[n.raster];for(;r?.length;){e.unshift(...r);const t=[];for(let e=0;e<r.length;e++){const{parameters:n}=r[e],o=n.rasters||n.raster&&[n.raster];o?.length&&t.push(...o)}r=t}for(let t=e.length-1;t>=0;t--)e[t].isNoopProcess&&e.splice(t,1);let o=!1;for(let t=0;t<e.length;t++){const n=e[t];n.id=e.length-t-1;const{rasters:r}=n.parameters;o=o||null!=r&&r.length>1}const s=e.some((({name:t})=>w.has(t.toLowerCase()))),{rawSourceRasterInfos:i}=this;return{functions:e,hasBranches:o,hasFocalFunction:s,isSourceSingleBand:1===i?.[0]?.bandCount}}bind(t,e=!1,n=-1){this.id=n+1;const r=this._getRasterValues();let o=!0;for(let n=0;n<r.length;n++){const s=r[n];if(null!=s&&this._isRasterFunctionValue(s)){const r=s.bind(t,e,this.id+n);if(!r.success)return this._bindingResult=r,r;o=o&&r.supportsGPU}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=o&&this._bindingResult.supportsGPU,this.processInputBandIds(),this._bindingResult):(this._bindingResult={success:!0,supportsGPU:!0},this.processInputBandIds(),this._bindingResult)}process(t){const e=this._getRasterValues(),n=0===e.length?t.pixelBlocks??t.primaryPixelBlocks:e.map((e=>this._readRasterValue(e,t)));return this._processPixels({...t,pixelBlocks:n})}processInputBandIds(){const t=this._getRasterValues().filter(this._isRasterFunctionValue);let e;if(t.length>1){const e=t.map((t=>t.processInputBandIds()[0]));this.rawInputBandIds=e,this.isInputBandIdsSwizzled=this.rawInputBandIds.some(((t,e)=>t!==e));const n=t.filter((t=>"ExtractBand"===t.functionName));return n.length&&n.forEach(((t,e)=>{t.isInputBandIdsSwizzled=!0,t.swizzledBandSelection=[e,e,e]})),this.rawInputBandIds}const n=t[0];if(n){if(e=n.processInputBandIds(),n.isInputBandIdsSwizzled)return this.rawInputBandIds=e,e}else{e=[];const{bandCount:t}=this.sourceRasterInfos[0];for(let n=0;n<t;n++)e.push(n)}const r=this._getInputBandIds(e);return this.isInputBandIdsSwizzled=r.some(((t,e)=>t!==e)),this.rawInputBandIds=r,this.rawInputBandIds}getPrimaryRasters(){const t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}getWebGLProcessorDefinition(){const t=this._getWebGLParameters(),{raster:e,rasters:n}=this.functionArguments;return n&&Array.isArray(n)&&n.length?(t.rasters=n.map((t=>this._isRasterFunctionValue(t)?t.getWebGLProcessorDefinition():"number"==typeof t?{name:"Constant",parameters:{value:t},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:t},pixelType:"f32",id:-1,isNoopProcess:!1})),t.rasters.some((t=>null!=t))||(t.rasters=null)):this._isRasterFunctionValue(e)&&(t.raster=e.getWebGLProcessorDefinition()),{name:this.functionName,parameters:t,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}getClippingGeometries(){const t=[];"Clip"===this.functionName&&t.push(this.functionArguments);const{raster:e,rasters:n}=this.functionArguments;if(n&&Array.isArray(n)&&n.length)n.forEach((e=>{if(this._isRasterFunctionValue(e)){const n=e.getClippingGeometries();t.push(...n)}}));else if(this._isRasterFunctionValue(e)){const n=e.getClippingGeometries();t.push(...n)}return t}_getOutputPixelType(t){return"unknown"===this.outputPixelType?t:this.outputPixelType??t}_getWebGLParameters(){return{}}_getInputBandIds(t){return t}_removeStatsHistColormapVAT(t){t.statistics=null,t.histograms=null,t.colormap=null,t.attributeTable=null,t.multidimensionalInfo?.variables.forEach((t=>{t.statistics=void 0,t.histograms=void 0}))}_getRasterValues(){const{rasterArgumentNames:t}=this;return"rasters"===t[0]?this.functionArguments.rasters??[]:t.flatMap((t=>this.functionArguments[t]))}_getSourceRasterInfos(t){const e=this._getRasterValues(),{rasterInfos:n,rasterIds:r}=t;if(0===e.length)return n;const o=e.map((t=>t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&r.includes(t)?n[r.indexOf(t)]:"number"!=typeof t?n[0]:void 0)),s=o.find((t=>t))??n[0];return o.forEach(((t,e)=>{void 0===t&&(o[e]=s)})),o}_getPrimaryRasterId(t){return t?.rasterId}_getPrimaryRasters(t,e=[],n=[]){for(let r=0;r<t.sourceRasters.length;r++){const o=t.sourceRasters[r];if("number"!=typeof o)if("bind"in o)this._getPrimaryRasters(o,e,n);else{const t=o,r=this._getPrimaryRasterId(t);if(null==r)continue;n.includes(r)||(this.mainPrimaryRasterId===r?(e.unshift(t),n.unshift(r)):(e.push(t),n.push(r)))}}}_isRasterFunctionValue(t){return null!=t&&"object"==typeof t&&"getWebGLProcessorDefinition"in t}_readRasterValue(t,e){const{primaryPixelBlocks:n}=e;if(null==t||"$$"===t){const t=n[0];return null==t?null:t.clone()}if("string"==typeof t){const r=e.primaryRasterIds.indexOf(t);return-1===r?null:n[r]}if("number"==typeof t){const e=n[0];if(null==e)return null;const{width:r,height:o,pixelType:s}=e,i=new Float32Array(r*o);i.fill(t);const a=this.sourceRasterInfos[0].bandCount,l=new Array(a).fill(i);return new y.A({width:r,height:o,pixelType:s,pixels:l})}return t.process(e)}_patchRasterInfo(){const{rasterInfo:t}=this;if(!t?.keyProperties)return;const{bandCount:e,keyProperties:n,statistics:r,histograms:o}=t,s=n.BandProperties;s&&s.length!==e&&(t.keyProperties={...n,BandProperties:void 0}),r&&r.length!==e&&(t.statistics=r.length>e?r.slice(0,e):null),o&&o.length!==e&&(t.histograms=o.length>e?o.slice(0,e):null),n.BAND_COUNT&&Number(n.BAND_COUNT)!==e&&(t.keyProperties={...n,BAND_COUNT:"string"==typeof n.BAND_COUNT?String(e):e})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}}),(0,g.w)((t=>t?.toLowerCase()))],b.prototype,"outputPixelType",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"mainPrimaryRasterId",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"sourceRasters",void 0),(0,i._)([(0,a.MZ)({type:[x.A],json:{write:!0}})],b.prototype,"sourceRasterInfos",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"rasterInfo",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"readingBufferSize",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],b.prototype,"id",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"isNoopProcess",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"supportsGPU",null),(0,i._)([(0,a.MZ)()],b.prototype,"rawInputBandIds",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"rawSourceRasterInfos",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"isInputBandIdsSwizzled",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"swizzledBandSelection",void 0),(0,i._)([(0,a.MZ)()],b.prototype,"isBranch",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],b.prototype,"flatWebGLFunctionChain",null),(0,i._)([(0,a.MZ)()],b.prototype,"_bindingResult",void 0),b=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.BaseRasterFunction")],b);const v=b,A={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255},M={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},C={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},k={setNull:50,conditional:78},T={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65,...M,...C,majority:38,max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75,...k},P=new Map([[C.acos,{domain:[0,Math.PI],isInteger:!1}],[C.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[C.atan,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[C.cos,{domain:[-1,1],isInteger:!1}],[C.sin,{domain:[-1,1],isInteger:!1}],[M.booleanAnd,{domain:[0,1],isInteger:!0}],[M.booleanNot,{domain:[0,1],isInteger:!0}],[M.booleanOr,{domain:[0,1],isInteger:!0}],[M.booleanXOr,{domain:[0,1],isInteger:!0}],[M.equalTo,{domain:[0,1],isInteger:!0}],[M.notEqual,{domain:[0,1],isInteger:!0}],[M.greaterThan,{domain:[0,1],isInteger:!0}],[M.greaterThanEqual,{domain:[0,1],isInteger:!0}],[M.lessThan,{domain:[0,1],isInteger:!0}],[M.lessThanEqual,{domain:[0,1],isInteger:!0}],[M.isNull,{domain:[0,1],isInteger:!0}]]);function S(t){return P.get(t)}const _=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];function I(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]+o[t]);return i}function R(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand("f32",o);return s.set(r),s}function N(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);for(let t=0;t<o;t++)e&&!e[t]||(s[t]=r[t]*r[t]);return s}function F(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]-o[t]);return i}function E(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]*o[t]);return i}function B(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);for(let t=0;t<o;t++)e&&!e[t]||(s[t]=Math.sign(r[t])*Math.floor(Math.abs(r[t])));return s}function O(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]/o[t]);return i}function G(t,e,n){return O(t,e,"f32")}function D(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=Math.floor(r[t]/o[t]));return i}function L(t,e,n,r){const o=t[0],s=o.length,i=y.A.createEmptyBand(n,s);if(r===C.atanh){for(let t=0;t<s;t++)if(e[t]){const n=o[t];Math.abs(n)>=1?e[t]=0:i[t]=Math.atanh(n)}return i}const a=r===C.asin?Math.asin:Math.acos;for(let t=0;t<s;t++)if(e[t]){const n=o[t];Math.abs(n)>1?e[t]=0:i[t]=a(n)}return i}function U(t,e,n,r){const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r(o[t]));return i}function j(t,e,n,r){const[o,s]=t,i=o.length,a=y.A.createEmptyBand(n,i);for(let t=0;t<i;t++)e&&!e[t]||(a[t]=r(o[t],s[t]));return a}function z(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]&o[t]);return i}function Z(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]<<o[t]);return i}function V(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);for(let t=0;t<o;t++)e&&!e[t]||(s[t]=~r[t]);return s}function W(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]|o[t]);return i}function H(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]>>o[t]);return i}function J(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]^o[t]);return i}function q(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]&&o[t]?1:0);return i}function $(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);for(let t=0;t<o;t++)e&&!e[t]||(s[t]=r[t]?0:1);return s}function K(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]||o[t]?1:0);return i}function Y(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=(r[t]?1:0)^(o[t]?1:0));return i}function X(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]===o[t]?1:0);return i}function Q(t,e,n,r){const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s),a=r===Math.E;for(let t=0;t<s;t++)e&&!e[t]||(i[t]=a?Math.exp(o[t]):r**o[t]);return i}function tt(t,e,n){return Q(t,e,n,10)}function et(t,e,n){return Q(t,e,n,2)}function nt(t,e,n){return Q(t,e,n,Math.E)}function rt(t,e,n,r){const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(o[t]<=0?e[t]=0:i[t]=r(o[t]));return i}function ot(t,e,n){return rt(t,e,n,Math.log10)}function st(t,e,n){return rt(t,e,n,Math.log2)}function it(t,e,n){return rt(t,e,n,Math.log)}function at(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]>o[t]?1:0);return i}function lt(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]>=o[t]?1:0);return i}function ut(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]<o[t]?1:0);return i}function ct(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]<=o[t]?1:0);return i}function ht(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);if(!e)return s;for(let t=0;t<o;t++)s[t]=e[t]?0:1;return s}function pt(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]%o[t]);return i}function ft(t,e,n){const[r]=t,o=r.length,s=y.A.createEmptyBand(n,o);for(let t=0;t<o;t++)e&&!e[t]||(s[t]=-r[t]);return s}function dt(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]===o[t]?0:1);return i}function mt(t,e,n){const[r,o]=t,s=r.length,i=y.A.createEmptyBand(n,s),a=new Uint8Array(s);for(let t=0;t<s;t++)null!=e&&!e[t]||0!==r[t]||(i[t]=o[t],a[t]=255);return{band:i,mask:a}}function gt(t,e,n){const[r,o,s]=t,i=r.length,a=y.A.createEmptyBand(n,i);for(let t=0;t<i;t++)e&&!e[t]||(a[t]=r[t]?o[t]:s[t]);return a}function yt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n]){let e=o[n];for(let o=1;o<r;o++){const r=t[o][n];e<r&&(e=r)}i[n]=e}return i}function xt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n]){let e=o[n];for(let o=1;o<r;o++){const r=t[o][n];e>r&&(e=r)}i[n]=e}return i}function wt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n]){let e=o[n],s=e;for(let o=1;o<r;o++){const r=t[o][n];s<r?s=r:e>r&&(e=r)}i[n]=s-e}return i}function bt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n]){let e=0;for(let o=0;o<r;o++)e+=t[o][n];i[n]=e/r}return i}function vt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n])for(let e=0;e<r;e++){const r=t[e];i[n]+=r[n]}return i}function At(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s);for(let n=0;n<s;n++)if(!e||e[n]){const e=new Float32Array(r);let o=0;for(let s=0;s<r;s++){const r=t[s];o+=r[n],e[s]=r[n]}o/=r;let s=0;for(let t=0;t<r;t++)s+=(e[t]-o)**2;i[n]=Math.sqrt(s/r)}return i}function Mt(t,e,n){const r=t.length;if(r<2)return t[0];const o=Math.floor(r/2),[s]=t,i=s.length,a=y.A.createEmptyBand(n,i),l=new Float32Array(r),u=r%2==1;for(let n=0;n<i;n++)if(!e||e[n]){for(let e=0;e<r;e++)l[e]=t[e][n];l.sort(),a[n]=u?l[o]:(l[o]+l[o-1])/2}return a}function Ct(t,e,n){const[r,o]=t;if(null==o)return r;const s=r.length,i=y.A.createEmptyBand(n,s);for(let t=0;t<s;t++)e&&!e[t]||(i[t]=r[t]<o[t]?r[t]:o[t]);return i}function kt(t,e,n){const r=t.length;if(r<=2)return Ct(t,e,n);const o=t[0].length,s=y.A.createEmptyBand(n,o),i=new Map;for(let n=0;n<o;n++)if(!e||e[n]){i.clear();for(let e=0;e<r;e++){const r=t[e][n];i.set(r,i.has(r)?i.get(r)+1:1)}let e=0,o=0;const a=[];for(const t of i.keys())e=i.get(t),e>o?(o=e,a.length=0,a.push(t)):e===o&&a.push(t);a.length>1&&a.sort(((t,e)=>t-e)),s[n]=a[0]}return s}function Tt(t,e,n){const r=t.length;if(r<=2)return Ct(t,e,n);const o=t[0].length,s=y.A.createEmptyBand(n,o),i=new Map;for(let n=0;n<o;n++)if(!e||e[n]){i.clear();for(let e=0;e<r;e++){const r=t[e][n];i.set(r,i.has(r)?i.get(r)+1:1)}let e=0,o=t.length;const a=[];for(const t of i.keys())e=i.get(t),e<o?(o=e,a.length=0,a.push(t)):e===o&&a.push(t);a.length>1&&a.sort(((t,e)=>t-e)),s[n]=a[0]}return s}function Pt(t,e,n){const r=t.length;if(r<2)return t[0];const[o]=t,s=o.length,i=y.A.createEmptyBand(n,s),a=new Set;for(let n=0;n<s;n++)if(!e||e[n]){let e;a.clear();for(let o=0;o<r;o++)e=t[o][n],a.add(e);i[n]=a.size}return i}const St=new Map,_t=new Map,It=new Map,Rt=new Map;function Nt(){St.size||(St.set(4,Math.sqrt),St.set(6,Math.acos),St.set(7,Math.asin),St.set(8,Math.atan),St.set(9,Math.atanh),St.set(10,Math.abs),St.set(21,Math.cos),St.set(22,Math.cosh),St.set(48,Math.floor),St.set(49,Math.ceil),St.set(51,Math.sin),St.set(52,Math.sinh),St.set(56,Math.tan),St.set(57,Math.tanh),St.set(59,Math.acosh),St.set(60,Math.asinh),St.set(65,Math.floor),_t.set(5,Math.pow),_t.set(61,Math.atan2),It.set(1,I),It.set(2,F),It.set(3,E),It.set(11,z),It.set(12,Z),It.set(13,V),It.set(14,W),It.set(15,H),It.set(16,J),It.set(17,q),It.set(18,$),It.set(19,K),It.set(20,Y),It.set(23,O),It.set(24,X),It.set(25,nt),It.set(26,tt),It.set(27,et),It.set(28,at),It.set(29,lt),It.set(30,B),It.set(31,ht),It.set(32,R),It.set(33,ut),It.set(34,ct),It.set(35,it),It.set(36,ot),It.set(37,st),It.set(44,pt),It.set(45,ft),It.set(46,dt),It.set(53,N),It.set(64,G),It.set(65,D),It.set(76,gt),It.set(78,gt),Rt.set(38,kt),Rt.set(39,yt),Rt.set(40,bt),Rt.set(41,Mt),Rt.set(42,xt),Rt.set(43,Tt),Rt.set(47,wt),Rt.set(54,At),Rt.set(55,vt),Rt.set(58,Pt),Rt.set(66,kt),Rt.set(67,yt),Rt.set(68,bt),Rt.set(69,Mt),Rt.set(70,xt),Rt.set(71,Tt),Rt.set(72,wt),Rt.set(73,At),Rt.set(74,vt),Rt.set(75,Pt))}function Ft(t,e,n={}){Nt();let r=function(t,e=!1){const n=t.map((t=>t.mask)),r=n.filter((t=>null!=t)),o=t[0].pixels[0].length;if(0===r.length||e&&r.length!==n.length)return new Uint8Array(o).fill(255);const s=r[0],i=new Uint8Array(s);if(1===r.length)return i;if(!e){for(let t=1;t<r.length;t++){const e=r[t];for(let t=0;t<i.length;t++)i[t]&&(i[t]=e[t]?255:0)}return i}for(let t=1;t<r.length;t++){const e=r[t];for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=e[t]?255:0)}return i}(t,e>=66&&e<=75);const{outputPixelType:o="f32"}=n,s=!Rt.has(e)||n.processAsMultiband,i=s?t[0].pixels.length:1,a=[];for(let n=0;n<i;n++){const i=Rt.has(e)&&!s?t.flatMap((t=>t.pixels)):t.map((t=>t.pixels[n]));let l,c=!0;if(e===k.setNull){const t=mt(i,r,o);l=t.band,r=t.mask,c=!1}else It.has(e)?l=It.get(e)(i,r,"f64"):St.has(e)?l=e===C.asin||e===C.acos||e===C.atanh?L(i,r,"f64",e):U(i,r,"f64",St.get(e)):_t.has(e)?l=j(i,r,"f64",_t.get(e)):Rt.has(e)?l=Rt.get(e)(i,r,"f64"):(l=i[0],c=!1);if(c&&e!==M.isNull&&!P.has(e)){const t=y.A.createEmptyBand(o,l.length);r||(r=new Uint8Array(l.length).fill(255)),(0,u.$p)(l,r),(0,u.yM)(l,r,o,t),l=t}a.push(l)}const l=t[0];return new y.A({width:l.width,height:l.height,pixelType:o,mask:e===M.isNull?null:r,pixels:a})}let Et=class extends v{constructor(){super(...arguments),this.functionName="Arithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const{operation:t}=this.functionArguments;if(t<1||t>6)return{success:!1,supportsGPU:!1,error:"unsupported operation"};const e=this.sourceRasterInfos[0].clone();return this.outputPixelType=this._getOutputPixelType(e.pixelType),e.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(e),this.rasterInfo=e,{success:!0,supportsGPU:e.bandCount<=3}}_processPixels(t){const{pixelBlocks:e}=t;return null==e?.[0]||null==e?.[1]?null:function(t,e,n){return Ft(t,e=[null,1,2,3,23,5,44][e]??1,{outputPixelType:n})}(e,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){const{operation:t}=this.functionArguments,e=["","plus","minus","times","divide","power","mod"][t],n=this.outputPixelType??"f32";let[r,o]=(0,u.hP)(n);const s=(0,u.zw)(n);return s&&(r-=1e-4,o+=1e-4),{imageCount:2,operationName:e,domainRange:[r,o],isOutputRounded:s}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Et.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:m,json:{write:!0,name:"rasterFunctionArguments"}})],Et.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Et.prototype,"rasterArgumentNames",void 0),Et=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ArithmeticFunction")],Et);const Bt=Et;var Ot;let Gt=Ot=class extends p{clone(){return new Ot({raster:this.raster})}};Gt=Ot=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],Gt);const Dt=Gt;var Lt=n(55469);let Ut=class extends v{constructor(){super(...arguments),this.functionName="Aspect",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.isGCS=t.spatialReference?.isGeographic??!1,this.outputPixelType=this._getOutputPixelType("f32");const e=t.clone();return e.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(e),e.statistics=[{min:-1,max:360,avg:180,stddev:30}],e.bandCount=1,this.rasterInfo=e,{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{extent:n,primaryPixelSizes:r}=t,o=r?.[0],s=o??(n?{x:n.width/e.width,y:n.height/e.height}:{x:1,y:1});return(0,Lt.di)(e,{resolution:s})}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Ut.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Dt,json:{write:!0,name:"rasterFunctionArguments"}})],Ut.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Ut.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ut.prototype,"isGCS",void 0),Ut=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.AspectFunction")],Ut);const jt=Ut;var zt=n(74376),Zt=n(73037);const Vt=new Set(["+","-","*","/","(",")"]);function Wt(t,e){return t.toLowerCase().startsWith("b")?e[parseInt(t.slice(1),10)-1]:parseFloat(t)}function Ht(t,e,n,r){if("number"==typeof n&&"number"==typeof r)return n+r;let o,s,i;"number"==typeof n?(i=r,o=i.length,s=new Float32Array(o),s.fill(n)):(o=n.length,s=n,r.constructor===Number?(i=new Float32Array(o),i.fill(r)):i=r);const a=new Float32Array(o);switch(e){case"+":for(let e=0;e<o;e++)(null==t||t[e])&&(a[e]=s[e]+i[e]);break;case"-":for(let e=0;e<o;e++)(null==t||t[e])&&(a[e]=s[e]-i[e]);break;case"*":for(let e=0;e<o;e++)(null==t||t[e])&&(a[e]=s[e]*i[e]);break;case"/":for(let e=0;e<o;e++)(null==t||t[e])&&i[e]&&(a[e]=s[e]/i[e]);break;case"(":case")":throw new Error("encountered error with custom band index equation")}return a}function Jt(t,e){t.splice(e,1);let n=0,r=0;do{n=0,r=0;for(let e=0;e<t.length;e++)if("("===t[e])n=e;else if(")"===t[e]){r=e;break}r===n+1&&t.splice(n,2)}while(r===n+1);return t}function qt(t){if(1===t.length)return{opIndex:0,numIndex:0};let e=0,n=0;for(let r=0;r<t.length;r++)if("("===t[r])e=r;else if(")"===t[r]){n=r;break}const r=0===n?t:t.slice(e+1,n);let o=-1;for(let t=0;t<r.length;t++)if("*"===r[t]||"/"===r[t]){o=t;break}if(o>-1)n>0&&(o+=e+1);else{for(let t=0;t<r.length;t++)if("+"===r[t]||"-"===r[t]){o=t;break}n>0&&(o+=e+1)}let s=0;for(let e=0;e<o;e++)"("===t[e]&&s++;return{opIndex:o,numIndex:o-s}}var $t=n(43264);const Kt=new Zt.J({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function Yt(t,e){if(!(0,$t.AB)(t))return t;const{equation:n,method:r}=e,o=e.bandIndexes.map((t=>t-1)),{pixels:s,mask:i}=t;let a;switch(r){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":a=Qt(i,s[o[0]],s[o[1]]);break;case"ndwi":a=Qt(i,s[o[1]],s[o[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":a=function(t,e,n){const r=n.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s]){const t=e[s],r=n[s];r&&(o[s]=t/r)}return[o]}(i,s[o[0]],s[o[1]]);break;case"ci-g":case"ci-re":a=function(t,e,n){const r=e.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s]){const t=e[s],r=n[s];r&&(o[s]=t/r-1)}return[o]}(i,s[o[0]],s[o[1]]);break;case"savi":a=function(t,e,n,r){const o=n.length,s=new Float32Array(o);for(let i=0;i<o;i++)if(null==t||t[i]){const t=n[i],o=e[i],a=o+t+r;a&&(s[i]=(o-t)/a*(1+r))}return[s]}(i,s[o[0]],s[o[1]],o[2]+1);break;case"tsavi":a=function(t,e,n,r,o,s){const i=n.length,a=new Float32Array(i),l=-o*r+s*(1+r*r);for(let s=0;s<i;s++)if(null==t||t[s]){const t=n[s],i=e[s],u=o*i+t+l;u&&(a[s]=r*(i-r*t-o)/u)}return[a]}(i,s[o[0]],s[o[1]],o[2]+1,o[3]+1,o[4]+1);break;case"msavi":a=function(t,e,n){const r=n.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s]){const t=n[s],r=e[s],i=2*r+1;o[s]=.5*(i-Math.sqrt(i*i-8*(r-t)))}return[o]}(i,s[o[0]],s[o[1]]);break;case"gemi":a=function(t,e,n){const r=n.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s]){const t=n[s],r=e[s];if(1!==t&&r+t+.5!==0){const e=(2*(r*r-t*t)+1.5*r+.5*t)/(r+t+.5);o[s]=e*(1-.25*e)-(t-.125)/(1-t)}}return[o]}(i,s[o[0]],s[o[1]]);break;case"pvi":a=function(t,e,n,r,o){const s=n.length,i=new Float32Array(s),a=1/Math.sqrt(1+r*r);for(let l=0;l<s;l++)if(null==t||t[l]){const t=n[l],s=e[l];i[l]=(s-r*t-o)*a}return[i]}(i,s[o[0]],s[o[1]],o[2]+1,o[3]+1);break;case"gvitm":a=function(t,e){const[n,r,o,s,i,a]=e,l=n.length,u=new Float32Array(l);for(let e=0;e<l;e++)(null==t||t[e])&&(u[e]=-.2848*n[e]-.2435*r[e]-.5436*o[e]+.7243*s[e]+.084*i[e]-.18*a[e]);return[u]}(i,[s[o[0]],s[o[1]],s[o[2]],s[o[3]],s[o[4]],s[o[5]]]);break;case"sultan":a=function(t,e){const[n,r,o,s,i]=e,a=n.length,l=new Float32Array(a),u=new Float32Array(a),c=new Float32Array(a);for(let e=0;e<a;e++)(null==t||t[e])&&(l[e]=i[e]?s[e]/i[e]*100:0,u[e]=n[e]?s[e]/n[e]*100:0,c[e]=o[e]?r[e]/o[e]*(s[e]/o[e])*100:0);return[l,u,c]}(i,[s[o[0]],s[o[1]],s[o[2]],s[o[3]],s[o[4]]]);break;case"vari":a=function(t,e){const[n,r,o]=e,s=n.length,i=new Float32Array(s);for(let e=0;e<s;e++)if(null==t||t[e])for(e=0;e<s;e++){const t=n[e],s=r[e],a=s+t-o[e];a&&(i[e]=(s-t)/a)}return[i]}(i,[s[o[0]],s[o[1]],s[o[2]]]);break;case"mtvi2":a=function(t,e){const[n,r,o]=e,s=n.length,i=new Float32Array(s);for(let e=0;e<s;e++)if(null==t||t[e])for(e=0;e<s;e++){const t=n[e],s=r[e],a=o[e],l=Math.sqrt((2*t+1)**2-(6*t-5*Math.sqrt(s))-.5);if(l){const n=1.5*(1.2*(t-a)-2.5*(s-a));i[e]=n/l}}return[i]}(i,[s[o[0]],s[o[1]],s[o[2]]]);break;case"rtvi-core":a=function(t,e){const[n,r,o]=e,s=n.length,i=new Float32Array(s);for(let e=0;e<s;e++)if(null==t||t[e])for(e=0;e<s;e++){const t=n[e],s=r[e],a=o[e];i[e]=100*(t-s)-10*(t-a)}return[i]}(i,[s[o[0]],s[o[1]],s[o[2]]]);break;case"evi":a=function(t,e){const[n,r,o]=e,s=n.length,i=new Float32Array(s);for(let e=0;e<s;e++)if(null==t||t[e])for(e=0;e<s;e++){const t=n[e],s=r[e],a=t+6*s-7.5*o[e]+1;a&&(i[e]=2.5*(t-s)/a)}return[i]}(i,[s[o[0]],s[o[1]],s[o[2]]]);break;case"wndwi":a=function(t,e,n=.5){const[r,o,s]=e,i=o.length,a=new Float32Array(i);for(let e=0;e<i;e++)if(null==t||t[e])for(e=0;e<i;e++){const t=r[e],i=o[e],l=s[e],u=t+n*i+(1-n)*l;u&&(a[e]=(t-n*i-(1-n)*l)/u)}return[a]}(i,[s[o[0]],s[o[1]],s[o[2]]],o[3]?o[3]+1:.5);break;case"bai":a=function(t,e,n){const r=n.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s])for(s=0;s<r;s++){const t=(.1-e[s])**2+(.06-n[s])**2;t&&(o[s]=1/t)}return[o]}(i,s[o[0]],s[o[1]]);break;case"custom":a=function(t,e,n){let r,{ops:o,nums:s}=function(t,e){(t=t.replaceAll(" ","")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1));const n=t.split(""),r=[],o=[];let s="";for(let t=0;t<n.length;t++){const i=n[t];Vt.has(i)?(s.length&&o.push(Wt(s,e)),r.push(i),s=""):s=s.concat(i)}return s.length&&o.push(Wt(s,e)),{ops:r,nums:o}}(n,e);if(0===o.length){const t=1===s.length?s[0]:e[0];if(t instanceof Float32Array)return[t];const n=new Float32Array(e[0].length);return"number"==typeof t?n.fill(t):n.set(t),[n]}for(;o.length>0;){const{numIndex:e,opIndex:n}=qt(o);if(r=Ht(t,o[n],s[e],s[e+1]),1===o.length)break;o=Jt(o,n),s.splice(e,2,r)}return[r]}(i,s,n);break;default:return t}const{outputPixelType:l="f32"}=e,c=null!=l&&(0,u.zw)(l);let h;i?(h=new Uint8Array(t.width*t.height),h.set(i)):c&&(h=new Uint8Array(t.width*t.height).fill(255)),c&&(a=a.map((t=>{const e=y.A.createEmptyBand(l,t.length);return(0,u.yM)(t,h,l,e),e})));const p=new y.A({width:t.width,height:t.height,pixelType:l,pixels:a,mask:h});return p.updateStatistics(),p}function Xt(t){const e=new Float32Array(9);return e[3*t[0]]=1,e[3*t[1]+1]=1,e[3*t[2]+2]=1,e}function Qt(t,e,n){const r=n.length,o=new Float32Array(r);for(let s=0;s<r;s++)if(null==t||t[s]){const t=e[s],r=n[s],i=t+r;i&&(o[s]=(t-r)/i)}return[o]}var te;let ee=te=class extends p{constructor(){super(...arguments),this.method="custom"}clone(){return new te({method:this.method,bandIndexes:this.bandIndexes,raster:(0,s.o8)(this.raster)})}};(0,i._)([(0,a.MZ)({json:{type:String,write:!0}})],ee.prototype,"bandIndexes",void 0),(0,i._)([(0,zt.e)(Kt)],ee.prototype,"method",void 0),ee=te=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],ee);const ne=ee,re=new Set(["vari","mtvi2","rtvi-core","evi"]);let oe=class extends v{constructor(){super(...arguments),this.functionName="BandArithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0];if(t.bandCount<2)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};const e=t.clone();return e.pixelType=this.outputPixelType,e.bandCount="sultan"===this.functionArguments.method?3:1,this._removeStatsHistColormapVAT(e),e.keyProperties={...e.keyProperties,BandProperties:void 0},this.rasterInfo=e,{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return e;const{method:n,bandIndexes:r}=this.functionArguments,o=r.split(" ").map((t=>parseFloat(t)));return Yt(e,{method:n,bandIndexes:o,equation:r,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const t=this.functionArguments.bandIndexes.split(" ").map((t=>parseFloat(t)-1));2===t.length&&t.push(0);const e=this.isInputBandIdsSwizzled?[0,1,2]:t;let n,r;const o=new Float32Array(3),{method:s}=this.functionArguments;switch(s){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":n=Xt([e[0],e[1],0]),r="ndxi";break;case"ndwi":n=Xt([e[1],e[0],0]),r="ndxi";break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":n=Xt([e[0],e[1],0]),r="sr";break;case"ci-g":case"ci-re":n=Xt([e[0],e[1],0]),r="ci";break;case"savi":n=Xt([e[0],e[1],0]),r="savi",o[0]=t[2]+1;break;case"tsavi":n=Xt([e[0],e[1],0]),r="tsavi",o[0]=t[2]+1,o[1]=t[3]+1,o[2]=t[4]+1;break;case"msavi":n=Xt([e[0],e[1],0]),r="msavi";break;case"gemi":n=Xt([e[0],e[1],0]),r="gemi";break;case"pvi":n=Xt([e[0],e[1],0]),r="tsavi",o[0]=t[2]+1,o[1]=t[3]+1;break;case"vari":n=Xt([e[0],e[1],e[2]]),r="vari";break;case"mtvi2":n=Xt([e[0],e[1],e[2]]),r="mtvi";break;case"rtvi-core":n=Xt([e[0],e[1],e[2]]),r="rtvicore";break;case"evi":n=Xt([e[0],e[1],e[2]]),r="evi";break;case"wndwi":n=Xt([e[0],e[1],0]),r="wndwi",o[0]=t[3]?t[3]+1:.5;break;case"bai":n=Xt([e[1],e[0],0]),r="bai";break;default:n=Xt([0,1,2]),r="custom"}return{bandIndexMat3:n,indexType:r,adjustments:o,isOutputRounded:(0,u.zw)(this.outputPixelType)}}_getInputBandIds(t){if("custom"===this.functionArguments.method)return t;const e=this.functionArguments.bandIndexes.split(" ").map((t=>parseFloat(t)-1)),n=t.length,r=e.map((t=>t>=n?n-1:t)),o=re.has(this.functionArguments.method)?3:2,s=r.slice(0,o).map((e=>t[e]));return 2===s.length&&s.push(0),s}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],oe.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:ne,json:{write:!0,name:"rasterFunctionArguments"}})],oe.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],oe.prototype,"rasterArgumentNames",void 0),oe=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],oe);const se=oe;var ie,ae=n(50917),le=n(74697);const ue=new Zt.J({1:"outside",2:"inside"},{useNumericKeys:!0});let ce=ie=class extends p{constructor(){super(...arguments),this.clippingType="outside"}clone(){return new ie({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}};(0,i._)([(0,a.MZ)({types:ae.yR,json:{read:le.rS,write:!0}})],ce.prototype,"clippingGeometry",void 0),(0,i._)([(0,a.MZ)({json:{read:ue.read,write:ue.write}})],ce.prototype,"clippingType",void 0),ce=ie=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ClipFunctionArguments")],ce);const he=ce;var pe=n(67090),fe=n(80221);let de=class extends v{constructor(){super(...arguments),this.functionName="Clip",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(t.pixelType),t.pixelType=this.outputPixelType,this.rasterInfo=t;const{functionArguments:e}=this,{clippingGeometry:n,clippingType:r}=e;if(!n)return{success:!1,supportsGPU:!1,error:"missing clipping geometry"};if("outside"===r)try{const{spatialReference:e}=t,r="extent"===n.type?(0,fe._l)(n,e):(0,fe.uk)(n,e).extent;r&&(0,pe.Sd)(t,r)}catch{}return{success:!0,supportsGPU:!0}}_processPixels(t){return t.pixelBlocks?.[0]}_getWebGLParameters(){const{clippingGeometry:t,clippingType:e}=this.functionArguments;return{clippingGeometry:t.toJSON(),clippingType:e}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],de.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:he,json:{write:!0,name:"rasterFunctionArguments"}})],de.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],de.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)()],de.prototype,"isNoopProcess",void 0),de=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ClipFunction")],de);const me=de;var ge,ye=n(47332),xe=n(3212),we=n(85982);let be=ge=class extends p{castColormapName(t){if(!t)return null;const e=t.toLowerCase();return xe.L7.includes(e)?e:null}readColorRamp(t){return(0,we.r)(t)}readColorRampName(t,e){if(!t)return null;const n=xe.kH.jsonValues.find((e=>e.toLowerCase()===t.toLowerCase()));return n?xe.kH.fromJSON(n):null}clone(){return new ge({colormap:(0,s.o8)(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};(0,i._)([(0,a.MZ)({type:[[Number]],json:{write:!0}})],be.prototype,"colormap",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],be.prototype,"colormapName",void 0),(0,i._)([(0,g.w)("colormapName")],be.prototype,"castColormapName",null),(0,i._)([(0,a.MZ)({types:we.g,json:{write:!0}})],be.prototype,"colorRamp",void 0),(0,i._)([(0,ye.w)("colorRamp")],be.prototype,"readColorRamp",null),(0,i._)([(0,a.MZ)({type:xe.kH.apiValues,json:{type:xe.kH.jsonValues,write:xe.kH.write}})],be.prototype,"colorRampName",void 0),(0,i._)([(0,ye.w)("colorRampName")],be.prototype,"readColorRampName",null),be=ge=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],be);const ve=be,Ae=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],Me=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];function Ce(t,e){const n=[],r=[];for(let e=0;e<t.length-1;e++)n.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:t[e].slice(1),toColor:t[e+1].slice(1)}),r.push(t[e+1][0]-t[e][0]);const o=t[t.length-1][0];return(0,xe.iv)({type:"multipart",colorRamps:n},{numColors:o,weights:e=e??r})}let ke=class extends v{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const t=this.sourceRasterInfos[0];if(t.bandCount>1)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let{colormap:e,colormapName:n,colorRamp:r,colorRampName:o}=this.functionArguments;if(!e?.length)if(r)this.colorRamp=r,e=(0,xe.R8)(r,{interpolateAlpha:!0});else if(o){const t=(0,xe.M5)(o);t&&(e=(0,xe.R8)(t),this.colorRamp=(0,we.r)(t))}else n&&(e=function(t){let e;switch(t){case"elevation":e=Ce([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case"gray":e=(0,xe.iv)({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case"hillshade":e=Ce([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case"ndvi":e=Ae;break;case"ndvi2":e=function(){const t=Ce([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let e=t.length;e<256;e++)t.push([6,27,7]);return t}();break;case"ndvi3":e=Me;break;case"random":e=function(){const t=[];for(let e=0;e<256;e++){const e=[];for(let t=0;t<3;t++)e.push(Math.round(255*Math.random()));t.push(e)}return t}()}return e?(e=e.map(((t,e)=>[e,...t])),e):null}(n));if(!e?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};const s=this._getOutputPixelType(t.pixelType);this.outputPixelType=s.startsWith("f")?"s32":s;const i=t.clone();return i.pixelType=this.outputPixelType,i.colormap=e,i.bandCount=1,this.rasterInfo=i,{success:!0,supportsGPU:!0}}_processPixels(t){let e=t.pixelBlocks?.[0];return!e||(0,u.zw)(e.pixelType)||(e=e.clone(),e.clamp(this.outputPixelType)),e}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],ke.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:ve,json:{write:!0,name:"rasterFunctionArguments"}})],ke.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],ke.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)()],ke.prototype,"isNoopProcess",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],ke.prototype,"indexedColormap",void 0),(0,i._)([(0,a.MZ)()],ke.prototype,"colorRamp",void 0),ke=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ColormapFunction")],ke);const Te=ke;var Pe,Se=n(42568);let _e=Pe=class extends p{clone(){return new Pe({raster:this.raster})}};_e=Pe=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ColormapToRGBFunctionArguments")],_e);const Ie=_e;var Re=n(9059);let Ne=class extends v{constructor(){super(...arguments),this.functionName="ColormapToRGB",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const t=this.sourceRasterInfos[0];if(t.bandCount>1||!t.colormap?.length)return{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: source data must be single band with a colormap"};const e=t.clone();e.pixelType=this.outputPixelType=this._getOutputPixelType("u8"),this._removeStatsHistColormapVAT(e),e.bandCount=3,e.statistics=[{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20},{min:0,max:255,avg:100,stddev:20}],this.rasterInfo=e;const n=[...t.colormap].sort(((t,e)=>t[0]-e[0])),{indexedColormap:r,offset:o}=(0,$t.zg)({colormap:n});return r?(this.lookup={indexedColormap:r,offset:o},{success:!0,supportsGPU:(0,Re.WN)(r)}):{success:!1,supportsGPU:!1,error:"colormap-to-rgb-function: the colormap is not supported"}}_processPixels(t){let e=t.pixelBlocks?.[0];if(!e||!this.lookup)return e;e=e.clone();const n=e.pixels[0],r=e.mask??new Uint8Array(n.length).fill(255),o=new Uint8Array(n.length),s=new Uint8Array(n.length),i=new Uint8Array(n.length),{indexedColormap:a,offset:l}=this.lookup,u=a.length;for(let t=0;t<n.length;t++)if(r[t]){let e=4*(n[t]-l);e<0||e>u-4?r[t]=0:(o[t]=a[e++],s[t]=a[e++],i[t]=a[e++])}return e.pixels=[o,s,i],e.statistics=[new Se.z(0,255),new Se.z(0,255),new Se.z(0,255)],e.pixelType=this.outputPixelType,e}_getWebGLParameters(){return this.lookup}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Ne.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Ie,json:{write:!0,name:"rasterFunctionArguments"}})],Ne.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Ne.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ne.prototype,"lookup",void 0),Ne=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ColormapToRGBFunction")],Ne);const Fe=Ne;var Ee,Be=n(81392);let Oe=Ee=class extends p{constructor(){super(...arguments),this.rasters=[]}writeRasters(t,e){e.rasters=t.map((t=>"number"==typeof t||"string"==typeof t?t:t.toJSON()))}clone(){return new Ee({rasters:(0,s.o8)(this.rasters)})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Oe.prototype,"rasters",void 0),(0,i._)([(0,Be.K)("rasters")],Oe.prototype,"writeRasters",null),Oe=Ee=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],Oe);const Ge=Oe;let De=class extends v{constructor(){super(...arguments),this.functionName="CompositeBand",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);const n=e.clone();if(n.attributeTable=null,n.colormap=null,n.pixelType=this.outputPixelType,n.bandCount=t.map((({bandCount:t})=>t)).reduce(((t,e)=>t+e)),t.every((({statistics:t})=>null!=t&&t.length))){const e=[];t.forEach((({statistics:t})=>null!=t&&e.push(...t))),n.statistics=e}if(t.every((({histograms:t})=>null!=t&&t.length))){const e=[];t.forEach((({histograms:t})=>null!=t&&e.push(...t))),n.histograms=e}n.multidimensionalInfo&&n.multidimensionalInfo.variables.forEach((e=>{const n=t.map((t=>t.multidimensionalInfo?.variables.find((({name:t})=>t===e.name)))),r=n.map((t=>t?.statistics?.length?t.statistics:null)),o=n.map((t=>t?.histograms?.length?t.histograms:null));e.statistics=r.every((t=>null!=t))?r.flat():null,e.histograms=o.every((t=>null!=t))?o.flat():null})),n.bandCount>1&&(n.colormap=null,n.attributeTable=null);const r=t.every((t=>t.keyProperties.BandProperties?.length))?t.flatMap((t=>t.keyProperties.BandProperties)):void 0;return n.keyProperties={...n.keyProperties,BandProperties:r},this.rasterInfo=n,{success:!0,supportsGPU:n.bandCount<=3}}_processPixels(t){const{pixelBlocks:e}=t;if(!e)return null;const n=e?.[0];return null==n?null:(0,$t.Wy)(e)}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],De.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Ge,json:{write:!0,name:"rasterFunctionArguments"}})],De.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],De.prototype,"rasterArgumentNames",void 0),De=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.CompositeBandFunction")],De);const Le=De;var Ue=n(56740);const je=new Zt.J({0:"difference",1:"relative-difference",2:"categorical",3:"euclidean-distance",4:"angle-difference",5:"band-with-most-change"},{useNumericKeys:!0}),ze=new Zt.J({0:"all",1:"changed",2:"unchanged"},{useNumericKeys:!0});var Ze;let Ve=Ze=class extends p{constructor(){super(...arguments),this.method="difference",this.keepMethod="all",this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new Ze({raster:this.raster,raster2:this.raster2,method:this.method,keepMethod:this.keepMethod})}};(0,i._)([(0,zt.e)(je)],Ve.prototype,"method",void 0),(0,i._)([(0,zt.e)(ze)],Ve.prototype,"keepMethod",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ve.prototype,"raster2",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],Ve.prototype,"rasters",null),Ve=Ze=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ComputeChangeFunctionArguments")],Ve);const We=Ve;let He=class extends v{constructor(){super(...arguments),this.functionName="ComputeChange",this.functionArguments=null,this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){const{method:t}=this.functionArguments,e=this.sourceRasterInfos[0].clone();if(this.outputPixelType=this._getOutputPixelType(e.pixelType),e.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(e),"categorical"===t){const t=this.sourceRasterInfos.map((t=>t.attributeTable)),n=this._getFieldNames(t,"value"),r=t.map((t=>this._getClassFieldName(t)));if(null==n[0]||null==n[1]||null==r[0]||null==r[1])return{success:!1,supportsGPU:!1,error:"both inputs must have proper attribute table with value and class fields"};this._updateAttributeTable(e,n,r)}return e.bandCount=1,this.rasterInfo=e,{success:!0,supportsGPU:"difference"===t||"relative-difference"===t}}_processPixels(t){const{pixelBlocks:e}=t;if(null==e?.[0]||null==e?.[1])return null;const{method:n}=this.functionArguments;return function(t,e,n,r){const[o,s]=t,i=(0,u.zw)(n)&&!(0,u.zw)(o.pixelType)&&!(0,u.zw)(s.pixelType),a=[o.mask,s.mask].filter((t=>t)),l=y.A.combineBandMasks(a),c=t.map((t=>t.pixels[0])),{width:h,height:p}=o,f=y.A.createEmptyBand(n,h*p);switch(e){case"difference":case"relative-difference":!function(t){const{bands:[e,n],mask:r,isRelative:o,isRoundingNeeded:s,outBand:i}=t,a=e.length;for(let t=0;t<a;t++)if(!r||r[t]){let r=e[t]-n[t];if(o){const o=Math.max(Math.abs(e[t])-Math.abs(n[t]));r=o>0?r/o:0}i[t]=s?Math.round(r):r}}({bands:c,mask:l,outBand:f,isRoundingNeeded:i,isRelative:"relative-difference"===e});break;case"categorical":!function(t){const{bands:[e,n],categoryIndexLookups:[r,o],classNames:[s,i],mask:a,keepMethod:l,outBand:u}=t,c=e.length,h=s.length,p=i.length,f=h*p,d=f+1,m=f+2;for(let t=0;t<c;t++)if(!a||a[t]){const a=e[t],c=n[t],h=r[a],g=o[c],y=s[h],x=i[g];u[t]=null==h||null==g?f:"changed"===l&&y===x?d:"unchanged"===l&&y!==x?m:h*p+g}}({bands:c,mask:l,outBand:f,...r});break;case"euclidean-distance":!function(t){const{pixels:[e,n],mask:r,outBand:o}=t,s=e[0].length,i=e.length;for(let t=0;t<s;t++)if(!r||r[t]){let r=0;for(let o=0;o<i;o++){const s=e[o][t]-n[o][t];r+=s*s}o[t]=Math.sqrt(r)}}({pixels:t.map((t=>t.pixels)),mask:l,outBand:f});break;case"angle-difference":!function(t){const{pixels:[e,n],mask:r,outBand:o}=t,s=e[0].length,i=e.length;for(let t=0;t<s;t++)if(!r||r[t]){let r=0,s=0,a=0;for(let o=0;o<i;o++){const i=e[o][t],l=n[o][t];r+=i*l,s+=i*i,a+=l*l}const l=Math.sqrt(s*a);o[t]=l?Math.acos(r/l):1.5707963267948966}}({pixels:t.map((t=>t.pixels)),mask:l,outBand:f});break;case"band-with-most-change":!function(t){const{pixels:[e,n],mask:r,outBand:o}=t,s=e[0].length,i=e.length;for(let t=0;t<s;t++)if(!r||r[t]){let r=0,s=0;for(let o=0;o<i;o++){const i=Math.abs(e[o][t]-n[o][t]);i>r&&(r=i,s=o)}o[t]=s}}({pixels:t.map((t=>t.pixels)),mask:l,outBand:f})}const d=new y.A({width:h,height:p,pixels:[f],pixelType:n,mask:l});return d.updateStatistics(),d}(e,n,this.outputPixelType,this._categoryConfig)}_getWebGLParameters(){const t=this.outputPixelType??"f32";let[e,n]=(0,u.hP)(t);const r=(0,u.zw)(t);return r&&(e-=1e-4,n+=1e-4),{method:this.functionArguments.method,domainRange:[e,n],isOutputRounded:r}}_updateAttributeTable(t,e,n){const r=this.sourceRasterInfos.map((t=>t.attributeTable)),o=r.map(((t,n)=>t.features.map((t=>t.attributes[e[n]])))),s=r.map(((t,e)=>t.features.map((t=>t.attributes[n[e]])))),i=o.map((t=>{const e=[];return t.forEach(((t,n)=>e[t]=n)),e})),{keepMethod:a}=this.functionArguments;this._categoryConfig={categoryIndexLookups:i,classNames:s,keepMethod:a};const l=r[0].clone();l.fields=[new Ue.A({name:"OID",type:"oid"}),new Ue.A({name:"Value",type:"integer"}),new Ue.A({name:"ClassName",type:"string"}),new Ue.A({name:"Class_From",type:"string"}),new Ue.A({name:"Class_To",type:"string"})];const u=this._getFieldNames(r,"red"),c=this._getFieldNames(r,"green"),h=this._getFieldNames(r,"blue"),p=[],f=2===u.length&&2===c.length&&2===h.length;f&&(p.push(...r.map(((t,e)=>t.features.map((t=>[t.attributes[u[e]],t.attributes[c[e]],t.attributes[h[e]]]))))),l.fields.push(new Ue.A({name:"Red",type:"integer"}),new Ue.A({name:"Green",type:"integer"}),new Ue.A({name:"Blue",type:"integer"})));const d=l.features[0].clone();d.geometry=null;const m=[],[g,y]=o.map((t=>t.length));let x=1;for(let t=0;t<g;t++){const e=s[0][t];for(let n=0;n<y;n++){const r=s[1][n];if("changed"===a&&e===r||"unchanged"===a&&e!==r)continue;const o=d.clone();o.attributes={OID:x++,Value:t*y+n,ClassName:e===r?e:`${e} -> ${r}`,Class_From:e,Class_To:r},f&&(o.attributes.Red=p[0][t][0]+p[1][n][0]>>1,o.attributes.Green=p[0][t][1]+p[1][n][1]>>1,o.attributes.Blue=p[0][t][2]+p[1][n][2]>>1),m.push(o)}}if("changed"===a){const t=d.clone();t.attributes={OID:x++,Value:g*y+1,ClassName:"No Change",Class_From:"Same",Class_To:"Same"},m.push(t)}else if("unchanged"===a){const t=d.clone();t.attributes={OID:x++,Value:g*y+2,ClassName:"Changed",Class_From:"Any",Class_To:"Any"},m.push(t)}l.features=m,t.attributeTable=l}_getFieldNames(t,e){return t.map((({fields:t})=>t.find((t=>t.name.toLowerCase()===e))?.name)).filter((t=>t))}_getClassFieldName(t){const e=t.fields.find((t=>"string"===t.type&&t.name.toLowerCase().startsWith("class")))??t.fields.find((t=>"string"===t.type&&t.name.toLowerCase().includes("class")||t.name.toLowerCase().includes("type")||t.name.toLowerCase().includes("name")))??t.fields.find((t=>"string"===t.type));return e?.name}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],He.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:We,json:{write:!0,name:"rasterFunctionArguments"}})],He.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],He.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],He.prototype,"_categoryConfig",void 0),He=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ComputeChangeFunction")],He);const Je=He;var qe;let $e=qe=class extends p{constructor(){super(...arguments),this.contrastOffset=0,this.brightnessOffset=0}clone(){return new qe({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],$e.prototype,"contrastOffset",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],$e.prototype,"brightnessOffset",void 0),$e=qe=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],$e);const Ke=$e;var Ye=n(72567);let Xe=class extends v{constructor(){super(...arguments),this.functionName="ContrastBrightness",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0];if("u8"!==e.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");const n=e.clone();this._removeStatsHistColormapVAT(n),this.rasterInfo=n;const{contrastOffset:r,brightnessOffset:o}=this.functionArguments;return this.lookup=(0,Ye.zj)(r,o),{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];return null==e?null:(0,$t.eH)(e,{lut:e.pixels.map((()=>this.lookup)),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const{contrastOffset:t,brightnessOffset:e}=this.functionArguments;return{contrastOffset:t,brightnessOffset:e}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Xe.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Ke,json:{write:!0,name:"rasterFunctionArguments"}})],Xe.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Xe.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Xe.prototype,"lookup",void 0),Xe=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],Xe);const Qe=Xe;function tn(t,e,n,r,o){const s=Math.floor(r/2);for(let r=0;r<s;r++)for(let s=0;s<e;s++)t[r*e+s]=t[(o-1-r)*e+s],t[(n-1-r)*e+s]=t[(n-o+r)*e+s];const i=Math.floor(o/2);for(let r=0;r<n;r++){const n=r*e;for(let r=0;r<i;r++)t[n+r]=t[n+o-1-r],t[n+e-r-1]=t[n+e+r-o]}}const en=new Map;function nn(t,e,n,r,o,s,i){const a=new Float32Array(e*n),l=s.length,u=i?0:r,c=i?r:0,h=i?1:e;for(let i=u;i<n-u;i++){const n=i*e;for(let i=c;i<e-c;i++){if(o&&!o[n+i])continue;let e=0;for(let o=0;o<l;o++)e+=t[n+i+(o-r)*h]*s[o];a[n+i]=e}}return a}function rn(t,e,n,r,o,s,i){const a=new Float32Array(e*n),l=Math.floor(r/2),u=Math.floor(o/2);for(let c=l;c<n-l;c++){const n=c*e;for(let c=u;c<e-u;c++){if(s&&!s[n+c])continue;let h=0;for(let s=0;s<r;s++)for(let r=0;r<o;r++)h+=t[n+c+(s-l)*e+r-u]*i[s*o+r];a[n+c]=h}}return a}var on;en.set(A.none,[0,0,0,0,1,0,0,0,0]),en.set(A.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),en.set(A.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),en.set(A.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),en.set(A.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),en.set(A.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]),en.set(A.gradientWest,[-1,0,1,-2,0,2,-1,0,1]),en.set(A.gradientEast,[1,0,-1,2,0,-2,1,0,-1]),en.set(A.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]),en.set(A.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),en.set(A.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),en.set(A.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),en.set(A.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),en.set(A.smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),en.set(A.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),en.set(A.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),en.set(A.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),en.set(A.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),en.set(A.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),en.set(A.sobelVertical,[-1,0,1,-2,0,2,-1,0,1]),en.set(A.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),en.set(A.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),en.set(A.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);let sn=on=class extends p{constructor(){super(...arguments),this.rows=3,this.cols=3,this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(t){this._set("convolutionType",t);const e=en.get(t);if(!e||t===A.userDefined||t===A.none)return;const n=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",n),this._set("rows",n)}clone(){return new on({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:(0,s.o8)(this.raster)})}};(0,i._)([(0,a.MZ)({json:{type:Number,write:!0}})],sn.prototype,"rows",void 0),(0,i._)([(0,a.MZ)({json:{type:Number,write:!0}})],sn.prototype,"cols",void 0),(0,i._)([(0,a.MZ)({json:{name:"type",type:Number,write:!0}})],sn.prototype,"convolutionType",null),(0,i._)([(0,a.MZ)({json:{type:[Number],write:!0}})],sn.prototype,"kernel",void 0),sn=on=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],sn);const an=sn;let ln=class extends v{constructor(){super(...arguments),this.functionName="Convolution",this.rasterArgumentNames=["raster"]}get _normalizedKernel(){const{kernel:t,convolutionType:e}=this.functionArguments,n=t.reduce(((t,e)=>t+e));return-1===e||0===n||1===n?t:t.map((t=>t/n))}_bindSourceRasters(){const{convolutionType:t,rows:e,cols:n,kernel:r}=this.functionArguments;if(!Object.values(A).includes(t))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${t}`};if(t!==A.none&&e*n!==r.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};const o=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(o.pixelType);const s=o.clone();s.pixelType=this.outputPixelType;const i=[A.none,A.sharpen,A.sharpen2,A.sharpening3x3,A.sharpening5x5];return(-1===t||"u8"!==this.outputPixelType&&!i.includes(t))&&(s.statistics=null,s.histograms=null),s.colormap=null,s.attributeTable=null,this.rasterInfo=s,{success:!0,supportsGPU:r.length<=25}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e||this.functionArguments.convolutionType===A.none)return e;const{rows:n,cols:r}=this.functionArguments,{_normalizedKernel:o}=this;return function(t,e){const n=function(t){const e=Math.sqrt(t.length),n=t.slice(0,e),r=[1];for(let n=1;n<e;n++){let o=null;for(let r=0;r<e;r++){const s=t[r+n*e],i=t[r];if(null==o)if(0===i){if(s)return{separable:!1,row:null,col:null}}else o=s/i;else if(s/i!==o)return{separable:!1,row:null,col:null}}if(null==o)return{separable:!1,row:null,col:null};r.push(o)}return{separable:!0,row:n,col:r}}(e.kernel),r=!1!==e.mirrorEdges,o=n.separable?function(t,e,n,r=!0){const{pixels:o,width:s,height:i,pixelType:a,mask:l}=t,u=o.length,c=[],h=e.length,p=n.length,f=Math.floor(h/2),d=Math.floor(p/2);for(let t=0;t<u;t++){let a=nn(o[t],s,i,f,l,e,!0);a=nn(a,s,i,d,l,n,!1),r&&tn(a,s,i,h,p),c.push(a)}return new y.A({width:s,height:i,pixelType:a,pixels:c,mask:l})}(t,n.row,n.col,r):function(t,e,n=!0){const{pixels:r,width:o,height:s,pixelType:i,mask:a}=t,l=r.length,u=[],{kernel:c,rows:h,cols:p}=e;for(let t=0;t<l;t++){const e=rn(r[t],o,s,h,p,a,c);n&&tn(e,o,s,h,p),u.push(e)}return new y.A({width:o,height:s,pixelType:i,pixels:u,mask:a})}(t,e,r),{outputPixelType:s}=e;return s&&o.clamp(s),o}(e,{kernel:o,rows:n,cols:r,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const t=new Float32Array(25);return t.set(this._normalizedKernel),{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:t,clampRange:(0,u.hP)(this.outputPixelType)}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],ln.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:an,json:{write:!0,name:"rasterFunctionArguments"}})],ln.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],ln.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)()],ln.prototype,"_normalizedKernel",null),ln=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ln);const un=ln;var cn;const hn=new Zt.J({0:"standard",1:"planform",2:"profile"},{useNumericKeys:!0});let pn=cn=class extends p{constructor(){super(...arguments),this.curvatureType="standard",this.zFactor=1}readCurvatureType(t,e){return hn.fromJSON(e.type??e.curvatureType??0)}clone(){return new cn({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};(0,i._)([(0,a.MZ)({json:{write:{target:"type"}}}),(0,zt.e)(hn)],pn.prototype,"curvatureType",void 0),(0,i._)([(0,ye.w)("curvatureType",["type","curvatureType"])],pn.prototype,"readCurvatureType",null),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],pn.prototype,"zFactor",void 0),pn=cn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],pn);const fn=pn;let dn=class extends v{constructor(){super(...arguments),this.functionName="Curvature",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0].clone();return t.pixelType=this.outputPixelType,t.bandCount=1,this._removeStatsHistColormapVAT(t),this.rasterInfo=t,this.isGCS=t.spatialReference?.isGeographic??!1,{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{zFactor:n,curvatureType:r}=this.functionArguments,{extent:o,primaryPixelSizes:s}=t,i=s?.[0],a=i??(o?{x:o.width/e.width,y:o.height/e.height}:{x:1,y:1}),l=this.isGCS&&n>=1?n*Lt.rk:n;return(0,Lt.E0)(e,{zFactor:l,curvatureType:r,resolution:a})}_getWebGLParameters(){const{zFactor:t,curvatureType:e}=this.functionArguments;return{curvatureType:e,zFactor:this.isGCS&&t>=1?t*Lt.rk:t}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],dn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:fn,json:{write:!0,name:"rasterFunctionArguments"}})],dn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],dn.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],dn.prototype,"isGCS",void 0),dn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.CurvatureFunction")],dn);const mn=dn;var gn;let yn=gn=class extends p{constructor(){super(...arguments),this.bandIds=[],this.bandNames=[],this.bandWavelengths=[],this.missingBandAction=$t.Wb.bestMatch}clone(){return new gn({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],yn.prototype,"bandIds",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],yn.prototype,"bandNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],yn.prototype,"bandWavelengths",void 0),(0,i._)([(0,zt.e)({0:"name",1:"wavelength",2:"id"})],yn.prototype,"method",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],yn.prototype,"missingBandAction",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],yn.prototype,"wavelengthMatchTolerance",void 0),yn=gn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],yn);const xn=yn;let wn=class extends v{constructor(){super(...arguments),this.functionName="ExtractBand",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{functionArguments:t,sourceRasterInfos:e}=this,n=e[0],{method:r,bandNames:o,bandWavelengths:s,bandIds:i,missingBandAction:a}=t,l=o?.length&&("name"===r||"id"!==r&&!i?.length),u=s?.length&&("wavelength"===r||"id"!==r&&!i?.length),c=a===$t.Wb.fail,h=l?function(t,e){const n=t.bandInfos.map((({name:t})=>t.toLowerCase())),r=[];for(let t=0;t<e.length;t++){const o=e[t].toLowerCase();let s=n.indexOf(o);if(-1===s&&"nearinfrared"===o&&(s=n.findIndex((t=>t.startsWith("nearinfrared_1"))),-1===s&&(s=n.findIndex((t=>t.startsWith("nearinfrared"))))),-1===s)return null;r.push(s)}return r}(n,o):u?function(t,e,{wavelengthMatchTolerance:n},r){const{bandInfos:o}=t,s=[];for(let t=0;t<o.length;t++){const{minWavelength:e,maxWavelength:n}=o[t];if(!e||!n)return null;s.push({minWavelength:e,maxWavelength:n})}const i=[];for(let t=0;t<e.length;t++){const o=e[t];let a=!1,l=-1,u=Number.MAX_VALUE;for(let t=0;t<s.length;t++){const e=s[t],n=o>=e.minWavelength&&o<=e.maxWavelength,r=Math.abs(o-(e.minWavelength+e.maxWavelength)/2);n?r<u&&(a=!0,l=t,u=r):!a&&r<u&&(l=t,u=r)}if(!a&&n&&u<n&&(a=!0),!a&&r)return null;i.push(l)}return i}(n,s,this.functionArguments,c):function(t,e,n){const{bandCount:r}=t;return!e?.length||n&&e.some((t=>t<0||t>=r))?null:e}(n,i,c);if(null==h)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${l?"band names":u?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=h,this.functionArguments.method="id",this.outputPixelType=this._getOutputPixelType("f32");const p=n.clone();p.pixelType=this.outputPixelType,p.bandCount=h.length;const{statistics:f,histograms:d}=p;null!=f&&f.length&&(p.statistics=h.map((t=>f[t]||f[f.length-1]))),null!=d&&d.length&&(p.histograms=h.map((t=>d[t]||d[d.length-1]))),p.multidimensionalInfo&&p.multidimensionalInfo.variables.forEach((t=>{const{statistics:e,histograms:n}=t;null!=e&&e.length&&(t.statistics=h.map((t=>e[t]||e[e.length-1]))),null!=n&&n.length&&(t.histograms=h.map((t=>n[t]||n[n.length-1])))}));let m=p.keyProperties?.BandProperties;return m?.length&&(m=h.map((t=>t>=m.length?m[m.length-1]:m[t])),p.keyProperties={...p.keyProperties,BandProperties:m}),this.rasterInfo=p,{success:!0,supportsGPU:p.bandCount<=3}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const n=e.pixels.length,r=this.functionArguments.bandIds.map((t=>t>=n?n-1:t));return e.extractBands(r)}_getWebGLParameters(){let t;if(this.isInputBandIdsSwizzled)t=this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{t=[...this.functionArguments.bandIds],0===t.length?t=[0,1,2]:t.length<3&&(t[1]=t[1]??t[0],t[2]=t[2]??t[1]);for(let e=0;e<3;e++)t[e]=Math.min(t[e],2)}return{bandIndexMat3:Xt(t)}}_getInputBandIds(t){const e=t.length;return this.functionArguments.bandIds.map((t=>t>=e?e-1:t)).map((e=>t[e]))}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],wn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:xn,json:{write:!0,name:"rasterFunctionArguments"}})],wn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],wn.prototype,"rasterArgumentNames",void 0),wn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ExtractBandFunction")],wn);const bn=wn;var vn;let An=vn=class extends p{clone(){return new vn({conversionParameters:[...this.conversionParameters],raster:this.raster})}};(0,i._)([(0,a.MZ)({type:[Number],json:{write:!0}})],An.prototype,"conversionParameters",void 0),An=vn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],An);const Mn=An;let Cn=class extends v{constructor(){super(...arguments),this.functionName="Grayscale",this.functionArguments=null,this.rasterArgumentNames=["raster"]}get _normalizedWeights(){const{conversionParameters:t}=this.functionArguments,e=t.reduce(((t,e)=>t+e));return t.map((t=>t/e))}_bindSourceRasters(){const{conversionParameters:t}=this.functionArguments;if(!t?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const e=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(e.pixelType),e.pixelType=this.outputPixelType;const n=3===t.length||3===e.bandCount&&t.length>3;return e.bandCount=1,this._removeStatsHistColormapVAT(e),this.rasterInfo=e,{success:!0,supportsGPU:n}}_processPixels(t){const e=t.pixelBlocks?.[0];return null==e?null:function(t,e,n){const{pixels:r,width:o,height:s,mask:i,bandMasks:a}=t,l=o*s,c=a?.length?y.A.combineBandMasks(a):i,h=Math.min(e.length,r.length),p=n.startsWith("f"),f=!p&&n!==t.pixelType,[d,m]=(0,u.hP)(n),g=y.A.createEmptyBand(n,l);for(let t=0;t<s;t++){let n=t*o;for(let t=0;t<o;t++,n++)if(!c||c[n]){let t=0;for(let o=0;o<h;o++)t+=e[o]*r[o][n];p||(t=Math.round(t),f&&(t=t>m?m:t<d?d:t)),g[n]=t}}const x=new y.A({width:o,height:s,pixels:[g],pixelType:n,mask:c});return x.updateStatistics(),x}(e,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Cn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Mn,json:{write:!0,name:"rasterFunctionArguments"}})],Cn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Cn.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)()],Cn.prototype,"_normalizedWeights",null),Cn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.GrayscaleFunction")],Cn);const kn=Cn;var Tn;const Pn=new Zt.J({0:"traditional",1:"multi-directional"},{useNumericKeys:!0}),Sn=new Zt.J({1:"degree",2:"percent-rise",3:"scaled"},{useNumericKeys:!0});let _n=Tn=class extends p{constructor(){super(...arguments),this.altitude=45,this.azimuth=315,this.hillshadeType="traditional",this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.slopeType="degree",this.zFactor=1,this.removeEdgeEffect=!1}clone(){return new Tn({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],_n.prototype,"altitude",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],_n.prototype,"azimuth",void 0),(0,i._)([(0,a.MZ)(),(0,zt.e)(Pn)],_n.prototype,"hillshadeType",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0,name:"psPower"}})],_n.prototype,"pixelSizePower",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0,name:"psZFactor"}})],_n.prototype,"pixelSizeFactor",void 0),(0,i._)([(0,a.MZ)(),(0,zt.e)(Sn)],_n.prototype,"slopeType",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],_n.prototype,"zFactor",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],_n.prototype,"removeEdgeEffect",void 0),_n=Tn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.HillshadeFunctionArguments")],_n);const In=_n;let Rn=class extends v{constructor(){super(...arguments),this.functionName="Hillshade",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const t=this.sourceRasterInfos[0];if(t.bandCount>1)return{success:!1,supportsGPU:!1,error:"hillshade-function: source data must be single band"};this.outputPixelType=this._getOutputPixelType("u8");const e=t.clone();return this._removeStatsHistColormapVAT(e),e.pixelType=this.outputPixelType,e.bandCount=1,e.statistics=[{min:0,max:255,avg:60,stddev:10}],this.rasterInfo=e,this.isGCS=e.spatialReference?.isGeographic??!1,{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if(!e)return null;const{extent:n,primaryPixelSizes:r}=t,o=r?.[0],s=o??(n?{x:n.width/e.width,y:n.height/e.height}:{x:1,y:1}),i=(0,Lt.PP)(this.functionArguments,s,this.isGCS),a=(0,Lt.fw)(e,i);return a.pixelType=this.outputPixelType,a}_getWebGLParameters(){const t=(0,Lt.PP)(this.functionArguments,{x:1,y:1},this.isGCS),e=(0,Lt.ng)(t),{slopeType:n,zFactor:r,pixelSizeFactor:o,pixelSizePower:s}=this.functionArguments,i="scaled"===n,a=(0,u.zw)(this.outputPixelType);return{...e,zFactor:r,gcsFactor:this.isGCS?Lt.rk:1,pixelSizeFactor:i?o:0,pixelSizePower:i?s:0,isOutputRounded:a}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Rn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:In,json:{write:!0,name:"rasterFunctionArguments"}})],Rn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Rn.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Rn.prototype,"isGCS",void 0),Rn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.HillshadeFunction")],Rn);const Nn=Rn;var Fn;let En=Fn=class extends p{constructor(){super(...arguments),this.rasters=[],this.processAsMultiband=!0}writeRasters(t,e){e.rasters=t.map((t=>"number"==typeof t||"string"==typeof t?t:t.toJSON()))}clone(){return new Fn({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,s.o8)(this.rasters)})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],En.prototype,"operation",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],En.prototype,"rasters",void 0),(0,i._)([(0,Be.K)("rasters")],En.prototype,"writeRasters",null),(0,i._)([(0,a.MZ)({json:{write:!0}})],En.prototype,"processAsMultiband",void 0),En=Fn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],En);const Bn=En;let On=class extends v{constructor(){super(...arguments),this.functionName="Local",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0],{bandCount:n}=e,{processAsMultiband:r}=this.functionArguments;if(t.some((t=>t.bandCount!==n)))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const{operation:o,rasters:s}=this.functionArguments,i=_[o];if(!(999===i||s.length===i||s.length<=1&&1===i))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${i}`};const a=e.clone();return a.bandCount=999!==i||r?n:1,this._removeStatsHistColormapVAT(a),this._updateStatistics(a),this._updatePixelType(a),this.rasterInfo=a,{success:!0,supportsGPU:1===a.bandCount&&i<=3}}_processPixels(t){const{pixelBlocks:e}=t;return null==e||e.some((t=>null==t))?null:Ft(e,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const{operation:t}=this.functionArguments,e=_[t],n=Object.keys(T).find((e=>T[e]===t))?.toLowerCase()??"undefined",r=this.outputPixelType??"f32";let[o,s]=(0,u.hP)(r);const i=(0,u.zw)(r);return i&&(o-=1e-4,s+=1e-4),{imageCount:e,operationName:n,domainRange:[o,s],isOutputRounded:i}}_updateStatistics(t){const e=this.sourceRasterInfos[0],{operation:n}=this.functionArguments,r=S(n)?.domain;if(r){t.statistics=[];for(let e=0;e<t.bandCount;e++)t.statistics[e]={min:r[0],max:r[1],avg:(r[0]+r[1])/2,stddev:(r[0]+r[1])/10}}else 45===n&&e.statistics?.length&&(t.statistics=e.statistics.map((t=>({min:-t.max,max:-t.min,avg:null!=t.avg?-t.avg:void 0,stddev:null!=t.stddev?-t.stddev:void 0}))))}_updatePixelType(t){const{statistics:e,pixelType:n}=this.sourceRasterInfos[0],{operation:r}=this.functionArguments,{domain:o,isInteger:s}=S(r)??{domain:null,isInteger:!1};let i="f32";if(o&&s)i=(0,u.X1)(o[0],o[1]);else if(30===r){const t=e?.[0];i=t?(0,u.X1)(t.min,t.max):(0,u.zw)(n)?n:"s32"}else if(45===r&&(0,u.zw)(n)){const t=e?.map((({max:t})=>-t)),r=e?.map((({min:t})=>-t)),o=t?.length?Math.min(...t):null,s=r?.length?Math.min(...r):null;i=null!=o&&null!=s?(0,u.X1)(o,s):n.startsWith("s")?n.replace("s","u"):"u1"===n||"u2"===n||"u4"===n?"s8":"u8"===n?"s16":"s32"}t.pixelType=this.outputPixelType=this._getOutputPixelType(i)}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],On.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Bn,json:{write:!0,name:"rasterFunctionArguments"}})],On.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],On.prototype,"rasterArgumentNames",void 0),On=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.LocalFunction")],On);const Gn=On;var Dn,Ln=n(15774);let Un=Dn=class extends p{constructor(){super(...arguments),this.includedRanges=null,this.noDataValues=null,this.noDataInterpretation=$t.IB.matchAny}get normalizedNoDataValues(){const{noDataValues:t}=this;if(!t?.length)return null;let e=!1;const n=t.map((t=>{if("number"==typeof t)return e=!0,[t];if("string"==typeof t){const n=t.trim().split(" ").filter((t=>""!==t.trim())).map((t=>Number(t)));return e=e||n.length>0,0===n.length?null:n}return null}));return e?n:null}clone(){return new Dn({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Un.prototype,"includedRanges",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Un.prototype,"noDataValues",void 0),(0,i._)([(0,a.MZ)()],Un.prototype,"normalizedNoDataValues",null),(0,i._)([(0,a.MZ)({json:{write:!0}})],Un.prototype,"noDataInterpretation",void 0),Un=Dn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],Un);const jn=Un;let zn=class extends v{constructor(){super(...arguments),this.functionName="Mask",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:e}=t;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;const{includedRanges:n,normalizedNoDataValues:r}=this.functionArguments;if(!n?.length&&!r?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};let o=[];for(let s=0;s<t.bandCount;s++){const t=(0,$t.Wt)(e,n?.slice(2*s,2*s+2),r?.[s]);if(null==t){o=null;break}o.push(t)}this.lookups=o;const s=null!=r&&r.every((t=>t?.length===r[0]?.length));return{success:!0,supportsGPU:(!n||n.length<=2*$t.et)&&(!r||s&&r[0].length<=$t.et)}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{outputPixelType:n,lookups:r}=this,{includedRanges:o,noDataInterpretation:s,normalizedNoDataValues:i}=this.functionArguments,a=s===$t.IB.matchAll;return(0,$t.dK)(e,{includedRanges:o,noDataValues:i,outputPixelType:n,matchAll:a,lookups:r})}_getWebGLParameters(){const{includedRanges:t,normalizedNoDataValues:e}=this.functionArguments,n=new Float32Array($t.et);n.fill(Ln.pq),e?.[0]?.length&&n.set(e[0]);const r=new Float32Array($t.et);for(let e=0;e<r.length;e+=2)r[e]=t?.[e]??-Ln.pq,r[e+1]=t?.[e+1]??Ln.pq;return t?.length&&r.set(t),{bandCount:this.sourceRasterInfos[0].bandCount,noDataValues:n,includedRanges:r}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],zn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:jn,json:{write:!0,name:"rasterFunctionArguments"}})],zn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],zn.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],zn.prototype,"lookups",void 0),zn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.MaskFunction")],zn);const Zn=zn;var Vn;let Wn=Vn=class extends p{constructor(){super(...arguments),this.visibleBandID=0,this.infraredBandID=1,this.scientificOutput=!1}clone(){const{visibleBandID:t,infraredBandID:e,scientificOutput:n}=this;return new Vn({visibleBandID:t,infraredBandID:e,scientificOutput:n})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Wn.prototype,"visibleBandID",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Wn.prototype,"infraredBandID",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Wn.prototype,"scientificOutput",void 0),Wn=Vn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],Wn);const Hn=Wn;let Jn=class extends v{constructor(){super(...arguments),this.functionName="NDVI",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{scientificOutput:t,visibleBandID:e,infraredBandID:n}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(t?"f32":"u8");const r=this.sourceRasterInfos[0],o=Math.max(e,n);if(r.bandCount<2||o>=r.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};const s=r.clone();s.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(s),s.bandCount=1,s.keyProperties={...s.keyProperties,BandProperties:void 0};const[i,a,l,u]=t?[-1,1,0,.1]:[0,200,100,10];return s.statistics=[{min:i,max:a,avg:l,stddev:u}],this.rasterInfo=s,{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{visibleBandID:n,infraredBandID:r,scientificOutput:o}=this.functionArguments;return function(t,e,n,r){const{mask:o,pixels:s,width:i,height:a}=t,l=s[n],u=s[e],c=u.length,h=r?new Uint8Array(c):new Float32Array(c),p=r?100:1,f=r?100.5:0;for(let t=0;t<c;t++)if(null==o||o[t]){const e=l[t],n=u[t],r=e+n;r&&(h[t]=(e-n)/r*p+f)}const d=new y.A({width:i,height:a,mask:o,pixelType:r?"u8":"f32",pixels:[h]});return d.updateStatistics(),d}(e,n,r,!o)}_getWebGLParameters(){const{visibleBandID:t,infraredBandID:e,scientificOutput:n}=this.functionArguments;return{bandIndexMat3:Xt(this.isInputBandIdsSwizzled?[0,1,2]:[e,t,0]),scaled:!n}}_getInputBandIds(t){const{visibleBandID:e,infraredBandID:n}=this.functionArguments;return[n,e,0].map((e=>t[e]))}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Jn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Hn,json:{write:!0,name:"rasterFunctionArguments"}})],Jn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Jn.prototype,"rasterArgumentNames",void 0),Jn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.NDVIFunction")],Jn);const qn=Jn;var $n;let Kn=$n=class extends p{constructor(){super(...arguments),this.inputRanges=null,this.outputValues=null,this.noDataRanges=null,this.allowUnmatched=!1,this.isLastInputRangeInclusive=!1}clone(){return new $n({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Kn.prototype,"inputRanges",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Kn.prototype,"outputValues",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Kn.prototype,"noDataRanges",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Kn.prototype,"allowUnmatched",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Kn.prototype,"isLastInputRangeInclusive",void 0),Kn=$n=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],Kn);const Yn=Kn;let Xn=class extends v{constructor(){super(...arguments),this.functionName="Remap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:e}=t;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.bandCount=1;const{statistics:n}=t;this._removeStatsHistColormapVAT(t);const{allowUnmatched:r,outputValues:o,inputRanges:s,noDataRanges:i,isLastInputRangeInclusive:a}=this.functionArguments;if(null!=n&&n.length&&o?.length)if(r){const e=Math.min.apply(null,[...o,n[0].min]),r=Math.max.apply(null,[...o,n[0].max]);t.statistics=[{...n[0],min:e,max:r}]}else{let e=o[0],r=e;for(let t=0;t<o.length;t++)e=e>o[t]?o[t]:e,r=r>o[t]?r:o[t];t.statistics=[{...n[0],min:e,max:r}]}return this.rasterInfo=t,this.lookup=r?null:(0,$t.XU)({srcPixelType:e,inputRanges:s,outputValues:o,noDataRanges:i,allowUnmatched:r,isLastInputRangeInclusive:a,outputPixelType:this.outputPixelType}),{success:!0,supportsGPU:(!o||o.length<=$t.et)&&(!i||i.length<=$t.et)}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{lookup:n,outputPixelType:r}=this;if(n){const t=(0,$t.eH)(e,{lut:[n.lut],offset:n.offset,outputPixelType:r});return null!=t&&n.mask&&(t.mask=(0,$t.UK)(e.pixels[0],e.mask,n.mask,n.offset,"u8")),t}const{inputRanges:o,outputValues:s,noDataRanges:i,allowUnmatched:a,isLastInputRangeInclusive:l}=this.functionArguments;return(0,$t.Ew)(e,{inputRanges:o,outputValues:s,noDataRanges:i,outputPixelType:r,allowUnmatched:a,isLastInputRangeInclusive:l})}_getWebGLParameters(){const{allowUnmatched:t,noDataRanges:e,isLastInputRangeInclusive:n}=this.functionArguments,r=new Float32Array(3*$t.et),o=1e-5,s=this.functionArguments.inputRanges??[],i=this.functionArguments.outputValues??[],a=i.length;for(let t=0;t<$t.et;t++)r[3*t]=s[2*t]??Ln.pq-1,r[3*t+1]=s[2*t+1]??Ln.pq,r[3*t+2]=i[t]??0,t<a&&(t>0&&(r[3*t]-=o),(t<a-1||!n)&&(r[3*t+1]-=o));const l=new Float32Array(2*$t.et);return l.fill(Ln.pq),e?.length&&l.set(e),{allowUnmatched:t,rangeMaps:r,noDataRanges:l,clampRange:(0,u.hP)(this.outputPixelType)}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Xn.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Yn,json:{write:!0,name:"rasterFunctionArguments"}})],Xn.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Xn.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Xn.prototype,"lookup",void 0),Xn=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.RemapFunction")],Xn);const Qn=Xn;var tr;let er=tr=class extends In{readColorRamp(t){if("string"==typeof t){const e=xe.kH.jsonValues.find((e=>e.toLowerCase()===t.toLowerCase()));return e?(0,xe.M5)(xe.kH.fromJSON(e)):null}return"toJSON"in t?t.toJSON():t}clone(){return new tr({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,slopeType:this.slopeType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,removeEdgeEffect:this.removeEdgeEffect,colorRamp:this.colorRamp,colormap:this.colormap,raster:this.raster})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],er.prototype,"colorRamp",void 0),(0,i._)([(0,ye.w)("colorRamp")],er.prototype,"readColorRamp",null),(0,i._)([(0,a.MZ)({type:[[Number]],json:{write:!0}})],er.prototype,"colormap",void 0),er=tr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ShadedReliefFunctionArguments")],er);const nr=er;let rr=class extends v{constructor(){super(...arguments),this.functionName="ShadedRelief",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const t=this.sourceRasterInfos[0];if(t.bandCount>1)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: source data must be single band"};let{colorRamp:e,colormap:n}=this.functionArguments;if(!e&&!n?.length)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: a color ramp argument must be specified"};this.outputPixelType=this._getOutputPixelType("u8");const r=t.clone();this._removeStatsHistColormapVAT(r),r.pixelType=this.outputPixelType,r.bandCount=3,r.statistics=[{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10},{min:0,max:255,avg:60,stddev:10}],this.rasterInfo=r,this.isGCS=r.spatialReference?.isGeographic??!1,n?.length||(n=(0,xe.R8)(e,{interpolateAlpha:!0}));const{indexedColormap:o,offset:s}=(0,$t.zg)({colormap:n});if(!o?.length)return{success:!1,supportsGPU:!1,error:"shadedrelief-function: a valid colorramp is required"};const i=(0,xe.S2)(o);return this.lookup={indexedColormap:o,offset:s,hsvMap:i},{success:!0,supportsGPU:(0,Re.WN)(o)}}_processPixels(t){const e=t.pixelBlocks?.[0];if(!e||!this.lookup)return null;let n=t.primaryPixelSizes?.[0];if(null==n){const{extent:r}=t;n=r?{x:r.width/e.width,y:r.height/e.height}:{x:1,y:1}}const r=(0,Lt.PP)(this.functionArguments,n,this.isGCS),o=(0,Lt.fw)(e,r),s=this.sourceRasterInfos[0].statistics?.[0]??{min:0,max:8e3};return(0,Lt.SC)(o,e,this.lookup.hsvMap,s),o.pixelType=this.outputPixelType,o}_getWebGLParameters(){const t=(0,Lt.PP)(this.functionArguments,{x:1,y:1},this.isGCS),e=(0,Lt.ng)(t),{slopeType:n,zFactor:r,pixelSizeFactor:o,pixelSizePower:s}=this.functionArguments,i="scaled"===n,{indexedColormap:a,offset:l}=this.lookup,c=this.sourceRasterInfos[0].statistics?.[0],h=(0,u.zw)(this.outputPixelType);return{...e,indexedColormap:a,offset:l,zFactor:r,gcsFactor:this.isGCS?Lt.rk:1,pixelSizeFactor:i?o:0,pixelSizePower:i?s:0,minValue:c?.min??0,maxValue:c?.max??8e3,isOutputRounded:h}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],rr.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:nr,json:{write:!0,name:"rasterFunctionArguments"}})],rr.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],rr.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],rr.prototype,"isGCS",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],rr.prototype,"lookup",void 0),rr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.ShadedReliefFunction")],rr);const or=rr;var sr;const ir=new Zt.J({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});let ar=sr=class extends p{constructor(){super(...arguments),this.slopeType="degree",this.zFactor=1,this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.removeEdgeEffect=!1}clone(){return new sr({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};(0,i._)([(0,zt.e)(ir)],ar.prototype,"slopeType",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],ar.prototype,"zFactor",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{name:"psPower",write:!0}})],ar.prototype,"pixelSizePower",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{name:"psZFactor",write:!0}})],ar.prototype,"pixelSizeFactor",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],ar.prototype,"removeEdgeEffect",void 0),ar=sr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],ar);const lr=ar;let ur=class extends v{constructor(){super(...arguments),this.functionName="Slope",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0].clone();return t.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(t),t.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null,t.bandCount=1,this.rasterInfo=t,this.isGCS=t.spatialReference?.isGeographic??!1,{success:!0,supportsGPU:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return null;const{zFactor:n,slopeType:r,pixelSizePower:o,pixelSizeFactor:s}=this.functionArguments,{isGCS:i}=this,{extent:a,primaryPixelSizes:l}=t,u=l?.[0],c=u??(a?{x:a.width/e.width,y:a.height/e.height}:{x:1,y:1});return(0,Lt.yy)(e,{zFactor:n,slopeType:r,pixelSizePower:o,pixelSizeFactor:s,isGCS:i,resolution:c})}_getWebGLParameters(){const{zFactor:t,slopeType:e,pixelSizeFactor:n,pixelSizePower:r}=this.functionArguments;return{zFactor:this.isGCS&&t>=1?t*Lt.rk:t,slopeType:e,pixelSizeFactor:n??0,pixelSizePower:r??0,isOutputRounded:(0,u.zw)(this.outputPixelType)}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],ur.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:lr,json:{write:!0,name:"rasterFunctionArguments"}})],ur.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],ur.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],ur.prototype,"isGCS",void 0),ur=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.SlopeFunction")],ur);const cr=ur,hr=new Zt.J({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});function pr(t,e){const{fillNoDataOnly:n}=e,{band:r,width:o,height:s,mask:i,outBand:a}=t;if(n&&!i)return void a.set(r);const{statisticsType:l,kernelRows:u,kernelCols:c}=e,h="stddev"===l,p=o*s,f=new Float64Array(p),d=new Float64Array(p),m=new Uint32Array(p);for(let t=0;t<s;t++){const e=t*o;let n=0,s=0,a=0;for(let t=0;t<c;t++)i&&!i[e+t]||(n+=r[e+t],h&&(s+=r[e+t]**2),a++);f[e]=n,d[e]=s,m[e]=a;for(let t=1;t<=o-c;t++){const o=e+t-1,l=o+c;i?(i[o]&&(a--,n-=r[o],h&&(s-=r[o]**2)),i[l]&&(a++,n+=r[l],h&&(s+=r[l]**2))):(n-=r[o],n+=r[l],h&&(s-=r[o]**2,s+=r[l]**2)),f[e+t]=n,m[e+t]=a,h&&(d[e+t]=s)}}const g=new Float64Array(p),y=new Float64Array(p),x=new Uint32Array(p),w=u*o;for(let t=0;t<=o-c;t++){let e=0,n=0,r=0;for(let s=0;s<u;s++){const i=s*o+t;e+=f[i],r+=m[i],h&&(n+=d[i])}g[t]=e,y[t]=n,x[t]=r;for(let i=1;i<=s-u;i++){const s=(i-1)*o+t,a=s+w;e-=f[s],e+=f[a],r-=m[s],r+=m[a],h&&(n-=d[s],n+=d[a]),g[i*o+t]=e,y[i*o+t]=n,x[i*o+t]=r}}const b=Math.floor(u/2),v=Math.floor(c/2);for(let t=b;t<s-b;t++){const e=t*o;for(let r=v;r<o-v;r++){const s=(t-b)*o+r-v,l=x[s];if(0===l||n&&(!i||i[e+r]))continue;const u=g[s]/l,c=h?Math.sqrt((y[s]-g[s]*u)/l):u;a[e+r]=c,i&&(i[e+r]=255)}}}function fr(t,e){const{fillNoDataOnly:n}=e,{band:r,width:o,height:s,mask:i,outBand:a}=t;if(n&&!i)return void a.set(r);const{kernelRows:l,kernelCols:u,statisticsType:c}=e,h=Math.floor(l/2),p=Math.floor(u/2),f="min"===c,d=a.slice(),m=new Uint32Array(o*s);for(let t=h;t<s-h;t++){const e=t*o;for(let t=p;t<o-p;t++){let n=f?Number.MAX_VALUE:-Number.MAX_VALUE,s=0;for(let a=0;a<l;a++)for(let l=0;l<u;l++){const u=e+t+(a-h)*o+l-p;i&&!i[u]||(n=f?Math.min(n,r[u]):Math.max(n,r[u]),s++)}i?(d[e+t]=0===s?0:n,m[e+t]=s):a[e+t]=0===s?0:n}}if(i)for(let t=h;t<s-h;t++){const e=t*o;for(let t=p;t<o-p;t++)if(m[e+t]){if(n&&i[e+t])continue;a[e+t]=d[e+t],i[e+t]=255}}}function dr(t,e){const{fillNoDataOnly:n}=e,{band:r,width:o,height:s,mask:i,outBand:a}=t;if(n&&!i)return void a.set(r);const{kernelRows:l,kernelCols:u}=e,c=Math.floor(l/2),h=Math.floor(u/2),p=a.slice(),f=new Uint32Array(o*s);for(let t=c;t<s-c;t++){const e=t*o;for(let t=h;t<o-h;t++){if(n&&i?.[e+t])continue;const s=[];for(let n=0;n<l;n++)for(let a=0;a<u;a++){const l=e+t+(n-c)*o+a-h;i&&!i[l]||s.push(r[l])}s.length&&(s.sort(((t,e)=>t-e)),i?(p[e+t]=s[Math.floor((s.length-1)/2)],f[e+t]=s.length):a[e+t]=s[Math.floor((s.length-1)/2)])}}if(i)for(let t=c;t<s-c;t++){const e=t*o;for(let t=h;t<o-h;t++)if(f[e+t]){if(n&&i[e+t])continue;a[e+t]=p[e+t],i[e+t]=255}}}function mr(t,e){const{fillNoDataOnly:n}=e,{band:r,width:o,height:s,mask:i,outBand:a}=t;if(n&&!i)return void a.set(r);const{kernelRows:l,kernelCols:u}=e,c=Math.floor(l/2),h=Math.floor(u/2),p="majority"===e.statisticsType,f=l*u,d=a.slice(),m=new Uint32Array(o*s);for(let t=c;t<s-c;t++){const e=t*o;for(let t=h;t<o-h;t++){if(n&&i?.[e+t])continue;const s=new Map;for(let n=0;n<l;n++)for(let a=0;a<u;a++){const l=e+t+(n-c)*o+a-h;if(i&&!i[l])continue;const u=r[l];s.set(u,s.has(u)?s.get(u)+1:1)}if(0===s.size)continue;let g=0,y=0,x=p?0:f+1;for(const t of s.keys())y=s.get(t),p===y>x&&(x=y,g=t);i?(d[e+t]=g,m[e+t]=s.size):a[e+t]=g}}if(i)for(let t=c;t<s-c;t++){const e=t*o;for(let t=h;t<o-h;t++)if(m[e+t]){if(n&&i[e+t])continue;a[e+t]=d[e+t],i[e+t]=255}}}var gr;let yr=gr=class extends p{constructor(){super(...arguments),this.rows=3,this.cols=3,this.fillNoDataOnly=!1,this.statisticsType="min"}clone(){return new gr({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:(0,s.o8)(this.raster)})}};(0,i._)([(0,a.MZ)({json:{write:!0,read:{source:["kernelRows","rows"],reader:(t,e)=>Number(t??e?.kernelRows??3)}}})],yr.prototype,"rows",void 0),(0,i._)([(0,a.MZ)({json:{write:!0,read:{source:["kernelCols","cols"],reader:(t,e)=>Number(t??e?.kernelCols??3)}}})],yr.prototype,"cols",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],yr.prototype,"fillNoDataOnly",void 0),(0,i._)([(0,a.MZ)({json:{read:{source:["statisticsType","type"],reader:(t,e)=>hr.fromJSON(e?.statisticsType??e?.type)??"min"},write:{target:"type"}}}),(0,zt.e)(hr)],yr.prototype,"statisticsType",void 0),yr=gr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],yr);const xr=yr;let wr=class extends v{constructor(){super(...arguments),this.functionName="Statistics",this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{type:t}=this.functionArguments.toJSON();if(t<1||t>7)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${t}`};const e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);const n=e.clone();n.pixelType=this.outputPixelType;const{statisticsType:r}=this.functionArguments;return"stddev"===r&&this._removeStatsHistColormapVAT(n),this.rasterInfo=n,{success:!0,supportsGPU:n.bandCount<=3&&t<5}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return e;const{statisticsType:n,rows:r,cols:o,fillNoDataOnly:s}=this.functionArguments;return function(t,e){const{mask:n}=t,{fillNoDataOnly:r}=e;if(r&&!n)return t;const{pixels:o,width:s,height:i,bandMasks:a,pixelType:l}=t,u=o.length,c=s*i,h=[],{kernelRows:p,kernelCols:f,statisticsType:d,mirrorEdges:m}=e;if(r&&!n)return t;const g=e.outputPixelType??l,x=[];for(let t=0;t<u;t++){const l=o[t],u=y.A.createEmptyBand(g,c);r&&u.set(l);const w=a?.[t]??n,b=w?.slice()??null,v={band:l,width:s,height:i,mask:b,outBand:u};switch(d){case"min":case"max":fr(v,e);break;case"mean":case"stddev":pr(v,e);break;case"median":dr(v,e);break;case"majority":case"minority":mr(v,e)}m&&!r&&tn(u,s,i,p,f),h.push(u),b&&x.push(b)}let w=x[0]??n;x.length!==u&&(x.length=0),u>1&&a?.length&&(w=y.A.combineBandMasks(a));const b=new y.A({pixelType:g,width:s,height:i,pixels:h,bandMasks:a&&x.length?x:null,mask:w});return b.updateStatistics(),b}(e,{kernelRows:r,kernelCols:o,fillNoDataOnly:s,outputPixelType:this.outputPixelType,statisticsType:n,mirrorEdges:!0})}_getWebGLParameters(){const{rows:t,cols:e,statisticsType:n,fillNoDataOnly:r}=this.functionArguments;return{fillNoDataOnly:r,kernelRows:t,kernelCols:e,statisticsType:n,clampRange:(0,u.hP)(this.outputPixelType)}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],wr.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:xr,json:{write:!0,name:"rasterFunctionArguments"}})],wr.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],wr.prototype,"rasterArgumentNames",void 0),wr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StatisticsFunction")],wr);const br=wr;var vr;let Ar=vr=class extends p{constructor(){super(...arguments),this.statistics=null,this.histograms=null}readStatistics(t,e){if(!t?.length)return null;const n=[];return t.forEach((t=>{const e={min:t.min,max:t.max,avg:t.avg??t.mean,stddev:t.stddev??t.standardDeviation};n.push(e)})),n}writeStatistics(t,e,n){if(!t?.length)return;const r=[];t.forEach((t=>{const e={...t,mean:t.avg,standardDeviation:t.stddev};delete e.avg,delete e.stddev,r.push(e)})),e[n]=r}clone(){return new vr({statistics:(0,s.o8)(this.statistics),histograms:(0,s.o8)(this.histograms)})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Ar.prototype,"statistics",void 0),(0,i._)([(0,ye.w)("statistics")],Ar.prototype,"readStatistics",null),(0,i._)([(0,Be.K)("statistics")],Ar.prototype,"writeStatistics",null),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ar.prototype,"histograms",void 0),Ar=vr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],Ar);const Mr=Ar;let Cr=class extends v{constructor(){super(...arguments),this.functionName="StatisticsHistogram",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");const e=t.clone(),{statistics:n,histograms:r}=this.functionArguments;return r&&(e.histograms=r),n&&(e.statistics=n),this.rasterInfo=e,{success:!0,supportsGPU:!0}}_processPixels(t){return t.pixelBlocks?.[0]}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Cr.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Mr,json:{write:!0,name:"rasterFunctionArguments"}})],Cr.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Cr.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Cr.prototype,"indexedColormap",void 0),(0,i._)([(0,a.MZ)()],Cr.prototype,"isNoopProcess",void 0),Cr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],Cr);const kr=Cr;var Tr;const Pr=new Zt.J({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});let Sr=Tr=class extends p{constructor(){super(...arguments),this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.histograms=null,this.statistics=null,this.stretchType="none",this.useGamma=!1}writeStatistics(t,e,n){t?.length&&(Array.isArray(t[0])||(t=t.map((t=>[t.min,t.max,t.avg,t.stddev]))),e[n]=t)}clone(){return new Tr({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,s.o8)(this.statistics),gamma:(0,s.o8)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,s.o8)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],Sr.prototype,"computeGamma",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{name:"dra",write:!0}})],Sr.prototype,"dynamicRangeAdjustment",void 0),(0,i._)([(0,a.MZ)({type:[Number],json:{write:!0}})],Sr.prototype,"gamma",void 0),(0,i._)([(0,a.MZ)()],Sr.prototype,"histograms",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],Sr.prototype,"maxPercent",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],Sr.prototype,"minPercent",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],Sr.prototype,"numberOfStandardDeviations",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{name:"max",write:!0}})],Sr.prototype,"outputMax",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{name:"min",write:!0}})],Sr.prototype,"outputMin",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],Sr.prototype,"sigmoidStrengthLevel",void 0),(0,i._)([(0,a.MZ)({json:{type:[[Number]],write:!0}})],Sr.prototype,"statistics",void 0),(0,i._)([(0,Be.K)("statistics")],Sr.prototype,"writeStatistics",null),(0,i._)([(0,zt.e)(Pr)],Sr.prototype,"stretchType",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],Sr.prototype,"useGamma",void 0),Sr=Tr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Sr);const _r=Sr;let Ir=class extends v{constructor(){super(...arguments),this.functionName="Stretch",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const t=this.sourceRasterInfos[0],{pixelType:e}=t,{functionArguments:n}=this,{dynamicRangeAdjustment:r,gamma:o,useGamma:s}=n;if(!r&&["u8","u16","s8","s16"].includes(e)){const r=(0,Ye.DP)(n.toJSON(),{rasterInfo:t}),i=(0,u.zw)(this.outputPixelType)?"round":"float";this.lookup=(0,Ye.RP)({pixelType:e,...r,gamma:s?o:null,rounding:i}),this.cutOffs=r}else r||(this.cutOffs=(0,Ye.DP)(n.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);const i=t.clone();i.pixelType=this.outputPixelType,this._removeStatsHistColormapVAT(i),"u8"===this.outputPixelType&&(i.keyProperties.DataType="processed");const{outputMin:a=0,outputMax:l=255}=this.functionArguments;i.statistics=[];for(let t=0;t<i.bandCount;t++)i.statistics[t]={min:a,max:l};return this.rasterInfo=i,{success:!0,supportsGPU:!r}}_processPixels(t){const e=t.pixelBlocks?.[0];if(null==e)return e;const{lookup:n}=this;if(n)return(0,$t.eH)(e,{...n,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:r}=this,o=this.cutOffs||(0,Ye.DP)(r.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e}),s=r.useGamma?r.gamma:null;return(0,Ye._N)(e,{...o,gamma:s,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const{outputMin:t=0,outputMax:e=255,gamma:n,useGamma:r}=this.functionArguments,o=this.rasterInfo.bandCount>=2?3:1,s=r&&n?.length?(0,Ye.Nh)(o,n):[1,1,1],{minCutOff:i,maxCutOff:a}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===i.length&&(i[1]=i[2]=i[0],a[1]=a[2]=a[0]);const l=new Float32Array(o);let c;for(c=0;c<o;c++)l[c]=(e-t)/(a[c]-i[c]);const h=(0,u.zw)(this.outputPixelType);return{bandCount:o,outMin:t,outMax:e,minCutOff:i,maxCutOff:a,factor:l,useGamma:r,gamma:r&&n?n:[1,1,1],gammaCorrection:r&&s?s:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:h,type:"stretch"}}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Ir.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:_r,json:{write:!0,name:"rasterFunctionArguments"}})],Ir.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Ir.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ir.prototype,"lookup",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],Ir.prototype,"cutOffs",void 0),Ir=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.StretchFunction")],Ir);const Rr=Ir;var Nr;let Fr=Nr=class extends p{constructor(){super(...arguments),this.attributeTableAsRecordSet=null}clone(){return new Nr({attributeTableAsRecordSet:(0,s.o8)(this.attributeTableAsRecordSet)})}};(0,i._)([(0,a.MZ)({json:{write:!0}})],Fr.prototype,"attributeTableAsRecordSet",void 0),Fr=Nr=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.TableFunctionArguments")],Fr);const Er=Fr;let Br=class extends v{constructor(){super(...arguments),this.functionName="Table",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isNoopProcess=!0}_bindSourceRasters(){const t=this.sourceRasterInfos[0];if(t.bandCount>1||t.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const{attributeTableAsRecordSet:e}=this.functionArguments;if(!e)return{success:!1,supportsGPU:!1,error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(t.pixelType);const n=t.clone();return n.pixelType=this.outputPixelType,n.bandCount=1,"thematic"!==n.dataType&&(n.keyProperties=n.keyProperties?{...n.keyProperties,DataType:"thematic"}:{DataType:"thematic"}),this.rasterInfo=n,{success:!0,supportsGPU:!0}}_processPixels(t){return t.pixelBlocks?.[0]}};(0,i._)([(0,a.MZ)({json:{write:!0,name:"rasterFunction"}})],Br.prototype,"functionName",void 0),(0,i._)([(0,a.MZ)({type:Er,json:{write:!0,name:"rasterFunctionArguments"}})],Br.prototype,"functionArguments",void 0),(0,i._)([(0,a.MZ)()],Br.prototype,"rasterArgumentNames",void 0),(0,i._)([(0,a.MZ)()],Br.prototype,"isNoopProcess",void 0),Br=(0,i._)([(0,l.$)("esri.layers.support.rasterFunctions.TableFunction")],Br);const Or=Br,Gr=new Map;function Dr(t,e){const{rasterFunctionArguments:n}=t;n&&(n.rasters||[n.raster,n.raster2]).forEach((t=>{t&&"number"!=typeof t&&("string"==typeof t?t.startsWith("http")&&(e.includes(t)||e.push(t)):"rasterFunctionArguments"in t&&Dr(t,e))}))}function Lr(t,e){if(e=e??{},"function"in(t=(0,s.o8)(t))&&"arguments"in t&&t.arguments){const n=Hr(t,new Map,e);if(qr(n),!n.renderingRule)throw new o.A("raster-function-helper","Unsupported raster function json.");t=n.renderingRule}if("rasterFunction"in t)return zr(t=jr(t),e);throw new o.A("raster-function-helper","unsupported raster function json.")}function Ur(t){return!!(t&&"object"==typeof t&&t.rasterFunction&&t.rasterFunctionArguments)}function jr(t){const{rasterFunction:e,rasterFunctionArguments:n}=t,r={};for(const t in n){let e=n[t];const o=t.toLowerCase();if("rasters"===o&&Array.isArray(e))r.rasters=e.map((t=>Ur(t)?jr(t):t));else switch(Ur(e)&&(e=jr(e)),o){case"dra":r.dra=e;break;case"pspower":r.psPower=e;break;case"pszfactor":r.psZFactor=e;break;case"bandids":r.bandIds=e;break;default:r[t[0].toLowerCase()+t.slice(1)]=e}}return"Local"!==e||r.rasters?.length||(r.rasters=["$$"]),{...t,rasterFunctionArguments:r}}function zr(t,e){const{rasterFunction:n,rasterFunctionArguments:r}=t,s=t.outputPixelType?.toLowerCase();if(null==n||!Gr.has(n))throw new o.A("raster-function-helper",`unsupported raster function: ${n}`);const i=Gr.get(n),a=("function"==typeof i.ctor?i.ctor:i.ctor.default).fromJSON({...t,outputPixelType:s}),{rasterArgumentNames:l}=a,u=[],c=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((e=>t[e]))}(r,l),h="rasters"===l[0]||l.length>1,p=[];for(let t=0;t<c.length;t++){const n=c[t];let r;null==n||"string"==typeof n&&n.startsWith("$")?u.push(e?.raster):"string"==typeof n?e[n]&&u.push(e[n]):"number"!=typeof n&&"rasterFunction"in n&&(r=zr(n,e),h||(a.functionArguments[l[t]]=r),u.push(r)),h&&p.push(r??n)}if(h&&("rasters"===l[0]?a.functionArguments.rasters=p:l.forEach(((t,e)=>{a.functionArguments[t]=p[e]}))),e){a.sourceRasters=u;const t=e.raster?.url;t&&(a.mainPrimaryRasterId=t)}return a}function Zr(t,e){if(t&&e)for(const n in t){const r=t[n];r&&"object"==typeof r&&"type"in r&&("RasterFunctionTemplate"===r.type?Zr(r.arguments,e):"RasterFunctionVariable"===r.type&&null!=e[r.name]&&(r.value=e[r.name]))}}function Vr(t,e){if(!t||"object"!=typeof t)return t;const{value:n}=t;if(!n||"object"!=typeof n)return t.isDataset?"$$":n;if(Array.isArray(n))return 0===n.length?[]:n.map((t=>"object"==typeof t&&"RasterFunctionVariable"===t.type?Vr(t,e):t));if("value"in n&&["number","string","boolean"].includes(typeof n.value))return n.value;if(t.isDataset&&"Scalar"!==n.type)return"$$";if(!("type"in n))return n;let r=n;switch(n.type){case"Scalar":r=n.value;break;case"AlgorithmicColorRamp":r=Wr(n);break;case"MultiPartColorRamp":r={type:"multipart",colorRamps:n.ArrayOfColorRamp.map(Wr)};break;case"ArgumentArray":if(n.elements?.length&&"RasterStatistics"!==n.elements[0].type){const t=[];for(let r=0;r<n.elements.length;r++){const s=n.elements[r],{type:i}=s;if(i)if("RasterFunctionTemplate"===i){const{renderingRule:n}=Hr(s,e);t.push(n),null!=s._object_id&&e.set(s._object_id,n)}else{if("RasterFunctionVariable"!==i)throw new o.A("raster-function-helper","unsupported raster function json.");{const n=Vr(s,e);t.push(n),null!=s._object_id&&e.set(s._object_id,n)}}else t.push(s)}r=t}else r=n.elements}return null!=n._object_id&&e.set(n._object_id,r),r}function Wr(t){const e=t.algorithm??"esriHSVAlgorithm";let{FromColor:n,ToColor:o}=t;if(!Array.isArray(n)){const{r:t,g:e,b:o}=(0,r.$)({h:n.Hue,s:n.Saturation,v:n.Value});n=[t,e,o,n.AlphaValue]}if(!Array.isArray(o)){const{r:t,g:e,b:n}=(0,r.$)({h:o.Hue,s:o.Saturation,v:o.Value});o=[t,e,n,o.AlphaValue]}return{type:"algorithmic",algorithm:e,fromColor:n,toColor:o}}function Hr(t,e,n){n&&Zr(t,n);const r={renderingRule:{},templates:e};return Jr(t,r),r}function Jr(t,e){if(!t||!e.renderingRule)return;const{renderingRule:n,templates:r}=e,{function:o,arguments:s,_object_id:i}=t;if(!o||!s)return;null!=i&&r.set(i,n),n.rasterFunction=o.type.replace("Function",""),n.outputPixelType=o.pixelType;const a={};n.rasterFunctionArguments=a;for(const t in s){if("type"===t||"object_id"===t||"_object_ref_id"===t)continue;const e=s[t];e&&"object"==typeof e&&"type"in e&&("RasterFunctionTemplate"===e.type||"RasterFunctionVariable"===e.type)?("RasterFunctionVariable"===e.type?a[t]=Vr(e,r):(n.rasterFunctionArguments[t]={},Jr(e,{renderingRule:n.rasterFunctionArguments[t],templates:r})),null!=e._object_id&&r.set(e._object_id,a[t])):a[t]=e}switch(a.DEM&&!a.Raster&&(a.Raster=a.DEM,delete a.DEM),n.rasterFunction){case"Stretch":!function(t){t.Statistics?.length&&"object"==typeof t.Statistics&&(t.Statistics=t.Statistics.map((t=>[t.min,t.max,t.mean,t.standardDeviation]))),null!=t.NumberOfStandardDeviation&&(t.NumberOfStandardDeviations=t.NumberOfStandardDeviation,delete t.NumberOfStandardDeviation)}(a);break;case"Colormap":!function(t){"randomcolorramp"===t.ColorRamp?.type?.toLowerCase()&&(delete t.ColorRamp,t.ColormapName="Random"),0===t.ColorSchemeType&&delete t.ColorRamp}(a);break;case"Convolution":!function(t){null!=t.ConvolutionType&&(t.Type=t.ConvolutionType,delete t.ConvolutionType)}(a);break;case"Mask":!function(t){t.NoDataValues?.length&&"string"==typeof t.NoDataValues[0]&&(t.NoDataValues=t.NoDataValues.filter((t=>""!==t)).map((t=>Number(t))))}(a)}}function qr(t){const{renderingRule:e,templates:n}=t;if("object"!=typeof e||!e?.rasterFunctionArguments||!n.size)return;const{rasterFunctionArguments:r}=e;for(const t in r){const e=r[t],s="_object_ref_id"===t?e:e&&"object"==typeof e&&"_object_ref_id"in e?e._object_ref_id:null;if(null==s)e&&"object"==typeof e&&(e.rasterFunctionArguments&&qr({renderingRule:e,templates:n}),Array.isArray(e)&&e.forEach(((t,r)=>{if("object"==typeof t)if(null!=t._object_ref_id){if(!n.has(t._object_ref_id))throw new o.A("raster-function-helper",`unsupported raster function json. _object_ref_id: ${e} does not exist`);const i=n.get(s);i&&"object"==typeof i?Object.assign(t,i):e[r]=i}else qr({renderingRule:t,templates:n})})));else{if(!n.has(s))throw new o.A("raster-function-helper",`unsupported raster function json. _object_ref_id: ${s} does not exist`);const e=n.get(s);"_object_ref_id"!==t?r[t]=e:e&&"object"==typeof e&&Object.assign(r,e)}}}Gr.set("Arithmetic",{desc:"Arithmetic Function",ctor:Bt,rasterArgumentNames:["rasters"]}),Gr.set("Aspect",{desc:"Aspect Function",ctor:jt,rasterArgumentNames:["raster"]}),Gr.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:se,rasterArgumentNames:["raster"]}),Gr.set("Colormap",{desc:"Colormap Function",ctor:Te,rasterArgumentNames:["raster"]}),Gr.set("ColormapToRGB",{desc:"ColormapToRGB Function",ctor:Fe,rasterArgumentNames:["raster"]}),Gr.set("CompositeBand",{desc:"CompositeBand Function",ctor:Le,rasterArgumentNames:["rasters"]}),Gr.set("ComputeChange",{desc:"ComputeChange Function",ctor:Je,rasterArgumentNames:["rasters"]}),Gr.set("Convolution",{desc:"Convolution Function",ctor:un,rasterArgumentNames:["raster"]}),Gr.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:Qe,rasterArgumentNames:["raster"]}),Gr.set("ExtractBand",{desc:"ExtractBand Function",ctor:bn,rasterArgumentNames:["raster"]}),Gr.set("Curvature",{desc:"Curvature Function",ctor:mn,rasterArgumentNames:["raster"]}),Gr.set("Hillshade",{desc:"Hillshade Function",ctor:Nn,rasterArgumentNames:["raster"]}),Gr.set("ShadedRelief",{desc:"ShadedRelief Function",ctor:or,rasterArgumentNames:["raster"]}),Gr.set("Grayscale",{desc:"Grayscale Function",ctor:kn,rasterArgumentNames:["raster"]}),Gr.set("Clip",{desc:"Clip Function",ctor:me,rasterArgumentNames:["raster"]}),Gr.set("Local",{desc:"Local Function",ctor:Gn,rasterArgumentNames:["rasters"]}),Gr.set("Mask",{desc:"Mask Function",ctor:Zn,rasterArgumentNames:["raster"]}),Gr.set("NDVI",{desc:"NDVI Function",ctor:qn,rasterArgumentNames:["raster"]}),Gr.set("Remap",{desc:"Remap Function",ctor:Qn,rasterArgumentNames:["raster"]}),Gr.set("Slope",{desc:"Slope Function",ctor:cr,rasterArgumentNames:["raster"]}),Gr.set("Statistics",{desc:"Focal Statistics Function",ctor:br,rasterArgumentNames:["raster"]}),Gr.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:kr,rasterArgumentNames:["raster"]}),Gr.set("Stretch",{desc:"Stretch Function",ctor:Rr,rasterArgumentNames:["raster"]}),Gr.set("Table",{desc:"Attribute Table Function",ctor:Or,rasterArgumentNames:["raster"]})},80221:function(t,e,n){n.d(e,{DO:function(){return J},FT:function(){return Z},Hh:function(){return T},OM:function(){return H},Ps:function(){return Y},Wo:function(){return S},_I:function(){return N},_l:function(){return U},dK:function(){return tt},eh:function(){return Q},l0:function(){return q},t$:function(){return X},uk:function(){return j},vI:function(){return P},xh:function(){return m}}),n(50917);var r,o,s=n(50659),i=n(39819),a=n(62938),l=n(38305),u=n(46157),c=n(57652),h=n(91484),p=n(44740),f=n(45532),d=n(57165);function m(t,e,n){return!(0,u.canProjectWithoutEngine)(t,e,n)}function g(t,e,n){const r=m(t,e,n);if(r&&!(0,u.isLoaded)())throw new i.A("rasterprojectionhelper-project","projection engine is not loaded");return r}(o=r||(r={}))[o.None=0]="None",o[o.North=1]="North",o[o.South=2]="South",o[o.Both=3]="Both";const y=(t,e,n,r=0)=>{if(1===n[0])return[0,0];let o=1,s=-1,i=1,a=-1;for(let e=0;e<t.length;e+=2)isNaN(t[e])||(o=o>t[e]?t[e]:o,s=s>t[e]?s:t[e],i=i>t[e+1]?t[e+1]:i,a=a>t[e+1]?a:t[e+1]);const{cols:l,rows:u}=e,c=(s-o)/l/n[0],h=(a-i)/u/n[1],p=2*r;let f=0,d=!1,m=[0,0];for(let e=0;e<l-3;e++){for(let n=0;n<u-3;n++){const r=e*u*2+2*n,o=(t[r]+t[r+4]+t[r+4*u]+t[r+4*u+4])/4,s=(t[r+1]+t[r+5]+t[r+4*u+1]+t[r+4*u+5])/4,i=Math.abs((o-t[r+2*u+2])/c),a=Math.abs((s-t[r+2*u+3])/h);if(i+a>f&&(f=i+a,m=[i,a]),p&&f>p){d=!0;break}}if(d)break}return m},x={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},w=32,b=4,v=b,A=new Map,M=new Map,C=500;let k=null;async function T(){k&&(0,u.isLoaded)()||((0,u.isLoaded)()||await(0,u.load)(),k=await n.e(5418).then(n.bind(n,22162)))}function P(t,e,n){return g(t.spatialReference,e),n?(0,u.getTransformation)(e,t.spatialReference,t):(0,u.getTransformation)(t.spatialReference,e,t)}function S(t,e,n,r=null){const o=t.spatialReference;if(!o||!e||o.equals(e))return t;g(o,e,r);const s=n.center,i=new h.default({xmin:s.x-t.x/2,xmax:s.x+t.x/2,ymin:s.y-t.y/2,ymax:s.y+t.y/2,spatialReference:o}),a=(0,u.project)(i,e,r),l=Z(e);return null==a||null!=l&&a.width>=l?_(t,o,e):{x:a.width,y:a.height}}function _(t,e,n){const r=(0,a.GA)(e)/(0,a.GA)(n);return{x:t.x*r,y:t.y*r}}function I(t,e,n){const{spatialReference:r}=n;if(!r||!e||r.equals(e))return t;if(r.isGeographic&&e.isGeographic)return _(t,r,e);if(g(r,e),!k)throw new i.A("raster-projection-helper:project-dataset-resolution","geometry engine is not loaded");let{x:o,y:s}=t;const l=(o+s)/2*(0,a.GA)(r);let c=1;l>30&&(c=30/l,o*=c,s*=c);const h=256,f=o*h/2,d=s*h/2,{x:m,y:y}=n.center,x=[];for(let t=0;t<=h;t++)x.push([m-f,y-d+t*s]);for(let t=1;t<=h;t++)x.push([m-f+t*o,y+d]);for(let t=1;t<=h;t++)x.push([m+f,y+d-t*s]);for(let t=1;t<h;t++)x.push([m+f-t*o,y-d]);x.push(x[0]);const w=new p.A({rings:[x],spatialReference:r}),b=(0,u.project)(w,e);if(!b)return _(t,r,e);const v=b.extent,A=Z(e);if(null==v||null!=A&&v.width>=A)return _(t,r,e);const M=k.planarArea(b),C=o*s*h*h,T=Math.sqrt(M/C)/c,P={x:v.width/c/h,y:v.height/c/h},S={x:o*T,y:s*T},I=P.x*P.y;return Math.abs(I-S.x*S.y)/I<.1?P:S}function R(t,e=.01){return(0,a.GA)(t)?e/(0,a.GA)(t):0}function N(t,e,n=null,r=!0){const o=t.spatialReference;if(o.equals(e))return t;g(o,e,n);const s=(0,u.project)(t,e,n);return r&&s?(F([t],[s],o,e),s):s}function F(t,e,n,r){const o=V(n,!0),s=V(r,!0),i=R(n,C),a=R(r,C);if(i&&null!=o&&null!=s)for(let n=0;n<t.length;n++){const r=e[n];if(!r)continue;const{x:l}=t[n],{x:u}=r;u>=s[1]-a&&Math.abs(l-o[0])<i?r.x-=s[1]-s[0]:u<=s[0]+a&&Math.abs(l-o[1])<i&&(r.x+=s[1]-s[0])}}function E(t){const{inSR:e,outSR:n,datumTransformation:r,preferPE:o}=t;if(e.equals(n)){const{points:e}=D(t,null);return e}if(e.isWebMercator&&n.isWGS84||e.isWGS84&&n.isWebMercator)return function(t){const{cols:e,rows:n,xres:r,yres:o,usePixelCenter:s,inSR:i,outSR:a}=t;let{xmin:l,ymax:c}=t;s&&(l+=r/2,c-=o/2);const h=[],p=[],d=Math.max(e,n);for(let t=0;t<d;t++){const s=l+r*Math.min(e,t),d=c-o*Math.min(n,t),m=(0,u.project)(new f.default({x:s,y:d,spatialReference:i}),a);t<=e&&h.push(m.x),t<=n&&p.push(m.y)}const m=[];for(let t=0;t<e;t++)for(let e=0;e<n;e++)m.push([h[t],p[e]]);return m}(t);if(g(e,n,r)&&o){if(e.isGeographic)return B(t);if(null!=O(e))return B(t)}return function(t){const{points:e}=D(t,null),{inSR:n,outSR:r,datumTransformation:o}=t,s=e.map((t=>new f.default(t[0],t[1],n))),i=(0,u.project)(s,r,o);return o&&F(s,i,n,r),i.map((t=>t?[t.x,t.y]:[NaN,NaN]))}(t)}function B(t){const{inSR:e,outSR:n,datumTransformation:r}=t,o=O(e),{points:s,mask:i}=D(t,o);if(!e.isGeographic){const t=e.wkid?l.P.coordsys(e.wkid):l.P.fromString(e.isGeographic?l.a.PE_TYPE_GEOGCS:l.a.PE_TYPE_PROJCS,e.wkt2||e.wkt);l.g.projToGeog(t,s.length,s)}if(null!=r&&r.steps.length){let t;const e=179.9955;if(n.isGeographic&&(t=s.map((([t])=>t>e?1:t<-e?-1:0))),r.steps.forEach((t=>{const e=t.wkid?l.P.geogtran(t.wkid):l.P.fromString(l.a.PE_TYPE_GEOGTRAN,t.wkt);l.h.geogToGeog(e,s.length,s,null,t.isInverse?l.a.PE_TRANSFORM_2_TO_1:l.a.PE_TRANSFORM_1_TO_2)})),t)for(let n=0;n<s.length;n++){const r=t[n],o=s[n][0],i=o>e?1:o<-e?-1:0;r&&i&&r!==i&&(s[n][0]=r>0?o+360:o-360)}}if(!n.isGeographic){const t=O(n,!0),e=null!=t&&t.isEnvelope?[t.bbox[1],t.bbox[3]]:[-90,90];!function(t,e){const[n,r]=e;for(let e=0;e<t.length;e++){const o=t[e][1];(o<n||o>r)&&(t[e]=[NaN,NaN])}}(s,e);const r=n.wkid?l.P.coordsys(n.wkid):l.P.fromString(n.isGeographic?l.a.PE_TYPE_GEOGCS:l.a.PE_TYPE_PROJCS,n.wkt2||n.wkt);l.g.geogToProj(r,s.length,s)}let a=s;if(i&&s.length!==i.length){a=[];for(let t=0,e=0;t<i.length;t++)i[t]?a.push(s[e++]):a.push([NaN,NaN])}return a}function O(t,e=!1){let n=t.wkid||t.wkt2||t.wkt;if(!n||t.isGeographic)return null;if(n=String(n),A.has(n)){const t=A.get(n);return e?t?.gcs:t?.pcs}const r=t.wkid?l.P.coordsys(t.wkid):l.P.fromString(t.isGeographic?l.a.PE_TYPE_GEOGCS:l.a.PE_TYPE_PROJCS,t.wkt2||t.wkt),o=G(r,R(t,1e-4)),s=G(r,0,!0);return A.set(n,{pcs:o,gcs:s}),e?s:o}function G(t,e=0,n=!1){const r=l.j.generate(t),o=n?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!r||!o?.length)return null;let s=!1,i=o.find((t=>1===t.getInclusive()&&1===t.getKind()));if(!i){if(i=o.find((t=>1===t.getInclusive()&&0===t.getKind())),!i)return null;s=!0}const a=n?0:(2===r.getNorthPoleLocation()?1:0)|(2===r.getSouthPoleLocation()?2:0),u=r.isPannableRectangle(),c=i.getCoord();if(s)return{isEnvelope:s,isPannable:u,vertices:c,coef:null,bbox:[c[0][0]-e,c[0][1]-e,c[1][0]+e,c[1][1]+e],poleLocation:a};let h=0;const p=[];let[f,d]=c[0],[m,g]=c[0];for(let t=0,e=c.length;t<e;t++){h++,h===e&&(h=0);const[n,r]=c[t],[o,s]=c[h];if(s===r)p.push([n,o,r,s,2]);else{const t=(o-n)/(s-r||1e-4),e=n-t*r;r<s?p.push([t,e,r,s,0]):p.push([t,e,s,r,1])}f=f<n?f:n,d=d<r?d:r,m=m>n?m:n,g=g>r?g:r}return{isEnvelope:!1,isPannable:u,vertices:c,coef:p,bbox:[f,d,m,g],poleLocation:a}}function D(t,e){const n=[],{cols:r,rows:o,xres:s,yres:i,usePixelCenter:a}=t;let{xmin:l,ymax:u}=t;if(a&&(l+=s/2,u-=i/2),null==e){for(let t=0;t<r;t++)for(let e=0;e<o;e++)n.push([l+s*t,u-i*e]);return{points:n}}const c=new Uint8Array(r*o);if(e.isEnvelope){const{bbox:[t,a,h,p]}=e;for(let f=0,d=0;f<r;f++){const r=l+s*f,m=e.isPannable||r>=t&&r<=h;for(let t=0;t<o;t++,d++){const e=u-i*t;m&&e>=a&&e<=p&&(n.push([r,e]),c[d]=1)}}return{points:n,mask:c}}const h=e.coef,p=[];for(let t=0;t<o;t++){const e=u-i*t,n=[],r=[];for(let t=0;t<h.length;t++){const[o,s,i,a,l]=h[t];if(e===i&&i===a)n.push(o),n.push(s),r.push(2),r.push(2);else if(e>=i&&e<=a){const t=o*e+s;n.push(t),r.push(l)}}let o=n;if(n.length>2){let t=2===r[0]?0:r[0],e=n[0];o=[];for(let s=1;s<r.length;s++)2===r[s]&&s!==r.length-1||(r[s]!==t&&(o.push(0===t?Math.min(e,n[s-1]):Math.max(e,n[s-1])),t=r[s],e=n[s]),s===r.length-1&&o.push(0===r[s]?Math.min(e,n[s]):Math.max(e,n[s])));o.sort(((t,e)=>t-e))}else n[0]>n[1]&&(o=[n[1],n[0]]);p.push(o)}for(let t=0,e=0;t<r;t++){const r=l+s*t;for(let t=0;t<o;t++,e++){const o=u-i*t,s=p[t];if(2===s.length)r>=s[0]&&r<=s[1]&&(n.push([r,o]),c[e]=1);else if(s.length>2){let t=!1;for(let e=0;e<s.length;e+=2)if(r>=s[e]&&r<=s[e+1]){t=!0;break}t&&(n.push([r,o]),c[e]=1)}}}return{points:n,mask:c}}function L(t,e){const n=Z(t[0].spatialReference);if(t.length<2||null==n)return t[0];if(e=e??R(t[0].spatialReference),1===(t=t.filter((t=>t.width>e))).length)return t[0];let{xmin:r,xmax:o,ymin:s,ymax:i}=t[0];for(let e=1;e<t.length;e++){const r=t[e];o=r.xmax+n*e,s=Math.min(s,r.ymin),i=Math.max(i,r.ymax)}return new h.default({xmin:r,xmax:o,ymin:s,ymax:i,spatialReference:t[0].spatialReference})}function U(t,e,n=null,o=!0){const i=t.spatialReference;if(i.equals(e))return t;const a=H(t),l=Z(i,!0),c=Z(e);if(0===a||null==l||null==c){const s=z(t,e,n,o);if(null==l&&null!=c&&Math.abs(s.width-c)<R(e)&&(0,u.isLoaded)()){const n=O(i);if(null!=n&&n.poleLocation===r.None&&t.width<(n.bbox[2]-n.bbox[0])/2)return function(t,e){const n=Z(e);if(null==n)return null;let{xmin:r,ymin:o,xmax:s,ymax:i}=t;const a=t.spatialReference,l=new p.A({spatialReference:a,rings:[[[r,o],[s,o],[s,i],[r,i],[r,o]]]}),c=(0,u.project)(l,e);if(2!==c.rings.length||!c.rings[0].length||!c.rings[1].length)return null;const{rings:f}=c,d=R(a),m=new h.default({spatialReference:e});for(let t=0;t<2;t++){r=s=f[t][0][0],o=i=f[t][0][1];for(let e=0;e<f[t].length;e++)r=r>f[t][e][0]?f[t][e][0]:r,s=s<f[t][e][0]?f[t][e][0]:s,o=o>f[t][e][1]?f[t][e][1]:o,i=i<f[t][e][1]?f[t][e][1]:i;if(0===t)m.ymin=o,m.ymax=i,m.xmin=r,m.xmax=s;else if(m.ymin=Math.min(m.ymin,o),m.ymax=Math.max(m.ymax,i),Math.abs(s-n/2)<d)m.xmin=r,m.xmax=m.xmax+n;else{if(!(Math.abs(r+n/2)<d))return null;m.xmax=s+n}}return m}(t,e)||s}return s}const f=t.clone().normalize();if(1===f.length&&t.xmax<l&&t.xmax-l/2>R(i)){const{xmin:e,xmax:n}=t;for(let r=0;r<=a;r++){const o=0===r?e:-l/2,s=r===a?n-l*r:l/2;f[r]=new h.default({xmin:o,xmax:s,ymin:t.ymin,ymax:t.ymax,spatialReference:i})}}return L(f.map((t=>z(t,e,n,o))).filter(s.Ru))}function j(t,e,n){if("extent"===t.type){const{xmin:e,ymin:n,xmax:r,ymax:o,spatialReference:s}=t;t=new p.A({rings:[[[e,o],[r,o],[r,n],[e,n],[e,o]]],spatialReference:s})}return t.spatialReference.equals(e)?t:(g(t.spatialReference,e,n),(0,u.project)(t,e,n))}function z(t,e,n=null,r=!0,o=!0){const s=t.spatialReference;if(s.equals(e)||!e)return t;g(s,e,n);const i=(0,u.project)(t,e,n);if(o&&e.isWebMercator&&i&&(i.ymax=Math.min(20037508.342787,i.ymax),i.ymin=Math.max(-20037508.342787,i.ymin),i.ymin>=i.ymax))return null;if(!r||!i)return i;const a=V(s,!0),l=V(e,!0);if(null==a||null==l)return i;const c=R(s,.001),h=R(s,C),p=R(e,.001);if(Math.abs(i.xmin-l[0])<p&&Math.abs(i.xmax-l[1])<p){const r=Math.abs(t.xmin-a[0]),o=Math.abs(a[1]-t.xmax);if(r<c&&o>h){i.xmin=l[0];const r=[];r.push(new f.default(t.xmax,t.ymin,s)),r.push(new f.default(t.xmax,(t.ymin+t.ymax)/2,s)),r.push(new f.default(t.xmax,t.ymax,s));const o=r.map((t=>N(t,e,n))).filter((t=>!isNaN(t?.x))).map((t=>t.x));i.xmax=Math.max.apply(null,o)}if(o<c&&r>h){i.xmax=l[1];const r=[];r.push(new f.default(t.xmin,t.ymin,s)),r.push(new f.default(t.xmin,(t.ymin+t.ymax)/2,s)),r.push(new f.default(t.xmin,t.ymax,s));const o=r.map((t=>N(t,e,n))).filter((t=>!isNaN(t?.x))).map((t=>t.x));i.xmin=Math.min.apply(null,o)}}else{const t=R(e,.001);Math.abs(i.xmin-l[0])<t&&(i.xmin=l[0]),Math.abs(i.xmax-l[1])<t&&(i.xmax=l[1])}return i}function Z(t,e=!1){if(!t)return null;const n=e?20037508.342787:20037508.342788905;return t.isWebMercator?2*n:t.wkid&&t.isGeographic?360:2*x[t.wkid]||null}function V(t,e=!1){if(t.isGeographic)return[-180,180];const n=Z(t,e);return null!=n?[-n/2,n/2]:null}function W(t,e,n,r){let o=(t-e)/n;return o-Math.floor(o)!=0?o=Math.floor(o):r&&(o-=1),o}function H(t,e=!1){const n=Z(t.spatialReference);if(null==n)return 0;const r=e?0:-n/2,o=R(t.spatialReference),s=!e&&Math.abs(t.xmax-n/2)<o?n/2:t.xmax,i=!e&&Math.abs(t.xmin+n/2)<o?-n/2:t.xmin;return W(s,r,n,!0)-W(i,r,n,!1)}function J(t){const e=t.storageInfo.origin.x,n=Z(t.spatialReference,!0);if(null==n)return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const r=n/2,{nativePixelSize:o,storageInfo:s,extent:i}=t,{maximumPyramidLevel:a,blockWidth:l,pyramidScalingFactor:u}=s;let c=o.x;const h=[],p=null!=t.transform&&"gcs-shift"===t.transform.type,f=e+(p?0:r),d=p?n-e:r-e;for(let t=0;t<=a;t++){const t=(i.xmax-e)/c/l,n=t-Math.floor(t)==0?t:Math.ceil(t),r=d/c/l,o=r-Math.floor(r)==0?r:Math.ceil(r),s=Math.floor(f/c/l),a=Math.round(f/c)%l,p=(l-Math.round(d/c)%l)%l;h.push({resolutionX:c,blockWidth:l,datasetColumnCount:n,worldColumnCountFromOrigin:o,leftMargin:a,rightPadding:p,originColumnOffset:s}),c*=u}return{originX:e,halfWorldWidth:r,pyramidsInfo:h,hasGCSSShiftTransform:p}}function q(t){const e=t.isAdaptive&&null==t.spacing;let n=t.spacing||[w,w],r=$(t),o={cols:r.size[0]+1,rows:r.size[1]+1};const s=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2;let i=r.outofBoundPointCount===r.offsets.length/2||e&&s?[0,0]:y(r.offsets,o,n,v);const a=(i[0]+i[1])/2,u=t.projectedExtent.spatialReference,c=t.srcBufferExtent.spatialReference;if(e&&(s||a>v)&&(m(u,c,t.datumTransformation)&&(u.isGeographic||O(u)),n=[b,b],r=$({...t,spacing:n}),o={cols:r.size[0]+1,rows:r.size[1]+1},i=y(r.offsets,o,n,v)),r.error=i,n[0]>1&&(r.coefficients=K(r.offsets,o,s)),t.includeGCSGrid&&!u.isGeographic&&!u.isWebMercator)if(c.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:n};else{const e=O(u);if(null!=e&&!e.isEnvelope){const e=function(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt2||t.wkt);let n;return M.has(e)?n=M.get(e):(n=(t.wkid?l.P.coordsys(t.wkid):l.P.fromString(l.a.PE_TYPE_PROJCS,t.wkt2||t.wkt)).getGeogcs().getCode(),M.set(e,n)),new d.A({wkid:n})}(u),i=U(t.projectedExtent,e),{offsets:a}=$({...t,srcBufferExtent:i,spacing:n}),c=K(a,o,s);r.gcsGrid={offsets:a,coefficients:c,spacing:n}}}return r}function $(t){const{projectedExtent:e,srcBufferExtent:n,pixelSize:r,datumTransformation:o,rasterTransform:s}=t,i=e.spatialReference,a=n.spatialReference,l=g(i,a),{xmin:u,ymin:c,xmax:h,ymax:p}=e,d=Z(a),m=null!=d&&(t.hasWrapAround||"gcs-shift"===s?.type),y=t.spacing||[w,w],x=y[0]*r.x,v=y[1]*r.y,A=1===y[0],M=Math.ceil((h-u)/x-.1/y[0])+(A?0:1),k=Math.ceil((p-c)/v-.1/y[1])+(A?0:1),T=E({cols:M,rows:k,xmin:u,ymax:p,xres:x,yres:v,inSR:i,outSR:a,datumTransformation:o,preferPE:y[0]<=b,usePixelCenter:A}),P=[];let S,_=0;const I=A?-1:NaN,{xmin:N,xmax:F,ymax:B,width:G,height:D}=n,L=R(a,C),U=null!=d&&N>0&&F>d/2;let j=!1;if(l){const t=O(i);j=null!=t&&t.poleLocation>0}for(let t=0;t<M;t++){const e=[];for(let n=0;n<k;n++){let r=T[t*k+n];if(m&&r[0]>F&&r[0]>d/2-L?r[0]-=d:m&&0===t&&r[0]<0&&U&&!s&&(r[0]+=d),!r||isNaN(r[0])||isNaN(r[1]))P.push(I),P.push(I),e.push(null),_++;else{if(s){const t=s.inverseTransform(new f.default({x:r[0],y:r[1],spatialReference:a}));r=[t.x,t.y]}e.push(r),t>0&&m&&S[n]&&r[0]<S[n][0]&&(r[0]+=d,j&&r[0]>F&&r[0]>d&&(r[0]-=d)),P.push((r[0]-N)/G),P.push((B-r[1])/D)}}S=e}return{offsets:P,error:null,coefficients:null,outofBoundPointCount:_,spacing:y,size:A?[M,k]:[M-1,k-1]}}function K(t,e,n){const{cols:r,rows:o}=e,s=new Float32Array((r-1)*(o-1)*2*6),i=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),a=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let e=0;e<r-1;e++){for(let n=0;n<o-1;n++){let l=e*o*2+2*n;const u=t[l],c=t[l+1],h=t[l+2],p=t[l+3];l+=2*o;const f=t[l],d=t[l+1],m=t[l+2],g=t[l+3];let y=0,x=12*(n*(r-1)+e);for(let t=0;t<3;t++)s[x++]=i[y++]*u+i[y++]*h+i[y++]*m;y=0;for(let t=0;t<3;t++)s[x++]=i[y++]*c+i[y++]*p+i[y++]*g;y=0;for(let t=0;t<3;t++)s[x++]=a[y++]*u+a[y++]*f+a[y++]*m;y=0;for(let t=0;t<3;t++)s[x++]=a[y++]*c+a[y++]*d+a[y++]*g}if(n)for(let t=0;t<s.length;t++)isNaN(s[t])&&(s[t]=-1)}return s}function Y(t){const{spatialReference:e}=t,n=(0,c.Vp)(e);if(!n)return t;const[r,o]=n.valid,s=o-r;let i=0;if(t.xmin<r){const e=r-t.xmin;i=Math.ceil(e/s)}else if(t.xmin>o){const e=t.xmin-o;i=-Math.ceil(e/s)}return new h.default({spatialReference:t.spatialReference,xmin:t.xmin+i*s,ymin:t.ymin,xmax:t.xmax+i*s,ymax:t.ymax})}function X(t,e,n){const{storageInfo:r,pixelSize:o}=e;let s=0,i=!1;const{pyramidResolutions:l}=r,u="mixed"===r.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,r.tileInfo.dpi/96)):1,c=(t.x+t.y)/2/u;if(null!=l&&l.length){const t=l[l.length-1],r=(t.x+t.y)/2,u=(o.x+o.y)/2;if(c<=u)s=0;else if(c>=r)s=l.length,i=c/r>8;else{let t,e=u;for(let r=1;r<=l.length;r++){if(t=(l[r-1].x+l[r-1].y)/2,c<=t){c===t?s=r:"down"===n?(s=r-1,i=c/e>8):s="up"===n||c-e>t-c||c/e>2?r:r-1;break}e=t}}const h=0===s?o:l[s-1];return i&&Math.min(h.x,h.y)*(0,a.GA)(e.spatialReference)>19567&&(i=!1),{pyramidLevel:s,pyramidResolution:new f.default({x:h.x,y:h.y,spatialReference:e.spatialReference}),excessiveReading:i}}const h=Math.log(t.x/o.x)/Math.LN2,p=Math.log(t.y/o.y)/Math.LN2,d=e.storageInfo.maximumPyramidLevel||0;s="down"===n?Math.floor(Math.min(h,p)):"up"===n?Math.ceil(Math.max(h,p)):Math.round((h+p)/2),s<0?s=0:s>d&&(i=s>d+3,s=d);const m=2**s;return{pyramidLevel:s,pyramidResolution:new f.default({x:m*e.nativePixelSize.x,y:m*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:i}}function Q(t,e){const{pixelSize:n,extent:r}=t,o=P(r,e,!1);return U(function(t,e){const n=t.clone().normalize();return 1===n.length?n[0]:L(n,e)}(r,(n.x+n.y)/16),e,o)}function tt(t,e,n){const r=n?.tileSize??512,o=n?.alignGlobalDatasetWithAGOL??!0,s=!!n?.limitToSrcResolution,{extent:i,spatialReference:l,pixelSize:u}=t,c=I(u,e,i);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const h=(c.x+c.y)/2,p=(0,a.GA)(e),f=h*p*96*39.37,m=e.isGeographic?256/r*295828763.7958547:256/r*591657527.591555;let g="vector-magdir"===t.dataType||"vector-uv"===t.dataType;const y=Q(t,e),x=Math.min(Math.ceil(Math.log(Math.min(t.width,t.height)/32)/Math.LN2),Math.ceil(Math.log(m/2/f)/Math.LN2));if(!g&&o&&(e.isGeographic||e.isWebMercator)){const n=Z(e);if(g=H(y)>0||null!=n&&y.width>n/4,!g&&null!=n){let e=-1;if(x<3)e=2**x*h*r;else if(t.storageInfo){const{maximumPyramidLevel:n=0,pyramidScalingFactor:o=2}=t.storageInfo;e=o**n*h*r}const o=Math.ceil(n/e);g=1===o||2===o&&n/2-y.xmax<e}}let w,b=f;const v=1.001,A=Math.min(2,Math.max(1.414,t.storageInfo?.pyramidScalingFactor||2));if(g){b=m;const n=e.isGeographic?1341104507446289e-21:.29858214164761665,r=n*(96*p*39.37),o=e.isGeographic?4326:3857;w=I({x:n,y:n},l,Q(t,new d.A({wkid:o}))),w.x*=b/r,w.y*=b/r}else{w={x:u.x,y:u.y};let t=0;for(;b<m*(v/2)&&t<x;)t++,b*=A,w.x*=A,w.y*=A;Math.max(b,m)/Math.min(b,m)<=v&&(b=m)}const M=[b],C=[{x:w.x,y:w.y}],k=Math.min(70.5310735,f)/v;for(;b>=k;)b/=A,w.x/=A,w.y/=A,M.push(b),C.push({x:w.x,y:w.y});if(s){const t=.001*u.x;let e=C.findIndex((e=>e.x>=u.x-t&&e.x<=u.x+t));e>-1?(C.length=e+1,M.length=e+1):(e=C.findIndex((e=>e.x<=u.x+t)),e>0&&(C.length=e,M.length=e))}return{projectedPixelSize:c,scales:M,srcResolutions:C,isCustomTilingScheme:!g}}},72567:function(t,e,n){n.d(e,{DP:function(){return y},Nh:function(){return x},Pg:function(){return g},RP:function(){return c},WF:function(){return u},_N:function(){return w},eH:function(){return d},f4:function(){return m},fP:function(){return p},zj:function(){return h}});var r=n(95929),o=n(21327),s=n(95738),i=n(41259);const a=1,l=[.299,.587,.114];function u(t,e=256){e=Math.min(e,256);const{size:n,counts:r}=t,o=new Uint8Array(n),s=r.reduce(((t,n)=>t+n/e),0);let i=0,a=0,l=0,u=s;for(let t=0;t<n;t++)if(l+=r[t],!(t<n-1&&l+r[t+1]<u)){for(;i<e-1&&u<l;)i++,u+=s;for(let e=a;e<=t;e++)o[e]=i;a=t+1}for(let t=a;t<n;t++)o[t]=e-1;return o}function c(t){const{minCutOff:e,maxCutOff:n,gamma:r,pixelType:o,rounding:s}=t,i=t.outMin||0,a=t.outMax||255;if(!["u8","u16","s8","s16"].includes(o))return null;const l=e.length;let u,c,p=0;"s8"===o?p=-127:"s16"===o&&(p=-32767);let f=256;["u16","s16"].includes(o)&&(f=65536);const d=[],m=[],g=a-i;for(u=0;u<l;u++)m[u]=n[u]-e[u],d[u]=0===m[u]?0:g/m[u];let y;const w=[];let b,v,A;if(r&&r.length>=l){const t=x(l,r);for(u=0;u<l;u++){for(A=[],c=0;c<f;c++)if(0!==m[u])if(b=c+p,y=(b-e[u])/m[u],v=1,r[u]>1&&(v-=(1/g)**(y*t[u])),b<n[u]&&b>e[u]){const t=v*g*y**(1/r[u])+i;A[c]="floor"===s?Math.floor(t):"round"===s?Math.round(t):t}else b>=n[u]?A[c]=a:A[c]=i;else A[c]=i;w[u]=A}}else for(u=0;u<l;u++){for(A=[],c=0;c<f;c++)if(b=c+p,b<=e[u])A[c]=i;else if(b>=n[u])A[c]=a;else{const t=(b-e[u])*d[u]+i;A[c]="floor"===s?Math.floor(t):"round"===s?Math.round(t):t}w[u]=A}if(null!=t.contrastOffset){const e=h(t.contrastOffset,t.brightnessOffset);for(u=0;u<l;u++)for(A=w[u],c=0;c<f;c++)A[c]=e[A[c]]}return{lut:w,offset:p}}function h(t,e){const n=Math.min(Math.max(t,-100),100),r=Math.min(Math.max(e??0,-100),100);let o=0,s=0;const i=new Uint8Array(256);for(o=0;o<256;o++)n>0&&n<100?s=(200*o-25500+510*r)/(2*(100-n))+128:n<=0&&n>-100?s=(200*o-25500+510*r)*(100+n)/2e4+128:100===n?(s=200*o-25500+256*(100-n)+510*r,s=s>0?255:0):-100===n&&(s=128),i[o]=s>255?255:s<0?0:s;return i}function p(t,e,n){const r=[];for(let o=0;o<e.length;o++){let s=0,i=0,a=0;"min"in e[o]?({min:s,max:i,avg:a}=e[o]):[s,i,a]=e[o];let u=a??0;"u8"!==t&&(u=255*(u-s)/(i-s)),n&&(u*=l[o]),r.push(f(u))}return r}function f(t){if(t<=0||t>=255)return a;let e=0;150!==t&&(e=t<=150?45*Math.cos(.01047*t):17*Math.sin(.021*t));const n=t+e,r=Math.log(t/255),o=Math.log(n/255);if(0===o)return a;const s=r/o;return isNaN(s)?a:Math.min(9.9,Math.max(.01,s))}function d(t){const{pixels:e,mask:n,pixelType:r,bandMasks:o}=t,s=e.map(((t,e)=>function(t,e,n){let r=1/0,o=-1/0,s=0,i=0,a=0,l=0;const u=t.length,c=new Map,h=[];for(let n=0;n<u;n++){const u=t[n];if(!e||e[n]){h.push(u);const t=(c.get(u)??0)+1;c.set(u,t),t>l&&(l=t,a=u),r=u<r?u:r,o=u>o?u:o,s+=u,i++}}if(0===i)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};const p=s/i;let f=0;for(let n=0;n<u;n++)e&&!e[n]||(f+=(t[n]-p)**2);const d=e?e.filter((t=>t)).length:u,m=d<=1?0:Math.sqrt(f/(d-1));h.sort(((t,e)=>t-e));const g=i>>>1,y={min:r,max:o,avg:p,stddev:m,mode:a,median:i%2?h[Math.floor(g)]:(h[g-1]+h[g])/2};if(["u8","s8","u4","u2","u1"].includes(n)){const n=o-r+1,s=new Uint32Array(n);for(let n=0;n<u;n++)e&&!e[n]||s[t[n]-r]++;return{statistics:y,histogram:{min:r-.5,max:o+.5,size:n,counts:s}}}const x=256,w=new Uint32Array(x),b=(o-r)/x;if(0===b)return{statistics:y,histogram:{min:r,max:o,size:1,counts:new Uint32Array(1).fill(i)}};const v=new Uint32Array(257);for(let n=0;n<u;n++)e&&!e[n]||v[Math.floor((t[n]-r)/b)]++;for(let t=0;t<255;t++)w[t]=v[t];return w[255]=v[255]+v[x],{statistics:y,histogram:{min:r,max:o,size:x,counts:w}}}(t,o?.[e]??n,r)));return{statistics:s.map((({statistics:t})=>t)),histograms:s.map((({histogram:t})=>t))}}function m(t){if(!t?.pixels?.length)return null;const{pixels:e,mask:n,bandMasks:r,pixelType:o}=t,s=t.width*t.height,i=e.length,a=[],l=[],u=256;let c,h,p,f;for(let d=0;d<i;d++){p=new Uint32Array(u);const i=e[d],m=r?.[d]??n;if("u8"===o){if(c=255,h=0,m){for(let t=0;t<s;t++)if(m[t]){const e=i[t];c=e<c?e:c,h=e>h?e:h,p[e]++}}else for(let t=0;t<s;t++){const e=i[t];c=e<c?e:c,h=e>h?e:h,p[e]++}p=p.slice(c,h+1)}else{let e=!1;t.statistics||(t.updateStatistics(),e=!0);const n=t.statistics;c=n[d].minValue,h=n[d].maxValue;const r=(h-c)/u;if(0===r){!n||t.validPixelCount||e||t.updateStatistics();const r=(t.validPixelCount||t.width*t.height)/u;for(let t=0;t<u;t++)p[t]=Math.round(r*(t+1))-Math.round(r*t)}else{f=new Uint32Array(257);for(let t=0;t<s;t++)m&&!m[t]||f[Math.floor((i[t]-c)/r)]++;for(let t=0;t<255;t++)p[t]=f[t];p[255]=f[255]+f[u]}}const g="u8"===o?c-.5:c,y="u8"===o?h+.5:h;a.push({min:g,max:y,size:p.length,counts:p});let x=0,w=0,b=0;for(let t=0;t<p.length;t++)x+=p[t],w+=t*p[t];const v=w/x;for(let t=0;t<p.length;t++)b+=p[t]*(t-v)**2;const A=Math.sqrt(b/(x-1)),M=(y-g)/p.length,C=(v+("u8"===o?0:.5))*M+c,k=A*M;l.push({min:c,max:h,avg:C,stddev:k})}return{statistics:l,histograms:a}}function g(t){const e=[];for(let n=0;n<t.length;n++){const{min:r,max:o,size:s,counts:i}=t[n];let a=0,l=0;for(let t=0;t<s;t++)a+=i[t],l+=t*i[t];const u=l/a;let c=0;for(let t=0;t<s;t++)c+=i[t]*(t-u)**2;const h=(o-r)/s,p=(u+.5)*h+r,f=Math.sqrt(c/(a-1))*h;e.push({min:r,max:o,avg:p,stddev:f})}return e}function y(t,e){const{pixelBlock:n,bandIds:o,returnHistogramLut:a,rasterInfo:l}=e;let c=null,h=null,p=t.stretchType;if("number"==typeof p&&(p=i.x[p]),t.dra)if("minMax"===p&&n?.statistics)c=n.statistics.map((t=>[t.minValue,t.maxValue,0,0]));else{const t=m(n);c=null!=t?t.statistics:null,h=null!=t?t.histograms:null}else c=t.statistics?.length?t.statistics:l.statistics,h="histograms"in t?t.histograms:void 0,h||(h=l.histograms);"percentClip"!==p&&"histogramEqualization"!==p||h?.length||(p="minMax");const f=c?.length||h?.length||l.bandCount,d=[],g=[];let y,x,w,b,v,A,M,C,k;c&&!Array.isArray(c[0])&&(c=c.map((t=>[t.min,t.max,t.avg,t.stddev])));const[T,P]=(0,s.hP)(l.pixelType);if(!c?.length){for(c=[],C=0;C<f;C++)c.push([T,P,1,1]);"standardDeviation"===p&&(p="minMax")}switch(p){case"none":for(C=0;C<f;C++)d[C]=T,g[C]=P;break;case"minMax":for(C=0;C<f;C++){const t=c[C];d[C]=t[0],g[C]=t[1]}break;case"standardDeviation":{const{numberOfStandardDeviations:e=2}=t;for(C=0;C<f;C++){const t=c[C];d[C]=t[2]-e*t[3],g[C]=t[2]+e*t[3],d[C]<t[0]&&(d[C]=t[0]),g[C]>t[1]&&(g[C]=t[1])}}break;case"histogramEqualization":for((0,r.Lw)(h),C=0;C<f;C++)d[C]=h[C].min,g[C]=h[C].max;break;case"percentClip":for((0,r.Lw)(h),C=0;C<h.length;C++){for(y=h[C],v=new Uint32Array(y.size),b=[...y.counts],b.length>=20&&(b[0]=b[1]=b[2]=b[b.length-1]=b[b.length-2]=0),w=0,x=(y.max-y.min)/y.size,M=-.5===y.min&&1===x?.5:0,k=0;k<y.size;k++)w+=b[k],v[k]=w;for(A=(t.minPercent||0)*w/100,d[C]=y.min+M,k=0;k<y.size;k++)if(v[k]>A){d[C]=y.min+x*(k+M);break}for(A=(1-(t.maxPercent||0)/100)*w,g[C]=y.max+M,k=y.size-2;k>=0;k--)if(v[k]<A){g[C]=y.min+x*(k+2-M);break}if(g[C]<d[C]){const t=d[C];d[C]=g[C],g[C]=t}}break;default:for(C=0;C<f;C++){const t=c[C];d[C]=t[0],g[C]=t[1]}}let S,_,I;return"histogramEqualization"===p?((0,r.Lw)(h),_=h[0].size||256,S=0,a&&(I=h.map((t=>u(t))))):(_=t.max||255,S=t.min||0),function(t,e){if(null==e||0===e.length)return t;const n=Math.max.apply(null,e),{minCutOff:r,maxCutOff:o,outMin:s,outMax:i,histogramLut:a}=t;return r.length===e.length||r.length<=n?t:{minCutOff:e.map((t=>r[t])),maxCutOff:e.map((t=>o[t])),histogramLut:a?e.map((t=>a[t])):null,outMin:s,outMax:i}}({minCutOff:d,maxCutOff:g,outMax:_,outMin:S,histogramLut:I},o)}function x(t,e){const n=new Float32Array(t);for(let r=0;r<t;r++)e[r]>1?e[r]>2?n[r]=6.5+(e[r]-2)**2.5:n[r]=6.5+100*(2-e[r])**4:n[r]=1;return n}function w(t,e){if(!t?.pixels?.length)return t;const{mask:n,bandMasks:r,width:s,height:i,pixels:a}=t,{minCutOff:l,maxCutOff:u,gamma:c}=e,h=e.outMin||0,p=e.outMax||255,f=s*i,d=e.outputPixelType||"u8",m=t.pixels.map((()=>o.A.createEmptyBand(d,f))),g=m.length,y=p-h,w=[],b=[];for(let t=0;t<g;t++)b[t]=u[t]-l[t],w[t]=0===b[t]?0:y/b[t];const v=d.startsWith("u")||d.startsWith("s"),A=c&&c.length>=g,M=!!e.isRenderer;if(A){const t=x(g,c);for(let e=0;e<g;e++){const o=r?.[e]??n;for(let n=0;n<f;n++)if(null==o||o[n]){if(0===b[e]){m[e][n]=h;continue}const r=a[e][n],o=(r-l[e])/b[e];let s=1;if(c[e]>1&&(s-=(1/y)**(o*t[e])),r<u[e]&&r>l[e]){const t=s*y*o**(1/c[e])+h;m[e][n]=M?Math.floor(t):v?Math.round(t):t}else r>=u[e]?m[e][n]=p:m[e][n]=h}}}else for(let t=0;t<g;t++){const e=r?.[t]??n;for(let n=0;n<f;n++)if(null==e||e[n]){const e=a[t][n];if(e<u[t]&&e>l[t]){const r=(e-l[t])*w[t]+h;m[t][n]=M?Math.floor(r):v?Math.round(r):r}else e>=u[t]?m[t][n]=p:m[t][n]=h}}const C=new o.A({width:s,height:i,mask:n,bandMasks:r,pixels:m,pixelType:d});return C.updateStatistics(),C}},55469:function(t,e,n){n.d(e,{E0:function(){return m},PP:function(){return g},SC:function(){return p},di:function(){return d},fw:function(){return h},ng:function(){return l},rk:function(){return a},yy:function(){return f}});var r=n(21327),o=n(42568),s=n(43264);const i=1,a=1/111e3;function l(t){let{altitude:e,azimuth:n}=t;const{hillshadeType:r,pixelSizePower:o=1,pixelSizeFactor:s=1,scalingType:i,isGCS:l,resolution:u}=t,c="multi-directional"===r?2*t.zFactor:t.zFactor,{x:h,y:p}=u;let f=c/(8*h),d=c/(8*p);if(l&&c>.001&&(f/=a,d/=a),"adjusted"===i)if(l){const t=h*a,e=p*a;f=(c+t**o*s)/(8*t),d=(c+e**o*s)/(8*e)}else f=(c+h**o*s)/(8*h),d=(c+p**o*s)/(8*p);let m=(90-e)*Math.PI/180,g=Math.cos(m),y=(360-n+90)*Math.PI/180,x=Math.sin(m)*Math.cos(y),w=Math.sin(m)*Math.sin(y);const b=[315,270,225,360,180,0],v=[60,60,60,60,60,90],A=new Float32Array([3,5,3,2,1,4]),M=A.reduce(((t,e)=>t+e)),C=A.map((t=>t/M)),k="multi-directional"===r?b.length:1,T=new Float32Array(6),P=new Float32Array(6),S=new Float32Array(6);if("multi-directional"===r)for(let t=0;t<k;t++)e=v[t],n=b[t],m=(90-e)*Math.PI/180,g=Math.cos(m),y=(360-n+90)*Math.PI/180,x=Math.sin(m)*Math.cos(y),w=Math.sin(m)*Math.sin(y),T[t]=g,P[t]=x,S[t]=w;else T.fill(g),P.fill(x),S.fill(w);return{resolution:u,factor:[f,d],sinZcosA:x,sinZsinA:w,cosZ:g,sinZcosAs:P,sinZsinAs:S,cosZs:T,weights:C,hillshadeType:["traditional","multi-directional"].indexOf(r)}}function u(t,e){const{width:n,height:r}=t,o=n*r,s=new Uint8Array(o),a=null!=t.mask;let l;if(a){l=new Uint8Array(t.mask);for(let t=0;t<l.length;t++)l[t]&&(s[t]=1,l[t]=1)}const u=t.pixels[0],c=new Float32Array(o),h=new Float32Array(o);let p,f=0;if(e){const{resolution:t}=e,n=t?(t.x+t.y)/2:1;f=200*e.zFactor/(n*n),p=new Float32Array(o)}const d=e?.curvatureType;let m,g,y,x,w,b,v,A;for(let t=i;t<r-i;t++){const e=t*n;for(let t=i;t<n-i;t++){const r=e+t;if(!l||0!==l[r]){if(l){if(l[r-n-1]+l[r-n]+l[r-n+1]+l[r-1]+l[r+1]+l[r+n-1]+l[r+n]+l[r+n+1]<7){s[r]=0;continue}m=l[r-n-1]?u[r-n-1]:u[r],g=l[r-n]?u[r-n]:u[r],y=l[r-n+1]?u[r-n+1]:u[r],x=l[r-1]?u[r-1]:u[r],w=l[r+1]?u[r+1]:u[r],b=l[r+n-1]?u[r+n-1]:u[r],v=l[r+n]?u[r+n]:u[r],A=l[r+n+1]?u[r+n+1]:u[r]}else m=u[r-n-1],g=u[r-n],y=u[r-n+1],x=u[r-1],w=u[r+1],b=u[r+n-1],v=u[r+n],A=u[r+n+1];if(c[r]=y+w+w+A-(m+x+x+b),h[r]=b+v+v+A-(m+g+g+y),null!=p){const t=u[r],e=.5*(x+w)-t,n=.5*(g+v)-t;if("standard"===d)p[r]=-f*(e+n);else{const t=(-m+y+b-A)/4,o=(-x+w)/2,s=(g-v)/2,i=o*o,a=s*s,l=i+a;l&&(p[r]="profile"===d?f*(e*i+n*a+t*o*s)/l:-f*(e*a+n*i-t*o*s)/l)}}}}}return{outMask:a?s:null,dzxs:c,dzys:h,curvatures:p}}function c(t,e,n){for(let r=0;r<n;r++)t[r*e]=t[r*e+1],t[(r+1)*e-1]=t[(r+1)*e-2];for(let r=1;r<e-1;r++)t[r]=t[r+e],t[r+(n-1)*e]=t[r+(n-2)*e]}function h(t,e){if(!(0,s.AB)(t))return t;const{factor:n,sinZcosA:a,sinZsinA:h,cosZ:p,sinZcosAs:f,sinZsinAs:d,cosZs:m,weights:g}=l(e),[y,x]=n,w="traditional"===e.hillshadeType,{width:b,height:v}=t,A=new Uint8Array(b*v),{dzxs:M,dzys:C,outMask:k}=u(t);for(let t=i;t<v-i;t++){const e=t*b;for(let t=i;t<b-i;t++){const n=e+t;if(!k||k[n]){const t=M[n]*y,e=C[n]*x,r=Math.sqrt(1+t*t+e*e);let o=0;if(w){let n=255*(p+h*e-a*t)/r;n<0&&(n=0),o=n}else{const n=d.length;for(let s=0;s<n;s++){let n=255*(m[s]+d[s]*e-f[s]*t)/r;n<0&&(n=0),o+=n*g[s]}}A[n]=255&o}}}return c(A,b,v),new r.A({width:b,height:v,pixels:[A],mask:k,pixelType:"u8",validPixelCount:t.validPixelCount,statistics:[new o.z(0,255)]})}function p(t,e,n,r){if(!(0,s.AB)(t)||!(0,s.AB)(e))return;const{min:o,max:i}=r,a=t.pixels[0],{pixels:l,mask:u}=e,c=l[0],h=255.00001/(i-o),p=new Uint8ClampedArray(c.length),f=new Uint8ClampedArray(c.length),d=new Uint8ClampedArray(c.length),m=n.length-1;for(let t=0;t<c.length;t++){if(u&&0===u[t])continue;const e=Math.floor((c[t]-o)*h),[r,s]=n[e<0?0:e>m?m:e],i=a[t],l=i*s,g=l*(1-Math.abs(r%2-1)),y=i-l;switch(Math.floor(r)){case 0:p[t]=l+y,f[t]=g+y,d[t]=y;break;case 1:p[t]=g+y,f[t]=l+y,d[t]=y;break;case 2:p[t]=y,f[t]=l+y,d[t]=g+y;break;case 3:p[t]=y,f[t]=g+y,d[t]=l+y;break;case 4:p[t]=g+y,f[t]=y,d[t]=l+y;break;case 5:case 6:p[t]=l+y,f[t]=y,d[t]=g+y}}t.pixels=[p,f,d],t.updateStatistics()}function f(t,e){if(!(0,s.AB)(t))return t;const n=e.zFactor,o=e.pixelSizePower??1,l=e.pixelSizeFactor??1,h=e.slopeType,p=e.isGCS,{x:f,y:d}=e.resolution;let m=n/(8*f),g=n/(8*d);p&&Math.abs(n-1)<1e-4&&(m/=a,g/=a),"adjusted"===h&&(m=(n+f**o*l)/(8*f),g=(n+d**o*l)/(8*d));const{dzxs:y,dzys:x,outMask:w}=u(t),{width:b,height:v}=t,A=new Float32Array(b*v);for(let t=i;t<v-i;t++){const e=t*b;for(let t=i;t<b-i;t++){const n=e+t;if(!w||w[n]){const r=y[n]*m,o=x[n]*g,s=Math.sqrt(r*r+o*o);A[e+t]="percent-rise"===h?100*s:57.2957795*Math.atan(s)}}}c(A,b,v);const M=new r.A({width:b,height:v,pixels:[A],mask:w,pixelType:"f32",validPixelCount:t.validPixelCount});return M.updateStatistics(),M}function d(t,e={}){if(!(0,s.AB)(t))return t;const{resolution:n}=e,a=n?1/n.x:1,l=n?1/n.y:1,{dzxs:h,dzys:p,outMask:f}=u(t),{width:d,height:m}=t,g=new Float32Array(d*m);for(let t=i;t<m-i;t++){const e=t*d;for(let t=i;t<d-i;t++){const n=e+t;if(!f||f[n]){const r=h[n]*a,o=p[n]*l;let s=-1;0===r&&0===o||(s=90-57.29578*Math.atan2(o,-r),s<0&&(s+=360),360===s?s=0:s>360&&(s%=360)),g[e+t]=s}}}return c(g,d,m),new r.A({width:d,height:m,pixels:[g],mask:f,pixelType:"f32",validPixelCount:t.validPixelCount,statistics:[new o.z(-1,360)]})}function m(t,e){if(!(0,s.AB)(t))return t;const{curvatures:n,outMask:o}=u(t,e),{width:i,height:a}=t;c(n,i,a);const l=new r.A({width:i,height:a,pixels:[n],mask:o,pixelType:"f32",validPixelCount:t.validPixelCount});return l.updateStatistics(),l}function g(t,e,n){const{hillshadeType:r,altitude:o,azimuth:s,zFactor:i,pixelSizeFactor:a,pixelSizePower:l,slopeType:u}=t;return{hillshadeType:r,altitude:o,azimuth:s,zFactor:i,pixelSizePower:l,pixelSizeFactor:a,scalingType:"scaled"===u?"adjusted":"none",resolution:e,isGCS:n}}},53611:function(t,e,n){n.d(e,{$Q:function(){return y},FI:function(){return m},KL:function(){return c},Lu:function(){return p},MD:function(){return u},Rn:function(){return g},Ud:function(){return S},Wu:function(){return I},Y2:function(){return d},gf:function(){return _}});var r=n(73037),o=n(21327),s=n(43264);const i=new Map;i.set("meter-per-second",1),i.set("kilometer-per-hour",.277778),i.set("knots",.514444),i.set("feet-per-second",.3048),i.set("mile-per-hour",.44704);const a=180/Math.PI,l=5,u=new r.J({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function c(t,e){return i.get(t)/i.get(e)||1}function h(t){return(450-t)%360}function p(t,e="geographic"){const[n,r]=t,o=Math.sqrt(n*n+r*r);let s=Math.atan2(r,n)*a;return s=(360+s)%360,"geographic"===e&&(s=h(s)),[o,s]}function f(t,e="geographic"){let n=t[1];"geographic"===e&&(n=h(n)),n%=360;const r=t[0];return[r*Math.cos(n/a),r*Math.sin(n/a)]}function d(t,e,n,r="geographic"){if(!(0,s.AB)(t)||null==n)return t;const o="vector-magdir"===e?t.clone():m(t,e),i=o.pixels[1];for(let t=0;t<i.length;t++)i[t]="geographic"===r?(i[t]+n[t]+270)%360:(i[t]+360-n[t])%360;return"vector-magdir"===e?o:m(o,"vector-magdir")}function m(t,e,n="geographic",r=1){if(!(0,s.AB)(t))return t;const{pixels:i,width:a,height:l}=t,u=a*l,c=i[0],h=i[1],d=t.pixelType.startsWith("f")?t.pixelType:"f32",m=o.A.createEmptyBand(d,u),g=o.A.createEmptyBand(d,u);let y=0;for(let t=0;t<l;t++)for(let t=0;t<a;t++)"vector-uv"===e?([m[y],g[y]]=p([c[y],h[y]],n),m[y]*=r):([m[y],g[y]]=f([c[y],h[y]],n),m[y]*=r,g[y]*=r),y++;const x=new o.A({pixelType:d,width:t.width,height:t.height,mask:t.mask,validPixelCount:t.validPixelCount,maskIsAlpha:t.maskIsAlpha,pixels:[m,g]});return x.updateStatistics(),x}function g(t,e,n=1){if(1===n||!(0,s.AB)(t))return t;const r=t.clone(),{pixels:o,width:i,height:a}=r,l=o[0],u=o[1];let c=0;for(let t=0;t<a;t++)for(let t=0;t<i;t++)"vector-uv"===e?(l[c]*=n,u[c]*=n):l[c]*=n,c++;return r.updateStatistics(),r}function y(t,e,n,r,o){if(null==o||!o.spatialReference.equals(t.spatialReference))return{extent:t,width:Math.round(e/r),height:Math.round(n/r),resolution:t.width/e};const s=o.xmin,i=o.ymax,a=(t.xmax-t.xmin)/e*r,l=(t.ymax-t.ymin)/n*r,u=(a+l)/2;return t.xmin=s+Math.floor((t.xmin-s)/a)*a,t.xmax=s+Math.ceil((t.xmax-s)/a)*a,t.ymin=i+Math.floor((t.ymin-i)/l)*l,t.ymax=i+Math.ceil((t.ymax-i)/l)*l,{extent:t,width:Math.round(t.width/a),height:Math.round(t.height/l),resolution:u}}const x=w(0,0,0);function w(t=0,e=0,n=Math.PI,r=!0){r&&(n=(2*Math.PI-n)%(2*Math.PI));const o=r?-1:1,s=13*o,i=-7*o,a=-2*o,l=-16*o,u=21.75,[c,h]=v(0,e+s,n,u),[p,f]=v(t-5.5,e+i,n,u),[d,m]=v(t+5.5,e+i,n,u),[g,y]=v(t-1.5,e+a,n,u),[x,w]=v(t+1.5,e+a,n,u),[b,A]=v(t-1.5,e+l,n,u),[M,C]=v(t+1.5,e+l,n,u);return[c,h,p,f,g,y,x,w,d,m,b,A,M,C]}function b(t=0,e=Math.PI,n=!0){n&&(e=(2*Math.PI-e)%(2*Math.PI));const r=n?-1:1,o=5*r,s=20*r,i=25*r,a=45,u=2*r,c=n?1:-1,h=5*c;let[p,f]=[0+h,0-s],[d,m]=[p+2*c,f],[g,y]=[d-0*c,m+u],[x,w]=[0-h,0-i],[b,A]=[x+0*c,w-u],M=Math.ceil(t/l),C=Math.floor(M/10);M-=8*C;const k=[],T=[];for(let t=0;t<M/2;t++,C--){C<=0&&M%2==1&&t===(M-1)/2&&(x=0,b=x+0*c,w=(w+f)/2,A=w-u);const[n,r]=v(x,w,e,a);if(C>0){const[t,o]=v(d,w,e,a),[s,i]=v(p,f,e,a);k.push(t),k.push(o),k.push(n),k.push(r),k.push(s),k.push(i)}else{const[t,o]=v(d,m,e,a),[s,i]=v(g,y,e,a),[l,u]=v(b,A,e,a);T.push(n),T.push(r),T.push(l),T.push(u),T.push(s),T.push(i),T.push(t),T.push(o)}w+=o,f+=o,m+=o,y+=o,A+=o}const[P,S]=v(0+h,0+s,e,a),_=7*c,[I,R]=v(0+_,0+s,e,a),[N,F]=v(0+h,0-i,e,a),[E,B]=v(0+_,0-i,e,a);return{pennants:k,barbs:T,shaft:[P,S,I,R,N,F,E,B]}}function v(t,e,n,r=1){const o=Math.sqrt(t*t+e*e)/r,s=(2*Math.PI+Math.atan2(e,t))%(2*Math.PI);return[o,(2*Math.PI+s-n)%(2*Math.PI)]}const A=[0,1,3,6,10,16,21,27,33,40,47,55,63],M=[0,.5,1,1.5,2],C=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function k(t,e,n,r){const o=c(r||"knots",n);let s;for(s=1;s<e.length;s++)if(s===e.length-1){if(t<e[s]*o)break}else if(t<=e[s]*o)break;return Math.min(s-1,e.length-2)}function T(t,e,n,r,o){let s=0;switch(e){case"beaufort_kn":s=k(t,A,"knots",n);break;case"beaufort_km":s=k(t,A,"kilometer-per-hour",n);break;case"beaufort_ft":s=k(t,A,"feet-per-second",n);break;case"beaufort_m":s=k(t,A,"meter-per-second",n);break;case"classified_arrow":s=k(t,o??[],r,n);break;case"ocean_current_m":s=k(t,M,"meter-per-second",n);break;case"ocean_current_kn":s=k(t,C,"knots",n)}return s}const P=[];function S(t,e){let n=0,r=0;const{width:o,height:s,mask:i}=t,a=t.pixels[0],h=[],p=[],f=c(u.fromJSON(e.inputUnit),"knots"),d="wind_speed"===e.style?l:Number.MAX_VALUE;for(let t=0;t<s;t++)for(let e=0;e<o;e++){const l=a[t*o+e]*f;if((!i||i[t*o+e])&&l<d){for(let r=0;r<4;r++)h[n++]=(e+.5)/o,h[n++]=(t+.5)/s,h[n++]=r<2?-.5:.5,h[n++]=r%2==0?-.5:.5,h[n++]=0,h[n++]=l;const i=4*(n/24-1);p[r++]=i,p[r++]=i+1,p[r++]=i+2,p[r++]=i+1,p[r++]=i+2,p[r++]=i+3}}return{vertexData:new Float32Array(h),indexData:new Uint32Array(p)}}function _(t,e){return"simple_scalar"===e.style?S(t,e):"wind_speed"===e.style?function(t,e){if(0===P.length)for(let t=0;t<30;t++)P.push(b(5*t,0,!e.invertDirection));const n=c(u.fromJSON(e.inputUnit),"knots"),{width:r,height:o,mask:s}=t,i=t.pixels[0],a=t.pixels[1],h=[],p=[];let f=0,d=0;for(let t=0;t<o;t++)for(let e=0;e<r;e++){const u=t*r+e,c=i[u]*n;if((!s||s[t*r+e])&&c>=l){const n=(a[u]+360)%360/180*Math.PI,{pennants:s,barbs:i,shaft:l}=P[Math.min(Math.floor(c/5),29)];if(s.length+i.length===0)continue;let m=h.length/6;const g=(e+.5)/r,y=(t+.5)/o;for(let t=0;t<s.length;t+=2)h[f++]=g,h[f++]=y,h[f++]=s[t],h[f++]=s[t+1]+n,h[f++]=0,h[f++]=c;for(let t=0;t<i.length;t+=2)h[f++]=g,h[f++]=y,h[f++]=i[t],h[f++]=i[t+1]+n,h[f++]=0,h[f++]=c;for(let t=0;t<l.length;t+=2)h[f++]=g,h[f++]=y,h[f++]=l[t],h[f++]=l[t+1]+n,h[f++]=0,h[f++]=c;for(let t=0;t<s.length/6;t++)p[d++]=m,p[d++]=m+1,p[d++]=m+2,m+=3;for(let t=0;t<i.length/8;t++)p[d++]=m,p[d++]=m+1,p[d++]=m+2,p[d++]=m+1,p[d++]=m+2,p[d++]=m+3,m+=4;p[d++]=m+0,p[d++]=m+1,p[d++]=m+2,p[d++]=m+1,p[d++]=m+3,p[d++]=m+2,m+=4}}return{vertexData:new Float32Array(h),indexData:new Uint32Array(p)}}(t,e):function(t,e){const{style:n,inputUnit:r,outputUnit:o,breakValues:s}=e,i=u.fromJSON(r),a=u.fromJSON(o);let l=0,c=0;const{width:h,height:p,mask:f}=t,d=t.pixels[0],m=t.pixels[1],g=null!=f?f.filter((t=>t>0)).length:h*p,y=new Float32Array(42*g),b=new Uint32Array(15*g),v=e.invertDirection?w(0,0,0,!1):x;for(let t=0;t<p;t++)for(let e=0;e<h;e++){const r=t*h+e;if(!f||f[t*h+e]){const o=(m[r]+360)%360/180*Math.PI,u=T(d[r],n,i,a,s);for(let n=0;n<v.length;n+=2)y[l++]=(e+.5)/h,y[l++]=(t+.5)/p,y[l++]=v[n],y[l++]=v[n+1]+o,y[l++]=u,y[l++]=d[r];const f=7*(l/42-1);b[c++]=f,b[c++]=f+1,b[c++]=f+2,b[c++]=f+0,b[c++]=f+4,b[c++]=f+3,b[c++]=f+0,b[c++]=f+2,b[c++]=f+3,b[c++]=f+2,b[c++]=f+5,b[c++]=f+3,b[c++]=f+5,b[c++]=f+6,b[c++]=f+3}}return{vertexData:y,indexData:b}}(t,e)}function I(t,e,n,r=[0,0],s=.5){const{width:i,height:a,mask:l}=t,[u,c]=t.pixels,[h,d]=r,m=Math.round((i-h)/n),g=Math.round((a-d)/n),y=m*g,x=new Float32Array(y),w=new Float32Array(y),b=new Uint8Array(y),v="vector-uv"===e;for(let t=0;t<g;t++)for(let e=0;e<m;e++){let r=0;const o=t*m+e,g=Math.max(0,t*n+d),y=Math.max(0,e*n+h),A=Math.min(a,g+n),M=Math.min(i,y+n);for(let t=g;t<A;t++)for(let e=y;e<M;e++){const n=t*i+e;if(!l||l[n]){r++;const t=v?[u[n],c[n]]:[u[n],(360+c[n])%360],[e,s]=v?t:f(t);x[o]+=e,w[o]+=s}}if(r>=(A-g)*(M-y)*(1-s)){b[o]=1;const[t,e]=p([x[o]/r,w[o]/r]);x[o]=t,w[o]=e}else b[o]=0,x[o]=0,w[o]=0}const A=new o.A({width:m,height:g,pixels:[x,w],mask:b});return A.updateStatistics(),A}},52477:function(t,e,n){n.d(e,{A:function(){return l}});var r=n(53804),o=n(30905),s=n(23502),i=(n(58941),n(40633),n(13798),n(65953));let a=class extends o.oY{get affectsPixelSize(){return!1}forwardTransform(t){return t}inverseTransform(t){return t}};(0,r._)([(0,s.MZ)()],a.prototype,"affectsPixelSize",null),(0,r._)([(0,s.MZ)({json:{write:!0}})],a.prototype,"spatialReference",void 0),a=(0,r._)([(0,i.$)("esri.layers.support.rasterTransforms.BaseRasterTransform")],a);const l=a},62710:function(t,e,n){n.d(e,{A:function(){return c}});var r,o=n(53804),s=n(23502),i=(n(58941),n(40633),n(13798),n(74376)),a=n(65953),l=n(52477);let u=r=class extends l.A{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}inverseTransform(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}clone(){return new r({tolerance:this.tolerance})}};(0,o._)([(0,i.e)({GCSShiftXform:"gcs-shift"})],u.prototype,"type",void 0),(0,o._)([(0,s.MZ)()],u.prototype,"tolerance",void 0),u=r=(0,o._)([(0,a.$)("esri.layers.support.rasterTransforms.GCSShiftTransform")],u);const c=u},85307:function(t,e,n){n.d(e,{A:function(){return g}});var r,o=n(53804),s=(n(50917),n(23502)),i=(n(58941),n(40633),n(13798),n(74376)),a=n(47332),l=n(65953),u=n(81392),c=n(52477),h=n(45532),p=n(91484);function f(t,e,n){const{x:r,y:o}=e;if(n<2)return{x:t[0]+r*t[2]+o*t[4],y:t[1]+r*t[3]+o*t[5]};if(2===n){const e=r*r,n=o*o,s=r*o;return{x:t[0]+r*t[2]+o*t[4]+e*t[6]+s*t[8]+n*t[10],y:t[1]+r*t[3]+o*t[5]+e*t[7]+s*t[9]+n*t[11]}}const s=r*r,i=o*o,a=r*o,l=s*r,u=s*o,c=r*i,h=o*i;return{x:t[0]+r*t[2]+o*t[4]+s*t[6]+a*t[8]+i*t[10]+l*t[12]+u*t[14]+c*t[16]+h*t[18],y:t[1]+r*t[3]+o*t[5]+s*t[7]+a*t[9]+i*t[11]+l*t[13]+u*t[15]+c*t[17]+h*t[19]}}function d(t,e,n){const{xmin:r,ymin:o,xmax:s,ymax:i,spatialReference:a}=e;let l=[];if(n<2)l.push({x:r,y:i}),l.push({x:s,y:i}),l.push({x:r,y:o}),l.push({x:s,y:o});else{let t=10;for(let e=0;e<t;e++)l.push({x:r,y:o+(i-o)*e/(t-1)}),l.push({x:s,y:o+(i-o)*e/(t-1)});t=8;for(let e=1;e<=t;e++)l.push({x:r+(s-r)*e/t,y:o}),l.push({x:r+(s-r)*e/t,y:i})}l=l.map((e=>f(t,e,n)));const u=l.map((t=>t.x)),c=l.map((t=>t.y));return new p.default({xmin:Math.min.apply(null,u),xmax:Math.max.apply(null,u),ymin:Math.min.apply(null,c),ymax:Math.max.apply(null,c),spatialReference:a})}let m=r=class extends c.A{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(t,e){const{coeffX:n,coeffY:r}=e;if(!n?.length||!r?.length||n.length!==r.length)return null;const o=[];for(let t=0;t<n.length;t++)o.push(n[t]),o.push(r[t]);return o}writeForwardCoefficients(t,e,n){const r=[],o=[];for(let e=0;e<t?.length;e++)e%2==0?r.push(t[e]):o.push(t[e]);e.coeffX=r,e.coeffY=o}get inverseCoefficients(){let t=this._get("inverseCoefficients");const e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){const[e,n,r,o,s,i]=t,a=r*i-s*o,l=s*o-r*i;return[(s*n-e*i)/a,(r*n-e*o)/l,i/a,o/l,-s/a,-r/l]}(e)),t}set inverseCoefficients(t){this._set("inverseCoefficients",t)}readInverseCoefficients(t,e){const{inverseCoeffX:n,inverseCoeffY:r}=e;if(!n?.length||!r?.length||n.length!==r.length)return null;const o=[];for(let t=0;t<n.length;t++)o.push(n[t]),o.push(r[t]);return o}writeInverseCoefficients(t,e,n){const r=[],o=[];for(let e=0;e<t?.length;e++)e%2==0?r.push(t[e]):o.push(t[e]);e.inverseCoeffX=r,e.inverseCoeffY=o}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(t){if("point"===t.type){const e=f(this.forwardCoefficients,t,this.polynomialOrder);return new h.default({x:e.x,y:e.y,spatialReference:t.spatialReference})}return d(this.forwardCoefficients,t,this.polynomialOrder)}inverseTransform(t){if("point"===t.type){const e=f(this.inverseCoefficients,t,this.polynomialOrder);return new h.default({x:e.x,y:e.y,spatialReference:t.spatialReference})}return d(this.inverseCoefficients,t,this.polynomialOrder)}clone(){return new r({polynomialOrder:this.polynomialOrder,forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};(0,o._)([(0,s.MZ)({json:{write:!0}})],m.prototype,"polynomialOrder",void 0),(0,o._)([(0,s.MZ)()],m.prototype,"forwardCoefficients",void 0),(0,o._)([(0,a.w)("forwardCoefficients",["coeffX","coeffY"])],m.prototype,"readForwardCoefficients",null),(0,o._)([(0,u.K)("forwardCoefficients")],m.prototype,"writeForwardCoefficients",null),(0,o._)([(0,s.MZ)({json:{write:!0}})],m.prototype,"inverseCoefficients",null),(0,o._)([(0,a.w)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],m.prototype,"readInverseCoefficients",null),(0,o._)([(0,u.K)("inverseCoefficients")],m.prototype,"writeInverseCoefficients",null),(0,o._)([(0,s.MZ)()],m.prototype,"affectsPixelSize",null),(0,o._)([(0,i.e)({PolynomialXform:"polynomial"})],m.prototype,"type",void 0),m=r=(0,o._)([(0,l.$)("esri.layers.support.rasterTransforms.PolynomialTransform")],m);const g=m},31233:function(t,e,n){n.d(e,{A:function(){return m}});var r=n(53804),o=n(30905),s=n(40633),i=n(23502),a=(n(58941),n(13798),n(65953)),l=n(98521),u=n(43264),c=n(72567),h=n(55469),p=n(3212),f=n(9059);let d=class extends o.oY{constructor(t){super(t)}bind(){const{rendererJSON:t}=this;if(!t)return{success:!1};let e;switch(this.lookup={rendererJSON:{}},t.type){case"uniqueValue":e=this._updateUVRenderer(t);break;case"rasterColormap":e=this._updateColormapRenderer(t);break;case"rasterStretch":e=this._updateStretchRenderer(t);break;case"classBreaks":e=this._updateClassBreaksRenderer(t);break;case"rasterShadedRelief":e=this._updateShadedReliefRenderer(t);break;case"vectorField":e=this._updateVectorFieldRenderer();break;case"flowRenderer":e=this._updateFlowRenderer()}return e}symbolize(t){let e=t?.pixelBlock;if(!g(e))return e;if(t.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(e,t.simpleStretchParams);try{let n;switch(e.pixels.length>3&&(e=e.extractBands(t.bandIds??[0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":n=this._symbolizeColormap(e);break;case"classBreaks":n=this._symbolizeClassBreaks(e);break;case"rasterStretch":n=this._symbolizeStretch(e,t.bandIds);break;case"rasterShadedRelief":{const r=t.extent,o=r.spatialReference.isGeographic,s={x:(r.xmax-r.xmin)/e.width,y:(r.ymax-r.ymin)/e.height};n=this._symbolizeShadedRelief(e,{isGCS:o,resolution:s});break}}return n}catch(t){return s.A.getLogger(this).error("symbolize",t.message),e}}simpleStretch(t,e){if(!g(t))return t;try{return t.pixels.length>3&&(t=t.extractBands([0,1,2])),(0,c._N)(t,{...e,isRenderer:!0})}catch(e){return s.A.getLogger(this).error("symbolize",e.message),t}}generateWebGLParameters(t){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const{indexedColormap:t,offset:e}=this.lookup.colormapLut||{};return{colormap:t,colormapOffset:e,isClassBreaks:"classBreaks"===this.rendererJSON.type,type:"lut"}}const{pixelBlock:e,isGCS:n,resolution:r,bandIds:o}=t,{rendererJSON:s}=this;return"rasterStretch"===s.type?this._generateStretchWebGLParams(e,s,o):"rasterShadedRelief"===s.type?this._generateShadedReliefWebGLParams(s,n,r??void 0):"vectorField"===s.type?this._generateVectorFieldWebGLParams(s):null}_isLUTChanged(t){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const e=this.rendererJSON.colorRamp;return t?JSON.stringify(e)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(t){return this._isLUTChanged()&&!this.bind().success?t:(0,u.qL)(t,this.lookup.colormapLut)}_symbolizeClassBreaks(t){const{canUseIndexedLUT:e}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?t:e?(0,u.qL)(t,this.lookup.colormapLut):(0,u.Hx)(t,this.lookup.remapLut??[])}_symbolizeStretch(t,e){const{rasterInfo:n}=this,{pixelType:r,bandCount:o}=n,s=this.rendererJSON,i=["u8","u16","s8","s16"].includes(r);let a,l;const{dra:h}=s,{gamma:p}=this.lookup;if("histogramEqualization"===s.stretchType){const r=h?null:this.lookup?.histogramLut,o=(0,c.DP)(s,{rasterInfo:n,pixelBlock:t,bandIds:e,returnHistogramLut:!r}),i=(0,c._N)(t,{...o,gamma:p,isRenderer:!0});l=(0,u.eH)(i,{lut:h?o.histogramLut:r,offset:0})}else if(i){if(h){const o=(0,c.DP)(s,{rasterInfo:n,pixelBlock:t,bandIds:e});a=(0,c.RP)({pixelType:r,...o,gamma:p,rounding:"floor"})}else if(this._isLUTChanged()){if(!this.bind().success)return t;a=this.lookup?this.lookup.stretchLut:null}else a=this.lookup?this.lookup.stretchLut:null;if(!a)return t;o>1&&null!=e&&e.length===t?.pixels.length&&a?.lut.length===o&&(a={lut:e.map((t=>a.lut[t])),offset:a.offset}),l=(0,u.eH)(t,a)}else{const r=(0,c.DP)(s,{rasterInfo:n,pixelBlock:t,bandIds:e});l=(0,c._N)(t,{...r,gamma:p,isRenderer:!0})}if(s.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return t;l=(0,u.qL)(l,this.lookup?.colormapLut)}return l}_symbolizeShadedRelief(t,e){const n=this.rendererJSON,r={...n,...e},o=(0,h.fw)(t,r);if(!n.colorRamp)return o;let s;if(this._isLUTChanged(!0)){if(!this.bind().success)return o;s=this.lookup?this.lookup.hsvMap:null}else s=this.lookup?this.lookup.hsvMap:null;if(!s)return o;const i=this.rasterInfo.statistics?.[0]??{min:0,max:8e3};return(0,h.SC)(o,t,s,i),o}_isVectorFieldData(){const{bandCount:t,dataType:e}=this.rasterInfo;return 2===t&&("vector-magdir"===e||"vector-uv"===e)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(t){const{bandCount:e,attributeTable:n,pixelType:r}=this.rasterInfo,o=t.field1;if(!o)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const s=t.defaultSymbol,i=1===e&&["u8","s8"].includes(r);if(!(0,f.hu)(this.rasterInfo,o)&&!i)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const a=[];if(null!=n){const e=n.fields.find((t=>"value"===t.name.toLowerCase()));if(!e)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};n.features.forEach((n=>{const r=t.uniqueValueInfos?.find((t=>String(t.value)===String(n.attributes[o]))),i=r?.symbol?.color;i?a.push([n.attributes[e.name]].concat(i)):s&&a.push([n.attributes[e.name]].concat(s.color))}))}else{if("value"!==o.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not available.'};t.uniqueValueInfos?.forEach((t=>{const e=t?.symbol?.color;e?a.push([parseInt(""+t.value,10)].concat(e)):s&&a.push([parseInt(""+t.value,10)].concat(s?.color))}))}if(0===a.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};const l=(0,u.zg)({colormap:a});return this.lookup={rendererJSON:t,colormapLut:l},this.canRenderInWebGL=(0,f.WN)(l?.indexedColormap),{success:!0}}_updateColormapRenderer(t){if(!(0,f.FA)(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};const e=t.colormapInfos.map((t=>[t.value].concat(t.color))).sort(((t,e)=>t[0]-e[0]));if(!e||0===e.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};const n=(0,u.zg)({colormap:e});return this.lookup={rendererJSON:t,colormapLut:n},this.canRenderInWebGL=(0,f.WN)(n?.indexedColormap),{success:!0}}_updateShadedReliefRenderer(t){if(!(0,f.iL)(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(t.colorRamp){const e=(0,p.R8)(t.colorRamp,{interpolateAlpha:!0}),n=(0,u.zg)({colormap:e}),r=(0,p.S2)(n.indexedColormap);this.lookup={rendererJSON:t,colormapLut:n,hsvMap:r}}else this.lookup=null;return this.canRenderInWebGL=!0,{success:!0}}_analyzeClassBreaks(t){const{attributeTable:e,pixelType:n}=this.rasterInfo,r=null!=e?e.fields.find((t=>"value"===t.name.toLowerCase())):null,o=null!=e?e.fields.find((e=>e.name.toLowerCase()===t.field.toLowerCase())):null,s=null!=r&&null!==o;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(n)||s,tableValueField:r,tableBreakField:o}}_updateClassBreaksRenderer(t){const{attributeTable:e}=this.rasterInfo,{canUseIndexedLUT:n,tableValueField:r,tableBreakField:o}=this._analyzeClassBreaks(t),s=t.classBreakInfos;if(!s?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};const i=s.sort(((t,e)=>t.classMaxValue-e.classMaxValue)),a=i[i.length-1];let l=t.minValue;if(!n){const e=[];for(let t=0;t<i.length;t++)e.push({value:i[t].classMinValue??l,mappedColor:i[t].symbol.color}),l=i[t].classMaxValue;return e.push({value:a.classMaxValue,mappedColor:a.symbol.color}),this.lookup={rendererJSON:t,remapLut:e},this.canRenderInWebGL=!1,{success:!0}}const c=[];if(null!=e&&null!=r&&null!==o&&r!==o){const n=r.name,s=o.name,a=i[i.length-1],{classMaxValue:u}=a;l=t.minValue;for(const t of e.features){const e=t.attributes[n],r=t.attributes[s],o=r===u?a:r<l?null:i.find((({classMaxValue:t})=>t>r));o&&c.push([e].concat(o.symbol.color))}}else{l=Math.floor(t.minValue);for(let t=0;t<i.length;t++){const e=i[t];for(let t=l;t<e.classMaxValue;t++)c.push([t].concat(e.symbol.color));l=Math.ceil(e.classMaxValue)}a.classMaxValue===l&&c.push([a.classMaxValue].concat(a.symbol.color))}const h=(0,u.zg)({colormap:c,fillUnspecified:!1});return this.lookup={rendererJSON:t,colormapLut:h},this.canRenderInWebGL=(0,f.WN)(h?.indexedColormap),{success:!0}}_updateStretchRenderer(t){let{stretchType:e,dra:n}=t;if(!("none"===e||t.statistics?.length||function(t){return null!=t&&t.length>0&&null!=t[0].min&&null!=t[0].max}(this.rasterInfo.statistics)||n))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};const r=t.histograms||this.rasterInfo.histograms;!function(t){return"percentClip"===t||"histogramEqualization"===t}(t.stretchType)||r?.length||n||(e="minMax");const{computeGamma:o,useGamma:s,colorRamp:i}=t;let{gamma:a}=t;if(s&&o&&!a?.length){const e=t.statistics?.length?t.statistics:this.rasterInfo.statistics;a=(0,c.fP)(this.rasterInfo.pixelType,e)}const l=this.rasterInfo.pixelType,h=!n&&["u8","u16","s8","s16"].includes(l);if("histogramEqualization"===e){const e=r.map((t=>(0,c.WF)(t)));this.lookup={rendererJSON:t,histogramLut:e}}else if(h){const e=(0,c.DP)(t,{rasterInfo:this.rasterInfo}),n=(0,c.RP)({pixelType:l,...e,gamma:s?a:null,rounding:"floor"});this.lookup={rendererJSON:t,stretchLut:n}}if(i&&!function(t){return"algorithmic"===t.type&&["0,0,0,255","0,0,0"].includes(t.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(t.toColor.join(","))}(i)){const e=(0,p.R8)(i,{interpolateAlpha:!0});this.lookup||(this.lookup={rendererJSON:t}),this.lookup.colormapLut=(0,u.zg)({colormap:e}),this.lookup.rendererJSON=t}return this.lookup.gamma=s&&a?.length?a:null,this.canRenderInWebGL=!0,{success:!0}}_generateStretchWebGLParams(t,e,n){let r=null,o=null;const s=this.lookup?.colormapLut;e.colorRamp&&s&&(r=s.indexedColormap,o=s.offset),"histogramEqualization"===e.stretchType&&(e={...e,stretchType:"minMax"});const{gamma:i}=this.lookup,a=!(!e.useGamma||!i?.some((t=>1!==t))),{minCutOff:l,maxCutOff:u,outMin:h,outMax:p}=(0,c.DP)(e,{rasterInfo:this.rasterInfo,pixelBlock:t,bandIds:n});let f=0;null!=t&&(f=t.getPlaneCount(),2===f&&((t=t.clone()).statistics=[t.statistics[0]],t.pixels=[t.pixels[0]]));const{bandCount:d}=this.rasterInfo,m=Math.min(3,n?.length||f||d,d),g=new Float32Array(m),y=r||a?1:255;let x;for(x=0;x<l.length;x++)g[x]=u[x]===l[x]?0:(p-h)/(u[x]-l[x])/y;const w=new Float32Array(m);if(a&&i)for(x=0;x<m;x++)i[x]>1?i[x]>2?w[x]=6.5+(i[x]-2)**2.5:w[x]=6.5+100*(2-i[x])**4:w[x]=1;return{bandCount:m,outMin:h/y,outMax:p/y,minCutOff:l,maxCutOff:u,factor:g,useGamma:a,gamma:a?i:[1,1,1],gammaCorrection:a?w:[1,1,1],colormap:r,colormapOffset:o,stretchType:e.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(t,e=!1,n={x:0,y:0}){let r=null,o=null;const s=this.lookup?.colormapLut;t.colorRamp&&s&&(r=s.indexedColormap,o=s.offset);const i={...t,isGCS:e,resolution:n},a=(0,h.ng)(i),l=this.rasterInfo.statistics?.[0];return{...a,minValue:l?.min??0,maxValue:l?.max??8e3,hillshadeType:"traditional"===t.hillshadeType?0:1,type:"hillshade",colormap:r,colormapOffset:o}}_generateVectorFieldWebGLParams(t){const{style:e,inputUnit:n,outputUnit:r,visualVariables:o,symbolTileSize:s,flowRepresentation:i}=t;let a;const l=this.rasterInfo.statistics?.[0].min??0,u=this.rasterInfo.statistics?.[0].max??50,c=o?.find((t=>"sizeInfo"===t.type))??{type:"sizeInfo",field:"Magnitude",maxDataValue:u,maxSize:.8*s,minDataValue:l,minSize:.2*s},h=c.minDataValue??l,p=c.maxDataValue??u,f=null!=c.maxSize&&null!=c.minSize?[c.minSize/s,c.maxSize/s]:[.2,.8];if("wind_speed"===e){const t=(f[0]+f[1])/2;f[0]=f[1]=t}const d=null!=h&&null!=p?[h,p]:null;if("classified_arrow"===e)if(null!=h&&null!=p&&null!=c){a=[];const t=(c.maxDataValue-c.minDataValue)/5;for(let e=0;e<6;e++)a.push(c.minDataValue+t*e)}else a=[0,1e-6,3.5,7,10.5,14];const m="flow_to"===i==("ocean_current_kn"===e||"ocean_current_m"===e)?0:Math.PI,g=o?.find((t=>"rotationInfo"===t.type));return{breakValues:a,dataRange:d,inputUnit:n,outputUnit:r,symbolTileSize:s,symbolPercentRange:f,style:e||"single_arrow",rotation:m,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":g?.rotationType||t.rotationType,type:"vectorField"}}};(0,r._)([(0,i.MZ)({json:{write:!0}})],d.prototype,"rendererJSON",void 0),(0,r._)([(0,i.MZ)({type:l.A,json:{write:!0}})],d.prototype,"rasterInfo",void 0),(0,r._)([(0,i.MZ)({json:{write:!0}})],d.prototype,"lookup",void 0),(0,r._)([(0,i.MZ)()],d.prototype,"canRenderInWebGL",void 0),d=(0,r._)([(0,a.$)("esri.renderers.support.RasterSymbolizer")],d);const m=d;function g(t){return(0,u.AB)(t)&&0!==t.validPixelCount}},3212:function(t,e,n){n.d(e,{L7:function(){return a},M5:function(){return d},R8:function(){return x},S2:function(){return w},hf:function(){return A},hs:function(){return f},iv:function(){return y},kH:function(){return u},vL:function(){return M},vj:function(){return l}});var r=n(52874),o=n(75505),s=n(73037),i=n(30905);const a=["random","ndvi","ndvi2","ndvi3","elevation","gray","hillshade"],l=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],u=new s.J({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});function c(t,e){if(!t||!e||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]>e[n]+2||t[n]<e[n]-2)return!1;return!0}function h(t){const e=t.clone();return e.fromColor=t.toColor,e.toColor=t.fromColor,e.algorithm=t.algorithm,e}function p(t,e){if(!t)return;const n=e??l;let o=null;return"algorithmic"===t.type?n.some((e=>{if(c(t.fromColor.toRgb(),e.fromColor)&&c(t.toColor.toRgb(),e.toColor))return o=e.id,!0})):"multipart"===t.type&&n.some((e=>{const n=t.colorRamps,s=e.colorRamps;if(n&&s&&n.length===s.length&&!s.some(((t,e)=>{if(!c(n[e].fromColor.toRgb(),new r.A(t.fromColor).toRgb())||!c(n[e].toColor.toRgb(),new r.A(t.toColor).toRgb()))return!0}))){if(o)return!0;o=e.id}})),o}function f(t,e=!1){const n="string"==typeof t?t:function(t,e,n=!1){if(!t)return;let r=!1,o=p(t,e);return null!=o||n||(r=!0,o=p(t=function(t){if("multipart"===t.type){const e=t.clone();return e.colorRamps?.length?(e.colorRamps=e.colorRamps.reverse().map((t=>h(t))),e):e}return h(t)}(t),e)),o?{id:o,inverted:r}:void 0}(t,void 0,e)?.id;return n?u.toJSON(n):null}function d(t,e="esriCIELabAlgorithm"){const n=l.find((({id:e})=>e===t));return n?n.colorRamps?{type:"multipart",colorRamps:n.colorRamps.map((t=>({type:"algorithmic",algorithm:e,fromColor:[...t.fromColor],toColor:[...t.toColor]})))}:{type:"algorithmic",algorithm:e,fromColor:[...n.fromColor],toColor:[...n.toColor]}:null}function m(t){const e=(t=t||{}).numColors||256,n=t.distanceOffset||0,r=null!=t.isCustomInterval?t.isCustomInterval:null!==t.distanceInterval&&t.distanceInterval!==1/(e-1),o=t.distanceInterval||1/(e-1);return{...t,numColors:e,distanceOffset:n,interpolateAlpha:!!t.interpolateAlpha,distanceInterval:o,isCustomInterval:r,weights:t.weights}}function g(t,e){let{fromColor:n,toColor:r}=t;n=[...n],r=[...r],3===n.length&&(n=n.concat([255])),3===r.length&&(r=r.concat([255]));const s=t.algorithm||"esriCIELabAlgorithm",i=m(e),{numColors:a,distanceOffset:l,isCustomInterval:u,interpolateAlpha:c}=i;if(1===a&&0===l)return[n];if(2===a&&0===l&&!u)return[n,r];const h={r:n[0],g:n[1],b:n[2]},p={r:r[0],g:r[1],b:r[2]},f="esriCIELabAlgorithm"===s?function(t,e,n){const{numColors:r,distanceOffset:o,distanceInterval:s,isCustomInterval:i}=n;let{l:a,a:l,b:u}=t;const c=(e.l-a)*s,h=(e.a-l)*s,p=(e.b-u)*s,f=[];if(o){const t=o/s;a+=t*c,l+=t*h,u+=t*p}for(let t=0;t<r-1;t++)f.push({l:a,a:l,b:u}),a+=c,l+=h,u+=p;return f.push(i?{l:a,a:l,b:u}:e),f}((0,o.ZD)(h),(0,o.ZD)(p),i):"esriHSVAlgorithm"===s?function(t,e,n){const{numColors:r,distanceOffset:o,distanceInterval:s,isCustomInterval:i}=n,a=0===t.s,l=0===e.s;let u=t.h,c=e.h;a&&!l?u=c:l&&!a&&(e={...e,h:u},c=u);let h,p=Math.abs(c-u);const f=360;p<180?h=(c-u)*s:(p=f-p,h=u>c?p*s:-p*s);const d=(e.s-t.s)*s,m=(e.v-t.v)*s;let{s:g,v:y}=t,x=u;if(o){const t=o/s;x=(x+t*h+f)%f,g+=t*d,y+=t*m}const w=[];for(let t=0;t<r-1;t++)w.push({h:x,s:g,v:y}),x=(x+h+f)%f,g+=d,y+=m;return w.push(i?{h:x,s:g,v:y}:e),w}((0,o.N2)(h),(0,o.N2)(p),i):function(t,e,n){const{numColors:r,distanceOffset:o,distanceInterval:s,isCustomInterval:i}=n,a=t.h,l=e.h,u=2*Math.PI;let c;if(a<=l){const t=l-a,e=l-a-u;c=Math.abs(e)<Math.abs(t)?e:t}else{const t=l+u-a,e=l-a;c=Math.abs(e)<Math.abs(t)?e:t}const h=c*s,p=(e.l-t.l)*s,f=(e.c-t.c)*s;let{l:d,c:m,h:g}=t;if(o){const t=o/s;d+=t*p,m+=t*f,g=(g+t*h+u)%u}const y=[];for(let t=0;t<r-1;t++)y.push({l:d,c:m,h:g}),d+=p,m+=f,g=(g+h+u)%u;return y.push(i?{l:d,c:m,h:g}:e),y}((0,o.RH)(h),(0,o.RH)(p),i),d=[],g=n[3]??255,y=((r[3]??255)-g)/(a-1);for(let t=0;t<a;t++){const{r:e,g:n,b:r}=(0,o.$)(f[t]),s=c?Math.round(g+y*t):255;d.push([e,n,r,s])}return d}function y(t,e){const n=(0,i.Wj)(t)?t.toJSON():t;return"multipart"===n.type?function(t,e){const{numColors:n,interpolateAlpha:r}=m(e);let o=e?.weights;const{colorRamps:s}=t;if(o){const t=o.reduce(((t,e)=>t+e));o=o.map((e=>e/t))}else{o=[];for(let t=0;t<s.length;t++)o[t]=1/s.length}const i=[],a=1/(n-1);let l=0,u=!1;for(let t=0;t<s.length;t++){const e=i.length,c=u?0:e*a-l;l+=o[t];let h=t===s.length-1?n-1-e:(o[t]-c)/a;if(u=Math.ceil(h)===h,h=Math.ceil(h),0===h)continue;const p=g(s[t],{numColors:h,interpolateAlpha:r,distanceOffset:c/o[t],distanceInterval:a/o[t]});i.push(...p)}const c=[...s[s.length-1].toColor];return 3===c.length&&c.push(255),i.push(c),i}(n,e):g(n,e)}function x(t,e){const n=y(t,e),r=e?.interpolateAlpha;return n.forEach(((t,e)=>{t.unshift(e),r||t.pop()})),n}function w(t){const e=[];for(let n=0;n<t.length;n+=4){const r=(0,o.N2)({r:t[n],g:t[n+1],b:t[n+2]});e.push([r.h/60,r.s/100,255*r.v/100])}return e}function b(t){const e=(0,o.N2)(t);return{type:"HsvColor",Hue:e.h,Saturation:e.s,Value:e.v,AlphaValue:255}}function v(t){const e=t.toJSON();return{Algorithm:e?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:b(t.fromColor),ToColor:b(t.toColor)}}function A(t){const e=f(t);if(!e)return null;if("algorithmic"===t.type)return{...v(t),Name:e};if(t.colorRamps){const n=t.colorRamps.map(v);return{type:"MultiPartColorRamp",NumColorRamps:n.length,ArrayOfColorRamp:n,Name:e}}return null}function M(t){const e=t.reverse().map((t=>{const e=t.toString(16);return e.length<2?"0"+e:e}));return 4294967295&Number.parseInt(e.join(""),16)}},9059:function(t,e,n){function r(t,e){const{attributeTable:n,bandCount:r}=t;return!((null!=n||(o=t,!["u8","s8"].includes(o.pixelType)||null==o.statistics?.[0]?.min||null==o.statistics[0]?.max||1!==o.bandCount))&&(null==n||r>1||e&&null==n.fields.find((t=>t.name.toLowerCase()===e.toLowerCase()))));var o}function o(t){const{bandCount:e,dataType:n,pixelType:r}=t;return"elevation"===n||"generic"===n&&1===e&&("s16"===r||"s32"===r||"f32"===r||"f64"===r)}function s(t,e=!1){const{bandCount:n,colormap:r,pixelType:o}=t;return 1===n&&(!!r?.length||!e&&"u8"===o)}function i(t,e=!1){const{attributeTable:n,bandCount:r}=t;return 1===r&&(!e||null!=n||null!=t.histograms)}function a(t){const{dataType:e}=t;return"vector-uv"===e||"vector-magdir"===e}function l(t){const{dataType:e}=t;return"vector-uv"===e||"vector-magdir"===e}function u(t){return!!t?.length&&t.length<=16384}n.d(e,{FA:function(){return s},QJ:function(){return l},WN:function(){return u},hu:function(){return r},iL:function(){return o},rd:function(){return a},xX:function(){return i}})},41259:function(t,e,n){n.d(e,{u:function(){return r},x:function(){return o}});const r=new(n(73037).J)({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),o={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"}},30698:function(t,e,n){n.d(e,{A:function(){return f}});var r,o=n(53804),s=n(52874),i=n(21609),a=n(23502),l=n(67888),u=n(74376),c=n(65953),h=n(9035);let p=r=class extends h.A{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new r({fromColor:(0,i.o8)(this.fromColor),toColor:(0,i.o8)(this.toColor),algorithm:this.algorithm})}};(0,o._)([(0,u.e)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],p.prototype,"algorithm",void 0),(0,o._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],p.prototype,"fromColor",void 0),(0,o._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],p.prototype,"toColor",void 0),(0,o._)([(0,a.MZ)({type:["algorithmic"]})],p.prototype,"type",void 0),p=r=(0,o._)([(0,c.$)("esri.rest.support.AlgorithmicColorRamp")],p);const f=p},9035:function(t,e,n){n.d(e,{A:function(){return l}});var r=n(53804),o=n(30905),s=n(23502),i=(n(58941),n(40633),n(13798),n(65953));let a=class extends o.oY{constructor(t){super(t),this.type=null}};(0,r._)([(0,s.MZ)({readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,r._)([(0,i.$)("esri.rest.support.ColorRamp")],a);const l=a},96245:function(t,e,n){n.d(e,{A:function(){return h}});var r,o=n(53804),s=n(21609),i=n(23502),a=(n(58941),n(40633),n(65953)),l=n(30698),u=n(9035);let c=r=class extends u.A{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new r({colorRamps:(0,s.o8)(this.colorRamps)})}};(0,o._)([(0,i.MZ)({type:[l.A],json:{write:!0}})],c.prototype,"colorRamps",void 0),(0,o._)([(0,i.MZ)({type:["multipart"]})],c.prototype,"type",void 0),c=r=(0,o._)([(0,a.$)("esri.rest.support.MultipartColorRamp")],c);const h=c},85982:function(t,e,n){n.d(e,{g:function(){return i},r:function(){return a}});var r=n(30698),o=n(9035),s=n(96245);const i={key:"type",base:o.A,typeMap:{algorithmic:r.A,multipart:s.A}};function a(t){return t?.type?"algorithmic"===t.type?r.A.fromJSON(t):"multipart"===t.type?s.A.fromJSON(t):null:null}},20106:function(t,e,n){n.d(e,{CW:function(){return p},pH:function(){return g}}),n(50917);var r=n(58941),o=n(40633),s=n(15774),i=n(60539),a=n(13798),l=n(57652),u=n(91484);const c=()=>o.A.getLogger("esri.views.2d.engine.flow.dataUtils"),h=10;async function p(t,e,n,o){const s=performance.now(),l=function(t,e){const n=function(t,e,n,r){if(0===r)return t;const o=Math.round(3*r),s=new Array(2*o+1);let i=0;for(let t=-o;t<=o;t++){const e=Math.exp(-t*t/(r*r));s[t+o]=e,i+=e}for(let t=-o;t<=o;t++)s[t+o]/=i;const a=new Float32Array(t.length);for(let r=0;r<n;r++)for(let n=0;n<e;n++){let i=0,l=0;for(let a=-o;a<=o;a++){if(n+a<0||n+a>=e)continue;const u=s[a+o];i+=u*t[2*(r*e+(n+a))],l+=u*t[2*(r*e+(n+a))+1]}a[2*(r*e+n)]=i,a[2*(r*e+n)+1]=l}const l=new Float32Array(t.length);for(let t=0;t<e;t++)for(let r=0;r<n;r++){let i=0,u=0;for(let l=-o;l<=o;l++){if(r+l<0||r+l>=n)continue;const c=s[l+o];i+=c*a[2*((r+l)*e+t)],u+=c*a[2*((r+l)*e+t)+1]}l[2*(r*e+t)]=i,l[2*(r*e+t)+1]=u}return l}(e.data,e.width,e.height,t.smoothing);return t.interpolate?(t,r)=>{const o=Math.floor(t),s=Math.floor(r);if(o<0||o>=e.width)return[0,0];if(s<0||s>=e.height)return[0,0];const i=t-o,a=r-s,l=o,u=s,c=o<e.width-1?o+1:o,h=s<e.height-1?s+1:s,p=n[2*(u*e.width+l)],f=n[2*(u*e.width+c)],d=n[2*(h*e.width+l)],m=n[2*(h*e.width+c)],g=n[2*(u*e.width+l)+1],y=n[2*(u*e.width+c)+1];return[(p*(1-a)+d*a)*(1-i)+(f*(1-a)+m*a)*i,(g*(1-a)+n[2*(h*e.width+l)+1]*a)*(1-i)+(y*(1-a)+n[2*(h*e.width+c)+1]*a)*i]}:(t,r)=>{const o=Math.round(t),s=Math.round(r);return o<0||o>=e.width||s<0||s>=e.height?[0,0]:[n[2*(s*e.width+o)],n[2*(s*e.width+o)+1]]}}(e,n),u=performance.now(),p=d(e,l,n.width,n.height),f=performance.now(),m=function(t){const e=new a.A,n=t.reduce(((t,e)=>t+e.length),0),r=new Float32Array(4*n),o=new Array(t.length);let s=0,i=0;for(const n of t){const t=s;for(const t of n)r[4*s]=t.x,r[4*s+1]=t.y,r[4*s+2]=t.t,r[4*s+3]=t.speed,s++;o[i++]={startVertex:t,numberOfVertices:n.length,totalTime:n[n.length-1].t,timeSeed:e.getFloat()}}return{lineVertices:r,lineDescriptors:o}}(p),g=performance.now(),y="Streamlines"===t?function(t,e){const{lineVertices:n,lineDescriptors:r}=t;let o=0,s=0;for(const t of r)o+=2*t.numberOfVertices,s+=6*(t.numberOfVertices-1);const i=new Float32Array(9*o),a=new Uint32Array(s);let l=0,u=0;function c(){a[u++]=l-2,a[u++]=l,a[u++]=l-1,a[u++]=l,a[u++]=l+1,a[u++]=l-1}function h(t,e,n,r,o,s,a,u){const c=9*l;let h=0;i[c+h++]=t,i[c+h++]=e,i[c+h++]=1,i[c+h++]=n,i[c+h++]=s,i[c+h++]=a,i[c+h++]=r/2,i[c+h++]=o/2,i[c+h++]=u,l++,i[c+h++]=t,i[c+h++]=e,i[c+h++]=-1,i[c+h++]=n,i[c+h++]=s,i[c+h++]=a,i[c+h++]=-r/2,i[c+h++]=-o/2,i[c+h++]=u,l++}for(const t of r){const{totalTime:r,timeSeed:o}=t;let s=null,i=null,a=null,l=null,u=null,p=null;for(let f=0;f<t.numberOfVertices;f++){const d=n[4*(t.startVertex+f)],m=n[4*(t.startVertex+f)+1],g=n[4*(t.startVertex+f)+2],y=n[4*(t.startVertex+f)+3];let x=null,w=null,b=null,v=null;if(f>0){x=d-s,w=m-i;const t=Math.sqrt(x*x+w*w);if(x/=t,w/=t,f>1){let t=x+u,n=w+p;const r=Math.sqrt(t*t+n*n);t/=r,n/=r;const o=Math.min(1/(t*x+n*w),e);t*=o,n*=o,b=-n,v=t}else b=-w,v=x;null!==b&&null!==v&&(h(s,i,a,b,v,r,o,y),c())}s=d,i=m,a=g,u=x,p=w,l=y}h(s,i,a,-p,u,r,o,l)}return{vertexData:i,indexData:a}}(m,h):function(t){const{lineVertices:e,lineDescriptors:n}=t;let r=0,o=0;for(const t of n){const e=t.numberOfVertices-1;r+=4*e*2,o+=6*e*2}const s=new Float32Array(16*r),i=new Uint32Array(o);let a,l,u,c,h,p,f,d,m,g,y,x,w,b,v=0,A=0;function M(){i[A++]=v-8,i[A++]=v-7,i[A++]=v-6,i[A++]=v-7,i[A++]=v-5,i[A++]=v-6,i[A++]=v-4,i[A++]=v-3,i[A++]=v-2,i[A++]=v-3,i[A++]=v-1,i[A++]=v-2}function C(t,e,n,r,o,i,a,l,u,c,h,p,f,d){const m=16*v;let g=0;for(const y of[1,2])for(const x of[1,2,3,4])s[m+g++]=t,s[m+g++]=e,s[m+g++]=n,s[m+g++]=r,s[m+g++]=a,s[m+g++]=l,s[m+g++]=u,s[m+g++]=c,s[m+g++]=y,s[m+g++]=x,s[m+g++]=f,s[m+g++]=d,s[m+g++]=o/2,s[m+g++]=i/2,s[m+g++]=h/2,s[m+g++]=p/2,v++}function k(t,e){let n=m+y,r=g+x;const o=Math.sqrt(n*n+r*r);n/=o,r/=o;const s=m*n+g*r;n/=s,r/=s;let i=y+w,v=x+b;const A=Math.sqrt(i*i+v*v);i/=A,v/=A;const k=y*i+x*v;i/=k,v/=k,C(a,l,u,c,-r,n,h,p,f,d,-v,i,t,e),M()}function T(t,e,n,r,o,s){if(m=y,g=x,y=w,x=b,null==m&&null==g&&(m=y,g=x),null!=h&&null!=p){w=t-h,b=e-p;const n=Math.sqrt(w*w+b*b);w/=n,b/=n}null!=m&&null!=g&&k(o,s),a=h,l=p,u=f,c=d,h=t,p=e,f=n,d=r}function P(t,e){m=y,g=x,y=w,x=b,null==m&&null==g&&(m=y,g=x),null!=m&&null!=g&&k(t,e)}for(const t of n){a=null,l=null,u=null,c=null,h=null,p=null,f=null,d=null,m=null,g=null,y=null,x=null,w=null,b=null;const{totalTime:n,timeSeed:r}=t;for(let o=0;o<t.numberOfVertices;o++)T(e[4*(t.startVertex+o)],e[4*(t.startVertex+o)+1],e[4*(t.startVertex+o)+2],e[4*(t.startVertex+o)+3],n,r);P(n,r)}return{vertexData:s,indexData:i}}(m),x=performance.now();return(0,r.A)("esri-2d-profiler")&&(c().info("I.1","_createFlowFieldFromData (ms)",Math.round(u-s)),c().info("I.2","_getStreamlines (ms)",Math.round(f-u)),c().info("I.3","createAnimatedLinesData (ms)",Math.round(g-f)),c().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(x-g)),c().info("I.5","createFlowMesh (ms)",Math.round(x-s)),c().info("I.6","Mesh size (bytes)",y.vertexData.buffer.byteLength+y.indexData.buffer.byteLength)),await Promise.resolve(),(0,i.Te)(o),y}function f(t,e,n,r,o,s,i,a,l){const u=[];let c=n,h=r,p=0,[f,d]=e(c,h);f*=t.velocityScale,d*=t.velocityScale;const m=Math.sqrt(f*f+d*d);let g,y;u.push({x:c,y:h,t:p,speed:m});for(let n=0;n<t.verticesPerLine;n++){let[n,r]=e(c,h);n*=t.velocityScale,r*=t.velocityScale;const f=Math.sqrt(n*n+r*r);if(f<t.minSpeedThreshold)return u;const d=n/f,m=r/f;if(c+=d*t.segmentLength,h+=m*t.segmentLength,p+=t.segmentLength/f,Math.acos(d*g+m*y)>t.maxTurnAngle)return u;if(t.collisions){const t=Math.round(c*l),e=Math.round(h*l);if(t<0||t>i-1||e<0||e>a-1)return u;const n=s[e*i+t];if(-1!==n&&n!==o)return u;s[e*i+t]=o}u.push({x:c,y:h,t:p,speed:f}),g=d,y=m}return u}function d(t,e,n,r){const o=[],s=new a.A,i=1/Math.max(t.lineCollisionWidth,1),l=Math.round(n*i),u=Math.round(r*i),c=new Int32Array(l*u);for(let t=0;t<c.length;t++)c[t]=-1;const h=[];for(let e=0;e<r;e+=t.lineSpacing)for(let r=0;r<n;r+=t.lineSpacing)h.push({x:r,y:e,sort:s.getFloat()});h.sort(((t,e)=>t.sort-e.sort));for(const{x:n,y:r}of h)if(s.getFloat()<t.density){const s=f(t,e,n,r,o.length,c,l,u,i);if(s.length<2)continue;o.push(s)}return o}function m(t,e){const n=e.pixels,{width:r,height:o}=e,i=new Float32Array(r*o*2),a=e.mask||new Uint8Array(r*o*2);if(e.mask||a.fill(255),"vector-uv"===t)for(let t=0;t<r*o;t++)i[2*t]=n[0][t],i[2*t+1]=-n[1][t];else if("vector-magdir"===t)for(let t=0;t<r*o;t++){const e=n[0][t],r=(0,s.kU)(n[1][t]),o=Math.cos(r-Math.PI/2),a=Math.sin(r-Math.PI/2);i[2*t]=o*e,i[2*t+1]=a*e}return{data:i,mask:a,width:r,height:o}}async function g(t,e,n,o,s,i){const a=performance.now(),h=(0,l.Vp)(e.spatialReference);if(!h){const l=await y(t,e,n,o,s,i);return(0,r.A)("esri-2d-profiler")&&c().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-a)),(0,r.A)("esri-2d-profiler")&&c().info("I.9","Number of parts",1),l}const[p,f]=h.valid,d=f-p,m=Math.ceil(e.width/d),g=e.width/m,x=Math.round(n/m);let w=e.xmin;const b=[],v=performance.now();for(let n=0;n<m;n++){const n=new u.default({xmin:w,xmax:w+g,ymin:e.ymin,ymax:e.ymax,spatialReference:e.spatialReference});b.push(y(t,n,x,o,s,i)),w+=g}const A=await Promise.all(b);(0,r.A)("esri-2d-profiler")&&c().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-v)),(0,r.A)("esri-2d-profiler")&&c().info("I.9","Number of parts",A.length);const M={data:new Float32Array(n*o*2),mask:new Uint8Array(n*o),width:n,height:o};let C=0;for(const t of A){for(let e=0;e<t.height;e++)for(let r=0;r<t.width;r++)C+r>=n||(M.data[2*(e*n+C+r)]=t.data[2*(e*t.width+r)],M.data[2*(e*n+C+r)+1]=t.data[2*(e*t.width+r)+1],M.mask[e*n+C+r]=t.mask[e*t.width+r]);C+=t.width}return(0,r.A)("esri-2d-profiler")&&c().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-a)),M}async function y(t,e,n,r,o,s){const i={requestProjectedLocalDirections:!0,signal:s};if(null!=o&&(i.timeExtent=o),"imagery"===t.type){await t.load({signal:s});const o=t.rasterInfo.dataType,a=await t.fetchImage(e,n,r,i);return null==a?.pixelData?.pixelBlock?{data:new Float32Array(n*r*2),mask:new Uint8Array(n*r),width:n,height:r}:m(o,a.pixelData.pixelBlock)}await t.load({signal:s});const a=t.serviceRasterInfo.dataType,l=await t.fetchPixels(e,n,r,i);return null==l?.pixelBlock?{data:new Float32Array(n*r*2),mask:new Uint8Array(n*r),width:n,height:r}:m(a,l.pixelBlock)}}}]);
//# sourceMappingURL=layers-support-RasterWorker.js.map