"use strict";
(self["webpackChunkdefra"] = self["webpackChunkdefra"] || []).push([["widgets-Legend-support-sizeRampUtils"],{

/***/ "./node_modules/@arcgis/core/smartMapping/renderers/support/referenceSizeUtils.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/smartMapping/renderers/support/referenceSizeUtils.js ***!
  \****************************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   createPrimitiveOverrides: function() { return /* binding */ l; },
/* harmony export */   createReferenceSizeSymbol: function() { return /* binding */ u; },
/* harmony export */   getReferenceSizeStops: function() { return /* binding */ a; },
/* harmony export */   updateReferenceSizeSymbol: function() { return /* binding */ d; }
/* harmony export */ });
/* harmony import */ var _symbols_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../symbols.js */ "./node_modules/@arcgis/core/symbols.js");
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/Error.js */ "./node_modules/@arcgis/core/core/Error.js");
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/lang.js */ "./node_modules/@arcgis/core/core/lang.js");
/* harmony import */ var _renderers_visualVariables_support_SizeStop_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../renderers/visualVariables/support/SizeStop.js */ "./node_modules/@arcgis/core/renderers/visualVariables/support/SizeStop.js");
/* harmony import */ var _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../symbols/cim/enums.js */ "./node_modules/@arcgis/core/symbols/cim/enums.js");
/* harmony import */ var _symbols_CIMSymbol_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../symbols/CIMSymbol.js */ "./node_modules/@arcgis/core/symbols/CIMSymbol.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
var o;function a(r){if(null!=r.minDataValue&&null!=r.maxDataValue&&null!=r.minSize&&null!=r.maxSize&&"number"==typeof r.minSize&&"number"==typeof r.maxSize)return[new _renderers_visualVariables_support_SizeStop_js__WEBPACK_IMPORTED_MODULE_3__["default"]({value:r.minDataValue,size:r.minSize}),new _renderers_visualVariables_support_SizeStop_js__WEBPACK_IMPORTED_MODULE_3__["default"]({value:r.maxDataValue,size:r.maxSize})];throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("create-reference-size-symbol","Invalid size variable")}function l(e){const{view:r,field:n,normalizationField:t,sizeStops:i,sizeByScaleEnabled:a}=e,{value:l,size:s}=i[0],{value:m,size:c}=i[1];let u,y=0;n&&(y=`$feature["${n}"]`,u=`\n      if(!HasValue($feature, "${n}")){\n        return 0;\n      }\n      $feature["${n}"];\n    `),t&&(y=`$feature["${n}"] / $feature["${t}"]`,u=`if(!HasValue($feature, "${n}") || !HasValue($feature, "${t}") || $feature["${t}"] <= 0){\n        return 0;\n      }\n      $feature["${n}"];\n      $feature["${t}"];`);const p={type:"CIMExpressionInfo",title:"Size in pixels of outer ring",expression:a?`\n      ${u}\n      var maxSize = ${c};\n      var referenceScale = ${r.scale};\n      return (maxSize * (referenceScale / $view.scale));\n    `:`${u}\n      return ${c}`,returnType:"Default"},f={type:"CIMExpressionInfo",title:"Size in pixels of inner ring",expression:`\n        ${u}\n        var value = ${y};\n\n        var referenceScale = ${r.scale};\n        var referenceScaleRatio = ${a?"(referenceScale / $view.scale)":1};\n        var maxSize = ${c} * referenceScaleRatio;\n        var minSize = ${s} * referenceScaleRatio;\n\n        var minDataValue = ${l};\n        var maxDataValue = ${m};\n\n        var ratio = Constrain(( value - minDataValue ) / ( maxDataValue - minDataValue ), 0, 1);\n\n        var innerDotSize = Constrain(maxSize * ratio, minSize, maxSize);\n        return innerDotSize;\n      `,returnType:"Default"};return[{type:"CIMPrimitiveOverride",primitiveName:o.OuterRing,propertyName:"Size",valueExpressionInfo:p},{type:"CIMPrimitiveOverride",primitiveName:o.InnerDot,propertyName:"Size",valueExpressionInfo:f}]}function s(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function m(e){const{type:r,color:n,colorLocked:i}=e;return{type:"CIMVectorMarker",enable:!0,colorLocked:!1,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:o.OuterRing,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:s(r),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:n.toArray(),colorLocked:!!i,effects:[{type:"CIMGeometricEffectDonut",width:.75}]}]}}],scaleSymbolsProportionally:!1,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:_symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_4__.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:20}}function c(e){const{type:r,color:n}=e;return{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:o.InnerDot,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:s(r),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:n.toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:_symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_4__.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:10}}function u(e){const{primitiveOverrides:r}=e;return new _symbols_CIMSymbol_js__WEBPACK_IMPORTED_MODULE_5__["default"]({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[m(e),c(e)]},primitiveOverrides:r}})}function y(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function p(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function f(e,r){"CIMVectorMarker"===e?.type&&null!=r&&(e.size=r)}function v(e,r){const n=y(e);n&&null!=r&&(n.geometry=s(r))}function S(e,r){const n=p(y(e));n&&null!=r&&(n.color=r.toArray())}function z(e,r,n){const t=p(y(e));t&&null!=r&&n&&(t.colorLocked=r)}function d(e,n){const{outerRingSize:t,innerDotSize:i,type:a,color:l,colorLocked:s,primitiveOverrides:m}=n,c="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===c?.length)for(const r of c){const e=r.primitiveName===o.OuterRing;f(r,e?t:i),v(r,a),S(r,l),z(r,s,e)}return null!=t&&null!=i&&(e.data.primitiveOverrides=null),void 0!==m&&(e.data.primitiveOverrides=(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.clone)(m)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(o||(o={}));


/***/ }),

/***/ "./node_modules/@arcgis/core/widgets/Legend/support/sizeRampUtils.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@arcgis/core/widgets/Legend/support/sizeRampUtils.js ***!
  \***************************************************************************/
/***/ (function(__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   getRampStops: function() { return /* binding */ L; },
/* harmony export */   getReferenceSizeSymbol: function() { return /* binding */ M; },
/* harmony export */   realWorldMaxSize: function() { return /* binding */ b; },
/* harmony export */   realWorldMinSize: function() { return /* binding */ h; }
/* harmony export */ });
/* harmony import */ var _Color_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../Color.js */ "./node_modules/@arcgis/core/Color.js");
/* harmony import */ var _symbols_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../symbols.js */ "./node_modules/@arcgis/core/symbols.js");
/* harmony import */ var _renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../renderers/support/numberUtils.js */ "./node_modules/@arcgis/core/renderers/support/numberUtils.js");
/* harmony import */ var _smartMapping_renderers_support_referenceSizeUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../smartMapping/renderers/support/referenceSizeUtils.js */ "./node_modules/@arcgis/core/smartMapping/renderers/support/referenceSizeUtils.js");
/* harmony import */ var _symbols_support_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../symbols/support/cimSymbolUtils.js */ "./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js");
/* harmony import */ var _symbols_support_utils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../symbols/support/utils.js */ "./node_modules/@arcgis/core/symbols/support/utils.js");
/* harmony import */ var _utils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./utils.js */ "./node_modules/@arcgis/core/widgets/Legend/support/utils.js");
/* harmony import */ var _support_widgetUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../support/widgetUtils.js */ "./node_modules/@arcgis/core/widgets/support/widgetUtils.js");
/* harmony import */ var _support_themeUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../support/themeUtils.js */ "./node_modules/@arcgis/core/support/themeUtils.js");
/* harmony import */ var _symbols_SimpleMarkerSymbol_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../symbols/SimpleMarkerSymbol.js */ "./node_modules/@arcgis/core/symbols/SimpleMarkerSymbol.js");
/* harmony import */ var _symbols_SimpleLineSymbol_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../symbols/SimpleLineSymbol.js */ "./node_modules/@arcgis/core/symbols/SimpleLineSymbol.js");
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.31/esri/copyright.txt for details.
*/
const b=30,h=12,d=24,w=[255,255,255],S=[200,200,200],g=[128,128,128],v=20,z=5;function j(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}function k(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}function V(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}function x(e){return"esri.symbols.TextSymbol"===e.declaredClass}function I(e,l){const t=e.length-1;return e.map(((e,n)=>(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__.createStopLabel)(e,n,t,l)))}async function L(e,l,n,o,i,s,c){const m=l.legendOptions,p=m?.customValues,f=c||await D(e,n),y=l.stops,b=!!f,h=!!p,w=null!=l.minSize&&null!=l.maxSize,S=y&&y.length>1,g=!!l.target;if(!b||!h&&!(w||S&&!g))return;const v=(0,_symbols_support_utils_js__WEBPACK_IMPORTED_MODULE_5__.isVolumetricSymbol)(f);let z=!1,j=null,k=null;j=v&&!S?(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.round)([l.minDataValue,l.maxDataValue]):p??await T(l,f,o,i?.type);const V=e?.authoringInfo,x="univariate-color-size"===V?.type,L=x&&"above-and-below"===V?.univariateTheme,q=!!(0,_utils_js__WEBPACK_IMPORTED_MODULE_6__.getReferenceSizeAuthoringInfoVisualVariable)(e);if(!j&&S&&(j=y.map((e=>e.value)),z=y.some((e=>!!e.label)),"flow"===e.type&&(j=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.round)(j)),z&&(k=y.map((e=>e.label)))),v&&null!=j&&j?.length>2&&!L&&(j=[j[0],j[j.length-1]]),!j)return null;x&&5!==j?.length&&(j=P({minSize:j[0],maxSize:j[j.length-1]}));const B=v?U(e,j):null,E=(0,_symbols_support_utils_js__WEBPACK_IMPORTED_MODULE_5__.getSymbolOutlineSize)(f),R=z?null:I(j,s);return(await Promise.all(j.map((async(t,s)=>{const r=v?B[s]:await H(l,f,t,o,i?.type);return{value:t,symbol:!q||"class-breaks"!==e.type&&"unique-value"!==e.type?O(L&&"class-breaks"===e.type?C(e,s):f,r):M(e,r,l.maxSize,n)??f,label:z?k[s]:R[s],size:q?d:r,outlineSize:E}})))).reverse()}function U(e,l){const t=e?.authoringInfo,n="univariate-color-size"===t?.type;let o=[h,b];if(n){const e=l[0],t=l[l.length-1],n=h,i=b;o=l.map((l=>n+(l-e)/(t-e)*(i-n)))}return n&&"below"===t?.univariateTheme&&o.reverse(),o}function M(l,t,n,o){const s="class-breaks"===l.type,r=s?l.classBreakInfos?.[0]?.symbol?.clone():l.uniqueValueInfos?.[0]?.symbol?.clone();return r&&"type"in r&&"cim"===r.type?((0,_smartMapping_renderers_support_referenceSizeUtils_js__WEBPACK_IMPORTED_MODULE_3__.updateReferenceSizeSymbol)(r,{color:o??(s?null:new _Color_js__WEBPACK_IMPORTED_MODULE_0__["default"](S)),innerDotSize:t*(d/n)||1,outerRingSize:d}),r):null}function C(e,l){const t=e.classBreakInfos,n=t.length,o=n<2||!(l>=2)?t[0].symbol.clone():t[n-1].symbol.clone(),i=e.visualVariables?.some((e=>"color"===e.type));return i&&(o.type.includes("3d")?B(o):E(o)),o}async function D(e,l){if("flow"===e.type)return (0,_utils_js__WEBPACK_IMPORTED_MODULE_6__.getSymbolForFlowRenderer)(e,l);if("pie-chart"===e.type)return new _symbols_SimpleMarkerSymbol_js__WEBPACK_IMPORTED_MODULE_9__["default"]({color:null,outline:e.outline?.width?e.outline:new _symbols_SimpleLineSymbol_js__WEBPACK_IMPORTED_MODULE_10__["default"]});let t=null,n=null;if("simple"===e.type)t=e.symbol;else if("class-breaks"===e.type){const l=e.classBreakInfos;t=l&&l[0]&&l[0].symbol,n=l.length>1}else if("unique-value"===e.type){const l=e.uniqueValueInfos;t=l?.[0]?.symbol,n=null!=l&&l.length>1}return!t||q(t)?null:(t=t.clone(),(l||n)&&(t.type.includes("3d")?B(t):E(t)),t)}function q(e){if(e){if((0,_symbols_js__WEBPACK_IMPORTED_MODULE_1__.isSymbol3D)(e)){return!!e.symbolLayers&&e.symbolLayers.some((e=>e&&"fill"===e.type))}return e.type.includes("fill")}return!1}function B(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:g}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:S}:(e.material={color:w},e.outline={color:g,size:1.5})}))}function E(l){const t=(0,_support_themeUtils_js__WEBPACK_IMPORTED_MODULE_8__.isDarkTheme)();if("cim"===l.type)(0,_symbols_support_cimSymbolUtils_js__WEBPACK_IMPORTED_MODULE_4__.applyCIMSymbolColor)(l,new _Color_js__WEBPACK_IMPORTED_MODULE_0__["default"](S));else if(l.type.includes("line"))l.color=g;else if(l.color=t?g:w,"simple-marker"===l.type)if(l.outline){const e=l.outline?.color?.toHex();"#ffffff"===e&&(l.outline.color=g)}else l.outline={color:g,width:1.5}}async function T(e,l,n,o){const i=(await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../../renderers/visualVariables/support/visualVariableUtils.js */ "./node_modules/@arcgis/core/renderers/visualVariables/support/visualVariableUtils.js"))).getSizeRangeAtScale(e,n,o),s=i&&P(i);if(!i||!s)return;let r=s.map((l=>R(l,e,i)));r=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.round)(r);for(let t=1;t<r.length-1;t++){const i=await A(e,l,r[t],r[t-1],n,o);i&&(r[t]=i[0],s[t]=i[1])}return r}function P(e){const l=e.minSize,t=e.maxSize,n=z,o=(t-l)/(n-1),i=[];for(let s=0;s<n;s++)i.push(l+o*s);return i}function R(e,l,t){const n=t.minSize,o=t.maxSize,i=l.minDataValue,s=l.maxDataValue;let r;if(e<=n)r=i;else if(e>=o)r=s;else{r=(e-n)/(o-n)*(s-i)+i}return r}async function A(e,l,i,s,r,a){const u=await H(e,l,i,r,a),c=await H(e,l,s,r,a),m=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.numDigits)(i),p=m.fractional,f=v;let y=m.integer,b=null,h=null;i>0&&i<1&&(b=10**p,y=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.numDigits)(i*=b).integer);for(let n=y-1;n>=0;n--){const s=10**n;let m=Math.floor(i/s)*s,p=Math.ceil(i/s)*s;null!=b&&(m/=b,p/=b);let y=(m+p)/2;[,y]=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.round)([m,y,p],{indexes:[1]});const d=await H(e,l,m,r,a),w=await H(e,l,p,r,a),S=await H(e,l,y,r,a),g=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.percentChange)(u,d,c,null),v=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.percentChange)(u,w,c,null),z=(0,_renderers_support_numberUtils_js__WEBPACK_IMPORTED_MODULE_2__.percentChange)(u,S,c,null);let j=g.previous<=f,k=v.previous<=f;if(j&&k&&(g.previous<=v.previous?(j=!0,k=!1):(k=!0,j=!1)),j?h=[m,d]:k?h=[p,w]:z.previous<=f&&(h=[y,S]),h)break}return h}async function H(e,l,t,n,o){const{getSize:i}=await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ../../../renderers/visualVariables/support/visualVariableUtils.js */ "./node_modules/@arcgis/core/renderers/visualVariables/support/visualVariableUtils.js"));return i(e,t,{scale:n,view:o,shape:"simple-marker"===l.type?l.style:null})}function O(e,t){const n=e.clone();if((0,_symbols_js__WEBPACK_IMPORTED_MODULE_1__.isSymbol3D)(n))(0,_symbols_support_utils_js__WEBPACK_IMPORTED_MODULE_5__.isVolumetricSymbol)(n)||n.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(j(n))n.size=t;else if(k(n)){const e=n.width,l=n.height;n.height=t,n.width=t*(e/l)}else V(n)?n.width=t:x(n)&&n.font&&(n.font.size=t);return n}


/***/ })

}]);
//# sourceMappingURL=widgets-Legend-support-sizeRampUtils.js.map