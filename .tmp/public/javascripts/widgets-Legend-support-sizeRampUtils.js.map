{"version":3,"file":"widgets-Legend-support-sizeRampUtils.js","mappings":"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","sources":["webpack://defra/./node_modules/@arcgis/core/smartMapping/renderers/support/referenceSizeUtils.js","webpack://defra/./node_modules/@arcgis/core/widgets/Legend/support/sizeRampUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../symbols.js\";import e from\"../../../core/Error.js\";import{clone as r}from\"../../../core/lang.js\";import n from\"../../../renderers/visualVariables/support/SizeStop.js\";import{PlacementPolygonCenterMethod as t}from\"../../../symbols/cim/enums.js\";import i from\"../../../symbols/CIMSymbol.js\";var o;function a(r){if(null!=r.minDataValue&&null!=r.maxDataValue&&null!=r.minSize&&null!=r.maxSize&&\"number\"==typeof r.minSize&&\"number\"==typeof r.maxSize)return[new n({value:r.minDataValue,size:r.minSize}),new n({value:r.maxDataValue,size:r.maxSize})];throw new e(\"create-reference-size-symbol\",\"Invalid size variable\")}function l(e){const{view:r,field:n,normalizationField:t,sizeStops:i,sizeByScaleEnabled:a}=e,{value:l,size:s}=i[0],{value:m,size:c}=i[1];let u,y=0;n&&(y=`$feature[\"${n}\"]`,u=`\\n      if(!HasValue($feature, \"${n}\")){\\n        return 0;\\n      }\\n      $feature[\"${n}\"];\\n    `),t&&(y=`$feature[\"${n}\"] / $feature[\"${t}\"]`,u=`if(!HasValue($feature, \"${n}\") || !HasValue($feature, \"${t}\") || $feature[\"${t}\"] <= 0){\\n        return 0;\\n      }\\n      $feature[\"${n}\"];\\n      $feature[\"${t}\"];`);const p={type:\"CIMExpressionInfo\",title:\"Size in pixels of outer ring\",expression:a?`\\n      ${u}\\n      var maxSize = ${c};\\n      var referenceScale = ${r.scale};\\n      return (maxSize * (referenceScale / $view.scale));\\n    `:`${u}\\n      return ${c}`,returnType:\"Default\"},f={type:\"CIMExpressionInfo\",title:\"Size in pixels of inner ring\",expression:`\\n        ${u}\\n        var value = ${y};\\n\\n        var referenceScale = ${r.scale};\\n        var referenceScaleRatio = ${a?\"(referenceScale / $view.scale)\":1};\\n        var maxSize = ${c} * referenceScaleRatio;\\n        var minSize = ${s} * referenceScaleRatio;\\n\\n        var minDataValue = ${l};\\n        var maxDataValue = ${m};\\n\\n        var ratio = Constrain(( value - minDataValue ) / ( maxDataValue - minDataValue ), 0, 1);\\n\\n        var innerDotSize = Constrain(maxSize * ratio, minSize, maxSize);\\n        return innerDotSize;\\n      `,returnType:\"Default\"};return[{type:\"CIMPrimitiveOverride\",primitiveName:o.OuterRing,propertyName:\"Size\",valueExpressionInfo:p},{type:\"CIMPrimitiveOverride\",primitiveName:o.InnerDot,propertyName:\"Size\",valueExpressionInfo:f}]}function s(e){switch(e){case\"circle\":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case\"square\":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case\"diamond\":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case\"hexagon-pointy\":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case\"hexagon-flat\":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function m(e){const{type:r,color:n,colorLocked:i}=e;return{type:\"CIMVectorMarker\",enable:!0,colorLocked:!1,anchorPoint:{x:0,y:0},anchorPointUnits:\"Relative\",primitiveName:o.OuterRing,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:s(r),symbol:{type:\"CIMPolygonSymbol\",symbolLayers:[{type:\"CIMSolidFill\",enable:!0,color:n.toArray(),colorLocked:!!i,effects:[{type:\"CIMGeometricEffectDonut\",width:.75}]}]}}],scaleSymbolsProportionally:!1,respectFrame:!0,markerPlacement:{type:\"CIMMarkerPlacementPolygonCenter\",placePerPart:!1,method:t.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:20}}function c(e){const{type:r,color:n}=e;return{type:\"CIMVectorMarker\",enable:!0,anchorPoint:{x:0,y:0},anchorPointUnits:\"Relative\",primitiveName:o.InnerDot,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:s(r),symbol:{type:\"CIMPolygonSymbol\",symbolLayers:[{type:\"CIMSolidFill\",enable:!0,color:n.toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,markerPlacement:{type:\"CIMMarkerPlacementPolygonCenter\",placePerPart:!1,method:t.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:10}}function u(e){const{primitiveOverrides:r}=e;return new i({data:{type:\"CIMSymbolReference\",symbol:{type:\"CIMPolygonSymbol\",symbolLayers:[m(e),c(e)]},primitiveOverrides:r}})}function y(e){return\"CIMVectorMarker\"===e?.type?e.markerGraphics?.[0]:void 0}function p(e){return\"CIMPolygonSymbol\"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function f(e,r){\"CIMVectorMarker\"===e?.type&&null!=r&&(e.size=r)}function v(e,r){const n=y(e);n&&null!=r&&(n.geometry=s(r))}function S(e,r){const n=p(y(e));n&&null!=r&&(n.color=r.toArray())}function z(e,r,n){const t=p(y(e));t&&null!=r&&n&&(t.colorLocked=r)}function d(e,n){const{outerRingSize:t,innerDotSize:i,type:a,color:l,colorLocked:s,primitiveOverrides:m}=n,c=\"CIMPolygonSymbol\"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===c?.length)for(const r of c){const e=r.primitiveName===o.OuterRing;f(r,e?t:i),v(r,a),S(r,l),z(r,s,e)}return null!=t&&null!=i&&(e.data.primitiveOverrides=null),void 0!==m&&(e.data.primitiveOverrides=r(m)),e}!function(e){e.OuterRing=\"reference-size-outer-ring\",e.InnerDot=\"reference-size-inner-dot\"}(o||(o={}));export{l as createPrimitiveOverrides,u as createReferenceSizeSymbol,a as getReferenceSizeStops,d as updateReferenceSizeSymbol};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../Color.js\";import{isSymbol3D as l}from\"../../../symbols.js\";import{round as t,numDigits as n,percentChange as o}from\"../../../renderers/support/numberUtils.js\";import{updateReferenceSizeSymbol as i}from\"../../../smartMapping/renderers/support/referenceSizeUtils.js\";import{applyCIMSymbolColor as s}from\"../../../symbols/support/cimSymbolUtils.js\";import{isVolumetricSymbol as r,getSymbolOutlineSize as a}from\"../../../symbols/support/utils.js\";import{getReferenceSizeAuthoringInfoVisualVariable as u,getSymbolForFlowRenderer as c,createStopLabel as m}from\"./utils.js\";import\"../../support/widgetUtils.js\";import{isDarkTheme as p}from\"../../../support/themeUtils.js\";import f from\"../../../symbols/SimpleMarkerSymbol.js\";import y from\"../../../symbols/SimpleLineSymbol.js\";const b=30,h=12,d=24,w=[255,255,255],S=[200,200,200],g=[128,128,128],v=20,z=5;function j(e){return\"esri.symbols.SimpleMarkerSymbol\"===e.declaredClass}function k(e){return\"esri.symbols.PictureMarkerSymbol\"===e.declaredClass}function V(e){return\"esri.symbols.SimpleLineSymbol\"===e.declaredClass}function x(e){return\"esri.symbols.TextSymbol\"===e.declaredClass}function I(e,l){const t=e.length-1;return e.map(((e,n)=>m(e,n,t,l)))}async function L(e,l,n,o,i,s,c){const m=l.legendOptions,p=m?.customValues,f=c||await D(e,n),y=l.stops,b=!!f,h=!!p,w=null!=l.minSize&&null!=l.maxSize,S=y&&y.length>1,g=!!l.target;if(!b||!h&&!(w||S&&!g))return;const v=r(f);let z=!1,j=null,k=null;j=v&&!S?t([l.minDataValue,l.maxDataValue]):p??await T(l,f,o,i?.type);const V=e?.authoringInfo,x=\"univariate-color-size\"===V?.type,L=x&&\"above-and-below\"===V?.univariateTheme,q=!!u(e);if(!j&&S&&(j=y.map((e=>e.value)),z=y.some((e=>!!e.label)),\"flow\"===e.type&&(j=t(j)),z&&(k=y.map((e=>e.label)))),v&&null!=j&&j?.length>2&&!L&&(j=[j[0],j[j.length-1]]),!j)return null;x&&5!==j?.length&&(j=P({minSize:j[0],maxSize:j[j.length-1]}));const B=v?U(e,j):null,E=a(f),R=z?null:I(j,s);return(await Promise.all(j.map((async(t,s)=>{const r=v?B[s]:await H(l,f,t,o,i?.type);return{value:t,symbol:!q||\"class-breaks\"!==e.type&&\"unique-value\"!==e.type?O(L&&\"class-breaks\"===e.type?C(e,s):f,r):M(e,r,l.maxSize,n)??f,label:z?k[s]:R[s],size:q?d:r,outlineSize:E}})))).reverse()}function U(e,l){const t=e?.authoringInfo,n=\"univariate-color-size\"===t?.type;let o=[h,b];if(n){const e=l[0],t=l[l.length-1],n=h,i=b;o=l.map((l=>n+(l-e)/(t-e)*(i-n)))}return n&&\"below\"===t?.univariateTheme&&o.reverse(),o}function M(l,t,n,o){const s=\"class-breaks\"===l.type,r=s?l.classBreakInfos?.[0]?.symbol?.clone():l.uniqueValueInfos?.[0]?.symbol?.clone();return r&&\"type\"in r&&\"cim\"===r.type?(i(r,{color:o??(s?null:new e(S)),innerDotSize:t*(d/n)||1,outerRingSize:d}),r):null}function C(e,l){const t=e.classBreakInfos,n=t.length,o=n<2||!(l>=2)?t[0].symbol.clone():t[n-1].symbol.clone(),i=e.visualVariables?.some((e=>\"color\"===e.type));return i&&(o.type.includes(\"3d\")?B(o):E(o)),o}async function D(e,l){if(\"flow\"===e.type)return c(e,l);if(\"pie-chart\"===e.type)return new f({color:null,outline:e.outline?.width?e.outline:new y});let t=null,n=null;if(\"simple\"===e.type)t=e.symbol;else if(\"class-breaks\"===e.type){const l=e.classBreakInfos;t=l&&l[0]&&l[0].symbol,n=l.length>1}else if(\"unique-value\"===e.type){const l=e.uniqueValueInfos;t=l?.[0]?.symbol,n=null!=l&&l.length>1}return!t||q(t)?null:(t=t.clone(),(l||n)&&(t.type.includes(\"3d\")?B(t):E(t)),t)}function q(e){if(e){if(l(e)){return!!e.symbolLayers&&e.symbolLayers.some((e=>e&&\"fill\"===e.type))}return e.type.includes(\"fill\")}return!1}function B(e){\"line-3d\"===e.type?e.symbolLayers.forEach((e=>{e.material={color:g}})):e.symbolLayers.forEach((e=>{\"icon\"!==e.type||e.resource?.href?e.material={color:S}:(e.material={color:w},e.outline={color:g,size:1.5})}))}function E(l){const t=p();if(\"cim\"===l.type)s(l,new e(S));else if(l.type.includes(\"line\"))l.color=g;else if(l.color=t?g:w,\"simple-marker\"===l.type)if(l.outline){const e=l.outline?.color?.toHex();\"#ffffff\"===e&&(l.outline.color=g)}else l.outline={color:g,width:1.5}}async function T(e,l,n,o){const i=(await import(/* webpackChunkName: \"renderers-visualVariables-support-visualVariableUtils\" */ \"../../../renderers/visualVariables/support/visualVariableUtils.js\")).getSizeRangeAtScale(e,n,o),s=i&&P(i);if(!i||!s)return;let r=s.map((l=>R(l,e,i)));r=t(r);for(let t=1;t<r.length-1;t++){const i=await A(e,l,r[t],r[t-1],n,o);i&&(r[t]=i[0],s[t]=i[1])}return r}function P(e){const l=e.minSize,t=e.maxSize,n=z,o=(t-l)/(n-1),i=[];for(let s=0;s<n;s++)i.push(l+o*s);return i}function R(e,l,t){const n=t.minSize,o=t.maxSize,i=l.minDataValue,s=l.maxDataValue;let r;if(e<=n)r=i;else if(e>=o)r=s;else{r=(e-n)/(o-n)*(s-i)+i}return r}async function A(e,l,i,s,r,a){const u=await H(e,l,i,r,a),c=await H(e,l,s,r,a),m=n(i),p=m.fractional,f=v;let y=m.integer,b=null,h=null;i>0&&i<1&&(b=10**p,y=n(i*=b).integer);for(let n=y-1;n>=0;n--){const s=10**n;let m=Math.floor(i/s)*s,p=Math.ceil(i/s)*s;null!=b&&(m/=b,p/=b);let y=(m+p)/2;[,y]=t([m,y,p],{indexes:[1]});const d=await H(e,l,m,r,a),w=await H(e,l,p,r,a),S=await H(e,l,y,r,a),g=o(u,d,c,null),v=o(u,w,c,null),z=o(u,S,c,null);let j=g.previous<=f,k=v.previous<=f;if(j&&k&&(g.previous<=v.previous?(j=!0,k=!1):(k=!0,j=!1)),j?h=[m,d]:k?h=[p,w]:z.previous<=f&&(h=[y,S]),h)break}return h}async function H(e,l,t,n,o){const{getSize:i}=await import(/* webpackChunkName: \"renderers-visualVariables-support-visualVariableUtils\" */ \"../../../renderers/visualVariables/support/visualVariableUtils.js\");return i(e,t,{scale:n,view:o,shape:\"simple-marker\"===l.type?l.style:null})}function O(e,t){const n=e.clone();if(l(n))r(n)||n.symbolLayers.forEach((e=>{\"fill\"!==e.type&&(e.size=t)}));else if(j(n))n.size=t;else if(k(n)){const e=n.width,l=n.height;n.height=t,n.width=t*(e/l)}else V(n)?n.width=t:x(n)&&n.font&&(n.font.size=t);return n}export{L as getRampStops,M as getReferenceSizeSymbol,b as realWorldMaxSize,h as realWorldMinSize};\n"],"names":["o","e","y","type","markerGraphics","p","symbol","symbolLayers","f","r","size","v","n","geometry","rings","s","S","color","toArray","z","t","colorLocked","d","outerRingSize","innerDotSize","i","a","l","primitiveOverrides","m","c","data","length","primitiveName","OuterRing","InnerDot","b","h","w","g","async","L","legendOptions","customValues","D","stops","minSize","maxSize","target","j","k","minDataValue","maxDataValue","getSizeRangeAtScale","P","map","R","A","T","V","authoringInfo","x","univariateTheme","q","value","some","label","B","U","E","I","Promise","all","H","O","C","M","outlineSize","reverse","classBreakInfos","clone","uniqueValueInfos","visualVariables","includes","outline","width","forEach","material","resource","href","toHex","push","u","fractional","integer","Math","floor","ceil","indexes","previous","getSize","scale","view","shape","style","declaredClass","height","font"],"sourceRoot":""}