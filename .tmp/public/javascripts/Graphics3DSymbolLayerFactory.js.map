{"version":3,"file":"Graphics3DSymbolLayerFactory.js","mappings":"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ACA;AACA;AACA;AAC2a,gBAAgB,oCAAoC,mBAAmB,UAAU,gEAAC,qBAAqB,kFAAC,0CAA0C,wFAAC,8CAA8C,oFAAC,gDAAgD,gFAAC,uDAAuD,oFAAC,mEAAmE,kEAAC;AAC1xB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gDAAgD;AAChD;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,8CAA8C;AAC9C;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wCAAwC;AACxC,wCAAwC;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,mBAAmB,gBAAgB;AACnC;AACA,oDAAoD;;AAEpD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAyC;;;;;;;;;;;;;;;;;;;;;;;;;;AC/GzC;AACA;AACA;AACA;AACmwB,gBAAgB,UAAU,4FAAC,cAAc,iDAAC,YAAY,6DAAC,gCAAgC,sFAAC,YAAY,mFAAC,IAAI,mBAAmB,UAAU,sEAAC,6RAA6R,uEAAC,6CAA6C,qEAAC,mUAAmU,kEAAC;AAC1hD;AACA;AACA;AACA,CAAC,sBAAsB,gFAAC,gFAAgF,gFAAC,8FAA8F,kEAAC;AACxM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,0CAA0C,gFAAC,sDAAsD,kEAAC;AACtK;AACA;AACA,sHAAsH,+CAA+C,oFAAC,0CAA0C,wFAAC,0EAA0E,gFAAC,sDAAsD,kEAAC;AACnV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,cAAc,kEAAC,+FAA+F,0DAA0D,kEAAC;AAClN,CAAC,cAAc,kEAAC;AAChB,CAAC,cAAc,kEAAC;AAChB,CAAC,GAAsB;;;;;;;;;;;;;;;;;;;;;;;;;;ACpEvB;AACA;AACA;AACA;AACitB,cAAc,4BAA4B,wFAAC,wCAAwC,wFAAC,oDAAoD,kFAAC,kBAAkB,mDAAC,yEAAyE,kFAAC,qBAAqB,wEAAC,qFAAqF,iEAAC,sBAAsB,kEAAC;AAC1jC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,GAAG,gBAAgB,+EAAC,EAAE,QAAQ,mFAAC,KAAK,mFAAC,GAAmE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrDzG;AACA;AACA;AACA;AACogC,MAAM,gBAAgB,MAAM,oBAAoB,GAAG,mBAAmB,kFAAC,yCAAyC,kFAAC,oGAAoG,yFAAC,uCAAuC,gBAAgB,MAAM,oBAAoB,GAAG,sFAAsF,iFAAC,6CAA6C,yFAAC,wEAAwE,gBAAgB,oBAAoB,wFAAC,oBAAoB,wFAAC,oCAAoC,wFAAC,kBAAkB,aAAa,yDAAC,IAAI,MAAM,oBAAoB,GAAG,+CAA+C,mEAAC;AAC3sD;AACA,CAAC,cAAc,mEAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,cAAc,mEAAC;AAChB;AACA,CAAC,cAAc,mEAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,cAAc,mEAAC;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,OAAO,oFAAC,I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","sources":["webpack://defra/./node_modules/@arcgis/core/chunks/ColorMaterial.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/HUDMaterial.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/HighlightApply.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/HighlightDownsample.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/HighlightToSingle.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/LineMarker.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/NativeLine.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/OverlayCompositing.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/Path.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/Pattern.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/SingleHighlightApply.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/SingleHighlightBlur.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/TextureOnly.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/WaterSurface.glsl.js","webpack://defra/./node_modules/@arcgis/core/chunks/earcut.js","webpack://defra/./node_modules/@arcgis/core/chunks/vec2.js","webpack://defra/./node_modules/@arcgis/core/chunks/vec3.js","webpack://defra/./node_modules/@arcgis/core/chunks/vec33.js","webpack://defra/./node_modules/@arcgis/core/chunks/vec4.js","webpack://defra/./node_modules/@arcgis/core/chunks/vec43.js","webpack://defra/./node_modules/@arcgis/core/core/BidiEngine.js","webpack://defra/./node_modules/@arcgis/core/core/BidiText.js","webpack://defra/./node_modules/@arcgis/core/core/NestedMap.js","webpack://defra/./node_modules/@arcgis/core/core/PriorityQueue.js","webpack://defra/./node_modules/@arcgis/core/core/bidiEngineTables.js","webpack://defra/./node_modules/@arcgis/core/core/devEnvironmentUtils.js","webpack://defra/./node_modules/@arcgis/core/core/fontUtils.js","webpack://defra/./node_modules/@arcgis/core/core/imageUtils.js","webpack://defra/./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat2df32.js","webpack://defra/./node_modules/@arcgis/core/core/libs/gl-matrix-2/factories/mat2f64.js","webpack://defra/./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat2.js","webpack://defra/./node_modules/@arcgis/core/core/libs/gl-matrix-2/math/mat2d.js","webpack://defra/./node_modules/@arcgis/core/core/libs/gl-matrix-2/types/mat4.js","webpack://defra/./node_modules/@arcgis/core/geometry/GeometryCursor.js","webpack://defra/./node_modules/@arcgis/core/geometry/projection/projectVectorToPoint.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/MeshComponent.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/MeshMaterial.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/MeshMaterialMetallicRoughness.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/MeshTexture.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/MeshTextureTransform.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/TileClipper.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/buffer/math/common.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/labelPoint.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/meshProperties.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/meshUtils/deduplicate.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/meshUtils/projectMeshVertexPositions.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/meshUtils/projection.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/meshUtils/vertexSpaceConversion.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/polygonUtils.js","webpack://defra/./node_modules/@arcgis/core/geometry/support/triangulationUtils.js","webpack://defra/./node_modules/@arcgis/core/layers/graphics/data/SnappingCandidate.js","webpack://defra/./node_modules/@arcgis/core/layers/graphics/sources/interfaces.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMCursor.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMEffects.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMImageColorSubstitutionHelper.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMOperators.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMPlacements.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMSymbolDrawHelper.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CIMSymbolHelper.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/CurveHelper.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/GeometryWalker.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/Rect.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/TextRasterizer.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectAddControlPoints.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectArrow.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectBuffer.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectControlMeasureLine.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectCut.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectDashes.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectDonut.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectJog.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectMove.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectOffset.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectReverse.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectRotate.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectScale.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/effects/EffectWave.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/imageUtils.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementAlongLineSameSize.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementAtExtremities.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementAtRatioPositions.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementInsidePolygon.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementOnLine.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementOnVertices.js","webpack://defra/./node_modules/@arcgis/core/symbols/cim/placements/PlacementPolygonCenter.js","webpack://defra/./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js","webpack://defra/./node_modules/@arcgis/core/symbols/support/gfxUtils.js","webpack://defra/./node_modules/@arcgis/core/symbols/support/utils.js","webpack://defra/./node_modules/@arcgis/core/symbols/support/webStyleSymbolUtils.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/svgUtils.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/vectorTiles/GeometryUtils.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/webgl/Rect.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/webgl/alignmentUtils.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/webgl/collisions/BoundingBox.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js","webpack://defra/./node_modules/@arcgis/core/views/2d/engine/webgl/mesh/templates/shapingUtils.js","webpack://defra/./node_modules/@arcgis/core/views/2d/layers/graphics/graphicsUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/Clouds.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/CloudsParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/CloudyWeather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/FoggyWeather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/RainyWeather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/SnowyWeather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/SunnyWeather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/environment/weather.js","webpack://defra/./node_modules/@arcgis/core/views/3d/glTF/DefaultLoadingContext.js","webpack://defra/./node_modules/@arcgis/core/views/3d/glTF/internal/TextureTransformUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/glTF/internal/indexUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/glTF/internal/resourceUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DDrapedGraphicLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DExtrudeSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DIconSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLineSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DLodInstanceGraphicLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshFillSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DMeshObject3DGraphicLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DObjectSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DPathSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DPolygonFillSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DSymbolLayerFactory.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DTextSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/Graphics3DWaterSymbolLayer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/LabelParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/MeshFastUpdateProcessor.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/ProcessedObjectResource.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/lineUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/lodResourceUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/meshAutoFastUpdateConstants.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/objectResourceUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/placementUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/polygonUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/webStyleUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/graphics/wosrLoader.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/support/patternUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/layers/support/uvUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/support/buffer/glUtil.js","webpack://defra/./node_modules/@arcgis/core/views/3d/support/engineContent/line.js","webpack://defra/./node_modules/@arcgis/core/views/3d/support/renderInfoUtils/line.js","webpack://defra/./node_modules/@arcgis/core/views/3d/support/renderInfoUtils/polygon.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/Intersector.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/Overlay.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/OverlayContent.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/OverlayFramebufferObject.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderTargets.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/terrain/interfaces.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/renderPasses/AllRenderPasses.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/attributes/PathVertexPosition.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/FoamRendering.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Gamma.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/ScreenSpaceReflections.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/WaterDistortion.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/terrain/Overlay.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/CloudsParallaxShading.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/TextureCubePassUniform.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/RenderPlugin.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/Highlight.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightApplyTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightDownsampleTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightPassParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/HighlightToSingleTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/SingleHighlightApplyTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/effects/highlight/SingleHighlightBlurTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/BindParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/CascadeCamera.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ChangeSet.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexBufferLayouts.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/FontMetrics.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterialRepository.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterials.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ModelDirtyTypes.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Normals.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Path.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathBuilder.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathCapBuilder.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathExtruder.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathGeometry.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathGeometryData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathProfile.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/PathVertex.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderContext.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ShadowMap.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/SortedRenderGeometryRenderer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextHelperCanvas.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextRenderParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextRenderer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextTextureAtlas.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextTextureFactory.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextureTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TextureTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Update.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexArrayObject.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/fov.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/BackedBufferObject.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/InstanceData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/InstanceOctree.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/Intersector.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LevelSelector.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodComponentData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodLevel.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodRenderer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/lodRendering/RenderInstanceData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/pathGeometryUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/lib/rendererUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultLayouts.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultMaterial_COLOR_GAMMA.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DrawParameters.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/HUDMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/LineMarkerMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/NativeLineMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/PathTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/PatternMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/PatternStyle.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ScaleInfo.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterGLMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterMaterial.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/WaterTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/waterMaterialUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/lineStippleUtils.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/BufferRange.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/DrawCommand.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/Instance.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/MergedRenderer.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/PerBufferData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/materials/renderers/PerOriginData.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ColorMaterialTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ColorMaterialTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/HUDMaterialTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/HUDMaterialTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LineMarkerTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/NativeLineTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/NativeLineTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/OverlayCompositingTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/PatternTechnique.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/PatternTechniqueConfiguration.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ToneMapping.glsl.js","webpack://defra/./node_modules/@arcgis/core/views/3d/webgl/RenderCamera.js","webpack://defra/./node_modules/@arcgis/core/views/webgl/BufferObject.js","webpack://defra/./node_modules/@arcgis/core/views/webgl/VertexArrayObject.js","webpack://defra/./node_modules/@arcgis/core/views/webgl/VertexElementDescriptor.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ObjectAndLayerIdColor as i}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js\";import{VertexColor as l}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{terrainDepthTest as s}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{VisualVariables as t}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as n}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float4PassUniform as a}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{glsl as g}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as c}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{VertexAttribute as v}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";import{outputColorHighlightOID as b}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";function m(m){const u=new c,{vertex:p,fragment:w,attributes:f,varyings:h}=u;n(p,m),u.include(o,m),u.include(l,m),u.include(t,m),u.include(i,m),u.include(r,m),u.include(b,m),f.add(v.POSITION,\"vec3\"),m.vvColor&&f.add(v.COLORFEATUREATTRIBUTE,\"float\"),h.add(\"vColor\",\"vec4\"),h.add(\"vpos\",\"vec3\");const C=m.terrainDepthTest&&m.output===e.Color;return C&&h.add(\"depth\",\"float\"),p.uniforms.add(new a(\"eColor\",(e=>e.color))),p.main.add(g`\n      vpos = position;\n      forwardNormalizedVertexColor();\n      forwardObjectAndLayerIdColor();\n\n      ${m.hasVertexColors?\"vColor *= eColor;\":m.vvColor?\"vColor = eColor * interpolateVVColor(colorFeatureAttribute);\":\"vColor = eColor;\"}\n      ${C?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      gl_Position = transformPosition(proj, view, vpos);`),u.include(r,m),C&&u.include(s,m),w.include(d),w.main.add(g`\n    discardBySlice(vpos);\n    ${C?\"terrainDepthTest(depth);\":\"\"}\n    vec4 fColor = vColor;\n    outputColorHighlightOID(fColor, vpos);`),u}const u=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:\"Module\"}));export{u as C,m as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{set as e,copy as o}from\"../core/libs/gl-matrix-2/math/vec2.js\";import{create as r}from\"../core/libs/gl-matrix-2/factories/vec2f64.js\";import{ZEROS as i,fromValues as t}from\"../core/libs/gl-matrix-2/factories/vec4f64.js\";import{earth as a}from\"../geometry/support/Ellipsoid.js\";import{ShaderOutput as l}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as s}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{ObjectAndLayerIdColor as n}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js\";import{AlignPixel as c}from\"../views/3d/webgl-engine/core/shaderLibrary/hud/AlignPixel.glsl.js\";import{HUD as d}from\"../views/3d/webgl-engine/core/shaderLibrary/hud/HUD.glsl.js\";import{HUDOcclusionPass as u}from\"../views/3d/webgl-engine/core/shaderLibrary/hud/HUDOcclusionPass.glsl.js\";import{HUDVisibility as p}from\"../views/3d/webgl-engine/core/shaderLibrary/hud/HUDVisibility.glsl.js\";import{OutputHighlight as f}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{VisualVariables as g}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{alphaCutoff as m}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as v}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{RgbaFloatEncoding as b}from\"../views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl.js\";import{ScreenSizePerspective as h,addScreenSizePerspective as w,addScreenSizePerspectiveAlignment as x}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ScreenSizePerspective.glsl.js\";import{addPixelRatio as C}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float2PassUniform as P}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{Float4DrawUniform as z}from\"../views/3d/webgl-engine/core/shaderModules/Float4DrawUniform.js\";import{Float4PassUniform as S}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as j}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as y,If as A}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as O}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as F}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{OITPass as $}from\"../views/3d/webgl-engine/lib/OITPass.js\";import{VertexAttribute as D}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";const L={occludedFadeFactor:.6};function T(o){const r=new O,T=o.signedDistanceFieldEnabled;if(r.include(d,o),r.include(s,o),o.occlusionPass)return r.include(u,o),r;const{vertex:M,fragment:H}=r;r.include(h),r.include(g,o),r.include(n,o),r.include(p),H.include(b),H.include(v),r.varyings.add(\"vcolor\",\"vec4\"),r.varyings.add(\"vtc\",\"vec2\"),r.varyings.add(\"vsize\",\"vec2\"),r.varyings.add(\"voccluded\",\"float\"),M.uniforms.add(new S(\"viewport\",((e,o)=>o.camera.fullViewport)),new P(\"screenOffset\",((o,r)=>e(R,2*o.screenOffset[0]*r.camera.pixelRatio,2*o.screenOffset[1]*r.camera.pixelRatio))),new P(\"anchorPosition\",(e=>E(e))),new S(\"materialColor\",(e=>e.color)),new j(\"materialRotation\",(e=>e.rotation))),C(M),T&&(M.uniforms.add(new S(\"outlineColor\",(e=>e.outlineColor))),H.uniforms.add(new S(\"outlineColor\",(e=>B(e)?e.outlineColor:i)),new j(\"outlineSize\",(e=>B(e)?e.outlineSize:0)))),o.horizonCullingEnabled&&M.uniforms.add(new z(\"pointDistanceSphere\",((e,o)=>{const r=o.camera.eye,i=e.origin;return t(i[0]-r[0],i[1]-r[1],i[2]-r[2],a.radius)}))),o.pixelSnappingEnabled&&M.include(c),o.hasScreenSizePerspective&&(w(M),x(M)),o.debugDrawLabelBorder&&r.varyings.add(\"debugBorderCoords\",\"vec4\"),r.attributes.add(D.UV0,\"vec2\"),r.attributes.add(D.COLOR,\"vec4\"),r.attributes.add(D.SIZE,\"vec2\"),r.attributes.add(D.ROTATION,\"float\"),r.attributes.add(D.FEATUREATTRIBUTE,\"vec4\"),M.code.add(o.horizonCullingEnabled?y`bool behindHorizon(vec3 posModel) {\nvec3 camToEarthCenter = pointDistanceSphere.xyz - localOrigin;\nvec3 camToPos = pointDistanceSphere.xyz + posModel;\nfloat earthRadius = pointDistanceSphere.w;\nfloat a = dot(camToPos, camToPos);\nfloat b = dot(camToPos, camToEarthCenter);\nfloat c = dot(camToEarthCenter, camToEarthCenter) - earthRadius * earthRadius;\nreturn  b > 0.0 && b < a && b * b  > a * c;\n}`:y`bool behindHorizon(vec3 posModel) { return false; }`),M.main.add(y`\n      ProjectHUDAux projectAux;\n      vec4 posProj = projectPositionHUD(projectAux);\n      forwardObjectAndLayerIdColor();\n\n      if (rejectBySlice(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n\n      if (behindHorizon(projectAux.posModel)) {\n        // Project outside of clip plane\n        gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n        return;\n      }\n\n      vec2 inputSize;\n      ${A(o.hasScreenSizePerspective,y`\n          inputSize = screenSizePerspectiveScaleVec2(size, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspective);\n          vec2 screenOffsetScaled = screenSizePerspectiveScaleVec2(screenOffset, projectAux.absCosAngle, projectAux.distanceToCamera, screenSizePerspectiveAlignment);`,y`\n          inputSize = size;\n          vec2 screenOffsetScaled = screenOffset;`)}\n      ${A(o.vvSize,y`inputSize *= vvScale(featureAttribute).xx;`)}\n\n      vec2 combinedSize = inputSize * pixelRatio;\n      vec4 quadOffset = vec4(0.0);\n      bool visible = testHUDVisibility(posProj);\n      voccluded = visible ? 0.0 : 1.0;\n    `);const U=y`\n      vec2 uv01 = floor(uv0);\n      vec2 uv = uv0 - uv01;\n      quadOffset.xy = (uv01 - anchorPosition) * 2.0 * combinedSize;\n\n      ${A(o.hasRotation,y`\n          float angle = radians(materialRotation + rotation);\n          float cosAngle = cos(angle);\n          float sinAngle = sin(angle);\n          mat2 rotate = mat2(cosAngle, -sinAngle, sinAngle,  cosAngle);\n\n          quadOffset.xy = rotate * quadOffset.xy;\n        `)}\n\n      quadOffset.xy = (quadOffset.xy + screenOffsetScaled) / viewport.zw * posProj.w;\n  `,V=o.pixelSnappingEnabled?T?y`posProj = alignToPixelOrigin(posProj, viewport.zw) + quadOffset;`:y`posProj += quadOffset;\nif (inputSize.x == size.x) {\nposProj = alignToPixelOrigin(posProj, viewport.zw);\n}`:y`posProj += quadOffset;`;M.main.add(y`\n    ${A(o.occlusionTestEnabled,y`\n      if (!visible) {\n        vtc = vec2(0.0);\n        ${A(o.debugDrawLabelBorder,\"debugBorderCoords = vec4(0.5, 0.5, 1.5 / combinedSize);\")}\n        return;\n      }`)}\n    ${U}\n    ${o.vvColor?\"vcolor = interpolateVVColor(featureAttribute.y) * materialColor;\":\"vcolor = color / 255.0 * materialColor;\"}\n\n    ${A(o.output===l.ObjectAndLayerIdColor,y`vcolor.a = 1.0;`)}\n\n    bool alphaDiscard = vcolor.a < ${y.float(m)};\n    ${A(T,`alphaDiscard = alphaDiscard && outlineColor.a < ${y.float(m)};`)}\n    if (alphaDiscard) {\n      // \"early discard\" if both symbol color (= fill) and outline color (if applicable) are transparent\n      gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n      return;\n    } else {\n      ${V}\n      gl_Position = posProj;\n    }\n\n    vtc = uv;\n\n    ${A(o.debugDrawLabelBorder,y`debugBorderCoords = vec4(uv01, 1.5 / combinedSize);`)}\n    vsize = inputSize;\n  `),H.uniforms.add(new F(\"tex\",(e=>e.texture))),o.occludedFragmentFade&&(H.uniforms.add(new F(\"depthMap\",((e,o)=>o.mainDepth))),H.uniforms.add(new j(\"fadeFactor\",(()=>L.occludedFadeFactor))));const _=o.debugDrawLabelBorder?y`(isBorder > 0.0 ? 0.0 : ${y.float(m)})`:y.float(m),I=o.output===l.Highlight,q=y`\n    ${A(o.debugDrawLabelBorder,y`float isBorder = float(any(lessThan(debugBorderCoords.xy, debugBorderCoords.zw)) || any(greaterThan(debugBorderCoords.xy, 1.0 - debugBorderCoords.zw)));`)}\n\n    ${A(o.sampleSignedDistanceFieldTexelCenter,y`\n      float txSize = float(textureSize(tex, 0).x);\n      float texelSize = 1.0 / txSize;\n\n      // Calculate how much we have to add/subtract to/from each texel to reach the size of an onscreen pixel\n      vec2 scaleFactor = (vsize - txSize) * texelSize;\n      vec2 samplePos = vtc + (vec2(1.0, -1.0) * texelSize) * scaleFactor;`,y`vec2 samplePos = vtc;`)}\n\n    ${T?y`\n      vec4 fillPixelColor = vcolor;\n\n      // Get distance and map it into [-0.5, 0.5]\n      float d = rgba2float(texture(tex, samplePos)) - 0.5;\n\n      // Distance in output units (i.e. pixels)\n      float dist = d * vsize.x;\n\n      // Create smooth transition from the icon into its outline\n      float fillAlphaFactor = clamp(0.5 - dist, 0.0, 1.0);\n      fillPixelColor.a *= fillAlphaFactor;\n\n      if (outlineSize > 0.25) {\n        vec4 outlinePixelColor = outlineColor;\n        float clampedOutlineSize = min(outlineSize, 0.5*vsize.x);\n\n        // Create smooth transition around outline\n        float outlineAlphaFactor = clamp(0.5 - (abs(dist) - 0.5*clampedOutlineSize), 0.0, 1.0);\n        outlinePixelColor.a *= outlineAlphaFactor;\n\n        if (\n          outlineAlphaFactor + fillAlphaFactor < ${_} ||\n          fillPixelColor.a + outlinePixelColor.a < ${y.float(m)}\n        ) {\n          discard;\n        }\n\n        // perform un-premultiplied over operator (see https://en.wikipedia.org/wiki/Alpha_compositing#Description)\n        float compositeAlpha = outlinePixelColor.a + fillPixelColor.a * (1.0 - outlinePixelColor.a);\n        vec3 compositeColor = vec3(outlinePixelColor) * outlinePixelColor.a +\n          vec3(fillPixelColor) * fillPixelColor.a * (1.0 - outlinePixelColor.a);\n\n        ${A(!I,y`fragColor = vec4(compositeColor, compositeAlpha);`)}\n      } else {\n        if (fillAlphaFactor < ${_}) {\n          discard;\n        }\n\n        ${A(!I,y`fragColor = premultiplyAlpha(fillPixelColor);`)}\n      }\n\n      // visualize SDF:\n      // fragColor = vec4(clamp(-dist/vsize.x*2.0, 0.0, 1.0), clamp(dist/vsize.x*2.0, 0.0, 1.0), 0.0, 1.0);\n      `:y`\n          vec4 texColor = texture(tex, vtc, -0.5);\n          if (texColor.a < ${_}) {\n            discard;\n          }\n          ${A(!I,y`fragColor = texColor * premultiplyAlpha(vcolor);`)}\n          `}\n\n    ${A(o.occludedFragmentFade&&!I,y`\n        float zSample = texelFetch(depthMap, ivec2(gl_FragCoord.xy), 0).x;\n        if (zSample < gl_FragCoord.z) {\n          fragColor *= fadeFactor;\n        }\n        `)}\n\n    ${A(!I&&o.debugDrawLabelBorder,y`fragColor = mix(fragColor, vec4(1.0, 0.0, 1.0, 1.0), isBorder * 0.5);`)}\n  `;switch(o.output){case l.Color:o.oitPass===$.ColorAlpha&&(r.outputs.add(\"fragColor\",\"vec4\",0),r.outputs.add(\"fragAlpha\",\"float\",1)),H.main.add(y`\n        ${q}\n        ${A(o.oitPass===$.FrontFace,y`fragColor.rgb /= fragColor.a;`)}\n        ${A(o.oitPass===$.ColorAlpha,y`fragAlpha = fragColor.a;`)}`);break;case l.ObjectAndLayerIdColor:H.main.add(y`\n        ${q}\n        outputObjectAndLayerIdColor();`);break;case l.Highlight:r.include(f,o),H.main.add(y`\n        ${q}\n        outputHighlight(voccluded == 1.0);`)}return r}function B(e){return e.outlineColor[3]>0&&e.outlineSize>0}function E(e,r=R){return e.textureIsSignedDistanceField?M(e.anchorPosition,e.distanceFieldBoundingBox,r):o(r,e.anchorPosition),r}function M(o,r,i){null!=r?e(i,o[0]*(r[2]-r[0])+r[0],o[1]*(r[3]-r[1])+r[1]):e(i,0,0)}const R=r(),H=Object.freeze(Object.defineProperty({__proto__:null,build:T,calculateAnchorPosForRendering:E,shaderSettings:L},Symbol.toStringTag,{value:\"Module\"}));export{H,T as b,E as c,L as s};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{HighlightCellGridScreenSpacePass as e}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js\";import{HighlightReadBitmap as l}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js\";import{FloatPassUniform as i}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{IntegerPassUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js\";import{glsl as o}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as n}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as a}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";function r(){const r=new n;r.include(e);const{fragment:c}=r;return c.uniforms.add(new a(\"highlightTexture\",(e=>e.highlightTexture)),new a(\"highlightOptionsTexture\",(e=>e.highlightOptionsTexture)),new i(\"pixelRatio\",(e=>e.pixelRatio)),new i(\"occludedIntensityFactor\",(e=>e.occludedFactor)),new t(\"maxHighlightLevel\",(e=>e.maxHighlightLevel))),c.constants.add(\"pixelSampleScale\",\"float\",1),r.include(l),c.code.add(o`const float pascal17[9] = float[9](12870.0, 11440.0, 8008.0, 4368.0, 1820.0, 560.0, 120.0, 16.0, 1.0);\nconst float denom17 =  65536.0;\nfloat colorWeight[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);\nfloat colorOcclusion[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);\nfloat weights[16] = float[16](0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0);\nvoid applyTexel(vec2 texel, float weight) {\nif (texel != vec2(0.0)){\nint maxChannel = (maxHighlightLevel >> 2) & 1;\nfor (int channelIndex = 0; channelIndex <= maxChannel; ++channelIndex){\nuint channel = readChannel(texel, channelIndex << 2);\nint firstIndex = channelIndex << 2;\nint maxIndex  = min(firstIndex + 3, maxHighlightLevel);\nfor (int highlightIndex = firstIndex; highlightIndex <= maxIndex; ++highlightIndex ) {\nuint v = readChannelBits(channel, highlightIndex);\nif ((v & 1u) == 1u){\ncolorWeight[highlightIndex] += weight;\nif ((v & 2u) == 2u){\ncolorOcclusion[highlightIndex] += weight;\n}\n}\n}\n}\n}\n}\nvec2 readTexel(ivec2 iuv, int du, int dv) {\nreturn texelFetch(highlightTexture, iuv + ivec2(du, dv), 0).rg;\n}\nvoid readAndApplyTexel(ivec2 iuv, int du, int dv, float weight) {\nvec2 texel = readTexel(iuv, du, dv);\napplyTexel(texel, weight);\n}\nvoid readAndApply2TexelsU(ivec2 iuv, int du, int dv, float weight) {\nreadAndApplyTexel(iuv, -du, dv, weight);\nreadAndApplyTexel(iuv, +du, dv, weight);\n}\nfloat getWeight(int pixelDistance) {\nfloat scaledDistance = float(pixelDistance) * pixelSampleScale / pixelRatio;\nfloat d0f = floor(scaledDistance);\nint d0 = int(d0f);\nif (d0 >= 8){\nreturn 0.0;\n}\nfloat w0 = pascal17[d0];\nfloat w1 = pascal17[d0+1];\nfloat f =  scaledDistance - d0f;\nreturn mix(w0, w1, f);\n}`),c.main.add(o`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));\nivec2 iuv = ivec2(sUV * highlightTextureSize);\nvec2 centerTexel = texelFetch(highlightTexture, iuv, 0).rg;\nbool outlinePossible = false;\nif (vOutlinePossible > 0.0){\nfor (int highlightLevel=0; highlightLevel<= maxHighlightLevel; ++highlightLevel) {\nif ((readLevelBits(centerTexel,highlightLevel) & 1u) == 0u) {\noutlinePossible = true;\nbreak;\n}\n}\n}\nif (outlinePossible) {\nint maxPixelDistance = clamp(int(8.0 * pixelRatio / pixelSampleScale), 2, 16);\nfloat weightSum = 0.0;\nfor(int y = 0; y <= maxPixelDistance; ++y) {\nfloat w = getWeight(y);\nweights[y] = w;\nweightSum += w * (y == 0 ? 1.0 : 2.0);\n}\nfor(int y = 0; y <= maxPixelDistance; ++y) {\nweights[y] = weights[y] / weightSum;\n}\nfloat weight0 = weights[0];\napplyTexel(centerTexel, weight0 * weight0);\nfor(int y = 0; y <= maxPixelDistance; y += 1) {\nfloat yFactor = weights[y];\nif (y != 0) {\nfloat xFactor = weight0;\nfloat weight = xFactor * yFactor;\nif (weight > 0.0) {\nreadAndApplyTexel(iuv, 0, +y, weight);\nreadAndApplyTexel(iuv, 0, -y, weight);\n}\n}\nfor(int x = 1; x <= maxPixelDistance; x += 1) {\nfloat xFactor = weights[x];\nfloat weight = xFactor * yFactor;\nif (weight > 0.0) {\nreadAndApply2TexelsU(iuv, x, +y, weight);\nif (y != 0){\nreadAndApply2TexelsU(iuv, x, -y, weight);\n}\n}\n}\n}\n} else {\napplyTexel(centerTexel, 1.0);\n}\nint frontColorIndex = 999;\nint maxColorIndex = 0;\nfor (int i = 0; i <= maxHighlightLevel; ++i) {\nif (colorWeight[i] > 0.0){\nfrontColorIndex = min(frontColorIndex, i);\nmaxColorIndex = max(maxColorIndex, i);\n}\n}\nif (frontColorIndex == 999){\nfragColor = vec4(0.0);\nreturn;\n}\nvec4 accumulatedColor = vec4(0.0);\nfor (int curColorIndex = frontColorIndex; curColorIndex <= maxColorIndex; ++curColorIndex) {\nfloat curColorWeight = colorWeight[curColorIndex];\nif (curColorWeight <= 0.01){\ncontinue;\n}\nuint vc = readLevelBits(centerTexel, curColorIndex);\nbool centerFilled = (vc & 1u) == 1u;\nbool centerOccluded = (vc & 3u) == 3u;\nfloat curColorOcclusion = colorOcclusion[curColorIndex];\nbool occluded = centerFilled ? centerOccluded : curColorOcclusion > 0.5 * curColorWeight;\nint colorChannel = centerFilled ? 0 : 1;\nvec4 colorBase = texelFetch(highlightOptionsTexture, ivec2(curColorIndex, colorChannel), 0);\nfloat occlusionFactor = occluded ? occludedIntensityFactor : 1.0;\nfloat outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, 0.03, curColorWeight);\nfloat intensity = colorBase.a * occlusionFactor * outlineFactor;\nvec3 currentColor = colorBase.rgb;\nfloat a0 = accumulatedColor.a;\nfloat a1 = intensity;\nfloat alpha = clamp(a0 + a1 - a0 * a1, 0.0, 1.0);\nif (alpha > 0.001){\nvec3 blendedColor = ((1.0 - a1) * a0 * accumulatedColor.rgb + a1 * currentColor) / alpha;\naccumulatedColor = vec4(blendedColor, alpha);\n}\n}\nfragColor = accumulatedColor;`),r}const c=Object.freeze(Object.defineProperty({__proto__:null,build:r},Symbol.toStringTag,{value:\"Module\"}));export{c as H,r as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ScreenSpacePass as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js\";import{NoParameters as r,glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as i}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DDrawUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js\";class o extends r{}function a(){const r=new i,{outputs:o,fragment:a}=r;return r.include(e),a.uniforms.add(new n(\"textureInput\",(e=>e.input))),a.constants.add(\"outlineWidth\",\"int\",Math.ceil(c)),a.constants.add(\"cellSize\",\"int\",l),o.add(\"fragGrid\",\"vec2\"),a.main.add(t`vec2 inputTextureSize = vec2(textureSize(textureInput, 0));\nvec2 cellBottomLeftCornerInput = floor(gl_FragCoord.xy) * vec2(cellSize);\nvec2 coordMid =  (cellBottomLeftCornerInput + 0.5 * vec2(cellSize)) / inputTextureSize;\nvec2 commonValue = texture(textureInput, coordMid).rg;\nint margin = outlineWidth;\nfloat marginSquare = float(margin*margin);\nfor(int y = -margin; y <= cellSize + margin; y+=2) {\nint dy = y < 0 ? -y : y > cellSize ? y-cellSize : 0;\nint xMargin = dy > 0 ? int(ceil(sqrt(marginSquare - float(dy*dy)))) : margin;\nfor(int x = -xMargin; x <= cellSize + xMargin; x+=2) {\nvec2 coord = (cellBottomLeftCornerInput + vec2(x, y)) / inputTextureSize;\nvec2 value = texture(textureInput, coord).rg;\nif (value != commonValue){\nfragGrid = vec2(1.0, 1.0);\nreturn;\n}\n}\n}\nbool hasAny = commonValue != vec2(0.0);\nfragGrid = vec2(hasAny ? 1.0 : 0.0, 0.0);`),r}const l=32,c=9,u=.4,d=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:o,blurSize:u,build:a,gridCellPixelSize:l,outlineSize:c},Symbol.toStringTag,{value:\"Module\"}));export{o as H,d as a,u as b,a as c,l as g,c as o};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{HighlightCellGridScreenSpacePass as e}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js\";import{HighlightReadBitmap as i}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js\";import{IntegerPassUniform as l}from\"../views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js\";import{glsl as r}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as g}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";function h(){const h=new g;h.include(e),h.include(i);const{fragment:s}=h;return h.outputs.add(\"fragSingleHighlight\",\"vec2\",0),s.uniforms.add(new t(\"highlightTexture\",(e=>e.highlightTexture)),new l(\"maxHighlightLevel\",(e=>e.maxHighlightLevel)),new l(\"highlightLevel\",(e=>e.highlightLevel))),h.include(i),s.main.add(r`ivec2 iuv = ivec2(gl_FragCoord.xy);\nvec2 inputTexel = texelFetch(highlightTexture, iuv, 0).rg;\nuint bits = readLevelBits(inputTexel, highlightLevel);\nbool hasHighlight = (bits & 1u) == 1u;\nbool hasOccluded  = (bits & 2u) == 2u;\nfragSingleHighlight = vec2(hasHighlight ? 1.0 : 0.0, hasOccluded ? 1.0 : 0.0);`),h}const s=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:\"Module\"}));export{s as H,h as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{markerTextureSize as e,markerSymbolSize as r,markerTipThicknessFactor as i}from\"../views/3d/support/engineContent/marker.js\";import{ShaderOutput as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{RibbonVertexPosition as t}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/RibbonVertexPosition.glsl.js\";import{OutputHighlight as n}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{MarkerSizing as s}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MarkerSizing.glsl.js\";import{terrainDepthTest as c}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{RgbaFloatEncoding as p}from\"../views/3d/webgl-engine/core/shaderLibrary/util/RgbaFloatEncoding.glsl.js\";import{addProjViewLocalOrigin as d,addViewNormal as v,addPixelRatio as m}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float2PassUniform as h}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{Float4PassUniform as f}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as g}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as u}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{Matrix4PassUniform as w}from\"../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform.js\";import{ShaderBuilder as S}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as y}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{VertexAttribute as b}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";import{LineMarkerSpace as P,LineMarkerAnchor as x}from\"../views/3d/webgl-engine/shaders/LineMarkerTechniqueConfiguration.js\";import{outputColorHighlightOID as z}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";function j(j){const L=new S,k=j.terrainDepthTest&&j.output===o.Color,M=j.space===P.World;L.include(t,j),L.include(s,j);const{vertex:N,fragment:C}=L;return C.include(p),d(N,j),L.attributes.add(b.POSITION,\"vec3\"),L.attributes.add(b.PREVPOSITION,\"vec3\"),L.attributes.add(b.UV0,\"vec2\"),L.varyings.add(\"vColor\",\"vec4\"),L.varyings.add(\"vpos\",\"vec3\"),L.varyings.add(\"vUV\",\"vec2\"),L.varyings.add(\"vSize\",\"float\"),k&&L.varyings.add(\"depth\",\"float\"),j.hasTip&&L.varyings.add(\"vLineWidth\",\"float\"),N.uniforms.add(new h(\"nearFar\",((e,r)=>r.camera.nearFar)),new f(\"viewport\",((e,r)=>r.camera.fullViewport))),N.code.add(u`vec4 projectAndScale(vec4 pos) {\nvec4 posNdc = proj * pos;\nposNdc.xy *= viewport.zw / posNdc.w;\nreturn posNdc;\n}`),N.code.add(u`void clip(vec4 pos, inout vec4 prev) {\nfloat vnp = nearFar[0] * 0.99;\nif (prev.z > -nearFar[0]) {\nfloat interpolation = (-vnp - pos.z) / (prev.z - pos.z);\nprev = mix(pos, prev, interpolation);\n}\n}`),M?(L.attributes.add(b.NORMAL,\"vec3\"),v(N),N.constants.add(\"tiltThreshold\",\"float\",.7),N.code.add(u`vec3 perpendicular(vec3 v) {\nvec3 n = (viewNormal * vec4(normal.xyz, 1.0)).xyz;\nvec3 n2 = cross(v, n);\nvec3 forward = vec3(0.0, 0.0, 1.0);\nfloat tiltDot = dot(forward, n);\nreturn abs(tiltDot) < tiltThreshold ? n : n2;\n}`)):N.code.add(u`vec2 perpendicular(vec2 v) {\nreturn vec2(v.y, -v.x);\n}`),N.code.add(u`\n      #define vecN ${M?\"vec3\":\"vec2\"}\n\n      vecN normalizedSegment(vecN pos, vecN prev) {\n        vecN segment = pos - prev;\n        float segmentLen = length(segment);\n\n        // normalize or zero if too short\n        return (segmentLen > 0.001) ? segment / segmentLen : ${M?\"vec3(0.0, 0.0, 0.0)\":\"vec2(0.0, 0.0)\"};\n      }\n\n      vecN displace(vecN pos, vecN prev, float displacementLen) {\n        vecN segment = normalizedSegment(pos, prev);\n\n        vecN displacementDirU = perpendicular(segment);\n        vecN displacementDirV = segment;\n\n        ${j.anchor===x.Tip?\"pos -= 0.5 * displacementLen * displacementDirV;\":\"\"}\n\n        return pos + displacementLen * (uv0.x * displacementDirU + uv0.y * displacementDirV);\n      }\n    `),j.space===P.Screen&&(N.uniforms.add(new w(\"inverseProjectionMatrix\",((e,r)=>r.camera.inverseProjectionMatrix))),N.code.add(u`vec3 inverseProject(vec4 posScreen) {\nposScreen.xy = (posScreen.xy / viewport.zw) * posScreen.w;\nreturn (inverseProjectionMatrix * posScreen).xyz;\n}`),N.code.add(u`bool rayIntersectPlane(vec3 rayDir, vec3 planeOrigin, vec3 planeNormal, out vec3 intersection) {\nfloat cos = dot(rayDir, planeNormal);\nfloat t = dot(planeOrigin, planeNormal) / cos;\nintersection = t * rayDir;\nreturn abs(cos) > 0.001 && t > 0.0;\n}`),N.uniforms.add(new g(\"perScreenPixelRatio\",((e,r)=>r.camera.perScreenPixelRatio))),N.code.add(u`\n      vec4 toFront(vec4 displacedPosScreen, vec3 posLeft, vec3 posRight, vec3 prev, float lineWidth) {\n        // Project displaced position back to camera space\n        vec3 displacedPos = inverseProject(displacedPosScreen);\n\n        // Calculate the plane that we want the marker to lie in. Note that this will always be an approximation since ribbon lines are generally\n        // not planar and we do not know the actual position of the displaced prev vertices (they are offset in screen space, too).\n        vec3 planeNormal = normalize(cross(posLeft - posRight, posLeft - prev));\n        vec3 planeOrigin = posLeft;\n\n        ${j.hasCap?\"\\n                if(prev.z > posLeft.z) {\\n                  vec2 diff = posLeft.xy - posRight.xy;\\n                  planeOrigin.xy += perpendicular(diff) / 2.0;\\n                }\\n              \":\"\"};\n\n        // Move the plane towards the camera by a margin dependent on the line width (approximated in world space). This tolerance corrects for the\n        // non-planarity in most cases, but sharp joins can place the prev vertices at arbitrary positions so markers can still clip.\n        float offset = lineWidth * perScreenPixelRatio;\n        planeOrigin *= (1.0 - offset);\n\n        // Intersect camera ray with the plane and make sure it is within clip space\n        vec3 rayDir = normalize(displacedPos);\n        vec3 intersection;\n        if (rayIntersectPlane(rayDir, planeOrigin, planeNormal, intersection) && intersection.z < -nearFar[0] && intersection.z > -nearFar[1]) {\n          return vec4(intersection.xyz, 1.0);\n        }\n\n        // Fallback: use depth of pos or prev, whichever is closer to the camera\n        float minDepth = planeOrigin.z > prev.z ? length(planeOrigin) : length(prev);\n        displacedPos *= minDepth / length(displacedPos);\n        return vec4(displacedPos.xyz, 1.0);\n      }\n  `)),m(N),N.main.add(u`\n    // Check for special value of uv0.y which is used by the Renderer when graphics\n    // are removed before the VBO is recompacted. If this is the case, then we just\n    // project outside of clip space.\n    if (uv0.y == 0.0) {\n      // Project out of clip space\n      gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n    else {\n      float lineWidth = getLineWidth();\n      float screenMarkerSize = getScreenMarkerSize();\n\n      vec4 pos  = view * vec4(position, 1.0);\n      vec4 prev = view * vec4(prevPosition, 1.0);\n      clip(pos, prev);\n\n      ${M?u`${j.hideOnShortSegments?u`\n                  if (areWorldMarkersHidden(pos, prev)) {\n                    // Project out of clip space\n                    gl_Position = vec4(1e038, 1e038, 1e038, 1.0);\n                    return;\n                  }`:\"\"}\n            pos.xyz = displace(pos.xyz, prev.xyz, getWorldMarkerSize(pos));\n            vec4 displacedPosScreen = projectAndScale(pos);`:u`\n            vec4 posScreen = projectAndScale(pos);\n            vec4 prevScreen = projectAndScale(prev);\n            vec4 displacedPosScreen = posScreen;\n\n            displacedPosScreen.xy = displace(posScreen.xy, prevScreen.xy, screenMarkerSize);\n            ${j.space===P.Screen?u`\n                vec2 displacementDirU = perpendicular(normalizedSegment(posScreen.xy, prevScreen.xy));\n\n                // We need three points of the ribbon line in camera space to calculate the plane it lies in\n                // Note that we approximate the third point, since we have no information about the join around prev\n                vec3 lineRight = inverseProject(posScreen + lineWidth * vec4(displacementDirU.xy, 0.0, 0.0));\n                vec3 lineLeft = pos.xyz + (pos.xyz - lineRight);\n\n                pos = toFront(displacedPosScreen, lineLeft, lineRight, prev.xyz, lineWidth);\n                displacedPosScreen = projectAndScale(pos);`:\"\"}`}\n\n      ${k?\"depth = pos.z;\":\"\"}\n\n      // Convert back into NDC\n      displacedPosScreen.xy = (displacedPosScreen.xy / viewport.zw) * displacedPosScreen.w;\n\n      // Convert texture coordinate into [0,1]\n      vUV = (uv0 + 1.0) / 2.0;\n      ${M?\"\":\"vUV *= displacedPosScreen.w;\"}\n      ${j.hasTip?\"vLineWidth = lineWidth;\":\"\"}\n\n      vSize = screenMarkerSize;\n      vColor = getColor();\n\n      // Use camera space for slicing\n      vpos = pos.xyz;\n\n      gl_Position = displacedPosScreen;\n    }`),k&&L.include(c,j),L.include(a,j),L.include(z,j),C.uniforms.add(new f(\"intrinsicColor\",(e=>e.color)),new y(\"tex\",(e=>e.markerTexture))),C.include(l),C.constants.add(\"texelSize\",\"float\",1/e),C.code.add(u`float markerAlpha(vec2 samplePos) {\nsamplePos += vec2(0.5, -0.5) * texelSize;\nfloat sdf = rgba2float(texture(tex, samplePos)) - 0.5;\nfloat distance = sdf * vSize;\ndistance -= 0.5;\nreturn clamp(0.5 - distance, 0.0, 1.0);\n}`),j.hasTip&&C.constants.add(\"relativeMarkerSize\",\"float\",r/e).constants.add(\"relativeTipLineWidth\",\"float\",i).code.add(u`\n    float tipAlpha(vec2 samplePos) {\n      // Convert coordinates s.t. they are in pixels and relative to the tip of an arrow marker\n      samplePos -= vec2(0.5, 0.5 + 0.5 * relativeMarkerSize);\n      samplePos *= vSize;\n\n      float halfMarkerSize = 0.5 * relativeMarkerSize * vSize;\n      float halfTipLineWidth = 0.5 * max(1.0, relativeTipLineWidth * vLineWidth);\n\n      ${M?\"halfTipLineWidth *= fwidth(samplePos.y);\":\"\"}\n\n      float distance = max(abs(samplePos.x) - halfMarkerSize, abs(samplePos.y) - halfTipLineWidth);\n      return clamp(0.5 - distance, 0.0, 1.0);\n    }\n  `),L.include(n,j),C.main.add(u`\n    discardBySlice(vpos);\n    ${k?\"terrainDepthTest(depth);\":\"\"}\n\n    vec4 finalColor = intrinsicColor * vColor;\n    ${M?\"vec2 samplePos = vUV;\":\"vec2 samplePos = vUV * gl_FragCoord.w;\"}\n    ${j.hasTip?\"finalColor.a *= max(markerAlpha(samplePos), tipAlpha(samplePos));\":\"finalColor.a *= markerAlpha(samplePos);\"}\n    outputColorHighlightOID(finalColor, vpos);`),L}const L=Object.freeze(Object.defineProperty({__proto__:null,build:j},Symbol.toStringTag,{value:\"Module\"}));export{L,j as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{VertexColor as i}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{OutputHighlight as s}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{alphaCutoff as t}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{addProjViewLocalOrigin as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float4PassUniform as a}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as d}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as c}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{VertexAttribute as g}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";function m(m){const u=new c,{vertex:p,fragment:w}=u;return u.include(o,m),u.include(i,m),l(p,m),u.attributes.add(g.POSITION,\"vec3\"),u.varyings.add(\"vpos\",\"vec3\"),p.main.add(d`vpos = position;\nforwardNormalizedVertexColor();\ngl_Position = transformPosition(proj, view, vpos);`),u.include(s,m),u.include(r,m),w.uniforms.add(new n(\"alphaCoverage\",((e,r)=>Math.min(1,e.width*r.camera.pixelRatio)))),m.hasVertexColors||w.uniforms.add(new a(\"constantColor\",(e=>e.color))),w.main.add(d`\n    discardBySlice(vpos);\n\n    vec4 color = ${m.hasVertexColors?\"vColor\":\"constantColor\"};\n\n    ${m.output===e.ObjectAndLayerIdColor?\"color.a = 1.0;\":\"\"}\n\n    if (color.a < ${d.float(t)}) {\n      discard;\n    }\n\n    ${m.output===e.Color?d`fragColor = highlightSlice(color, vpos);`:\"\"}\n    calculateOcclusionAndOutputHighlight();\n  `),u}const u=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:\"Module\"}));export{u as N,m as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{OverlayIndex as e}from\"../views/3d/terrain/interfaces.js\";import{ScreenSpacePass as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js\";import{FloatPassUniform as o}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{IntegerPassUniform as s}from\"../views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js\";import{NoParameters as a,glsl as n}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as i}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";class d extends a{constructor(){super(...arguments),this.overlayIndex=e.INNER,this.opacity=1}}function l(){const e=new i;return e.include(r),e.fragment.uniforms.add(new t(\"tex\",(e=>e.texture))),e.fragment.uniforms.add(new s(\"overlayIdx\",(e=>e.overlayIndex))),e.fragment.uniforms.add(new o(\"opacity\",(e=>e.opacity))),e.fragment.main.add(n`vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);\nfragColor = texture(tex, overlayUV) * opacity;`),e}const m=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:d,build:l},Symbol.toStringTag,{value:\"Module\"}));export{d as O,m as a,l as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ForwardLinearDepth as e,addNearFar as i}from\"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";import{isColorOrColorEmission as a,ShaderOutput as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as n}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ObjectAndLayerIdColor as l}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js\";import{PathVertexPosition as s}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/PathVertexPosition.glsl.js\";import{OutputDepth as d}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputDepth.glsl.js\";import{OutputHighlight as t}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{EvaluateAmbientOcclusion as c}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientOcclusion.glsl.js\";import{EvaluateSceneLighting as g,addAmbientBoostFactor as m,addLightingGlobalFactor as h}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateSceneLighting.glsl.js\";import{addMainLightIntensity as v}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js\";import{Normals as p}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/Normals.glsl.js\";import{NormalUtils as u}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl.js\";import{PhysicallyBasedRenderingParameters as b,PBRMode as w}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{ReadShadowMapDraw as f}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{terrainDepthTest as y}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{ColorConversion as j}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as L,addViewNormal as P,addCameraPosition as S}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float3PassUniform as O}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{FloatPassUniform as C}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as D,If as A}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as I}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{outputColorHighlightOID as F}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";function B(B){const _=new I,{vertex:M,fragment:V}=_;L(M,B),_.varyings.add(\"vpos\",\"vec3\"),_.include(s,B);const{output:z,spherical:T,pbrMode:x,receiveShadows:H}=B,N=a(z);switch((N||z===o.ObjectAndLayerIdColor)&&(_.include(n,B),_.include(f,B),_.include(e,B),_.include(l,B),_.varyings.add(\"vnormal\",\"vec3\"),_.varyings.add(\"vcolor\",\"vec4\"),B.terrainDepthTest&&_.varyings.add(\"depth\",\"float\"),M.main.add(D`\n      vpos = calculateVPos();\n      vnormal = normalize(localNormal());\n\n      ${B.terrainDepthTest?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      gl_Position = transformPosition(proj, view, vpos);\n\n      ${N?\"forwardLinearDepth();\":\"\"}\n      forwardObjectAndLayerIdColor();\n\n      vcolor = getColor();`)),_.include(y,B),z){case o.ColorEmission:case o.Color:_.include(b,B),_.include(g,B),_.include(c,B),_.include(f,B),_.include(p,B),_.include(r,B),_.include(F,B),S(V,B),m(V),h(V),V.uniforms.add(M.uniforms.get(\"localOrigin\"),new O(\"ambient\",(e=>e.ambient)),new O(\"diffuse\",(e=>e.diffuse)),new O(\"specular\",(e=>e.specular)),new C(\"opacity\",(e=>e.opacity))),V.include(j),v(V),V.main.add(D`\n        discardBySlice(vpos);\n        ${B.terrainDepthTest?D`terrainDepthTest(depth);`:\"\"}\n\n        shadingParams.viewDirection = normalize(vpos - cameraPosition);\n        shadingParams.normalView = vnormal;\n        vec3 normal = shadingNormal(shadingParams);\n        float ssao = evaluateAmbientOcclusionInverse();\n\n        vec3 posWorld = vpos + localOrigin;\n        vec3 normalGround = ${T?\"normalize(posWorld);\":\"vec3(0.0, 0.0, 1.0);\"}\n\n        float additionalAmbientScale = additionalDirectedAmbientLight(posWorld);\n        vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;\n        float shadow = ${H?\"max(lightingGlobalFactor * (1.0 - additionalAmbientScale), readShadowMap(vpos, linearDepth));\":T?\"lightingGlobalFactor * (1.0 - additionalAmbientScale);\":\"0.0;\"}\n        vec3 albedo = vcolor.rgb * max(ambient, diffuse); // combine the old material parameters into a single one\n        float combinedOpacity = vcolor.a * opacity;\n        albedo += 0.25 * specular; // don't completely ignore specular for now\n\n        ${A(x===w.Schematic,\"float additionalAmbientIrradiance = additionalAmbientIrradianceFactor * mainLightIntensity[2];\\n           vec4 emission = getEmissions();\")}\n\n        vec3 shadedColor = ${x===w.Schematic?\"evaluateSceneLightingPBR(normal, albedo, shadow, 1.0 - ssao, additionalLight, shadingParams.viewDirection, normalGround, mrr, emission, additionalAmbientIrradiance);\":\"evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight);\"}\n        vec4 finalColor = vec4(shadedColor, combinedOpacity);\n        outputColorHighlightOID(finalColor, vpos);`);break;case o.Depth:_.include(n,B),M.main.add(D`vpos = calculateVPos();\ngl_Position = transformPosition(proj, view, vpos);`),_.include(r,B),V.main.add(D`discardBySlice(vpos);`);break;case o.Shadow:case o.ShadowHighlight:case o.ShadowExcludeHighlight:case o.ViewshedShadow:_.include(n,B),i(_),_.varyings.add(\"depth\",\"float\"),M.main.add(D`vpos = calculateVPos();\ngl_Position = transformPositionWithDepth(proj, view, vpos, nearFar, depth);`),_.include(r,B),_.include(d,B),V.main.add(D`discardBySlice(vpos);\noutputDepth(depth);`);break;case o.ObjectAndLayerIdColor:_.include(r,B),V.main.add(D`discardBySlice(vpos);\noutputObjectAndLayerIdColor();`);break;case o.Normal:_.include(n,B),_.include(u,B),P(M),_.varyings.add(\"vnormal\",\"vec3\"),M.main.add(D`vpos = calculateVPos();\nvnormal = normalize((viewNormal * vec4(localNormal(), 1.0)).xyz);\ngl_Position = transformPosition(proj, view, vpos);`),_.include(r,B),V.main.add(D`discardBySlice(vpos);\nvec3 normal = normalize(vnormal);\nif (gl_FrontFacing == false) normal = -normal;\nfragColor = vec4(vec3(0.5) + 0.5 * normal, 1.0);`);break;case o.Highlight:_.include(n,B),_.include(u,B),_.varyings.add(\"vnormal\",\"vec3\"),M.main.add(D`vpos = calculateVPos();\ngl_Position = transformPosition(proj, view, vpos);`),_.include(r,B),_.include(t,B),V.main.add(D`discardBySlice(vpos);\ncalculateOcclusionAndOutputHighlight();`)}return _}const _=Object.freeze(Object.defineProperty({__proto__:null,build:B},Symbol.toStringTag,{value:\"Module\"}));export{_ as P,B as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as r}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ObjectAndLayerIdColor as t}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js\";import{VertexColor as a}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/VertexColor.glsl.js\";import{terrainDepthTest as i}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{VisualVariables as n}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/VisualVariables.glsl.js\";import{ColorConversion as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as c,addCameraPosition as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float4PassUniform as s}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as v}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as p}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as g}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{VertexAttribute as m}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";import{Style as u}from\"../views/3d/webgl-engine/materials/PatternStyle.js\";import{outputColorHighlightOID as f}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";const w=.70710678118,h=w,b=.08715574274,y=10,S=1;function j(j){const C=new g,{vertex:T,fragment:P,attributes:R,varyings:V}=C,D=j.terrainDepthTest&&j.output===e.Color,$=j.output===e.Highlight;c(T,j),C.include(r,j),C.include(a,j),C.include(n,j),C.include(t,j),C.include(o,j),C.include(f,j),j.draped?T.uniforms.add(new v(\"worldToScreenRatio\",((e,o)=>1/o.screenToPCSRatio))):R.add(m.BOUNDINGRECT,\"mat3\"),R.add(m.POSITION,\"vec3\"),R.add(m.UVMAPSPACE,\"vec4\"),j.vvColor&&R.add(m.COLORFEATUREATTRIBUTE,\"float\"),V.add(\"vColor\",\"vec4\"),V.add(\"vpos\",\"vec3\"),V.add(\"vuv\",\"vec2\"),D&&V.add(\"depth\",\"float\"),T.uniforms.add(new s(\"uColor\",(e=>e.color)));const O=j.style===u.ForwardDiagonal||j.style===u.BackwardDiagonal||j.style===u.DiagonalCross;return O&&T.code.add(p`\n      const mat2 rotate45 = mat2(${p.float(w)}, ${p.float(-h)},\n                                 ${p.float(h)}, ${p.float(w)});\n    `),j.draped||(d(T,j),T.uniforms.add(new v(\"worldToScreenPerDistanceRatio\",((e,o)=>1/o.camera.perScreenPixelRatio))),T.code.add(p`vec3 projectPointToLineSegment(vec3 center, vec3 halfVector, vec3 point) {\nfloat projectedLength = dot(halfVector, point - center) / dot(halfVector, halfVector);\nreturn center + halfVector * clamp(projectedLength, -1.0, 1.0);\n}`),T.code.add(p`vec3 intersectRayPlane(vec3 rayDir, vec3 rayOrigin, vec3 planeNormal, vec3 planePoint) {\nfloat d = dot(planeNormal, planePoint);\nfloat t = (d - dot(planeNormal, rayOrigin)) / dot(planeNormal, rayDir);\nreturn rayOrigin + t * rayDir;\n}`),T.code.add(p`\n      float boundingRectDistanceToCamera() {\n        vec3 center = vec3(boundingRect[0][0], boundingRect[0][1], boundingRect[0][2]);\n        vec3 halfU = vec3(boundingRect[1][0], boundingRect[1][1], boundingRect[1][2]);\n        vec3 halfV = vec3(boundingRect[2][0], boundingRect[2][1], boundingRect[2][2]);\n        vec3 n = normalize(cross(halfU, halfV));\n\n        vec3 viewDir = - vec3(view[0][2], view[1][2], view[2][2]);\n\n        float viewAngle = dot(viewDir, n);\n        float minViewAngle = ${p.float(b)};\n\n        if (abs(viewAngle) < minViewAngle) {\n          // view direction is (almost) parallel to plane -> clamp it to min angle\n          float normalComponent = sign(viewAngle) * minViewAngle - viewAngle;\n          viewDir = normalize(viewDir + normalComponent * n);\n        }\n\n        // intersect view direction with infinite plane that contains bounding rect\n        vec3 planeProjected = intersectRayPlane(viewDir, cameraPosition, n, center);\n\n        // clip to bounds by projecting to u and v line segments individually\n        vec3 uProjected = projectPointToLineSegment(center, halfU, planeProjected);\n        vec3 vProjected = projectPointToLineSegment(center, halfV, planeProjected);\n\n        // use to calculate the closest point to camera on bounding rect\n        vec3 closestPoint = uProjected + vProjected - center;\n\n        return length(closestPoint - cameraPosition);\n      }\n    `)),T.code.add(p`\n    vec2 scaledUV() {\n      vec2 uv = uvMapSpace.xy ${O?\" * rotate45\":\"\"};\n      vec2 uvCellOrigin = uvMapSpace.zw ${O?\" * rotate45\":\"\"};\n\n      ${j.draped?\"\":p`\n            float distanceToCamera = boundingRectDistanceToCamera();\n            float worldToScreenRatio = worldToScreenPerDistanceRatio / distanceToCamera;\n          `}\n\n      // Logarithmically discretize ratio to avoid jittering\n      float step = 0.1;\n      float discreteWorldToScreenRatio = log(worldToScreenRatio);\n      discreteWorldToScreenRatio = ceil(discreteWorldToScreenRatio / step) * step;\n      discreteWorldToScreenRatio = exp(discreteWorldToScreenRatio);\n\n      vec2 uvOffset = mod(uvCellOrigin * discreteWorldToScreenRatio, ${p.float(y)});\n      return uvOffset + (uv * discreteWorldToScreenRatio);\n    }\n  `),T.main.add(p`\n    vuv = scaledUV();\n    vpos = position;\n    ${D?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n    forwardNormalizedVertexColor();\n    forwardObjectAndLayerIdColor();\n    ${j.hasVertexColors?\"vColor *= uColor;\":j.vvColor?\"vColor = uColor * interpolateVVColor(colorFeatureAttribute);\":\"vColor = uColor;\"}\n    gl_Position = transformPosition(proj, view, vpos);\n  `),P.include(l),j.draped&&P.uniforms.add(new v(\"texelSize\",((e,o)=>1/o.camera.pixelRatio))),D&&C.include(i,j),$||(P.code.add(p`\n      const float lineWidth = ${p.float(S)};\n      const float spacing = ${p.float(y)};\n      const float spacingINV = ${p.float(1/y)};\n\n      float coverage(float p, float txlSize) {\n        p = mod(p, spacing);\n\n        float halfTxlSize = txlSize / 2.0;\n\n        float start = p - halfTxlSize;\n        float end = p + halfTxlSize;\n\n        float coverage = (ceil(end * spacingINV) - floor(start * spacingINV)) * lineWidth;\n        coverage -= min(lineWidth, mod(start, spacing));\n        coverage -= max(lineWidth - mod(end, spacing), 0.0);\n\n        return coverage / txlSize;\n      }\n    `),j.draped||P.code.add(p`const int maxSamples = 5;\nfloat sampleAA(float p) {\nvec2 dxdy = abs(vec2(dFdx(p), dFdy(p)));\nfloat fwidth = dxdy.x + dxdy.y;\nivec2 samples = 1 + ivec2(clamp(dxdy, 0.0, float(maxSamples - 1)));\nvec2 invSamples = 1.0 / vec2(samples);\nfloat accumulator = 0.0;\nfor (int j = 0; j < maxSamples; j++) {\nif(j >= samples.y) {\nbreak;\n}\nfor (int i = 0; i < maxSamples; i++) {\nif(i >= samples.x) {\nbreak;\n}\nvec2 step = vec2(i,j) * invSamples - 0.5;\naccumulator += coverage(p + step.x * dxdy.x + step.y * dxdy.y, fwidth);\n}\n}\naccumulator /= float(samples.x * samples.y);\nreturn accumulator;\n}`)),P.main.add(p`\n    discardBySlice(vpos);\n    ${D?\"terrainDepthTest(depth);\":\"\"}\n    vec4 color = vColor;\n    ${$?\"\":p`color.a *= ${x(j)};`}\n    outputColorHighlightOID(color, vpos);\n  `),C}function x(e){function o(o){return e.draped?p`coverage(vuv.${o}, texelSize)`:p`sampleAA(vuv.${o})`}switch(e.style){case u.ForwardDiagonal:case u.Horizontal:return o(\"y\");case u.BackwardDiagonal:case u.Vertical:return o(\"x\");case u.DiagonalCross:case u.Cross:return p`1.0 - (1.0 - ${o(\"x\")}) * (1.0 - ${o(\"y\")})`;default:return\"0.0\"}}const C=Object.freeze(Object.defineProperty({__proto__:null,build:j},Symbol.toStringTag,{value:\"Module\"}));export{C as P,j as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{HighlightCellGridScreenSpacePass as e}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js\";import{HighlightReadBitmap as t}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightReadBitmap.glsl.js\";import{Float2DrawUniform as i}from\"../views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js\";import{FloatPassUniform as l}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{IntegerPassUniform as r}from\"../views/3d/webgl-engine/core/shaderModules/IntegerPassUniform.js\";import{glsl as o}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as n}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as g}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{o as u,b as h}from\"./HighlightDownsample.glsl.js\";function s(){const s=new n;s.include(e);const{fragment:c}=s;return c.uniforms.add(new g(\"blurInput\",(e=>e.singleHighlightBlurTexture)),new i(\"blurSize\",(e=>e.blurSize)),new g(\"highlightTexture\",(e=>e.highlightTexture)),new g(\"highlightOptionsTexture\",(e=>e.highlightOptionsTexture)),new r(\"highlightLevel\",(e=>e.highlightLevel)),new l(\"occludedIntensityFactor\",(e=>e.occludedFactor))),c.constants.add(\"inner\",\"float\",1-(u-h)/u),s.include(t),c.main.add(o`vec2 highlightTextureSize = vec2(textureSize(highlightTexture,0));\nvec2 uv = sUV;\nvec2 center = texture(blurInput, uv).rg;\nvec2 blurredHighlightValue = (vOutlinePossible == 0.0)\n? center\n: center * 0.204164\n+ texture(blurInput, uv + blurSize * 1.407333).rg * 0.304005\n+ texture(blurInput, uv - blurSize * 1.407333).rg * 0.304005\n+ texture(blurInput, uv + blurSize * 3.294215).rg * 0.093913\n+ texture(blurInput, uv - blurSize * 3.294215).rg * 0.093913;\nfloat highlightIntensity = blurredHighlightValue.r;\nfloat occlusionWeight = blurredHighlightValue.g;\nif (highlightIntensity <= 0.01) {\ndiscard;\n}\nvec4 fillColor    = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 0), 0);\nvec4 outlineColor = texelFetch(highlightOptionsTexture, ivec2(highlightLevel, 1), 0);\nvec2 centerTexel = texelFetch(highlightTexture, ivec2(uv * highlightTextureSize), 0).rg;\nuint centerBits = readLevelBits(centerTexel, highlightLevel);\nbool centerFilled = (centerBits & 1u) == 1u;\nbool centerOccluded = (centerBits & 3u) == 3u;\nbool occluded = centerOccluded || (0.5 * highlightIntensity < occlusionWeight);\nfloat occlusionFactor = occluded ? occludedIntensityFactor : 1.0;\nfloat outlineFactor = centerFilled ? 1.0 : smoothstep(0.0, inner, highlightIntensity);\nfloat fillFactor = centerFilled ? 1.0 : 0.0;\nvec4 baseColor = mix(outlineColor, fillColor, fillFactor);\nfloat intensity = baseColor.a * occlusionFactor * outlineFactor;\nfragColor = vec4(baseColor.rgb, intensity);`),s}const c=Object.freeze(Object.defineProperty({__proto__:null,build:s},Symbol.toStringTag,{value:\"Module\"}));export{c as S,s as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../core/libs/gl-matrix-2/factories/vec2f64.js\";import{HighlightCellGridScreenSpacePass as r}from\"../views/3d/webgl-engine/core/shaderLibrary/HighlightCellGridScreenSpacePass.glsl.js\";import{Float2DrawUniform as t}from\"../views/3d/webgl-engine/core/shaderModules/Float2DrawUniform.js\";import{NoParameters as u,glsl as i}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as l}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DDrawUniform as s}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DDrawUniform.js\";class n extends u{constructor(){super(...arguments),this.blurSize=e()}}function o(){const e=new l;return e.include(r),e.fragment.uniforms.add(new t(\"blurSize\",(e=>e.blurSize)),new s(\"blurInput\",(e=>e.blurInput))),e.outputs.add(\"fragSingleHighlight\",\"vec2\",0),e.fragment.main.add(i`vec2 highlightTextureSize = vec2(textureSize(blurInput,0));\nvec2 uv = sUV;\nvec2 center = texture(blurInput, uv).rg;\nif (vOutlinePossible == 0.0) {\nfragSingleHighlight = center;\n} else {\nvec2 sum = center * 0.204164;\nsum += texture(blurInput, uv + blurSize * 1.407333).rg * 0.304005;\nsum += texture(blurInput, uv - blurSize * 1.407333).rg * 0.304005;\nsum += texture(blurInput, uv + blurSize * 3.294215).rg * 0.093913;\nsum += texture(blurInput, uv - blurSize * 3.294215).rg * 0.093913;\nfragSingleHighlight = sum;\n}`),e}const g=Object.freeze(Object.defineProperty({__proto__:null,SingleHighlightBlurDrawParameters:n,build:o},Symbol.toStringTag,{value:\"Module\"}));export{n as S,g as a,o as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as e}from\"../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ScreenSpacePass as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js\";import{Float3PassUniform as o}from\"../views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js\";import{NoParameters as s,glsl as t}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as n}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as i}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";class a extends s{constructor(){super(...arguments),this.color=e(1,1,1)}}function l(){const e=new n;return e.include(r),e.fragment.uniforms.add(new i(\"tex\",(e=>e.texture)),new o(\"uColor\",(e=>e.color))),e.fragment.main.add(t`vec4 texColor = texture(tex, uv);\nfragColor = texColor * vec4(uColor, 1.0);`),e}const d=Object.freeze(Object.defineProperty({__proto__:null,TextureOnlyPassParameters:a,build:l},Symbol.toStringTag,{value:\"Module\"}));export{a as T,d as a,l as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ForwardLinearDepth as e}from\"../views/3d/webgl-engine/core/shaderLibrary/ForwardLinearDepth.glsl.js\";import{ShaderOutput as r}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as o}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{ObjectAndLayerIdColor as a}from\"../views/3d/webgl-engine/core/shaderLibrary/attributes/ObjectAndLayerIdColor.glsl.js\";import{OutputHighlight as t}from\"../views/3d/webgl-engine/core/shaderLibrary/output/OutputHighlight.glsl.js\";import{EvaluateAmbientLighting as n}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/EvaluateAmbientLighting.glsl.js\";import{addMainLightDirection as s,addMainLightIntensity as l}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MainLighting.glsl.js\";import{NormalUtils as d}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/NormalUtils.glsl.js\";import{PBRMode as g}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{ReadShadowMapDraw as v}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/ReadShadowMap.glsl.js\";import{terrainDepthTest as m}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/TerrainDepthTest.glsl.js\";import{Water as c}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/Water.glsl.js\";import{WaterDistortion as p}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/WaterDistortion.glsl.js\";import{alphaCutoff as u}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as w}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as h,addCameraPosition as f}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float4PassUniform as b}from\"../views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js\";import{FloatPassUniform as y}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as j}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as L}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{VertexAttribute as C}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";import{outputColorHighlightOID as P}from\"../views/3d/webgl-engine/shaders/OutputColorHighlightOID.glsl.js\";function O(O){const x=new L,{vertex:D,fragment:S}=x;h(D,O),x.include(o,O),x.attributes.add(C.POSITION,\"vec3\"),x.attributes.add(C.UV0,\"vec2\");const M=new b(\"waterColor\",(e=>e.color));if(O.output===r.Color&&O.draped)return x.varyings.add(\"vpos\",\"vec3\"),D.uniforms.add(M),D.main.add(j`\n      if (waterColor.a < ${j.float(u)}) {\n        // Discard this vertex\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      }\n\n      vpos = position;\n      gl_Position = transformPosition(proj, view, vpos);`),S.uniforms.add(M),S.main.add(j`fragColor = waterColor;`),x;switch(O.output===r.Color&&(x.include(d,O),x.include(e,O),x.varyings.add(\"vuv\",\"vec2\"),x.varyings.add(\"vpos\",\"vec3\"),x.varyings.add(\"vnormal\",\"vec3\"),x.varyings.add(\"vtbnMatrix\",\"mat3\"),O.terrainDepthTest&&x.varyings.add(\"depth\",\"float\"),D.uniforms.add(M),D.main.add(j`\n      if (waterColor.a < ${j.float(u)}) {\n        // Discard this vertex\n        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n        return;\n      }\n\n      vuv = uv0;\n      vpos = position;\n\n      vnormal = getLocalUp(vpos, localOrigin);\n      vtbnMatrix = getTBNMatrix(vnormal);\n\n      ${O.terrainDepthTest?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n\n      gl_Position = transformPosition(proj, view, vpos);\n      ${O.output===r.Color?\"forwardLinearDepth();\":\"\"}`)),x.include(m,O),O.output){case r.Color:x.include(n,{pbrMode:g.Disabled,lightingSphericalHarmonicsOrder:2}),x.include(p),x.include(v,O),x.include(c,O),x.include(i,O),x.include(P,O),S.uniforms.add(M,new y(\"timeElapsed\",(e=>e.timeElapsed)),D.uniforms.get(\"view\"),D.uniforms.get(\"localOrigin\")),f(S,O),S.include(w),s(S),l(S),S.main.add(j`\n        discardBySlice(vpos);\n        ${O.terrainDepthTest?\"terrainDepthTest(depth);\":\"\"}\n        vec3 localUp = vnormal;\n        // the created normal is in tangent space\n        vec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\n\n        // we rotate the normal according to the tangent-bitangent-normal-Matrix\n        vec3 n = normalize(vtbnMatrix * tangentNormalFoam.xyz);\n        vec3 v = -normalize(vpos - cameraPosition);\n        float shadow = ${O.receiveShadows?j`1.0 - readShadowMap(vpos, linearDepth)`:\"1.0\"};\n        vec4 vPosView = view * vec4(vpos, 1.0);\n        vec4 final = vec4(getSeaColor(n, v, mainLightDirection, waterColor.rgb, mainLightIntensity, localUp, shadow, tangentNormalFoam.w, vPosView.xyz, vpos + localOrigin), waterColor.w);\n\n        // gamma correction\n        fragColor = delinearizeGamma(final);\n        outputColorHighlightOID(fragColor, vpos);`);break;case r.Normal:x.include(d,O),x.include(p,O),x.include(i,O),x.varyings.add(\"vpos\",\"vec3\"),x.varyings.add(\"vuv\",\"vec2\"),D.uniforms.add(M),D.main.add(j`\n        if (waterColor.a < ${j.float(u)}) {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vuv = uv0;\n        vpos = position;\n\n        gl_Position = transformPosition(proj, view, vpos);`),S.uniforms.add(new y(\"timeElapsed\",(e=>e.timeElapsed))),S.main.add(j`discardBySlice(vpos);\nvec4 tangentNormalFoam = getSurfaceNormalAndFoam(vuv, timeElapsed);\ntangentNormalFoam.xyz = normalize(tangentNormalFoam.xyz);\nfragColor = vec4((tangentNormalFoam.xyz + vec3(1.0)) * 0.5, tangentNormalFoam.w);`);break;case r.Highlight:x.include(t,O),x.varyings.add(\"vpos\",\"vec3\"),D.uniforms.add(M),D.main.add(j`\n        if (waterColor.a < ${j.float(u)}) {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vpos = position;\n        gl_Position = transformPosition(proj, view, vpos);`),x.include(i,O),S.main.add(j`discardBySlice(vpos);\ncalculateOcclusionAndOutputHighlight();`);break;case r.ObjectAndLayerIdColor:x.include(a,O),x.varyings.add(\"vpos\",\"vec3\"),D.uniforms.add(M),D.main.add(j`\n        if (waterColor.a < ${j.float(u)}) {\n          // Discard this vertex\n          gl_Position = vec4(1e38, 1e38, 1e38, 1.0);\n          return;\n        }\n\n        vpos = position;\n        gl_Position = transformPosition(proj, view, vpos);\n        forwardObjectAndLayerIdColor();`),x.include(i,O),S.main.add(j`discardBySlice(vpos);\noutputObjectAndLayerIdColor();`)}return x}const x=Object.freeze(Object.defineProperty({__proto__:null,build:O},Symbol.toStringTag,{value:\"Module\"}));export{x as W,O as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,t,x){x=x||2;var i,u,v,y,o,p,a,l=t&&t.length,h=l?t[0]*x:e.length,c=n(e,0,h,x,!0),s=[];if(!c||c.next===c.prev)return s;if(l&&(c=f(e,t,c,x)),e.length>80*x){i=v=e[0],u=y=e[1];for(var Z=x;Z<h;Z+=x)(o=e[Z])<i&&(i=o),(p=e[Z+1])<u&&(u=p),o>v&&(v=o),p>y&&(y=p);a=0!==(a=Math.max(v-i,y-u))?1/a:0}return r(c,s,x,i,u,a),s}function n(e,n,t,r,x){var i,u;if(x===E(e,n,t,r)>0)for(i=n;i<t;i+=r)u=B(i,e[i],e[i+1],u);else for(i=t-r;i>=n;i-=r)u=B(i,e[i],e[i+1],u);if(u&&M(u,u.next)){var v=u.next;C(u),u=v}return u}function t(e,n){if(!e)return e;n||(n=e);var t,r=e;do{if(t=!1,r.steiner||!M(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{var x=r.prev;if(C(r),(r=n=x)===r.next)break;t=!0}}while(t||r!==n);return n}function r(e,n,f,y,o,p,a){if(e){!a&&p&&h(e,y,o,p);for(var l,c,s=e;e.prev!==e.next;)if(l=e.prev,c=e.next,p?i(e,y,o,p):x(e))n.push(l.i/f),n.push(e.i/f),n.push(c.i/f),C(e),e=c.next,s=c.next;else if((e=c)===s){a?1===a?r(e=u(t(e),n,f),n,f,y,o,p,2):2===a&&v(e,n,f,y,o,p):r(t(e),n,f,y,o,p,1);break}}}function x(e){var n=e.prev,t=e,r=e.next;if(w(n,t,r)>=0)return!1;for(var x=e.next.next;x!==e.prev;){if(g(n.x,n.y,t.x,t.y,r.x,r.y,x.x,x.y)&&w(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function i(e,n,t,r){var x=e.prev,i=e,u=e.next;if(w(x,i,u)>=0)return!1;for(var v=x.x<i.x?x.x<u.x?x.x:u.x:i.x<u.x?i.x:u.x,f=x.y<i.y?x.y<u.y?x.y:u.y:i.y<u.y?i.y:u.y,y=x.x>i.x?x.x>u.x?x.x:u.x:i.x>u.x?i.x:u.x,o=x.y>i.y?x.y>u.y?x.y:u.y:i.y>u.y?i.y:u.y,p=s(v,f,n,t,r),a=s(y,o,n,t,r),l=e.prevZ,h=e.nextZ;l&&l.z>=p&&h&&h.z<=a;){if(l!==e.prev&&l!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&w(l.prev,l,l.next)>=0)return!1;if(l=l.prevZ,h!==e.prev&&h!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;l&&l.z>=p;){if(l!==e.prev&&l!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&w(l.prev,l,l.next)>=0)return!1;l=l.prevZ}for(;h&&h.z<=a;){if(h!==e.prev&&h!==e.next&&g(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&w(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function u(e,n,r){var x=e;do{var i=x.prev,u=x.next.next;!M(i,u)&&z(i,x,x.next,u)&&j(i,u)&&j(u,i)&&(n.push(i.i/r),n.push(x.i/r),n.push(u.i/r),C(x),C(x.next),x=e=u),x=x.next}while(x!==e);return t(x)}function v(e,n,x,i,u,v){var f=e;do{for(var y=f.next.next;y!==f.prev;){if(f.i!==y.i&&d(f,y)){var o=A(f,y);return f=t(f,f.next),o=t(o,o.next),r(f,n,x,i,u,v),void r(o,n,x,i,u,v)}y=y.next}f=f.next}while(f!==e)}function f(e,r,x,i){var u,v,f,o=[];for(u=0,v=r.length;u<v;u++)(f=n(e,r[u]*i,u<v-1?r[u+1]*i:e.length,i,!1))===f.next&&(f.steiner=!0),o.push(Z(f));for(o.sort(y),u=0;u<o.length;u++)x=t(x=p(o[u],x),x.next);return x}function y(e,n){return e.x-n.x}function o(e){if(e.next.prev===e)return e;let n=e;for(;;){const t=n.next;if(t.prev===n||t===n||t===e)break;n=t}return n}function p(e,n){var r=a(e,n);if(!r)return n;var x=A(r,e),i=t(r,r.next);let u=o(x);return t(u,u.next),i=o(i),o(n===r?i:n)}function a(e,n){var t,r=n,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var v=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=x&&v>u){if(u=v,v===x){if(i===r.y)return r;if(i===r.next.y)return r.next}t=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!t)return null;if(x===u)return t;var f,y=t,o=t.x,p=t.y,a=1/0;r=t;do{x>=r.x&&r.x>=o&&x!==r.x&&g(i<p?x:u,i,o,p,i<p?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),j(r,e)&&(f<a||f===a&&(r.x>t.x||r.x===t.x&&l(t,r)))&&(t=r,a=f)),r=r.next}while(r!==y);return t}function l(e,n){return w(e.prev,e,n.prev)<0&&w(n.next,e,e.next)<0}function h(e,n,t,r){var x=e;do{null===x.z&&(x.z=s(x.x,x.y,n,t,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,c(x)}function c(e){var n,t,r,x,i,u,v,f,y=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,r=t,v=0,n=0;n<y&&(v++,r=r.nextZ);n++);for(f=y;v>0||f>0&&r;)0!==v&&(0===f||!r||t.z<=r.z)?(x=t,t=t.nextZ,v--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;t=r}i.nextZ=null,y*=2}while(u>1);return e}function s(e,n,t,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*x)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-r)*x)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Z(e){var n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function g(e,n,t,r,x,i,u,v){return(x-u)*(n-v)-(e-u)*(i-v)>=0&&(e-u)*(r-v)-(t-u)*(n-v)>=0&&(t-u)*(i-v)-(x-u)*(r-v)>=0}function d(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!k(e,n)&&(j(e,n)&&j(n,e)&&q(e,n)&&(w(e.prev,e,n.prev)||w(e,n.prev,n))||M(e,n)&&w(e.prev,e,e.next)>0&&w(n.prev,n,n.next)>0)}function w(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function M(e,n){return e.x===n.x&&e.y===n.y}function z(e,n,t,r){var x=m(w(e,n,t)),i=m(w(e,n,r)),u=m(w(t,r,e)),v=m(w(t,r,n));return x!==i&&u!==v||(!(0!==x||!b(e,t,n))||(!(0!==i||!b(e,r,n))||(!(0!==u||!b(t,e,r))||!(0!==v||!b(t,n,r)))))}function b(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function m(e){return e>0?1:e<0?-1:0}function k(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&z(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function j(e,n){return w(e.prev,e,e.next)<0?w(e,n,e.next)>=0&&w(e,e.prev,n)>=0:w(e,n,e.prev)<0||w(e,e.next,n)<0}function q(e,n){var t=e,r=!1,x=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&x<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next}while(t!==e);return r}function A(e,n){var t=new D(e.i,e.x,e.y),r=new D(n.i,n.x,n.y),x=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=x,x.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function B(e,n,t,r){var x=new D(e,n,t);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function C(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function D(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(e,n,t,r){for(var x=0,i=n,u=t-r;i<t;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}e.deviation=function(e,n,t,r){var x=n&&n.length,i=x?n[0]*t:e.length,u=Math.abs(E(e,0,i,t));if(x)for(var v=0,f=n.length;v<f;v++){var y=n[v]*t,o=v<f-1?n[v+1]*t:e.length;u-=Math.abs(E(e,y,o,t))}var p=0;for(v=0;v<r.length;v+=3){var a=r[v]*t,l=r[v+1]*t,h=r[v+2]*t;p+=Math.abs((e[a]-e[h])*(e[l+1]-e[a+1])-(e[a]-e[l])*(e[h+1]-e[a+1]))}return 0===u&&0===p?0:Math.abs((p-u)/u)},e.flatten=function(e){for(var n=e[0][0].length,t={vertices:[],holes:[],dimensions:n},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<n;u++)t.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,t.holes.push(r))}return t};export{e};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isArray as e,isFloat as t,maximumValue as r,isSigned as f}from\"../core/typedArrayUtil.js\";function o(e,t){n(e.typedBuffer,t.typedBuffer,e.typedBufferStride,t.typedBufferStride)}function n(o,n,l=2,u=l){const i=n.length/2;let a=0,d=0;if(e(n)||t(n)){for(let e=0;e<i;++e)o[a]=n[d],o[a+1]=n[d+1],a+=l,d+=u;return}const c=r(n);if(f(n))for(let e=0;e<i;++e)o[a]=Math.max(n[d]/c,-1),o[a+1]=Math.max(n[d+1]/c,-1),a+=l,d+=u;else for(let e=0;e<i;++e)o[a]=n[d]/c,o[a+1]=n[d+1]/c,a+=l,d+=u}function l(e,t,r,f){const o=e.typedBuffer,n=e.typedBufferStride,l=f?.count??e.count;let u=(f?.dstIndex??0)*n;for(let i=0;i<l;++i)o[u]=t,o[u+1]=r,u+=n}const u=Object.freeze(Object.defineProperty({__proto__:null,fill:l,normalizeIntegerBuffer:n,normalizeIntegerBufferView:o},Symbol.toStringTag,{value:\"Module\"}));export{n as a,l as f,o as n,u as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../core/has.js\";import\"../core/Logger.js\";function t(t,r,f){e(t.typedBuffer,r.typedBuffer,f,t.typedBufferStride,r.typedBufferStride)}function e(t,e,r,f=3,n=f){if(t.length/f!==Math.ceil(e.length/n))return t;const o=t.length/f,i=r[0],u=r[1],l=r[2],a=r[4],s=r[5],c=r[6],d=r[8],p=r[9],h=r[10],y=r[12],B=r[13],g=r[14];let m=0,M=0;for(let S=0;S<o;S++){const r=e[m],o=e[m+1],S=e[m+2];t[M]=i*r+a*o+d*S+y,t[M+1]=u*r+s*o+p*S+B,t[M+2]=l*r+c*o+h*S+g,m+=n,M+=f}return t}function r(t,e,r){f(t.typedBuffer,e.typedBuffer,r,t.typedBufferStride,e.typedBufferStride)}function f(t,e,r,f=3,n=f){if(t.length/f!==Math.ceil(e.length/n))return;const o=t.length/f,i=r[0],u=r[1],l=r[2],a=r[3],s=r[4],c=r[5],d=r[6],p=r[7],h=r[8];let y=0,B=0;for(let g=0;g<o;g++){const r=e[y],o=e[y+1],g=e[y+2];t[B]=i*r+a*o+d*g,t[B+1]=u*r+s*o+p*g,t[B+2]=l*r+c*o+h*g,y+=n,B+=f}}function n(t,e,r){o(t.typedBuffer,e.typedBuffer,r,t.typedBufferStride,e.typedBufferStride)}function o(t,e,r,f=3,n=f){const o=Math.min(t.length/f,e.length/n);let i=0,u=0;for(let l=0;l<o;l++)t[u]=r*e[i],t[u+1]=r*e[i+1],t[u+2]=r*e[i+2],i+=n,u+=f;return t}function i(t,e,r,f=3,n=f){const o=t.length/f;if(o!==Math.ceil(e.length/n))return t;let i=0,u=0;for(let l=0;l<o;l++)t[u]=e[i]+r[0],t[u+1]=e[i+1]+r[1],t[u+2]=e[i+2]+r[2],i+=n,u+=f;return t}function u(t,e){l(t.typedBuffer,e.typedBuffer,t.typedBufferStride,e.typedBufferStride)}function l(t,e,r=3,f=r){const n=Math.min(t.length/r,e.length/f);let o=0,i=0;for(let u=0;u<n;u++){const n=e[o],u=e[o+1],l=e[o+2],a=n*n+u*u+l*l;if(a>0){const e=1/Math.sqrt(a);t[i]=e*n,t[i+1]=e*u,t[i+2]=e*l}o+=f,i+=r}}function a(t,e,r){const f=Math.min(t.count,e.count),n=t.typedBuffer,o=t.typedBufferStride,i=e.typedBuffer,u=e.typedBufferStride;let l=0,a=0;for(let s=0;s<f;s++)n[a]=i[l]>>r,n[a+1]=i[l+1]>>r,n[a+2]=i[l+2]>>r,l+=u,a+=o}const s=Object.freeze(Object.defineProperty({__proto__:null,normalize:l,normalizeView:u,scale:o,scaleView:n,shiftRight:a,transformMat3:f,transformMat3View:r,transformMat4:e,transformMat4View:t,translate:i},Symbol.toStringTag,{value:\"Module\"}));export{i as a,f as b,r as c,t as d,u as e,o as f,a as g,l as n,n as s,e as t,s as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,f){t(e.typedBuffer,f.typedBuffer,e.typedBufferStride,f.typedBufferStride)}function t(e,t,f=3,o=f){const r=t.length/o;let n=0,u=0;for(let c=0;c<r;++c)e[n]=t[u],e[n+1]=t[u+1],e[n+2]=t[u+2],n+=f,u+=o}function f(e,t,f,o,r){const n=e.typedBuffer,u=e.typedBufferStride,c=r?.count??e.count;let d=(r?.dstIndex??0)*u;for(let l=0;l<c;++l)n[d]=t,n[d+1]=f,n[d+2]=o,d+=u}const o=Object.freeze(Object.defineProperty({__proto__:null,copy:t,copyView:e,fill:f},Symbol.toStringTag,{value:\"Module\"}));export{e as a,t as c,f,o as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../core/has.js\";import{getMathLogger as t}from\"../geometry/support/buffer/math/common.js\";function e(t,e,r){if(t.count!==e.count)return;const f=t.count,n=r[0],o=r[1],u=r[2],s=r[3],c=r[4],i=r[5],a=r[6],d=r[7],l=r[8],p=r[9],y=r[10],m=r[11],B=r[12],h=r[13],g=r[14],S=r[15],M=t.typedBuffer,b=t.typedBufferStride,j=e.typedBuffer,v=e.typedBufferStride;for(let _=0;_<f;_++){const t=_*b,e=_*v,r=j[e],f=j[e+1],w=j[e+2],V=j[e+3];M[t]=n*r+c*f+l*w+B*V,M[t+1]=o*r+i*f+p*w+h*V,M[t+2]=u*r+a*f+y*w+g*V,M[t+3]=s*r+d*f+m*w+S*V}}function r(e,r,f,n=4,o=n){if(e.length/n!=r.length/o)return void t().error(\"source and destination buffers need to have the same number of elements\");const u=e.length/n,s=f[0],c=f[1],i=f[2],a=f[3],d=f[4],l=f[5],p=f[6],y=f[7],m=f[8],B=f[9],h=f[10],g=f[11],S=f[12],M=f[13],b=f[14],j=f[15];let v=0,_=0;for(let t=0;t<u;t++){const t=r[v],f=r[v+1],u=r[v+2],w=r[v+3];e[_]=s*t+d*f+m*u+S*w,e[_+1]=c*t+l*f+B*u+M*w,e[_+2]=i*t+p*f+h*u+b*w,e[_+3]=a*t+y*f+g*u+j*w,v+=o,_+=n}}function f(t,e,r){n(t.typedBuffer,e.typedBuffer,r,t.typedBufferStride,e.typedBufferStride)}function n(t,e,r,f=4,n=f){if(t.length/f!=e.length/n)return;const o=t.length/f,u=r[0],s=r[1],c=r[2],i=r[3],a=r[4],d=r[5],l=r[6],p=r[7],y=r[8];let m=0,B=0;for(let h=0;h<o;h++){const r=e[m],o=e[m+1],h=e[m+2],g=e[m+3];t[B]=u*r+i*o+l*h,t[B+1]=s*r+a*o+p*h,t[B+2]=c*r+d*o+y*h,t[B+3]=g,m+=n,B+=f}}function o(t,e){const r=Math.min(t.count,e.count),f=t.typedBuffer,n=t.typedBufferStride,o=e.typedBuffer,u=e.typedBufferStride;for(let s=0;s<r;s++){const t=s*n,e=s*u,r=o[e],c=o[e+1],i=o[e+2],a=r*r+c*c+i*i;if(a>0){const e=1/Math.sqrt(a);f[t]=e*r,f[t+1]=e*c,f[t+2]=e*i}}}function u(t,e,r){s(t.typedBuffer,e,r,t.typedBufferStride)}function s(t,e,r,f=4){const n=Math.min(t.length/f,e.count),o=e.typedBuffer,u=e.typedBufferStride;let s=0,c=0;for(let i=0;i<n;i++)t[c]=r*o[s],t[c+1]=r*o[s+1],t[c+2]=r*o[s+2],t[c+3]=r*o[s+3],s+=u,c+=f}const c=Object.freeze(Object.defineProperty({__proto__:null,normalize:o,scale:s,scaleView:u,transformMat3:n,transformMat3View:f,transformMat4:r,transformMat4View:e},Symbol.toStringTag,{value:\"Module\"}));export{f as a,s as b,e as c,r as d,o as n,u as s,n as t,c as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,f){t(e.typedBuffer,f,e.typedBufferStride)}function t(e,t,f=4){const o=t.typedBuffer,r=t.typedBufferStride,n=t.count;let u=0,c=0;for(let d=0;d<n;++d)e[u]=o[c],e[u+1]=o[c+1],e[u+2]=o[c+2],e[u+3]=o[c+3],u+=f,c+=r}function f(e,t,f,o,r,n){const u=e.typedBuffer,c=e.typedBufferStride,d=n?.count??e.count;let l=(n?.dstIndex??0)*c;for(let p=0;p<d;++p)u[l]=t,u[l+1]=f,u[l+2]=o,u[l+3]=r,l+=c}const o=Object.freeze(Object.defineProperty({__proto__:null,copy:t,copyView:e,fill:f},Symbol.toStringTag,{value:\"Module\"}));export{t as a,e as c,f,o as v};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{aLefTable as t,feTo06Table as r,impTabRtl as e,impTabLtr as n,ubatB as o,ubatS as i,ubatWs as a,primaryTable as u,tbbase as s,unicodeTable as c,arabicAlefBetIntervalsBegine as f,arabicAlefBetIntervalsEnd as l,typesNames as h,swapTable as T,standAlonForm as L,baseForm as A,medialForm as d,lamAlefInialTableFE as g,lamAlefMedialTableFE as m,finalForm as F,initialForm as p,isolatedForm as R,ubatL as b,ubatR as U,ubatOn as B,ubatAn as S,ubatEn as w,ubatNsm as _,ubatAl as v,ubatEt as N}from\"./bidiEngineTables.js\";class C{constructor(){this.inputFormat=\"ILYNN\",this.outputFormat=\"VLNNN\",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(t,r,e){if(this.sourceToTarget=[],this.targetToSource=[],!t)return\"\";if(ot(this.sourceToTarget,this.targetToSource,t.length),!this.checkParameters(r,e))return t;r=this.inputFormat,e=this.outputFormat;let n=t;const o=ft,i=rt(r.charAt(1)),a=rt(e.charAt(1)),u=(\"I\"===r.charAt(0)?\"L\":r.charAt(0))+i,s=(\"I\"===e.charAt(0)?\"L\":e.charAt(0))+a,c=r.charAt(2)+e.charAt(2);o.defInFormat=u,o.defOutFormat=s,o.defSwap=c;const f=V(t,u,s,c,o);let l=!1;return\"R\"===e.charAt(1)?l=!0:\"C\"!==e.charAt(1)&&\"D\"!==e.charAt(1)||(l=\"rtl\"===this.checkContextual(f)),this.sourceToTarget=ut,this.targetToSource=it(this.sourceToTarget),st=this.targetToSource,n=r.charAt(3)===e.charAt(3)?f:\"S\"===e.charAt(3)?I(l,f):k(f,l,!0),this.sourceToTarget=ut,this.targetToSource=st,this.levels=ct,n}_inputFormatSetter(t){if(!At.test(t))throw new Error(\"dojox/string/BidiEngine: the bidi layout string is wrong!\");this.inputFormat=t}_outputFormatSetter(t){if(!At.test(t))throw new Error(\"dojox/string/BidiEngine: the bidi layout string is wrong!\");this.outputFormat=t}checkParameters(t,r){return t?this._inputFormatSetter(t):t=this.inputFormat,r?this._outputFormatSetter(r):r=this.outputFormat,t!==r}checkContextual(t){let r=x(t);if(\"ltr\"!==r&&\"rtl\"!==r){try{r=document.dir.toLowerCase()}catch(e){}\"ltr\"!==r&&\"rtl\"!==r&&(r=\"ltr\")}return r}hasBidiChar(t){return dt.test(t)}}function V(t,r,e,n,o){const i=E(t,{inFormat:r,outFormat:e,swap:n},o);if(i.inFormat===i.outFormat)return t;r=i.inFormat,e=i.outFormat,n=i.swap;const a=r.slice(0,1),u=r.slice(1,4),s=e.slice(0,1),c=e.slice(1,4);if(o.inFormat=r,o.outFormat=e,o.swap=n,\"L\"===a&&\"VLTR\"===e){if(\"LTR\"===u)return o.dir=Tt,y(t,o);if(\"RTL\"===u)return o.dir=Lt,y(t,o)}if(\"V\"===a&&\"V\"===s)return o.dir=\"RTL\"===u?Lt:Tt,M(t,o);if(\"L\"===a&&\"VRTL\"===e)return\"LTR\"===u?(o.dir=Tt,t=y(t,o)):(o.dir=Lt,t=y(t,o)),M(t);if(\"VLTR\"===r&&\"LLTR\"===e)return o.dir=Tt,y(t,o);if(\"V\"===a&&\"L\"===s&&u!==c)return t=M(t),\"RTL\"===u?V(t,\"LLTR\",\"VLTR\",n,o):V(t,\"LRTL\",\"VRTL\",n,o);if(\"VRTL\"===r&&\"LRTL\"===e)return V(t,\"LRTL\",\"VRTL\",n,o);if(\"L\"===a&&\"L\"===s){const r=o.swap;return o.swap=r.slice(0,1)+\"N\",\"RTL\"===u?(o.dir=Lt,t=y(t,o),o.swap=\"N\"+r.slice(1,3),o.dir=Tt,t=y(t,o)):(o.dir=Tt,t=y(t,o),o.swap=\"N\"+r.slice(1,3),t=V(t,\"VLTR\",\"LRTL\",o.swap,o)),t}return t}function E(t,r,e){if(void 0===r.inFormat&&(r.inFormat=e.defInFormat),void 0===r.outFormat&&(r.outFormat=e.defOutFormat),void 0===r.swap&&(r.swap=e.defSwap),r.inFormat===r.outFormat)return r;const n=r.inFormat.slice(0,1),o=r.outFormat.slice(0,1);let i,a=r.inFormat.slice(1,4),u=r.outFormat.slice(1,4);return\"C\"===a.charAt(0)&&(i=x(t),a=\"ltr\"===i||\"rtl\"===i?i.toUpperCase():\"L\"===r.inFormat.charAt(2)?\"LTR\":\"RTL\",r.inFormat=n+a),\"C\"===u.charAt(0)&&(i=x(t),\"rtl\"===i?u=\"RTL\":\"ltr\"===i?(i=O(t),u=i.toUpperCase()):u=\"L\"===r.outFormat.charAt(2)?\"LTR\":\"RTL\",r.outFormat=o+u),r}function I(t,r,e){if(0===r.length)return\"\";void 0===t&&(t=!0);const n=(r=String(r)).split(\"\");let o=0,i=1,a=n.length;t||(o=n.length-1,i=-1,a=1);const u=j(n,o,i,a);let s=\"\";for(let c=0;c<n.length;c++)W(u,u.length,c)>-1?(at(st,c,!t,-1),ut.splice(c,1)):s+=n[c];return s}function j(t,r,e,n,o){let i=0;const a=[];let u=0;for(let s=r;s*e<n;s+=e)if(Z(t[s])||tt(t[s])){if(\"ل\"===t[s]&&q(t,s+e,e,n)){t[s]=nt(t[s+e],0===i?g:m),s+=e,et(t,s,e,n),a[u]=s,u++,i=0;continue}const r=t[s];1===i?t[s]=$(t,s+e,e,n)?Q(t[s]):X(t[s],F):!0===$(t,s+e,e,n)?t[s]=X(t[s],p):t[s]=X(t[s],R),tt(r)||(i=1),!0===K(r)&&(i=0)}else i=0;return a}function x(t){const r=/[A-Za-z\\u05d0-\\u065f\\u066a-\\u06ef\\u06fa-\\u07ff\\ufb1d-\\ufdff\\ufe70-\\ufefc]/.exec(t);return r?r[0]<=\"z\"?\"ltr\":\"rtl\":\"\"}function O(t){const r=t.split(\"\");return r.reverse(),x(r.join(\"\"))}function k(e,n,o){if(0===e.length)return\"\";void 0===n&&(n=!0);let i=\"\";const a=(e=String(e)).split(\"\");for(let u=0;u<e.length;u++){let s=!1;if(a[u]>=\"ﹰ\"&&a[u]<\"\\ufeff\"){const c=e.charCodeAt(u);a[u]>=\"ﻵ\"&&a[u]<=\"ﻼ\"?(n?(u>0&&o&&\" \"===a[u-1]?i=i.slice(0,-1)+\"ل\":(i+=\"ل\",s=!0),i+=t[(c-65269)/2]):(i+=t[(c-65269)/2],i+=\"ل\",u+1<e.length&&o&&\" \"===a[u+1]?u++:s=!0),s&&(at(st,u,!0,1),ut.splice(u,0,ut[u]))):i+=r[c-65136]}else i+=a[u]}return i}function y(t,r){const e=t.split(\"\"),n=[];return D(e,n,r),P(e,n,r),G(2,e,n,r),G(1,e,n,r),ct=n,e.join(\"\")}function D(t,r,i){const a=t.length,u=i.dir?e:n;let s=0,c=-1;const f=[],l=[];i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1;for(let e=0;e<a;e++)f[e]=z(t[e]);for(let e=0;e<a;e++){const n=s,a=H(t,f,l,e,i);l[e]=a,s=u[n][a];const h=240&s;s&=15;const T=u[s][lt];if(r[e]=T,h>0)if(16===h){for(let t=c;t<e;t++)r[t]=1;c=-1}else c=-1;if(u[s][ht])-1===c&&(c=e);else if(c>-1){for(let t=c;t<e;t++)r[t]=T;c=-1}f[e]===o&&(r[e]=0),i.hiLevel|=T}i.hasUbatS&&Y(f,r,a,i)}function Y(t,r,e,n){for(let o=0;o<e;o++)if(t[o]===i){r[o]=n.dir;for(let e=o-1;e>=0&&t[e]===a;e--)r[e]=n.dir}}function P(t,r,e){if(0!==e.hiLevel&&e.swap[0]!==e.swap[1])for(let n=0;n<t.length;n++)1===r[n]&&(t[n]=J(t[n]))}function z(t){const r=t.charCodeAt(0),e=u[r>>8];return e<s?e:c[e-s][255&r]}function M(t,r){const e=t.split(\"\");if(r){const t=[];D(e,t,r),ct=t}return e.reverse(),ut.reverse(),e.join(\"\")}function W(t,r,e){for(let n=0;n<r;n++)if(t[n]===e)return n;return-1}function Z(t){for(let r=0;r<f.length;r++)if(t>=f[r]&&t<=l[r])return!0;return!1}function $(t,r,e,n){for(;r*e<n&&tt(t[r]);)r+=e;return!!(r*e<n&&Z(t[r]))}function q(r,e,n,o){for(;e*n<o&&tt(r[e]);)e+=n;let i=\" \";if(!(e*n<o))return!1;i=r[e];for(let a=0;a<t.length;a++)if(t[a]===i)return!0;return!1}function G(t,r,e,n){if(n.hiLevel<t)return;if(1===t&&n.dir===Lt&&!n.hasUbatB)return r.reverse(),void ut.reverse();const o=r.length;let i,a,u,s,c,f=0;for(;f<o;){if(e[f]>=t){for(i=f+1;i<o&&e[i]>=t;)i++;for(a=f,u=i-1;a<u;a++,u--)s=r[a],r[a]=r[u],r[u]=s,c=ut[a],ut[a]=ut[u],ut[u]=c;f=i}f++}}function H(t,r,e,n,i){const a=r[n];return{UBAT_L:()=>(i.lastArabic=!1,b),UBAT_R:()=>(i.lastArabic=!1,U),UBAT_ON:()=>B,UBAT_AN:()=>S,UBAT_EN:()=>i.lastArabic?S:w,UBAT_AL:()=>(i.lastArabic=!0,i.hasUbatAl=!0,U),UBAT_WS:()=>B,UBAT_CS:()=>{let t,o;return n<1||n+1>=r.length||(t=e[n-1])!==w&&t!==S||(o=r[n+1])!==w&&o!==S?B:(i.lastArabic&&(o=S),o===t?o:B)},UBAT_ES:()=>(n>0?e[n-1]:o)===w&&n+1<r.length&&r[n+1]===w?w:B,UBAT_ET:()=>{if(n>0&&e[n-1]===w)return w;if(i.lastArabic)return B;let t=n+1;const o=r.length;for(;t<o&&r[t]===N;)t++;return t<o&&r[t]===w?w:B},UBAT_NSM:()=>{if(\"VLTR\"===i.inFormat){const e=r.length;let o=n+1;for(;o<e&&r[o]===_;)o++;if(o<e){const e=t[n].charCodeAt(0),i=e>=1425&&e<=2303||64286===e,a=r[o];if(i&&(a===U||a===v))return U}}return n<1||r[n-1]===o?B:e[n-1]},UBAT_B:()=>(i.lastArabic=!0,i.hasUbatB=!0,i.dir),UBAT_S:()=>(i.hasUbatS=!0,B),UBAT_LRE:()=>(i.lastArabic=!1,B),UBAT_RLE:()=>(i.lastArabic=!1,B),UBAT_LRO:()=>(i.lastArabic=!1,B),UBAT_RLO:()=>(i.lastArabic=!1,B),UBAT_PDF:()=>(i.lastArabic=!1,B),UBAT_BN:()=>B}[h[a]]()}function J(t){let r,e=0,n=T.length-1;for(;e<=n;)if(r=Math.floor((e+n)/2),t<T[r][0])n=r-1;else{if(!(t>T[r][0]))return T[r][1];e=r+1}return t}function K(t){for(let r=0;r<L.length;r++)if(L[r]===t)return!0;return!1}function Q(t){for(let r=0;r<A.length;r++)if(t===A[r])return d[r];return t}function X(t,r){for(let e=0;e<A.length;e++)if(t===A[e])return r[e];return t}function tt(t){return t>=\"ً\"&&t<=\"ٕ\"}function rt(t){return\"L\"===t?\"LTR\":\"R\"===t?\"RTL\":\"C\"===t?\"CLR\":\"D\"===t?\"CRL\":\"\"}function et(t,r,e,n){for(;r*e<n&&tt(t[r]);)r+=e;return r*e<n&&(t[r]=\" \",!0)}function nt(r,e){for(let n=0;n<t.length;n++)if(r===t[n])return e[n];return r}function ot(t,r,e){ut=[],ct=[];for(let n=0;n<e;n++)t[n]=n,r[n]=n,ut[n]=n}function it(t){const r=new Array(t.length);for(let e=0;e<t.length;e++)r[t[e]]=e;return r}function at(t,r,e,n){for(let o=0;o<t.length;o++)(t[o]>r||!e&&t[o]===r)&&(t[o]+=n)}let ut=[],st=[],ct=[];const ft={dir:0,defInFormat:\"LLTR\",defoutFormat:\"VLTR\",defSwap:\"YN\",inFormat:\"LLTR\",outFormat:\"VLTR\",swap:\"YN\",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:\"\"},lt=5,ht=6,Tt=0,Lt=1,At=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,dt=/[\\u0591-\\u06ff\\ufb1d-\\ufefc]/;export{C as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"./BidiEngine.js\";const n=new r;function i(r){if(null==r)return[\"\",!1];if(!n.hasBidiChar(r))return[r,!1];let i;return i=\"rtl\"===n.checkContextual(r)?\"IDNNN\":\"ICNNN\",[n.bidiTransform(r,i,\"VLYSN\"),!0]}export{i as bidiText};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return 0===this._outer.size}get(t,e){return this._outer.get(t)?.get(e)}getInner(t){return this._outer.get(t)}set(t,e,r){const o=this._outer.get(t);o?o.set(e,r):this._outer.set(t,new Map([[e,r]]))}delete(t,e){const r=this._outer.get(t);r&&(r.delete(e),0===r.size&&this._outer.delete(t))}forEach(t){this._outer.forEach(((e,r)=>t(e,r)))}forAll(t){for(const e of this._outer.values())for(const r of e.values())t(r)}}export{t as NestedMap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(t=e){this._data=[],this._compare=t}get size(){return this._data.length}enqueue(t){if(null==t)return;const{_data:e,_compare:n}=this;e.push(t);let l=e.length-1>>>0;const r=e[l];for(;l>0;){const t=l-1>>1,s=e[t];if(!(n(s,r)<=0))break;e[t]=r,e[l]=s,l=t}}dequeue(){const{_data:t,_compare:e}=this,n=t[0],l=t.pop();if(0===t.length)return n;t[0]=l;let r=0;const s=t.length,u=t[0];let a,o,c=null;for(;;){const n=2*r+1,l=2*r+2;if(c=null,n<s&&(a=t[n],e(a,u)>0&&(c=n)),l<s&&(o=t[l],(null===c&&e(o,u)<=0||null!==c&&e(o,a)<=0)&&(c=l)),null===c)break;t[r]=t[c],t[c]=u,r=c}return n}}const e=(t,e)=>t<e?-1:t>e?1:0;export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst A=[[\"(\",\")\"],[\")\",\"(\"],[\"<\",\">\"],[\">\",\"<\"],[\"[\",\"]\"],[\"]\",\"[\"],[\"{\",\"}\"],[\"}\",\"{\"],[\"«\",\"»\"],[\"»\",\"«\"],[\"‹\",\"›\"],[\"›\",\"‹\"],[\"⁽\",\"⁾\"],[\"⁾\",\"⁽\"],[\"₍\",\"₎\"],[\"₎\",\"₍\"],[\"≤\",\"≥\"],[\"≥\",\"≤\"],[\"〈\",\"〉\"],[\"〉\",\"〈\"],[\"﹙\",\"﹚\"],[\"﹚\",\"﹙\"],[\"﹛\",\"﹜\"],[\"﹜\",\"﹛\"],[\"﹝\",\"﹞\"],[\"﹞\",\"﹝\"],[\"﹤\",\"﹥\"],[\"﹥\",\"﹤\"]],B=[\"آ\",\"أ\",\"إ\",\"ا\"],T=[\"ﻵ\",\"ﻷ\",\"ﻹ\",\"ﻻ\"],U=[\"ﻶ\",\"ﻸ\",\"ﻺ\",\"ﻼ\"],_=[\"ا\",\"ب\",\"ت\",\"ث\",\"ج\",\"ح\",\"خ\",\"د\",\"ذ\",\"ر\",\"ز\",\"س\",\"ش\",\"ص\",\"ض\",\"ط\",\"ظ\",\"ع\",\"غ\",\"ف\",\"ق\",\"ك\",\"ل\",\"م\",\"ن\",\"ه\",\"و\",\"ي\",\"إ\",\"أ\",\"آ\",\"ة\",\"ى\",\"ل\",\"م\",\"ن\",\"ه\",\"و\",\"ي\",\"إ\",\"أ\",\"آ\",\"ة\",\"ى\",\"ی\",\"ئ\",\"ؤ\"],L=[\"ﺍ\",\"ﺏ\",\"ﺕ\",\"ﺙ\",\"ﺝ\",\"ﺡ\",\"ﺥ\",\"ﺩ\",\"ﺫ\",\"ﺭ\",\"ﺯ\",\"ﺱ\",\"ﺵ\",\"ﺹ\",\"ﺽ\",\"ﻁ\",\"ﻅ\",\"ﻉ\",\"ﻍ\",\"ﻑ\",\"ﻕ\",\"ﻙ\",\"ﻝ\",\"ﻡ\",\"ﻥ\",\"ﻩ\",\"ﻭ\",\"ﻱ\",\"ﺇ\",\"ﺃ\",\"ﺁ\",\"ﺓ\",\"ﻯ\",\"ﯼ\",\"ﺉ\",\"ﺅ\",\"ﹰ\",\"ﹲ\",\"ﹴ\",\"ﹶ\",\"ﹸ\",\"ﹺ\",\"ﹼ\",\"ﹾ\",\"ﺀ\",\"ﺉ\",\"ﺅ\"],E=[\"ﺎ\",\"ﺐ\",\"ﺖ\",\"ﺚ\",\"ﺞ\",\"ﺢ\",\"ﺦ\",\"ﺪ\",\"ﺬ\",\"ﺮ\",\"ﺰ\",\"ﺲ\",\"ﺶ\",\"ﺺ\",\"ﺾ\",\"ﻂ\",\"ﻆ\",\"ﻊ\",\"ﻎ\",\"ﻒ\",\"ﻖ\",\"ﻚ\",\"ﻞ\",\"ﻢ\",\"ﻦ\",\"ﻪ\",\"ﻮ\",\"ﻲ\",\"ﺈ\",\"ﺄ\",\"ﺂ\",\"ﺔ\",\"ﻰ\",\"ﯽ\",\"ﺊ\",\"ﺆ\",\"ﹰ\",\"ﹲ\",\"ﹴ\",\"ﹶ\",\"ﹸ\",\"ﹺ\",\"ﹼ\",\"ﹾ\",\"ﺀ\",\"ﺊ\",\"ﺆ\"],N=[\"ﺎ\",\"ﺒ\",\"ﺘ\",\"ﺜ\",\"ﺠ\",\"ﺤ\",\"ﺨ\",\"ﺪ\",\"ﺬ\",\"ﺮ\",\"ﺰ\",\"ﺴ\",\"ﺸ\",\"ﺼ\",\"ﻀ\",\"ﻄ\",\"ﻈ\",\"ﻌ\",\"ﻐ\",\"ﻔ\",\"ﻘ\",\"ﻜ\",\"ﻠ\",\"ﻤ\",\"ﻨ\",\"ﻬ\",\"ﻮ\",\"ﻴ\",\"ﺈ\",\"ﺄ\",\"ﺂ\",\"ﺔ\",\"ﻰ\",\"ﯿ\",\"ﺌ\",\"ﺆ\",\"ﹱ\",\"ﹲ\",\"ﹴ\",\"ﹷ\",\"ﹹ\",\"ﹻ\",\"ﹽ\",\"ﹿ\",\"ﺀ\",\"ﺌ\",\"ﺆ\"],R=[\"ﺍ\",\"ﺑ\",\"ﺗ\",\"ﺛ\",\"ﺟ\",\"ﺣ\",\"ﺧ\",\"ﺩ\",\"ﺫ\",\"ﺭ\",\"ﺯ\",\"ﺳ\",\"ﺷ\",\"ﺻ\",\"ﺿ\",\"ﻃ\",\"ﻇ\",\"ﻋ\",\"ﻏ\",\"ﻓ\",\"ﻗ\",\"ﻛ\",\"ﻟ\",\"ﻣ\",\"ﻧ\",\"ﻫ\",\"ﻭ\",\"ﻳ\",\"ﺇ\",\"ﺃ\",\"ﺁ\",\"ﺓ\",\"ﻯ\",\"ﯾ\",\"ﺋ\",\"ﺅ\",\"ﹰ\",\"ﹲ\",\"ﹴ\",\"ﹶ\",\"ﹸ\",\"ﹺ\",\"ﹼ\",\"ﹾ\",\"ﺀ\",\"ﺋ\",\"ﺅ\"],S=[\"ء\",\"آ\",\"أ\",\"ؤ\",\"إ\",\"ا\",\"ة\",\"د\",\"ذ\",\"ر\",\"ز\",\"و\",\"ى\"],O=[\"ً\",\"ً\",\"ٌ\",\"؟\",\"ٍ\",\"؟\",\"َ\",\"َ\",\"ُ\",\"ُ\",\"ِ\",\"ِ\",\"ّ\",\"ّ\",\"ْ\",\"ْ\",\"ء\",\"آ\",\"آ\",\"أ\",\"أ\",\"ؤ\",\"ؤ\",\"إ\",\"إ\",\"ئ\",\"ئ\",\"ئ\",\"ئ\",\"ا\",\"ا\",\"ب\",\"ب\",\"ب\",\"ب\",\"ة\",\"ة\",\"ت\",\"ت\",\"ت\",\"ت\",\"ث\",\"ث\",\"ث\",\"ث\",\"ج\",\"ج\",\"ج\",\"ج\",\"ح\",\"ح\",\"ح\",\"ح\",\"خ\",\"خ\",\"خ\",\"خ\",\"د\",\"د\",\"ذ\",\"ذ\",\"ر\",\"ر\",\"ز\",\"ز\",\"س\",\"س\",\"س\",\"س\",\"ش\",\"ش\",\"ش\",\"ش\",\"ص\",\"ص\",\"ص\",\"ص\",\"ض\",\"ض\",\"ض\",\"ض\",\"ط\",\"ط\",\"ط\",\"ط\",\"ظ\",\"ظ\",\"ظ\",\"ظ\",\"ع\",\"ع\",\"ع\",\"ع\",\"غ\",\"غ\",\"غ\",\"غ\",\"ف\",\"ف\",\"ف\",\"ف\",\"ق\",\"ق\",\"ق\",\"ق\",\"ك\",\"ك\",\"ك\",\"ك\",\"ل\",\"ل\",\"ل\",\"ل\",\"م\",\"م\",\"م\",\"م\",\"ن\",\"ن\",\"ن\",\"ن\",\"ه\",\"ه\",\"ه\",\"ه\",\"و\",\"و\",\"ى\",\"ى\",\"ي\",\"ي\",\"ي\",\"ي\",\"ﻵ\",\"ﻶ\",\"ﻷ\",\"ﻸ\",\"ﻹ\",\"ﻺ\",\"ﻻ\",\"ﻼ\",\"؟\",\"؟\",\"؟\"],o=[\"ء\",\"ف\"],t=[\"غ\",\"ي\"],c=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],e=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],n=0,p=1,r=2,s=3,x=4,C=5,D=6,F=7,M=8,P=9,W=10,a=11,b=12,d=13,f=14,g=15,h=16,i=17,j=18,k=[\"UBAT_L\",\"UBAT_R\",\"UBAT_EN\",\"UBAT_AN\",\"UBAT_ON\",\"UBAT_B\",\"UBAT_S\",\"UBAT_AL\",\"UBAT_WS\",\"UBAT_CS\",\"UBAT_ES\",\"UBAT_ET\",\"UBAT_NSM\",\"UBAT_LRE\",\"UBAT_RLE\",\"UBAT_PDF\",\"UBAT_LRO\",\"UBAT_RLO\",\"UBAT_BN\"],l=100,m=[l+0,n,n,n,n,l+1,l+2,l+3,p,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,l+4,x,x,x,n,x,n,x,n,x,x,x,n,n,x,x,n,n,n,n,n,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,n,n,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,n,n,x,x,n,n,x,x,n,n,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,n,n,n,l+5,F,F,l+6,l+7],q=[[j,j,j,j,j,j,j,j,j,D,C,D,M,C,j,j,j,j,j,j,j,j,j,j,j,j,j,j,C,C,C,D,M,x,x,a,a,a,x,x,x,x,x,W,P,W,P,P,r,r,r,r,r,r,r,r,r,r,P,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,j,j,j,j,j,j,C,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,j,P,x,a,a,a,a,x,x,x,x,n,x,x,j,x,x,a,a,r,r,x,n,x,x,x,r,n,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,n,n,n,n,n,n,n,n],[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,n,n,n,n,n,n,n,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,n,x,x,x,x,x,x,x,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,p,b,p,b,b,p,b,b,p,b,x,x,x,x,x,x,x,x,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,x,x,x,x,x,p,p,p,p,p,x,x,x,x,x,x,x,x,x,x,x],[s,s,s,s,x,x,x,x,F,a,a,F,P,F,x,x,b,b,b,b,b,b,b,b,b,b,b,F,x,x,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,s,s,s,s,s,s,s,s,s,s,a,s,s,F,F,F,b,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,b,b,b,b,b,b,b,s,x,b,b,b,b,b,b,F,F,b,b,x,b,b,b,b,F,F,r,r,r,r,r,r,r,r,r,r,F,F,F,F,F,F],[F,F,F,F,F,F,F,F,F,F,F,F,F,F,x,F,F,b,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,x,x,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,b,b,b,b,b,b,b,b,b,b,b,F,x,x,x,x,x,x,x,x,x,x,x,x,x,x,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,b,b,b,b,b,b,b,b,b,p,p,x,x,x,x,p,x,x,x,x,x],[M,M,M,M,M,M,M,M,M,M,M,j,j,j,n,p,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,M,C,d,f,g,h,i,P,a,a,a,a,a,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,P,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,M,j,j,j,j,j,x,x,x,x,x,j,j,j,j,j,j,r,n,x,x,r,r,r,r,r,r,W,W,x,x,x,n,r,r,r,r,r,r,r,r,r,r,W,W,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x],[n,n,n,n,n,n,n,x,x,x,x,x,x,x,x,x,x,x,x,n,n,n,n,n,x,x,x,x,x,p,b,p,p,p,p,p,p,p,p,p,p,W,p,p,p,p,p,p,p,p,p,p,p,p,p,x,p,p,p,p,p,x,p,x,p,p,x,p,p,x,p,p,p,p,p,p,p,p,p,p,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F],[b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,b,b,b,b,b,b,b,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,P,x,P,x,x,P,x,x,x,x,x,x,x,x,x,a,x,x,W,W,x,x,x,x,x,a,a,x,x,x,x,x,F,F,F,F,F,x,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,F,x,x,j],[x,x,x,a,a,a,x,x,x,x,x,W,P,W,P,P,r,r,r,r,r,r,r,r,r,r,P,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,x,x,x,x,x,x,x,x,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,x,x,x,n,n,n,n,n,n,x,x,n,n,n,n,n,n,x,x,n,n,n,n,n,n,x,x,n,n,n,x,x,x,a,a,x,x,x,a,a,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x]];export{B as aLefTable,o as arabicAlefBetIntervalsBegine,t as arabicAlefBetIntervalsEnd,_ as baseForm,O as feTo06Table,E as finalForm,c as impTabLtr,e as impTabRtl,R as initialForm,L as isolatedForm,T as lamAlefInialTableFE,U as lamAlefMedialTableFE,N as medialForm,m as primaryTable,S as standAlonForm,A as swapTable,l as tbbase,k as typesNames,F as ubatAl,s as ubatAn,C as ubatB,j as ubatBn,P as ubatCs,r as ubatEn,W as ubatEs,a as ubatEt,n as ubatL,d as ubatLre,h as ubatLro,b as ubatNsm,x as ubatOn,g as ubatPdf,p as ubatR,f as ubatRle,i as ubatRlo,D as ubatS,M as ubatWs,q as unicodeTable};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction c(c){return c=c||globalThis.location.hostname,i.some((a=>null!=c?.match(a)))}function a(c,a){return c?(a=a||globalThis.location.hostname)?null!=a.match(t)||null!=a.match(s)?c.replace(\"static.arcgis.com\",\"staticdev.arcgis.com\"):null!=a.match(o)||null!=a.match(l)?c.replace(\"static.arcgis.com\",\"staticqa.arcgis.com\"):c:c:null}const t=/^devext\\.arcgis\\.com$/,o=/^qaext\\.arcgis\\.com$/,s=/^[\\w-]*\\.mapsdevext\\.arcgis\\.com$/,l=/^[\\w-]*\\.mapsqa\\.arcgis\\.com$/,i=[/^([\\w-]*\\.)?[\\w-]*\\.zrh-dev-local\\.esri\\.com$/,t,o,/^jsapps\\.esri\\.com$/,s,l];export{a as adjustStaticAGOUrl,i as devHostnames,c as isDevEnvironment};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../config.js\";const t=\"arial-unicode-ms\",n=\"woff2\",r=new Map,o=new Set;class s{constructor(e,t){this.fontFace=e,this.promise=t}}async function c(t){const c=l(t),a=f(t),i=r.get(c);if(i)return i.promise;const u=new FontFace(t.family,`url('${e.fontsUrl}/woff2/${a}.${n}') format('${n}')`,{style:t.style,weight:t.weight}),d=document.fonts;if(d.has(u)&&\"loading\"===u.status)return u.loaded;const h=u.load().then((()=>(d.add(u),u)));return r.set(c,new s(u,h)),o.add(u),h}function a(){const e=document.fonts;r.forEach((t=>{e.delete(t.fontFace)})),r.clear(),o.clear()}function i(e){return o.has(e)}function u(e){if(!e)return t;const n=e.toLowerCase().split(\" \").join(\"-\");switch(n){case\"serif\":return\"noto-serif\";case\"sans-serif\":return\"arial-unicode-ms\";case\"monospace\":return\"ubuntu-mono\";case\"fantasy\":return\"cabin-sketch\";case\"cursive\":return\"redressed\";default:return n}}function f(e){const t=d(e)+h(e);return u(e.family)+(t.length>0?t:\"-regular\")}function l(e){const n=d(e)+h(e);return(e.family||t)+(n.length>0?n:\"-regular\")}function d(e){if(!e.weight)return\"\";switch(e.weight.toLowerCase()){case\"bold\":case\"bolder\":return\"-bold\"}return\"\"}function h(e){if(!e.style)return\"\";switch(e.style.toLowerCase()){case\"italic\":case\"oblique\":return\"-italic\"}return\"\"}export{a as clearFonts,t as defaultFontFamily,u as getFontFamily,f as getFullyQualifiedFontName,i as isCachedFontFace,c as loadFont};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../request.js\";import e from\"./Error.js\";import{isAbortError as r}from\"./promiseUtils.js\";import{dataComponents as a}from\"./urlUtils.js\";import{base64ToArrayBuffer as n}from\"../support/base64Utils.js\";let i=null,o=!0;function s(t,e,r){if(!t||!e)throw new Error(\"Cannot construct image data without dimensions\");if(o)try{return new ImageData(t,e)}catch(a){o=!1}return m(t,e,r)}function c(t,e,r,a){if(!e||!r)throw new Error(\"Cannot construct image data without dimensions\");if(o)try{return new ImageData(t,e,r)}catch(i){o=!1}const n=m(e,r,a);return n.data.set(t,0),n}function f(){return i||(i=document.createElement(\"canvas\"),i.width=1,i.height=1),i}function m(t,e,r){return r||(r=f()),r.getContext(\"2d\").createImageData(t,e)}async function u(a,n){const i=window.URL.createObjectURL(a);try{const{data:e}=await t(i,{...n,responseType:\"image\"});return e}catch(o){if(!r(o))throw new e(\"invalid-image\",`Could not fetch requested image at ${i}`);throw o}finally{window.URL.revokeObjectURL(i)}}async function p(t,e){const{arrayBuffer:r,mediaType:a}=await d(t,e),n=\"image/png\"===a;if(\"image/gif\"===a){const{isAnimatedGIF:t,parseGif:a}=await import(/* webpackChunkName: \"image-gif\" */ \"./image/gif.js\");if(t(r))return a(r,e)}if(n){const{isAnimatedPNG:t,parseApng:a}=await import(/* webpackChunkName: \"image-apng\" */ \"./image/apng.js\");if(t(r))return a(r,e)}return u(new Blob([r],{type:a}),e)}async function d(e,r){const i=a(e);if(i?.isBase64)return{arrayBuffer:n(i.data),mediaType:i.mediaType};const o=await t(e,{responseType:\"array-buffer\",...r});return{arrayBuffer:o.data,mediaType:o.getHeader?.(\"Content-Type\")??\"\"}}export{s as createEmptyImageData,p as getImageData,c as wrapImageData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction n(){const n=new Float32Array(6);return n[0]=1,n[3]=1,n}function t(n){const t=new Float32Array(6);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function r(n,t,r,e,o,a){const c=new Float32Array(6);return c[0]=n,c[1]=t,c[2]=r,c[3]=e,c[4]=o,c[5]=a,c}function e(n,t){return new Float32Array(n,t,6)}function o(n,t,r,e){const o=t[e],a=t[e+1];n[e]=r[0]*o+r[2]*a+r[4],n[e+1]=r[1]*o+r[3]*a+r[5]}function a(n,t,r,e=0,a=0,c=2){const u=a||t.length/c;for(let l=e;l<u;l++){o(n,t,r,l*c)}}const c=Object.freeze(Object.defineProperty({__proto__:null,clone:t,create:n,createView:e,fromValues:r,transform:o,transformMany:a},Symbol.toStringTag,{value:\"Module\"}));export{t as clone,n as create,e as createView,r as fromValues,c as m,o as transform,a as transformMany};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(){return[1,0,0,1]}function r(e){return[e[0],e[1],e[2],e[3]]}function t(e,r,t,n){return[e,r,t,n]}function n(e,r){return new Float64Array(e,r,4)}const o=Object.freeze(Object.defineProperty({__proto__:null,clone:r,create:e,createView:n,fromValues:t},Symbol.toStringTag,{value:\"Module\"}));export{r as clone,e as create,n as createView,t as fromValues,o as m};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getEpsilon as t}from\"./common.js\";function n(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function r(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function a(t,n,r,a,u){return t[0]=n,t[1]=r,t[2]=a,t[3]=u,t}function u(t,n){if(t===n){const r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function o(t,n){const r=n[0],a=n[1],u=n[2],o=n[3];let e=r*o-u*a;return e?(e=1/e,t[0]=o*e,t[1]=-a*e,t[2]=-u*e,t[3]=r*e,t):null}function e(t,n){const r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t}function c(t){return t[0]*t[3]-t[2]*t[1]}function s(t,n,r){const a=n[0],u=n[1],o=n[2],e=n[3],c=r[0],s=r[1],i=r[2],f=r[3];return t[0]=a*c+o*s,t[1]=u*c+e*s,t[2]=a*i+o*f,t[3]=u*i+e*f,t}function i(t,n,r){const a=n[0],u=n[1],o=n[2],e=n[3],c=Math.sin(r),s=Math.cos(r);return t[0]=a*s+o*c,t[1]=u*s+e*c,t[2]=a*-c+o*s,t[3]=u*-c+e*s,t}function f(t,n,r){const a=n[0],u=n[1],o=n[2],e=n[3],c=r[0],s=r[1];return t[0]=a*c,t[1]=u*c,t[2]=o*s,t[3]=e*s,t}function l(t,n){const r=Math.sin(n),a=Math.cos(n);return t[0]=a,t[1]=r,t[2]=-r,t[3]=a,t}function M(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function h(t){return\"mat2(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"}function b(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2)}function m(t,n,r,a){return t[2]=a[2]/a[0],r[0]=a[0],r[1]=a[1],r[3]=a[3]-t[2]*r[1],[t,n,r]}function d(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function p(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function y(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function x(n,r){const a=n[0],u=n[1],o=n[2],e=n[3],c=r[0],s=r[1],i=r[2],f=r[3],l=t();return Math.abs(a-c)<=l*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(u-s)<=l*Math.max(1,Math.abs(u),Math.abs(s))&&Math.abs(o-i)<=l*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(e-f)<=l*Math.max(1,Math.abs(e),Math.abs(f))}function S(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function j(t,n,r,a){return t[0]=n[0]+r[0]*a,t[1]=n[1]+r[1]*a,t[2]=n[2]+r[2]*a,t[3]=n[3]+r[3]*a,t}const _=s,g=p,q=Object.freeze(Object.defineProperty({__proto__:null,LDU:m,add:d,adjoint:e,copy:n,determinant:c,equals:x,exactEquals:y,frob:b,fromRotation:l,fromScaling:M,identity:r,invert:o,mul:_,multiply:s,multiplyScalar:S,multiplyScalarAndAdd:j,rotate:i,scale:f,set:a,str:h,sub:g,subtract:p,transpose:u},Symbol.toStringTag,{value:\"Module\"}));export{m as LDU,d as add,e as adjoint,n as copy,c as determinant,x as equals,y as exactEquals,b as frob,l as fromRotation,M as fromScaling,r as identity,o as invert,q as m,_ as mul,s as multiply,S as multiplyScalar,j as multiplyScalarAndAdd,i as rotate,f as scale,a as set,h as str,g as sub,p as subtract,u as transpose};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getEpsilon as t}from\"./common.js\";function n(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function r(t,n,a,r,u,o,e){return t[0]=n,t[1]=a,t[2]=r,t[3]=u,t[4]=o,t[5]=e,t}function u(t,n){const a=n[0],r=n[1],u=n[2],o=n[3],e=n[4],s=n[5];let c=a*o-r*u;return c?(c=1/c,t[0]=o*c,t[1]=-r*c,t[2]=-u*c,t[3]=a*c,t[4]=(u*s-o*e)*c,t[5]=(r*e-a*s)*c,t):null}function o(t){return t[0]*t[3]-t[1]*t[2]}function e(t,n,a){const r=n[0],u=n[1],o=n[2],e=n[3],s=n[4],c=n[5],i=a[0],M=a[1],h=a[2],f=a[3],b=a[4],l=a[5];return t[0]=r*i+o*M,t[1]=u*i+e*M,t[2]=r*h+o*f,t[3]=u*h+e*f,t[4]=r*b+o*l+s,t[5]=u*b+e*l+c,t}function s(t,n,a){const r=n[0],u=n[1],o=n[2],e=n[3],s=n[4],c=n[5],i=Math.sin(a),M=Math.cos(a);return t[0]=r*M+o*i,t[1]=u*M+e*i,t[2]=r*-i+o*M,t[3]=u*-i+e*M,t[4]=s,t[5]=c,t}function c(t,n,a){const r=n[0],u=n[1],o=n[2],e=n[3],s=n[4],c=n[5],i=a[0],M=a[1];return t[0]=r*i,t[1]=u*i,t[2]=o*M,t[3]=e*M,t[4]=s,t[5]=c,t}function i(t,n,a){const r=n[0],u=n[1],o=n[2],e=n[3],s=n[4],c=n[5],i=a[0],M=a[1];return t[0]=r,t[1]=u,t[2]=o,t[3]=e,t[4]=r*i+o*M+s,t[5]=u*i+e*M+c,t}function M(t,n){const a=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=a,t[2]=-a,t[3]=r,t[4]=0,t[5]=0,t}function h(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function f(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function b(t){return\"mat2d(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\")\"}function l(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function m(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t[3]=n[3]+a[3],t[4]=n[4]+a[4],t[5]=n[5]+a[5],t}function d(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t[3]=n[3]-a[3],t[4]=n[4]-a[4],t[5]=n[5]-a[5],t}function p(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t[3]=n[3]*a,t[4]=n[4]*a,t[5]=n[5]*a,t}function x(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t[2]=n[2]+a[2]*r,t[3]=n[3]+a[3]*r,t[4]=n[4]+a[4]*r,t[5]=n[5]+a[5]*r,t}function y(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function S(n,a){const r=n[0],u=n[1],o=n[2],e=n[3],s=n[4],c=n[5],i=a[0],M=a[1],h=a[2],f=a[3],b=a[4],l=a[5],m=t();return Math.abs(r-i)<=m*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(u-M)<=m*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(o-h)<=m*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(e-f)<=m*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(s-b)<=m*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-l)<=m*Math.max(1,Math.abs(c),Math.abs(l))}const _=e,g=d,j=Object.freeze(Object.defineProperty({__proto__:null,add:m,copy:n,determinant:o,equals:S,exactEquals:y,frob:l,fromRotation:M,fromScaling:h,fromTranslation:f,identity:a,invert:u,mul:_,multiply:e,multiplyScalar:p,multiplyScalarAndAdd:x,rotate:s,scale:c,set:r,str:b,sub:g,subtract:d,translate:i},Symbol.toStringTag,{value:\"Module\"}));export{m as add,n as copy,o as determinant,S as equals,y as exactEquals,l as frob,M as fromRotation,h as fromScaling,f as fromTranslation,a as identity,u as invert,j as m,_ as mul,e as multiply,p as multiplyScalar,x as multiplyScalarAndAdd,s as rotate,c as scale,r as set,b as str,g as sub,d as subtract,i as translate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction n(n){return n instanceof Float32Array&&n.length>=16}function r(n){return Array.isArray(n)&&n.length>=16}function t(t){return n(t)||r(t)}export{t as isMat4,n as isMat4f32,r as isMat4f64};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clone as t}from\"../core/lang.js\";import{collectMultipath as e}from\"./geometryCursorCollectUtils.js\";import{isPolygon as s,isPolyline as i,isMultipoint as h,isExtent as r,isPoint as n}from\"./support/jsonUtils.js\";import o from\"../layers/graphics/OptimizedGeometry.js\";class a{static fromOptimized(t,e,s=!1,i=!1,h=1){return(new p).initialize(t,e,s,i,h)}static fromJSON(t,e=!1,s=!1){const[i,h]=u(t);return(new c).initialize(i,h,e,s,1)}static fromOptimizedCIM(t,e,s=!1,i=!1,h=1){return(new y).initialize(t,e,s,i,h)}static fromJSONCIM(t,e=!1,s=!1,i=1){const[h,r]=u(t);return(new m).initialize(h,r,e,s,i)}static fromFeatureSetReader(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimized(e,s):null}static fromFeatureSetReaderCIM(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimizedCIM(e,s):null}static createEmptyOptimized(t,e=!1,s=!1,i=1){return(new p).initialize(new o,t,e,s,i)}static createEmptyJSON(t,e=!1,s=!1){return(new c).initialize([],t,e,s,1)}static createEmptyOptimizedCIM(t,e=!1,s=!1,i=1){return(new y).initialize(new o,t,e,s,i)}static createEmptyJSONCIM(t,e=!1,s=!1,i=1){return(new m).initialize([],t,e,s,i)}asJSON(){const t=e(this);return\"esriGeometryEnvelope\"===this.geometryType?{xmin:t[0][0][0],ymin:t[0][0][1],xmax:t[0][2][0],ymax:t[0][2][1]}:\"esriGeometryMultipoint\"===this.geometryType?{points:t.flat()}:\"esriGeometryPoint\"===this.geometryType?{x:t[0][0][0],y:t[0][0][1]}:\"esriGeometryPolygon\"===this.geometryType?{rings:t}:{paths:t}}getCurrentRingArea(){if(this.pathSize<3)return 0;let t,e,s=0;if(this.seekPathStart(),!this.nextPoint())return 0;t=this.x,e=this.y;const i=t,h=e;for(;this.nextPoint();)s+=(t-this.x)*(e+this.y),t=this.x,e=this.y;return s+=(t-i)*(e+h),-.5*s}invertY(){this.yFactor*=-1}}class p extends a{constructor(){super(...arguments),this._end=-1}initialize(t,e,s,i,h){return this.hasZ=s,this.hasM=i,this.geometryType=e,this._stride=2+Number(s)+Number(i),this._geometry=t,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=h,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(t){if(t>=0&&t<this.totalSize){if(this._pathIndex<t)for(;this._pathIndex<t&&this.nextPath(););else if(this._pathIndex>t)for(;this._pathIndex>t&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(t){const e=this._pathOffset+t*this._stride;return e>=0&&e<this._end&&(this._pointOffset=e,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1)&&(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,!0)}prevPath(){return!(this.pathIndex<=0)&&(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,!0)}getCurrentPath(){const t=this._end,e=this._geometry.coords,s=this._pathOffset;return(new p).initialize(new o([this.pathSize],e.slice(s,t)),this.geometryType,this.hasZ,this.hasM,this.yFactor)}pathLength(){const t=this._end,e=this._stride,s=this._geometry.coords;let i=0;for(let h=this._pathOffset+e;h<t;h+=e){const t=s[h-e],r=s[h-e+1],n=s[h]-t,o=s[h+1]-r;i+=Math.sqrt(n*n+o*o)}return i}startPath(){this._geometry.lengths.push(0)}pushPath(t){this.startPath(),this.pushPoints(t)}pushPoint(t){for(let e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.totalSize-1]++}pushXY(t,e){this._geometry.coords.push(t,e),this._geometry.lengths[this.totalSize-1]++}pushPoints(t){for(const e of t)for(let t=0;t<this._stride;++t)this._geometry.coords.push(e[t]);this._geometry.lengths[this.totalSize-1]+=t.length}pushCursor(t){const e=t.asOptimized();this._geometry.coords.push(...e.coords),this._geometry.lengths.push(...e.lengths)}asOptimized(){const t=this._geometry.clone();if(1!==this.yFactor)for(let e=1;e<t.coords.length;e+=this._stride)t.coords[e]*=this.yFactor;return\"esriGeometryPoint\"===this.geometryType&&(t.lengths.length=0),t}isClosed(){const t=this._geometry.coords,e=this._pathOffset,s=this._end-this._stride;for(let i=0;i<this._stride;i++)if(t[e+i]!==t[s+i])return!1;return!0}clone(){return(new p).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce(((t,e)=>t+e))}get pathSize(){const{lengths:t}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>t.length-1?0:t[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(t){this._geometry.coords[this._pointOffset]=t}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(t){this._geometry.coords[this._pointOffset+1]=this.yFactor*t}get z(){return this._geometry.coords[this._pointOffset+2]}set z(t){this._geometry.coords[this._pointOffset+2]=t}get m(){const t=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+t]}set m(t){this._geometry.coords[this._pointOffset+3]=t}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function _(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function u(t){return s(t)?[t.rings,\"esriGeometryPolygon\"]:i(t)?[t.paths,\"esriGeometryPolyline\"]:h(t)?[[t.points],\"esriGeometryMultipoint\"]:r(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],\"esriGeometryEnvelope\"]:n(t)?[[[_(t)]],\"esriGeometryPoint\"]:[[],\"esriGeometryPolyline\"]}class c extends a{initialize(t,e,s,i,h){return this._paths=t,this.geometryType=e,this.hasZ=s,this.hasM=i,this._pathIndex=this._pointIndex=-1,this.yFactor=h,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(t){return this._pathIndex=t,this._pointIndex=-1,t>=0&&t<this.totalSize&&(this._currentPath=this._paths[t],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(t){return t>=0&&t<this._currentPath.length&&(this._pointIndex=t,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const t=this._currentPath.length,e=this._currentPath;let s=0;for(let i=1;i<t;i++){const t=e[i-1],h=e[i],r=t[0],n=t[1],o=h[0]-r,a=h[1]-n;s+=Math.sqrt(o*o+a*a)}return s}startPath(){this._paths.push([])}getCurrentPath(){return(new c).initialize([this._currentPath],this.geometryType,this.hasZ,this.hasM,this.yFactor)}pushPath(t){this._paths.push(t)}pushPoint(t){this._paths[this.totalSize-1].push(t)}pushXY(t,e){this._paths[this.totalSize-1].push([t,e])}pushPoints(t){this._paths[this.totalSize-1].push(...t)}pushCursor(t){const s=e(t);for(const e of s)this.pushPath(e)}asOptimized(){const t=new o;if(\"esriGeometryPoint\"===this.geometryType)t.coords.push(...this._paths[0][0]),t.lengths.length=0;else for(const e of this._paths){for(const s of e)t.coords.push(s[0]),t.coords.push(s[1]*this.yFactor),this.hasZ&&t.coords.push(s[2]),this.hasM&&t.coords.push(s[this._mIndex]);t.lengths.push(e.length)}return t}isClosed(){const t=this._currentPath[0],e=this._currentPath[this._currentPath.length-1];for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}clone(){return(new c).initialize(t(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((t=>t.length)).reduce(((t,e)=>t+e))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(t){this._currentPoint[0]=t}get y(){return this.yFactor*this._currentPoint[1]}set y(t){this._currentPoint[1]=this.yFactor*t}get z(){return this._currentPoint[2]}set z(t){this._currentPoint[2]=t}get m(){return this._currentPoint[this._mIndex]}set m(t){this._currentPoint[this._mIndex]=t}get pathIndex(){return this._pathIndex}}const d=4,l=1;class y extends p{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((t=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const t=(new y).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return t._controlPoints=this._controlPoints,t}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(t){this._controlPoints[this.pathIndex].add(t)}getControlPointAt(t){return this._controlPoints[this.pathIndex].has(t)}}class m extends c{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h)}clone(){return(new m).initialize(t(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][d]=l}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][d]===l}setControlPointAt(t){this._paths[this.pathIndex][t][d]=l}getControlPointAt(t){return this._paths[this.pathIndex][t][d]===l}}export{a as GeometryCursor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as r}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{initializeProjection as e}from\"../projection.js\";import{projectVectorToVector as o}from\"./projectVectorToVector.js\";function t(r,e,t){return!!o(r,e,i,t.spatialReference)&&(t.x=i[0],t.y=i[1],t.z=i[2],!0)}async function c(r,o,c,i){return await e(o,c.spatialReference,null,i),t(r,o,c)}const i=r();export{t as projectVectorToPoint,c as projectVectorToPointAsync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{clone as e}from\"../../core/lang.js\";import s from\"../../core/Logger.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{cast as a}from\"../../core/accessorSupport/decorators/cast.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{ensureClass as c}from\"../../core/accessorSupport/ensureType.js\";import n from\"./MeshMaterial.js\";import l from\"./MeshMaterialMetallicRoughness.js\";import{castArray as m,writeTypedArray as p}from\"./meshProperties.js\";var u;let h=u=class extends r{static from(t){return c(u,t)}constructor(t){super(t),this.faces=null,this.material=null,this.name=void 0,this.shading=\"source\",this.trustSourceNormals=!1}castFaces(t){return m(t,Uint32Array,[Uint16Array],{loggerTag:\".faces=\",stride:3},s.getLogger(this))}castMaterial(t){return c(t&&\"object\"==typeof t&&(\"metallic\"in t||\"roughness\"in t||\"metallicRoughnessTexture\"in t)?l:n,t)}clone(){return new u({faces:e(this.faces),shading:this.shading,material:e(this.material),trustSourceNormals:this.trustSourceNormals,name:this.name})}cloneWithDeduplication(t,r){const s={faces:e(this.faces),shading:this.shading,material:this.material?this.material.cloneWithDeduplication(t,r):null,trustSourceNormals:this.trustSourceNormals,name:this.name};return new u(s)}get memoryUsage(){let t=0;return null!=this.faces&&(t+=this.faces.byteLength),null!=this.material&&(t+=this.material.memoryUsage),t}};t([o({json:{write:p}})],h.prototype,\"faces\",void 0),t([a(\"faces\")],h.prototype,\"castFaces\",null),t([o({type:n,json:{write:!0}})],h.prototype,\"material\",void 0),t([a(\"material\")],h.prototype,\"castMaterial\",null),t([o({json:{write:!0}})],h.prototype,\"name\",void 0),t([o({type:String,json:{write:!0}})],h.prototype,\"shading\",void 0),t([o({type:Boolean})],h.prototype,\"trustSourceNormals\",void 0),h=u=t([i(\"esri.geometry.support.MeshComponent\")],h);const f=h;export{f as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../chunks/tslib.es6.js\";import r from\"../../Color.js\";import{JSONSupport as e}from\"../../core/JSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as l}from\"../../core/accessorSupport/decorators/subclass.js\";import s from\"./MeshTexture.js\";import i from\"./MeshTextureTransform.js\";var n;let u=n=class extends e{constructor(o){super(o),this.color=null,this.colorTexture=null,this.colorTextureTransform=null,this.normalTexture=void 0,this.normalTextureTransform=void 0,this.alphaMode=\"auto\",this.alphaCutoff=.5,this.doubleSided=!0}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(o,r){const e=null!=o?o.get(this):null;if(e)return e;const t=new n(this.clonePropertiesWithDeduplication(r));return null!=o&&o.set(this,t),t}clonePropertiesWithDeduplication(o){return{color:null!=this.color?this.color.clone():null,colorTexture:this.colorTexture?.cloneWithDeduplication(o),normalTexture:this.normalTexture?.cloneWithDeduplication(o),alphaMode:this.alphaMode,alphaCutoff:this.alphaCutoff,doubleSided:this.doubleSided,colorTextureTransform:this.colorTextureTransform?.clone(),normalTextureTransform:this.normalTextureTransform?.clone()}}get memoryUsage(){return this.getMemoryUsage()}getMemoryUsage(){let o=0;return o+=null!=this.color?16:0,null!=this.colorTexture&&(o+=this.colorTexture.memoryUsage),o+=null!=this.colorTextureTransform?20:0,null!=this.normalTexture&&(o+=this.normalTexture.memoryUsage),o+=null!=this.normalTextureTransform?20:0,o}};o([t({type:r,json:{write:!0}})],u.prototype,\"color\",void 0),o([t({type:s,json:{write:!0}})],u.prototype,\"colorTexture\",void 0),o([t({type:i,json:{write:!0}})],u.prototype,\"colorTextureTransform\",void 0),o([t({type:s,json:{write:!0}})],u.prototype,\"normalTexture\",void 0),o([t({type:i,json:{write:!0}})],u.prototype,\"normalTextureTransform\",void 0),o([t({nonNullable:!0,json:{write:!0}})],u.prototype,\"alphaMode\",void 0),o([t({nonNullable:!0,json:{write:!0}})],u.prototype,\"alphaCutoff\",void 0),o([t({nonNullable:!0,json:{write:!0}})],u.prototype,\"doubleSided\",void 0),u=n=o([l(\"esri.geometry.support.MeshMaterial\")],u);const a=u;export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import s from\"../../Color.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import r from\"./MeshMaterial.js\";import i from\"./MeshTexture.js\";import l from\"./MeshTextureTransform.js\";var n;let u=n=class extends r{constructor(e){super(e),this.emissiveColor=null,this.emissiveTexture=null,this.emissiveTextureTransform=void 0,this.occlusionTexture=null,this.occlusionTextureTransform=void 0,this.metallic=1,this.roughness=1,this.metallicRoughnessTexture=null,this.metallicRoughnessTextureTransform=void 0}clone(){return this.cloneWithDeduplication(null,new Map)}cloneWithDeduplication(e,s){const o=null!=e?e.get(this):null;if(o)return o;const t=new n(this.clonePropertiesWithDeduplication(s));return null!=e&&e.set(this,t),t}getMemoryUsage(){let e=super.getMemoryUsage();return e+=null!=this.emissiveColor?16:0,null!=this.emissiveTexture&&(e+=this.emissiveTexture.memoryUsage),e+=null!=this.emissiveTextureTransform?20:0,null!=this.occlusionTexture&&(e+=this.occlusionTexture.memoryUsage),e+=null!=this.occlusionTextureTransform?20:0,null!=this.metallicRoughnessTexture&&(e+=this.metallicRoughnessTexture.memoryUsage),e+=null!=this.metallicRoughnessTextureTransform?20:0,e}clonePropertiesWithDeduplication(e){return{...super.clonePropertiesWithDeduplication(e),emissiveColor:this.emissiveColor?.clone(),emissiveTexture:this.emissiveTexture?.cloneWithDeduplication(e),emissiveTextureTransform:this.emissiveTextureTransform?.clone(),occlusionTexture:this.occlusionTexture?.cloneWithDeduplication(e),occlusionTextureTransform:this.occlusionTextureTransform?.clone(),metallic:this.metallic,roughness:this.roughness,metallicRoughnessTexture:this.metallicRoughnessTexture?.cloneWithDeduplication(e),metallicRoughnessTextureTransform:this.metallicRoughnessTextureTransform?.clone()}}};e([o({type:s,json:{write:!0}})],u.prototype,\"emissiveColor\",void 0),e([o({type:i,json:{write:!0}})],u.prototype,\"emissiveTexture\",void 0),e([o({type:l,json:{write:!0}})],u.prototype,\"emissiveTextureTransform\",void 0),e([o({type:i,json:{write:!0}})],u.prototype,\"occlusionTexture\",void 0),e([o({type:l,json:{write:!0}})],u.prototype,\"occlusionTextureTransform\",void 0),e([o({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u.prototype,\"metallic\",void 0),e([o({type:Number,nonNullable:!0,json:{write:!0},range:{min:0,max:1}})],u.prototype,\"roughness\",void 0),e([o({type:i,json:{write:!0}})],u.prototype,\"metallicRoughnessTexture\",void 0),e([o({type:l,json:{write:!0}})],u.prototype,\"metallicRoughnessTextureTransform\",void 0),u=n=e([t(\"esri.geometry.support.MeshMaterialMetallicRoughness\")],u);const m=u;export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{wrapImageData as e}from\"../../core/imageUtils.js\";import{JSONSupport as a}from\"../../core/JSONSupport.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import{ensureClass as s}from\"../../core/accessorSupport/ensureType.js\";import\"../../core/RandomLCG.js\";import{reader as n}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as i}from\"../../core/accessorSupport/decorators/writer.js\";import{t as l,w as c}from\"../../chunks/persistableUrlUtils.js\";var p;const h=new WeakMap;let d=0,u=p=class extends a{constructor(t){super(t),this.wrap=\"repeat\"}get url(){return this._get(\"url\")||null}set url(t){this._set(\"url\",t),t&&this._set(\"data\",null)}get data(){return this._get(\"data\")||null}set data(t){this._set(\"data\",t),t&&this._set(\"url\",null)}writeData(t,e,a,r){if(t instanceof HTMLImageElement){const s={type:\"image-element\",src:l(t.src,r),crossOrigin:t.crossOrigin};e[a]=s}else if(t instanceof HTMLCanvasElement){const r={type:\"canvas-element\",imageData:m(t.getContext(\"2d\").getImageData(0,0,t.width,t.height))};e[a]=r}else if(t instanceof HTMLVideoElement){const s={type:\"video-element\",src:l(t.src,r),autoplay:t.autoplay,loop:t.loop,muted:t.muted,crossOrigin:t.crossOrigin,preload:t.preload};e[a]=s}else if(t instanceof ImageData){const r={type:\"image-data\",imageData:m(t)};e[a]=r}}readData(t){switch(t.type){case\"image-element\":{const e=new Image;return e.src=t.src,e.crossOrigin=t.crossOrigin,e}case\"canvas-element\":{const e=g(t.imageData),a=document.createElement(\"canvas\");return a.width=e.width,a.height=e.height,a.getContext(\"2d\").putImageData(e,0,0),a}case\"image-data\":return g(t.imageData);case\"video-element\":{const e=document.createElement(\"video\");return e.src=t.src,e.crossOrigin=t.crossOrigin,e.autoplay=t.autoplay,e.loop=t.loop,e.muted=t.muted,e.preload=t.preload,e}default:return}}get transparent(){const{data:t,url:e}=this;return t instanceof HTMLCanvasElement?f(t.getContext(\"2d\").getImageData(0,0,t.width,t.height)):t instanceof ImageData?f(t):!(!e?.toLowerCase().endsWith(\".png\")&&!e?.toLocaleLowerCase().startsWith(\"data:image/png;\"))}set transparent(t){this._overrideIfSome(\"transparent\",t)}get contentHash(){const t=\"string\"==typeof this.wrap?this.wrap:\"object\"==typeof this.wrap?`${this.wrap.horizontal}/${this.wrap.vertical}`:\"\",e=(e=\"\")=>`d:${e},t:${this.transparent},w:${t}`;return null!=this.url?e(this.url):null!=this.data?this.data instanceof HTMLImageElement||this.data instanceof HTMLVideoElement?e(this.data.src):(h.has(this.data)||h.set(this.data,++d),e(h.get(this.data))):e()}get memoryUsage(){let t=0;if(t+=null!=this.url?this.url.length:0,null!=this.data){const e=this.data;\"data\"in e?t+=e.data.byteLength:e instanceof HTMLImageElement?t+=e.naturalWidth*e.naturalHeight*3:e instanceof HTMLCanvasElement&&(t+=e.width*e.height*3)}return t}clone(){const t={url:this.url,data:this.data,wrap:this._cloneWrap()};return new p(t)}cloneWithDeduplication(t){const e=t.get(this);if(e)return e;const a=this.clone();return t.set(this,a),a}_cloneWrap(){return\"string\"==typeof this.wrap?this.wrap:{horizontal:this.wrap.horizontal,vertical:this.wrap.vertical}}static from(t){return\"string\"==typeof t?new p({url:t}):t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageData||t instanceof HTMLVideoElement?new p({data:t}):s(p,t)}};function m(t){let e=\"\";for(let a=0;a<t.data.length;a++)e+=String.fromCharCode(t.data[a]);return{data:btoa(e),width:t.width,height:t.height}}function g(t){const a=atob(t.data),r=new Uint8ClampedArray(a.length);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);return e(r,t.width,t.height)}function f(t){for(let e=3;e<t.data.length;e+=4)if(255!==t.data[e])return!0;return!1}t([r({type:String,json:{write:c}})],u.prototype,\"url\",null),t([r({json:{write:{overridePolicy(){return{enabled:!this.url}}}}}),r()],u.prototype,\"data\",null),t([i(\"data\")],u.prototype,\"writeData\",null),t([n(\"data\")],u.prototype,\"readData\",null),t([r({type:Boolean,json:{write:{overridePolicy(){return{enabled:this._isOverridden(\"transparent\")}}}}})],u.prototype,\"transparent\",null),t([r({json:{write:!0}})],u.prototype,\"wrap\",void 0),t([r({readOnly:!0})],u.prototype,\"contentHash\",null),u=p=t([o(\"esri.geometry.support.MeshTexture\")],u);const w=u;export{w as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../chunks/tslib.es6.js\";import{ClonableMixin as r}from\"../../core/Clonable.js\";import{JSONSupport as e}from\"../../core/JSONSupport.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";let p=class extends(r(e)){constructor(o){super(o),this.offset=[0,0],this.rotation=0,this.scale=[1,1]}};o([t({type:[Number],nonNullable:!0,json:{write:!0}})],p.prototype,\"offset\",void 0),o([t({type:Number,nonNullable:!0,json:{write:!0}})],p.prototype,\"rotation\",void 0),o([t({type:[Number],nonNullable:!0,json:{write:!0}})],p.prototype,\"scale\",void 0),p=o([s(\"esri.geometry.support.MeshTextureTransform\")],p);const c=p;export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst t=512;var i,s;!function(t){t[t.Unknown=0]=\"Unknown\",t[t.Point=1]=\"Point\",t[t.LineString=2]=\"LineString\",t[t.Polygon=3]=\"Polygon\"}(i||(i={}));class h{constructor(t,i){this.x=t,this.y=i}clone(){return new h(this.x,this.y)}equals(t,i){return t===this.x&&i===this.y}isEqual(t){return t.x===this.x&&t.y===this.y}setCoords(t,i){return this.x=t,this.y=i,this}normalize(){const t=this.x,i=this.y,s=Math.sqrt(t*t+i*i);return this.x/=s,this.y/=s,this}rightPerpendicular(){const t=this.x;return this.x=this.y,this.y=-t,this}leftPerpendicular(){const t=this.x;return this.x=-this.y,this.y=t,this}move(t,i){return this.x+=t,this.y+=i,this}assign(t){return this.x=t.x,this.y=t.y,this}assignAdd(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}assignSub(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}rotate(t,i){const s=this.x,h=this.y;return this.x=s*t-h*i,this.y=s*i+h*t,this}scale(t){return this.x*=t,this.y*=t,this}length(){const t=this.x,i=this.y;return Math.sqrt(t*t+i*i)}sub(t){return this.x-=t.x,this.y-=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}static distance(t,i){const s=i.x-t.x,h=i.y-t.y;return Math.sqrt(s*s+h*h)}static add(t,i){return new h(t.x+i.x,t.y+i.y)}static sub(t,i){return new h(t.x-i.x,t.y-i.y)}}class n{constructor(t,i,s){this.ratio=t,this.x=i,this.y=s}}class e{constructor(i,s,h,n=8,e=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=n,this._pixelMargin=e,this._tileSize=t*n,this._dz=i,this._yPos=s,this._xPos=h}setPixelMargin(t){t!==this._pixelMargin&&(this._pixelMargin=t,this.setExtent(this._extent))}setExtent(t){this._extent=t,this._finalRatio=this._tileSize/t*(1<<this._dz);let i=this._pixelRatio*this._pixelMargin;i/=this._finalRatio;const s=t>>this._dz;i>s&&(i=s),this._margin=i,this._xmin=s*this._xPos-i,this._ymin=s*this._yPos-i,this._xmax=this._xmin+s+2*i,this._ymax=this._ymin+s+2*i}reset(t){this._type=t,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(t,i){this._pushLine(),this._prevIsIn=this._isIn(t,i),this._moveTo(t,i,this._prevIsIn),this._prevPt=new h(t,i),this._firstPt=new h(t,i),this._dist=0}lineTo(t,i){const s=this._isIn(t,i),e=new h(t,i),_=h.distance(this._prevPt,e);let x,l,y,a,r,o,u,m;if(s)this._prevIsIn?this._lineTo(t,i,!0):(x=this._prevPt,l=e,y=this._intersect(l,x),this._start=this._dist+_*(1-this._r),this._lineTo(y.x,y.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,x=e,y=this._intersect(l,x),this._lineTo(y.x,y.y,!0),this._lineTo(x.x,x.y,!1);else{const t=this._prevPt,i=e;if(t.x<=this._xmin&&i.x<=this._xmin||t.x>=this._xmax&&i.x>=this._xmax||t.y<=this._ymin&&i.y<=this._ymin||t.y>=this._ymax&&i.y>=this._ymax)this._lineTo(i.x,i.y,!1);else{const s=[];if((t.x<this._xmin&&i.x>this._xmin||t.x>this._xmin&&i.x<this._xmin)&&(a=(this._xmin-t.x)/(i.x-t.x),m=t.y+a*(i.y-t.y),m<=this._ymin?o=!1:m>=this._ymax?o=!0:s.push(new n(a,this._xmin,m))),(t.x<this._xmax&&i.x>this._xmax||t.x>this._xmax&&i.x<this._xmax)&&(a=(this._xmax-t.x)/(i.x-t.x),m=t.y+a*(i.y-t.y),m<=this._ymin?o=!1:m>=this._ymax?o=!0:s.push(new n(a,this._xmax,m))),(t.y<this._ymin&&i.y>this._ymin||t.y>this._ymin&&i.y<this._ymin)&&(a=(this._ymin-t.y)/(i.y-t.y),u=t.x+a*(i.x-t.x),u<=this._xmin?r=!1:u>=this._xmax?r=!0:s.push(new n(a,u,this._ymin))),(t.y<this._ymax&&i.y>this._ymax||t.y>this._ymax&&i.y<this._ymax)&&(a=(this._ymax-t.y)/(i.y-t.y),u=t.x+a*(i.x-t.x),u<=this._xmin?r=!1:u>=this._xmax?r=!0:s.push(new n(a,u,this._ymax))),0===s.length)r?o?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):o?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(s.length>1&&s[0].ratio>s[1].ratio)this._start=this._dist+_*s[1].ratio,this._lineTo(s[1].x,s[1].y,!0),this._lineTo(s[0].x,s[0].y,!0);else{this._start=this._dist+_*s[0].ratio;for(let t=0;t<s.length;t++)this._lineTo(s[t].x,s[t].y,!0)}this._lineTo(i.x,i.y,!1)}}this._dist+=_,this._prevIsIn=s,this._prevPt=e}close(){if(this._line.length>2){const t=this._firstPt,i=this._prevPt;t.x===i.x&&t.y===i.y||this.lineTo(t.x,t.y);const s=this._line;let h=s.length;for(;h>=4&&(s[0].x===s[1].x&&s[0].x===s[h-2].x||s[0].y===s[1].y&&s[0].y===s[h-2].y);)s.pop(),s[0].x=s[h-2].x,s[0].y=s[h-2].y,--h}}result(t=!0){return this._pushLine(),0===this._lines.length?null:(this._type===i.Polygon&&t&&x.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==i.LineString)throw new Error(\"Only valid for lines\");this._pushLine();const t=this._lines,s=t.length;if(0===s)return null;const h=[];for(let i=0;i<s;i++)h.push({line:t[i],start:this._starts[i]||0});return h}_isIn(t,i){return t>=this._xmin&&t<=this._xmax&&i>=this._ymin&&i<=this._ymax}_intersect(t,i){let s,n,e;if(i.x>=this._xmin&&i.x<=this._xmax)n=i.y<=this._ymin?this._ymin:this._ymax,e=(n-t.y)/(i.y-t.y),s=t.x+e*(i.x-t.x);else if(i.y>=this._ymin&&i.y<=this._ymax)s=i.x<=this._xmin?this._xmin:this._xmax,e=(s-t.x)/(i.x-t.x),n=t.y+e*(i.y-t.y);else{n=i.y<=this._ymin?this._ymin:this._ymax,s=i.x<=this._xmin?this._xmin:this._xmax;const h=(s-t.x)/(i.x-t.x),_=(n-t.y)/(i.y-t.y);h<_?(e=h,n=t.y+h*(i.y-t.y)):(e=_,s=t.x+_*(i.x-t.x))}return this._r=e,new h(s,n)}_pushLine(){this._line&&(this._type===i.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===i.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===i.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(t,s,n){this._type!==i.Polygon?n&&(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),s=Math.round((s-(this._ymin+this._margin))*this._finalRatio),this._line.push(new h(t,s))):(n||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),s<this._ymin&&(s=this._ymin),s>this._ymax&&(s=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),s=Math.round((s-(this._ymin+this._margin))*this._finalRatio),this._line.push(new h(t,s)),this._isH=!1,this._isV=!1)}_lineTo(t,s,n){let e,_;if(this._type!==i.Polygon)if(n){if(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),s=Math.round((s-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(e=this._line[this._line.length-1],e.equals(t,s)))return;this._line.push(new h(t,s))}else this._line&&this._line.length>0&&this._pushLine();else if(n||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),s<this._ymin&&(s=this._ymin),s>this._ymax&&(s=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),s=Math.round((s-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){e=this._line[this._line.length-1];const i=e.x===t,n=e.y===s;if(i&&n)return;this._isH&&i||this._isV&&n?(e.x=t,e.y=s,_=this._line[this._line.length-2],_.x===t&&_.y===s?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(_=this._line[this._line.length-2],this._isH=_.x===t,this._isV=_.y===s)):(this._isH=_.x===t,this._isV=_.y===s)):(this._line.push(new h(t,s)),this._isH=i,this._isV=n)}else this._line.push(new h(t,s))}}class _{setExtent(t){this._ratio=4096===t?1:4096/t}get validateTessellation(){return this._ratio<1}reset(t){this._lines=[],this._line=null}moveTo(t,i){this._line&&this._lines.push(this._line),this._line=[];const s=this._ratio;this._line.push(new h(t*s,i*s))}lineTo(t,i){const s=this._ratio;this._line.push(new h(t*s,i*s))}close(){const t=this._line;t&&!t[0].isEqual(t[t.length-1])&&t.push(t[0])}result(){return this._line&&this._lines.push(this._line),0===this._lines.length?null:this._lines}}!function(t){t[t.sideLeft=0]=\"sideLeft\",t[t.sideRight=1]=\"sideRight\",t[t.sideTop=2]=\"sideTop\",t[t.sideBottom=3]=\"sideBottom\"}(s||(s={}));class x{static simplify(t,i,h){if(!h)return;const n=-i,e=t+i,_=-i,l=t+i,y=[],a=[],r=h.length;for(let x=0;x<r;++x){const t=h[x];if(!t||t.length<2)continue;let i,r=t[0];const o=t.length;for(let h=1;h<o;++h)i=t[h],r.x===i.x&&(r.x<=n&&(r.y>i.y?(y.push(x),y.push(h),y.push(s.sideLeft),y.push(-1)):(a.push(x),a.push(h),a.push(s.sideLeft),a.push(-1))),r.x>=e&&(r.y<i.y?(y.push(x),y.push(h),y.push(s.sideRight),y.push(-1)):(a.push(x),a.push(h),a.push(s.sideRight),a.push(-1)))),r.y===i.y&&(r.y<=_&&(r.x<i.x?(y.push(x),y.push(h),y.push(s.sideTop),y.push(-1)):(a.push(x),a.push(h),a.push(s.sideTop),a.push(-1))),r.y>=l&&(r.x>i.x?(y.push(x),y.push(h),y.push(s.sideBottom),y.push(-1)):(a.push(x),a.push(h),a.push(s.sideBottom),a.push(-1)))),r=i}if(0===y.length||0===a.length)return;x.fillParent(h,a,y),x.fillParent(h,y,a);const o=[];x.calcDeltas(o,a,y),x.calcDeltas(o,y,a),x.addDeltas(o,h)}static fillParent(t,i,h){const n=h.length,e=i.length;for(let _=0;_<e;_+=4){const e=i[_],x=i[_+1],y=i[_+2],a=t[e][x-1],r=t[e][x];let o=8092,u=-1;for(let i=0;i<n;i+=4){if(h[i+2]!==y)continue;const n=h[i],e=h[i+1],_=t[n][e-1],x=t[n][e];switch(y){case s.sideLeft:case s.sideRight:if(l(a.y,_.y,x.y)&&l(r.y,_.y,x.y)){const t=Math.abs(x.y-_.y);t<o&&(o=t,u=i)}break;case s.sideTop:case s.sideBottom:if(l(a.x,_.x,x.x)&&l(r.x,_.x,x.x)){const t=Math.abs(x.x-_.x);t<o&&(o=t,u=i)}}}i[_+3]=u}}static calcDeltas(t,i,s){const h=i.length;for(let n=0;n<h;n+=4){const h=[],e=x.calcDelta(n,i,s,h);t.push(i[n]),t.push(i[n+1]),t.push(i[n+2]),t.push(e)}}static calcDelta(t,i,s,h){const n=i[t+3];if(-1===n)return 0;const e=h.length;return e>1&&h[e-2]===n?0:(h.push(n),x.calcDelta(n,s,i,h)+1)}static addDeltas(t,i){const h=t.length;let n=0;for(let s=0;s<h;s+=4){const i=t[s+3];i>n&&(n=i)}for(let e=0;e<h;e+=4){const h=i[t[e]],_=t[e+1],x=n-t[e+3];switch(t[e+2]){case s.sideLeft:h[_-1].x-=x,h[_].x-=x,1===_&&(h[h.length-1].x-=x),_===h.length-1&&(h[0].x-=x);break;case s.sideRight:h[_-1].x+=x,h[_].x+=x,1===_&&(h[h.length-1].x+=x),_===h.length-1&&(h[0].x+=x);break;case s.sideTop:h[_-1].y-=x,h[_].y-=x,1===_&&(h[h.length-1].y-=x),_===h.length-1&&(h[0].y-=x);break;case s.sideBottom:h[_-1].y+=x,h[_].y+=x,1===_&&(h[h.length-1].y+=x),_===h.length-1&&(h[0].y+=x)}}}}const l=(t,i,s)=>t>=i&&t<=s||t>=s&&t<=i;export{i as GeometryType,h as Point,_ as SimpleBuilder,e as TileClipper};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{rad2deg as r,deg2rad as t}from\"../../core/mathUtils.js\";import{getRotation as n}from\"../../core/libs/gl-matrix-2/math/mat4.js\";import{getAxisAngle as o,setAxisAngle as i,multiply as u}from\"../../core/libs/gl-matrix-2/math/quat.js\";import{create as c}from\"../../core/libs/gl-matrix-2/factories/quatf64.js\";import{c as e,e as f,n as s,r as m}from\"../../chunks/vec32.js\";import{UNIT_X as a,UNIT_Y as l,UNIT_Z as p}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";function j(r=B){return[r[0],r[1],r[2],r[3]]}function x(r,t,n,o){return h(r,t,n,o,E)}function b(r,t){return h(r[0],r[1],r[2],t,E)}function g(r,t=j()){return h(r[0],r[1],r[2],r[3],t)}function h(r,t,n,o,i=j()){return i[0]=r,i[1]=t,i[2]=n,i[3]=o,i}function q(r,t,n=j()){return e(w(n),r),n[3]=t,n}function v(r,t,n){return f(n,r,t),s(n,n),n[3]=-m(r,t),n}function k(t,i=j()){const u=n(C,t);return A(i,r(o(i,u))),i}function U(t,n,c=j()){return i(C,w(t),z(t)),i(D,w(n),z(n)),u(C,D,C),A(c,r(o(w(c),C)))}function d(r,t,n,o=j()){return q(a,r,F),q(l,t,G),q(p,n,H),U(F,G,F),U(F,H,o),o}function w(r){return r}function y(r){return r[3]}function z(r){return t(r[3])}function A(r,t){return r[3]=t,r}const B=[0,0,1,0],C=c(),D=c(),E=j(),F=j(),G=j(),H=j();export{y as angle,z as angleRad,w as axis,U as compose,d as composeAxes,g as copy,j as create,q as fromAxisAndAngle,k as fromMatrix,v as fromPoints,h as fromValues,A as setAngle,B as up,x as wrap,b as wrapAxisAngle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"../../../../core/Logger.js\";const e=()=>r.getLogger(\"esri.views.3d.support.buffer.math\");export{e as getMathLogger};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../../core/PriorityQueue.js\";import{create as e}from\"./aaBoundingRect.js\";import{getCursorBoundsXY as n,getCursorPathBounds as i}from\"./boundsUtils.js\";import{ringCentroidCursorXY as r,ringsCentroidCursor as a}from\"./centroid.js\";import{projectPointOnLineSeg as o,distanceFromPointToPolygon as s}from\"./coordsUtils.js\";import{segmentIntersects as c}from\"./intersectsBase.js\";const N=100*222045e-21;function l(t){if(0===t.totalSize)return null;const a=n(t);if(!a)return null;const o=4*(Math.abs(a[0])+Math.abs(a[2])+Math.abs(a[1])+Math.abs(a[3])+1)*N;let s=0,c=0;t.reset();for(let e=0;t.nextPath();e++){const n=t.getCurrentRingArea();n>c&&(c=n,s=e)}if(t.seekPath(s),0===t.pathSize)return null;t.seekPathStart();const l=i(t);if(Math.abs(c)<=2*o*o)return[(l[0]+l[2])/2,(l[1]+l[3])/2];t.seekPathStart();const x=r(t,e());if(null===x)return null;if(t.totalPoints<4)return x;const m=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],d=[NaN,NaN,NaN,NaN],P=[NaN,NaN,NaN,NaN];let y=!1,M=f(x,t,!0);0===M.distance&&(y=!0,m[0][0]=x[0],m[0][1]=x[1],M=f(x,t,!1)),d[0]=M.distance,P[0]=0;const b=[NaN,NaN];let S=!1,k=.25,z=-1,g=NaN;do{if(g=NaN,m[1]=h(t,w(l[0],l[2],k),o,a),isNaN(m[1][0])||isNaN(m[1][1])||(M=f(m[1],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[1],t))S=!0,d[1]=g,P[1]=p(m[1],x);else if(!isNaN(g)&&g>z&&(z=g,b[0]=m[1][0],b[1]=m[1][1]),k-=.01,k<.1){if(!(z>=0))break;S=!0,d[1]=z,m[1][0]=b[0],m[1][1]=b[1],P[1]=p(m[1],x)}}while(!S);S=!1,k=.5,z=-1;let q=.01,j=1;do{if(g=NaN,m[2]=h(t,w(l[0],l[2],k),o,a),isNaN(m[2][0])||isNaN(m[2][1])||(M=f(m[2],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[2],t))S=!0,d[2]=g,P[2]=p(m[2],x);else if(!isNaN(g)&&g>z)z=g,b[0]=m[2][0],b[1]=m[2][1];else if(g>z&&(z=g,b[0]=m[2][0],b[1]=m[2][1]),k=.5+q*j,q+=.01,j*=-1,k<.3||k>.7){if(!(z>=0))break;S=!0,d[2]=z,m[2][0]=b[0],m[2][1]=b[1],P[2]=p(m[2],x)}}while(!S);S=!1,k=.75,z=-1;do{if(g=NaN,m[3]=h(t,w(l[0],l[2],k),o,a),isNaN(m[3][0])||isNaN(m[3][1])||(M=f(m[3],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[3],t))S=!0,d[3]=g,P[3]=p(m[3],x);else if(g>z&&(z=g,b[0]=m[3][0],b[1]=m[3][1]),k+=.01,k>.9){if(!(z>=0))break;S=!0,d[3]=z,m[3][0]=b[0],m[3][1]=b[1],P[3]=p(m[3],x)}}while(!S);const T=[0,1,2,3],D=y?0:1;let R;for(let e=D;e<4;e++)for(let t=D;t<3;t++){const e=P[t],n=P[t+1];C(e,n)>0&&(R=T[t],T[t]=T[t+1],T[t+1]=R,P[t]=n,P[t+1]=e)}let B=D,Q=0,U=0;for(let e=D;e<4;e++){switch(e){case 0:U=2*d[T[e]];break;case 1:U=1.66666666*d[T[e]];break;case 2:U=1.33333333*d[T[e]];break;case 3:U=d[T[e]]}U>Q&&(Q=U,B=T[e])}return m[B]}function u(t,e){let n,i,r,a,o=0;for(e.reset();e.nextPath()&&e.nextPoint();)for(n=e.x,i=e.y;e.nextPoint();n=r,i=a){if(r=e.x,a=e.y,i>t[1]==a>t[1])continue;(r-n)*(t[1]-i)-(a-i)*(t[0]-n)>0?o++:o--}return 0!==o}function f(t,e,n){if(n&&u(t,e))return{coord:t,distance:0};let i=1/0,r=0,a=0,s=[0,0],c=[0,0];const N=[0,0];for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(s[0]=e.x,s[1]=e.y;e.nextPoint();s=c){c=[e.x,e.y],o(N,t,s,c);const n=p(t,N);n<i&&(i=n,r=N[0],a=N[1])}return{coord:[r,a],distance:Math.sqrt(i)}}function h(t,n,i,r){const a=[n,0];let o=1/0,s=1/0,N=!1,l=!1;const u=[[n,r[1]-1],[n,r[3]+1]],f=[0,0],h=[0,0],m=[0,0],d=[[0,0],[0,0]],P=e();for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(d[0][0]=t.x,d[0][1]=t.y;t.nextPoint();d[0][0]=d[1][0],d[0][1]=d[1][1]){if(d[1][0]=t.x,d[1][1]=t.y,null===x(P,d))continue;if(h[0]=u[0][0],h[1]=u[0][1],m[0]=u[1][0],m[1]=u[1][1],0===M(P,h,m))continue;if(!c(u[0],u[1],d[0],d[1],f))continue;const e=f[1];o>s?e<o&&(o=e,N=!0):e<s&&(s=e,l=!0)}return N&&l?a[1]=(o+s)/2:a[0]=a[1]=NaN,a}function x(t,n){if(n.length<2)return null;t||(t=e());const[i,r]=n[0],[a,o]=n[1];return t[0]=Math.min(i,a),t[1]=Math.min(r,o),t[2]=Math.max(i,a),t[3]=Math.max(r,o),t}const m=1,d=4,P=3,y=12;function M(t,e,n){let i=b(e,t),r=b(n,t);const a=t[0],o=t[1],s=t[2],c=t[3];if(i&r)return 0;if(!(i|r))return 4;const N=(i?1:0)|(r?2:0);do{const N=n[0]-e[0],l=n[1]-e[1];if(N>l)i&P?(i&m?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b(e,t)):r&P?(r&m?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b(n,t)):i?(i&d?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b(e,t)):(r&d?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b(n,t));else if(i&y?(i&d?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b(e,t)):r&y?(r&d?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b(n,t)):i?(i&m?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b(e,t)):(r&m?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b(n,t)),i&r)return 0}while(i|r);return N}function b(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function w(t,e,n){return t+(e-t)*n}function p(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function C(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;const n=isNaN(t),i=isNaN(e);return n<i?-1:n>i?1:0}class S{constructor(t,e,n,i){this.x=t,this.y=e,this.cellSize=n,this.distancefromCellCenter=s(t,e,i),this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2}}const k=1,z=100;function g(e){if(!e.nextPath()||!e.pathSize)return null;const n=i(e),r=n[2]-n[0],o=n[3]-n[1];if(0===r||0===o)return[n[0]+r/2,n[1]+o/2];const s=Math.max(Math.min(r,o)/z,k),c=new t(((t,e)=>e.maxDistanceToPolygon-t.maxDistanceToPolygon)),N=Math.min(r,o);let l=N/2,u=0,f=0;for(u=n[0];u<n[2];u+=N)for(f=n[1];f<n[3];f+=N)c.enqueue(new S(u+l,f+l,l,e));e.reset(),e.nextPath();const h=a(e);if(null===h)return null;let x,m=new S(h[0],h[1],0,e);for(;c.size>0;)x=c.dequeue(),x.distancefromCellCenter>m.distancefromCellCenter&&(m=x),x.maxDistanceToPolygon-m.distancefromCellCenter<=s||(l=x.cellSize/2,c.enqueue(new S(x.x-l,x.y-l,l,e)),c.enqueue(new S(x.x+l,x.y-l,l,e)),c.enqueue(new S(x.x-l,x.y+l,l,e)),c.enqueue(new S(x.x+l,x.y+l,l,e)));return[m.x,m.y]}export{l as getLabelPoint,g as getPolylabelPoint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction e(e,n,r,t){const{loggerTag:o,stride:f}=n;return e.length%f!=0?(t.error(o,`Invalid array length, expected a multiple of ${f}`),new r([])):e}function n(n,r,t,o,f){if(!n)return n;if(n instanceof r)return e(n,o,r,f);for(const i of t)if(n instanceof i)return e(new r(n),o,r,f);if(Array.isArray(n))return e(new r(n),o,r,f);{const e=t.map((e=>`'${e.name}'`));return f.error(`Failed to set property, expected one of ${e}, but got ${n.constructor.name}`),new r([])}}function r(e,n,r){n[r]=t(e)}function t(e){const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r];return n}export{n as castArray,r as writeTypedArray};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{nextHighestPowerOfTwo as t}from\"../../../core/mathUtils.js\";import{newIndexArray as n,compactIndices as r}from\"../Indices.js\";function e(e,s,u){const c=Array.isArray(e),a=c?e.length/s:e.byteLength/(4*s),h=c?e:new Uint32Array(e,0,a*s),y=u?.minReduction??0,A=u?.originalIndices||null,g=A?A.length:0,m=u?.componentOffsets||null;let w=0;if(m)for(let t=0;t<m.length-1;t++){const n=m[t+1]-m[t];n>w&&(w=n)}else w=a;const U=Math.floor(1.1*w)+1;(null==i||i.length<2*U)&&(i=new Uint32Array(t(2*U)));for(let t=0;t<2*U;t++)i[t]=0;let b=0;const d=!!m&&!!A,p=d?g:a;let M=n(a);const j=new Uint32Array(g),q=1.96;let I=0!==y?Math.ceil(4*q*q/(y*y)*y*(1-y)):p,k=1,x=m?m[1]:p;for(let t=0;t<p;t++){if(t===I){const n=1-b/t;if(n+q*Math.sqrt(n*(1-n)/t)<y)return null;I*=2}if(t===x){for(let t=0;t<2*U;t++)i[t]=0;if(A)for(let t=m[k-1];t<m[k];t++)j[t]=M[A[t]];x=m[++k]}const n=d?A[t]:t,r=n*s,e=f(h,r,s);let o=e%U,u=b;for(;0!==i[2*o+1];){if(i[2*o]===e){const t=i[2*o+1]-1;if(l(h,r,t*s,s)){u=M[t];break}}o++,o>=U&&(o-=U)}u===b&&(i[2*o]=e,i[2*o+1]=n+1,b++),M[n]=u}if(0!==y&&1-b/a<y)return null;if(d){for(let t=m[k-1];t<j.length;t++)j[t]=M[A[t]];M=r(j)}const C=c?new Array(b):new Uint32Array(b*s);b=0;for(let t=0;t<p;t++)if(M[t]===b){o(h,(d?A[t]:t)*s,C,b*s,s),b++}if(A&&!d){const t=new Uint32Array(g);for(let n=0;n<t.length;n++)t[n]=M[A[n]];M=r(t)}return{buffer:Array.isArray(C)?C:C.buffer,indices:M,uniqueCount:b}}function l(t,n,r,e){for(let l=0;l<e;l++)if(t[n+l]!==t[r+l])return!1;return!0}function o(t,n,r,e,l){for(let o=0;o<l;o++)r[e+o]=t[n+o]}function f(t,n,r){let e=0;for(let l=0;l<r;l++)e=t[n+l]+e|0,e=e+(e<<11)+(e>>>2)|0;return e>>>0}let i=null;export{e as deduplicate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{projectBuffer as e}from\"../../projection/projectBuffer.js\";import r from\"../MeshGeoreferencedVertexSpace.js\";import{equals as o}from\"../spatialReferenceUtils.js\";import{convertVertexSpace as t}from\"./vertexSpaceConversion.js\";function n(n,i){const p=t(n,r.absolute);if(!p)return null;let s=p.position;return o(n.spatialReference,i)||(s=new Float64Array(p.position.length),e(p.position,n.spatialReference,0,s,i,0))?s:null}export{n as projectMeshVertexPositions};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{hasScaling as r,deg2rad as t}from\"../../../core/mathUtils.js\";import{normalFromMat4 as o,fromMat4 as e}from\"../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as n}from\"../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as i}from\"../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as f}from\"../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{q as c,n as a}from\"../../../chunks/vec32.js\";import{create as s}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{computeTranslationToOriginAndRotation as m}from\"../../projection/computeTranslationToOriginAndRotation.js\";import{projectBuffer as u}from\"../../projection/projectBuffer.js\";import{earth as l}from\"../Ellipsoid.js\";import{isCGCS2000 as p,isMars as T,isMoon as y}from\"../spatialReferenceUtils.js\";import{y2lat as A}from\"../webMercatorUtils.js\";import{BufferViewVec3f as d,BufferViewVec3f64 as P}from\"../buffer/BufferView.js\";import{b as N,n as j}from\"../../../chunks/vec3.js\";import{t as M}from\"../../../chunks/vec4.js\";const O=\"Projection may be possible after calling projection.load().\";function F(r,t,o,e){r.error(`Failed to project from (wkid:${t.wkid}) to (wkid:${o.wkid}).${e?\" \":\"\"}${e}`)}function E(r,t,o,e,n,i){return B(x.TO_PCPF,d.fromTypedArray(r),V.NORMAL,P.fromTypedArray(t),o,P.fromTypedArray(e),n,d.fromTypedArray(i))?i:null}function R(r,t,o,e,n,i){return B(x.FROM_PCPF,d.fromTypedArray(r),V.NORMAL,P.fromTypedArray(t),o,P.fromTypedArray(e),n,d.fromTypedArray(i))?i:null}function g(r,t,o,e){return u(r,t,0,o,e,0)?o:null}function h(r,t,o,e){return u(r,t,0,o,e,0)?o:null}function _(t,e,n){return o(Y,n),N(e,t,Y),r(Y)&&j(e,e),e}function C(t,o,n){return e(Y,n),M(o,t,Y),r(Y)&&j(o,o,4),o}function b(r,o,e,n){const i=o===V.NORMAL;return k(r,o,e,((r,o)=>{const e=Math.cos(t(r));o[0]=i?e:1/e,o[1]=1}),n)}function L(r,t,o,e){const n=t===V.NORMAL;return k(r,t,o,((r,t)=>{const o=Math.cosh(-r/l.radius);t[0]=1,t[1]=n?o:1/o}),e)}function k(r,t,o,e,n){const i=t===V.NORMAL?3:4,f=[0,0];for(let c=0,a=1;c<r.length;c+=i,a+=3){e(o[a],f);const t=r[c]*f[0],s=r[c+1]*f[1],m=r[c+2],u=1/Math.sqrt(t*t+s*s+m*m);n[c]=t*u,n[c+1]=s*u,n[c+2]=m*u,4===i&&(n[c+3]=r[c+3])}return n}function w(r,t,o,e,n,i){if(!B(x.TO_PCPF,d.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),V.TANGENT,P.fromTypedArray(t),o,P.fromTypedArray(e),n,d.fromTypedArray(i,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let f=3;f<r.length;f+=4)i[f]=r[f];return i}function G(r,t,o,e,n,i){if(!B(x.FROM_PCPF,d.fromTypedArray(r,16),V.TANGENT,P.fromTypedArray(t),o,P.fromTypedArray(e),n,d.fromTypedArray(i,16)))return null;for(let f=3;f<r.length;f+=4)i[f]=r[f];return i}var V,x;function v(r,t,n,f,c){switch(m(f,n,q,f),r===x.FROM_PCPF&&i(q,q),t){case V.NORMAL:return o(c,q);case V.TANGENT:return e(c,q)}}function B(r,t,o,e,n,i,f,s){if(!t)return;const m=e.count;if($(n))for(let a=0;a<m;a++)i.getVec(a,S),t.getVec(a,U),c(U,U,v(r,o,S,f,Y)),s.setVec(a,U);else for(let u=0;u<m;u++){i.getVec(u,S),t.getVec(u,U);const n=A(e.get(u,1));let m=Math.cos(n);o===V.TANGENT!=(r===x.TO_PCPF)&&(m=1/m),v(r,o,S,f,Y),r===x.TO_PCPF?(Y[0]*=m,Y[1]*=m,Y[2]*=m,Y[3]*=m,Y[4]*=m,Y[5]*=m):(Y[0]*=m,Y[3]*=m,Y[6]*=m,Y[1]*=m,Y[4]*=m,Y[7]*=m),c(U,U,Y),a(U,U),s.setVec(u,U)}return s}function $(r){return r.isWGS84||p(r)||T(r)||y(r)}!function(r){r[r.NORMAL=0]=\"NORMAL\",r[r.TANGENT=1]=\"TANGENT\"}(V||(V={})),function(r){r[r.TO_PCPF=0]=\"TO_PCPF\",r[r.FROM_PCPF=1]=\"FROM_PCPF\"}(x||(x={}));const S=s(),U=s(),q=f(),Y=n();export{V as VectorType,O as loadProjectErrorMessage,F as logProjectionError,h as projectFromPCPF,R as projectNormalFromPCPF,E as projectNormalToPCPF,G as projectTangentFromPCPF,w as projectTangentToPCPF,g as projectToPCPF,_ as transformNormal,C as transformTangent,b as transformVectorENUPlateCarree,L as transformVectorWMPlateCarree};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/Logger.js\";import{floatEqualUlp as n}from\"../../../core/mathUtils.js\";import{getMetersPerCartesianUnitForSR as r,convertUnit as e}from\"../../../core/unitUtils.js\";import{normalFromMat4 as o}from\"../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as i}from\"../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as l,exactEquals as a,copy as s,multiply as c,scale as u}from\"../../../core/libs/gl-matrix-2/math/mat4.js\";import{IDENTITY as f,create as m}from\"../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{d as p,t as g,v as A}from\"../../../chunks/vec32.js\";import{create as R}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{getSphericalPCPF as x,WGS84ECEFSpatialReference as E}from\"../../spatialReferenceEllipsoidUtils.js\";import{computeTranslationToOriginAndRotation as v}from\"../../projection/computeTranslationToOriginAndRotation.js\";import{projectPointToVector as T}from\"../../projection/projectPointToVector.js\";import{isRelativeVertexSpace as h,vertexSpaceEquals as j}from\"../meshVertexSpaceUtils.js\";import{isEarth as S}from\"../spatialReferenceUtils.js\";import{a as w,t as y,b as U}from\"../../../chunks/vec3.js\";import{logProjectionError as F,transformNormal as O,transformTangent as _,projectFromPCPF as b,projectNormalFromPCPF as C,projectTangentFromPCPF as d,projectToPCPF as G,projectNormalToPCPF as N,projectTangentToPCPF as D}from\"./projection.js\";const M=()=>t.getLogger(\"esri.geometry.support.meshUtils.vertexSpaceConversion\");function k(t,n,{vertexSpace:r,spatialReference:e}){if(\"georeferenced\"===r.type){const o=t;if(!T(n,o,e))return!1;const{origin:i}=r;return p(t,o,i),!0}const o=x(e),i=t;if(!T(n,i,o))return!1;const{origin:a}=r,s=lt;if(!v(e,a,s,o))return!1;const c=l(lt,s);return null!=c&&(g(t,i,c),!0)}function B(t,n,r){const{vertexSpace:e,transform:o,vertexAttributes:i}=t,l=h(e)?o:null,s=X(t.spatialReference,r,at.SOURCE_AND_TARGET);if(j(e,n)&&(!l||a(l.localMatrix,f))&&Y(s)){const{position:t,normal:n,tangent:e}=i,o=r?.allowBufferReuse;return{position:o?t:t.slice(),normal:o?n:n?.slice(),tangent:o?e:e?.slice()}}switch(t.vertexSpace.type){case\"local\":return\"local\"===n.type?H(t,t.vertexSpace,n.origin,r):P(t,t.vertexSpace,n.origin,r);case\"georeferenced\":return\"local\"===n.type?q(t,t.vertexSpace,n.origin,r):L(t,t.vertexSpace,n.origin,r)}}function L({vertexAttributes:t,transform:n,spatialReference:r},{origin:e},o,i){const l=X(r,i,at.SOURCE_AND_TARGET),a=e||!Y(l)?s(rt,n?.localMatrix??f):null;a&&W(a,r,i,at.SOURCE_AND_TARGET);const{position:c,normal:u,tangent:m}=a?I(t,a):t,p=i?.allowBufferReuse,g=p?c:new Float64Array(c.length);let R=c;if(e&&(R=w(g,R,e)),o){const t=A(it,o);R=w(g,R,t)}return{position:R!==t.position||p?R:R.slice(),normal:u!==t.normal||p?u:u?.slice(),tangent:m!==t.tangent||p?m:m?.slice()}}function V(t,n){return n?.useEllipsoid&&S(t)?E:x(t)}function P({spatialReference:t,vertexAttributes:n,transform:r},{origin:e},o,i){const l=V(t,i);if(!v(t,e,rt,l))return F(M(),t,l),null;r&&c(rt,rt,r.localMatrix),W(rt,t,i,at.SOURCE);const a=new Float64Array(n.position.length),s=J(n.position,rt,t,a,l);if(!s)return null;const u=K(s,t,a,l,n.normal,rt);if(n.normal&&!u)return null;const f=Q(s,t,a,l,n.tangent,rt);if(n.tangent&&!f)return null;if(o){const t=A(it,o);w(s,s,t)}return{position:s,normal:u,tangent:f}}function q({vertexAttributes:t,spatialReference:n,transform:r},{origin:e},i,a){const s=V(n,a);if(!v(n,i,rt,s))return F(M(),n,s),null;const c=1/X(n,a,at.TARGET);u(rt,rt,[c,c,c]);const f=l(et,rt),{position:m,normal:p,tangent:g}=z(t,e,r),A=new Float64Array(m.length),R=Z(m,n,f,A,s);if(!R)return null;const x=o(ot,f),E=$(p,m,n,A,s,x,p!==t.normal?p:void 0);if(!E&&p)return null;const T=tt(g,m,n,A,s,x,g!==t.tangent?g:void 0);return!T&&g?null:{position:R,normal:E,tangent:T}}function z(t,n,r){if(!n)return t;if(!r){const{position:r,normal:e,tangent:o}=t;return{position:w(new Float64Array(r.length),r,n),tangent:o,normal:e}}const e=I(t,r.localMatrix);return w(e.position,e.position,n),e}function H({vertexAttributes:t,spatialReference:n,transform:r},{origin:e},o,i){const a=V(n,i);if(!v(n,e,rt,a))return F(M(),n,a),null;if(r&&c(rt,rt,r.localMatrix),!v(n,o,et,a))return F(M(),a,n),null;l(et,et);const s=c(rt,et,rt);return W(s,n,i,at.SOURCE_AND_TARGET),I(t,s)}function I(t,n){const r=new Float64Array(t.position.length);y(r,t.position,n);const e=t.normal?new Float32Array(t.normal.length):null,o=t.tangent?new Float32Array(t.tangent.length):null;return e&&t.normal&&O(t.normal,e,n),o&&t.tangent&&_(t.tangent,o,n),{position:r,normal:e,tangent:o}}function J(t,n,r,e,o){y(e,t,n);const i=new Float64Array(t.length);return b(e,o,i,r)?i:(F(M(),o,r),null)}function K(t,n,r,e,o,i){if(null==o)return null;const l=new Float32Array(o.length);return O(o,l,i),C(l,t,n,r,e,l)?l:(F(M(),e,n),null)}function Q(t,n,r,e,o,i){if(null==o)return null;const l=new Float32Array(o.length);return _(o,l,i),d(l,t,n,r,e,l)?l:(F(M(),e,n),null)}function W(t,n,r,e){const o=X(n,r,e);Y(o)||u(t,t,[o,o,o])}function X(t,n,r){const e=!!(r&at.SOURCE),o=!!(r&at.TARGET),i=n?.sourceUnit,l=n?.targetUnit;if(!i&&!l)return 1;let a=nt(i,t);e||!i||Y(a)||(M().warn(\"source unit conversion not supported\"),a=1);let s=1/nt(l,t);return o||!l||Y(s)||(M().warn(\"target unit conversion not supported\"),s=1),a*s}function Y(t){return n(t,1)}function Z(t,n,r,e,o){const i=G(t,n,e,o);if(!i)return F(M(),n,o),null;const l=new Float64Array(i.length);return y(l,i,r),l}function $(t,n,r,e,o,i,l){if(null==t)return null;const a=l??new Float32Array(t.length);return N(t,n,r,e,o,a)?(U(a,a,i),a):(F(M(),r,o),null)}function tt(t,n,r,e,o,i,l){if(null==t)return null;const a=l??new Float32Array(t.length);return D(t,n,r,e,o,a)?(U(a,a,i,4),a):(F(M(),r,o),null)}function nt(t,n){if(null==t)return 1;const o=r(n);return 1/e(o,\"meters\",t)}const rt=m(),et=m(),ot=i(),it=R(),lt=m();var at;!function(t){t[t.NONE=0]=\"NONE\",t[t.SOURCE=1]=\"SOURCE\",t[t.TARGET=2]=\"TARGET\",t[t.SOURCE_AND_TARGET=3]=\"SOURCE_AND_TARGET\"}(at||(at={}));export{B as convertVertexSpace,nt as getUnitToSpatialReferenceScaleConversion,k as projectPointToVertexSpace};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{deg2rad as r}from\"../../core/mathUtils.js\";import{getMetersPerUnitForSR as t,getMetersPerVerticalUnitForSR as o}from\"../../core/unitUtils.js\";import{i as s}from\"../../chunks/vec32.js\";import{Axis as i}from\"./Axis.js\";import{create as a,getNormal as n,fromManyPoints as m}from\"./plane.js\";function c(t,o,s){const a=e(f,t,o,s)?n(f):[0,0,1];return Math.abs(a[2])>Math.cos(r(80))?i.Z:Math.abs(a[1])>Math.abs(a[0])?i.Y:i.X}function e(r,i,a,n){const c=(r=>!Array.isArray(r[0]))(i)?(r,t)=>i[3*r+t]:(r,t)=>i[r][t],e=n?t(n)/o(n):1;return m(r,((r,t)=>s(r,c(t,0)*e,c(t,1)*e,c(t,2))),a)}const f=a();export{e as fitPlane,c as leastSignificantAxis};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{e as n}from\"../../chunks/earcut.js\";import{Axis as t}from\"./Axis.js\";import{isClockwise as e}from\"./coordsUtils.js\";import{doubleSubArray as o,doubleArrayFrom as r,newDoubleArray as s}from\"./DoubleArray.js\";import{compactIndices as i}from\"./Indices.js\";import{leastSignificantAxis as l}from\"./polygonUtils.js\";import{deduplicate as c}from\"./meshUtils/deduplicate.js\";function f(t){const e=a(t.rings,t.hasZ,p.CCW_IS_HOLE,t.spatialReference),s=new Array;let l=0,f=0;for(const r of e.polygons){const t=r.count,c=r.index,h=o(e.position,3*c,3*t),a=r.holeIndices.map((n=>n-c)),g=i(n(h,a,3));s.push({position:h,faces:g}),l+=h.length,f+=g.length}const g=h(s,l,f),u=Array.isArray(g.position)?c(g.position,3,{originalIndices:g.faces}):c(g.position.buffer,6,{originalIndices:g.faces});return g.position=r(new Float64Array(u.buffer)),g.faces=u.indices,g}function h(n,t,e){if(1===n.length)return n[0];const o=s(t),r=new Array(e);let l=0,c=0,f=0;for(const s of n){for(let n=0;n<s.position.length;n++)o[l++]=s.position[n];for(const n of s.faces)r[c++]=n+f;f=l/3}return{position:o,faces:i(r)}}function a(n,t,e,o){const r=n.length,i=new Array(r),l=new Array(r),c=new Array(r);let f=0;for(let s=0;s<r;++s)f+=n[s].length;let h=0,a=0,m=0;const d=s(3*f);let y=0;for(let s=r-1;s>=0;s--){const f=n[s],A=e===p.CCW_IS_HOLE&&u(f,t,o);if(A&&1!==r)i[h++]=f;else{let n=f.length;for(let t=0;t<h;++t)n+=i[t].length;const e={index:y,pathLengths:new Array(h+1),count:n,holeIndices:new Array(h)};e.pathLengths[0]=f.length,f.length>0&&(c[m++]={index:y,count:f.length}),y=A?g(f,f.length-1,-1,d,y,f.length,t):g(f,0,1,d,y,f.length,t);for(let o=0;o<h;++o){const n=i[o];e.holeIndices[o]=y,e.pathLengths[o+1]=n.length,n.length>0&&(c[m++]={index:y,count:n.length}),y=g(n,0,1,d,y,n.length,t)}h=0,e.count>0&&(l[a++]=e)}}for(let s=0;s<h;++s){const n=i[s];n.length>0&&(c[m++]={index:y,count:n.length}),y=g(n,0,1,d,y,n.length,t)}return l.length=a,c.length=m,{position:d,polygons:l,outlines:c}}function g(n,t,e,o,r,s,i){r*=3;for(let l=0;l<s;++l){const s=n[t];o[r++]=s[0],o[r++]=s[1],o[r++]=i&&s[2]?s[2]:0,t+=e}return r/3}function u(n,o,r){if(!o)return!e(n);const s=n.length-1;switch(l(n,s,r)){case t.X:return!e(n,t.Y,t.Z);case t.Y:return!e(n,t.X,t.Z);case t.Z:return!e(n,t.X,t.Y)}}var p;!function(n){n[n.NONE=0]=\"NONE\",n[n.CCW_IS_HOLE=1]=\"CCW_IS_HOLE\"}(p||(p={}));export{p as CounterClockwiseMode,u as isCounterClockwise,a as ringsToTriangulationInfo,f as triangulate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction t(t,e,r){return{objectId:t,target:e,distance:r,type:\"vertex\"}}function e(t,e,r,n,d,a=!1){return{objectId:t,target:e,distance:r,type:\"edge\",start:n,end:d,draped:a}}export{e as makeEdgeCandidate,t as makeVertexCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar a;!function(a){a[a.EnableFastUpdates=0]=\"EnableFastUpdates\",a[a.DisableFastUpdates=1]=\"DisableFastUpdates\",a[a.UpdateFastLocalOrigin=2]=\"UpdateFastLocalOrigin\"}(a||(a={}));export{a as MeshTransformUpdateAction};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Placement as t}from\"./CIMPlacements.js\";function e(t){return t[4]}function i(t,e){t[4]=e}class r{constructor(e,i=!0,r=!0,s=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!i&&\"esriGeometryPolygon\"===e.geometryType||!r&&\"esriGeometryPolyline\"===e.geometryType?null:e,this.geomUnitsPerPoint=s,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new t}next(){if(!this.geometryCursor)return null;const t=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&t||(this.geometryCursor=null),t}processMultiPath(t){for(;this.iteratePath||t.pathIndex<t.totalSize-1;){this.iteratePath||t.nextPath(),this.iterateMultiPath=!0;const e=this.processPath(t);if(e)return e}return this.iterateMultiPath=!1,null}}class s{constructor(t,e,i,r=0){this.isClosed=!1,this.inputGeometries=t,this.acceptPolygon=e,this.acceptPolyline=i,this.geomUnitsPerPoint=r,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let t=this.inputGeometries.next();for(;t&&(this.isClosed=this.acceptPolygon&&\"esriGeometryPolygon\"===t.geometryType||\"esriGeometryEnvelope\"===t.geometryType,this.multiPathCursor=t,!this.multiPathCursor);)t=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const t=this.processPath(this.multiPathCursor);if(t)return t}this.multiPathCursor=null}}}export{s as PathEffectCursor,r as PathTransformationCursor,e as getId,i as setId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../geometry/GeometryCursor.js\";import{GeometryType as e,TileClipper as o}from\"../../geometry/support/TileClipper.js\";const r=512;let n;class s{constructor(t){this._geometry=t}next(){const t=this._geometry;return this._geometry=null,t}}function i(s,i){n||(n=new o(0,0,0,1));const y=\"esriGeometryPolygon\"===s.geometryType,m=y?e.Polygon:e.LineString,l=y?3:2;let c,p;for(n.reset(m),n.setPixelMargin(i+1),n.setExtent(r);s.nextPath();)if(!(s.pathSize<l)){for(s.nextPoint(),c=s.x,p=-s.y,n.moveTo(c,p);s.nextPoint();)c=s.x,p=-s.y,n.lineTo(c,p);y&&n.close()}const f=n.result(!1);if(f){const e=t.createEmptyOptimizedCIM(s.geometryType);for(const t of f){e.startPath();for(const o of t)e.pushXY(o.x,-o.y)}return e.reset(),e}return null}export{s as SimpleEffectCursor,i as clipCursorToTileExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{applyColorSubstitution(t,a){if(!a)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\"));const{width:e,height:n}=t,o=this._rasterizationCanvas,r=o.getContext(\"2d\",{willReadFrequently:!0});t!==o&&(o.width=e,o.height=n,r.drawImage(t,0,0,e,n));const i=r.getImageData(0,0,e,n).data;if(a)for(const l of a)if(l&&l.oldColor&&4===l.oldColor.length&&l.newColor&&4===l.newColor.length){const[t,a,e,n]=l.oldColor,[o,r,s,h]=l.newColor;if(t===o&&a===r&&e===s&&n===h)continue;for(let l=0;l<i.length;l+=4)t===i[l]&&a===i[l+1]&&e===i[l+2]&&n===i[l+3]&&(i[l]=o,i[l+1]=r,i[l+2]=s,i[l+3]=h)}const s=new ImageData(i,e,n);return r.putImageData(s,0,0),o}tintImageData(t,a){if(!a||a.length<4)return t;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement(\"canvas\"));const{width:e,height:n}=t,o=this._rasterizationCanvas,r=o.getContext(\"2d\",{willReadFrequently:!0});t!==o&&(o.width=e,o.height=n,r.drawImage(t,0,0,e,n));const i=r.getImageData(0,0,e,n),s=new Uint8Array(i.data),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255];for(let g=0;g<s.length;g+=4)s[g]*=l[0],s[g+1]*=l[1],s[g+2]*=l[2],s[g+3]*=l[3];const h=new ImageData(new Uint8ClampedArray(s.buffer),e,n);return r.putImageData(h,0,0),o}}export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{EffectAddControlPoints as e}from\"./effects/EffectAddControlPoints.js\";import{EffectArrow as t}from\"./effects/EffectArrow.js\";import{EffectBuffer as r}from\"./effects/EffectBuffer.js\";import{EffectControlMeasureLine as c}from\"./effects/EffectControlMeasureLine.js\";import{EffectCut as f}from\"./effects/EffectCut.js\";import{EffectDashes as o}from\"./effects/EffectDashes.js\";import{EffectDonut as s}from\"./effects/EffectDonut.js\";import{EffectJog as a}from\"./effects/EffectJog.js\";import{EffectMove as n}from\"./effects/EffectMove.js\";import{EffectOffset as l}from\"./effects/EffectOffset.js\";import{EffectReverse as m}from\"./effects/EffectReverse.js\";import{EffectRotate as i}from\"./effects/EffectRotate.js\";import{EffectScale as u}from\"./effects/EffectScale.js\";import{EffectWave as M}from\"./effects/EffectWave.js\";import{PlacementAlongLineSameSize as p}from\"./placements/PlacementAlongLineSameSize.js\";import{PlacementAtExtremities as E}from\"./placements/PlacementAtExtremities.js\";import{PlacementAtRatioPositions as C}from\"./placements/PlacementAtRatioPositions.js\";import{PlacementInsidePolygon as I}from\"./placements/PlacementInsidePolygon.js\";import{PlacementOnLine as P}from\"./placements/PlacementOnLine.js\";import{PlacementOnVertices as j}from\"./placements/PlacementOnVertices.js\";import{PlacementPolygonCenter as G}from\"./placements/PlacementPolygonCenter.js\";function A(p){if(!p)return null;switch(p.type){case\"CIMGeometricEffectAddControlPoints\":return e.local();case\"CIMGeometricEffectArrow\":return t.local();case\"CIMGeometricEffectBuffer\":return r.local();case\"CIMGeometricEffectControlMeasureLine\":return c.local();case\"CIMGeometricEffectCut\":return f.local();case\"CIMGeometricEffectDashes\":return o.local();case\"CIMGeometricEffectDonut\":return s.local();case\"CIMGeometricEffectJog\":return a.local();case\"CIMGeometricEffectMove\":return n.local();case\"CIMGeometricEffectOffset\":return l.local();case\"CIMGeometricEffectReverse\":return m.local();case\"CIMGeometricEffectRotate\":return i.local();case\"CIMGeometricEffectScale\":return u.local();case\"CIMGeometricEffectWave\":return M.local()}return null}function g(e){if(!e)return null;switch(e.type){case\"CIMMarkerPlacementAlongLineSameSize\":return p.local();case\"CIMMarkerPlacementAtExtremities\":return E.local();case\"CIMMarkerPlacementAtRatioPositions\":return C.local();case\"CIMMarkerPlacementInsidePolygon\":return I.local();case\"CIMMarkerPlacementOnLine\":return P.local();case\"CIMMarkerPlacementOnVertices\":return j.local();case\"CIMMarkerPlacementPolygonCenter\":return G.local()}return null}export{A as getEffectOperator,g as getPlacementOperator};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(t,s){this.tx=t,this.ty=s}setTranslateZ(t){this.tz=t}setRotateCS(t,s){this.rz=void 0,this.rzCos=t,this.rzSin=s}setRotate(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0}setRotateY(t){this.ry=t}setScale(t){this.s=t}setMeasure(t){this.m=t}}class s{next(){return null}}export{s as EmptyPlacementCursor,t as Placement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{defaultFontFamily as t}from\"../../core/fontUtils.js\";import has from\"../../core/has.js\";import{clone as e}from\"../../core/lang.js\";import r from\"../../core/Logger.js\";import s from\"../../core/ObjectPool.js\";import{px2pt as i,pt2px as o}from\"../../core/screenUtils.js\";import{GeometryCursor as n}from\"../../geometry/GeometryCursor.js\";import{fromValues as a,create as l}from\"../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as h}from\"../../geometry/support/boundsUtils.js\";import{polygonCentroid as c}from\"../../geometry/support/centroid.js\";import{isPoint as m,isPolygon as f,isPolyline as u,isExtent as d,isMultipoint as p}from\"../../geometry/support/jsonUtils.js\";import{SimpleEffectCursor as _}from\"./CIMEffects.js\";import g from\"./CIMImageColorSubstitutionHelper.js\";import{getEffectOperator as y,getPlacementOperator as P}from\"./CIMOperators.js\";import{Placement as w}from\"./CIMPlacements.js\";import{defaultCIMValues as x}from\"./defaultCIMValues.js\";import{LineCapStyle as S,LineJoinStyle as M}from\"./enums.js\";import{getFirstFrame as b}from\"./imageUtils.js\";import k from\"./Rect.js\";import C from\"./TextRasterizer.js\";import{getNumericValue as I,isCIMFill as v,getSize as T,isSVGImage as R,fromCIMFontDecoration as z,fromCIMFontStyle as F,fromCIMHorizontalAlignment as L,fromCIMVerticalAlignment as U,getFillColor as A,getStrokeColor as j,getStrokeWidth as G,getFontStyle as D,getFontWeight as H}from\"./utils.js\";import{destroyHiddenSvg as B,createHiddenSvg as E,createSvgElement as X}from\"../../views/2d/engine/svgUtils.js\";import{glyphSize as N,magicLabelLineHeight as J,hittestToleranceSmallSymbol as O,hittestSmallSymbolThreshold as V}from\"../../views/2d/engine/webgl/definitions.js\";import{shapeGlyphs as q}from\"../../views/2d/engine/webgl/mesh/templates/shapingUtils.js\";import{roundPtToWholePixel as Y,getLineWidth as W}from\"../../views/2d/layers/graphics/graphicsUtils.js\";const K=Math.PI/180,Q=.5,Z=()=>r.getLogger(\"esri.symbols.cim.CIMSymbolDrawHelper\");class ${constructor(t){this._t=t}static createIdentity(){return new $([1,0,0,0,1,0])}clone(){const t=this._t;return new $(t.slice())}transform(t){const e=this._t;return[e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}static createScale(t,e){return new $([t,0,0,0,e,0])}scale(t,e){const r=this._t;return r[0]*=t,r[1]*=t,r[2]*=t,r[3]*=e,r[4]*=e,r[5]*=e,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,e){return new $([0,0,t,0,0,e])}translate(t,e){const r=this._t;return r[2]+=t,r[5]+=e,this}static createRotate(t){const e=Math.cos(t),r=Math.sin(t);return new $([e,-r,0,r,e,0])}rotate(t){return $.multiply(this,$.createRotate(t),this)}angle(){const t=this._t[0],e=this._t[3],r=Math.sqrt(t*t+e*e);return[t/r,e/r]}static multiply(t,e,r){const s=t._t,i=e._t,o=s[0]*i[0]+s[3]*i[1],n=s[1]*i[0]+s[4]*i[1],a=s[2]*i[0]+s[5]*i[1]+i[2],l=s[0]*i[3]+s[3]*i[4],h=s[1]*i[3]+s[4]*i[4],c=s[2]*i[3]+s[5]*i[4]+i[5],m=r._t;return m[0]=o,m[1]=n,m[2]=a,m[3]=l,m[4]=h,m[5]=c,r}invert(){const t=this._t;let e=t[0]*t[4]-t[1]*t[3];if(0===e)return new $([0,0,0,0,0,0]);e=1/e;const r=(t[1]*t[5]-t[2]*t[4])*e,s=(t[2]*t[3]-t[0]*t[5])*e,i=t[4]*e,o=-t[1]*e,n=-t[3]*e,a=t[0]*e;return new $([i,o,r,n,a,s])}}class tt{constructor(t,e){this._resourceManager=t,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new s(w,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(e||$.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1)}setTransform(t,e){this._transfos=[t||$.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)]}setGeomUnitsPerPoint(t){this._geomUnitsPerPoint=t}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(t){return this._transfos[this._transfos.length-1].invert().transform(t)}reverseTransformSize(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(t){return t/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(t,e){const r=e?t.scaleRatio():1;$.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*r)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(t,e,r){if(t)switch(t.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":this.drawMultiLayerSymbol(t,e);break;case\"CIMTextSymbol\":this.drawTextSymbol(t,e,r)}}drawMultiLayerSymbol(t,e){if(!t||!e)return;const r=t.symbolLayers;if(!r)return;const s=t.effects;if(s&&s.length>0){const t=this.executeEffects(s,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayers(r,e.asJSON()),e=t.next()}}else this.drawSymbolLayers(r,e)}executeEffects(t,e){const r=this._resourceManager.geometryEngine;let s=new _(n.fromJSONCIM(e));for(const i of t){const t=y(i);t&&(s=t.execute(s,i,this.geomUnitsPerPoint(),null,r))}return s}drawSymbolLayers(t,e){let r=t.length;for(;r--;){const s=t[r];if(!s||!1===s.enable)continue;const i=s.effects;if(i&&i.length>0){const t=this.executeEffects(i,e);if(t){let e=null;for(;(e=t.next())&&(this.drawSymbolLayer(s,e.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(s,e);if(this._earlyReturn)return}}drawSymbolLayer(t,e){switch(t.type){case\"CIMSolidFill\":this.drawSolidFill(e,t.color,t.path);break;case\"CIMHatchFill\":this.drawHatchFill(e,t);break;case\"CIMPictureFill\":this.drawPictureFill(e,t);break;case\"CIMGradientFill\":this.drawGradientFill(e,t);break;case\"CIMSolidStroke\":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit,t.path);break;case\"CIMPictureStroke\":this.drawPictureStroke(e,t);break;case\"CIMGradientStroke\":this.drawGradientStroke(e,t);break;case\"CIMCharacterMarker\":case\"CIMPictureMarker\":case\"CIMVectorMarker\":this.drawMarkerLayer(t,e)}}drawHatchFill(t,e){const r=it(e,t,this.geomUnitsPerPoint());r&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,r),this.popClipPath())}drawPictureFill(t,e){}drawGradientFill(t,e){}drawPictureStroke(t,e){}drawGradientStroke(t,e){}drawMarkerLayer(t,e){const r=t.markerPlacement;if(r){const s=P(r);if(s){const i=\"CIMMarkerPlacementInsidePolygon\"===r.type||\"CIMMarkerPlacementPolygonCenter\"===r.type&&r.clipAtBoundary;i&&this.pushClipPath(e);const o=s.execute(n.fromJSONCIM(e),r,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(o){let e=null;for(;(e=o.next())&&(this.drawMarker(t,e),!this._earlyReturn););}i&&this.popClipPath()}}else{const r=this._placementPool.acquire();if(m(e))r.tx=e.x,r.ty=e.y,this.drawMarker(t,r);else if(f(e)){const s=c(e);s&&([r.tx,r.ty]=s,this.drawMarker(t,r))}else for(const s of e.points)if(r.tx=s[0],r.ty=s[1],this.drawMarker(t,r),this._earlyReturn)break;this._placementPool.release(r)}}drawMarker(t,e){switch(t.type){case\"CIMCharacterMarker\":case\"CIMPictureMarker\":this.drawPictureMarker(t,e);break;case\"CIMVectorMarker\":this.drawVectorMarker(t,e)}}drawPictureMarker(t,e){if(!t)return;const r=this._resourceManager.getResource(t.url),s=I(t.size,x.CIMPictureMarker.size);if(null==r||s<=0)return;const i=r.width,o=r.height;if(!i||!o)return;const n=i/o,a=I(t.scaleX,1),l=$.createIdentity(),h=t.anchorPoint;if(h){let e=h.x,r=h.y;\"Absolute\"!==t.anchorPointUnits&&(e*=s*n*a,r*=s),l.translate(-e,-r)}let c=I(t.rotation);t.rotateClockwise&&(c=-c),this._mapRotation&&(c+=this._mapRotation),c&&l.rotate(c*K);let m=I(t.offsetX),f=I(t.offsetY);if(m||f){if(this._mapRotation){const t=K*this._mapRotation,e=Math.cos(t),r=Math.sin(t),s=m*r+f*e;m=m*e-f*r,f=s}l.translate(m,f)}const u=this.geomUnitsPerPoint();1!==u&&l.scale(u,u);const d=e.getAngle();d&&l.rotate(d),l.translate(e.tx,e.ty),this.push(l,!1),this.drawImage(t,s),this.pop()}drawVectorMarker(t,e){if(!t)return;const r=t.markerGraphics;if(!r)return;const s=I(t.size,x.CIMVectorMarker.size),i=t.frame,o=i?i.ymax-i.ymin:0,n=s&&o?s/o:1,a=$.createIdentity();i&&a.translate(.5*-(i.xmax+i.xmin),.5*-(i.ymax+i.ymin));const l=t.anchorPoint;if(l){let e=l.x,r=l.y;\"Absolute\"!==t.anchorPointUnits?i&&(e*=i.xmax-i.xmin,r*=i.ymax-i.ymin):(e/=n,r/=n),a.translate(-e,-r)}1!==n&&a.scale(n,n);let h=I(t.rotation);t.rotateClockwise&&(h=-h),this._mapRotation&&(h+=this._mapRotation),h&&a.rotate(h*K);let c=I(t.offsetX),m=I(t.offsetY);if(c||m){if(this._mapRotation){const t=K*this._mapRotation,e=Math.cos(t),r=Math.sin(t),s=c*r+m*e;c=c*e-m*r,m=s}a.translate(c,m)}const f=this.geomUnitsPerPoint();1!==f&&a.scale(f,f);const u=e.getAngle();u&&a.rotate(u),a.translate(e.tx,e.ty),this.push(a,t.scaleSymbolsProportionally);for(const d of r){d?.symbol&&d.geometry||Z().error(\"Invalid marker graphic\",d);let t=d.textString;if(\"number\"==typeof t&&(t=t.toString()),this.drawSymbol(d.symbol,d.geometry,t),this._earlyReturn)break}this.pop()}drawTextSymbol(t,e,r){if(!t)return;if(!m(e))return;if(I(t.height,x.CIMTextSymbol.height)<=0)return;const s=$.createIdentity();let i=I(t.angle);i=-i,i&&s.rotate(i*K);const o=I(t.offsetX),n=I(t.offsetY);(o||n)&&s.translate(o,n);const a=this.geomUnitsPerPoint();1!==a&&s.scale(a,a),s.translate(e.x,e.y),this.push(s,!1),this.drawText(t,r),this.pop()}}class et extends tt{constructor(t,e){super(t,e),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new k(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return a(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(t){if(t&&!(this._clipCount>0))if(f(t))this._processPath(t.rings,0);else if(u(t))this._processPath(t.paths,0);else if(d(t)){const e=lt(t);e&&this._processPath(e.rings,0)}else console.error(\"drawSolidFill Unexpected geometry type!\")}drawSolidStroke(t,e,r){if(!t||this._clipCount>0||null==r||r<=0)return;const s=Math.max(.5*this.transformSize(I(r,x.CIMSolidStroke.width)),.5*Q);if(f(t))this._processPath(t.rings,s);else if(u(t))this._processPath(t.paths,s);else if(d(t)){const e=lt(t);e&&this._processPath(e.rings,s)}else console.error(\"drawSolidStroke unexpected geometry type!\")}drawMarkerLayer(t,e){f(e)&&t.markerPlacement&&(\"CIMMarkerPlacementInsidePolygon\"===t.markerPlacement.type||\"CIMMarkerPlacementPolygonCenter\"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._processPath(e.rings,0):super.drawMarkerLayer(t,e)}drawHatchFill(t,e){this.drawSolidFill(t)}drawPictureFill(t,e){this.drawSolidFill(t)}drawGradientFill(t,e){this.drawSolidFill(t)}drawPictureStroke(t,e){this.drawSolidStroke(t,null,e.width)}drawGradientStroke(t,e){this.drawSolidStroke(t,null,e.width)}pushClipPath(t){this.drawSolidFill(t),this._clipCount++}popClipPath(){this._clipCount--}drawImage(t,e){const{url:r}=t,s=I(t.scaleX,1);let i=s*e,o=e;const n=this._resourceManager.getResource(r);if(null!=n){const t=n.height/n.width;i=s*(e?t>1?e:e/t:n.width),o=e?t>1?e*t:e:n.height}this._merge(this.transformPt([-i/2,-o/2]),0),this._merge(this.transformPt([-i/2,o/2]),0),this._merge(this.transformPt([i/2,-o/2]),0),this._merge(this.transformPt([i/2,o/2]),0)}drawText(t,e){if(!e||0===e.length)return;this._textRasterizer||(this._textRasterizer=new C);const r=ct(t);let[s,o]=this._textRasterizer.computeTextSize(e,r);s=i(s),o=i(o);const n=this.transformSize(1)*this.reverseTransformScalar(1);s*=n,o*=n;let a=0;switch(t.horizontalAlignment){case\"Left\":a=s/2;break;case\"Right\":a=-s/2}let l=0;switch(t.verticalAlignment){case\"Bottom\":l=o/2;break;case\"Top\":l=-o/2;break;case\"Baseline\":l=o/6}this._merge(this.transformPt([-s/2+a,-o/2+l]),0),this._merge(this.transformPt([-s/2+a,o/2+l]),0),this._merge(this.transformPt([s/2+a,-o/2+l]),0),this._merge(this.transformPt([s/2+a,o/2+l]),0)}_processPath(t,e){if(t)for(const r of t){const t=r?r.length:0;if(t>1){this._merge(this.transformPt(r[0]),e);for(let s=1;s<t;s++)this._merge(this.transformPt(r[s]),e)}}}_merge(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e)}}class rt extends tt{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null,this._svg=null,this._path=null,this._canvas=null}destroy(){this._svg=B(this._svg),this._path=null,this._canvas=null}hitTest(t,e,r,s,n,a){const l=a*o(1);this.setTransform(),this.setGeomUnitsPerPoint(l),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/l,this._textInfo=s;const h=e&&(\"CIMPointSymbol\"===e.type&&\"Map\"!==e.angleAlignment||\"CIMTextSymbol\"===e.type);if(this._mapRotation=h?n:0,!has(\"esri-mobile\")){const t=i(O*window.devicePixelRatio),r=i(V);!((\"CIMLineSymbol\"===e?.type||\"CIMPolygonSymbol\"===e?.type)&&e.symbolLayers?.some(v))&&\"CIMMeshSymbol\"!==e?.type&&(T(e)??0)<r&&(this._searchDistPoint=t)}return this._earlyReturn=!1,this.drawSymbol(e,r),this._earlyReturn}executeEffects(t,e){return\"CIMGeometricEffectDashes\"===t.at(-1)?.type&&(t=t.slice(0,-1)),super.executeEffects(t,e)}drawSolidFill(t,e,r){null!=r?this._hittestSvgPath(t,r,!0):this._hitTestFill(t)}drawHatchFill(t,e){this._hitTestFill(t)}drawPictureFill(t,e){this._hitTestFill(t)}drawGradientFill(t,e){this._hitTestFill(t)}drawSolidStroke(t,e,r,s,i,o,n){null!=n?this._hittestSvgPath(t,n,!1,r):this._hitTestStroke(t,r)}drawPictureStroke(t,e){this._hitTestStroke(t,e.width)}drawGradientStroke(t,e){this._hitTestStroke(t,e.width)}drawMarkerLayer(t,e){t.markerPlacement&&(\"CIMMarkerPlacementInsidePolygon\"===t.markerPlacement.type||\"CIMMarkerPlacementPolygonCenter\"===t.markerPlacement.type&&t.markerPlacement.clipAtBoundary)?this._hitTestFill(e):super.drawMarkerLayer(t,e)}pushClipPath(t){}popClipPath(){}drawImage(t,e){const{url:r}=t,s=I(t.scaleX,1),i=this._resourceManager.getResource(r);if(null==i||0===i.height||0===e)return;const o=e*this.geomUnitsPerPoint(),n=o*s*(i.width/i.height),a=this.reverseTransformPt(this._searchPoint),l=this._searchDistPoint;Math.abs(a[0])<n/2+l&&Math.abs(a[1])<o/2+l&&(this._earlyReturn=!0)}drawText(t,e){const r=this._textInfo;if(!r)return;const s=r.get(t);if(!s)return;if(!s.glyphMosaicItems.glyphs.length)return;const i=Y(I(t.height,x.CIMTextSymbol.height)),{lineGapType:o,lineGap:n}=t,a=o?ht(o,I(n),i):0,l=\"CIMBackgroundCallout\"===t.callout?.type,h=q(s.glyphMosaicItems,{scale:i/N,angle:0,xOffset:0,yOffset:0,horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,maxLineWidth:W(t.lineWidth),lineHeight:J*Math.max(.25,Math.min(a||1,4)),decoration:t.font.decoration||\"none\",useCIMAngleBehavior:!0,hasBackground:l}),c=this.reverseTransformPt(this._searchPoint),m=c[0],f=c[1];for(const u of h.glyphs)if(m>u.xTopLeft&&m<u.xBottomRight&&f>-u.yBottomRight&&f<-u.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(t){let e=null;if(d(t)){const r=t;e=[[[r.xmin,r.ymin],[r.xmin,r.ymax],[r.xmax,r.ymax],[r.xmax,r.ymin],[r.xmin,r.ymin]]]}else if(f(t))e=t.rings;else{if(!u(t))return;e=t.paths}const r=this.reverseTransformPt(this._searchPoint);if(ot(r,e)&&(this._earlyReturn=!0),!this._earlyReturn){nt(r,e,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}_getSvgPath(){return null!=this._svg&&null!=this._path||(this._svg??=E(),this._path??=X(\"path\"),this._svg.appendChild(this._path)),this._path}_getCanvas(){return this._canvas??=document.createElement(\"canvas\"),this._canvas}_hittestSvgPath(t,e,r,s){const i=l();h(i,t);const o={x:i[0],y:i[1],width:i[2]-i[0],height:i[3]-i[1]},n=this._getSvgPath();n.setAttribute(\"d\",e);const a=n.getBBox(),c=a.width/o.width,m=a.height/o.height,f=this._getCanvas();f.width=a.width,f.height=a.height;const u=f.getContext(\"2d\",{willReadFrequently:!0});u.setTransform(1,0,0,1,a.x,-a.y);const d=new Path2D(e);r?u.fill(d):(u.lineWidth=s*c,u.stroke(d));const p=this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint(),_=this.reverseTransformPt(this._searchPoint),g=(_[0]-o.x-p)*c,y=(o.height-(_[1]-o.y)-p)*m,P=2*p*c,w=2*p*m,x=u.getImageData(g,y,P,w).data;for(let l=3;l<x.length;l+=4)if(x[l]>127.5)return void(this._earlyReturn=!0)}_hitTestStroke(t,e){let r=null;if(d(t)){const e=t;r=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}else if(f(t))r=t.rings;else{if(!u(t))return;r=t.paths}nt(this.reverseTransformPt(this._searchPoint),r,I(e,x.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class st extends tt{constructor(t,e,r,s){super(e,r),this._applyAdditionalRenderProps=s,this._colorSubstitutionHelper=new g,this._ctx=t}drawSolidFill(t,e){if(!t)return;if(f(t))this._buildPath(t.rings,!0);else if(u(t))this._buildPath(t.paths,!0);else if(d(t))this._buildPath(lt(t).rings,!0);else{if(!p(t))return;console.log(\"CanvasDrawHelper.drawSolidFill - No implementation!\")}const r=this._ctx;r.fillStyle=\"string\"==typeof e?e:\"rgba(\"+Math.round(e[0])+\",\"+Math.round(e[1])+\",\"+Math.round(e[2])+\",\"+(e[3]??255)/255+\")\",r.fill(\"evenodd\")}drawSolidStroke(t,e,r,s,i,o){if(!t||!e||0===r)return;if(f(t))this._buildPath(t.rings,!0);else if(u(t))this._buildPath(t.paths,!1);else{if(!d(t))return void console.log(\"CanvasDrawHelper.drawSolidStroke isn't implemented!\");this._buildPath(lt(t).rings,!0)}const n=this._ctx;n.strokeStyle=\"string\"==typeof e?e:\"rgba(\"+Math.round(e[0])+\",\"+Math.round(e[1])+\",\"+Math.round(e[2])+\",\"+(e[3]??255)/255+\")\",n.lineWidth=Math.max(this.transformSize(r),Q),this._setCapStyle(s),this._setJoinStyle(i),n.miterLimit=o,n.stroke()}pushClipPath(t){if(this._ctx.save(),f(t))this._buildPath(t.rings,!0);else if(u(t))this._buildPath(t.paths,!0);else{if(!d(t))return;this._buildPath(lt(t).rings,!0)}this._ctx.clip(\"evenodd\")}popClipPath(){this._ctx.restore()}drawImage(t,e){const{colorSubstitutions:r,url:s,tintColor:i}=t,o=I(t.scaleX,1),n=this._resourceManager.getResource(s);if(null==n)return;let a=e*(n.width/n.height),l=e;e||(a=n.width,l=n.height);const h=R(s)||\"src\"in n&&R(n.src);let c=\"getFrame\"in n?b(n):n;r&&(c=this._colorSubstitutionHelper.applyColorSubstitution(c,r)),this._applyAdditionalRenderProps&&!h&&i&&(c=this._colorSubstitutionHelper.tintImageData(c,i));const m=this.transformPt([0,0]),[f,u]=this.getTransformAngle(),d=this.transformSize(1),p=this._ctx;p.save(),p.setTransform({m11:o*d*f,m12:o*d*u,m21:-d*u,m22:d*f,m41:m[0],m42:m[1]}),p.drawImage(c,-a/2,-l/2,a,l),p.restore()}drawText(t,e){if(!e||0===e.length)return;this._textRasterizer||(this._textRasterizer=new C);const r=ct(t,this.transformSize(i(1))),s=this._textRasterizer.rasterizeText(e,r);if(!s)return;const{size:o,anchorX:n,anchorY:a,canvas:l}=s,h=o[0]*(n+.5),c=o[1]*(a-.5),m=this._ctx,f=this.transformPt([0,0]),[u,d]=this.getTransformAngle(),p=1;m.save(),m.setTransform({m11:p*u,m12:p*d,m21:-p*d,m22:p*u,m41:f[0]-p*h,m42:f[1]+p*c}),m.drawImage(l,0,0),m.restore()}drawPictureFill(t,e){if(!t)return;let{colorSubstitutions:r,height:s,offsetX:i,offsetY:o,rotation:n,scaleX:a,tintColor:l,url:h}=e;const c=this._resourceManager.getResource(h);if(null==c)return;if(f(t))this._buildPath(t.rings,!0);else if(u(t))this._buildPath(t.paths,!0);else if(d(t))this._buildPath(lt(t).rings,!0);else{if(!p(t))return;console.log(\"CanvasDrawHelper.drawPictureFill - No implementation!\")}const m=this._ctx,_=R(h)||\"src\"in c&&R(c.src);let g,y=\"getFrame\"in c?b(c):c;if(r&&(y=this._colorSubstitutionHelper.applyColorSubstitution(y,r)),this._applyAdditionalRenderProps){_||l&&(y=this._colorSubstitutionHelper.tintImageData(y,l)),g=m.createPattern(y,\"repeat\");const t=this.transformSize(1);n||(n=0),i?i*=t:i=0,o?o*=t:o=0,s&&(s*=t);const e=s?s/c.height:1,r=a&&s?a*s/c.width:1;if(0!==n||1!==e||1!==r||0!==i||0!==o){const t=new DOMMatrix;t.rotateSelf(0,0,-n).translateSelf(i,o).scaleSelf(r,e,1),g.setTransform(t)}}else g=m.createPattern(y,\"repeat\");m.save(),m.fillStyle=g,m.fill(\"evenodd\"),m.restore()}drawPictureStroke(t,r){if(!t)return;let{colorSubstitutions:s,capStyle:i,joinStyle:n,miterLimit:a,tintColor:l,url:h,width:c}=r;const m=this._resourceManager.getResource(h);if(null==m)return;let _;if(f(t))_=t.rings;else if(u(t))_=t.paths;else{if(!d(t))return p(t)?void console.log(\"CanvasDrawHelper.drawPictureStroke - No implementation!\"):void 0;_=lt(t).rings}c||(c=m.width);const g=R(h)||\"src\"in m&&R(m.src);let y=\"getFrame\"in m?b(m):m;s&&(y=this._colorSubstitutionHelper.applyColorSubstitution(y,s)),this._applyAdditionalRenderProps&&(g||l&&(y=this._colorSubstitutionHelper.tintImageData(y,l)));const P=Math.max(this.transformSize(o(c)),.5),w=P/y.width,x=this._ctx,S=x.createPattern(y,\"repeat-y\");let M,k;x.save(),this._setCapStyle(i),this._setJoinStyle(n),void 0!==a&&(x.miterLimit=a),x.lineWidth=P;for(let o of _)if(o=e(o),ft(o),o&&!(o.length<=1)){M=this.transformPt(o[0]);for(let t=1;t<o.length;t++){k=this.transformPt(o[t]);const e=at(M,k),r=new DOMMatrix;r.translateSelf(0,M[1]-P/2).scaleSelf(w,w,1).rotateSelf(0,0,90-e),S.setTransform(r),x.strokeStyle=S,x.beginPath(),x.moveTo(M[0],M[1]),x.lineTo(k[0],k[1]),x.stroke(),M=k}}x.restore()}_buildPath(t,e){const r=this._ctx;if(r.beginPath(),t)for(const s of t){const t=s?s.length:0;if(t>1){let i=this.transformPt(s[0]);r.moveTo(i[0],i[1]);for(let e=1;e<t;e++)i=this.transformPt(s[e]),r.lineTo(i[0],i[1]);e&&r.closePath()}}}_setCapStyle(t){switch(t){case S.Butt:this._ctx.lineCap=\"butt\";break;case S.Round:this._ctx.lineCap=\"round\";break;case S.Square:this._ctx.lineCap=\"square\"}}_setJoinStyle(t){switch(t){case M.Bevel:this._ctx.lineJoin=\"bevel\";break;case M.Round:this._ctx.lineJoin=\"round\";break;case M.Miter:this._ctx.lineJoin=\"miter\"}}}function it(t,e,r){let s=I(t.separation,x.CIMHatchFill.separation)*r,i=I(t.rotation);if(0===s)return null;s<0&&(s=-s);let o=0;const n=.5*s;for(;o>n;)o-=s;for(;o<-n;)o+=s;const a=l();h(a,e),a[0]-=n,a[1]-=n,a[2]+=n,a[3]+=n;const c=[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]]];for(;i>180;)i-=180;for(;i<0;)i+=180;const m=Math.cos(i*K),f=Math.sin(i*K),u=-s*f,d=s*m;let p,_,g,y;o=I(t.offsetX)*r*f-I(t.offsetY)*r*m,p=g=Number.MAX_VALUE,_=y=-Number.MAX_VALUE;for(const l of c){const t=l[0],e=l[1],r=m*t+f*e,s=-f*t+m*e;p=Math.min(p,r),g=Math.min(g,s),_=Math.max(_,r),y=Math.max(y,s)}g=Math.floor(g/s)*s;let P=m*p-f*g-u*o/s,w=f*p+m*g-d*o/s,S=m*_-f*g-u*o/s,M=f*_+m*g-d*o/s;const b=1+Math.round((y-g)/s),k=[];for(let l=0;l<b;l++)P+=u,w+=d,S+=u,M+=d,k.push([[P,w],[S,M]]);return{paths:k}}function ot(t,e){let r=0;for(const s of e){const e=s.length;for(let i=1;i<e;i++){const e=s[i-1],o=s[i];if(e[1]>t[1]==o[1]>t[1])continue;(o[0]-e[0])*(t[1]-e[1])-(o[1]-e[1])*(t[0]-e[0])>0?r++:r--}}return 0!==r}function nt(t,e,r){for(const s of e){const e=s.length;for(let i=1;i<e;i++){const e=s[i-1],o=s[i];let n=(o[0]-e[0])*(o[0]-e[0])+(o[1]-e[1])*(o[1]-e[1]);if(0===n)continue;n=Math.sqrt(n);const a=((o[0]-e[0])*(t[1]-e[1])-(o[1]-e[1])*(t[0]-e[0]))/n;if(Math.abs(a)<r){const s=((o[0]-e[0])*(t[0]-e[0])+(o[1]-e[1])*(t[1]-e[1]))/n;if(s>-r&&s<n+r)return!0}}}return!1}function at(t,e){const r=e[0]-t[0],s=e[1]-t[1];return 180/Math.PI*Math.atan2(s,r)}const lt=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,ht=(t,e,r)=>{switch(t){case\"ExtraLeading\":return 1+e/r;case\"Multiple\":return e;case\"Exact\":return e/r}};function ct(e,r=1){const s=z(e),i=F(e.fontStyleName),o=e.fontFamilyName??t,{weight:n,style:a}=i,l=r*(e.height||5),h=L(e.horizontalAlignment),c=U(e.verticalAlignment),m=A(e),f=A(e.haloSymbol),u=null!=f?r*(e.haloSize??0):0,d=j(e.symbol),p=r*(G(e.symbol)||0),_=\"CIMBackgroundCallout\"===e.callout?.type?e.callout.backgroundSymbol:null,g=A(_),y=G(_),P=j(_);return{color:m,size:l,horizontalAlignment:h,verticalAlignment:c,font:{family:o,style:D(a),weight:H(n),decoration:s},outline:{size:p||0,color:d},halo:{size:u||0,color:f,style:a},backgroundColor:g,borderLine:null!=y&&null!=P?{size:y,color:P}:null,pixelRatio:1,premultiplyColors:!0}}const mt=1e-4;function ft(t){let e,r,s,i,o,n=t[0],a=1;for(;a<t.length;)e=t[a][0]-n[0],r=t[a][1]-n[1],i=0!==e?r/e:Math.PI/2,void 0!==s&&i-s<=mt?(t.splice(a-1,1),n=o):(o=n,n=t[a],a++),s=i}export{tt as CIMSymbolDrawHelper,st as CanvasDrawHelper,et as EnvDrawHelper,rt as HittestDrawHelper,$ as Transformation,K as cDegToRad,ht as lineGapType2LineHeight};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{bidiText as e}from\"../../core/BidiText.js\";import has from\"../../core/has.js\";import{clone as t}from\"../../core/lang.js\";import r from\"../../core/Logger.js\";import o from\"../../core/RandomLCG.js\";import{px2pt as a}from\"../../core/screenUtils.js\";import{create as s,expandPointInPlace as i}from\"../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as n}from\"../../geometry/support/boundsUtils.js\";import l from\"../Font.js\";import{Placement as c}from\"./CIMPlacements.js\";import{EnvDrawHelper as m,Transformation as f,CanvasDrawHelper as y,lineGapType2LineHeight as h}from\"./CIMSymbolDrawHelper.js\";import{defaultCIMValues as u}from\"./defaultCIMValues.js\";import{LineCapStyle as p,LineJoinStyle as M,TextureFilter as S,ExtremityPlacement as d,BlockProgression as g,FontEffects as b,FontEncoding as C,FontType as x,GlyphHinting as I,TextReadingDirection as k,VerticalGlyphOrientation as w,BillBoardMode as P,LineDashEnding as L}from\"./enums.js\";import{getNumericValue as F,fromCIMFontStyle as z,fromCIMFontDecoration as D,isGeometryEngineRequired as E,importGeometryEngine as G}from\"./utils.js\";import{defaultPolylineSymbol2D as T}from\"../support/defaults.js\";import{cInfinity as v}from\"../../views/2d/engine/vectorTiles/GeometryUtils.js\";import{glyphSize as A,magicLabelLineHeight as R,randomInsidePolygonTextureSize as j}from\"../../views/2d/engine/webgl/definitions.js\";import{shapeGlyphs as B}from\"../../views/2d/engine/webgl/mesh/templates/shapingUtils.js\";import{roundPtToWholePixel as X,getLineWidth as V}from\"../../views/2d/layers/graphics/graphicsUtils.js\";const N=Math.PI,Y=N/2,_=Math.PI/180,U=96/72,q=1.4142135623730951,H=4,O=()=>r.getLogger(\"esri.symbols.cim.CIMSymbolHelper\");function W(e){let t;switch(e.type){case\"cim\":return e.data;case\"web-style\":return e;case\"simple-marker\":{const r=ee.fromSimpleMarker(e);if(!r)throw new Error(\"InternalError: Cannot convert symbol to CIM\");t=r;break}case\"picture-marker\":t=ee.fromPictureMarker(e);break;case\"simple-line\":t=ee.fromSimpleLineSymbol(e);break;case\"simple-fill\":t=ee.fromSimpleFillSymbol(e);break;case\"picture-fill\":t=ee.fromPictureFillSymbol(e);break;case\"text\":t=ee.fromTextSymbol(e)}return{type:\"CIMSymbolReference\",symbol:t}}function $(e,t,r){switch(t.type){case\"CIMSymbolReference\":return $(e,t.symbol,r);case\"CIMPointSymbol\":null==r&&(r={x:0,y:0}),e.drawSymbol(t,r);break;case\"CIMLineSymbol\":null==r&&(r={paths:[[[0,0],[10,0]]]}),e.drawSymbol(t,r);break;case\"CIMPolygonSymbol\":null==r&&(r={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),e.drawSymbol(t,r);break;case\"CIMTextSymbol\":{const r={x:0,y:0};e.drawSymbol(t,r);break}case\"CIMVectorMarker\":{const r=new c;e.drawMarker(t,r);break}}return e.envelope()}function J(e){if(!e)return 0;switch(e.type){case\"CIMMarkerPlacementAlongLineSameSize\":case\"CIMMarkerPlacementAlongLineRandomSize\":case\"CIMMarkerPlacementAtExtremities\":case\"CIMMarkerPlacementAtMeasuredUnits\":case\"CIMMarkerPlacementAtRatioPositions\":case\"CIMMarkerPlacementOnLine\":case\"CIMMarkerPlacementOnVertices\":return Math.abs(e.offset);default:return 0}}function K(e){if(!e)return 0;switch(e.type){case\"CIMGeometricEffectArrow\":return Math.abs(.5*e.width);case\"CIMGeometricEffectBuffer\":return Math.abs(e.size);case\"CIMGeometricEffectControlMeasureLine\":return 500;case\"CIMGeometricEffectExtension\":case\"CIMGeometricEffectRadial\":return Math.abs(e.length);case\"CIMGeometricEffectJog\":return Math.abs(.5*e.length);case\"CIMGeometricEffectMove\":return Math.max(Math.abs(F(e.offsetX)),Math.abs(F(e.offsetY)));case\"CIMGeometricEffectOffset\":case\"CIMGeometricEffectOffsetTangent\":return Math.abs(e.offset);case\"CIMGeometricEffectRegularPolygon\":return Math.abs(e.radius);case\"CIMGeometricEffectRotate\":case\"CIMGeometricEffectScale\":default:return 0;case\"CIMGeometricEffectTaperedPolygon\":return.5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case\"CIMGeometricEffectWave\":return Math.abs(e.amplitude);case\"CIMGeometricEffectDonut\":return Math.abs(e.width)}}function Q(e){if(!e)return 0;let t=0;for(const r of e)t+=K(r);return t}class Z{static getSymbolInflateSize(e,t,r,o,a){return e||(e=[0,0,0,0]),t?this._getInflateSize(e,t,r,o,a):e}static safeSize(e){const t=Math.max(Math.abs(e[0]),Math.abs(e[2])),r=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(t*t+r*r)}static _vectorMarkerBounds(e,t,r,o){let a=!0;const i=s();if(t?.markerGraphics)for(const s of t.markerGraphics){const t=[0,0,0,0];s.geometry&&(n(i,s.geometry),t[0]=0,t[1]=0,t[2]=0,t[3]=0,this.getSymbolInflateSize(t,s.symbol,r,0,o),i[0]+=t[0],i[1]+=t[1],i[2]+=t[2],i[3]+=t[3],a?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],a=!1):(e[0]=Math.min(e[0],i[0]),e[1]=Math.min(e[1],i[1]),e[2]=Math.max(e[2],i[2]),e[3]=Math.max(e[3],i[3])))}return e}static _getInflateSize(e,t,r,o,a){if(fe(t)){const s=this._getLayersInflateSize(e,t.symbolLayers,r,o,a),i=Q(t.effects);return i>0&&(s[0]-=i,s[1]-=i,s[2]+=i,s[3]+=i),s}return this._getTextInflatedSize(e,t,a)}static _getLayersInflateSize(e,t,r,o,a){let n=!0;if(!t)return e;for(const l of t){if(!l)continue;let t=[0,0,0,0];switch(l.type){case\"CIMSolidFill\":case\"CIMPictureFill\":case\"CIMHatchFill\":case\"CIMGradientFill\":break;case\"CIMSolidStroke\":case\"CIMPictureStroke\":case\"CIMGradientStroke\":{const e=l;let r=e.width;null!=r&&(e.capStyle===p.Square||e.joinStyle===M.Miter?r/=q:r/=2,t[0]=-r,t[1]=-r,t[2]=r,t[3]=r);break}case\"CIMCharacterMarker\":case\"CIMVectorMarker\":case\"CIMPictureMarker\":{const e=l;if(\"CIMVectorMarker\"===l.type){const e=l;if(t=this._vectorMarkerBounds(t,e,r,a),e.frame){const r=(e.frame.xmin+e.frame.xmax)/2,o=(e.frame.ymin+e.frame.ymax)/2;if(t[0]-=r,t[1]-=o,t[2]-=r,t[3]-=o,null!=e.size){const r=e.size/(e.frame.ymax-e.frame.ymin);t[0]*=r,t[1]*=r,t[2]*=r,t[3]*=r}}}else if(\"CIMPictureMarker\"===l.type){const o=l,a=r.getResource(o.url);let s=1;if(null!=a&&a.height&&(s=a.width/a.height),null!=e.size){const r=e.size/2,a=e.size*s*o.scaleX/2;t=[-a,-r,a,r]}}else if(null!=e.size){const r=e.size/2;t=[-r,-r,r,r]}if(e.anchorPoint){let r,o;\"Absolute\"===e.anchorPointUnits?(r=e.anchorPoint.x,o=e.anchorPoint.y):(r=e.anchorPoint.x*(t[2]-t[0]),o=e.anchorPoint.y*(t[3]-t[1]));const a=1.25*Math.sqrt(r*r+o*o);t[0]-=a,t[1]-=a,t[2]+=a,t[3]+=a}let n=F(e.rotation);if(e.rotateClockwise&&(n=-n),o&&(n-=o),n){const e=_*n,r=Math.cos(e),o=Math.sin(e),a=s([v,v,-v,-v]);i(a,[t[0]*r-t[1]*o,t[0]*o+t[1]*r]),i(a,[t[0]*r-t[3]*o,t[0]*o+t[3]*r]),i(a,[t[2]*r-t[1]*o,t[2]*o+t[1]*r]),i(a,[t[2]*r-t[3]*o,t[2]*o+t[3]*r]),t=a}let c=F(e.offsetX),m=F(e.offsetY);if(o){const e=_*o,t=Math.cos(e),r=Math.sin(e),a=c*r+m*t;c=c*t-m*r,m=a}t[0]+=c,t[1]+=m,t[2]+=c,t[3]+=m;const f=J(e.markerPlacement);f>0&&(t[0]-=f,t[1]-=f,t[2]+=f,t[3]+=f);break}}const c=Q(l.effects);c>0&&(t[0]-=c,t[1]-=c,t[2]+=c,t[3]+=c),n?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],n=!1):(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]))}return e}static _getTextInflatedSize(e,t,r){const o=X(t.height??u.CIMTextSymbol.height);if(e[0]=-o/2,e[1]=-o/2,e[2]=o/2,e[3]=o/2,!r)return e;const a=r.get(t);if(!a)return e;if(!a.glyphMosaicItems.glyphs.length)return e;const{lineGapType:s,lineGap:i}=t,n=s?h(s,i??0,o):0,l=\"CIMBackgroundCallout\"===t.callout?.type,c=B(a.glyphMosaicItems,{scale:o/A,angle:F(t.angle),xOffset:F(t.offsetX),yOffset:F(t.offsetY),horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,maxLineWidth:V(t.lineWidth),lineHeight:R*Math.max(.25,Math.min(n||1,4)),decoration:t.font.decoration||\"none\",useCIMAngleBehavior:!0,hasBackground:l}).boundsT,m=Math.sqrt(c.width*c.width+c.height*c.height);return e[0]-=c.x+m,e[1]-=c.y-m,e[2]+=c.x+m,e[3]+=-c.y+m,e}}class ee{static getEnvelope(e,t,r){if(!e)return null;const o=new m(r);if(Array.isArray(e)){let r;for(const a of e)r?r.union($(o,a,t)):r=$(o,a,t);return r}return $(o,e,t)}static getTextureAnchor(e,t){const r=this.getEnvelope(e,null,t);if(!r)return[0,0,0];const o=(r.x+.5*r.width)*U,a=(r.y+.5*r.height)*U,s=r.width*U+2,i=r.height*U+2;return[-o/s,-a/i,i]}static rasterize(e,t,r,o,a=!0,s){const i=r||this.getEnvelope(t,null,o);if(!i)return[null,0,0,0,0];const n=Math.max(i.width,i.height)*U;let l=null!=s?Math.max(s/n,1):1;l*=U;const m=(i.x+.5*i.width)*l,h=(i.y+.5*i.height)*l;e.width=i.width*l,e.height=i.height*l,r||(e.width+=2,e.height+=2);const u=e.getContext(\"2d\",{willReadFrequently:!0}),p=f.createScale(l,-l);p.translate(.5*e.width-m,.5*e.height+h);const M=new y(u,o,p);switch(t.type){case\"CIMPointSymbol\":{const e={type:\"point\",x:0,y:0};M.drawSymbol(t,e);break}case\"CIMVectorMarker\":{const e=new c;M.drawMarker(t,e);break}}const S=u.getImageData(0,0,e.width,e.height),d=new Uint8Array(S.data);if(a){let e;for(let t=0;t<d.length;t+=4)e=d[t+3]/255,d[t]=d[t]*e,d[t+1]=d[t+1]*e,d[t+2]=d[t+2]*e}return[d,e.width,e.height,-m/e.width,-h/e.height]}static fromTextSymbol(e){const{text:t}=e;return{type:\"CIMPointSymbol\",symbolLayers:[{type:\"CIMVectorMarker\",enable:!0,anchorPointUnits:\"Relative\",dominantSizeAxis3D:\"Y\",size:10,billboardMode3D:\"FaceNearPlane\",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:{x:0,y:0},symbol:ee.createCIMTextSymbolfromTextSymbol(e),textString:t}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:\"Display\"}}static fromPictureFillSymbol(e){const{height:t,outline:r,width:o,xoffset:a,xscale:s,yoffset:i,yscale:n}=e,l=[],c={type:\"CIMPolygonSymbol\",symbolLayers:l};if(r){const e=pe(r);e&&l.push(e)}let m=e.url;\"esriPFS\"===e.type&&e.imageData&&(m=e.imageData);const f=\"angle\"in e?e.angle??0:0,y=(o??0)*(s||1),h=(t??0)*(n||1);return l.push({type:\"CIMPictureFill\",invertBackfaceTexture:!1,scaleX:1,textureFilter:S.Picture,tintColor:null,url:m,height:h,width:y,offsetX:F(a),offsetY:F(i),rotation:F(-f),colorSubstitutions:null}),c}static fromSimpleFillSymbol(e){const{color:r,style:o,outline:s}=e,i=[],n={type:\"CIMPolygonSymbol\",symbolLayers:i};if(s){const e=pe(s);e&&i.push(e)}if(o&&\"solid\"!==o&&\"none\"!==o&&\"esriSFSSolid\"!==o&&\"esriSFSNull\"!==o){const e={type:\"CIMLineSymbol\",symbolLayers:[{type:\"CIMSolidStroke\",color:ie(r),capStyle:p.Butt,joinStyle:M.Miter,width:.75}]};let s=0;const n=a(he(o)?8:10);switch(o){case\"vertical\":case\"esriSFSVertical\":s=90;break;case\"forward-diagonal\":case\"esriSFSForwardDiagonal\":case\"diagonal-cross\":case\"esriSFSDiagonalCross\":s=-45;break;case\"backward-diagonal\":case\"esriSFSBackwardDiagonal\":s=45;break;case\"cross\":case\"esriSFSCross\":s=0}i.push({type:\"CIMHatchFill\",lineSymbol:e,offsetX:0,offsetY:0,rotation:s,separation:n}),\"cross\"===o||\"esriSFSCross\"===o?i.push({type:\"CIMHatchFill\",lineSymbol:t(e),offsetX:0,offsetY:0,rotation:90,separation:n}):\"diagonal-cross\"!==o&&\"esriSFSDiagonalCross\"!==o||i.push({type:\"CIMHatchFill\",lineSymbol:t(e),offsetX:0,offsetY:0,rotation:45,separation:n})}else!o||\"solid\"!==o&&\"esriSFSSolid\"!==o||i.push({type:\"CIMSolidFill\",enable:!0,color:ie(r)});return n}static fromSimpleLineSymbol(e){const{cap:t,color:r,join:o,marker:a,miterLimit:s,style:i,width:n}=e;let l=null;\"solid\"!==i&&\"none\"!==i&&\"esriSLSSolid\"!==i&&\"esriSLSNull\"!==i&&(l=[{type:\"CIMGeometricEffectDashes\",dashTemplate:me(i,t),lineDashEnding:\"NoConstraint\",scaleDash:!0,offsetAlongLine:null}]);const c=[];if(a){let e;switch(a.placement){case\"begin-end\":e=d.Both;break;case\"begin\":e=d.JustBegin;break;case\"end\":e=d.JustEnd;break;default:e=d.None}const t=ee.fromSimpleMarker(a,n,r).symbolLayers[0];t.markerPlacement={type:\"CIMMarkerPlacementAtExtremities\",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:e,offsetAlongLine:0},c.push(t)}return c.push({type:\"CIMSolidStroke\",color:\"none\"!==i&&\"esriSLSNull\"!==i?ie(r):[0,0,0,0],capStyle:re(t),joinStyle:oe(o),miterLimit:s,width:n,effects:l}),{type:\"CIMLineSymbol\",symbolLayers:c}}static fromPictureMarker(e){const{angle:t,height:r,width:o,xoffset:a,yoffset:s}=e;let i=e.url;return\"esriPMS\"===e.type&&e.imageData&&(i=e.imageData),{type:\"CIMPointSymbol\",symbolLayers:[{type:\"CIMPictureMarker\",invertBackfaceTexture:!1,scaleX:1,textureFilter:S.Picture,tintColor:null,url:i,size:r,width:o,offsetX:F(a),offsetY:F(s),rotation:F(-t)}]}}static createCIMTextSymbolfromTextSymbol(t){const{angle:r,color:o,font:a,haloColor:s,haloSize:i,horizontalAlignment:n,kerning:l,lineWidth:c,text:m,verticalAlignment:f,xoffset:y,yoffset:h,backgroundColor:u,borderLineColor:p,borderLineSize:M}=t;let S,d,L,z,D,E;a&&(S=a.family,d=a.style,L=a.weight,z=a.size,D=a.decoration);let G=!1;if(m){G=e(m)[1]}return(u||M)&&(E={type:\"CIMBackgroundCallout\",margin:null,backgroundSymbol:{type:\"CIMPolygonSymbol\",symbolLayers:[{type:\"CIMSolidFill\",color:ie(u)},{type:\"CIMSolidStroke\",color:ie(p),width:M}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:\"CIMTextSymbol\",angle:r,blockProgression:g.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:b.Normal,fontEncoding:C.Unicode,fontFamilyName:S||\"Arial\",fontStyleName:ne(d,L),fontType:x.Unspecified,haloSize:i,height:z,hinting:I.Default,horizontalAlignment:ae(n??\"center\"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:\"Multiple\",lineWidth:c,offsetX:F(y),offsetY:F(h),strikethrough:\"line-through\"===D,underline:\"underline\"===D,symbol:{type:\"CIMPolygonSymbol\",symbolLayers:[{type:\"CIMSolidFill\",enable:!0,color:ie(o)}]},haloSymbol:{type:\"CIMPolygonSymbol\",symbolLayers:[{type:\"CIMSolidFill\",enable:!0,color:ie(s)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:\"Normal\",textDirection:G?k.RTL:k.LTR,verticalAlignment:se(f??\"baseline\"),verticalGlyphOrientation:w.Right,wordSpacing:100,billboardMode3D:P.FaceNearPlane,callout:E}}static createPictureMarkerRasterizationParam(e){const{angle:t,height:r,width:o,xoffset:a,yoffset:s}=e,i=e.url??e.source?.url??e.source?.imageData;return i?{type:\"sprite-rasterization-param\",overrides:[],resource:{type:\"CIMPictureMarker\",invertBackfaceTexture:!1,scaleX:1,textureFilter:S.Picture,tintColor:null,url:i,size:r,width:o,offsetX:F(a),offsetY:F(s),rotation:F(-t)}}:null}static createPictureFillRasterizationParam(e){const{width:t,height:r,xoffset:o,yoffset:a,url:s}=e;return s?{type:\"sprite-rasterization-param\",overrides:[],resource:{type:\"CIMPictureFill\",scaleX:1,textureFilter:S.Picture,tintColor:null,url:s,width:t,height:r,offsetX:F(o),offsetY:F(a),rotation:0}}:null}static fromSimpleMarker(e,t,r){const{style:o}=e,a=e.color??r;if(\"path\"===o||\"esriSMSPath\"===o){const t=[];if(\"outline\"in e&&e.outline){const r=e.outline;t.push({type:\"CIMSolidStroke\",enable:!0,width:r.width,color:ie(r.color),path:e.path})}t.push({type:\"CIMSolidFill\",enable:!0,color:ie(a),path:e.path});const[r,o]=ye(\"square\");return{type:\"CIMPointSymbol\",symbolLayers:[{type:\"CIMVectorMarker\",enable:!0,rotation:-F(e.angle),size:F(e.size||6),offsetX:F(e.xoffset),offsetY:F(e.yoffset),scaleSymbolsProportionally:!1,frame:r,markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:o,symbol:{type:\"CIMPolygonSymbol\",symbolLayers:t}}]}]}}const s=[];let i,n,l=e.size;if(\"outline\"in e&&e.outline&&\"none\"!==e.outline.style&&\"esriSLSNull\"!==e.outline.style){const t=e.outline,r=\"solid\"!==t.style&&\"esriSLSSolid\"!==t.style;[i,n]=r?ye(o,e.size):ye(o);const a=t.width??T.width;if(r){const t=a/e.size,r=(i.xmax-i.xmin)*t/2,o=(i.ymax-i.ymin)*t/2;i.xmin-=r,i.xmax+=r,i.ymin-=o,i.ymax+=o,l&&(l+=a)}const c=\"cross\"!==e.style&&\"x\"!==e.style||\"dot\"===e?.outline.style||\"short-dot\"===e?.outline.style?L.HalfGap:L.FullPattern,m=r?[{type:\"CIMGeometricEffectAddControlPoints\"},{type:\"CIMGeometricEffectDashes\",dashTemplate:me(t.style,null).map((e=>t.width&&t.width>0?e*t.width:e)),lineDashEnding:c,controlPointEnding:L.FullPattern}]:void 0;s.push({type:\"CIMSolidStroke\",capStyle:r?p.Round:p.Butt,enable:!0,width:a,color:ie(t.color),effects:m})}else!t||\"line-marker\"!==e.type||\"cross\"!==e.style&&\"x\"!==e.style?[i,n]=ye(o):([i,n]=ye(o),s.push({type:\"CIMSolidStroke\",enable:!0,width:t,color:ie(a)}));s.push({type:\"CIMSolidFill\",enable:!0,color:ie(a)});const c={type:\"CIMPolygonSymbol\",symbolLayers:s};return{type:\"CIMPointSymbol\",symbolLayers:[{type:\"CIMVectorMarker\",enable:!0,rotation:F(-e.angle),size:F(l||6*t),offsetX:F(e.xoffset),offsetY:F(e.yoffset),scaleSymbolsProportionally:!1,frame:i,markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:n,symbol:c}]}]}}static fromCIMHatchFill(e,r){const o=r*(e.separation??u.CIMHatchFill.separation),a=o/2,s=t(e.lineSymbol);s.symbolLayers?.forEach((e=>{switch(e.type){case\"CIMSolidStroke\":null!=e.width&&(e.width*=r),e.effects?.forEach((e=>{if(\"CIMGeometricEffectDashes\"===e.type){const t=e.dashTemplate;e.dashTemplate=t?.map((e=>e*r))}}));break;case\"CIMVectorMarker\":{null!=e.size&&(e.size*=r);const t=e.markerPlacement;null!=t&&\"placementTemplate\"in t&&(t.placementTemplate=t.placementTemplate.map((e=>e*r)));break}}}));let i=this._getLineSymbolPeriod(s)||H;for(;i<H;)i*=2;const n=i/2;return{type:\"CIMVectorMarker\",frame:{xmin:-n,xmax:n,ymin:-a,ymax:a},markerGraphics:[{type:\"CIMMarkerGraphic\",geometry:{paths:[[[-n,0],[n,0]]]},symbol:s}],size:o}}static fetchResources(e,t,r,o=null){return e&&t?(te(e,(e=>{ue(e,t,r),\"url\"in e&&e.url&&r.push(t.fetchResource(e.url,{signal:o}))})),r):r}static fetchFonts(e,t,r){if(e&&t)if(\"symbolLayers\"in e&&e.symbolLayers){for(const o of e.symbolLayers)if(\"CIMVectorMarker\"===o.type&&o.markerGraphics)for(const e of o.markerGraphics)e?.symbol&&ee.fetchFonts(e.symbol,t,r)}else if(\"CIMTextSymbol\"===e.type){const{fontFamilyName:o,fontStyleName:a}=e;if(!o||\"calcitewebcoreicons\"===o.toLowerCase())return;const{style:s,weight:i}=z(a),n=D(e),c=new l({family:o,style:s,weight:i,decoration:n});r.push(t.loadFont(c).catch((()=>{O().error(`Unsupported font ${o} in CIM symbol`)})))}}static _getLineSymbolPeriod(e){if(e){const t=this._getEffectsRepeat(e.effects);if(t)return t;if(e.symbolLayers)for(const r of e.symbolLayers)if(r){const e=this._getEffectsRepeat(r.effects);if(e)return e;switch(r.type){case\"CIMCharacterMarker\":case\"CIMPictureMarker\":case\"CIMVectorMarker\":case\"CIMObjectMarker3D\":case\"CIMglTFMarker3D\":{const e=this._getPlacementRepeat(r.markerPlacement);if(e)return e}}}}return 0}static _getEffectsRepeat(e){if(e)for(const t of e)if(t)switch(t.type){case\"CIMGeometricEffectDashes\":{const e=t.dashTemplate;if(e&&e.length){let t=0;for(const r of e)t+=r;return 1&e.length&&(t*=2),t}break}case\"CIMGeometricEffectWave\":return t.period;default:O().error(`unsupported geometric effect type ${t.type}`)}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case\"CIMMarkerPlacementAlongLineSameSize\":case\"CIMMarkerPlacementAlongLineRandomSize\":case\"CIMMarkerPlacementAlongLineVariableSize\":{const t=e.placementTemplate;if(t&&t.length){let e=0;for(const r of t)e+=+r;return 1&t.length&&(e*=2),e}break}}return 0}static fromCIMInsidePolygon(e){const t=e.markerPlacement,r={...e};r.markerPlacement=null,r.anchorPoint=null;const s=Math.abs(t.stepX),i=Math.abs(t.stepY),n=(t.randomness??100)/100;let l,c,m,f;if(\"Random\"===t.gridType){const e=a(j),r=Math.max(Math.floor(e/s),1),y=Math.max(Math.floor(e/i),1);l=r*s/2,c=y*i/2,m=2*c;const h=new o(t.seed),u=n*s/1.5,p=n*i/1.5;f=[];for(let t=0;t<r;t++)for(let e=0;e<y;e++){const r=t*s-l+u*(.5-h.getFloat()),o=e*i-c+p*(.5-h.getFloat());f.push({x:r,y:o}),0===t&&f.push({x:r+2*l,y:o}),0===e&&f.push({x:r,y:o+2*c})}}else!0===t.shiftOddRows?(l=s/2,c=i,m=2*i,f=[{x:-l,y:0},{x:l,y:0},{x:0,y:c},{x:0,y:-c}]):(l=s/2,c=i/2,m=i,f=[{x:-s,y:0},{x:0,y:-i},{x:-s,y:-i},{x:0,y:0},{x:s,y:0},{x:0,y:i},{x:s,y:i},{x:-s,y:i},{x:s,y:-i}]);return{type:\"CIMVectorMarker\",frame:{xmin:-l,xmax:l,ymin:-c,ymax:c},markerGraphics:f.map((e=>({type:\"CIMMarkerGraphic\",geometry:e,symbol:{type:\"CIMPointSymbol\",symbolLayers:[r]}}))),size:m}}}function te(e,t){if(e)switch(e.type){case\"CIMPointSymbol\":case\"CIMLineSymbol\":case\"CIMPolygonSymbol\":{const r=e.symbolLayers;if(!r)return;for(const e of r)if(t(e),\"CIMVectorMarker\"===e.type){const r=e.markerGraphics;if(!r)continue;for(const e of r)if(e){const r=e.symbol;r&&te(r,t)}}break}}}const re=e=>{if(!e)return p.Butt;switch(e){case\"butt\":return p.Butt;case\"square\":return p.Square;case\"round\":return p.Round}},oe=e=>{if(!e)return M.Miter;switch(e){case\"miter\":return M.Miter;case\"round\":return M.Round;case\"bevel\":return M.Bevel}},ae=e=>{if(null==e)return\"Center\";switch(e){case\"left\":return\"Left\";case\"right\":return\"Right\";case\"center\":return\"Center\"}},se=e=>{if(null==e)return\"Center\";switch(e){case\"baseline\":return\"Baseline\";case\"top\":return\"Top\";case\"middle\":return\"Center\";case\"bottom\":return\"Bottom\"}},ie=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:o,a}=e;return[t,r,o,255*a]},ne=(e,t)=>{const r=le(t),o=ce(e);return r&&o?`${r}-${o}`:`${r}${o}`},le=e=>{if(!e)return\"\";switch(e.toLowerCase()){case\"bold\":case\"bolder\":return\"bold\"}return\"\"},ce=e=>{if(!e)return\"\";switch(e.toLowerCase()){case\"italic\":case\"oblique\":return\"italic\"}return\"\"},me=(e,t)=>{const r=has(\"safari\")?.001:0,o=\"butt\"===t;switch(e){case\"dash\":case\"esriSLSDash\":return o?[4,3]:[3,4];case\"dash-dot\":case\"esriSLSDashDot\":return o?[4,3,1,3]:[3,4,r,4];case\"dot\":case\"esriSLSDot\":return o?[1,3]:[r,4];case\"long-dash\":case\"esriSLSLongDash\":return o?[8,3]:[7,4];case\"long-dash-dot\":case\"esriSLSLongDashDot\":return o?[8,3,1,3]:[7,4,r,4];case\"long-dash-dot-dot\":case\"esriSLSDashDotDot\":return o?[8,3,1,3,1,3]:[7,4,r,4,r,4];case\"short-dash\":case\"esriSLSShortDash\":return o?[4,1]:[3,2];case\"short-dash-dot\":case\"esriSLSShortDashDot\":return o?[4,1,1,1]:[3,2,r,2];case\"short-dash-dot-dot\":case\"esriSLSShortDashDotDot\":return o?[4,1,1,1,1,1]:[3,2,r,2,r,2];case\"short-dot\":case\"esriSLSShortDot\":return o?[1,1]:[r,2];case\"solid\":case\"esriSLSSolid\":case\"none\":return O().error(\"Unexpected: style does not require rasterization\"),[0,0];default:return O().error(`Tried to rasterize SLS, but found an unexpected style: ${e}!`),[0,0]}};function fe(e){return void 0!==e.symbolLayers}const ye=(e,t=100)=>{const r=t/2;let o,a;const s=e;if(\"circle\"===s||\"esriSMSCircle\"===s){const e=.25;let t=Math.acos(1-e/r),s=Math.ceil(N/t/4);0===s&&(s=1),t=Y/s,s*=4;const i=[];i.push([r,0]);for(let o=1;o<s;o++)i.push([r*Math.cos(o*t),-r*Math.sin(o*t)]);i.push([r,0]),o={rings:[i]},a={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if(\"cross\"===s||\"esriSMSCross\"===s){const e=0;o={paths:[[[e,r],[e,-r]],[[r,e],[-r,e]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r}}else if(\"diamond\"===s||\"esriSMSDiamond\"===s)o={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(\"square\"===s||\"esriSMSSquare\"===s)o={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(\"x\"===s||\"esriSMSX\"===s)o={paths:[[[r,r],[-r,-r]],[[r,-r],[-r,r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if(\"triangle\"===s||\"esriSMSTriangle\"===s){const e=t*.5773502691896257,r=-e,s=2/3*t,i=s-t;o={rings:[[[r,i],[0,s],[e,i],[r,i]]]},a={xmin:r,ymin:i,xmax:e,ymax:s}}else\"arrow\"===s&&(o={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r});return[a,o]},he=e=>\"vertical\"===e||\"horizontal\"===e||\"cross\"===e||\"esriSFSCross\"===e||\"esriSFSVertical\"===e||\"esriSFSHorizontal\"===e;function ue(e,t,r){if(!e.effects||null!=t.geometryEngine)return;if(t.geometryEnginePromise)return void r.push(t.geometryEnginePromise);E(e.effects)&&(t.geometryEnginePromise=G(),r.push(t.geometryEnginePromise),t.geometryEnginePromise.then((e=>t.geometryEngine=e)))}function pe(e){if(!e)return null;let t=null;const{cap:r,color:o,join:a,miterLimit:s,style:i,width:n}=e;return\"solid\"!==i&&\"none\"!==i&&\"esriSLSSolid\"!==i&&\"esriSLSNull\"!==i&&(t=[{type:\"CIMGeometricEffectDashes\",dashTemplate:me(i,r),lineDashEnding:\"NoConstraint\",scaleDash:!0,offsetAlongLine:null}]),{type:\"CIMSolidStroke\",color:\"esriSLSNull\"!==i&&\"none\"!==i?ie(o):[0,0,0,0],capStyle:re(r),joinStyle:oe(a),miterLimit:s,width:n,effects:t}}export{ee as CIMSymbolHelper,Z as CIMSymbolInflatedSizeHelper,re as capTypeToEnum,Q as getEffectsInflateSize,me as slsDashToTemplateArray,W as symbolToCIM};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../geometry/GeometryCursor.js\";import{GeometricEffectOffsetMethod as e}from\"./enums.js\";const n=.03;class s{constructor(t=0,e=!1){}isEmpty(t){if(!t.nextPoint())return!0;let e,n,s,r;for(e=t.x,n=t.y;t.nextPoint();e=n,n=r)if(s=t.x,r=t.y,s!==e||r!==n)return t.seekPathStart(),!1;return t.seekPathStart(),!0}normalize(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);0!==e&&(t[0]/=e,t[1]/=e)}getLength(t,e,n,s){const r=n-t,o=s-e;return Math.sqrt(r*r+o*o)}getSegLength(t){const[[e,n],[s,r]]=t;return this.getLength(e,n,s,r)}getCoord2D(t,e,n,s,r){return[t+(n-t)*r,e+(s-e)*r]}getSegCoord2D(t,e){const[[n,s],[r,o]]=t;return this.getCoord2D(n,s,r,o,e)}getAngle(t,e,n,s,r){const o=n-t,i=s-e;return Math.atan2(i,o)}getAngleCS(t,e,n,s,r){const o=n-t,i=s-e,u=Math.sqrt(o*o+i*i);return u>0?[o/u,i/u]:[1,0]}getSegAngleCS(t,e){const[[n,s],[r,o]]=t;return this.getAngleCS(n,s,r,o,e)}cut(t,e,n,s,r,o){return[r<=0?[t,e]:this.getCoord2D(t,e,n,s,r),o>=1?[n,s]:this.getCoord2D(t,e,n,s,o)]}getSubCurve(e,n,s){const r=t.createEmptyOptimizedCIM(\"esriGeometryPolyline\");return this.appendSubCurve(r,e,n,s)?r:null}appendSubCurve(t,e,n,s){t.startPath(),e.seekPathStart();let r=0,o=!0;if(!e.nextPoint())return!1;let i=e.x,u=e.y;for(;e.nextPoint();){const h=this.getLength(i,u,e.x,e.y);if(0!==h){if(o){if(r+h>n){const l=(n-r)/h;let a=1,c=!1;r+h>=s&&(a=(s-r)/h,c=!0);const f=this.cut(i,u,e.x,e.y,l,a);if(f&&t.pushPoints(f),c)break;o=!1}}else{if(r+h>s){const n=this.cut(i,u,e.x,e.y,0,(s-r)/h);n&&t.pushPoint(n[1]);break}t.pushXY(e.x,e.y)}r+=h,i=e.x,u=e.y}else i=e.x,u=e.y}return!0}getCIMPointAlong(t,e){if(!t.nextPoint())return null;let n,s,r,o,i=0;for(n=t.x,s=t.y;t.nextPoint();n=r,s=o){r=t.x,o=t.y;const u=this.getLength(n,s,r,o);if(0!==u){if(i+u>e){const t=(e-i)/u;return this.getCoord2D(n,s,r,o,t)}i+=u}}return null}offset(t,n,s,r,o){if(!t||t.length<2)return null;let i=0,u=t[i++],h=i;for(;i<t.length;){const e=t[i];e[0]===u[0]&&e[1]===u[1]||(i!==h&&(t[h]=t[i]),u=t[h++]),i++}const l=t[0][0]===t[h-1][0]&&t[0][1]===t[h-1][1];if(l&&--h,h<(l?3:2))return null;const a=[];u=l?t[h-1]:null;let c=t[0];for(let f=0;f<h;f++){const o=f===h-1?l?t[0]:null:t[f+1];if(u)if(o){const t=[o[0]-c[0],o[1]-c[1]];this.normalize(t);const i=[c[0]-u[0],c[1]-u[1]];this.normalize(i);const h=i[0]*t[1]-i[1]*t[0],l=i[0]*t[0]+i[1]*t[1];if(0===h&&1===l){c=o;continue}if(h>=0==n<=0){if(l<1){const e=[t[0]-i[0],t[1]-i[1]];this.normalize(e);const s=Math.sqrt((1+l)/2);if(s>1/r){const t=-Math.abs(n)/s;a.push([c[0]-e[0]*t,c[1]-e[1]*t])}}}else switch(s){case e.Mitered:{const e=Math.sqrt((1+l)/2);if(e>0&&1/e<r){const s=[t[0]-i[0],t[1]-i[1]];this.normalize(s);const r=Math.abs(n)/e;a.push([c[0]-s[0]*r,c[1]-s[1]*r]);break}}case e.Bevelled:a.push([c[0]+i[1]*n,c[1]-i[0]*n]),a.push([c[0]+t[1]*n,c[1]-t[0]*n]);break;case e.Rounded:if(l<1){a.push([c[0]+i[1]*n,c[1]-i[0]*n]);const e=Math.floor(2.5*(1-l));if(e>0){const s=1/e;let r=s;for(let o=1;o<e;o++,r+=s){const e=[i[1]*(1-r)+t[1]*r,-i[0]*(1-r)-t[0]*r];this.normalize(e),a.push([c[0]+e[0]*n,c[1]+e[1]*n])}}a.push([c[0]+t[1]*n,c[1]-t[0]*n])}break;case e.Square:default:if(h<0)a.push([c[0]+(i[1]+i[0])*n,c[1]+(i[1]-i[0])*n]),a.push([c[0]+(t[1]-t[0])*n,c[1]-(t[0]+t[1])*n]);else{const e=Math.sqrt((1+Math.abs(l))/2),s=[t[0]-i[0],t[1]-i[1]];this.normalize(s);const r=n/e;a.push([c[0]-s[0]*r,c[1]-s[1]*r])}}}else{const t=[c[0]-u[0],c[1]-u[1]];this.normalize(t),a.push([c[0]+t[1]*n,c[1]-t[0]*n])}else{const t=[o[0]-c[0],o[1]-c[1]];this.normalize(t),a.push([c[0]+t[1]*n,c[1]-t[0]*n])}u=c,c=o}return a.length<(l?3:2)?null:(l&&a.push([a[0][0],a[0][1]]),a)}}export{s as CurveHelper,n as pixelTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../geometry/GeometryCursor.js\";import{CurveHelper as e,pixelTolerance as s}from\"./CurveHelper.js\";const n=1e-7;class i{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(t,e,s=!0){if(this._setEmpty(),!t||0===t.length)return!1;for(let i=0;i<t.length;i++){let e=Math.abs(t[i]);s&&e<n&&(e=n),this._values.push(e),this._length+=e}return e&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const e=this._values?this._values.length:0;for(let s=0;s<e;++s)this._values[s]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t}addValue(t){this._length+=t,this._values.push(t)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class h{constructor(){this.pt=null,this.ca=0,this.sa=0}}var r;!function(t){t[t.FAIL=0]=\"FAIL\",t[t.END=1]=\"END\",t[t.CONTINUE=2]=\"CONTINUE\"}(r||(r={}));class a{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd}}class o extends e{constructor(t=0,e=!1){super(t,e),this._tolerance=s,this._currentPosition=new a}updateTolerance(t){this._tolerance=s*t}init(t,e,s=!0){return s?(this._patternLength=e.length(),this._partExtPtGap=e.extPtGap,this._partCtrlPtGap=e.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=t,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,e=r.FAIL){const s=new a;return!!this._nextPosition(t,s,null,e)&&(s.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[e,s]=this._getAngleCS(this._currentPosition);t.ca=e,t.sa=s}nextPointAndAngle(t,e,s=r.FAIL){const n=new a;if(!this._nextPosition(t,n,null,s))return!1;n.copyTo(this._currentPosition),e.pt=this._getPoint(n);const[i,h]=this._getAngleCS(n);return e.ca=i,e.sa=h,!0}nextCurve(e){if(0===e)return null;const s=t.createEmptyOptimizedCIM(\"esriGeometryPolyline\");s.startPath(),s.nextPath();const n=new a;return this._nextPosition(e,n,s,r.END)?(n.copyTo(this._currentPosition),s):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(t){return this._pathCursor.seekInPath(t),[this._pathCursor.x,this._pathCursor.y]}getSeg(t){return[this.getPt(t),this.getPt(t+1)]}_nextPosition(t,e,s,n){if(this._currentPosition.isPathEnd)return!1;let i=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(i/=this._currentPosition.segmentLength),this._currentPosition.copyTo(e);e.abscissa+t*this._partLengthRatio>e.segmentLength+this._tolerance;){if(s){if(0===s.pathSize)if(0===i){const t=e.segment[0];s.pushXY(t[0],t[1])}else s.pushPoint(this.getSegCoord2D(e.segment,i));const t=e.segment[1];s.pushXY(t[0],t[1])}if(i=0,t-=(e.segmentLength-e.abscissa)/this._partLengthRatio,this._partSegCount)e.segment=this._nextSegment(),e.segmentLength=this.getSegLength(e.segment),e.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return n!==r.FAIL&&(e.segmentLength=this.getSegLength(e.segment),e.isPartEnd=!0,n===r.END?(e.abscissa=e.segmentLength,e.isPathEnd=!0):e.abscissa=e.segmentLength+t,!0);this._currentPosition.copyTo(e)}}if(e.abscissa+=t*this._partLengthRatio,s){0===s.pathSize&&(0===i?s.pushPoint(e.segment[0]):s.pushPoint(this.getSegCoord2D(e.segment,i)));const t=e.abscissa/e.segmentLength;1===t?s.pushPoint(e.segment[1]):s.pushPoint(this.getSegCoord2D(e.segment,t))}return this._partSegCount||Math.abs(e.abscissa-e.segmentLength)<this._tolerance&&(e.isPathEnd=this._partIsLast,e.isPartEnd=!0),!0}_getPoint(t){const e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,e)}_getAngleCS(t){const e=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._currentPosition.segment,e)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let t=this._partSegCount;for(;t;)this._previousSegment(),--t;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const e=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(e);let s=e+this._partSegCount+1;if(s>=this._pathCursor.pathSize&&(s=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(s),this._patternLength>0){const t=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,e=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let s=Math.round((this._partLength-(t+e))/this._patternLength);s<=0&&(s=t+e>0?0:1),this._partLengthRatio=this._partLength/(t+e+s*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}export{i as DashPattern,r as EndType,o as GeometryWalker,h as Pos};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(t=0,h=0,i=0,s=0){this.x=t,this.y=h,this.width=i,this.height=s}static fromExtent(h){return new t(h.xmin,-h.ymax,h.xmax-h.xmin,h.ymax-h.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{pt2px as e}from\"../../core/screenUtils.js\";import{backgroundPadding as t}from\"../support/textUtils.js\";function i(e){return`rgb(${e.slice(0,3).toString()})`}function n(e){return`rgba(${e.slice(0,3).toString()},${e[3]})`}class s{constructor(e){e&&(this._textRasterizationCanvas=e)}rasterizeText(e,s){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement(\"canvas\"));const a=this._textRasterizationCanvas,h=a.getContext(\"2d\",{willReadFrequently:!0});r(h,s),this._parameters=s,this._textLines=e.split(/\\r?\\n/),this._lineHeight=this._computeLineHeight();const{decoration:l,weight:d}=s.font;this._lineThroughWidthOffset=l&&\"line-through\"===l?.1*this._lineHeight:0;const c=null!=s.backgroundColor||null!=s.borderLine,_=c?t:0,u=this._computeTextWidth(h,s)+2*_,g=this._lineHeight*this._textLines.length+2*_;if(a.width=u+2*this._lineThroughWidthOffset,a.height=g,0===a.width||0===a.height)return a.width=a.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:a};this._renderedLineHeight=Math.round(this._lineHeight),this._renderedOutlineSize=(s.outline.size||0)*s.pixelRatio,this._renderedHaloSize=(s.halo.size||0)*s.pixelRatio,this._renderedWidth=u,this._renderedHeight=g,this._lineThroughWidthOffset*=s.pixelRatio;const f=(s.outline&&s.outline.color)??[0,0,0,0],m=s.color??[0,0,0,0],p=s.halo&&s.halo.color?s.halo.color:[0,0,0,0];this._fillStyle=n(m),this._outlineStyle=n(f),this._haloStyle=i(p);const x=this._renderedLineHeight,z=this._renderedOutlineSize,b=this._renderedHaloSize;h.save(),h.clearRect(0,0,a.width,a.height),r(h,s);const w=_*s.pixelRatio,v=o(h.textAlign,this._renderedWidth-2*w,this._renderedHaloSize+this._renderedOutlineSize)+w,S=b+z+w,y=b>0;let R=this._lineThroughWidthOffset,C=0;if(c){h.save();const e=s.backgroundColor??[0,0,0,0],t=s.borderLine?.color??[0,0,0,0],i=2*(s.borderLine?.size??0);h.fillStyle=n(e),h.strokeStyle=n(t),h.lineWidth=i,h.fillRect(0,0,a.width,a.height),h.strokeRect(0,0,a.width,a.height),h.restore()}y&&this._renderHalo(h,v,S,R,C,s),z>0&&this._renderOutline(h,v,S,R,C,s),C+=S,R+=v;for(const t of this._textLines)y?(h.globalCompositeOperation=\"destination-out\",h.fillStyle=\"rgb(0, 0, 0)\",h.fillText(t,R,C),h.globalCompositeOperation=\"source-over\",h.fillStyle=this._fillStyle,h.fillText(t,R,C)):(h.fillStyle=this._fillStyle,h.fillText(t,R,C)),l&&\"none\"!==l&&this._renderDecoration(h,R,C,l,d),C+=x;h.restore();const H=this._renderedWidth+2*this._lineThroughWidthOffset,W=this._renderedHeight,T=h.getImageData(0,0,H,W),k=new Uint8Array(T.data);if(s.premultiplyColors){let e;for(let t=0;t<k.length;t+=4)e=k[t+3]/255,k[t]=k[t]*e,k[t+1]=k[t+1]*e,k[t+2]=k[t+2]*e}let L,O;switch(s.horizontalAlignment){case\"left\":L=-.5;break;case\"right\":L=.5;break;default:L=0}switch(s.verticalAlignment){case\"bottom\":O=-.5;break;case\"top\":O=.5;break;case\"baseline\":O=-1/6;break;default:O=0}return{size:[H,W],image:new Uint32Array(k.buffer),sdf:!1,simplePattern:!1,anchorX:L,anchorY:O,canvas:a}}_renderHalo(e,t,i,n,s,o){const a=this._renderedWidth,h=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement(\"canvas\")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=h;const l=this._outlineRasterizationCanvas,d=l.getContext(\"2d\");d.clearRect(0,0,a,h),r(d,o);const{decoration:c,weight:_}=o.font;d.fillStyle=this._haloStyle,d.strokeStyle=this._haloStyle,d.lineJoin=\"round\",this._renderOutlineNative(d,t,i,c,_,this._renderedHaloSize+this._renderedOutlineSize),e.globalAlpha=this._parameters.halo.color[3],e.drawImage(l,0,0,a,h,n,s,a,h),e.globalAlpha=1}_renderOutline(e,t,i,n,s,o){const a=this._renderedWidth,h=this._renderedHeight;this._outlineRasterizationCanvas||(this._outlineRasterizationCanvas=document.createElement(\"canvas\")),this._outlineRasterizationCanvas.width=a,this._outlineRasterizationCanvas.height=h;const l=this._outlineRasterizationCanvas,d=l.getContext(\"2d\");d.clearRect(0,0,a,h),r(d,o);const{decoration:c,weight:_}=o.font;d.fillStyle=this._outlineStyle,d.strokeStyle=this._outlineStyle,d.lineJoin=\"round\",this._renderOutlineNative(d,t,i,c,_,this._renderedOutlineSize),e.globalAlpha=this._parameters.outline.color[3],e.drawImage(l,0,0,a,h,n,s,a,h),e.globalAlpha=1}_renderOutlineNative(e,t,i,n,s,r){const o=this._renderedLineHeight;for(const a of this._textLines){const h=2*r,l=5,d=.1;for(let r=0;r<l;r++){const o=(1-(l-1)*d+r*d)*h;e.lineWidth=o,e.strokeText(a,t,i),n&&\"none\"!==n&&this._renderDecoration(e,t,i,n,s,o)}i+=o}}computeTextSize(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement(\"canvas\"));const i=this._textRasterizationCanvas,n=i.getContext(\"2d\");r(n,t),this._parameters=t,this._textLines=e.split(/\\r?\\n/),this._lineHeight=this._computeLineHeight();const s=this._computeTextWidth(n,t),o=this._lineHeight*this._textLines.length;return i.width=s,i.height=o,[s*t.pixelRatio,o*t.pixelRatio]}_computeTextWidth(t,i){let n=0;for(const e of this._textLines)n=Math.max(n,t.measureText(e).width);const s=i.font;return(\"italic\"===s.style||\"oblique\"===s.style||\"string\"==typeof s.weight&&(\"bold\"===s.weight||\"bolder\"===s.weight)||\"number\"==typeof s.weight&&s.weight>600)&&(n+=.3*t.measureText(\"w\").width),n+=2*e(this._parameters.halo.size),Math.round(n)}_computeLineHeightBase(){return 1.275*this._parameters.size}_computeLineHeight(){let t=this._computeLineHeightBase();const i=this._parameters.font.decoration;return i&&\"underline\"===i&&(t*=1.3),Math.round(t+2*e(this._parameters.halo.size))}_renderDecoration(e,t,i,n,s,r){let o=.9*this._lineHeight;const a=\"bold\"===s?.06:\"bolder\"===s?.09:.04;switch(e.textAlign){case\"center\":t-=this._renderedWidth/2;break;case\"right\":t-=this._renderedWidth}const h=e.textBaseline;if(\"underline\"===n)switch(o=.9*this._computeLineHeightBase(),h){case\"top\":i+=o;break;case\"middle\":i+=o/2}else if(\"line-through\"===n)switch(h){case\"top\":i+=o/1.5;break;case\"middle\":i+=o/3}const l=r?1.5*r:Math.ceil(o*a);e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=l,e.moveTo(t-this._lineThroughWidthOffset,i),e.lineTo(t+this._renderedWidth+2*this._lineThroughWidthOffset,i),e.stroke(),e.restore()}}function r(t,i){const n=Math.max(i.size,.5),s=i.font,r=`${s.style} ${s.weight} ${e(n).toFixed(1)}px ${s.family}, sans-serif`;let o;switch(t.font=r,t.textBaseline=\"top\",i.horizontalAlignment){case\"left\":default:o=\"left\";break;case\"right\":o=\"right\";break;case\"center\":o=\"center\"}t.textAlign=o}function o(e,t,i){return\"center\"===e?.5*t:\"right\"===e?t-i:i}export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(e,s,n,i,o){return new t(e,s,n)}}e.instance=null;class t{constructor(e,t,s){this._inputGeometries=e,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let e=this._inputGeometries.next();for(;e;){if(\"esriGeometryPolygon\"===e.geometryType)this._isClosed=!0;else if(\"esriGeometryPolyline\"===e.geometryType)this._isClosed=!1;else{if(\"esriGeometryEnvelope\"!==e.geometryType){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const t=e.x,s=e.y;let n=t,i=s,o=e.pathSize,l=0,r=0,a=0,h=0,c=0,_=0;this._isClosed&&++o;for(let u=1;e.nextPoint()||u<o;++u){let x,m;this._isClosed&&u===o-1?(x=t,m=s):(x=e.x,m=e.y);const y=x-n,g=m-i,C=Math.sqrt(y*y+g*g);if(u>1&&C>0&&a>0){(l*y+r*g)/C/a<=this._maxCosAngle&&e.setControlPointAt(u-1)}1===u&&(h=y,c=g,_=C),C>0&&(n=x,i=m,l=y,r=g,a=C)}if(this._isClosed&&a>0&&_>0){(l*h+r*c)/_/a<=this._maxCosAngle&&e.setControlPointAt(0)}}}}export{e as EffectAddControlPoints};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{collectPath as e}from\"../../../geometry/geometryCursorCollectUtils.js\";import{PathEffectCursor as r}from\"../CIMCursor.js\";import{CurveHelper as n,pixelTolerance as o}from\"../CurveHelper.js\";import{GeometricEffectArrowType as s,GeometricEffectOffsetMethod as i}from\"../enums.js\";const c=1.7320508075688772,u=5,h=s.OpenEnded;class p{static local(){return null===p.instance&&(p.instance=new p),p.instance}execute(t,e,r,n,o){return new P(t,e,r)}}p.instance=null;class P extends r{constructor(t,e,r){super(t,!1,!0),this._curveHelper=new n,this._width=(void 0!==e.width?e.width:u)*r,this._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:void 0!==e.arrowType?e.arrowType:h,this._offsetFlattenError=o*r}processPath(e){const r=t.createEmptyOptimizedCIM(e.geometryType);switch(this._arrowType){case s.OpenEnded:default:this._constructSimpleArrow(r,e,!0);break;case s.Block:this._constructSimpleArrow(r,e,!1);break;case s.Crossed:this._constructCrossedArrow(r,e)}return r}_constructSimpleArrow(t,r,n){const o=r.pathLength();let s=this._width;o<2*s&&(s=o/2);const i=this._curveHelper.getSubCurve(r,0,o-s);if(!i||!i.nextPath())return;i.seekPathStart();const c=s/2;if(this._curveHelper.isEmpty(i))return;const u=e(i),h=this._constructOffset(u,-c);if(!h)return;const p=this._constructOffset(u,c);if(!p)return;const P=this._constructArrowBasePoint(h,-c/2);if(!P)return;const l=this._constructArrowBasePoint(p,c/2);if(!l)return;r.seekInPath(r.pathSize-1);const f=[r.x,r.y];t.pushPath(p),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(l),t.nextPoint(),t.setControlPoint(),t.pushPoint(f),t.nextPoint(),t.setControlPoint(),t.pushPoint(P),t.nextPoint(),t.setControlPoint(),t.pushPoints(h.reverse()),t.setControlPoint(),n||(t.setControlPointAt(0),t.setControlPointAt(t.pathSize-1),t.pushPoint(p[0])),t.reset()}_constructCrossedArrow(t,r){const n=r.pathLength();let o=this._width;n<o*(1+c+1)&&(o=n/(1+c+1)),r.seekPathStart();const s=this._curveHelper.getSubCurve(r,0,n-o*(1+c));if(!s)return;s.nextPath();const i=o/2;if(this._curveHelper.isEmpty(s))return;const u=e(s),h=this._constructOffset(u,i);if(!h)return;const p=this._constructOffset(u,-i);if(!p)return;const P=this._curveHelper.getSubCurve(r,0,n-o);if(!P)return;if(P.nextPath(),this._curveHelper.isEmpty(P))return;const l=e(P),f=this._constructOffset(l,i);if(!f)return;const a=this._constructOffset(l,-i);if(!a)return;const _=f[f.length-1],m=this._constructArrowBasePoint(f,i/2);if(!m)return;const C=a[a.length-1],w=this._constructArrowBasePoint(a,-i/2);if(!w)return;r.seekInPath(r.pathSize-1);const x=[r.x,r.y];t.pushPath(h),t.nextPath(),t.nextPoint(),t.setControlPoint(),t.pushPoint(C),t.nextPoint(),t.setControlPoint(),t.pushPoint(w),t.nextPoint(),t.setControlPoint(),t.pushPoint(x),t.nextPoint(),t.setControlPoint(),t.pushPoint(m),t.nextPoint(),t.setControlPoint(),t.pushPoint(_),t.nextPoint(),t.setControlPoint(),t.pushPoints(p.reverse()),t.nextPoint(),t.setControlPoint(),t.reset()}_constructOffset(t,e){return this._curveHelper.offset(t,e,i.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(t,e){if(!t||t.length<2)return null;const r=t[t.length-2],n=t[t.length-1],o=[n[0]-r[0],n[1]-r[1]];return this._curveHelper.normalize(o),[n[0]+o[1]*e,n[1]-o[0]*e]}}export{p as EffectArrow};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{GeometryCursor as e}from\"../../../geometry/GeometryCursor.js\";import{collectMultipath as t}from\"../../../geometry/geometryCursorCollectUtils.js\";import{clipCursorToTileExtent as i}from\"../CIMEffects.js\";import{CurveHelper as s,pixelTolerance as r}from\"../CurveHelper.js\";import{GeometricEffectOffsetMethod as n}from\"../enums.js\";import o from\"../../../geometry/SpatialReference.js\";class m{static local(){return null===m.instance&&(m.instance=new m),m.instance}execute(e,t,i,s,r,n){return new l(e,t,i,s,r,n)}}m.instance=null;class l{constructor(e,t,i,n,o,m){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=o,this._curveHelper=new s,this._size=(void 0!==t.size?t.size:1)*i,this._maxInflateSize=m*i,this._offsetFlattenError=r*i}next(){let s;for(;s=this._inputGeometries.next();){if(0===this._size)return s;if(\"esriGeometryEnvelope\"===s.geometryType)if(this._size>0){const i=e.createEmptyOptimizedCIM(s.geometryType),r=t(s)[0],o=this._curveHelper.offset(r,this._size,n.Rounded,4,this._offsetFlattenError);if(o)return i.pushPath(o),i}else if(this._size<0){const t=s.asJSON();if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return e.fromJSONCIM({xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size})}const r=this._geometryEngine;if(null==r)return null;const m=this._tileKey?i(s,this._maxInflateSize):s;if(!m)continue;const l=r.buffer(o.WebMercator,m.asJSON(),this._size,1);return l?e.fromJSONCIM(l):null}return null}}export{m as EffectBuffer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as s}from\"../../../geometry/GeometryCursor.js\";import{collectMultipath as t}from\"../../../geometry/geometryCursorCollectUtils.js\";import{getPathLength as i}from\"../../../geometry/support/coordsUtils.js\";import{setId as h}from\"../CIMCursor.js\";import{GeometricEffectControlMeasureLineRule as e}from\"../enums.js\";class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(s,t,i,h,e){return new _(s,t,i)}}r.instance=null;class _{constructor(s,t,i){this._defaultPointSize=20,this._inputGeometries=s,this._geomUnitsPerPoint=i,this._rule=t.rule??e.FullGeometry,this._defaultSize=this._defaultPointSize*i}next(){let i;for(;i=this._inputGeometries.next();){const h=this._processGeom(t(i));if(h?.length)return s.fromJSONCIM({paths:h})}return null}_clone(s){return[s[0],s[1]]}_mid(s,t){return[(s[0]+t[0])/2,(s[1]+t[1])/2]}_mix(s,t,i,h){return[s[0]*t+i[0]*h,s[1]*t+i[1]*h]}_add(s,t){return[s[0]+t[0],s[1]+t[1]]}_add2(s,t,i){return[s[0]+t,s[1]+i]}_sub(s,t){return[s[0]-t[0],s[1]-t[1]]}_dist(s,t){return Math.sqrt((s[0]-t[0])*(s[0]-t[0])+(s[1]-t[1])*(s[1]-t[1]))}_norm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}_normalize(s,t=1){const i=t/this._norm(s);s[0]*=i,s[1]*=i}_leftPerpendicular(s){const t=-s[1],i=s[0];s[0]=t,s[1]=i}_leftPerp(s){return[-s[1],s[0]]}_rightPerpendicular(s){const t=s[1],i=-s[0];s[0]=t,s[1]=i}_rightPerp(s){return[s[1],-s[0]]}_dotProduct(s,t){return s[0]*t[0]+s[1]*t[1]}_crossProduct(s,t){return s[0]*t[1]-s[1]*t[0]}_rotateDirect(s,t,i){const h=s[0]*t-s[1]*i,e=s[0]*i+s[1]*t;s[0]=h,s[1]=e}_makeCtrlPt(s){const t=[s[0],s[1]];return h(t,1),t}_addAngledTicks(s,t,i,h){const e=this._sub(i,t);this._normalize(e);const r=this._crossProduct(e,this._sub(h,t));let _;_=r>0?this._rightPerp(e):this._leftPerp(e);const c=Math.abs(r)/2,u=[];u.push([t[0]+(_[0]-e[0])*c,t[1]+(_[1]-e[1])*c]),u.push(t),u.push(i),u.push([i[0]+(_[0]+e[0])*c,i[1]+(_[1]+e[1])*c]),s.push(u)}_addBezier2(s,t,i,h,e){if(0==e--)return void s.push(h);const r=this._mid(t,i),_=this._mid(i,h),c=this._mid(r,_);this._addBezier2(s,t,r,c,e),this._addBezier2(s,c,_,h,e)}_addBezier3(s,t,i,h,e,r){if(0==r--)return void s.push(e);const _=this._mid(t,i),c=this._mid(i,h),u=this._mid(h,e),o=this._mid(_,c),a=this._mid(c,u),n=this._mid(o,a);this._addBezier3(s,t,_,o,n,r),this._addBezier3(s,n,a,u,e,r)}_add90DegArc(s,t,i,h,e){const r=e??this._crossProduct(this._sub(i,t),this._sub(h,t))>0,_=this._mid(t,i),c=this._sub(_,t);r?this._leftPerpendicular(c):this._rightPerpendicular(c),_[0]+=c[0],_[1]+=c[1],this._addBezier3(s,t,this._mix(t,.33333,_,.66667),this._mix(i,.33333,_,.66667),i,4)}_addArrow(s,t,i){const h=t[0],e=t[1],r=t[t.length-1],_=this._sub(h,e),c=this._norm(_);this._normalize(_);const u=Math.abs(this._crossProduct(_,this._sub(r,e)));let o=this._dotProduct(_,this._sub(r,e));o<.05*c?o=.05*c:o>.95*c&&(o=.95*c);const a=.5*u,n=this._leftPerp(_),p=[e[0]+_[0]*o,e[1]+_[1]*o],d=t.length-1,l=[];l.push(i?[-n[0],-n[1]]:n);let b=[-_[0],-_[1]];for(let P=1;P<d-1;P++){const s=this._sub(t[P+1],t[P]);this._normalize(s);const i=this._dotProduct(s,b),h=this._crossProduct(s,b),e=Math.sqrt((1+i)/2),r=this._sub(s,b);this._normalize(r),r[0]/=e,r[1]/=e,l.push(h<0?[-r[0],-r[1]]:r),b=s}l.push(this._rightPerp(b));for(let P=l.length-1;P>0;P--)s.push([t[P][0]+l[P][0]*a,t[P][1]+l[P][1]*a]);s.push([p[0]+l[0][0]*a,p[1]+l[0][1]*a]),s.push([p[0]+l[0][0]*u,p[1]+l[0][1]*u]),s.push(h),s.push([p[0]-l[0][0]*u,p[1]-l[0][1]*u]),s.push([p[0]-l[0][0]*a,p[1]-l[0][1]*a]);for(let P=1;P<l.length;P++)s.push([t[P][0]-l[P][0]*a,t[P][1]-l[P][1]*a])}_addDash(s,t,i){const h=this._norm(i)/7;this._normalize(i);let e=[];for(let r=0;r<=7;r++)e.push([t[0]+i[0]*r*h,t[1]+i[1]*r*h]),1&r&&(s.push(e),e=[])}_cp2(s,t,i){return s.length>=2?s[1]:this._add2(s[0],t*this._defaultSize,i*this._defaultSize)}_cp3(s,t,i,h){if(s.length>=3)return s[2];const e=this._mix(s[0],1-i,t,i),r=this._sub(t,s[0]);return this._normalize(r),this._rightPerpendicular(r),[e[0]+r[0]*h*this._defaultSize,e[1]+r[1]*h*this._defaultSize]}_arrowPath(s){if(s.length>2)return s;const t=s[0],i=this._cp2(s,-4,0),h=this._sub(t,i);this._normalize(h);const e=this._rightPerp(h);return[t,i,[t[0]+(e[0]-h[0])*this._defaultSize,t[1]+(e[1]-h[1])*this._defaultSize]]}_arrowLastSeg(s){const t=s[0],i=this._cp2(s,-4,0);let h;if(s.length>=3)h=s[s.length-1];else{const s=this._sub(t,i);this._normalize(s);const e=this._rightPerp(s);h=[t[0]+(e[0]-s[0])*this._defaultSize,t[1]+(e[1]-s[1])*this._defaultSize]}return[i,h]}_processGeom(s){if(!s)return null;const t=[];for(const r of s){const s=r.length>1&&i(r)<this._defaultSize;if(!r||0===r.length||s)continue;const _=r.length;let c=r[0];switch(this._rule){case e.PerpendicularFromFirstSegment:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,4),h=[];h.push(i),h.push(this._mid(c,s)),t.push(h);break}case e.ReversedFirstSegment:{const s=this._cp2(r,0,-1);t.push([s,c]);break}case e.PerpendicularToSecondSegment:{if(r.length<3)return[];const s=this._cp2(r,-4,1),i=this._cp3(r,s,.882353,-1.94),h=[];h.push(this._mid(s,i)),h.push(c),t.push(h);break}case e.SecondSegmentWithTicks:{if(r.length<3)return[];const s=this._cp2(r,-4,1),i=this._cp3(r,s,.882353,-1.94),h=this._sub(i,s);let e;e=this._crossProduct(h,this._sub(c,s))>0?this._rightPerp(h):this._leftPerp(h);const _=[];_.push([s[0]+(e[0]-h[0])/3,s[1]+(e[1]-h[1])/3]),_.push(s),_.push(i),_.push([i[0]+(e[0]+h[0])/3,i[1]+(e[1]+h[1])/3]),t.push(_);break}case e.DoublePerpendicular:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,3),h=this._mid(c,s),e=this._sub(h,i);this._normalize(e);const _=this._crossProduct(e,this._sub(c,i));this._leftPerpendicular(e);const u=[];u.push(c),u.push([i[0]+e[0]*_,i[1]+e[1]*_]),t.push(u);const o=[];o.push([i[0]-e[0]*_,i[1]-e[1]*_]),o.push(s),t.push(o);break}case e.OppositeToFirstSegment:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,3),h=this._mid(c,s),e=this._sub(h,i);this._normalize(e);const _=this._crossProduct(e,this._sub(c,i));this._leftPerpendicular(e);const u=[];u.push([i[0]+e[0]*_,i[1]+e[1]*_]),u.push([i[0]-e[0]*_,i[1]-e[1]*_]),t.push(u);break}case e.TriplePerpendicular:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,4),h=this._mid(c,s),e=this._sub(h,i);this._normalize(e);const _=this._crossProduct(e,this._sub(c,i));this._leftPerpendicular(e);const u=[];u.push([i[0]+e[0]*_*.8,i[1]+e[1]*_*.8]),u.push([h[0]+.8*(c[0]-h[0]),h[1]+.8*(c[1]-h[1])]),t.push(u),t.push([i,h]);const o=[];o.push([i[0]-e[0]*_*.8,i[1]-e[1]*_*.8]),o.push([h[0]+.8*(s[0]-h[0]),h[1]+.8*(s[1]-h[1])]),t.push(o);break}case e.HalfCircleFirstSegment:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,4),h=this._mid(c,s);let e=this._sub(s,c);const _=Math.cos(Math.PI/18),u=Math.sin(Math.PI/18),o=Math.sqrt((1+_)/2),a=Math.sqrt((1-_)/2),n=[];let p;this._crossProduct(e,this._sub(i,c))>0?(n.push(c),e=this._sub(c,h),p=s):(n.push(s),e=this._sub(s,h),p=c),this._rotateDirect(e,o,a),e[0]/=o,e[1]/=o;for(let t=1;t<=18;t++)n.push(this._add(h,e)),this._rotateDirect(e,_,u);n.push(p),t.push(n);break}case e.HalfCircleSecondSegment:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,1,-1);let h=this._sub(c,s);this._normalize(h);const e=this._crossProduct(h,this._sub(i,s))/2;this._leftPerpendicular(h);const _=[s[0]+h[0]*e,s[1]+h[1]*e];h=this._sub(s,_);const u=Math.cos(Math.PI/18);let o=Math.sin(Math.PI/18);e>0&&(o=-o);const a=[s];for(let t=1;t<=18;t++)this._rotateDirect(h,u,o),a.push(this._add(_,h));t.push(a);break}case e.HalfCircleExtended:{const s=this._cp2(r,0,-2),i=this._cp3(r,s,1,-1);let h;if(_>=4)h=r[3];else{const t=this._sub(c,s);h=this._add(i,t)}const e=this._dist(s,i)/2/.75,u=this._sub(s,c);this._normalize(u,e);const o=this._sub(i,h);this._normalize(o,e);const a=[h,i];t.push(a);const n=[this._clone(i)];this._addBezier3(n,i,this._add(i,o),this._add(s,u),s,4),n.push(c),t.push(n);break}case e.OpenCircle:{const s=this._cp2(r,-2,0),i=this._sub(s,c),h=Math.cos(Math.PI/18),e=-Math.sin(Math.PI/18),_=[s];for(let t=1;t<=33;t++)this._rotateDirect(i,h,e),_.push(this._add(c,i));t.push(_);break}case e.CoverageEdgesWithTicks:{const s=this._cp2(r,0,-1);let i,h;if(_>=3)i=r[2];else{const t=this._sub(s,c),h=this._leftPerp(t);i=[c[0]+h[0]-.25*t[0],c[1]+h[1]-.25*t[1]]}if(_>=4)h=r[3];else{const t=this._mid(c,s),e=this._sub(c,s);this._normalize(e),this._leftPerpendicular(e);const r=this._crossProduct(e,this._sub(i,t));this._rightPerpendicular(e),h=[i[0]+e[0]*r*2,i[1]+e[1]*r*2]}const e=this._sub(s,c);let u,o;u=this._crossProduct(e,this._sub(i,c))>0?this._rightPerp(e):this._leftPerp(e),o=[],o.push(i),o.push(c),o.push([c[0]+(u[0]-e[0])/3,c[1]+(u[1]-e[1])/3]),t.push(o),u=this._crossProduct(e,this._sub(h,s))>0?this._rightPerp(e):this._leftPerp(e),o=[],o.push([s[0]+(u[0]+e[0])/3,s[1]+(u[1]+e[1])/3]),o.push(s),o.push(h),t.push(o);break}case e.GapExtentWithDoubleTicks:{const s=this._cp2(r,0,2),i=this._cp3(r,s,0,1);let h;if(_>=4)h=r[3];else{const t=this._sub(s,c);h=this._add(i,t)}this._addAngledTicks(t,c,s,this._mid(i,h)),this._addAngledTicks(t,i,h,this._mid(c,s));break}case e.GapExtentMidline:{const s=this._cp2(r,2,0),i=this._cp3(r,s,0,1);let h;if(_>=4)h=r[3];else{const t=this._sub(s,c);h=this._add(i,t)}const e=[];e.push(this._mid(c,i)),e.push(this._mid(s,h)),t.push(e);break}case e.Chevron:{const s=this._cp2(r,-1,-1);let i;if(_>=3)i=r[2];else{const t=this._sub(s,c);this._leftPerpendicular(t),i=this._add(c,t)}t.push([s,this._makeCtrlPt(c),i]);break}case e.PerpendicularWithArc:{const s=this._cp2(r,0,-2),i=this._cp3(r,s,.5,-1),h=this._sub(s,c),e=this._norm(h);h[0]/=e,h[1]/=e;const u=this._crossProduct(h,this._sub(i,c));let o=this._dotProduct(h,this._sub(i,c));o<.05*e?o=.05*e:o>.95*e&&(o=.95*e);const a=[c[0]+h[0]*o,c[1]+h[1]*o];let n=this._leftPerp(h),p=[];if(p.push([a[0]-n[0]*u,a[1]-n[1]*u]),p.push([a[0]+n[0]*u,a[1]+n[1]*u]),t.push(p),_>=4){const s=r[3];let i=this._dotProduct(h,this._sub(s,c));i<.1*e?i=.1*e:i>.9*e&&(i=.9*e);const _=[c[0]+h[0]*i,c[1]+h[1]*i],u=this._crossProduct(h,this._sub(s,c)),o=[];o.push([_[0]-n[0]*u,_[1]-n[1]*u]),o.push([_[0]+n[0]*u,_[1]+n[1]*u]),t.push(o)}const d=[s[0]+n[0]*u,s[1]+n[1]*u];n=this._sub(s,d);const l=Math.cos(Math.PI/18);let b=Math.sin(Math.PI/18);u<0&&(b=-b),p=[c,s];for(let t=1;t<=9;t++)this._rotateDirect(n,l,b),p.push(this._add(d,n));t.push(p);break}case e.ClosedHalfCircle:{const s=this._cp2(r,2,0),i=this._mid(c,s),h=this._sub(s,i),e=Math.cos(Math.PI/18),_=Math.sin(Math.PI/18),u=[c,s];for(let t=1;t<=18;t++)this._rotateDirect(h,e,_),u.push(this._add(i,h));t.push(u);break}case e.TripleParallelExtended:{const s=this._cp2(r,0,-2),i=this._cp3(r,s,1,-2),e=this._mid(c,s),_=this._sub(i,s);this._normalize(_);const u=Math.abs(this._crossProduct(_,this._sub(e,s)))/2,o=this._dist(s,i),a=[s,c];a.push([c[0]+_[0]*o*.5,c[1]+_[1]*o*.5]),t.push(a);const n=[];n.push([e[0]-_[0]*u,e[1]-_[1]*u]),n.push([e[0]+_[0]*o*.375,e[1]+_[1]*o*.375]),h(n[n.length-1],1),n.push([e[0]+_[0]*o*.75,e[1]+_[1]*o*.75]),t.push(n);const p=[s,i];t.push(p);break}case e.ParallelWithTicks:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._sub(i,s);this._normalize(h);const e=this._crossProduct(h,this._sub(i,c));this._leftPerpendicular(h),this._addAngledTicks(t,c,s,i),this._addAngledTicks(t,this._mix(c,1,h,e),this._mix(s,1,h,e),this._mid(c,s));break}case e.Parallel:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._sub(s,c);this._normalize(h);const e=this._leftPerp(h),_=this._crossProduct(h,this._sub(i,c));let u=[c,s];t.push(u),u=[],u.push([c[0]+e[0]*_,c[1]+e[1]*_]),u.push([s[0]+e[0]*_,s[1]+e[1]*_]),t.push(u);break}case e.PerpendicularToFirstSegment:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._mid(c,s),e=this._sub(s,c);this._normalize(e);const _=this._crossProduct(e,this._sub(i,c));this._leftPerpendicular(e);const u=[];u.push([h[0]-e[0]*_*.25,h[1]-e[1]*_*.25]),u.push([h[0]+e[0]*_*1.25,h[1]+e[1]*_*1.25]),t.push(u);break}case e.ParallelOffset:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._sub(s,c);this._normalize(h);const e=this._crossProduct(h,this._sub(i,c));this._leftPerpendicular(h);const _=[];_.push([c[0]-h[0]*e,c[1]-h[1]*e]),_.push([s[0]-h[0]*e,s[1]-h[1]*e]),t.push(_);const u=[];u.push([c[0]+h[0]*e,c[1]+h[1]*e]),u.push([s[0]+h[0]*e,s[1]+h[1]*e]),t.push(u);break}case e.OffsetOpposite:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._sub(s,c);this._normalize(h);const e=this._crossProduct(h,this._sub(i,c));this._leftPerpendicular(h);const _=[];_.push([c[0]-h[0]*e,c[1]-h[1]*e]),_.push([s[0]-h[0]*e,s[1]-h[1]*e]),t.push(_);break}case e.OffsetSame:{const s=this._cp2(r,3,0),i=this._cp3(r,s,.5,-1),h=this._sub(s,c);this._normalize(h);const e=this._crossProduct(h,this._sub(i,c));this._leftPerpendicular(h);const _=[];_.push([c[0]+h[0]*e,c[1]+h[1]*e]),_.push([s[0]+h[0]*e,s[1]+h[1]*e]),t.push(_);break}case e.CircleWithArc:{let s=this._cp2(r,3,0);const i=this._cp3(r,s,.5,-1);let e,u;if(_>=4)e=r[3],u=this._crossProduct(this._sub(e,s),this._sub(i,s))>0;else{e=s,u=this._crossProduct(this._sub(e,c),this._sub(i,c))>0;const t=24*this._geomUnitsPerPoint,h=this._sub(e,c);this._normalize(h,t);const r=Math.sqrt(2)/2;this._rotateDirect(h,r,u?r:-r),s=this._add(c,h)}const o=this._sub(s,c),a=Math.cos(Math.PI/18),n=Math.sin(Math.PI/18),p=[s];for(let t=1;t<=36;t++)this._rotateDirect(o,a,n),p.push(this._add(c,o));this._add90DegArc(p,s,e,i,u),h(p[p.length-8],1),t.push(p);break}case e.DoubleJog:{let s,i=this._cp2(r,-3,1),h=this._cp3(r,i,-1,-.5);if(_>=4)s=r[3];else{const t=c;c=i,s=h;const e=this._dist(c,t),r=this._dist(s,t);let _=30*this._geomUnitsPerPoint;.5*e<_&&(_=.5*e),.5*r<_&&(_=.5*r),i=this._mix(c,_/e,t,(e-_)/e),h=this._mix(s,_/r,t,(r-_)/r)}const e=this._mid(c,i),u=this._mid(s,h),o=this._dist(c,i),a=this._dist(h,s);let n=Math.min(o,a)/8;n=Math.min(n,24*this._geomUnitsPerPoint);const p=Math.cos(Math.PI/4);let d=this._sub(c,i);this._normalize(d,n),this._crossProduct(d,this._sub(s,i))>0?this._rotateDirect(d,p,-p):this._rotateDirect(d,p,p);let l=[];l.push(i),l.push(this._add(e,d)),l.push(this._sub(e,d)),l.push(c),t.push(l),d=this._sub(s,h),this._normalize(d,n),this._crossProduct(d,this._sub(c,h))<0?this._rotateDirect(d,p,p):this._rotateDirect(d,p,-p),l=[],l.push(h),l.push(this._add(u,d)),l.push(this._sub(u,d)),l.push(s),t.push(l);break}case e.PerpendicularOffset:{const s=this._cp2(r,-4,1),i=this._cp3(r,s,.882353,-1.94),h=this._sub(i,s);this._crossProduct(h,this._sub(c,s))>0?this._rightPerpendicular(h):this._leftPerpendicular(h);const e=[h[0]/8,h[1]/8],_=this._sub(this._mid(s,i),e);t.push([_,c]);break}case e.LineExcludingLastSegment:{const s=this._arrowPath(r),i=[];let h=s.length-2;for(;h--;)i.push(s[h]);t.push(i);break}case e.MultivertexArrow:{const s=this._arrowPath(r),i=[];this._addArrow(i,s,!1),t.push(i);break}case e.CrossedArrow:{const s=this._arrowPath(r),i=[];this._addArrow(i,s,!0),t.push(i);break}case e.ChevronArrow:{const[s,i]=this._arrowLastSeg(r),h=10*this._geomUnitsPerPoint,e=this._sub(c,s),_=this._norm(e);this._normalize(e);const u=this._crossProduct(e,this._sub(i,s));let o=this._dotProduct(e,this._sub(i,s));o<.05*_?o=.05*_:o>.95*_-h&&(o=.95*_-h);const a=[s[0]+e[0]*o,s[1]+e[1]*o],n=this._leftPerp(e),p=[];p.push([a[0]+n[0]*u+e[0]*h,a[1]+n[1]*u+e[1]*h]),p.push(c),p.push([a[0]-n[0]*u+e[0]*h,a[1]-n[1]*u+e[1]*h]),t.push(p);break}case e.ChevronArrowOffset:{const[s,i]=this._arrowLastSeg(r),h=this._sub(c,s),e=this._norm(h);this._normalize(h);const _=this._crossProduct(h,this._sub(i,s));let u=this._dotProduct(h,this._sub(i,s));u<.05*e?u=.05*e:u>.95*e&&(u=.95*e);const o=[s[0]+h[0]*u,s[1]+h[1]*u];this._leftPerpendicular(h);const a=[];a.push([o[0]+h[0]*_*.5,o[1]+h[1]*_*.5]),a.push(this._mid(o,c)),a.push([o[0]-h[0]*_*.5,o[1]-h[1]*_*.5]),t.push(a);break}case e.PartialFirstSegment:{const[s,i]=this._arrowLastSeg(r),h=this._sub(c,s),e=this._norm(h);this._normalize(h);let _=this._dotProduct(h,this._sub(i,s));_<.05*e?_=.05*e:_>.95*e&&(_=.95*e);const u=[s[0]+h[0]*_,s[1]+h[1]*_];t.push([s,u]);break}case e.Arch:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,1),h=this._sub(c,s),e=this._mix(i,1,h,.55),_=this._mix(i,1,h,-.55),u=[c];this._addBezier2(u,c,e,i,4),this._addBezier2(u,i,_,s,4),t.push(u);break}case e.CurvedParallelTicks:{const s=this._cp2(r,-4,1),i=this._cp3(r,s,.882353,-1.94),h=this._sub(i,s);this._crossProduct(h,this._sub(c,s))>0?this._rightPerpendicular(h):this._leftPerpendicular(h);const e=[h[0]/8,h[1]/8],_=this._sub(this._mid(s,i),e),u=this._sub(this._mix(s,.75,i,.25),e),o=this._sub(this._mix(s,.25,i,.75),e),a=[s];this._addBezier2(a,s,u,_,3),this._addBezier2(a,_,o,i,3),t.push(a);for(let r=0;r<8;r++){const s=a[2*r+1],i=[this._clone(s)];i.push(this._add(s,[h[0]/4,h[1]/4])),t.push(i)}break}case e.Arc90Degrees:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,1),h=[s];this._add90DegArc(h,s,c,i),t.push(h);break}case e.TipWithPerpendicularAndTicks:{const[s,i]=this._arrowLastSeg(r),h=10*this._geomUnitsPerPoint,e=this._sub(c,s),_=this._norm(e);this._normalize(e);let u=this._crossProduct(e,this._sub(i,s)),o=this._dotProduct(e,this._sub(i,s));o<.05*_?o=.05*_:o>.95*_-h&&(o=.95*_-h);const a=this._leftPerp(e),n=[c[0]-e[0]*h,c[1]-e[1]*h],p=.5*Math.max(_-o-h,h);u=Math.abs(u);const d=[];d.push([n[0]+a[0]*(u+p)-e[0]*p,n[1]+a[1]*(u+p)-e[1]*p]),d.push([n[0]+a[0]*u,n[1]+a[1]*u]),d.push([n[0]-a[0]*u,n[1]-a[1]*u]),d.push([n[0]-a[0]*(u+p)-e[0]*p,n[1]-a[1]*(u+p)-e[1]*p]),t.push(d),t.push([n,c]);break}case e.ConcentricCircles:{const s=this._cp2(r,1,0),i=this._cp3(r,s,2,0),e=Math.cos(Math.PI/18),u=Math.sin(Math.PI/18);let o=this._dist(s,c),a=[o,0],n=[];for(let t=0;t<=36;t++)n.push(this._add(c,a)),this._rotateDirect(a,e,u);if(t.push(n),_>=4){n=[];const s=r[3];o=this._dist(s,c),a=[o,0];for(let t=0;t<=36;t++)n.push(this._add(c,a)),0===t&&(n.push(this._add(c,a)),h(n[1],1)),this._rotateDirect(a,e,u);t.push(n)}n=[],o=this._dist(i,c),a=[o,0];for(let t=0;t<=36;t++)n.push(this._add(c,a)),this._rotateDirect(a,e,u);t.push(n);break}case e.DoubleJogArrow:{c=this._arrowPath(r)[0];const[s,i]=this._arrowLastSeg(r),h=this._sub(c,s),e=this._norm(h);this._normalize(h);const _=Math.abs(this._crossProduct(h,this._sub(i,c)));let u=Math.abs(this._dotProduct(h,this._sub(i,c)));u<.05*e?u=.05*e:u>.95*e&&(u=.95*e);const o=Math.max(_,u),a=this._leftPerp(h);let n=[];const p=[c[0]-h[0]*u*.5+a[0]*_*.5,c[1]-h[1]*u*.5+a[1]*_*.5];n.push([p[0],p[1]]),p[0]+=h[0]*o*.5+a[0]*o*.4,p[1]+=h[1]*o*.5+a[1]*o*.4,n.push([p[0],p[1]]),p[0]-=a[0]*o*.25,p[1]-=a[1]*o*.25,n.push([p[0],p[1]]),p[0]+=h[0]*o*.5+a[0]*o*.4,p[1]+=h[1]*o*.5+a[1]*o*.4,n.push([p[0],p[1]]),t.push(n),n=[],p[0]=c[0]-h[0]*u*.5-a[0]*_*.5,p[1]=c[1]-h[1]*u*.5-a[1]*_*.5,n.push([p[0],p[1]]),p[0]+=h[0]*o*.5-a[0]*o*.4,p[1]+=h[1]*o*.5-a[1]*o*.4,n.push([p[0],p[1]]),p[0]+=a[0]*o*.25,p[1]+=a[1]*o*.25,n.push([p[0],p[1]]),p[0]+=h[0]*o*.5-a[0]*o*.4,p[1]+=h[1]*o*.5-a[1]*o*.4,n.push([p[0],p[1]]),t.push(n);break}case e.LinkedChevrons:{const s=this._cp2(r,-5,0),i=this._cp3(r,s,-.2,1),h=this._sub(c,s);this._normalize(h);const e=this._leftPerp(h),_=Math.abs(this._crossProduct(h,this._sub(i,s)));t.push([s,c]);const u=[];u.push([c[0]-h[0]*_+e[0]*_,c[1]-h[1]*_+e[1]*_]),u.push(c),u.push([c[0]-h[0]*_-e[0]*_,c[1]-h[1]*_-e[1]*_]),t.push(u),this._addDash(t,s,[-h[0]*_+e[0]*_,-h[1]*_+e[1]*_]),this._addDash(t,s,[-h[0]*_-e[0]*_,-h[1]*_-e[1]*_]);break}case e.SegmentThenHalfCircle:{const s=this._cp2(r,2,0),i=this._cp3(r,s,1.5,0);let h;h=_>=4?r[3]:this._cp3(r,s,1.25,-.5);const e=this._sub(s,c);this._normalize(e);const u=.5*this._dist(s,i),o=this._crossProduct(e,this._sub(h,c))>0,a=Math.cos(Math.PI/18);let n=Math.sin(Math.PI/18);o&&(n=-n);const p=[c,s];e[0]*=u,e[1]*=u;const d=this._add(s,e);e[0]=-e[0],e[1]=-e[1];for(let t=1;t<=18;t++)this._rotateDirect(e,a,n),p.push(this._add(d,e));t.push(p);break}case e.LineWithStraightTicks:{const s=this._cp2(r,-2,1),i=this._cp3(r,s,-1,-.5),h=this._sub(i,s);this._normalize(h);const e=this._dotProduct(h,this._sub(s,c)),_=this._dotProduct(h,this._sub(i,c));let u=[c];u.push([c[0]+h[0]*e,c[1]+h[1]*e]),u.push(s),t.push(u),u=[c],u.push([c[0]+h[0]*_,c[1]+h[1]*_]),u.push(i),t.push(u);break}case e.DoubleCurve:{const s=this._cp2(r,-5,-1),i=this._cp3(r,s,2,0),e=Math.atan2(1,5),_=Math.cos(e),u=Math.sin(e),o=this._sub(s,c),a=this._dist(c,s);this._normalize(o),this._rotateDirect(o,_,-u);const n=[c];n.push([c[0]+o[0]*a*.5,c[1]+o[1]*a*.5]),h(n[1],1),n.push([c[0]+o[0]*a*.8,c[1]+o[1]*a*.8]),this._addBezier2(n,n[2],[c[0]+o[0]*a,c[1]+o[1]*a],s,3);const p=this._sub(i,s),d=this._dist(s,i);this._normalize(p),this._rotateDirect(p,_,-u),this._addBezier2(n,s,[i[0]-p[0]*d,i[1]-p[1]*d],[i[0]-p[0]*d*.8,i[1]-p[1]*d*.8],3),n.push(i),t.push(n);break}case e.ParallelWithTicksByWidth:{const s=this._cp2(r,0,-1),i=this._cp3(r,s,.5,3),h=this._sub(s,c);this._normalize(h);const e=this._crossProduct(h,this._sub(i,c));this._leftPerpendicular(h),e>0?(this._addAngledTicks(t,c,[c[0]+h[0]*e,c[1]+h[1]*e],s),this._addAngledTicks(t,s,[s[0]+h[0]*e,s[1]+h[1]*e],c)):(this._addAngledTicks(t,[c[0]+h[0]*e,c[1]+h[1]*e],c,s),this._addAngledTicks(t,[s[0]+h[0]*e,s[1]+h[1]*e],c,s));break}case e.EnclosingRoundedRectangle:{const s=this._cp2(r,3,-2),t=[Math.min(c[0],s[0]),Math.max(c[1],s[1])],i=[Math.max(c[0],s[0]),Math.min(c[1],s[1])],h=i[0]-t[0],e=t[1]-i[1],_=Math.min(h,e)/10,u=[];u.push([t[0]+_+.75*(h-2*_),t[1]]),u.push([i[0]-_,t[1]]),this._add90DegArc(u,[i[0]-_,t[1]],[i[0],t[1]-_],[i[0],t[1]]),u.push([i[0],i[1]+_]),this._add90DegArc(u,[i[0],i[1]+_],[i[0]-_,i[1]],i),u.push([t[0]+_,i[1]]),this._add90DegArc(u,[t[0]+_,i[1]],[t[0],i[1]+_],[t[0],i[1]]),u.push([t[0],t[1]-_]),this._add90DegArc(u,[t[0],t[1]-_],[t[0]+_,t[1]],t),u.push([t[0]+_+.75*(h-2*_),t[1]]);break}case e.FullGeometry:default:t.push(r)}}return t}}export{r as EffectControlMeasureLine};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as e}from\"../../../geometry/GeometryCursor.js\";import{PathEffectCursor as t}from\"../CIMCursor.js\";import{CurveHelper as i}from\"../CurveHelper.js\";class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(e,t,i,r,n){return new u(e,t,i)}}r.instance=null;class u extends t{constructor(e,t,r){super(e,!0,!0),this._curveHelper=new i,this._beginCut=(void 0!==t.beginCut?t.beginCut:1)*r,this._endCut=(void 0!==t.endCut?t.endCut:1)*r,this._middleCut=(void 0!==t.middleCut?t.middleCut:0)*r,this._invert=void 0!==t.invert&&t.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(t){const{_beginCut:i,_endCut:r,_middleCut:u}=this,n=t.pathLength(),s=e.createEmptyOptimizedCIM(\"esriGeometryPolyline\");if(this._invert){if(0!==i||0!==r||0!==u)if(i+r+u>=n)for(s.startPath();t.nextPoint();)s.pushXY(t.x,t.y);else this._curveHelper.appendSubCurve(s,t,0,i),this._curveHelper.appendSubCurve(s,t,.5*(n-u),.5*(n+u)),this._curveHelper.appendSubCurve(s,t,n-r,r)}else if(0===i&&0===r&&0===u)for(s.startPath();t.nextPoint();)s.pushXY(t.x,t.y);else i+r+u<n&&(0===u?this._curveHelper.appendSubCurve(s,t,i,n-r):(this._curveHelper.appendSubCurve(s,t,i,.5*(n-u)),this._curveHelper.appendSubCurve(s,t,.5*(n+u),n-r)));return 0===s.totalSize?null:s}}export{r as EffectCut};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{collectPath as e}from\"../../../geometry/geometryCursorCollectUtils.js\";import{PathEffectCursor as s}from\"../CIMCursor.js\";import{LineDashEnding as i}from\"../enums.js\";import{GeometryWalker as r,DashPattern as a}from\"../GeometryWalker.js\";import{normalizeDashEffectTemplate as n}from\"../utils.js\";class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(t,e,s,i,r){return new l(t,e,s)}}h.instance=null;class l extends s{constructor(t,e,s){super(t,!0,!0),this._firstCurve=null,this._walker=new r,this._walker.updateTolerance(s),this._endings=e.lineDashEnding,this._customDashPos=-(e.offsetAlongLine??0)*s,this._offsetAtEnd=(e.customEndingOffset??0)*s;let i=n(e).dashTemplate;null==i&&(i=[]),i.length%2&&(i=[...i,...i]),this._pattern=new a,this._pattern.init(i,!0),this._pattern.scale(s)}processPath(s){if(0===this._pattern.length()){this.iteratePath=!1;const i=e(s);return t.fromJSONCIM({paths:[i]})}if(!this.iteratePath){let r=!0;switch(this._endings){case i.HalfPattern:case i.HalfGap:default:this._pattern.extPtGap=0;break;case i.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case i.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case i.NoConstraint:this.isClosed||(r=!1);break;case i.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const a=s.pathLength();if(this._pattern.isEmpty()||a<.1*this._pattern.length()){const i=e(s);return t.fromJSONCIM({paths:[i]})}if(!this._walker.init(s,this._pattern,r)){const i=e(s);return t.fromJSONCIM({paths:[i]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else{let t;switch(this._endings){case i.HalfPattern:default:t=.5*this._pattern.firstValue();break;case i.HalfGap:t=.5*-this._pattern.lastValue();break;case i.FullGap:t=-this._pattern.lastValue();break;case i.FullPattern:t=0;break;case i.NoConstraint:case i.Custom:t=-this._customDashPos}let e=t/this._pattern.length();e-=Math.floor(e),t=e*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let s=!1;for(;t>=r;)t-=r,r=this._pattern.nextValue(),s=!s;r-=t,s?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}let a=this._walker.nextCurve(r);if(a)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)a.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(a.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,a=this._firstCurve,this._firstCurve=null;return a?.reset(),a}}export{h as EffectDashes};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{clipCursorToTileExtent as i}from\"../CIMEffects.js\";import{GeometricEffectDonutMethod as e}from\"../enums.js\";import n from\"../../../geometry/SpatialReference.js\";class s{static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(t,i,e,n,s,o){return new r(t,i,e,n,s,o)}}s.instance=null;class r{constructor(t,i,n,s,r,o){switch(this._inputGeometries=t,this._tileKey=s,this._geometryEngine=r,this._maxInflateSize=o*n,this._width=(void 0!==i.width?i.width:2)*n,i.method){case e.Mitered:case e.Bevelled:case e.Rounded:case e.TrueBuffer:case e.Square:}this._option=i.option}next(){let e;for(;e=this._inputGeometries.next();){if(\"esriGeometryEnvelope\"===e.geometryType&&this._width>0){const i=e.asJSON();return Math.min(i.xmax-i.xmin,i.ymax-i.ymin)-2*this._width<0?e:t.fromJSONCIM({paths:[[[i.xmin+this._width,i.ymin+this._width],[i.xmax-this._width,i.ymin+this._width],[i.xmax-this._width,i.ymax-this._width],[i.xmin+this._width,i.ymax-this._width],[i.xmin+this._width,i.ymin+this._width]],[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]})}if(\"esriGeometryPolygon\"===e.geometryType){if(0===this._width)return e.clone();const t=this._geometryEngine;if(null==t)return null;const s=this._tileKey?i(e,this._maxInflateSize):e.clone();if(!s)continue;const r=t.buffer(n.WebMercator,s.asJSON(),-this._width,1);if(r)for(const i of r.rings)if(i){s.startPath();for(const t of i.reverse())s.pushXY(t[0],s.yFactor*t[1])}return s}}return null}}export{s as EffectDonut};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{PathEffectCursor as i}from\"../CIMCursor.js\";import{CurveHelper as s}from\"../CurveHelper.js\";class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,i,s,e,o){return new n(t,i,s)}}e.instance=null;class n extends i{constructor(t,i,e){super(t,!1,!0),this._curveHelper=new s,this._length=(void 0!==i.length?i.length:20)*e,this._angle=void 0!==i.angle?i.angle:225,this._position=void 0!==i.position?i.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(i){const s=t.createEmptyOptimizedCIM(\"esriGeometryPolyline\");if(this._curveHelper.isEmpty(i))return null;i.seekInPath(0);const e=i.x,n=i.y;i.seekInPath(i.pathSize-1);const o=i.x,r=i.y,h=[o-e,r-n];this._curveHelper.normalize(h);const l=e+(o-e)*this._position/100,_=n+(r-n)*this._position/100,a=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(p=-p),this._mirror=!this._mirror;const c=[l-this._length/2*a,_-this._length/2*p],m=[l+this._length/2*a,_+this._length/2*p];return s.pushPath([[e,n],c,m,[o,r]]),s}}export{e as EffectJog};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{static local(){return null===t.instance&&(t.instance=new t),t.instance}execute(t,s,n,o,i){return new e(t,s,n)}}t.instance=null;class e{constructor(t,e,s){this._inputGeometries=t,this._offsetX=void 0!==e.offsetX?e.offsetX*s:0,this._offsetY=void 0!==e.offsetY?e.offsetY*s:0}next(){let t=this._inputGeometries.next();for(;t;){if(t.totalSize>0)return this._move(t.clone(),this._offsetX,this._offsetY);t=this._inputGeometries.next()}return null}_move(t,e,s){for(;t.nextPath();)for(;t.nextPoint();)t.x=t.x+e,t.y=t.y+s;return t.reset(),t}}export{t as EffectMove};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../geometry.js\";import{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{collectPath as e}from\"../../../geometry/geometryCursorCollectUtils.js\";import{isExtent as s}from\"../../../geometry/support/jsonUtils.js\";import{clipCursorToTileExtent as o}from\"../CIMEffects.js\";import{CurveHelper as r,pixelTolerance as i}from\"../CurveHelper.js\";import{GeometricEffectOffsetMethod as n}from\"../enums.js\";import m from\"../../../geometry/SpatialReference.js\";const f=10;class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(t,e,s,o,r,i){return new l(t,e,s,o,r,i)}}h.instance=null;class l{constructor(t,e,s,o,n,m){this._inputGeometries=t,this._tileKey=o,this._geometryEngine=n,this._curveHelper=new r,this._offset=(e.offset??1)*s,this._method=e.method,this._maxInflateSize=Math.max(Math.abs(m*s),f),this._option=e.option,this._offsetFlattenError=i*s}next(){let r;for(;r=this._inputGeometries.next();){if(0===this._offset)return r.clone();if(\"esriGeometryEnvelope\"===r.geometryType){if(this._method===n.Rounded&&this._offset>0){const s=e(r),o=this._curveHelper.offset(s,-this._offset,this._method,4,this._offsetFlattenError);if(o){const e=t.createEmptyOptimizedCIM(r.geometryType);return e.pushPath(o),e}return null}const o=r.asJSON();if(s(o)&&Math.min(o.xmax-o.xmin,o.ymax-o.ymin)+2*this._offset>0)return t.fromJSONCIM({xmin:o.xmin-this._offset,xmax:o.xmax+this._offset,ymin:o.ymin-this._offset,ymax:o.ymax+this._offset})}const i=this._geometryEngine;if(null==i)continue;const f=this._tileKey?o(r,this._maxInflateSize):r.clone();if(!f)continue;const h=i.offset(m.WebMercator,f.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return h?t.fromJSONCIM(h):null}return null}}export{h as EffectOffset};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(e,n,r,s,i){return new t(e,n,r)}}e.instance=null;class t{constructor(e,t,n){this._inputGeometries=e,this._reverse=void 0===t.reverse||t.reverse}next(){let e=this._inputGeometries.next();for(;e;){if(!this._reverse)return e;if(\"esriGeometryPolyline\"===e.geometryType)return n(e.clone());e=this._inputGeometries.next()}return null}}function n(e){for(;e.nextPath();)for(let t=0;t<e.pathSize/2;t++){e.seekInPath(t);const n=e.x,r=e.y;e.seekInPath(e.pathSize-t-1);const s=e.x,i=e.y;e.x=n,e.y=r,e.seekInPath(t),e.x=s,e.y=i}return e.reset(),e}export{e as EffectReverse};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getCursorBoundsXY as t}from\"../../../geometry/support/boundsUtils.js\";class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,e,r,s,o){return new n(t,e,r)}}e.instance=null;class n{constructor(t,e,n){this._inputGeometries=t,this._rotateAngle=void 0!==e.angle?e.angle*Math.PI/180:0}next(){let e=this._inputGeometries.next();for(;e;){if(0===this._rotateAngle||\"esriGeometryPoint\"===e.geometryType)return e;if(e.totalSize>0){const n=t(e),r=(n[2]+n[0])/2,s=(n[3]+n[1])/2;return e.reset(),this._rotate(e.clone(),r,s)}e=this._inputGeometries.next()}return null}_rotate(t,e,n){const r=Math.cos(this._rotateAngle),s=Math.sin(this._rotateAngle);for(;t.nextPath();)for(;t.nextPoint();){const o=t.x-e,i=t.y-n;t.x=e+o*r-i*s,t.y=n+o*s+i*r}return t.reset(),t}}export{e as EffectRotate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getCursorBoundsXY as t}from\"../../../geometry/support/boundsUtils.js\";class e{static local(){return null===e.instance&&(e.instance=new e),e.instance}execute(t,e,o,s,n){return new r(t,e,o)}}e.instance=null;class r{constructor(t,e,r){this._inputGeometries=t,this._xFactor=void 0!==e.xScaleFactor?e.xScaleFactor:1.15,this._yFactor=void 0!==e.yScaleFactor?e.yScaleFactor:1.15}next(){const e=this._inputGeometries.next();if(e){if(1===this._xFactor&&1===this._yFactor)return e;if(\"esriGeometryPoint\"===e.geometryType)return e;if(e.totalSize>0){const r=t(e),o=(r[2]+r[0])/2,s=(r[3]+r[1])/2;return e.reset(),this._scaleCursor(e.clone(),o,s)}}return null}_scaleCursor(t,e,r){for(;t.nextPath();)for(;t.nextPoint();)t.x=e+(t.x-e)*this._xFactor,t.y=r+(t.y-r)*this._yFactor;return t.reset(),t}}export{e as EffectScale};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{GeometryCursor as t}from\"../../../geometry/GeometryCursor.js\";import{GeometricEffectWaveform as e}from\"../enums.js\";import{DashPattern as i,GeometryWalker as s,Pos as h}from\"../GeometryWalker.js\";class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(t,e,i,s,h){return new r(t,e,i)}}n.instance=null;class r{constructor(t,e,h){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*h,this._period=(void 0!==e.period?e.period:3)*h,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new i,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new s,this._walker.updateTolerance(h)}next(){let t=this._inputGeometries.next();for(;t;){if(0===this._height||0===this._period)return t;const e=this._processGeom(t);if(e)return e;t=this._inputGeometries.next()}return null}_processGeom(i){const s=t.createEmptyOptimizedCIM(i.geometryType);for(;i.nextPath();){s.startPath();const t=i.pathLength();if(this._walker.init(i,this._pattern))switch(this._style){case e.Sinus:default:this._constructCurve(s,t,!1);break;case e.Square:this._constructSquare(s,t);break;case e.Triangle:this._constructTriangle(s,t);break;case e.Random:this._constructCurve(s,t,!0)}else for(;i.nextPoint();)s.pushXY(i.x,i.y)}return s}_constructCurve(t,e,i){let s=Math.round(e/this._period);0===s&&(s=1);const n=s*16+1,r=e/s,a=this._period/16,o=1/n,p=2*Math.PI*e/r,_=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),l=2*Math.PI*Math.random(),c=.75-Math.random()/2,d=.75-Math.random()/2,g=new h;this._walker.curPointAndAngle(g),t.pushPoint(g.pt);let w=0;for(;;){if(!this._walker.nextPointAndAngle(a,g)){t.pushPoint(this._walker.getPathEnd());break}{const e=w;let s;if(w+=o,i){const t=this._height/2*(1+.3*Math.sin(c*p*e+_));s=t*Math.sin(p*e+u),s+=t*Math.sin(d*p*e+l),s/=2}else s=.5*this._height*Math.sin(.5*p*e);t.pushXY(g.pt[0]-s*g.sa,g.pt[1]+s*g.ca)}}}_constructSquare(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new h;this._walker.curPointAndAngle(s);const n=new h;if(this._walker.nextPointAndAngle(this._period,n)){const r=new h;this._walker.nextPointAndAngle(this._period,r)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(t,e){Math.round(e/this._period);let i=!0;for(;;){let e=!1;if(this._walker.curPositionIsValid()){const s=new h;this._walker.curPointAndAngle(s);const n=new h;if(this._walker.nextPointAndAngle(this._period/2,n)){const r=new h;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(i?(t.pushPoint(s.pt),i=!1):t.pushPoint(s.pt),t.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),t.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),e=!0)}}if(!e){t.pushPoint(this._walker.getPathEnd());break}}}}export{n as EffectWave};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction t(t){const e=t.getFrame(0);if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement)return e;const n=document.createElement(\"canvas\");n.width=t.width,n.height=t.height;const a=n.getContext(\"2d\");return e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0),n}export{t as getFirstFrame};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as t}from\"../CIMCursor.js\";import{PlacementEndings as e}from\"../enums.js\";import{GeometryWalker as s,DashPattern as i,Pos as n}from\"../GeometryWalker.js\";class a{static local(){return null===a.instance&&(a.instance=new a),a.instance}execute(t,e,s,i,n){return new r(t,e,s)}}a.instance=null;class r extends t{constructor(t,e,n){super(t),this._geometryWalker=new s,this._geometryWalker.updateTolerance(n),this._angleToLine=e.angleToLine??!0,this._offset=(e.offset?e.offset:0)*n,this._originalEndings=e.endings,this._offsetAtEnd=(e.customEndingOffset?e.customEndingOffset:0)*n,this._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*n,this._pattern=new i,this._pattern.init(e.placementTemplate,!1),this._pattern.scale(n),this._endings=this._originalEndings}processPath(t){if(this._pattern.isEmpty())return null;let s;if(this.iteratePath)s=this._pattern.nextValue();else{this._originalEndings===e.WithFullGap&&this.isClosed?this._endings=e.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let i,n=!0;switch(this._endings){case e.NoConstraint:i=-this._position,i=this._adjustPosition(i),n=!1;break;case e.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case e.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case e.WithMarkers:i=0;break;case e.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(t,this._pattern,n))return null;this._pattern.reset();let a=0;for(;i>a;)i-=a,a=this._pattern.nextValue();a-=i,s=a,this.iteratePath=!0}const i=new n;return this._geometryWalker.nextPointAndAngle(s,i)?this._endings===e.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===e.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let e=t/this._pattern.length();return e-=Math.floor(e),e*this._pattern.length()}}export{a as PlacementAlongLineSameSize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as t}from\"../CIMCursor.js\";import{CurveHelper as e}from\"../CurveHelper.js\";import{ExtremityPlacement as s}from\"../enums.js\";class i{static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(t,e,s,i,n){return new r(t,e,s)}}i.instance=null;class r extends t{constructor(t,s,i){super(t,!1,!0),this._curveHelper=new e,this._placePerPart=s.placePerPart??!1,this._angleToLine=void 0===s.angleToLine||s.angleToLine,this._offset=void 0!==s.offset?s.offset*i:0,this._type=s.extremityPlacement,this._position=void 0!==s.offsetAlongLine?s.offsetAlongLine*i:0,this._beginProcessed=!1}processMultiPath(t){return this._placePerPart?super.processMultiPath(t):this.processPath(t)}processPath(t){let e;switch(this._type){case s.Both:default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case s.JustBegin:e=this._atExtremities(t,this._position,!0);break;case s.JustEnd:e=this._atExtremities(t,this._position,!1);case s.None:}return e}_atExtremities(t,e,s){if(this._placePerPart||(s?t.seekPath(0):t.seekPath(t.totalSize-1)),s||t.seekPathEnd(),s?t.nextPoint():t.prevPoint()){let i=0,[r,n]=[0,0],[a,o]=[t.x,t.y];for(;s?t.nextPoint():t.prevPoint();){r=a,n=o,a=t.x,o=t.y;const s=this._curveHelper.getLength(r,n,a,o);if(i+s>e){const t=(e-i)/s,[h,l]=this._curveHelper.getAngleCS(r,n,a,o,t),c=this._curveHelper.getCoord2D(r,n,a,o,t);return this.internalPlacement.setTranslate(c[0]-this._offset*l,c[1]+this._offset*h),this._angleToLine&&this.internalPlacement.setRotateCS(-h,-l),this.internalPlacement}i+=s}}return null}}export{i as PlacementAtExtremities};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as t}from\"../CIMCursor.js\";import{GeometryWalker as i,DashPattern as s,EndType as e,Pos as n}from\"../GeometryWalker.js\";class a{static local(){return null===a.instance&&(a.instance=new a),a.instance}execute(t,i,s,e,n){return new r(t,i,s)}}a.instance=null;class r extends t{constructor(t,e,n){super(t),this._walker=new i,this._walker.updateTolerance(n),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*n:0,this._beginGap=void 0!==e.beginPosition?e.beginPosition*n:0,this._endGap=void 0!==e.endPosition?e.endPosition*n:0,this._flipFirst=void 0===e.flipFirst||e.flipFirst,this._pattern=new s,this._pattern.init(e.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const t=this._pattern.nextValue()*this._subPathLen,s=this._beginGap+t;i=s-this._prevPos,this._prevPos=s}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=t.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const s=this._pattern.nextValue()*this._subPathLen,e=this._beginGap+s;i=e-this._prevPos,this._prevPos=e,this.iteratePath=!0}const s=new n;if(!this._walker.nextPointAndAngle(i,s,e.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);const a=this._isFirst&&this._flipFirst;let r,h;return this._angleToLine?(r=s.ca,h=s.sa):(r=1,h=0),a&&(r=-r,h=-h),this.internalPlacement.setRotateCS(r,h),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}export{a as PlacementAtRatioPositions};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport t from\"../../../core/RandomLCG.js\";import{Placement as s}from\"../CIMPlacements.js\";import{PlacementGridType as i}from\"../enums.js\";const e=512,h=10,n=24,_=1e-6;class r{static local(){return null===r.instance&&(r.instance=new r),r.instance}execute(t,s,i,e,h){return new a(t,s,i,e,h)}}r.instance=null;class a{constructor(h,n,_,r,a){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(n.stepX??16)*_,this._stepY=Math.abs(n.stepY??16)*_,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=n.gridType??i.Fixed,this._gridType===i.Random){const s=n.seed??13,i=1;this._randomLCG=new t(s*i),this._randomness=(n.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{if(this._randomness=0,this._gridAngle=n.gridAngle??0,this._shiftOddRows=n.shiftOddRows??!1,this._offsetX=(n.offsetX??0)*_,this._offsetY=(n.offsetY??0)*_,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=r){const[t,s,i,h]=r.split(\"/\"),n=parseFloat(t),_=parseFloat(s),a=parseFloat(i),o=parseFloat(h);this._graphicOriginX=-(o*2**n+a)*e,this._graphicOriginY=_*e,this._testInsidePolygon=!0}this._internalPlacement=new s,this._calculateMinMax(h),this._geometryCursor=h}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!a._randValues){a._randValues=[];for(let t=0;t<n;t++)for(let s=0;s<n;s++)a._randValues.push(this._randomLCG.getFloat()),a._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(t){let s,i,h,n,_,r,a,o,l,f,c,u,p,M;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,a=o=p=c=Number.MAX_VALUE,l=f=M=u=-Number.MAX_VALUE;const g=1!==this._cosAngle;for(t.reset();t.nextPath();)for(;t.nextPoint();)r=t.x,_=t.y,s=r-this._graphicOriginX-this._offsetX,i=_-this._graphicOriginY-this._offsetY,g?(h=this._cosAngle*s-this._sinAngle*i,n=this._sinAngle*s+this._cosAngle*i):(h=s,n=i),a=Math.min(a,h),l=Math.max(l,h),o=Math.min(o,n),f=Math.max(f,n),c=Math.min(c,_),u=Math.max(u,_),p=Math.min(p,r),M=Math.max(M,r);c=c!==Number.MAX_VALUE?c:-e-this._stepY,u=u!==-Number.MAX_VALUE?u:this._stepY,p=p!==Number.MAX_VALUE?p:-this._stepX,M=M!==-Number.MAX_VALUE?M:e+this._stepX;const d=u-c,X=M-p;if(this._verticalSubdivision=d>=X,this._polygonMin=this._verticalSubdivision?c:p,this._testInsidePolygon){let t=0-this._graphicOriginX-this._offsetX-this._stepX,s=e-this._graphicOriginX-this._offsetX+this._stepX,i=-e-this._graphicOriginY-this._offsetY-this._stepY,h=0-this._graphicOriginY-this._offsetY+this._stepY;if(g){const e=[[t,i],[t,h],[s,i],[s,h]];t=i=Number.MAX_VALUE,s=h=-Number.MAX_VALUE;for(const n of e){const e=this._cosAngle*n[0]-this._sinAngle*n[1],_=this._sinAngle*n[0]+this._cosAngle*n[1];t=Math.min(t,e),s=Math.max(s,e),i=Math.min(i,_),h=Math.max(h,_)}}a=a!==Number.MAX_VALUE?Math.max(a,t):t,o=o!==Number.MAX_VALUE?Math.max(o,i):i,l=l!==-Number.MAX_VALUE?Math.min(l,s):s,f=f!==-Number.MAX_VALUE?Math.min(f,h):h}this._xMin=Math.round(a/this._stepX),this._xMax=Math.round(l/this._stepX),this._yMin=Math.round(o/this._stepY),this._yMax=Math.round(f/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(t,p,M,c,u)}_buildAccelerationMap(t,s,i,n,_){t.reset();const r=new Map,a=this._verticalSubdivision,o=a?_-n:i-s;let f=Math.ceil(o/h);if(f<=1)return;const c=Math.floor(o/f);let u,p,M,g,d,X,m,x,A,Y,y;for(f++,this._delta=c,a?(A=-e-2*this._stepY,Y=2*this._stepY,y=n):(A=-2*this._stepX,Y=e+2*this._stepX,y=s);t.nextPath();)if(!(t.pathSize<2)&&t.nextPoint())for(u=t.x,p=t.y;t.nextPoint();u=M,p=g){if(M=t.x,g=t.y,a){if(p===g||p<A&&g<A||p>Y&&g>Y)continue;d=Math.min(p,g),X=Math.max(p,g)}else{if(u===M||u<A&&M<A||u>Y&&M>Y)continue;d=Math.min(u,M),X=Math.max(u,M)}for(;d<X;)m=Math.floor((d-y)/c),l(m,u,p,M,g,r),d+=c;x=Math.floor((X-y)/c),x>m&&l(x,u,p,M,g,r)}this._accelerationMap=r}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const s=this._currentY*this._stepY+this._offsetY;let e,h;if(this._currentX++,this._gridType===i.Random){const i=(this._currentX%n+n)%n,_=(this._currentY%n+n)%n;e=this._graphicOriginX+t+this._stepX*this._randomness*(.5-a._randValues[_*n+i])*2/3,h=this._graphicOriginY+s+this._stepY*this._randomness*(.5-a._randValues[_*n+i+1])*2/3}else e=this._graphicOriginX+this._cosAngle*t+this._sinAngle*s,h=this._graphicOriginY-this._sinAngle*t+this._cosAngle*s;if(!this._testInsidePolygon||this._isInsidePolygon(e,h,this._geometryCursor))return this._internalPlacement.setTranslate(e,h),this._internalPlacement}}_isInsidePolygon(t,s,i){if(null==this._accelerationMap)return o(t,s,i);t+=_,s+=_;const e=this._verticalSubdivision,h=e?s:t,n=Math.floor((h-this._polygonMin)/this._delta),r=this._accelerationMap.get(n);if(!r)return!1;let a,l,f,c=0;for(const _ of r){if(a=_[0],l=_[1],e){if(a[1]>s==l[1]>s)continue;f=(l[0]-a[0])*(s-a[1])-(l[1]-a[1])*(t-a[0])}else{if(a[0]>t==l[0]>t)continue;f=(l[1]-a[1])*(t-a[0])-(l[0]-a[0])*(s-a[1])}f>0?c++:c--}return 0!==c}}function o(t,s,i){let e,h,n,r,a=0;for(t+=_,s+=_,i.reset();i.nextPath();)if(i.nextPoint())for(e=i.x,h=i.y;i.nextPoint();e=n,h=r){if(n=i.x,r=i.y,h>s==r>s)continue;(n-e)*(s-h)-(r-h)*(t-e)>0?a++:a--}return 0!==a}function l(t,s,i,e,h,n){let _=n.get(t);_||(_=[],n.set(t,_)),_.push([[s,i],[e,h]])}export{r as PlacementInsidePolygon};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as e}from\"../CIMCursor.js\";import{CurveHelper as t}from\"../CurveHelper.js\";import{PlacementOnLineRelativeTo as n}from\"../enums.js\";const i=.001;class s{static local(){return null===s.instance&&(s.instance=new s),s.instance}execute(e,t,n,i,s){return new r(e,t,n)}}s.instance=null;class r extends e{constructor(e,n,s){super(e),this._curveHelper=new t,this._angleToLine=void 0===n.angleToLine||n.angleToLine,this._offset=void 0!==n.offset?n.offset*s:0,this._relativeTo=n.relativeTo,this._position=void 0!==n.startPointOffset?n.startPointOffset*s:0,this._epsilon=i*s}processPath(e){const t=this._position;if(this._relativeTo===n.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[t,n]=[e.x,e.y],[i,s]=[0,0];for(;e.nextPoint();){i=e.x,s=e.y;const r=this._curveHelper.getLength(t,n,i,s);if(r<this._epsilon){t=i,n=s;continue}const o=.5+this._position/r,[a,l]=this._curveHelper.getAngleCS(t,n,i,s,o),h=this._curveHelper.getCoord2D(t,n,i,s,o);return this.internalPlacement.setTranslate(h[0]-this._offset*l,h[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(a,l),this.internalPlacement}}return this.iteratePath=!1,null}const i=this._relativeTo===n.LineEnd;return this.onLine(e,t,i)}onLine(e,t,i){let s,r=!1;switch(this._relativeTo){case n.LineMiddle:default:e.seekPathStart(),s=e.pathLength()/2+t;break;case n.LineBeginning:s=t;break;case n.LineEnd:s=t,r=!0}i?e.seekPathEnd():e.seekPathStart();let o=0;if(i?e.prevPoint():e.nextPoint()){let[t,n]=[e.x,e.y],[a,l]=[0,0];for(;i?e.prevPoint():e.nextPoint();){a=e.x,l=e.y;const i=this._curveHelper.getLength(t,n,a,l);if(o+i>s){const e=(s-o)/i,[h,c]=this._curveHelper.getAngleCS(t,n,a,l,e),f=this._curveHelper.getCoord2D(t,n,a,l,e),u=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(f[0]-u*c,f[1]+u*h),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-h,-c):this.internalPlacement.setRotateCS(h,c)),this.internalPlacement}t=a,n=l,o+=i}}return null}}export{s as PlacementOnLine};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{PathTransformationCursor as t}from\"../CIMCursor.js\";import{CurveHelper as e}from\"../CurveHelper.js\";const s=1e-15;class i{static local(){return null===i.instance&&(i.instance=new i),i.instance}execute(t,e,s,i,o){return new n(t,e,s)}}i.instance=null;class n extends t{constructor(t,s,i){super(t),this._curveHelper=new e,this._angleToLine=void 0===s.angleToLine||s.angleToLine,this._offset=void 0!==s.offset?s.offset*i:0,this._endPoints=void 0===s.placeOnEndPoints||s.placeOnEndPoints,this._controlPoints=void 0===s.placeOnControlPoints||s.placeOnControlPoints,this._regularVertices=void 0===s.placeOnRegularVertices||s.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const e=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(e[2]);let s=e[0],i=e[1];if(0!==this._offset){const t=Math.cos(e[2]),n=Math.sin(e[2]);s-=this._offset*n,i+=this._offset*t}return this.internalPlacement.setTranslate(s,i),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0,t.seekPathStart();const e=t.isClosed();let s=0,i=!1,n=0,r=0;if(t.seekPathStart(),t.nextPoint()){let a=t.x,h=t.y,l=t.getControlPoint(),_=!0,c=t.nextPoint();for(;c;){const g=t.x,P=t.y,u=t.getControlPoint();(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(a,h,g,P,0)),_?(_=!1,e?(s=n,i=l):(this._endPoints||this._controlPoints&&l)&&this._tags.push([a,h,n])):l?this._controlPoints&&this._tags.push([a,h,o(r,n)]):this._regularVertices&&this._tags.push([a,h,o(r,n)]),(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(a,h,g,P,1)),c=t.nextPoint(),c||(e?u||i?this._controlPoints&&this._tags.push([g,P,o(r,s)]):this._regularVertices&&this._tags.push([g,P,o(r,s)]):(this._endPoints||this._controlPoints&&u)&&this._tags.push([g,P,r])),a=g,h=P,l=u}}this._tagIterator=0}}function o(t,e){const i=Math.PI;for(;Math.abs(e-t)>i+2*s;)e-t>i?e-=2*i:e+=2*i;return(t+e)/2}export{i as PlacementOnVertices};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getCursorBoundsXY as t}from\"../../../geometry/support/boundsUtils.js\";import{weightedAreaCentroid as e}from\"../../../geometry/support/centroid.js\";import{getLabelPoint as s}from\"../../../geometry/support/labelPoint.js\";import{Placement as n}from\"../CIMPlacements.js\";import{PlacementPolygonCenterMethod as r}from\"../enums.js\";class o{static local(){return null===o.instance&&(o.instance=new o),o.instance}execute(t,e,s,n,r){return new i(t,e,s)}}o.instance=null;class i{constructor(t,e,s){this._geometryCursor=t,this._offsetX=void 0!==e.offsetX?e.offsetX*s:0,this._offsetY=void 0!==e.offsetY?e.offsetY*s:0,this._method=void 0!==e.method?e.method:r.OnPolygon,this._placementPerPart=void 0!==e.placePerPart&&e.placePerPart,this._internalPlacement=new n}next(){const t=this._geometryCursor;if(!t)return null;if(!this._placementPerPart)return this._geometryCursor=null,this._polygonCenter(t);for(;t.nextPath();)if(!(t.getCurrentRingArea()<0))return this._polygonCenter(t.getCurrentPath());return this._geometryCursor=null,null}_polygonCenter(n){let o=!1;switch(this._method){case r.CenterOfMass:{const t=e(n);t&&(this._internalPlacement.setTranslate(t[0]+this._offsetX,t[1]+this._offsetY),o=!0)}break;case r.BoundingBoxCenter:{const e=t(n);e&&(this._internalPlacement.setTranslate((e[2]+e[0])/2+this._offsetX,(e[3]+e[1])/2+this._offsetY),o=!0)}break;case r.OnPolygon:default:{const t=s(n);null!==t&&(this._internalPlacement.setTranslate(t[0]+this._offsetX,t[1]+this._offsetY),o=!0)}}return o?this._internalPlacement:null}}export{o as PlacementPolygonCenter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import{toCIMSymbolJSON as t,isCIMMarker as o,isCIMStroke as r,isCIMFill as n,isCIMMarkerStrokePlacement as s,normalizeAlpha as a}from\"../cim/utils.js\";function i(e){const s=t(e);if(\"CIMTextSymbol\"===s?.type)return s.height??0;let a=0;if(s?.symbolLayers)for(const t of s.symbolLayers)o(t)&&null!=t.size&&t.size>a?a=t.size:r(t)&&null!=t.width&&t.width>a?a=t.width:n(t);return a}function c(e,o,r){if(!e)return;const n=t(e),s=i(e);if(0===s)return void f(n,o);l(n,o/s,!1,r)}function f(e,t){if(e)if(\"CIMTextSymbol\"!==e.type){if(e.symbolLayers)for(const o of e.symbolLayers)switch(o.type){case\"CIMPictureMarker\":case\"CIMVectorMarker\":o.size=t;break;case\"CIMPictureStroke\":case\"CIMSolidStroke\":o.width=t}}else e.height=t}function l(e,t,o,r){if(e)if(\"CIMTextSymbol\"!==e.type){if(o&&e.effects)for(const o of e.effects)y(o,t);if(e.symbolLayers)for(const o of e.symbolLayers)switch(o.type){case\"CIMPictureMarker\":case\"CIMVectorMarker\":m(o,t,r);break;case\"CIMPictureStroke\":case\"CIMSolidStroke\":!r?.preserveOutlineWidth&&o.width&&(o.width*=t);break;case\"CIMPictureFill\":o.height&&(o.height*=t),o.offsetX&&(o.offsetX*=t),o.offsetY&&(o.offsetY*=t);break;case\"CIMHatchFill\":l(o.lineSymbol,t,!0,{...r,preserveOutlineWidth:!1}),o.offsetX&&(o.offsetX*=t),o.offsetY&&(o.offsetY*=t),o.separation&&(o.separation*=t)}}else null!=e.height&&(e.height*=t)}function m(e,t,o){if(e&&(e.markerPlacement&&M(e.markerPlacement,t),e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.anchorPoint&&\"Absolute\"===e.anchorPointUnits&&(e.anchorPoint={x:e.anchorPoint.x*t,y:e.anchorPoint.y*t}),e.size=null!=e.size?e.size*t:0,\"CIMVectorMarker\"===e.type&&e.markerGraphics))for(const r of e.markerGraphics)e.scaleSymbolsProportionally||l(r.symbol,t,!0,o)}function M(e,t){switch(s(e)&&e.offset&&(e.offset*=t),e.type){case\"CIMMarkerPlacementAlongLineRandomSize\":case\"CIMMarkerPlacementAlongLineSameSize\":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case\"CIMMarkerPlacementAlongLineVariableSize\":if(e.maxRandomOffset&&(e.maxRandomOffset*=t),e.placementTemplate&&e.placementTemplate.length){const o=e.placementTemplate.map((e=>e*t));e.placementTemplate=o}break;case\"CIMMarkerPlacementOnLine\":e.startPointOffset&&(e.startPointOffset*=t);break;case\"CIMMarkerPlacementAtExtremities\":e.offsetAlongLine&&(e.offsetAlongLine*=t);break;case\"CIMMarkerPlacementAtMeasuredUnits\":case\"CIMMarkerPlacementOnVertices\":break;case\"CIMMarkerPlacementAtRatioPositions\":e.beginPosition&&(e.beginPosition*=t),e.endPosition&&(e.endPosition*=t);break;case\"CIMMarkerPlacementPolygonCenter\":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case\"CIMMarkerPlacementInsidePolygon\":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t),e.stepX&&(e.stepX*=t),e.stepY&&(e.stepY*=t)}}function y(e,t){switch(e.type){case\"CIMGeometricEffectArrow\":case\"CIMGeometricEffectDonut\":e.width&&(e.width*=t);break;case\"CIMGeometricEffectBuffer\":e.size&&(e.size*=t);break;case\"CIMGeometricEffectCut\":e.beginCut&&(e.beginCut*=t),e.endCut&&(e.endCut*=t),e.middleCut&&(e.middleCut*=t);break;case\"CIMGeometricEffectDashes\":if(e.customEndingOffset&&(e.customEndingOffset*=t),e.offsetAlongLine&&(e.offsetAlongLine*=t),e.dashTemplate&&e.dashTemplate.length){const o=e.dashTemplate.map((e=>e*t));e.dashTemplate=o}break;case\"CIMGeometricEffectExtension\":case\"CIMGeometricEffectJog\":case\"CIMGeometricEffectRadial\":e.length&&(e.length*=t);break;case\"CIMGeometricEffectMove\":e.offsetX&&(e.offsetX*=t),e.offsetY&&(e.offsetY*=t);break;case\"CIMGeometricEffectOffset\":case\"CIMGeometricEffectOffsetTangent\":e.offset&&(e.offset*=t);break;case\"CIMGeometricEffectRegularPolygon\":e.radius&&(e.radius*=t);break;case\"CIMGeometricEffectTaperedPolygon\":e.fromWidth&&(e.fromWidth*=t),e.length&&(e.length*=t),e.toWidth&&(e.toWidth*=t);break;case\"CIMGeometricEffectWave\":e.amplitude&&(e.amplitude*=t),e.period&&(e.period*=t)}}function C(o){const r=[];return u(t(o),r),r.length?new e(a(r[0])):null}function u(e,t){if(!e)return;let n;n=\"CIMTextSymbol\"===e.type?e.symbol:e;const a=\"CIMPolygonSymbol\"===e.type;if(n?.symbolLayers)for(const i of n.symbolLayers)if(!(i.colorLocked||a&&(r(i)||o(i)&&i.markerPlacement&&s(i.markerPlacement))))switch(i.type){case\"CIMPictureMarker\":case\"CIMPictureStroke\":case\"CIMPictureFill\":i.tintColor&&b(t,i.tintColor);break;case\"CIMVectorMarker\":i.markerGraphics?.forEach((e=>{u(e.symbol,t)}));break;case\"CIMSolidStroke\":case\"CIMSolidFill\":b(t,i.color);break;case\"CIMHatchFill\":u(i.lineSymbol,t)}}function b(e,t){for(const o of e)if(o.join(\".\")===t.join(\".\"))return;e.push(t)}function I(o,r,n){r instanceof e||(r=new e(r));const s=t(o);s&&k(s,r,n)}function k(e,t,a){if(!e)return;let i;i=\"CIMTextSymbol\"===e.type?e.symbol:e;const c=\"CIMPolygonSymbol\"===i?.type;if(i?.symbolLayers)for(const f of i.symbolLayers){if(f.colorLocked)continue;if(c)if(a){const{layersToColor:e}=a;if((r(f)||o(f)&&f.markerPlacement&&s(f.markerPlacement))&&\"fill\"===e||n(f)&&\"outline\"===e)continue}else if(r(f)||o(f)&&f.markerPlacement&&s(f.markerPlacement))continue;const e=t.toArray();switch(f.type){case\"CIMPictureMarker\":case\"CIMPictureStroke\":case\"CIMPictureFill\":f.tintColor=e;break;case\"CIMVectorMarker\":f.markerGraphics?.forEach((e=>{k(e.symbol,t,a)}));break;case\"CIMSolidStroke\":case\"CIMSolidFill\":f.color=e;break;case\"CIMHatchFill\":k(f.lineSymbol,t,a)}}}function p(e,o=!1){const r=t(e);if(\"CIMTextSymbol\"===r?.type||\"CIMPointSymbol\"===r?.type){const e=r.angle;return null!=e&&o?360-e:e??0}return 0}function h(e,r,n=!1){const s=t(e);if(n&&(r=360-r),\"CIMTextSymbol\"!==s?.type){if(\"CIMPointSymbol\"===s?.type&&s.symbolLayers){const e=r-(s.angle||0);for(const t of s.symbolLayers)if(o(t)){let o=t.rotation||0;t.rotateClockwise?o-=e:o+=e,t.rotation=o}s.angle=r}}else s.angle=r}function P(e){const o=t(e);if(!o)return null;switch(o.type){case\"CIMPointSymbol\":return\"CIMPointSymbol\";case\"CIMLineSymbol\":return\"CIMLineSymbol\";case\"CIMPolygonSymbol\":return\"CIMPolygonSymbol\";case\"CIMTextSymbol\":return\"CIMTextSymbol\";case\"CIMMeshSymbol\":return\"CIMMeshSymbol\";default:return null}}export{I as applyCIMSymbolColor,h as applyCIMSymbolRotation,C as getCIMSymbolColor,p as getCIMSymbolRotation,i as getCIMSymbolSize,P as getCIMSymbolType,m as scaleCIMMarker,l as scaleCIMSymbol,c as scaleCIMSymbolTo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getAssetUrl as t}from\"../../assets.js\";import e from\"../../Color.js\";import o from\"../../request.js\";import{LRUCache as s}from\"../../core/LRUCache.js\";import{pt2px as r}from\"../../core/screenUtils.js\";import{getCIMSymbolColor as n}from\"./cimSymbolUtils.js\";const i=\"picture-fill\",a=\"simple-fill\",l=\"simple-line\",c=\"simple-marker\",h=\"text\",d=\"cim\",m=new Map([[\"dash\",[4,3]],[\"dashdot\",[4,3,1,3]],[\"dot\",[1,3]],[\"longdash\",[8,3]],[\"longdashdot\",[8,3,1,3]],[\"longdashdotdot\",[8,3,1,3,1,3]],[\"shortdash\",[4,1]],[\"shortdashdot\",[4,1,1,1]],[\"shortdashdotdot\",[4,1,1,1,1,1]],[\"shortdot\",[1,1]],[\"solid\",[]]]),p=new s(1e3);function u(e){const o=e.style;let s=null;if(e)switch(e.type){case c:\"cross\"!==o&&\"x\"!==o&&(s=e.color);break;case a:o&&\"solid\"!==o?\"none\"!==o&&(s={type:\"pattern\",x:0,y:0,src:t(`esri/symbols/patterns/${o}.png`),width:5,height:5}):s=e.color;break;case i:s={type:\"pattern\",src:e.url,width:r(e.width)*e.xscale,height:r(e.height)*e.yscale,x:r(e.xoffset),y:r(e.yoffset)};break;case h:s=e.color;break;case d:s=n(e)}return s}function f(t,e){const s=t+\"-\"+e;return void 0!==p.get(s)?Promise.resolve(p.get(s)):o(t,{responseType:\"image\"}).then((t=>{const o=t.data,r=o.naturalWidth,n=o.naturalHeight,i=document.createElement(\"canvas\");i.width=r,i.height=n;const a=i.getContext(\"2d\");a.fillStyle=e,a.fillRect(0,0,r,n),a.globalCompositeOperation=\"destination-in\",a.drawImage(o,0,0);const l=i.toDataURL();return p.put(s,l),l}))}function y(t){if(!t)return null;let e=null;switch(t.type){case a:case i:case c:e=y(t.outline);break;case l:{const o=r(t.width);null!=t.style&&\"none\"!==t.style&&0!==o&&(e={color:t.color,style:w(t.style),width:o,cap:t.cap,join:\"miter\"===t.join?r(t.miterLimit):t.join},e.dashArray=g(e).join(\",\")||\"none\");break}default:e=null}return e}function g(t){if(!t?.style)return[];const{dashArray:e,style:o,width:s}=t;if(\"string\"==typeof e&&\"none\"!==e)return e.split(\",\").map((t=>Number(t)));const r=s??0,n=m.has(o)?m.get(o).map((t=>t*r)):[];if(\"butt\"!==t.cap)for(const[i,a]of n.entries())n[i]=i%2==1?a+r:Math.max(a-r,1);return n}const w=(()=>{const t={};return e=>{if(t[e])return t[e];const o=e.replaceAll(\"-\",\"\");return t[e]=o,o}})(),b=new e([128,128,128]);export{b as defaultThematicColor,w as dekebabifyLineStyle,g as getDashArray,u as getFill,f as getPatternUrlWithColor,y as getStroke};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../Color.js\";import{isSymbol3D as t,isSymbol2D as o}from\"../../symbols.js\";import{forEach as r}from\"../../core/asyncUtils.js\";import\"../../core/has.js\";import{px2pt as n}from\"../../core/screenUtils.js\";import{ONES as l}from\"../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{effectFunctionsFromJSON as i}from\"../../layers/effects/jsonUtils.js\";import{getCIMSymbolColor as c}from\"./cimSymbolUtils.js\";import{getStroke as s}from\"./gfxUtils.js\";import{Symbol3DMaterial as u}from\"./Symbol3DMaterial.js\";const a=new e(\"white\");function f(e){const t=e.symbolLayers?.at(-1);if(t&&\"outline\"in t)return t?.outline?.size}function m(e){if(!e)return 0;if(t(e)){const t=f(e);return null!=t?t:0}return n(s(e)?.width)}function y(e){if(null==e||!(\"symbolLayers\"in e)||null==e.symbolLayers)return!1;switch(e.type){case\"point-3d\":return e.symbolLayers.some((e=>\"object\"===e.type));case\"line-3d\":return e.symbolLayers.some((e=>\"path\"===e.type));case\"polygon-3d\":return e.symbolLayers.some((e=>\"object\"===e.type||\"extrude\"===e.type));default:return!1}}function p(e){return e.resource?.href??\"\"}function h(r,n){if(!r)return null;let l=null;return t(r)?l=b(r):o(r)&&(l=\"cim\"===r.type?c(r):r.color?new e(r.color):null),l?w(l,n):null}function b(t){const o=t.symbolLayers;if(!o)return null;let r=null;return o.forEach((e=>{\"object\"===e.type&&e.resource?.href||(r=\"water\"===e.type?e.color:e.material?e.material.color:null)})),r?new e(r):null}function w(t,o){if(null==o||null==t)return t;const r=t.toRgba();return r[3]=r[3]*o,new e(r)}function d(e,t,o){const r=e.symbolLayers;if(!r)return;const n=e=>w(t=t??e??(null!=o?a:null),o);r.forEach((e=>{if(\"object\"!==e.type||!e.resource?.href||t)if(\"water\"===e.type)e.color=n(e.color);else{const t=null!=e.material?e.material.color:null,r=n(t);null==e.material?e.material=new u({color:r}):e.material.color=r,null!=o&&\"outline\"in e&&null!=e.outline?.color&&(e.outline.color=w(e.outline.color,o))}}))}function j(e,t,o){(t=t??e.color)&&(e.color=w(t,o)),null!=o&&\"outline\"in e&&e.outline?.color&&(e.outline.color=w(e.outline.color,o))}function g(r,n,l){r&&(n||null!=l)&&(n&&(n=new e(n)),t(r)?d(r,n,l):o(r)&&j(r,n,l))}async function k(e,t){const o=e.symbolLayers;o&&await r(o,(async e=>L(e,t)))}async function L(e,t){switch(e.type){case\"extrude\":x(e,t);break;case\"icon\":case\"line\":case\"text\":z(e,t);break;case\"path\":v(e,t);break;case\"object\":await U(e,t)}}function z(e,t){const o=S(t);null!=o&&(e.size=o)}function S(e){for(const t of e)if(\"number\"==typeof t)return t;return null}function x(e,t){e.size=\"number\"==typeof t[2]?t[2]:0}async function U(e,t){const{resourceSize:o,symbolSize:r}=await C(e),n=E(t,o,r);e.width=M(t[0],r[0],o[0],n),e.depth=M(t[1],r[1],o[1],n),e.height=M(t[2],r[2],o[2],n)}function v(e,t){const o=E(t,l,[e.width,void 0,e.height]);e.width=M(t[0],e.width,1,o),e.height=M(t[2],e.height,1,o)}function E(e,t,o){for(let r=0;r<3;r++){const n=e[r];switch(n){case\"symbol-value\":{const e=o[r];return null!=e?e/t[r]:1}case\"proportional\":break;default:if(n&&t[r])return n/t[r]}}return 1}async function C(e){const{computeObjectLayerResourceSize:t}=await import(/* webpackChunkName: \"symbolLayerUtils\" */ \"./symbolLayerUtils.js\"),o=await t(e,10),{width:r,height:n,depth:l}=e,i=[r,l,n];let c=1;for(let s=0;s<3;s++){const e=i[s];if(null!=e){c=e/o[s];break}}for(let s=0;s<3;s++)null==i[s]&&(i[s]=o[s]*c);return{resourceSize:o,symbolSize:i}}function M(e,t,o,r){switch(e){case\"proportional\":return o*r;case\"symbol-value\":return null!=t?t:o;default:return e}}function O(e,t){const o=S(t);if(null!=o)switch(e.type){case\"simple-marker\":e.size=o;break;case\"picture-marker\":{const t=e.width/e.height;t>1?(e.width=o,e.height=o*t):(e.width=o*t,e.height=o);break}case\"simple-line\":e.width=o;break;case\"text\":e.font.size=o}}async function R(e,r){if(e&&r)return t(e)?k(e,r):void(o(e)&&O(e,r))}function D(e,r,n){if(e&&null!=r)if(t(e)){const t=e.symbolLayers;t&&t.forEach((e=>{if(\"object\"===e.type)switch(n){case\"tilt\":e.tilt=(e.tilt??0)+r;break;case\"roll\":e.roll=(e.roll??0)+r;break;default:e.heading=(e.heading??0)+r}\"icon\"===e.type&&(e.angle+=r)}))}else o(e)&&(\"simple-marker\"!==e.type&&\"picture-marker\"!==e.type&&\"text\"!==e.type||(e.angle+=r))}function I(e){if(!e)return null;const t=e.effects.filter((e=>\"bloom\"!==e.type)).map((e=>e.toJSON()));return i(t)}function J(e){return null!=e&&\"polygon-3d\"===e.type&&e.symbolLayers.some((e=>\"extrude\"===e.type))}async function N(e,t){const o=await e.fetchSymbol(t);return o||e.fetchCIMSymbol(t)}export{g as applyColorToSymbol,w as applyOpacityToColor,D as applyRotationToSymbol,R as applySizesToSymbol,N as fetchWebStyleSymbol,I as getCSSFilterFromEffectList,h as getColorFromSymbol,p as getIconHref,m as getSymbolOutlineSize,y as isVolumetricSymbol,J as symbolHasExtrudeSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isSymbol3D as t}from\"../../symbols.js\";import{isDevEnvironment as e,adjustStaticAGOUrl as r}from\"../../core/devEnvironmentUtils.js\";import l from\"../../core/Error.js\";import{urlToObject as o,removeFile as n}from\"../../core/urlUtils.js\";import s from\"../../portal/Portal.js\";import{f as i}from\"../../chunks/persistableUrlUtils.js\";import{fromJSON as m}from\"./jsonUtils.js\";import a from\"./StyleOrigin.js\";import{fetchStyle as u,requestJSON as p,makeCIMSymbolRef as f,Style2DUrlTemplate as y,symbolUrlFromStyleItem as c}from\"./styleUtils.js\";import{Thumbnail as b}from\"./Thumbnail.js\";function g(t,e,r,o){const n=t.name;return null==n?Promise.reject(new l(\"symbolstyleutils:style-symbol-reference-name-missing\",\"Missing name in style symbol reference\")):\"Esri2DPointSymbolsStyle\"===t.styleName?d(n,e,o):u(t,e,o).then((t=>h(t,n,e,r,c,o)))}function j(t,e){return e.items.find((e=>e.name===t))}function h(u,y,c,g,h,d){const U=null!=c?.portal?c.portal:s.getDefault(),N={portal:U,url:o(u.baseUrl),origin:\"portal-item\"},w=j(y,u.data);if(!w){const t=`The symbol name '${y}' could not be found`;return Promise.reject(new l(\"symbolstyleutils:symbol-name-not-found\",t,{symbolName:y}))}let S=i(h(w,g),N),D=w.thumbnail?.href??null;const O=w.thumbnail?.imageData;e()&&(S=r(S)??\"\",D=r(D));const P={portal:U,url:o(n(S)),origin:\"portal-item\"};return p(S,d).then((e=>{const r=\"cimRef\"===g?f(e.data):e.data,l=m(r,P);if(l&&t(l)){if(D){const t=i(D,N);l.thumbnail=new b({url:t})}else O&&(l.thumbnail=new b({url:`data:image/png;base64,${O}`}));u.styleUrl?l.styleOrigin=new a({portal:c.portal,styleUrl:u.styleUrl,name:y}):u.styleName&&(l.styleOrigin=new a({portal:c.portal,styleName:u.styleName,name:y}))}return l}))}function d(t,e,r){const l=y.replaceAll(/\\{SymbolName\\}/gi,t),i=null!=e.portal?e.portal:s.getDefault();return p(l,r).then((t=>{const e=f(t.data);return m(e,{portal:i,url:o(n(l)),origin:\"portal-item\"})}))}export{h as fetchSymbolFromStyle,j as getStyleItemFromStyle,g as resolveWebStyleSymbol};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction t(t){return document.createElementNS(\"http://www.w3.org/2000/svg\",t)}function e(){const e=t(\"svg\");return e.setAttribute(\"style\",\"position: absolute;\"),e.setAttribute(\"width\",\"0\"),e.setAttribute(\"height\",\"0\"),e.setAttribute(\"aria-hidden\",\"true\"),e.setAttribute(\"role\",\"presentation\"),document.body.appendChild(e),e}function n(t){return null!=t&&document.body.removeChild(t),null}export{e as createHiddenSvg,t as createSvgElement,n as destroyHiddenSvg};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{distanceToSegmentSquared as t}from\"../../../../geometry/support/coordsUtils.js\";import{Point as n}from\"../../../../geometry/support/TileClipper.js\";const r=Number.POSITIVE_INFINITY,o=Math.PI,e=2*o,i=128/o,u=256/360,s=o/180,c=1/Math.LN2;function a(t,n){return(t%=n)>=0?t:t+n}function f(t){return a(t*i,256)}function l(t){return a(t*u,256)}function h(t){return Math.log(t)*c}function m(t){return t*t}function p(t,n,r){return t*(1-r)+n*r}function g(t,n,r){return t>=n&&t<=r||t>=r&&t<=n}const x=8,y=14,M=16;function d(t){return x+Math.max((t-y)*M,0)}function I(t,n,r){let o,e,i,u=0;for(const s of r){o=s.length;for(let r=1;r<o;++r){if(e=s[r-1],i=s[r],e.y>n==i.y>n)continue;(i.x-e.x)*(n-e.y)-(i.y-e.y)*(t-e.x)>0?u++:u--}}return 0!==u}function N(n,r,o,e){let i,u,s,c;const a=e*e;for(const f of o){const o=f.length;if(!(o<2)){i=f[0].x,u=f[0].y;for(let e=1;e<o;++e){if(s=f[e].x,c=f[e].y,t(n,r,i,u,s,c)<a)return!0;i=s,u=c}}}return!1}function w(t,n,r,o,e,i,u){const s=Math.max(o,Math.min(n,i))-n,c=Math.max(e,Math.min(r,u))-r;return s*s+c*c<=t*t}function P(t,r){if(0===r||Number.isNaN(r))return t;const o=[],e=new n(0,0),i=new n(0,0),u=new n(0,0);for(let s=0;s<t.length;s++){const c=t[s],a=[];for(let t=0;t<c.length;t++){const o=c[t-1],s=c[t],f=c[t+1];0===t?e.setCoords(0,0):e.assignSub(s,o).normalize().rightPerpendicular(),t===c.length-1?i.setCoords(0,0):i.assignSub(f,s).normalize().rightPerpendicular(),u.assignAdd(e,i).normalize();const l=u.x*i.x+u.y*i.y;0!==l&&u.scale(1/l),a.push(n.add(s,u.scale(r)))}o.push(a)}return o}function b(t,r,o,e){const i=new n(t[0],t[1]);if(i.scale(e),\"viewport\"===r){const t=-o*(Math.PI/180),n=Math.cos(t),r=Math.sin(t);i.rotate(n,r)}return i}export{g as between,e as c2pi,u as cDegTo256,s as cDegToRad,r as cInfinity,o as cPi,i as cRadTo256,l as degToByte,N as distanceFromToPolylineWithinThreshold,d as getTileMargins,p as interpolate,w as isCircleOverlapingRect,h as log2,P as offsetLine,I as pointInPolygon,a as positiveMod,f as radToByte,m as sqr,b as translateAnchor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(t=0,h=0,i=0,s=0){this.x=t,this.y=h,this.width=i,this.height=s}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}export{t as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Logger.js\";const t=()=>e.getLogger(\"esri.views.2d.engine.webgl.alignmentUtils\");var r,n;function a(e){if(!e)return r.Center;switch(e){case\"Left\":case\"left\":return r.Left;case\"Right\":case\"right\":return r.Right;case\"Justify\":return t().warnOnce(\"Horizontal alignment 'justify' is not implemented. Falling back to 'center'.\"),r.Center;case\"Center\":case\"center\":return r.Center}}function c(e){if(!e)return n.Center;switch(e){case\"Top\":case\"top\":return n.Top;case\"Center\":case\"middle\":return n.Center;case\"Baseline\":case\"baseline\":return n.Baseline;case\"Bottom\":case\"bottom\":return n.Bottom}}function o(e){switch(e){case\"above-left\":case\"esriServerPointLabelPlacementAboveLeft\":return[\"right\",\"bottom\"];case\"above-center\":case\"above-along\":case\"esriServerPointLabelPlacementAboveCenter\":case\"esriServerLinePlacementAboveAlong\":return[\"center\",\"bottom\"];case\"above-right\":case\"esriServerPointLabelPlacementAboveRight\":return[\"left\",\"bottom\"];case\"center-left\":case\"esriServerPointLabelPlacementCenterLeft\":return[\"right\",\"middle\"];case\"center-center\":case\"center-along\":case\"esriServerPointLabelPlacementCenterCenter\":case\"esriServerLinePlacementCenterAlong\":case\"always-horizontal\":case\"esriServerPolygonPlacementAlwaysHorizontal\":return[\"center\",\"middle\"];case\"center-right\":case\"esriServerPointLabelPlacementCenterRight\":return[\"left\",\"middle\"];case\"below-left\":case\"esriServerPointLabelPlacementBelowLeft\":return[\"right\",\"top\"];case\"below-center\":case\"below-along\":case\"esriServerPointLabelPlacementBelowCenter\":case\"esriServerLinePlacementBelowAlong\":return[\"center\",\"top\"];case\"below-right\":case\"esriServerPointLabelPlacementBelowRight\":return[\"left\",\"top\"];default:return console.debug(`Found invalid placement type ${e}`),[\"center\",\"middle\"]}}function s(e){switch(e){case r.Right:case\"right\":return-1;case r.Center:case\"center\":return 0;case r.Left:case\"left\":return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function i(e){switch(e){case n.Top:case\"top\":return 1;case n.Center:case\"middle\":return 0;case n.Bottom:case n.Baseline:case\"baseline\":case\"bottom\":return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function l(e){switch(e){case\"left\":return r.Left;case\"right\":return r.Right;case\"center\":return r.Center}}function u(e){switch(e){case\"above-along\":case\"below-along\":case\"center-along\":case\"esriServerLinePlacementAboveAlong\":case\"esriServerLinePlacementBelowAlong\":case\"esriServerLinePlacementCenterAlong\":return!0;default:return!1}}!function(e){e[e.Left=-1]=\"Left\",e[e.Center=0]=\"Center\",e[e.Right=1]=\"Right\"}(r||(r={})),function(e){e[e.Top=1]=\"Top\",e[e.Center=0]=\"Center\",e[e.Bottom=-1]=\"Bottom\",e[e.Baseline=2]=\"Baseline\"}(n||(n={}));export{r as HAlign,n as VAlign,o as getAlignmentFromPlacement,l as getJustification,a as getXAnchorDirection,s as getXDirection,c as getYAnchorDirection,i as getYDirection,u as isMapAligned};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as t,create as h}from\"../../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";class i{constructor(i,e,s,r){this.transformedX=0,this.transformedY=0,this.center=t(i,e),this.centerT=h(),this.halfWidth=s/2,this.halfHeight=r/2,this.width=s,this.height=r}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t}set y(t){this.center[1]=t}clone(){return new i(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t,h=4){const i=Math.abs(t.centerT[0]-this.centerT[0]),e=Math.abs(t.centerT[1]-this.centerT[1]),s=(t.halfWidth+this.halfWidth+h)/i,r=(t.halfHeight+this.halfHeight+h)/e,n=Math.min(s,r);return Math.log2(n)}extend(t){const h=Math.min(this.xmin,t.xmin),i=Math.min(this.ymin,t.ymin),e=Math.max(this.xmax,t.xmax)-h,s=Math.max(this.ymax,t.ymax)-i,r=h+e/2,n=i+s/2;this.width=e,this.height=s,this.halfWidth=e/2,this.halfHeight=s/2,this.x=r,this.y=n}static deserialize(t){const h=t.readF32(),e=t.readF32(),s=t.readInt32(),r=t.readInt32();return new i(h,e,s,r)}}export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst i=8,t=i-2,D=1e-30,n=64,e=4294967295,a=512,o=256,c=256/360,l=128,r=16777216,g=!1,m=128,s=8,F=10,G=29,P=1,V=16,h=16,d=a/m,f=8,p=50,v=10,A=24,L=4,O={metrics:{width:15,height:17,left:0,top:-7,advance:14}},T=1024,U=0,u=0,w=0,x=1,b=2,j=3,k=4,q=5,y=6,z=12,B=13,C=5,E=6,H=5,I=6;var J;!function(i){i[i.FilterFlags=0]=\"FilterFlags\",i[i.Animation=1]=\"Animation\",i[i.GPGPU=2]=\"GPGPU\",i[i.VV=3]=\"VV\",i[i.DD0=4]=\"DD0\",i[i.DD1=5]=\"DD1\",i[i.DD2=6]=\"DD2\",i[i.LocalTimeOrigin=7]=\"LocalTimeOrigin\"}(J||(J={}));const K=6,M=1<<K,N=M<<1,Q=!1,R=1.05,S=3,W=1,X=3,Y=3,Z=5,$=6,_=1.15,ii=2,ti=2,Di=128,ni=256,ei=ni-2*ti,ai=2,oi=128,ci=8,li=500,ri=4,gi=128,mi=10,si=1024,Fi=2,Gi=0,Pi=1,Vi=4,hi=8,di=16,fi=4,pi=1,vi=4,Ai=8,Li=32,Oi=64,Ti=128,Ui=4,ui=1,wi=1<<20,xi=.75,bi=10,ji=.75,ki=12,qi=256,yi=32,zi=512,Bi=0,Ci=1;export{J as AttributeDataType,ui as MAX_TILE_RESHUFFLES_PER_FRAME,bi as RESHUFFLING_EXEMPT_DRAW_CALLS,wi as RESHUFFLING_EXEMPT_MEMORY_BYTES,ji as RESHUFFLING_TARGET_DRAW_EFFICIENCY,xi as RESHUFFLING_TARGET_MEMORY_EFFICIENCY,c as angleFactor256,b as animationUnit,qi as attributeStoreInitialSize,T as attributeStoreTextureSize,O as averageGlyphMosaicItem,Ci as backbufferStencilClipped,Bi as backbufferStencilVisible,Li as bitsetFillHasPatternHeightPrecisionFactor,Oi as bitsetFillHasPatternWidthPrecisionFactor,Ai as bitsetFillHasUnresolvedReplacementColor,vi as bitsetFillRandomPatternOffset,di as bitsetGenericConsiderAlphaOnly,Fi as bitsetGenericLockColor,fi as bitsetLineScaleDash,Pi as bitsetMarkerAlignmentMap,Gi as bitsetMarkerAlignmentScreen,Vi as bitsetMarkerOutlineAllowColorOverride,hi as bitsetMarkerScaleSymbolsProportionally,pi as bitsetTypeFillOutline,gi as bufferDataMinimumSize,ri as bufferDataPoolSize,F as chartMaxFields,h as collisionBoxPadding,m as collisionBucketSize,V as collisionEarlyRejectBucketSize,P as collisionMaxZoomDelta,f as collisionPlacementPadding,d as collisionTileBoxSize,l as compressionFactorForU16,k as dataDrivenUnit0,q as dataDrivenUnit1,y as dataDrivenUnit2,g as debugLabels,Di as defaultSdfTextureSize,ci as displayRecordIntPerElement,s as dotDensityMaxFields,N as effectFlag0,Q as enableEarlyLabelDiscard,n as extrudeScale,M as filterFlag0,x as filterFlagsUnit,A as glyphSize,z as gpgpuUnit,v as heuristicGlyphsPerFeature,p as heuristicGlyphsPerLine,Y as hittestSmallSymbolThreshold,W as hittestToleranceDesktop,S as hittestToleranceMobile,X as hittestToleranceSmallSymbol,L as labelPlacementOffsetPadding,B as localTimeOriginUnit,G as magicLabelLineHeight,ki as maxGeohashLevel,ii as maxGpuUploadsPerFrame,K as maxHighlightReasons,r as maxRepresentableInt,zi as maxTextLineWidth,mi as minMaxZoomPrecisionFactor,yi as minTextLineWidth,D as nanMagicNumber,li as patchPixelBufferAllocSize,ai as patternFillRasterizationScale,e as pictureFillColor,si as randomInsidePolygonTextureSize,o as rasterTileSize,oi as rasterizedVectorMarkerMinSize,ti as spritePadding,ei as svgSdfTextureInnerSize,ni as svgSdfTextureSize,w as textureBindingBitmap,u as textureBindingGlyphAtlas,C as textureBindingHighlight0,E as textureBindingHighlight1,H as textureBindingRenderer0,I as textureBindingRenderer1,U as textureBindingSpriteAtlas,Ui as textureUploadManagerBudget,Ti as textureUploadManagerChunkSize,R as thinLineHalfWidthThreshold,a as tileSize,j as visualVariableUnit,_ as vtlHighResCutoff,$ as vtlTextureBindingUnitGlyphs,Z as vtlTextureBindingUnitSprites,t as webglMaxInnerStops,i as webglMaxStops};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromRotation as t,multiply as s,translate as i,rotate as e}from\"../../../../../../core/libs/gl-matrix-2/math/mat2d.js\";import{create as o,transformMany as h}from\"../../../../../../core/libs/gl-matrix-2/factories/mat2df32.js\";import{transformMat2d as n,set as r}from\"../../../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as a}from\"../../../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{getXAnchorDirection as f,getYAnchorDirection as c,VAlign as d}from\"../../alignmentUtils.js\";import m from\"../../Rect.js\";import g from\"../../collisions/BoundingBox.js\";const _=22,l=4,u=_+l,x=_-6,p=3,b=Math.PI/180,y=8,w=1.5;class L{constructor(t,s,i,e){this._rotationT=o(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const h=i.rect,n=new Float32Array(8);t*=e,s*=e;const r=i.code?h.width*e:i.metrics.width,a=i.code?h.height*e:i.metrics.height;this.width=r,this.height=a,n[0]=t,n[1]=s,n[2]=t+r,n[3]=s,n[4]=t,n[5]=s+a,n[6]=t+r,n[7]=s+a,this._data=n,this._setTextureCoords(h),this._scale=e,this._mosaic=i,this.x=t,this.y=s,this.maxOffset=Math.max(t+r,s+a)}get mosaic(){return this._mosaic}set angle(s){this._angle=s,t(this._rotationT,-s),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:i}=this._mosaic.metrics,e=i*this._scale,n=Math.abs(t)*this._scale,r=new Float32Array(8);r[0]=this.x,r[1]=this.y,r[2]=this.x+e,r[3]=this.y,r[4]=this.x,r[5]=this.y+n,r[6]=this.x+e,r[7]=this.y+n;const a=s(o(),this._rotationT,this._transform);h(r,r,a);let f=1/0,c=1/0,d=-1/0,m=-1/0;for(let s=0;s<4;s++){const t=r[2*s],i=r[2*s+1];f=Math.min(f,t),c=Math.min(c,i),d=Math.max(d,t),m=Math.max(m,i)}const _=d-f,l=m-c,u=f+_/2,x=c+l/2;this._bounds=new g(u,x,_,l)}return this._bounds}setTransform(t){this._transform=t,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const t=s(o(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],n(this._offsets.topLeft,this._offsets.topLeft,t),n(this._offsets.topRight,this._offsets.topRight,t),n(this._offsets.bottomLeft,this._offsets.bottomLeft,t),n(this._offsets.bottomRight,this._offsets.bottomRight,t)}_setTextureCoords({x:t,y:s,width:i,height:e}){this._texcoords={topLeft:[t,s],topRight:[t+i,s],bottomLeft:[t,s+e],bottomRight:[t+i,s+e]}}}const M=(t,s)=>({code:0,page:0,sdf:!0,rect:new m(0,0,11,8),textureBinding:s,metrics:{advance:0,height:4,width:t,left:0,top:0}});function R(t,s){return t.forEach((t=>n(t,t,s))),{topLeft:t[0],topRight:t[1],bottomLeft:t[2],bottomRight:t[3]}}class B{constructor(t,s,i){this._rotation=0,this._decorate(t,s,i),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=s.length>1,this._hasRotation=0!==i.angle,this._transform=this._createGlyphTransform(this.bounds,i),this._borderLineSizePx=i.borderLineSizePx,(i.borderLineSizePx||i.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const e of t)e.setTransform(this._transform)}setRotation(i){if(0===i&&0===this._rotation)return;this._rotation=i;const e=this._transform,h=t(o(),i);s(e,h,e);for(const t of this.glyphs)t.setTransform(this._transform)}_decorate(t,s,i){if(!i.decoration||\"none\"===i.decoration||!t.length)return;const e=i.scale,o=\"underline\"===i.decoration?u:x,h=t[0].textureBinding;for(const n of s){const s=n.startX*e,i=n.startY*e,r=(n.width+n.glyphWidthEnd)*e;t.push(new L(s,i+o*e,M(r,h),1))}}shapeBackground(t){const s=this._borderLineSizePx||0,i=(w+s)/2,e=this._borderLineSizePx?i:0,{xmin:o,ymin:h,xmax:n,ymax:r,x:a,y:f,width:c,height:d}=this.bounds,m=[o-y,h-y],_=[n+y,h-y],l=[o-y,r+y],u=[n+y,r+y],x=R([[m[0]-i,m[1]-i],[_[0]+i,_[1]-i],[m[0]+e,m[1]+e],[_[0]-e,_[1]+e]],t),p=R([[l[0]+e,l[1]-e],[u[0]-e,u[1]-e],[l[0]-i,l[1]+i],[u[0]+i,u[1]+i]],t),b=R([[m[0]-i,m[1]-i],[m[0]+e,m[1]+e],[l[0]-i,l[1]+i],[l[0]+e,l[1]-e]],t),L=R([[_[0]-e,_[1]+e],[_[0]+i,_[1]-i],[u[0]-e,u[1]-e],[u[0]+i,u[1]+i]],t),M={main:R([m,_,l,u],t),top:x,bot:p,left:b,right:L};return[new g(a,f,c+2*i,d+2*i),M]}get boundsT(){const t=this.bounds,s=r(a(),t.x,t.y);if(n(s,s,this._transform),this._hasRotation){const i=Math.max(t.width,t.height);return new g(s[0],s[1],i,i)}return new g(s[0],s[1],t.width,t.height)}_createBounds(t){let s=1/0,i=1/0,e=0,o=0;for(const r of t)s=Math.min(s,r.xTopLeft),i=Math.min(i,r.yTopLeft),e=Math.max(e,r.xBottomRight),o=Math.max(o,r.yBottomRight);const h=e-s,n=o-i;return new g(s+h/2,i+n/2,h,n)}_createGlyphTransform(t,s){const h=b*s.angle,n=o(),f=a();return i(n,n,r(f,s.xOffset,-s.yOffset)),s.useCIMAngleBehavior?e(n,n,h):(i(n,n,r(f,t.x,t.y)),e(n,n,h),i(n,n,r(f,-t.x,-t.y))),n}}class T{constructor(t,s,i,e,o,h){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(s,i)),this.end=Math.max(0,Math.max(s,i)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=e,this.yMin=o,this.yMax=h}}const v=t=>10===t,j=t=>32===t;function A(t,s,i){const e=new Array,o=1/i.scale,h=i.maxLineWidth*o,n=s?t.length-1:0,r=s?-1:t.length,a=s?-1:1;let f=n,c=0,d=0,m=f,g=m,_=0,l=1/0,u=0;for(;f!==r;){const{code:s,metrics:i}=t[f],o=Math.abs(i.top);if(v(s)||j(s)||(l=Math.min(l,o),u=Math.max(u,o+i.height)),v(s))f!==n&&(e.push(new T(t,m,f-a,c,l===1/0?0:l,u)),l=1/0,u=0),c=0,m=f+a,g=f+a,d=0;else if(j(s))g=f+a,d=0,_=i.advance,c+=i.advance;else if(c>h){if(g!==m){const s=g-2*a;c-=_,e.push(new T(t,m,s,c-d,l,u)),l=1/0,u=0,m=g,c=d}else e.push(new T(t,m,f-a,c,l,u)),l=1/0,u=0,m=f,g=f,c=0;c+=i.advance,d+=i.advance}else c+=i.advance,d+=i.advance;f+=a}const x=new T(t,m,f-a,c,l,u);return x.start>=0&&x.end<t.length&&e.push(x),e}function z(t,s){let i=0;for(let h=0;h<t.length;h++){const{width:s}=t[h];i=Math.max(s,i)}const e=\"underline\"===s.decoration?l:0,o=t[0].yMin;return{x:0,y:o,height:t[t.length-1].yMax+s.lineHeight*(t.length-1)+e-o,width:i}}function O(t,s){const i=s.scale,e=new Array,{glyphs:o,isRightToLeft:h}=t,n=A(o,h,s),r=n.length?z(n,s):{x:0,y:0,height:0,width:0},a=f(s.horizontalAlignment),m=c(s.verticalAlignment),g=m===d.Baseline?1:0,l=g?0:m-1,u=(1-g)*-r.y+l*(r.height/2)+(g?1:0)*-_;for(let f=0;f<n.length;f++){const{start:h,end:r,width:c}=n[f];let d=-1*(a+1)*(c/2)-p;const m=(t.isRightToLeft?n.length-1-f:f)*s.lineHeight+u-p;n[f].startX=d,n[f].startY=m;for(let t=h;t<=r;t++){const s=o[t];if(v(s.code))continue;const h=new L(d+s.metrics.left,m-s.metrics.top,s,i);d+=s.metrics.advance,e.push(h)}}return new B(e,n,s)}export{L as ShapedGlyph,B as ShapingInfo,O as shapeGlyphs};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{px2pt as r,pt2px as n}from\"../../../../core/screenUtils.js\";import e from\"../../../../geometry/Polygon.js\";import{create as t}from\"../../../../geometry/support/aaBoundingRect.js\";import{getInfo as i}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{minTextLineWidth as o,maxTextLineWidth as s}from\"../../engine/webgl/definitions.js\";const m=512,u=50;function c(r,n){const e=i(n);if(!e)return null;const[o,s]=e.valid;return r[2]>s?[t([r[0],r[1],s,r[3]]),t([o,r[1],o+r[2]-s,r[3]])]:r[0]<o?[t([o,r[1],r[2],r[3]]),t([s-(o-r[0]),r[1],s,r[3]])]:null}function a(r){return\"text\"===r||\"esriTS\"===r}function f(r){return\"simple-marker\"===r||\"picture-marker\"===r||\"esriSMS\"===r||\"esriPMS\"===r}function l(r){if(!r)return null;const{xmin:n,ymin:t,xmax:i,ymax:o,spatialReference:s}=r;return new e({rings:[[[n,t],[n,o],[i,o],[i,t],[n,t]]],spatialReference:s})}function p(e){return r(Math.round(n(e)))}function g(n){const e=r(o),t=r(s);return Math.max(e,Math.min(n||t,t))}export{g as getLineWidth,c as intersectingInternationalDateline,f as isMarkerSymbol,a as isTextSymbol,u as pixelBuffer,l as polygonFromExtent,p as roundPtToWholePixel,m as tileSize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar n,e;function d(n){return null!=n&&!n.running}!function(n){n[n.Idle=0]=\"Idle\",n[n.Rendering=1]=\"Rendering\",n[n.Ready=2]=\"Ready\",n[n.Fading=3]=\"Fading\"}(n||(n={})),function(n){n[n.RG=0]=\"RG\",n[n.BA=1]=\"BA\",n[n.COUNT=2]=\"COUNT\"}(e||(e={}));export{e as CloudsTextureChannels,n as CubeMapState,d as ensureClouds};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{neverReached as a}from\"../../../core/compilerUtils.js\";import{clamp as t}from\"../../../core/mathUtils.js\";import{signal as e}from\"../../../core/signal.js\";import{rotate as s}from\"../../../core/libs/gl-matrix-2/math/mat4.js\";import{IDENTITY as i,create as r}from\"../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{k as h,n as o,h as n,c,l as d,d as l}from\"../../../chunks/vec32.js\";import{create as _,fromValues as u}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as F,fromPoints as f,axis as p}from\"../../../geometry/support/axisAngleDegrees.js\";import{earth as S}from\"../../../geometry/support/Ellipsoid.js\";import{CloudsTextureChannels as m,ensureClouds as E,CubeMapState as D}from\"./Clouds.js\";import{heightLimit as P}from\"./weather.js\";class x{constructor(){this.startTime=0,this._data=e(null),this._readChannels=m.RG,this.parallax=new O,this.parallaxNew=new O,this._anchorPoint=_(),this._fadeState=e(A.HIDE),this._fadeFactor=e(1)}get data(){return this._data.value}set data(a){this._data.value=a}get readChannels(){return this._readChannels}get fadeState(){return this._fadeState.value}get fadeFactor(){return this._fadeFactor.value}get opacity(){switch(this.fadeState){case A.HIDE:return 0;case A.FADE_OUT:return 1-this.fadeFactor;case A.FADE_IN:return this.fadeFactor;case A.SHOW:case A.CROSS_FADE:return 1}}fade(a,e,s){this.isFading&&this.fadeFactor<1&&(this._fadeFactor.value=s?t((e-this.startTime)/(H*s),0,1):1,1===this.fadeFactor&&this._endFade()),this._evaluateState(a,e),this._updateParallax(a)}_evaluateState(a,t){const e=a.relativeElevation,s=this._updateAnchorPoint(a);(e>1.7*P||e<-P||s>I)&&this.opacity>0?this._startFade(A.HIDE,t):this.isFading||(e>P||e<-.35*P||s>w*I?this.opacity>0&&this._startFade(A.FADE_OUT,t):E(this.data)&&(0===this.opacity?this._startFade(A.FADE_IN,t):this.data.state===D.Ready&&(this.fadeState===A.SHOW?this._startFade(A.CROSS_FADE,t):this._startFade(A.SHOW,t))))}_updateParallax(a){const t=h(a.eye);this.parallax.radiusCurvatureCorrection=.84*Math.sqrt(Math.max(t-S.radius*S.radius,0))/Math.sqrt(t),f(C,this.parallax.anchorPoint,v),s(this.parallax.transform,i,v[3],p(v)),f(C,this.parallaxNew.anchorPoint,v),s(this.parallaxNew.transform,i,v[3],p(v))}_updateAnchorPoint(a){return o(this._anchorPoint,a.eye),n(this._anchorPoint,this._anchorPoint,S.radius),this.fadeState===A.HIDE&&this.data?.state===D.Ready?(c(this.parallax.anchorPoint,this._anchorPoint),0):d(l(g,this.parallax.anchorPoint,this._anchorPoint))}requestFade(){this._fadeFactor.value=0}_startFade(a,t){switch(this._fadeState.value=a,this.startTime=t,a){case A.CROSS_FADE:this.requestFade(),this._switchReadChannels(),c(this.parallaxNew.anchorPoint,this._anchorPoint);break;case A.FADE_IN:this.requestFade(),this._switchReadChannels(),c(this.parallax.anchorPoint,this._anchorPoint),c(this.parallaxNew.anchorPoint,this._anchorPoint);break;case A.FADE_OUT:this.requestFade();break;case A.SHOW:this._switchReadChannels(),c(this.parallax.anchorPoint,this._anchorPoint),c(this.parallaxNew.anchorPoint,this._anchorPoint),this._endFade();break;case A.HIDE:this._endFade()}}_endFade(){switch(this._fadeFactor.value=1,this.data&&this.data.state!==D.Ready&&(this.data.state=D.Idle),this.fadeState){case A.CROSS_FADE:c(this.parallax.anchorPoint,this.parallaxNew.anchorPoint),this._fadeState.value=A.SHOW;break;case A.FADE_IN:this._fadeState.value=A.SHOW;break;case A.FADE_OUT:this._fadeState.value=A.HIDE;break;case A.SHOW:case A.HIDE:break;default:a(this.fadeState)}}_switchReadChannels(){this.data?.state===D.Ready&&(this._readChannels=1-this._readChannels,this.data.state=D.Fading)}get isFading(){return this.fadeState===A.FADE_OUT||this.fadeState===A.FADE_IN||this.fadeState===A.CROSS_FADE}}var A;!function(a){a[a.HIDE=0]=\"HIDE\",a[a.FADE_IN=1]=\"FADE_IN\",a[a.SHOW=2]=\"SHOW\",a[a.CROSS_FADE=3]=\"CROSS_FADE\",a[a.FADE_OUT=4]=\"FADE_OUT\"}(A||(A={}));class O{constructor(){this.anchorPoint=_(),this.radiusCurvatureCorrection=0,this.transform=r()}}const C=u(0,0,1),v=F(),g=_(),H=1.25,w=.5,I=2e5;export{x as CloudsParameters,A as FadeState};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../../core/JSONSupport.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{enumeration as t}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";var c;let p=c=class extends r{constructor(o){super(o),this.type=\"cloudy\",this.cloudCover=.5}clone(){return new c({cloudCover:this.cloudCover})}};o([t({cloudy:\"cloudy\"})],p.prototype,\"type\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"cloudCover\",void 0),p=c=o([s(\"esri.views.3d.environment.CloudyWeather\")],p);const u=p;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../../core/JSONSupport.js\";import{property as t}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{enumeration as e}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";var p;let c=p=class extends r{constructor(o){super(o),this.type=\"foggy\",this.fogStrength=.5}clone(){return new p({fogStrength:this.fogStrength})}};o([e({foggy:\"foggy\"})],c.prototype,\"type\",void 0),o([t({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],c.prototype,\"fogStrength\",void 0),c=p=o([s(\"esri.views.3d.environment.FoggyWeather\")],c);const n=c;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../../core/JSONSupport.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{enumeration as t}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";var s;let p=s=class extends r{constructor(o){super(o),this.type=\"rainy\",this.cloudCover=.5,this.precipitation=.5}clone(){return new s({cloudCover:this.cloudCover,precipitation:this.precipitation})}};o([t({rainy:\"rainy\"})],p.prototype,\"type\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"cloudCover\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"precipitation\",void 0),p=s=o([i(\"esri.views.3d.environment.RainyWeather\")],p);const c=p;export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../../core/JSONSupport.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{enumeration as t}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as s}from\"../../../core/accessorSupport/decorators/subclass.js\";var i;let p=i=class extends r{constructor(o){super(o),this.type=\"snowy\",this.cloudCover=.5,this.precipitation=.5,this.snowCover=\"disabled\"}clone(){return new i({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};o([t({snowy:\"snowy\"})],p.prototype,\"type\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"cloudCover\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"precipitation\",void 0),o([e({type:[\"enabled\",\"disabled\"],nonNullable:!0,json:{write:!0}})],p.prototype,\"snowCover\",void 0),p=i=o([s(\"esri.views.3d.environment.SnowyWeather\")],p);const n=p;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../../chunks/tslib.es6.js\";import{JSONSupport as r}from\"../../../core/JSONSupport.js\";import{property as e}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{enumeration as s}from\"../../../core/accessorSupport/decorators/enumeration.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";var c;let p=c=class extends r{constructor(o){super(o),this.type=\"sunny\",this.cloudCover=.5}clone(){return new c({cloudCover:this.cloudCover})}};o([s({sunny:\"sunny\"})],p.prototype,\"type\",void 0),o([e({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],p.prototype,\"cloudCover\",void 0),p=c=o([t(\"esri.views.3d.environment.SunnyWeather\")],p);const n=p;export{n as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"./CloudyWeather.js\";import r from\"./FoggyWeather.js\";import o from\"./RainyWeather.js\";import t from\"./SnowyWeather.js\";import y from\"./SunnyWeather.js\";const n={key:\"type\",base:y,typeMap:{sunny:y,cloudy:e,rainy:o,snowy:t,foggy:r}},a=Object.keys(n.typeMap);function s(e,r){return!!a.includes(e)||(r.error(`\"${e}\" is not a valid weather type`),!1)}const p=1e4,i=1e5;export{i as cloudsHeight,p as heightLimit,s as validateWeatherType,n as weatherTypes,a as weatherTypesArray};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"../../../request.js\";import{result as e}from\"../../../core/asyncUtils.js\";import t from\"../../../core/Error.js\";import{throwIfAborted as a,throwIfAbortError as o}from\"../../../core/promiseUtils.js\";import{isDataProtocol as s,dataToArrayBuffer as i}from\"../../../core/urlUtils.js\";class n{constructor(r){this._streamDataRequester=r}async loadJSON(r,e){return this._load(\"json\",r,e)}async loadBinary(r,e){return s(r)?(a(e),i(r)):this._load(\"binary\",r,e)}async loadImage(r,e){return this._load(\"image\",r,e)}async _load(a,s,i){if(null==this._streamDataRequester)return(await r(s,{responseType:m[a]})).data;const n=await e(this._streamDataRequester.request(s,a,i));if(!0===n.ok)return n.value;throw o(n.error),new t(\"glt-loader-request-error\",`Request for resource failed: ${n.error}`)}}const m={image:\"image\",binary:\"array-buffer\",json:\"json\",\"image+type\":void 0};export{n as DefaultLoadingContext};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as t,create as o}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{ZEROS as r,ONES as l}from\"../../../../core/libs/gl-matrix-2/factories/vec2f32.js\";import{multiply as i}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";function s(s){if(null==s)return null;const a=null!=s.offset?s.offset:r,n=null!=s.rotation?s.rotation:0,e=null!=s.scale?s.scale:l,f=t(1,0,0,0,1,0,a[0],a[1],1),c=t(Math.cos(n),-Math.sin(n),0,Math.sin(n),Math.cos(n),0,0,0,1),m=t(e[0],0,0,0,e[1],0,0,0,1),u=o();return i(u,c,m),i(u,f,u),u}export{s as getTransformMatrix};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isUint8Array as r}from\"../../../../core/typedArrayUtil.js\";import{getContinuousIndexArray as t,newIndexArray as e}from\"../../../../geometry/support/Indices.js\";import{PrimitiveType as n}from\"../../../webgl/enums.js\";function o(r,t){switch(t){case n.TRIANGLES:return f(r);case n.TRIANGLE_STRIP:return u(r);case n.TRIANGLE_FAN:return i(r)}}function f(e){return\"number\"==typeof e?t(e):r(e)?new Uint16Array(e):e}function u(r){const t=\"number\"==typeof r?r:r.length;if(t<3)return[];const n=t-2,o=e(3*n);if(\"number\"==typeof r){let r=0;for(let t=0;t<n;t+=1)t%2==0?(o[r++]=t,o[r++]=t+1,o[r++]=t+2):(o[r++]=t+1,o[r++]=t,o[r++]=t+2)}else{let t=0;for(let e=0;e<n;e+=1)e%2==0?(o[t++]=r[e],o[t++]=r[e+1],o[t++]=r[e+2]):(o[t++]=r[e+1],o[t++]=r[e],o[t++]=r[e+2])}return o}function i(r){const t=\"number\"==typeof r?r:r.length;if(t<3)return new Uint16Array(0);const e=t-2,n=e<=65536?new Uint16Array(3*e):new Uint32Array(3*e);if(\"number\"==typeof r){let r=0;for(let t=0;t<e;++t)n[r++]=0,n[r++]=t+1,n[r++]=t+2;return n}const o=r[0];let f=r[1],u=0;for(let i=0;i<e;++i){const t=r[i+2];n[u++]=o,n[u++]=f,n[u++]=t,f=t}return n}export{o as convertPrimitiveToTriangles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{TextureEncodingMimeType as e}from\"../../webgl-engine/lib/basicInterfaces.js\";class t{constructor(t){this.data=t,this.type=\"encoded-mesh-texture\",this.encoding=e.KTX2_ENCODING}}function r(e){return\"encoded-mesh-texture\"===e?.type}async function n(e){const t=new Blob([e]),r=await t.text();return JSON.parse(r)}async function o(r,n){if(n===e.KTX2_ENCODING)return new t(r);const o=new Blob([r],{type:n}),c=URL.createObjectURL(o),s=new Image;if(has(\"esri-iPhone\"))return new Promise(((e,t)=>{const r=()=>{o(),e(s)},n=e=>{o(),t(e)},o=()=>{URL.revokeObjectURL(c),s.removeEventListener(\"load\",r),s.removeEventListener(\"error\",n)};s.addEventListener(\"load\",r),s.addEventListener(\"error\",n),s.src=c}));try{s.src=c,await s.decode()}catch(i){console.warn(\"Failed decoding HTMLImageElement\")}return URL.revokeObjectURL(c),s}export{t as EncodedMeshTexture,o as imageFromBinaryData,r as isEncodedMeshTexture,n as jsonFromBinaryData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{i as e}from\"../../../../chunks/vec32.js\";import{create as t}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as i,empty as r,expandWithRect as o,center as s,set as n,toRect as d}from\"../../../../geometry/support/aaBoundingBox.js\";import{create as a}from\"../../../../geometry/support/aaBoundingRect.js\";import{demResolutionForBoundingBox as h}from\"./graphicUtils.js\";import{Object3DState as c}from\"../../webgl-engine/lib/basicInterfaces.js\";import{DirtyOperation as g,DirtyState as m}from\"../../webgl-engine/lib/ModelDirtyTypes.js\";class l{constructor(e,t,i,r){this.graphics3DSymbolLayer=e,this.renderGeometries=t,this.boundingBox=i,this._drapeSourceRenderer=r,this.type=\"draped\",this.stage=null,this._visible=!1,this._addedToStage=!1,this.isElevationSource=!1}initialize(e){this.stage=e.stage}setVisibility(e){if(null!=this.stage&&this._visible!==e){if(this._visible=e,e&&!this._addedToStage)return this._addedToStage=!0,void this._drapeSourceRenderer.addGeometries(this.renderGeometries,g.ADD);if(e||this._addedToStage){for(const e of this.renderGeometries)e.visible=this._visible;this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,m.VISIBILITY)}}}destroy(){this.stage&&this._addedToStage&&this._drapeSourceRenderer.removeGeometries(this.renderGeometries,g.REMOVE),this._addedToStage=!1,this._visible=!1,this.stage=null}getCenterObjectSpace(i=t()){return e(i,0,0,0)}getBoundingBoxObjectSpace(e=i()){return r(e)}addObjectState(e){e.stateType===c.Highlight&&(this.renderGeometries.forEach((t=>{const i=t.geometry.allocateIdAndHighlight(e.highlightGroupName);e.addRenderGeometry(t,i,this)})),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,m.HIGHLIGHT))}removeObjectState(e){this.renderGeometries.forEach((t=>e.removeByObject(t)))}removeRenderGeometryObjectState(e,t){t.channel===c.Highlight&&(e.geometry.removeHighlight(t),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries([e],m.HIGHLIGHT))}computeAttachmentOrigin(e){for(const t of this.renderGeometries)t.geometry.computeAttachmentOrigin(f)&&(e.draped.origin[0]+=f[0],e.draped.origin[1]+=f[1],e.draped.num++)}async getProjectedBoundingBox(e,t,i,n,d){r(d);for(let r=0;r<this.renderGeometries.length;r++){const t=this.renderGeometries[r];this._getRenderGeometryProjectedBoundingRect(t,e,u,i),o(d,u)}if(t){let e;s(d,f);const i=h(d,t.service.spatialReference,t);try{e=await t.service.queryElevation(f[0],f[1],n,i,\"ground\")}catch(a){}null!=e&&(d[2]=Math.min(d[2],e),d[5]=Math.max(d[5],e))}return d}_getRenderGeometryProjectedBoundingRect(e,t,i,r){if(this.boundingBox)n(p,this.boundingBox);else{const t=e.boundingSphere,i=t[3];p[0]=t[0]-i,p[1]=t[1]-i,p[2]=t[2]-i,p[3]=t[0]+i,p[4]=t[1]+i,p[5]=t[2]+i}return t(p,0,2),this.calculateRelativeScreenBounds&&r.push({location:s(p),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),d(p,i)}}const u=a(),p=i(),f=t();export{l as Graphics3DDrapedGraphicLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import t from\"../../../../core/Error.js\";import{clone as e}from\"../../../../core/lang.js\";import{getMetersPerVerticalUnitForSR as r}from\"../../../../core/unitUtils.js\";import{e as s}from\"../../../../chunks/earcut.js\";import{normalFromMat4 as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as i}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as n,invertOrIdentity as a}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as l}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{L as c,c as m,n as p,i as h,d as g,e as d,t as u,a as f}from\"../../../../chunks/vec32.js\";import{fromArray as y,clone as b,ZEROS as _,create as x}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{computeTranslationToOriginAndRotation as S}from\"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";import{create as j,fromBuffer as P,intersectsClippingArea as E}from\"../../../../geometry/support/aaBoundingBox.js\";import{newDoubleArray as w}from\"../../../../geometry/support/DoubleArray.js\";import{newIndexArray as O,getZeroIndexArray as v}from\"../../../../geometry/support/Indices.js\";import{t as C}from\"../../../../chunks/vec3.js\";import{makeVertexCandidate as M,makeEdgeCandidate as I}from\"../../../../layers/graphics/data/SnappingCandidate.js\";import{getDriverAxisSizeValue as A}from\"../../../../renderers/support/renderingInfoUtils.js\";import{ViewingMode as L}from\"../../../ViewingMode.js\";import{needsElevationUpdates3D as z,SampleElevationInfo as B}from\"./elevationAlignmentUtils.js\";import{Object3DEdgeState as D,Graphics3DObject3DGraphicLayer as R}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as T}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as U,computeCentroid as G}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as N}from\"./interfaces.js\";import{geometryAsPolygon as V}from\"./polygonUtils.js\";import{createMaterial as F}from\"../support/edgeUtils.js\";import{debugFlags as k}from\"../../support/debugFlags.js\";import{SamplePosition as H}from\"../../support/ElevationProvider.js\";import{geometryToRenderInfo as W}from\"../../support/renderInfoUtils/polygon.js\";import{NormalType as q}from\"../../webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{Attribute as Z}from\"../../webgl-engine/lib/Attribute.js\";import{CullFaceOptions as J}from\"../../webgl-engine/lib/basicInterfaces.js\";import{ContentObjectType as K}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as Q}from\"../../webgl-engine/lib/Geometry.js\";import{isGeometryWithMapPositions as X}from\"../../webgl-engine/lib/GeometryWithMapPositions.js\";import{compressNormals as Y,compressNormal as $}from\"../../webgl-engine/lib/Normals.js\";import{Object3D as tt}from\"../../webgl-engine/lib/Object3D.js\";import{VertexAttribute as et}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as rt}from\"../../webgl-engine/materials/DefaultMaterial.js\";const st=[\"polygon\",\"extent\"];class ot extends T{constructor(t,e,r,s){super(t,e,r,s),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const e=U(this._getSymbolSize());if(e)throw new t(\"graphics3dextrudesymbollayer:invalid-size\",e)}const e=this.symbolLayer?.material?.color,r=this._getCombinedOpacityAndColor(e),s=y(r),o=r[3],i=o<1||this.needsDrivenTransparentPass,n=this.symbolLayer?.material?.emissiveFactor,a=n?c(b(n)):_,l={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:s,ambient:s,opacity:o,transparent:i,cullFace:i?J.None:J.Back,hasVertexColors:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,emissiveFactor:a,offsetTransparentBackfaces:!0,normalType:q.Compressed};this._materials[It.Main]=new rt(l,this._context),this._materials[It.Bottom]=new rt({...l,cullFace:J.Back},this._context),this._context.stage.addMany(this._materials)}destroy(){super.destroy(),this._context.stage.removeMany(this._materials),this._materials.length=0}createGraphics3DGraphic(t){const e=t.graphic;if(!this._validateGeometry(e.geometry,st,this.symbolLayer.type))return null;const r=this._getVertexOpacityAndColor(t.renderingInfo,255),s=this.setGraphicElevationContext(e);return this._createAs3DShape(e,t.renderingInfo,r,s,e.uid)}layerOpacityChanged(t,e){const r=this.symbolLayer?.material?.color,s=this._getCombinedOpacity(r),o=s<1||this.needsDrivenTransparentPass;this._materials[It.Main]?.setParameters({opacity:s,transparent:o}),this._materials[It.Bottom]?.setParameters({opacity:s,transparent:o});const i=this._getLayerOpacity();t.forEach((t=>e(t)?.layerOpacityChanged(i,this._context.isAsync)))}layerElevationInfoChanged(t,e){return this.updateGraphics3DGraphicElevationInfo(t,e,z)}slicePlaneEnabledChanged(t,e){return this._materials[It.Main]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._materials[It.Bottom]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),t.forEach((t=>{const r=e(t);null!=r&&r.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)})),!0}physicalBasedRenderingChanged(){const t={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0};return this._materials[It.Main]?.setParameters(t),this._materials[It.Bottom]?.setParameters(t),!0}_getExtrusionSize(t){let e;return e=t.size&&this._drivenProperties.size?A(t.size,2)??0:this._getSymbolSize(),e/=this._context.renderCoordsHelper.unitInMeters,e}applyRendererDiff(t,e){return this._drivenPropertiesChanged(e)?N.RecreateSymbol:N.RecreateGraphics}async queryForSnapping(t,s,o,i){const n=this._getExtrusionSize(o)*this._context.renderCoordsHelper.unitInMeters/r(s),{objectId:a,target:l}=t,c=e(l);switch(c.z=(c.z??0)+n,t.type){case\"edge\":{const{start:r,end:s}=t,o=e(r),i=e(s);return o.z=(o.z??0)+n,i.z=(i.z??0)+n,[I(a,c,1/0,o,i)]}case\"vertex\":return[M(a,c,1/0),I(a,l,1/0,l,c)];default:return[]}}_getSymbolSize(){return this.symbolLayer.size??1}_createAs3DShape(t,e,r,a,c){const m=V(t.geometry);if(null==m)return null;if(0===m.rings.length||!m.rings.some((t=>t.length>0)))return this._logGeometryValidationWarnings(m.rings,\"rings\",\"ExtrudeSymbol3DLayer\"),null;const p=W(m,this._context.elevationProvider,this._context.renderCoordsHelper,a);this._logGeometryCreationWarnings(p,m.rings,\"rings\",\"ExtrudeSymbol3DLayer\");const h=G(m);if(null==h)return null;const g=new Array,d=new Array,u=j(),f=l(),y=x(),b=this._context.renderCoordsHelper.viewingMode===L.Global;b||this._context.renderCoordsHelper.worldUpAtPosition(null,y),S(m.spatialReference,[h.x,h.y,0],f,this._context.renderCoordsHelper.spatialReference);const _=l();n(_,f);const v=i();o(v,_);const{polygons:M,mapPositions:I,position:A}=p,B=new Map,T=this._materials[It.Main];for(const o of M){const t=o.count;if(this._context.clippingExtent&&(P(o.mapPositions,u),!E(u,this._context.clippingExtent)))continue;const i=s(o.mapPositions,o.holeIndices,3);if(0===i.length)continue;const n=i.length,a=6*t,l=O(a+n),m=O(n),p=w(3*a),h=w(3*a),x=w(3*a),S=w(a);nt(A,I,i,o,p,x,h,S,l,m,this._getExtrusionSize(e),y,b),C(p,p,_);const j=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:c,layerUid:this._context.layer.uid}),v=new At(p,x,Y(h),S),M=it(T,l,l.length-m.length,v,r,j),L=t,z=t,D=2*o.count,R=new Lt(L,z,D,n/3);_t(M,R,f),B.set(M,R),g.push(M,it(this._materials[It.Bottom],m,0,v,r,j)),d.push(v.heights)}if(0===g.length)return null;const U=new tt({geometries:g,layerUid:this._context.layer.uid,graphicUid:c,isElevationSource:!0});U.transformation=f;const N=F(this.symbolLayer,{opacity:this._getLayerOpacity()}),k=N?new D(this._materials[It.Main],N,this._context.slicePlaneEnabled):null,H=new R(this,U,g,null,null,((t,e,r,s,o)=>bt(t,e,r,s,o,d,B)),a,k);return H.alignedSampledElevation=p.sampledElevation,H.needsElevationUpdates=z(a.mode),H}}function it(t,e,r,s,o,i){const n=v(e.length),a=[[et.POSITION,new Z(s.positions,e,3,!0)],[et.NORMALCOMPRESSED,new Z(s.normals,e,2,!0)],[et.COLOR,new Z(o,n,4,!0)]];return new Q(t,a,s.elevation,K.Mesh,i,r)}function nt(t,e,r,s,o,i,n,a,l,c,m,p,h){{const g=r.length/3,d=2*s.count;at(t,e,s.index,s.count,r,0,g,o,i,n,a,l,c,d,m,p,h)}{let t=0,e=2*s.count,r=0;const c=s.pathLengths[0];mt(o,i,a,n,t,c,s.count,e,l,r,m),e+=4*c,r+=2*c,t+=c;for(let p=1;p<s.pathLengths.length;++p){const c=s.pathLengths[p];mt(o,i,a,n,t,c,s.count,e,l,r,m),e+=4*c,r+=2*c,t+=c}}}function at(t,e,r,s,o,i,n,a,l,c,h,g,d,u,f,y,b){m(St,y);{const o=f>0?1:-1;let i=3*r,n=0,m=3*n,g=s,d=3*g;for(let r=0;r<s;++r){const r=t[i],s=t[i+1],u=t[i+2];b&&(St[0]=r,St[1]=s,St[2]=u,p(St,St)),a[m+0]=r,a[m+1]=s,a[m+2]=u;const y=e[i+0],_=e[i+1],x=e[i+2];l[m+0]=y,l[m+1]=_,l[m+2]=x,c[m+0]=-o*St[0],c[m+1]=-o*St[1],c[m+2]=-o*St[2],h[n]=0,a[d+0]=r+f*St[0],a[d+1]=s+f*St[1],a[d+2]=u+f*St[2],l[d+0]=y,l[d+1]=_,l[d+2]=x,h[g]=f,m+=3,d+=3,i+=3,n+=1,g+=1}}{let t=3*i,e=0,r=3*u;const a=f<0?Et:Pt,l=f<0?Pt:Et;for(let i=0;i<n;++i)d[e]=o[t+a[0]],d[e+1]=o[t+a[1]],d[e+2]=o[t+a[2]],g[r]=o[t+l[0]]+s,g[r+1]=o[t+l[1]]+s,g[r+2]=o[t+l[2]]+s,e+=3,r+=3,t+=3}}function lt(t,e,r,s,o,i,n){s[i]=s[n],n*=3,t[i*=3]=t[n],t[i+1]=t[n+1],t[i+2]=t[n+2],e[i]=e[n],e[i+1]=e[n+1],e[i+2]=e[n+2],r[i]=o[0],r[i+1]=o[1],r[i+2]=o[2]}const ct=x();function mt(t,e,r,s,o,i,n,a,l,c,m){let p=o,h=o+1,g=o+n,d=o+n+1,u=a,f=a+1,y=a+2*i,b=a+2*i+1;m<0&&(p=o+n+1,d=o);let _=3*c;for(let x=0;x<i;++x)x===i-1&&(h=o,m>0?d=o+n:p=o+n),ft(t,p,h,g,ct),lt(t,e,s,r,ct,u,p),lt(t,e,s,r,ct,f,h),lt(t,e,s,r,ct,y,g),lt(t,e,s,r,ct,b,d),l[_]=u,l[_+1]=y,l[_+2]=b,l[_+3]=u,l[_+4]=b,l[_+5]=f,_+=6,p++,h++,g++,d++,u+=2,f+=2,y+=2,b+=2}const pt=x(),ht=x(),gt=x(),dt=x(),ut=x();function ft(t,e,r,s,o){e*=3,r*=3,s*=3,h(pt,t[e++],t[e++],t[e++]),h(ht,t[r++],t[r++],t[r++]),h(gt,t[s++],t[s++],t[s++]),g(dt,ht,pt),g(ut,gt,pt),d(o,ut,dt),p(o,o)}const yt=x();function bt(t,e,r,s,o,i,n){const c=t.stageObject,m=c.geometries,p=m.length,g=\"absolute-height\"!==e.mode;let d=0;const f=c.transformation,y=a(l(),f);for(let a=0;a<p;a+=2){const t=m[a];if(!X(t))continue;const e=t.getMutableAttribute(et.POSITION).data,l=i[a/2],p=new H(t.mapPositions),b=e.length/3;let _=!1,x=0;{let t=0;for(let i=0;i<b;i++){yt[0]=e[t],yt[1]=e[t+1],yt[2]=e[t+2],s(p,jt),g&&(x+=jt.sampledElevation),k.TESTS_DISABLE_OPTIMIZATIONS?(h(xt,p.array[p.offset],p.array[p.offset+1],jt.z+l[t/3]),null!=r&&o.toRenderCoords(xt,r,xt),u(xt,xt,y)):(h(xt,e[t],e[t+1],e[t+2]),u(xt,xt,f),o.setAltitude(xt,jt.z+l[t/3]),u(xt,xt,y)),e[t]=xt[0],e[t+1]=xt[1],e[t+2]=xt[2];const i=wt/o.unitInMeters;(Math.abs(yt[0]-e[t])>=i||Math.abs(yt[1]-e[t+1])>=i||Math.abs(yt[2]-e[t+2])>=i)&&(_=!0),p.offset+=3,t+=3}}if(_){const e=n.get(t);e&&_t(t,e,f),c.geometryVertexAttributeUpdated(m[a],et.NORMALCOMPRESSED),t.invalidateBoundingInfo(),c.geometryVertexAttributeUpdated(m[a],et.POSITION),m[a+1].invalidateBoundingInfo(),c.geometryVertexAttributeUpdated(m[a+1],et.POSITION)}d+=x/b}return d/p}function _t(t,e,r){const s=t.getMutableAttribute(et.POSITION),o=t.getMutableAttribute(et.NORMALCOMPRESSED).data,{topVertexStart:i,topVertexCount:n,topFaceStart:a,topFaceCount:l}=e,c=s.data,m=n,g=t.attributes.get(et.POSITION).indices,y=a+l,b=i+n,_=w(3*m);for(let p=0;p<m;++p){const t=3*p;_[t+0]=0,_[t+1]=0,_[t+2]=0}const x=Ot,S=vt,j=Ct,P=Mt,E=St;for(let w=a;w<y;++w){const t=3*w;for(let e=0;e<3;++e){const s=g[t+e];P[e]=s;const o=3*s;h(xt,c[o+0],c[o+1],c[o+2]),u(x[e],xt,r)}f(S,x[1],x[0]),f(j,x[2],x[0]),d(E,S,j),p(E,E);for(let e=0;e<3;++e){const t=3*(P[e]-i);_[t+0]+=E[0],_[t+1]+=E[1],_[t+2]+=E[2]}}for(let p=i;p<b;++p){const t=3*(p-i),e=_[t+0],r=_[t+1],s=_[t+2],n=Math.sqrt(e*e+r*r+s*s);$(o,p,e/n,r/n,s/n)}}const xt=x(),St=x(),jt=new B,Pt=[0,2,1],Et=[0,1,2],wt=.01,Ot=[x(),x(),x()],vt=x(),Ct=x(),Mt=[0,0,0];var It;!function(t){t[t.Main=0]=\"Main\",t[t.Bottom=1]=\"Bottom\"}(It||(It={}));class At{constructor(t,e,r,s){this.positions=t,this.elevation=e,this.normals=r,this.heights=s}}class Lt{constructor(t,e,r,s){this.topVertexStart=t,this.topVertexCount=e,this.topFaceStart=r,this.topFaceCount=s}}export{ot as Graphics3DExtrudeSymbolLayer,nt as extrudePolygon};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import{result as t,createTask as r}from\"../../../../core/asyncUtils.js\";import i from\"../../../../core/Error.js\";import has from\"../../../../core/has.js\";import{clone as s}from\"../../../../core/lang.js\";import{abortMaybe as o,releaseMaybe as a}from\"../../../../core/maybe.js\";import{throwIfAbortError as n,throwIfAborted as l}from\"../../../../core/promiseUtils.js\";import{pt2px as c,px2pt as h}from\"../../../../core/screenUtils.js\";import{numericHash as m}from\"../../../../core/string.js\";import{dataComponents as u}from\"../../../../core/urlUtils.js\";import{fromValues as d,create as p}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{create as _,fromValues as f}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as y}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{projectPointToVector as g}from\"../../../../geometry/projection/projectPointToVector.js\";import{containsPoint as x}from\"../../../../geometry/support/aaBoundingBox.js\";import{createRendererExpression as b}from\"../../../../support/arcadeOnDemand.js\";import{CIMSymbolHelper as v}from\"../../../../symbols/cim/CIMSymbolHelper.js\";import{OverrideHelper as S}from\"../../../../symbols/cim/OverrideHelper.js\";import{evaluateValueOrFunction as P}from\"../../../../symbols/cim/utils.js\";import{scaleCIMSymbol as R}from\"../../../../symbols/support/cimSymbolUtils.js\";import{defaultPrimitive as z}from\"../../../../symbols/support/IconSymbol3DLayerResource.js\";import{Symbol3DAnchorPosition2D as M}from\"../../../../symbols/support/Symbol3DAnchorPosition2D.js\";import{getIconHref as w}from\"../../../../symbols/support/utils.js\";import C from\"../../../2d/arcade/callExpressionWithFeature.js\";import{transparentUnit as O}from\"./constants.js\";import{perObjectElevationAligner as j}from\"./ElevationAligners.js\";import{SymbolUpdateType as I,elevationModeChangeUpdateType as T,needsElevationUpdates2D as E}from\"./elevationAlignmentUtils.js\";import{Graphics3DDrapedGraphicLayer as D}from\"./Graphics3DDrapedGraphicLayer.js\";import{Graphics3DObject3DGraphicLayer as U}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as F}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as L}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as G}from\"./interfaces.js\";import{namedAnchorToHUDMaterialAnchorPos as A}from\"./placementUtils.js\";import{placePointOnGeometry as V,updateStageObjectGeometry as H,getLocalOriginForPoint as k,extendPointGraphicElevationContext as B,createStageObject as N}from\"./pointUtils.js\";import{initFastSymbolUpdatesState as W,updateFastSymbolUpdatesState as $,evaluateModelTransformScale as q,ConvertOptions as J}from\"../support/FastSymbolUpdates.js\";import{createTexture as Z,requiresHalfTexelOffset as K,defaultSymbolSizeRatio as Q,defaultTexSize as X}from\"../../support/engineContent/sdfPrimitives.js\";import{drapedZ as Y}from\"../../terrain/OverlayRenderer.js\";import{createPointGeometry as ee}from\"../../webgl-engine/lib/GeometryUtil.js\";import{RenderGeometry as te}from\"../../webgl-engine/lib/RenderGeometry.js\";import{Texture as re}from\"../../webgl-engine/lib/Texture.js\";import{HUDMaterial as ie}from\"../../webgl-engine/materials/HUDMaterial.js\";const se=f(0,0,1),oe=16,ae=1.5,ne=Q,le=[ne/2,ne/2,1-ne/2,1-ne/2],ce=[X*ne,X*ne];class he extends F{getCachedSize(){return{size:this._getIconSize()}}constructor(e,t,r,i){super(e,t,r,i),this._cimSymbolMaterials=new Map,this._cimSymbolTextures=new Map,this._cimMaterialParametersInfo=null,this._size=null,this._symbolTextureRatio=1,this._outlineSize=0,this._patchTask=null,this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0}}async doLoad(e){this._validateOrThrow();const t=this._prepareMaterialParameters(),r=this._getPrimitive();if(null!=r)this._prepareResourcesPrimitive(t,r);else{const r=w(this.symbolLayer),i=de(r);null!=i?await this._prepareResourcesCIM(t,JSON.parse(i),e):await this._prepareResourcesHref(t,r,e)}}_validateOrThrow(){if(this._drivenProperties.size)return;const e=L(this._getIconSize());if(e)throw new i(\"graphics3diconsymbollayer:invalid-size\",e)}_getIconSize(){const e=this.symbolLayer,t=Math.round(null!=e.size?c(e.size):oe);return this._drivenProperties.size?Math.max(t,64):t}_generateTextureCIM(e){let t=this._cimData;if(t&&t.symbol||this.logger.error(\"Can't create texture, CIM data is undefined\"),t.primitiveOverrides){t=s(t);const r=t.primitiveOverrides;S.evaluateOverrides(r,e,this._arcadeInfo.geometryType,null,null),S.applyOverrides(t.symbol,r)}const r=m(JSON.stringify(t));let i=this._cimSymbolTextures.get(r);if(i)return i;const o=this._context.sharedResources.cimSymbolRasterizer,a=this._context.renderer&&\"dictionary\"===this._context.renderer.type?this._context.renderer.fieldMap:null;a&&S.applyDictionaryTextOverrides(t.symbol,e,a,null);const n=null!=this._cimScaleFactorOrFunction?P(this._cimScaleFactorOrFunction,e):1;1!==n&&t.symbol&&R(t.symbol,n,!0);const l=v.getEnvelope(t,null,o.resourceManager);if(l?.width&&l.height){const e=l.x+l.width/2,r=l.y+l.height/2,s=o.rasterize({type:\"cim\",data:t},l.width,l.height,e,r,1,\"esriGeometryPoint\"),a=new M({x:-l.x/l.width-.5,y:(l.height+l.y)/l.height-.5});this._cimMaterialParametersInfo.anchorPosition=pe(\"relative\",a),i=new re(s,{width:s?.width??1,height:s?.height??1,reloadable:!0})}else i=new re(new ImageData(1,1),{width:1,height:1,reloadable:!0});return this._cimSymbolTextures.set(r,i),this._context.stage.add(i),i}_prepareMaterialParameters(){const e={anchorPosition:pe(this.symbolLayer.anchor,this.symbolLayer.anchorPosition),rotation:this.symbolLayer.angle},t=this.symbol;if(me(t)){const{screenLength:r,minWorldLength:i,maxWorldLength:s}=t.verticalOffset;e.verticalOffset={screenLength:c(r),minWorldLength:i||0,maxWorldLength:null!=s?s:1/0}}this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),(0!==e.rotation||this._drivenProperties.rotation)&&(e.hasRotation=!0);const r=!!has(\"enable-feature:non-occluded-hud\");return e.occlusionTest=!r,e.occludedFragmentFade=r,e.horizonCullingEnabled=r,e.hasSlicePlane=this._context.slicePlaneEnabled,e}_prepareResourcesPrimitive(e,t){const r=this._getOutlineSize();if(ue(t)&&0===r)throw new Error(\"Nothing to render\");if(this._outlineSize=r,e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,null!=this._context.sharedResources.textures){const r=this._context.sharedResources.textures.fromData(`${t}-icon`,(()=>Z(t)));this._textureHandle=r,e.textureId=r.texture.id}e.textureIsSignedDistanceField=!0,e.sampleSignedDistanceFieldTexelCenter=K(t),e.distanceFieldBoundingBox=le;const i=this._getIconSize();this._size=[i,i],this._symbolTextureRatio=1/ne,this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesHref(e,r,s){this._outlineSize=this._getOutlineSize(),e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,e.textureIsSignedDistanceField=!1;const o=this._getIconSize(),a=o*this._context.graphicsCoreOwner.view.state.rasterPixelRatio;if(null!=this._context.sharedResources.textures){const l=await t(this._context.sharedResources.textures.fromUrl(r,a,{signal:s}));if(!1===l.ok){n(l.error);throw new i(\"graphics3diconsymbollayer:request-failed\",`Failed to load (Request for icon resource failed: ${r})`)}this._textureHandle=l.value;const c=l.value.texture;this._size=_e(c,o),e.textureId=c.id}this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesCIM(e,t,r){if(this._cimData=t,!this._context.sharedResources.cimSymbolRasterizer){const e=(await import(/* webpackChunkName: \"symbols-cim-CIMSymbolRasterizer\" */ \"../../../../symbols/cim/CIMSymbolRasterizer.js\")).CIMSymbolRasterizer;l(r),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new e(this._context.renderCoordsHelper.spatialReference))}const i=this._context.sharedResources.cimSymbolRasterizer,s=[],o=t,a=o?.symbol;v.fetchResources(a,i.resourceManager,s,r),v.fetchFonts(a,i.resourceManager,s);const n=this._context.layer.fields?this._context.layer.fields.map((e=>e.toJSON())):[],c=this._context.renderCoordsHelper.spatialReference;if(this._arcadeInfo={spatialReference:c,fields:n,geometryType:\"esriGeometryPoint\"},o?.primitiveOverrides&&s.push(S.createRenderExpressions(o.primitiveOverrides,this._arcadeInfo)),s.length>0&&(await Promise.all(s),l(r)),this._context.renderer&&\"dictionary\"===this._context.renderer.type&&this._context.renderer.scaleExpression){const e=this._context.renderer;if(e.scaleExpression){const t=e.scaleExpression,r=await b(t,this._context.layer.spatialReference,n);this._cimScaleFactorOrFunction=(e,t,i)=>{const s=C(r,e,{$view:i},\"esriGeometryPoint\",t);return null!==s?s:1}}}l(r),this._cimMaterialParametersInfo=e,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1}_getPrimitive(){return this.symbolLayer.resource?.href?null:this.symbolLayer.resource?.primitive??z}_getOutlineSize(){let e=0;const t=this.symbolLayer;if(null!=t.outline?.size)return Math.max(c(t.outline.size),0);return e=ue(this._getPrimitive())?ae:0,Math.max(e,0)}_getOutlineColor(){const t=this._getLayerOpacity(),r=this.symbolLayer,i=r?.outline?.color;if(null!=i){const r=e.toUnitRGB(i),s=i.a*t;return[r[0],r[1],r[2],s]}return[0,0,0,0]}_getFillColor(){if(ue(this._getPrimitive()))return O;const e=null==this._getPrimitive(),t=this.symbolLayer?.material?.color;return this._getCombinedOpacityAndColor(t,{hasIntrinsicColor:e})}_createMaterialAndAddToStage(e,t){const r=this._context.spherical;if(this._cimData){this._fastUpdates=null;let i=e.textureId?this._cimSymbolMaterials.get(e.textureId):null;return i||(i=new ie(e,r),this._cimSymbolMaterials.set(e.textureId??0,i),t.add(i)),i}return this._fastUpdates=W(this._context.renderer,this._fastVisualVariableConvertOptions()),this._fastUpdates&&(e={...e,...this._fastUpdates.materialParameters}),this._materials[0]=new ie(e,r),t.add(this._materials[0]),this._materials[0]}_setDrapingDependentMaterialParameters(){this.draped&&(this._forEachMaterial((e=>{e.setParameters({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,hasSlicePlane:!1,shaderPolygonOffset:0,draped:this.draped})})),this.layerOpacityChanged())}destroy(){super.destroy(),this._patchTask=o(this._patchTask),this._forEachMaterial((e=>this._context.stage.remove(e))),this._materials.length=0,this._cimSymbolMaterials.clear(),this._cimSymbolTextures.forEach((e=>this._context.stage.remove(e))),this._cimSymbolTextures.clear(),this._textureHandle=a(this._textureHandle)}_getScaleFactor(e,t){if(this._drivenProperties.size&&e.size){for(let t=0;t<3;t++){const r=e.size[t];r&&\"symbol-value\"!==r&&\"proportional\"!==r&&(e.size[t]=c(r))}if(\"symbol-value\"===e.size[0])return 1;if(isFinite(+e.size[0]))return+e.size[0]/t;if(isFinite(+e.size[2]))return+e.size[2]/t}return 1}_getDrivenRotation(e){return this._drivenProperties.rotation?e.heading??0:0}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;let r,i=[0,0];if(this._cimData){if(!this._cimData.symbol)return null;const e=this._generateTextureCIM(t),s={textureId:e.id,...this._cimMaterialParametersInfo};r=this._createMaterialAndAddToStage(s,this._context.stage);const o=window.devicePixelRatio||1;i=[e.parameters.width/o,e.parameters.height/o]}else i=this._size,r=this._materials[0];const s=V(t.geometry);if(null==s)return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const o=e.renderingInfo,a=this._getVertexOpacityAndColor(o),n=this._getDrivenRotation(o);let l=1;if(!this._fastUpdates?.visualVariables.size){const e=i[0]>i[1]?i[0]:i[1];l=this._getScaleFactor(o,e)}l*=this._symbolTextureRatio;const c=d(i[0]*l,i[1]*l),h=this.setGraphicElevationContext(t);return this.ensureDrapedStatus(\"on-the-ground\"===h.mode)&&this._setDrapingDependentMaterialParameters(),this.draped?this._createAsOverlay(t,s,r,a,n,c,e.layer.uid):this._createAs3DShape(t,s,r,a,n,c,h,t.uid)}layerOpacityChanged(){const e=this._getFillColor(),t=this._getOutlineColor();this._forEachMaterial((r=>{r.setParameters({color:e}),r.setParameters({outlineColor:t})}))}updateGeometry(e,t){if(this.draped||!this._validateGeometry(t))return!1;const{elevationContext:r,stageObject:i}=e;if(r.mode!==this.getGeometryElevationMode(t))return!1;const s=V(t);if(!s)return!1;const o=H(i,this._context,s,r);if(null==o)return!1;const a=k(this._context,s);return i.geometries[0].localOrigin===a&&(e.alignedSampledElevation=o,B(e,s,this._context.elevationProvider),!0)}layerElevationInfoChanged(e,t,r){const i=this._elevationContext.mode,s=T(he.elevationModeChangeTypes,r,i);if(s!==I.UPDATE)return s;const o=E(i)||\"absolute-height\"===i;return this.updateGraphics3DGraphicElevationInfo(e,t,(()=>o))}slicePlaneEnabledChanged(){return this.draped||this._forEachMaterial((e=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})})),!0}physicalBasedRenderingChanged(){return!0}get pixelRatioChanged(){return null!=this._getPrimitive()}applyRendererDiff(e,t){for(const r in e.diff){if(\"visualVariables\"!==r)return G.RecreateSymbol;if(!$(this._fastUpdates,t,this._fastVisualVariableConvertOptions()))return G.RecreateSymbol;this._materials[0]?.setParameters(this._fastUpdates.materialParameters)}return G.FastUpdate}prepareSymbolLayerPatch(e){if(this._patchTask?.abort(),\"partial\"!==e.diff.type)return;const t=e.diff.diff;this._preparePatchResource(e,t),this._preparePatchRotation(e,t)}_preparePatchResource(e,s){if(!s.resource||\"partial\"!==s.resource.type)return;const c=s.resource.diff;if(\"complete\"!==c?.href?.type)return;const h=c.href.newValue,{textures:m}=this._context.sharedResources;if(null==h||null==m||null!=de(h))return;const u=this._getIconSize(),d=u*this._context.graphicsCoreOwner.view.state.pixelRatio;e.symbolLayerStatePatches.push((()=>{this._patchTask=o(this._patchTask),this._patchTask=r((e=>this._context.schedule((async(e,r)=>{const s=await t(m.fromUrl(h,d,{signal:r}));l(r);const o=!s.ok;if(o&&n(s.error),this._textureHandle=a(this._textureHandle),this._patchTask=null,o){this._forEachMaterial((e=>{e.visible=!1,e.setParameters({textureId:null})}));const e=`Failed to load (Request for icon resource failed: ${h})`;return void this.logger.error(new i(\"graphics3diconsymbollayer:request-failed\",e))}this._textureHandle=s.value;const c=s.value.texture;this._size=_e(c,u),this._forEachMaterial((e=>{e.setParameters({textureId:c.id}),e.visible=!0}))}),e)))})),delete c.href}_preparePatchRotation(e,t){if(!t.angle||\"complete\"!==t.angle.type)return;const r=t.angle.newValue??0,i=0!==r||this._drivenProperties.rotation;e.symbolLayerStatePatches.push((()=>{this._forEachMaterial((e=>e.setParameters({rotation:r,hasRotation:i})))})),delete t.angle}_defaultElevationInfoNoZ(){return fe}_createAs3DShape(e,t,r,i,s,o,a,n){const l=this.getFastUpdateAttrValues(e),c=this._context.layer.uid,h=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:n,layerUid:c}),m=ee(r,se,null,i,s,o,ye,null,l,h),u=N(this._context,t,m,a,n);if(null==u)return null;const d=new U(this,u.object,[m],null,null,j,a);return d.alignedSampledElevation=u.sampledElevation,d.needsElevationUpdates=E(a.mode)||\"absolute-height\"===a.mode,d.getScreenSize=this._createScreenSizeGetter(o,l),d.calculateRelativeScreenBounds=e=>r.calculateRelativeScreenBounds(d.getScreenSize(),1,e),B(d,t,this._context.elevationProvider),d}_createAsOverlay(e,t,r,i,s,o,a){r.renderPriority=this._renderPriority;const n=_();g(t,n,this._context.overlaySR),n[2]=Y;const l=this._context.clippingExtent;if(null!=l&&!x(l,n))return null;const c=this.getFastUpdateAttrValues(e),h=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:e.uid,layerUid:this._context.layer.uid}),m=ee(r,se,n,i,s,o,null,null,c,h),u=new te(m,{layerUid:a,graphicUid:e.uid}),d=new D(this,[u],null,this._context.drapeSourceRenderer);return d.getScreenSize=this._createScreenSizeGetter(o,c),d.calculateRelativeScreenBounds=e=>r.calculateRelativeScreenBounds(d.getScreenSize(),1,e),d}_createScreenSizeGetter(e,t){const r=this._outlineSize+2;if(this._fastUpdates&&t){const i=e[0]/this._symbolTextureRatio,s=e[1]/this._symbolTextureRatio;return(e=p())=>{const[o,a]=q(ge,this._fastUpdates.materialParameters,t);return e[0]=o*i+r,e[1]=a*s+r,e}}const i=e[0]/this._symbolTextureRatio+r,s=e[1]/this._symbolTextureRatio+r;return(e=p())=>(e[0]=i,e[1]=s,e)}_fastVisualVariableConvertOptions(){const e=Math.max(this._size[0],this._size[1]),t=f(e,e,e),r=h(1),i=e*r,s=f(i,i,i);return new J({size:!0,color:!0,rotation:!0,opacity:!1},t,s,r)}_forEachMaterial(e){this._materials.forEach(e),this._cimSymbolMaterials.forEach(e)}test(){return{...super.test(),material:this._materials[0]}}}function me(e){return e&&\"point-3d\"===e.type&&e.hasVisibleVerticalOffset()}function ue(e){return null!=e&&(\"cross\"===e||\"x\"===e)}function de(e){const t=u(e);return\"application/json\"===t?.mediaType?t.data:void 0}function pe(e,t){return\"relative\"===e?d((t.x||0)+.5,.5-(t.y||0)):e in A?A[e]:A.center}function _e({parameters:e},t){const r=(e.width??1)/(e.height??1);return r>1?[t,Math.round(t/r)]:[Math.round(t*r),t]}he.PRIMITIVE_SIZE=ce,he.elevationModeChangeTypes={definedChanged:I.UPDATE,staysOnTheGround:I.NONE,onTheGroundChanged:I.RECREATE};const fe={mode:\"relative-to-ground\",offset:0},ye=y(0,0,0,1),ge=_();export{he as Graphics3DIconSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import e from\"../../../../core/Error.js\";import{px2pt as t,pt2px as r}from\"../../../../core/screenUtils.js\";import{fromValues as i,clone as a}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{create as s,fromBuffer as n,intersectsClippingArea as o,empty as l,expandWithAABB as m,expandWithBuffer as h}from\"../../../../geometry/support/aaBoundingBox.js\";import{getDriverAxisSizeValueAny as p}from\"../../../../renderers/support/renderingInfoUtils.js\";import{sharedGeometryElevationAligner as c}from\"./ElevationAligners.js\";import{SymbolUpdateType as d,elevationModeChangeUpdateType as y,needsElevationUpdates2D as u}from\"./elevationAlignmentUtils.js\";import{Graphics3DDrapedGraphicLayer as _}from\"./Graphics3DDrapedGraphicLayer.js\";import{Graphics3DObject3DGraphicLayer as g}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as f}from\"./Graphics3DSymbolLayer.js\";import{ApplyRendererDiffResult as b}from\"./interfaces.js\";import{parseCapType as M,parseLineMarkerStyle as L}from\"./lineUtils.js\";import{initFastSymbolUpdatesState as E,updateFastSymbolUpdatesState as P,getAttributeValue as v,ConvertOptions as C}from\"../support/FastSymbolUpdates.js\";import{debugFlags as R}from\"../../support/debugFlags.js\";import{createGeometry as w}from\"../../support/engineContent/line.js\";import{geometryToRenderInfo as x,geometryToRenderInfoDraped as D}from\"../../support/renderInfoUtils/line.js\";import{Object3D as k}from\"../../webgl-engine/lib/Object3D.js\";import{RenderGeometry as j}from\"../../webgl-engine/lib/RenderGeometry.js\";import{LineMarkerMaterial as S}from\"../../webgl-engine/materials/LineMarkerMaterial.js\";import{getStipplePatternForLinePattern as A}from\"../../webgl-engine/materials/lineStippleUtils.js\";import{RibbonLineMaterial as U}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";import z from\"../../../../geometry/Extent.js\";import W from\"../../../../geometry/Polygon.js\";const G=[\"polyline\",\"polygon\",\"extent\"],O=new C({size:!0,color:!0,rotation:!1,opacity:!0});class V extends f{constructor(e,t,r,i){super(e,t,r,i)}async doLoad(){if(this._fastUpdates=E(this._context.renderer,O),!this._drivenProperties.size){if((null!=this.symbolLayer.size?this.symbolLayer.size:t(1))<0)throw new e(\"graphics3dlinesymbollayer:invalid-size\",\"Symbol sizes may not be negative values\")}}_getMaterialParameters(e,t=!1){const r=this._getCombinedOpacityAndColor(t&&this._markerColor||this._materialColor);this._patternHidesLine&&!t&&(r[3]=0);const i={width:this._computeMaterialWidth(this.symbolLayer?.size),color:r,hasPolygonOffset:!0,join:this.symbolLayer.join||\"miter\",cap:M(this.symbolLayer.cap||\"butt\"),hasSlicePlane:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:A(this.symbolLayer.pattern)};return this._fastUpdates?.visualVariables?{...i,...this._fastUpdates.materialParameters}:i}get _materialColor(){return this.symbolLayer.material?.color}get _markerColor(){return this.symbolLayer.marker?.color}get _lineMaterial(){return null==this._materials[H.Line]&&(this._materials[H.Line]=new U(this._getMaterialParameters(!1)),this._context.stage.add(this._materials[H.Line])),this._materials[H.Line]}get _ringMaterial(){return null==this._materials[H.Ring]&&(this._materials[H.Ring]=new U(this._getMaterialParameters(!0)),this._context.stage.add(this._materials[H.Ring])),this._materials[H.Ring]}get _wireframeLineMaterial(){return null==this._materials[H.LineWireframe]&&(this._materials[H.LineWireframe]=new U({...this._getMaterialParameters(!1),wireframe:!0}),this._context.stage.add(this._materials[H.LineWireframe])),this._materials[H.LineWireframe]}get _wireframeRingMaterial(){return null==this._materials[H.RingWireframe]&&(this._materials[H.RingWireframe]=new U({...this._getMaterialParameters(!0),wireframe:!0}),this._context.stage.add(this._materials[H.RingWireframe])),this._materials[H.RingWireframe]}get _markerMaterial(){return null==this._materials[H.Marker]&&null!=this.symbolLayer.marker&&(this._materials[H.Marker]=new S({...this._getMaterialParameters(!1,!0),placement:this.symbolLayer.marker.placement,markerPrimitive:L(this.symbolLayer.marker.style)}),this._context.stage.add(this._materials[H.Marker])),this._materials[H.Marker]}destroy(){super.destroy(),this._forEachMaterial((e=>this._context.stage.remove(e))),this._materials.length=0}_getDrivenSize(e){return this._drivenProperties.size&&e.size?r(p(e.size)):1}_getDrivenColor(e){const t=i(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,G,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t);return this.ensureDrapedStatus(\"on-the-ground\"===r.mode),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,r,t.uid)}applyRendererDiff(e,t){for(const r in e.diff){if(\"visualVariables\"!==r)return b.RecreateSymbol;{const e=this._fastUpdates;if(!P(e,t,O))return b.RecreateSymbol;this._forEachMaterial((t=>t?.setParameters(e.materialParameters)))}}return b.FastUpdate}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff,r={};\"complete\"===t.size?.type&&(r.width=this._computeMaterialWidth(t.size.newValue),delete t.size),\"complete\"===t.cap?.type&&(r.cap=M(t.cap.newValue??\"butt\"),delete t.cap);const i=this._prepareMarkerPatch(e,t);this._prepareMaterialPatch(e,t,i),e.symbolLayerStatePatches.push((()=>this._forEachMaterial((e=>e?.setParameters(r)))))}layerOpacityChanged(){this._forEachMaterial(((e,t)=>this._updateMaterialLayerOpacity(e,t===H.Marker)))}_forEachMaterial(e){this._materials.forEach(e)}_updateMaterialLayerOpacity(e,t=!1){if(null==e)return;const r=e.parameters.color,a=this.symbolLayer?.material?.color,s=this._patternHidesLine&&!t?0:this._getCombinedOpacity(a),n=i(r[0],r[1],r[2],s);e.setParameters({color:n})}layerElevationInfoChanged(e,t,r){const i=this._elevationContext.mode,a=y(V.elevationModeChangeTypes,r,i);if(a!==d.UPDATE)return a;const s=u(i);return this.updateGraphics3DGraphicElevationInfo(e,t,(()=>s))}slicePlaneEnabledChanged(){const e={hasSlicePlane:this._context.slicePlaneEnabled};return this._forEachMaterial((t=>t?.setParameters(e))),!0}physicalBasedRenderingChanged(){return!0}_createAs3DShape(e,t,r){const i=I(e.graphic.geometry),a=\"polygon\"===i.type?i.rings:i.paths,l=new Array,m=s(),h=x(i,this._context.elevationProvider,this._context.renderCoordsHelper,t),p=\"polygon\"===i.type?\"rings\":\"paths\";this._logGeometryCreationWarnings(h,a,p,\"LineSymbol3DLayer\");for(let s=0;s<h.lines.length;s++){const t=h.lines[s],a=t.position,p=t.mapPositions;if(null!=this._context.clippingExtent&&(n(p,m),!o(m,this._context.clippingExtent)))continue;const c=this._createGeometry(\"polygon\"===i.type?this._ringMaterial:this._lineMaterial,e,a,p,i.type,F.ELEVATED,r);l.push(c),R.LINE_WIREFRAMES&&l.push(c.instantiate({material:\"polygon\"===i.type?this._wireframeRingMaterial:this._wireframeLineMaterial})),null!=this._markerMaterial&&l.push(c.instantiate({material:this._markerMaterial}))}if(0===l.length)return null;const d=new k({geometries:l,castShadow:!1,layerUid:this._context.layer.uid,graphicUid:r}),y=new g(this,d,l,null,null,c,t);return y.alignedSampledElevation=h.sampledElevation,y.needsElevationUpdates=u(t.mode),y}_createGeometry(e,t,r,i,a,s,n){const o=s===F.DRAPED?{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper}:null,l=\"polygon\"===a,m=this._fastUpdates?.visualVariables.color,h=this._fastUpdates?.visualVariables.size,p=this._fastUpdates?.visualVariables.opacity,c=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),d={position:r,size:h?null:this._getDrivenSize(t.renderingInfo),color:m?null:this._getDrivenColor(t.renderingInfo),sizeFeature:h?v(h.field,t.graphic):null,colorFeature:m?v(m.field,t.graphic):null,opacityFeature:p?v(p.field,t.graphic):null};return w(e,{overlayInfo:o,removeDuplicateStartEnd:l,mapPositions:i,attributeData:d},c)}_createAsOverlay(e,t){const r=e.graphic,i=I(r.geometry),a=\"polygon\"===i.type?i.rings:i.paths,p=\"polygon\"===i.type?this._ringMaterial:this._lineMaterial;p.renderPriority=this._renderPriority;const c=R.LINE_WIREFRAMES?\"polygon\"===i.type?this._wireframeRingMaterial:this._wireframeLineMaterial:null,d=this._markerMaterial;null!=c&&(c.renderPriority=this._renderPriority-.001),null!=d&&(d.renderPriority=this._renderPriority-.002);const y=new Array,u=s(),g=l(),f=D(i,this._context.overlaySR),b=\"polygon\"===i.type?\"rings\":\"paths\";this._logGeometryCreationWarnings(f,a,b,\"LineSymbol3DLayer\");for(const s of f.lines){if(n(s.position,u),!o(u,this._context.clippingExtent))continue;m(g,u);const a=a=>{const n=this._createGeometry(a,e,s.position,void 0,i.type,F.DRAPED,r.uid),o=new j(n,{layerUid:t,graphicUid:r.uid});y.push(o)};if(null!=d){a(d);const e=this.symbolLayer.marker.placement;\"begin\"!==e&&\"begin-end\"!==e||h(u,s.position,0,1),\"end\"!==e&&\"begin-end\"!==e||h(u,s.position,s.position.length-3,1)}a(p),R.LINE_WIREFRAMES&&a(c)}return new _(this,y,g,this._context.drapeSourceRenderer)}get _patternHidesLine(){const e=this.symbolLayer.pattern;return null!=e&&\"style\"===e.type&&\"none\"===e.style}_computeMaterialWidth(e){return e=e??t(1),this._drivenProperties.size?this._fastUpdates?.visualVariables.size?r(1):1:r(e)}_prepareMaterialPatch(e,t,r){const i=t.material;if(null==i)return void(r.changed&&r.useMaterialColor&&T(this._getCombinedOpacityAndColor(this._materialColor),this._materials[H.Marker],e));if(\"collection\"===i.type)return;const s=\"complete\"===i.type?i.newValue?.color:\"complete\"===i.diff.color?.type?i.diff.color.newValue:null,n=this._getCombinedOpacityAndColor(s);r.useMaterialColor&&T(a(n),this._materials[H.Marker],e),this._patternHidesLine&&(n[3]=0),T(n,this._materials[H.Line],e),delete t.material}_prepareMarkerPatch(e,t){const r=t.marker,i=this._markerMaterial;if(null==r||\"partial\"!==r.type||null==r.diff||null!=r.diff.placement||null!=r.diff.style&&\"complete\"!==r.diff.style.type||null!=r.diff.color&&\"complete\"!==r.diff.color.type||null==i)return{changed:!1,useMaterialColor:null==this._markerColor};const a=r.diff.color,s=null!=a,n=s?a.newValue:null,o=null==n&&null==this._markerColor;n&&T(this._getCombinedOpacityAndColor(n),i,e);const l=r.diff.style?.newValue;return l&&e.symbolLayerStatePatches.push((()=>i.setParameters({markerPrimitive:L(l)}))),delete t.marker,{changed:s,useMaterialColor:o}}}function I(e){switch(e.type){case\"extent\":if(e instanceof z)return W.fromExtent(e);break;case\"polygon\":case\"polyline\":return e}return null}function T(e,t,r){null!=t&&r.symbolLayerStatePatches.push((()=>t.setParameters({color:e})))}var F,H;V.elevationModeChangeTypes={definedChanged:d.RECREATE,staysOnTheGround:d.NONE,onTheGroundChanged:d.RECREATE},function(e){e[e.DRAPED=0]=\"DRAPED\",e[e.ELEVATED=1]=\"ELEVATED\"}(F||(F={})),function(e){e[e.Line=0]=\"Line\",e[e.Ring=1]=\"Ring\",e[e.LineWireframe=2]=\"LineWireframe\",e[e.RingWireframe=3]=\"RingWireframe\",e[e.Marker=4]=\"Marker\"}(H||(H={}));export{V as Graphics3DLineSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{t,i}from\"../../../../chunks/vec32.js\";import{create as n}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as s,expandWithVec3 as a,create as o,isPoint as r,center as h,offset as l}from\"../../../../geometry/support/aaBoundingBox.js\";import{evaluateElevationInfoAtPoint as c}from\"./elevationAlignmentUtils.js\";import{setContextFeature as g}from\"./featureExpressionInfoUtils.js\";import{demResolutionForBoundingBox as d}from\"./graphicUtils.js\";import{Object3DState as m}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Object3DHighlightStateID as p}from\"../../webgl-engine/lib/Object3DStateID.js\";class u{constructor(e,t,i,n){this.graphics3DSymbolLayer=e,this.instanceIndex=t,this.elevationAligner=i,this.elevationContext=n,this.type=\"lod-instance\",this._highlights=new Set,this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}initialize(){}setVisibility(e){const{instanceData:t}=this;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}destroy(){null!=this.instanceIndex&&(this.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}alignWithElevation(e,t,i){if(this.elevationAligner){g(this.elevationContext.featureExpressionInfoContext,i);const n=(i,n)=>c(i,e,this.elevationContext,t,n),s=this.elevationAligner(this,this.elevationContext,e.spatialReference,n,t);null!=s&&(this.alignedSampledElevation=s)}}getCenterObjectSpace(e=n()){return this.instanceData.getCombinedLocalTransform(this.instanceIndex,I),t(e,this._lodRenderer.baseBoundingSphere.center,I)}getBoundingBoxObjectSpace(e=o()){this.instanceData.getCombinedLocalTransform(this.instanceIndex,I);const n=this._lodRenderer.baseBoundingBox;s(e);for(let s=0;s<8;++s)i(x,1&s?n[3]:n[0],2&s?n[4]:n[1],4&s?n[5]:n[2]),t(x,x,I),a(e,x);return e}computeAttachmentOrigin(e){this.instanceData.getGlobalTransform(this.instanceIndex,I),e.render.origin[0]+=I[12],e.render.origin[1]+=I[13],e.render.origin[2]+=I[14],e.render.num++}async getProjectedBoundingBox(e,i,n,a,o){const c=this.getBoundingBoxObjectSpace(o),g=v,m=r(c)?1:g.length;this.instanceData.getGlobalTransform(this.instanceIndex,I);for(let s=0;s<m;s++){const e=g[s];x[0]=c[e[0]],x[1]=c[e[1]],x[2]=c[e[2]],t(x,x,I),f[3*s]=x[0],f[3*s+1]=x[1],f[3*s+2]=x[2]}if(!e(f,0,m))return null;s(c);let p=null;this.calculateRelativeScreenBounds&&(p=this.calculateRelativeScreenBounds());for(let t=0;t<3*m;t+=3){for(let e=0;e<3;e++)c[e]=Math.min(c[e],f[t+e]),c[e+3]=Math.max(c[e+3],f[t+e]);p&&n.push({location:f.slice(t,t+3),screenSpaceBoundingRect:p})}if(i&&(h(c,b),\"absolute-height\"!==this.elevationContext.mode)){let e;const t=d(c,i.service.spatialReference,i);try{e=await i.service.queryElevation(b[0],b[1],a,t,\"ground\")}catch(u){}null!=e&&l(c,0,0,-this.alignedSampledElevation+e)}return c}addObjectState(e){e.stateType===m.Highlight&&this.addObjectHighlightState(e)}addObjectHighlightState(e){const t=new p(e.highlightGroupName);this._addHighlightId(t),e.addExternal((e=>{this._removeHighlightId(e)}),t)}removeObjectState(e){this._highlights.forEach((t=>e.remove(t)))}_addHighlightId(e){this._highlights.add(e),this.instanceData.setHighlight(this.instanceIndex,!0,e.highlightGroupName)}_removeHighlightId(e){this._highlights.delete(e),this.instanceData.setHighlight(this.instanceIndex,this._highlights.size>0,e.highlightGroupName)}get _lodRenderer(){return this.graphics3DSymbolLayer.lodRenderer}get instanceData(){return this._lodRenderer.instanceData}}const f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],x=n(),b=n(),v=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],I=e();export{u as Graphics3DLodInstanceGraphicLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import\"../../../../core/has.js\";import{deg2rad as t}from\"../../../../core/mathUtils.js\";import{normalFromMat4 as r,fromMat4 as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as n}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{fromTranslation as a,multiply as s,invert as i,getTranslation as l}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as c,IDENTITY as u,clone as m}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{ONES as f}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as p,g as h,h as d,t as g,q as x,n as _,b as T,f as b,d as y,e as v}from\"../../../../chunks/vec32.js\";import{ZEROS as w,ONES as R,create as M}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ONES as j}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{canProjectWithoutEngine as A}from\"../../../../geometry/projection.js\";import{computeTranslationToOriginAndRotation as C}from\"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";import{projectBuffer as P}from\"../../../../geometry/projection/projectBuffer.js\";import{projectVectorToPoint as E}from\"../../../../geometry/projection/projectVectorToPoint.js\";import{create as O,fromBuffer as I,intersectsClippingArea as N}from\"../../../../geometry/support/aaBoundingBox.js\";import{newFloatArray as S}from\"../../../../geometry/support/FloatArray.js\";import{getZeroIndexArray as U,getContinuousIndexArray as B}from\"../../../../geometry/support/Indices.js\";import F from\"../../../../geometry/support/MeshComponent.js\";import D from\"../../../../geometry/support/MeshMaterialMetallicRoughness.js\";import G from\"../../../../geometry/support/MeshTextureTransform.js\";import{isRelativeVertexSpace as L,isAbsoluteVertexSpace as V}from\"../../../../geometry/support/meshVertexSpaceUtils.js\";import{equals as $,isPlateCarree as H}from\"../../../../geometry/support/spatialReferenceUtils.js\";import{t as k}from\"../../../../chunks/vec3.js\";import{transformNormal as q,transformVectorENUPlateCarree as z,VectorType as W,transformVectorWMPlateCarree as Y,projectNormalToPCPF as J,transformTangent as K,projectTangentToPCPF as Q}from\"../../../../geometry/support/meshUtils/projection.js\";import{projectMeshVertexPositions as X}from\"../../../../geometry/support/meshUtils/projectMeshVertexPositions.js\";import{makeDehydratedPoint as Z}from\"../../../../layers/graphics/dehydratedPoint.js\";import{MeshTransformUpdateAction as ee}from\"../../../../layers/graphics/sources/interfaces.js\";import{ViewingMode as te}from\"../../../ViewingMode.js\";import{isEncodedMeshTexture as re}from\"../../glTF/internal/resourceUtils.js\";import{getTransformMatrix as oe}from\"../../glTF/internal/TextureTransformUtils.js\";import{perObjectElevationAligner as ne}from\"./ElevationAligners.js\";import{needsElevationUpdates3D as ae,evaluateElevationInfoAtPoint as se}from\"./elevationAlignmentUtils.js\";import{Graphics3DMeshObject3DGraphicLayer as ie}from\"./Graphics3DMeshObject3DGraphicLayer.js\";import{Object3DEdgeState as le}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as ce}from\"./Graphics3DSymbolLayer.js\";import{MaterialInfoCache as ue,MeshFastUpdateProcessor as me}from\"./MeshFastUpdateProcessor.js\";import{createMaterial as fe}from\"../support/edgeUtils.js\";import{parseColorMixMode as pe,encodeSymbolColor as he}from\"../support/symbolColorUtils.js\";import{debugFlags as de}from\"../../support/debugFlags.js\";import{Attribute as ge}from\"../../webgl-engine/lib/Attribute.js\";import{AlphaDiscardMode as xe,CullFaceOptions as _e}from\"../../webgl-engine/lib/basicInterfaces.js\";import{ContentObjectType as Te}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as be}from\"../../webgl-engine/lib/Geometry.js\";import{Object3D as ye}from\"../../webgl-engine/lib/Object3D.js\";import{Texture as ve}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as we}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as Re}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{NativeLineMaterial as Me}from\"../../webgl-engine/materials/NativeLineMaterial.js\";import{useSchematicPBR as je,advancedMRRFactors as Ae,schematicMRRFactors as Ce}from\"../../webgl-engine/materials/pbrUtils.js\";import{TextureWrapMode as Pe}from\"../../../webgl/enums.js\";const Ee=[\"mesh\"];class Oe extends ce{constructor(e,t,r,o){super(e,t,r,o),this._materialInfoCache=new ue,this._fastUpdateProcessor=new me,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){de.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new Me({color:[1,0,1,1]}),this._debugTangentNormalMaterial=new Me({color:[1,.5,0,1]}),this._debugFaceNormalMaterial=new Me({color:[0,1,1,1]}))}destroy(){super.destroy(),this._textures.forEach((e=>e.unload())),this._context.stage.removeMany(this._materialInfoCache.materials),this._context.stage.removeMany(Array.from(this._textures.values())),this._materialInfoCache.clear(),this._textures.clear(),this._fastUpdateProcessor.destroy(this._context.stage)}get materials(){return this._materialInfoCache.materials}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Ee,\"fill on mesh-3d\"))return null;const r=this.setGraphicElevationContext(t),o=e.renderingInfo;return this._createAs3DShape(t,o,r,t.uid)}onRemoveGraphic(e){this._fastUpdateProcessor.onRemoveGraphic(e,this._materialInfoCache,this._context)}layerOpacityChanged(e,t){const r=this._getLayerOpacity();this._updateMaterialParameters((e=>{e.material.setParameters({layerOpacity:r});const t=e.material.parameters;this._setMaterialTransparentParameter(t,e),e.material.setParameters({transparent:t.transparent})})),e.forEach((e=>t(e)?.layerOpacityChanged(r,this._context.isAsync)))}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,ae)}slicePlaneEnabledChanged(e,t){return this._updateMaterialParameters((({material:e})=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})})),e.forEach((e=>t(e)?.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync))),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._updateMaterialParameters((({material:t})=>t.setParameters({usePBR:e}))),!0}updateTransform(e,t,r,o){if(!e.fastTransformUpdatesAllowed)return!1;const n=e.fastTransformUpdatesEnabled;switch(o){case ee.EnableFastUpdates:if(n)return!0;break;case ee.DisableFastUpdates:if(!n)return!0;break;default:if(!n)return!!this.updateTransform(e,t,r,ee.EnableFastUpdates)&&(e.autoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,ee.DisableFastUpdates))),!0)}const a=this._context.renderCoordsHelper.spatialReference,s=ot,{origin:i,transform:l}=r;if(!C(t,p(Xe,i.x,i.y,i.z??0),s,a))return!1;switch(o){case ee.EnableFastUpdates:this._fastUpdateProcessor.enable(e,this._materialInfoCache,this._context);break;case ee.DisableFastUpdates:this._fastUpdateProcessor.disable(e,this._materialInfoCache,this._context);break;case ee.UpdateFastLocalOrigin:e.updateFastLocalOrigin(s,l,this._context.localOriginFactory)}const{elevationContext:c}=e;c.centerPointInElevationSR=this._getCenterPointInElevationSR(s);const{elevationProvider:u,renderCoordsHelper:m}=this._context,f=(e,t)=>se(e,u,c,m,t);return e.alignedSampledElevation=ne(e,c,u.spatialReference,f,m,s),e.updateTransform(s,l,this._context.isAsync),e.updateAutoDisableFastTransformUpdates((()=>this.updateTransform(e,t,r,ee.DisableFastUpdates))),!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_materialPropertiesDefault(e,t){const r=this._requiresSymbolVertexColors(),o=!!e.vertexAttributes.color,n=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:r,hasVertexColors:o,hasVertexTangents:n,uid:`vc:${o},vt:${n},vct${t},svc:${r}`}}_materialProperties(e,t,r){const o=this._materialPropertiesDefault(e,r);if(!t.material)return o;const{color:n,colorTexture:a,colorTextureTransform:s,normalTexture:i,normalTextureTransform:l,doubleSided:c,alphaCutoff:u,alphaMode:m}=t.material,f=We(n),p=We(a),h=Ye(s),d=We(i),g=Ye(l);if(o.color=n,o.colorTexture=a,o.normalTexture=i,o.uid=`${o.uid},cmuid:${f},ctmuid:${p},cttuid:${h},ntmuid:${d},nttuid:${g},ds:${c},ac:${u},am:${m}`,t.material instanceof D){const{metallic:e,roughness:r,metallicRoughnessTexture:n,metallicRoughnessTextureTransform:a,emissiveColor:i,emissiveTexture:c,emissiveTextureTransform:u,occlusionTexture:m,occlusionTextureTransform:f}=t.material,p=We(n),h=Ye(a),d=We(i),g=We(c),x=Ye(u),_=We(m),T=Ye(f);o.metallic=e,o.roughness=r,o.metallicRoughnessTexture=n,o.emissiveColor=i,o.emissiveTexture=c,o.occlusionTexture=m,o.colorTextureTransform=Ve(s),o.normalTextureTransform=Ve(l),o.emissiveTextureTransform=Ve(u),o.occlusionTextureTransform=Ve(f),o.metallicRoughnessTextureTransform=Ve(a),o.uid=`${o.uid},mrm:${e},mrr:${r},mrt:${p},mrtt:${h},emuid:${d},etmuid:${g},ett:${x},otmuid:${_},ott:${T}`}return o}_getInternalTextureId(e){const t=this._getInternalTexture(e,xe.Opaque);return t?.id}_getInternalTexture(e,t){const r=ze(e);if(!r)return null;const o=`${e.contentHash}/${t}`;let n=this._textures.get(o);if(!n){let a=null;const s=this._context.stage.renderView.renderingContext.parameters.maxMaxAnisotropy,i={wrap:$e(e.wrap),noUnpackFlip:!0,maxAnisotropy:s,mipmap:s>1};re(r)?(a=r.data,i.preMultiplyAlpha=!1,i.encoding=r.encoding):(a=r,i.preMultiplyAlpha=t!==xe.Opaque,i.downsampleUncompressed=this._context.graphicsCoreOwner.view.qualitySettings.graphics3D.uncompressedTextureDownsamplingEnabled),n=new ve(a,i),this._textures.set(o,n),n.load(this._context.stage.renderView.renderingContext),this._context.stage.add(n),n.events.on(\"unloaded\",(()=>{this._textures.delete(o)}))}return n}_setInternalMaterialTextureParameters(t,r){if(null!=t.colorTexture){const e=this._getInternalTexture(t.colorTexture,r.textureAlphaMode);e?(r.textureId=e.id,r.textureAlphaPremultiplied=!!e.parameters.preMultiplyAlpha):r.textureId=void 0}t.normalTexture&&(r.normalTextureId=this._getInternalTextureId(t.normalTexture)),t.emissiveColor&&(r.emissiveFactor=e.toUnitRGB(t.emissiveColor)),t.emissiveTexture&&(r.emissiveTextureId=this._getInternalTextureId(t.emissiveTexture)),t.occlusionTexture&&(r.occlusionTextureId=this._getInternalTextureId(t.occlusionTexture)),t.metallicRoughnessTexture&&(r.metallicRoughnessTextureId=this._getInternalTextureId(t.metallicRoughnessTexture))}_setInternalMaterialParameters(e,t){null!=e.color&&qe(e.color,t),this._setInternalMaterialTextureParameters(e,t),t.colorTextureTransformMatrix=oe(e.colorTextureTransform),t.normalTextureTransformMatrix=oe(e.normalTextureTransform);const r=null!=e.normalTextureTransform?.scale?e.normalTextureTransform?.scale:f;t.scale=[r[0],r[1]],t.occlusionTextureTransformMatrix=oe(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=oe(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=oe(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(t){const r=this._drivenProperties.color;let o=this.symbolLayer.material?.colorMixMode??null;if(r)t.externalColor=j;else{const r=this.symbolLayer.material?.color??null;r?t.externalColor=e.toUnitRGBA(r):(o=null,t.externalColor=j)}o&&(t.colorMixMode=o),t.castShadows=!!this.symbolLayer.castShadows}_getOrCreateMaterial(t,r){const o=r.material?.color,n=r.material?.colorTexture,a=r.material?.alphaMode,s=\"blend\"===a,i=!(\"opaque\"===a)&&(ke(t)||null!=o&&o.a<1||n?.transparent||s),l=this._materialProperties(t,r,i),c=this._materialInfoCache.byUid(l.uid);if(c)return this._setInternalMaterialTextureParameters(l,c.material.parameters),c.material;const u={uid:l.uid,material:null,isComponentTransparent:i,alphaMode:r.material?r.material.alphaMode:\"opaque\"},m=je({normalTexture:l.normalTexture,metallicRoughnessTexture:l.metallicRoughnessTexture,metallicFactor:l.metallic,roughnessFactor:l.roughness,emissiveTexture:l.emissiveTexture,emissiveFactor:e.toUnitRGB(l.emissiveColor),occlusionTexture:l.occlusionTexture}),f={usePBR:this._usePBR(),isSchematic:m,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:w,diffuse:R,opacity:1,doubleSided:!0,doubleSidedType:\"winding-order\",cullFace:_e.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled,initTextureTransparent:!0};f.mrrFactors=m?Ce:[l.metallic,l.roughness,Ae[2]],r.material&&(f.doubleSided=r.material.doubleSided,f.cullFace=r.material.doubleSided?_e.None:_e.Back,f.textureAlphaCutoff=r.material.alphaCutoff),this._setExternalMaterialParameters(f),this._setMaterialTransparentParameter(f,u),this._setInternalMaterialParameters(l,f);const p=new Re(f,this._context);return u.material=p,this._materialInfoCache.set(l.uid,u),this._context.stage.add(p),p}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,\"auto\"===t.alphaMode?e.textureAlphaMode=e.transparent?xe.MaskBlend:xe.Opaque:e.textureAlphaMode=\"opaque\"===t.alphaMode?xe.Opaque:\"mask\"===t.alphaMode?xe.Mask:xe.Blend}_createFaceDebugNormals(e,t){const o=t.length,a=e.spatialReference.isGeographic?20015077/180:1,s=.1*Math.max(e.extent.width*a,e.extent.height*a,e.extent.zmax-e.extent.zmin),i=[],l=[],c=t[0].transformation,u=r(n(),c);for(let r=0;r<o;r++){const e=t[r].attributes.get(we.POSITION);if(!e)continue;const o=e.data,n=e.indices;for(let t=0;t<n.length;t+=3)Ge(o,n,t,tt),De(o,n,t,Xe,Ze,et),h(Xe,Xe,Ze),h(Xe,Xe,et),d(Xe,Xe,1/3),g(Xe,Xe,c),i.push(...Xe),x(tt,tt,u),_(tt,tt),T(Xe,Xe,tt,s),i.push(...Xe),l.push(l.length),l.push(l.length)}return i.length?new be(this._debugFaceNormalMaterial,[[we.POSITION,new ge(i,l,3,!0)]],null,Te.Line):null}_createPerVertexDebugVectors(e,t,a,s,i){const l=t.length,c=e.spatialReference.isGeographic?20015077/180:1,u=.1*i*Math.max(e.extent.width*c,e.extent.height*c,e.extent.zmax-e.extent.zmin),m=[],f=[],h=t[0].transformation,d=r(n(),h);a===we.TANGENT&&o(d,h);for(let r=0;r<l;r++){const e=t[r],o=e.attributes.get(we.POSITION),n=e.attributes.get(a);if(!o||!n)continue;const s=o.data,i=o.indices,l=n.data,c=n.indices;for(let t=0;t<i.length;t++){const e=3*i[t],r=c[t]*n.stride;p(Xe,s[e+0],s[e+1],s[e+2]),g(Xe,Xe,h),m.push(...Xe),p(Ze,l[r+0],l[r+1],l[r+2]),x(Ze,Ze,d),_(Ze,Ze),T(Xe,Xe,Ze,u),m.push(...Xe),f.push(f.length),f.push(f.length)}}return m.length?new be(s,[[we.POSITION,new ge(m,f,3,!0)]],null,Te.Line):null}_createAs3DShape(e,t,r,o){const n=e.geometry;if(\"mesh\"!==n.type)return null;const a=this._createGeometryInfo(n,t,o);if(null==a)return null;const{geometries:s,objectTransformation:i}=a;if(de.DRAW_MESH_GEOMETRY_NORMALS){const e=this._createPerVertexDebugVectors(n,s,we.NORMAL,this._debugVertexNormalMaterial,1),t=this._createPerVertexDebugVectors(n,s,we.TANGENT,this._debugTangentNormalMaterial,.5),r=this._createFaceDebugNormals(n,s);e&&s.push(e),t&&s.push(t),r&&s.push(r)}const l=new ye({geometries:s,layerUid:this._context.layer.uid,graphicUid:o,isElevationSource:!0});l.transformation=i;const c=fe(this.symbolLayer,{opacity:this._getLayerOpacity()}),u=c?new le(s[0].material,c,this._context.slicePlaneEnabled):null,m=new ie(this,l,s,null,null,ne,r,u);this._fastUpdateProcessor.onAddGraphic(),m.needsElevationUpdates=ae(r.mode),m.useObjectOriginAsAttachmentOrigin=!0,m.fastTransformUpdatesAllowed=this._fastTransformUpdatesAllowed(n),r.centerPointInElevationSR=this._getCenterPointInElevationSR(l.transformation);const{elevationProvider:f,renderCoordsHelper:p}=this._context,h=(e,t)=>se(e,f,r,p,t);return m.alignedSampledElevation=ne(m,r,f.spatialReference,h,p),m}_fastTransformUpdatesAllowed(e){const{vertexSpace:t,spatialReference:r}=e;if(!L(t))return!1;const{type:o}=t,{view:n}=this._context.graphicsCoreOwner,{viewingMode:a}=n.state,s=n.spatialReference;return a===te.Global&&\"local\"===o||a===te.Local&&$(s,r)&&\"georeferenced\"===o&&!r.isGeographic}_getCenterPointInElevationSR(e){const t=Z(0,0,0,null!=this._context.elevationProvider.spatialReference?this._context.elevationProvider.spatialReference:null);return E([e[12],e[13],e[14]],this._context.renderCoordsHelper.spatialReference,t),t}_passthroughReprojectionInfo(e){return e.reprojection===st.NONE&&!!e.objectTransformation}_createPositionBuffer(e,t){const r=e.vertexAttributes.position;let o=r,n=null;if(t.reprojection===st.NONE)return{position:o,georeferencedPositionBuffer:n};const a=t.reprojection===st.RENDER?t.transformBeforeProject:null;a&&(o=k(new Float64Array(o.length),o,a));const{normal:s,tangent:i}=e.vertexAttributes;this._passthroughReprojectionInfo(t)||!s&&!i||(n=o);const l=o===r||o===n?new Float64Array(o.length):o;return P(o,e.spatialReference,0,l,this._context.renderCoordsHelper.spatialReference,0),{position:l,georeferencedPositionBuffer:n}}_createNormalBuffer(e,t,r,o){const n=e.vertexAttributes.normal;if(null==n)return null;let a=n;const s=o.reprojection===st.RENDER?o.transformBeforeProject:null;s&&(a=q(a,new Float32Array(a.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===st.NONE)return a;if(\"local\"===i){if(!H(this._context.renderCoordsHelper.spatialReference))return a;if(null==r)return null;if(e.spatialReference.isGeographic){const e=a===n?new Float32Array(a.length):a;return z(a,W.NORMAL,r,e)}if(e.spatialReference.isWebMercator){const e=a===n?new Float32Array(a.length):a;return Y(a,W.NORMAL,r,e)}return a}if(null==r)return null;const l=a===n?new Float32Array(a.length):a,c=this._context.renderCoordsHelper.spatialReference;return J(a,r,e.spatialReference,t,c,l)}_createTangentBuffer(e,t,r,o){const n=e.vertexAttributes.tangent;if(null==n)return null;let a=n;const s=o.reprojection===st.RENDER?o.transformBeforeProject:null;s&&(a=K(a,new Float32Array(a.length),s));const i=this._context.graphicsCoreOwner.view.viewingMode;if(o.reprojection===st.NONE)return a;if(\"local\"===i){if(!H(this._context.renderCoordsHelper.spatialReference))return a;if(null==r)return null;if(e.spatialReference.isGeographic){const e=a===n?new Float32Array(a.length):a;return z(a,W.TANGENT,r,e)}if(e.spatialReference.isWebMercator){const e=a===n?new Float32Array(a.length):a;return Y(a,W.TANGENT,r,e)}return a}if(null==r)return null;const l=a===n?new Float32Array(a.length):a,c=this._context.renderCoordsHelper.spatialReference;return Q(a,r,e.spatialReference,t,c,l)}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),r=pe(this.symbolLayer?.material?.colorMixMode),o=new Uint8Array(4);return he(t,r,o),o}return null}_createBuffers(e,t){const r=e.vertexAttributes&&e.vertexAttributes.position;if(!r)return this.logger.warn(\"Mesh geometry must contain position vertex attributes\"),null;const o=e.vertexAttributes.normal,n=e.vertexAttributes.uv,a=e.vertexAttributes.tangent;if(o&&o.length!==r.length)return this.logger.warn(\"Mesh normal vertex buffer must contain the same number of elements as the position buffer\"),null;if(a&&a.length/4!=r.length/3)return this.logger.warn(\"Mesh tangent vertex buffer must contain the same number of elements as the position buffer\"),null;if(n&&n.length/2!=r.length/3)return this.logger.warn(\"Mesh uv vertex buffer must contain the same number of elements as the position buffer\"),null;const s=this._computeReprojectionInfo(e),{position:i,georeferencedPositionBuffer:l}=this._createPositionBuffer(e,s),u=Je(e),m=this._createSymbolColorBuffer(t),f=this._createNormalBuffer(e,i,l,s),p=this._createTangentBuffer(e,i,l,s),h=n,{transformation:d,position:g,normal:x,tangent:_}=this._passthroughReprojectionInfo(s)?{transformation:s.objectTransformation,position:i,normal:f,tangent:p}:this._transformOriginLocal(e,i,f,p);return{positionBuffer:g,normalBuffer:x,tangentBuffer:_,uvBuffer:h,colorBuffer:u,symbolColorBuffer:m,objectTransformation:d,geometryTransformation:s.reprojection===st.NONE&&s.geometryTransformation?s.geometryTransformation:c()}}_computeReprojectionInfo(e){const{vertexSpace:t}=e,r=\"georeferenced\"===t.type?$(this._context.renderCoordsHelper.spatialReference,e.spatialReference)?st.NONE:st.RENDER:st.NONE;if(V(t))return{reprojection:r};const o=t.origin,n=c(),i=e.transform?.localMatrix??u;if(r===st.NONE){C(e.spatialReference,o,n,this._context.renderCoordsHelper.spatialReference);return{reprojection:r,objectTransformation:n,geometryTransformation:m(i)}}const l=a(c(),o);return s(l,l,i),{reprojection:r,transformBeforeProject:l}}_transformOriginLocal(e,t,r,o){const n=this._context.renderCoordsHelper.spatialReference,a=e.origin;Qe[0]=a.x,Qe[1]=a.y,Qe[2]=a.z??0;const s=c();C(e.spatialReference,Qe,s,n),i(rt,s);const{position:l,normal:u,tangent:m}=e.vertexAttributes,f=t===l?new Float64Array(t.length):t;k(f,t,rt);const p=r?r===u?new Float32Array(r.length):r:null,h=o?o===m?new Float32Array(o.length):o:null;return r&&p&&q(r,p,rt),o&&h&&K(o,h,rt),{transformation:s,position:f,normal:p,tangent:h}}_validateFaces(e,t){const r=e.vertexAttributes.position.length/3,o=t.faces;if(o){let e=-1;for(let t=0;t<o.length;t++){const r=o[t];r>e&&(e=r)}if(r<=e)return this.logger.warn(`Vertex index ${e} is out of bounds of the mesh position buffer`),!1}else if(r%3!=0)return this.logger.warn(\"Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)\"),!1;return!0}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes?.position;if(!t)return!1;const r=this._context.elevationProvider.spatialReference,o=X(e,r??e.spatialReference);return!!o&&(I(o,nt),!N(nt,this._context.clippingExtent))}_createGeometryInfo(e,t,r){if(!A(e.spatialReference,this._context.renderCoordsHelper.spatialReference))return this.logger.warn(\"Geometry spatial reference is not compatible with the view\"),null;if(!this._validateVertexSpace(e))return null;if(this._isOutsideClippingArea(e))return null;const o=this._createBuffers(e,t);if(null==o)return null;const{positionBuffer:n,uvBuffer:a,colorBuffer:s,symbolColorBuffer:i,normalBuffer:c,tangentBuffer:u,objectTransformation:m,geometryTransformation:f}=o,p=Le(e),h=new Array;let d=!1;const g=l(Xe,m),x=this._context.localOriginFactory.getOrigin(g);for(const l of p){if(!this._validateFaces(e,l))return null;const t=Ne(e,l);if(0===t.length)continue;const o=Se(n,c,l,t);o.didFlipNormals&&(d=!0);const m=[[we.POSITION,new ge(n,t,3,!0)],[we.NORMAL,new ge(o.normals,o.indices,3,!0)]];s&&m.push([we.COLOR,new ge(s,t,4,!0)]),i&&m.push([we.SYMBOLCOLOR,new ge(i,U(t.length),4,!0)]),a&&m.push([we.UV0,new ge(a,t,2,!0)]),u&&m.push([we.TANGENT,new ge(u,t,4,!0)]);const p=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),g=this._getOrCreateMaterial(e,l),_=new be(g,m,null,Te.Mesh,p);_.transformation=f,_.localOrigin=x,h.push(_)}return d&&this.logger.warn(\"Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals.\"),{geometries:h,objectTransformation:m}}_updateMaterialParameters(e){this._materialInfoCache.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachMaterialInfo(e),this._fastUpdateProcessor.forEachClonedMaterial(((e,t)=>{t.setParameters(e.parameters)}))}_validateVertexSpace(e){const{_context:{graphicsCoreOwner:{view:{state:{viewingMode:t}}}}}=this,{vertexSpace:r}=e;return t!==te.Local||\"local\"!==r.type||(this.logger.warn(\"Displaying a mesh with a local vertex space in a view in local viewing mode is not supported.\"),!1)}test(){return{...super.test(),materials:this._materialInfoCache.materials}}}class Ie{constructor(e,t,r){this.normals=e,this.indices=t,this.didFlipNormals=r}}function Ne(e,t){return t.faces??B(e.vertexAttributes.position.length/3)}function Se(e,t,r,o){switch(r.shading||\"flat\"){default:case\"source\":return Be(e,t,r,o);case\"flat\":return Ue(e,o);case\"smooth\":return Fe(e,o)}}function Ue(e,t){const r=S(t.length),o=new Array(3*t.length);for(let n=0;n<t.length;n+=3){const a=Ge(e,t,n,tt);for(let e=0;e<3;e++)r[n+e]=a[e],o[n+e]=n/3}return new Ie(r,o,!1)}function Be(e,t,r,o){if(null==t)return Ue(e,o);let n=!1;if(!r.trustSourceNormals)for(let a=0;a<o.length;a+=3){Ge(e,o,a,tt);for(let e=0;e<3;e++){const r=3*o[a+e];Xe[0]=t[r],Xe[1]=t[r+1],Xe[2]=t[r+2],b(tt,Xe)<0&&(t[r]=-t[r],t[r+1]=-t[r+1],t[r+2]=-t[r+2],n=!0)}}return new Ie(t,o,n)}function Fe(e,t){const r={};for(let a=0;a<t.length;a+=3){const o=Ge(e,t,a,tt);for(let e=0;e<3;e++){const n=t[a+e];let s=r[n];s||(s={normal:M(),count:0},r[n]=s),h(s.normal,s.normal,o),s.count++}}const o=S(3*t.length),n=new Array(3*t.length);for(let a=0;a<t.length;a++){const e=r[t[a]];1!==e.count&&(_(e.normal,e.normal),e.count=1);for(let t=0;t<3;t++)o[3*a+t]=e.normal[t];n[a]=a}return new Ie(o,n,!1)}function De(e,t,r,o,n,a){const s=3*t[r],i=3*t[r+1],l=3*t[r+2];o[0]=e[s],o[1]=e[s+1],o[2]=e[s+2],n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],a[0]=e[l],a[1]=e[l+1],a[2]=e[l+2]}function Ge(e,t,r,o){return De(e,t,r,Xe,Ze,et),y(Ze,Ze,Xe),y(et,et,Xe),v(Xe,Ze,et),_(o,Xe),o}function Le(e){return e.components??at}function Ve(e){if(!e)return null;const{scale:r,offset:o,rotation:n}=e;return{scale:r,offset:o,rotation:t(n)}}function $e(e=\"repeat\"){if(\"string\"==typeof e){const t=He(e);return{s:t,t}}return{s:He(e.horizontal),t:He(e.vertical)}}function He(e){switch(e){case\"clamp\":return Pe.CLAMP_TO_EDGE;case\"mirror\":return Pe.MIRRORED_REPEAT;default:return Pe.REPEAT}}function ke(e){const t=e.vertexAttributes.color;if(null==t)return!1;for(let r=3;r<t.length;r+=4)if(255!==t[r])return!0;return!1}function qe(t,r){r.diffuse=e.toUnitRGB(t),r.opacity=t.a}function ze(e){return e.data??e.url}function We(t){return null==t?\"-\":t instanceof e?t.toHex():t.contentHash}function Ye(e){const{offset:t,scale:r,rotation:o}=e??Ke;return`${t[0]},${t[1]},${o},${r[0]},${r[1]}`}function Je(e){return e.vertexAttributes.color}const Ke=new G,Qe=M(),Xe=M(),Ze=M(),et=M(),tt=M(),rt=c(),ot=c(),nt=O(),at=[new F];var st;!function(e){e[e.NONE=0]=\"NONE\",e[e.RENDER=1]=\"RENDER\"}(st||(st={}));export{Oe as Graphics3DMeshFillSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getTranslation as t,multiply as e,invert as a,copy as s,fromTranslation as r}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{IDENTITY as i,create as o}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{h as n}from\"../../../../chunks/vec32.js\";import{create as m}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{perObjectElevationAligner as l}from\"./ElevationAligners.js\";import{evaluateElevationInfoAtPoint as f}from\"./elevationAlignmentUtils.js\";import{setContextFeature as d}from\"./featureExpressionInfoUtils.js\";import{Graphics3DObject3DGraphicLayer as c}from\"./Graphics3DObject3DGraphicLayer.js\";import{meshAutoFastUpdateConstants as h}from\"./meshAutoFastUpdateConstants.js\";class p extends c{constructor(){super(...arguments),this.fastTransformUpdatesAllowed=!1,this._originalGeometries=[],this._fastTransformUpdatesEnabled=!1,this._autoDisableFastUpdatesTimeoutId=0}get fastTransformUpdatesEnabled(){return this._fastTransformUpdatesEnabled}destroy(){super.destroy(),this._cancelAutoDisableFastUpdates()}enableFastTransformUpdates(e,a){if(!this.fastTransformUpdatesAllowed||this._fastTransformUpdatesEnabled)return;this._cancelAutoDisableFastUpdates(),this._fastTransformUpdatesEnabled=!0;const{stageObject:s}=this,r=s.geometries.slice();s.removeAllGeometries();const i=t(g,s.transformation),o=a.getOrigin(i);for(const t of r){const a=e(t.material),r=t.instantiate({material:a});r.localOrigin=o,s.addGeometry(r)}this._originalGeometries=r}autoDisableFastTransformUpdates(t){this._cancelAutoDisableFastUpdates(),this._autoDisableFastUpdatesTimeoutId=setTimeout((()=>{this._autoDisableFastUpdatesTimeoutId=0,t()}),h.disableDelayMs)}updateAutoDisableFastTransformUpdates(t){this._autoDisableFastUpdatesTimeoutId&&this.autoDisableFastTransformUpdates(t)}_cancelAutoDisableFastUpdates(){clearTimeout(this._autoDisableFastUpdatesTimeoutId),this._autoDisableFastUpdatesTimeoutId=0}disableFastTransformUpdates(t){if(!this._fastTransformUpdatesEnabled)return;this._cancelAutoDisableFastUpdates(),this._fastTransformUpdatesEnabled=!1;const{stageObject:e}=this,a=e.geometries.map((e=>t(e.material)));e.removeAllGeometries();for(let s=0;s<this._originalGeometries.length;s++){const t=this._originalGeometries[s],r=a[s];r.setParameters({modelTransformation:null}),r===t.material?e.addGeometry(t):e.addGeometry(t.instantiate({material:r}))}this._originalGeometries.length=0}updateFastLocalOrigin(e,a,s){if(!this._fastTransformUpdatesEnabled)return;const{stageObject:r}=this;if(0===r.geometries.length)return;const o=r.geometries[0].localOrigin,n=t(g,e),m=s.getOrigin(n);if(m===o)return;const l=a?.localMatrix??i;r.shaderTransformation=null,r.transformation=e,r.geometries.forEach((t=>{t.transformation=l,t.localOrigin=m}))}updateTransform(t,s,r){const{stageObject:o}=this,n=s?.localMatrix??i;if(!this._fastTransformUpdatesEnabled)return o.shaderTransformation=null,o.transformation=t,o.geometries.forEach((t=>t.transformation=n)),void this._updateEdgeTransform(r);const m=o.transformation,l=o.geometries[0].transformation,f=t,d=n,c=e(u,m,l),h=e(T,f,d),p=e(_,h,a(_,l));o.shaderTransformation=p,this._setFastMaterialTransformation({matA:c,matB:h}),this._updateEdgeTransform(r)}alignWithElevation(t,a,r,i){if(!this._fastTransformUpdatesEnabled)return void super.alignWithElevation(t,a,r,i);null!=r&&d(this.elevationContext.featureExpressionInfoContext,r);const o=(e,s)=>f(e,t,this.elevationContext,a,s),{stageObject:n}=this;if(!n.geometries[0].material.parameters.modelTransformation)return;const m=n.transformation,c=n.geometries[0].transformation,h=e(u,m,c),p=n.effectiveTransformation,g=s(b,p);this.alignedSampledElevation=l(this,this.elevationContext,t.spatialReference,o,a,g),n.shaderTransformation=g;const _=n.geometries[0].transformation,U=e(T,g,_);this._setFastMaterialTransformation({matA:h,matB:U}),this._updateEdgeTransform(i)}_setFastMaterialTransformation({matA:t,matB:s}){const{stageObject:i}=this;if(0===i.geometries.length)return;const o=i.geometries[0].localOrigin,m=r(F,n(g,o.vec3,-1)),l=e(U,m,t),f=e(E,m,s),d=a(U,l),c=e(E,f,d);for(const e of i.geometries)e.material.setParameters({modelTransformation:c})}_updateEdgeTransform(t){const{stageObject:e,_stageLayer:a}=this;a.stage.renderer.withEdgeView((a=>{a.fastUpdateObject3DEdgesTransform(e)||this.resetEdgeObject(t)}))}}const g=m(),u=o(),T=o(),b=o(),_=o(),U=o(),E=o(),F=o();export{p as Graphics3DMeshObject3DGraphicLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import{throwIfAborted as t}from\"../../../../core/promiseUtils.js\";import{pt2px as s}from\"../../../../core/screenUtils.js\";import{estimateSize as r}from\"../../../../core/typedArrayUtil.js\";import{identity as i,scale as a,translate as o,copy as n}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as l}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{l as c,L as h,v as d,c as m,C as p,g as u,i as y}from\"../../../../chunks/vec32.js\";import{fromArray as f,clone as _,ZEROS as g,ONES as b,fromValues as P,create as R}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ONES as x,create as v}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{computeTranslationToOriginAndRotation as L}from\"../../../../geometry/projection/computeTranslationToOriginAndRotation.js\";import{projectPointToVector as C}from\"../../../../geometry/projection/projectPointToVector.js\";import{create as S,size as j,containsPoint as w,center as E}from\"../../../../geometry/support/aaBoundingBox.js\";import{defaultPrimitive as U}from\"../../../../symbols/support/ObjectSymbol3DLayerResource.js\";import{objectSymbolLayerPrimitiveBoundingBox as T,objectSymbolLayerSizeWithResourceSize as O}from\"../../../../symbols/support/symbolLayerUtils3D.js\";import{estimateNumVerticesForLods as B,defaultSymbolLayerMemoryComplexity as I}from\"./defaultSymbolComplexity.js\";import{perLodInstanceElevationAligner as G}from\"./ElevationAligners.js\";import{needsElevationUpdates3D as D,evaluateElevationInfoAtPoint as A,SampleElevationInfo as F}from\"./elevationAlignmentUtils.js\";import{Graphics3DLodInstanceGraphicLayer as z}from\"./Graphics3DLodInstanceGraphicLayer.js\";import{Graphics3DSymbolLayer as V}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as M,mixinColorAndOpacity as H,computeObjectScale as k,computeObjectRotation as W}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as q}from\"./interfaces.js\";import{LoadStatus as N}from\"./Loadable.js\";import{makeLodResources as J}from\"./lodResourceUtils.js\";import{fetch as Y}from\"./objectResourceUtils.js\";import{placePointOnGeometry as $,extendPointGraphicElevationContext as K}from\"./pointUtils.js\";import{isValidPrimitive as Q,primitiveLodResources as X}from\"./primitiveObjectSymbolUtils.js\";import{SymbolComplexity as Z}from\"./SymbolComplexity.js\";import{getResourceUrlFromSymbolStyle as ee}from\"./webStyleUtils.js\";import{initFastSymbolUpdatesState as te,updateFastSymbolUpdatesState as se,ConvertOptions as re,evaluateModelTransform as ie,evaluateModelTransformScale as ae}from\"../support/FastSymbolUpdates.js\";import{olidEnabled as oe}from\"../../webgl-engine/effects/geometry/olidUtils.js\";import{CullFaceOptions as ne}from\"../../webgl-engine/lib/basicInterfaces.js\";import{VertexAttribute as le}from\"../../webgl-engine/lib/VertexAttribute.js\";import{LodRenderer as ce}from\"../../webgl-engine/lib/lodRendering/LodRenderer.js\";import{materialsFromLodResources as he,texturesFromLodResources as de,geometriesFromLodResources as me}from\"../../webgl-engine/lib/lodRendering/LodResources.js\";import{DefaultMaterial as pe}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{schematicMRRFactors as ue}from\"../../webgl-engine/materials/pbrUtils.js\";class ye{constructor(e,t,s,r,i,a,o,n,l,c,h,d){this.lodResources=e,this.lodRenderer=t,this.stageResources=s,this.originalMaterialParameters=r,this.resourceSize=i,this.isEsriSymbolResource=a,this.isWosr=o,this.resourceBoundingBox=n,this.symbolSize=l,this.extentPadding=c,this.physicalBasedRenderingEnabled=h,this.pivotOffset=d}}class fe extends V{getCachedSize(){const[e,t,s]=null!=this._resources?this._resources.symbolSize:[1,1,1];return{width:e,depth:t,height:s}}constructor(e,t,s,r){super(e,t,s,r),this._resources=null,this._optionalFields=new Array,this._instanceIndexToGraphicUid=new Map,this._hasLoadedPBRTextures=!1,this._disposeResourceHandles=new Array,this.skipHighSymbolLodsChanged=!1,this.ensureDrapedStatus(!1),this._hasLoadedPBRTextures=s.physicalBasedRenderingEnabled}async doLoad(e){if(!this._drivenProperties.size){const e=M(this.symbolLayer);if(e)throw new Error(e)}if(this._isPrimitive){const t=this.symbolLayer.resource,s=t&&Q(t?.primitive)?t.primitive:U;this._resources=await this._createResourcesForPrimitive(s,e)}else{const t=await ee(this.symbol.styleOrigin),s=t?.href??this.symbolLayer.resource?.href;this._resources=await this._createResourcesForUrl(s,e)}this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity()}get extentPadding(){return null!=this._resources?this._resources.extentPadding:0}get _isPrimitive(){return!this.symbolLayer.resource?.href}get lodRenderer(){return this._resources?.lodRenderer}get materials(){return this._resources?.stageResources.materials??[]}_setMaterialTransparencyParameters(e,t=this.symbolLayer?.material?.color){const s=this._getCombinedOpacity(t),r=s<1||this.needsDrivenTransparentPass;return e.transparent=r,e.opacity=s,e.cullFace=r?ne.None:ne.Back,e}async _createResourcesForPrimitive(t,r){const i=this.symbolLayer,a=S(T(t)),o=f(j(a)),n=f(O(o,i)),l=c(n),d=!1,m=!1,p=this.symbolLayer?.material?.emissiveFactor,u=p?h(_(p)):g,y={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,mrrFactors:ue,ambient:b,diffuse:b,hasSlicePlane:this._context.slicePlaneEnabled,hasSliceHighlight:!1,castShadows:this.symbolLayer.castShadows,emissiveFactor:u,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},P=!!y.usePBR;this._setMaterialTransparencyParameters(y);const R=this.symbol;if(\"point-3d\"===R.type&&R.verticalOffset){const{screenLength:e,minWorldLength:t,maxWorldLength:r}=R.verticalOffset;y.verticalOffset={screenLength:s(e),minWorldLength:t||0,maxWorldLength:null!=r?r:1/0},y.castShadows=!1}if(this._context.screenSizePerspectiveEnabled&&(y.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color)y.externalColor=x;else{const t=null!=i.material?i.material.color:null,s=null!=t?e.toUnitRGBA(t):x;y.externalColor=s}this._fastUpdates=te(this._context.renderer,this._fastVisualVariableConvertOptions(a,n,o,null)),y.isInstanced=!0,this._fastUpdates?(Object.assign(y,this._fastUpdates.materialParameters),this._optionalFields.push(le.FEATUREATTRIBUTE)):this._hasPerInstanceColor()&&(y.hasInstancedColor=!0,this._optionalFields.push(le.COLOR)),oe()&&this._optionalFields.push(le.OBJECTANDLAYERIDCOLOR);const v=new pe(y,this._context),L=X(t,v);if(!L)throw new Error(`Unknown object symbol primitive: ${t}`);const C=he(L).map((e=>({opacity:1,transparent:e.parameters.transparent}))),w=await this._createStageResources(L,P,r),E=await this._createLodRenderer(L,r);return new ye(L,E,w,C,o,d,m,a,n,l,P,null)}async _createResourcesForUrl(e,t){const r={isInstanced:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},i={spherical:this._context.spherical,doublePrecisionRequiresObfuscation:this._context.doublePrecisionRequiresObfuscation,materialParameters:r,streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache};this._fastUpdates=te(this._context.renderer,this._fastVisualVariableConvertOptions(null,null,null,null)),this._fastUpdates?(Object.assign(i.materialParameters,this._fastUpdates.materialParameters),this._optionalFields.push(le.FEATUREATTRIBUTE)):this._hasPerInstanceColor()&&(i.materialParameters.hasInstancedColor=!0,this._optionalFields.push(le.COLOR)),oe()&&this._optionalFields.push(le.OBJECTANDLAYERIDCOLOR);const a=this.symbol;if(\"point-3d\"===a.type&&a.verticalOffset){const{screenLength:e,minWorldLength:t,maxWorldLength:r}=a.verticalOffset;i.materialParameters.verticalOffset={screenLength:s(e),minWorldLength:t||0,maxWorldLength:null!=r?r:1/0},i.materialParameters.castShadows=!1}const o=this._context.physicalBasedRenderingEnabled;i.signal=t,i.usePBR=o,i.skipHighLods=this._context.skipHighSymbolLods;const n=await Y(e,i),l=n.isEsriSymbolResource,h=n.isWosr,d=J(n.lods),m=this._context,p=this.symbolLayer.material,u=this._getExternalColorParameters(p),y=this.symbolLayer?.material?.color,_=this._getCombinedOpacity(y,{hasIntrinsicColor:!0}),g=this.needsDrivenTransparentPass,b=he(d),P=he(d).map((e=>({opacity:e.parameters.opacity||1,transparent:e.parameters.transparent})));b.forEach((e=>{const t=e.parameters;e.setParameters(u);const s=t.opacity*_,r=s<1||g||t.transparent;e.setParameters({opacity:s,transparent:r}),m.screenSizePerspectiveEnabled&&e.setParameters({screenSizePerspective:m.sharedResources.screenSizePerspectiveSettings})}));const R=n.referenceBoundingBox,x=f(j(R)),v=f(d.levels[0].pivotOffset),L=f(O(x,this.symbolLayer)),C=c(L),S=this._fastUpdates;se(S,this._context.renderer,this._fastVisualVariableConvertOptions(R,L,x,v))&&b.forEach((e=>e.setParameters(S.materialParameters)));const w=await this._createStageResources(d,o,t),E=await this._createLodRenderer(d,t);return new ye(d,E,w,P,x,l,h,R,L,C,o,v)}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createStageResources(e,s,r){const i=this._context.stage,a=he(e);s!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),i.addMany(a),this._addDisposeResource((()=>i.removeMany(a)));const o=de(e);i.addMany(o),this._addDisposeResource((()=>{o.forEach((e=>e.unload())),i.removeMany(o)})),await Promise.all(o.map((e=>this._context.stage.schedule((()=>e.load(i.renderView.renderingContext)),r)))),t(r);const n=me(e);return i.addMany(n),this._addDisposeResource((()=>i.removeMany(n))),{materials:a,textures:o,geometries:n}}async _createLodRenderer(e,t){const s=this._context.stage,r={layerUid:this._context.layer.uid,graphicUid:e=>this._instanceIndexToGraphicUid.get(e),notifyGraphicGeometryChanged:e=>this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(e)),notifyGraphicVisibilityChanged:e=>this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(e))},i=this._fastUpdates,a=i?{applyTransform:(e,t,s)=>{e.getFeatureAttribute(t,xe),n(s,ie(i.materialParameters,xe,s))},scaleFactor:(e,t,s)=>{t.getFeatureAttribute(s,xe),ae(e,i.materialParameters,xe)}}:null,o=new ce({symbol:e,optionalFields:this._optionalFields,metadata:r,shaderTransformation:a},this._context.scheduler);return o.slicePlaneEnabled=this._context.slicePlaneEnabled,this._addDisposeResource((()=>{s.removeRenderPlugin(o),o.destroy()})),await s.addRenderPlugin(o,t),o}_getExternalColorParameters(t){const s={};return this._drivenProperties.color?s.externalColor=x:null!=t?.color?s.externalColor=e.toUnitRGBA(t.color):(s.externalColor=x,s.colorMixMode=\"ignore\"),s}destroy(){super.destroy(),this._cleanupResources()}_cleanupResources(){this._disposeResourceHandles.forEach((e=>e())),this._disposeResourceHandles.length=0,this._resources=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;const s=$(t.geometry);if(null==s)return this.logger.warn(`unsupported geometry type for object symbol: ${t.geometry.type}`),null;const r=this.setGraphicElevationContext(t),i=e.renderingInfo;return this._createAs3DShape(t,s,i,r,t.uid,e.layer.uid)}notifyDestroyGraphicLayer(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}graphicLayerToGraphicId(){return 0}layerOpacityChanged(){if(null==this._resources)return;const e=this._drivenProperties.opacity,t=!this._isPrimitive,s=this._resources.stageResources.materials,r=this._resources.originalMaterialParameters;for(let i=0;i<s.length;i++){const a=s[i],o=this.symbolLayer?.material?.color,n=r[i],l=this._getCombinedOpacity(o,{hasIntrinsicColor:t})*n.opacity,c=l<1||e||n.transparent;a.setParameters({opacity:l,transparent:c}),this._isPrimitive&&a.setParameters({cullFace:c?ne.None:ne.Back})}}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,D)}slicePlaneEnabledChanged(){if(null==this._resources)return!0;this._resources.lodRenderer.slicePlaneEnabled=this._context.slicePlaneEnabled;for(const e of this._resources.stageResources.materials)e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled});return!0}physicalBasedRenderingChanged(){if(null==this._resources)return!0;const{stageResources:e,isWosr:t}=this._resources;for(const s of e.materials)this._isPrimitive?s.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):t||s.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1});return!1!==this._hasLoadedPBRTextures||!0!==this._context.physicalBasedRenderingEnabled||(this._hasLoadedPBRTextures=!0,!1)}applyRendererDiff(e,t){if(null==this._resources)return q.RecreateSymbol;const{stageResources:{materials:s},lodRenderer:r,resourceBoundingBox:i,symbolSize:a,resourceSize:o,pivotOffset:n}=this._resources;for(const l in e.diff){if(\"visualVariables\"!==l)return q.RecreateSymbol;if(!se(this._fastUpdates,t,this._fastVisualVariableConvertOptions(i,a,o,n)))return q.RecreateSymbol;for(const e of s)e.setParameters(this._fastUpdates.materialParameters);r.notifyShaderTransformationChanged()}return q.FastUpdate}computeComplexity(){if(null==this._resources)return super.computeComplexity();const e=this._resources.lodResources,t=B(e.levels),s=e=>Array.from(e.attributes.values()).reduce(((e,t)=>e+r(t.data,t.indices)),0),i=me(e).reduce(((e,t)=>e+s(t)),0),a=de(e).reduce(((e,t)=>e+t.memoryEstimate),0)+i,o={...I(this.symbol,this.symbolLayer),resourceBytes:a};return new Z({verticesPerFeature:t,memory:o})}_hasLodRenderer(){return null!=this._resources}_createAs3DShape(e,t,s,r,i,a){if(!this._hasLodRenderer()||null==this._resources)return null;const o=this.getFastUpdateAttrValues(e),n=this._context.clippingExtent;if(C(t,be,this._context.elevationProvider.spatialReference),null!=n&&!w(n,be))return null;const l=ge(r),c=this._computeGlobalTransform(t,r,Re,ve),h=this._computeLocalTransform(this._resources,this.symbolLayer,s,Pe),d=this._resources.lodRenderer.instanceData,m=d.addInstance();this._instanceIndexToGraphicUid.set(m,i),d.setLocalTransform(m,h,!1),d.setGlobalTransform(m,c),o&&d.setFeatureAttribute(m,o),null==this._fastUpdates&&this._hasPerInstanceColor()&&d.setColor(m,H(s.color,s.opacity,255));const p=this._context.stage.renderView.olidRenderHelper;p&&d.setObjectAndLayerIdColor(m,p.getObjectAndLayerIdColor({graphicUid:i,layerUid:a}));const u=new z(this,m,G,r);return l&&(u.alignedSampledElevation=ve.sampledElevation),u.needsElevationUpdates=D(r.mode),K(u,t,this._context.elevationProvider),u}_computeGlobalTransform(e,t,s,r){return A(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,r),be[0]=e.x,be[1]=e.y,be[2]=r.z,L(e.spatialReference,be,s,this._context.renderCoordsHelper.spatialReference),s}_computeLocalTransform(e,t,s,r){return i(r),this._applyObjectRotation(s,!1,r),this._applyObjectRotation(t,!0,r),this._applyObjectScale(e,s,r),this._applyAnchor(e,t,r),r}_applyObjectScale(e,t,s){if(this._fastUpdates?.requiresShaderTransformation)return;const r=this._drivenProperties.size&&t.size?t.size:e.symbolSize,i=k(r,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);1===i[0]&&1===i[1]&&1===i[2]||a(s,s,i)}prepareSymbolLayerPatch(e){if(\"partial\"!==e.diff.type)return;const t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}updateGeometry(e,t){if(null==this._resources)return!0;const s=t&&$(t);if(null==s)return!1;const r=this.getGeometryElevationMode(t);return e.elevationContext.mode===r&&(this._computeGlobalTransform(s,e.elevationContext,Re,ve),ge(e.elevationContext)&&(e.alignedSampledElevation=ve.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,Re,!0),K(e,s,this._context.elevationProvider),!0)}_preparePatchTransform(e,t){if(!(t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition))return;if(null==this._resources)return;const s=(e,t,s)=>(null!=e&&\"complete\"===e.type?e.newValue:t)??s,r=s(t.heading,this.symbolLayer.heading,0),i=s(t.tilt,this.symbolLayer.tilt,0),a=s(t.roll,this.symbolLayer.roll,0),o=s(t.width,this.symbolLayer.width,void 0),n=s(t.height,this.symbolLayer.height,void 0),l=s(t.depth,this.symbolLayer.depth,void 0),c=s(t.anchor,this.symbolLayer.anchor,void 0),h=s(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;const d={heading:r,tilt:i,roll:a,anchor:c,anchorPosition:h},m=this._resources;this.loadStatus===N.LOADED&&e.symbolLayerStatePatches.push((()=>{m.symbolSize=f(O(m.resourceSize,{width:o,height:n,depth:l,isPrimitive:this.symbolLayer.isPrimitive}))})),e.graphics3DGraphicPatches.push(((e,t)=>{const s=this._computeLocalTransform(m,d,t,Pe),r=e.instanceIndex;m.lodRenderer.instanceData.setLocalTransform(r,s,!0)}))}_preparePatchColor(t,s){if(!s.material||\"partial\"!==s.material.type)return;const r=s.material.diff;if(!r.color||\"complete\"!==r.color.type||null==r.color.newValue||null==r.color.oldValue)return;const i=r.color.newValue,a=null!=i?e.toUnitRGBA(i):x;delete r.color;const o=this._resources;null!=o&&t.graphics3DGraphicPatches.push((e=>{let t;this._hasPerInstanceColor()?(o.lodRenderer.instanceData.setColor(e.instanceIndex,a),t=this._setMaterialTransparencyParameters({},i)):t=this._setMaterialTransparencyParameters({externalColor:a},i);for(const s of o.stageResources.materials)s.setParameters(t)}))}_applyObjectRotation(e,t,s){if(!this._fastUpdates?.requiresShaderTransformation||!t)return W(e.heading,e.tilt,e.roll,s)}_applyAnchor(e,t,s){if(this._fastUpdates?.requiresShaderTransformation)return;const r=_e(e.resourceBoundingBox,e.pivotOffset,t);r&&o(s,s,r)}_hasPerInstanceColor(){return this._drivenProperties.color||this._drivenProperties.opacity}_fastVisualVariableConvertOptions(e,t,s,r){const i=null!=e?f(j(e)):b,a=null!=e?_e(e,r,this.symbolLayer):g,o=this._context.renderCoordsHelper.unitInMeters,n=k(null!=t?t:void 0,t,s,o),l=P(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return new re({size:!0,color:!0,rotation:!0,opacity:!1},i,t??b,o,a,n,l)}}function _e(e,t,s){const r=R();switch(s.anchor){case\"center\":m(r,E(e)),d(r,r);break;case\"top\":{const t=E(e);y(r,-t[0],-t[1],-e[5]);break}case\"bottom\":{const t=E(e);y(r,-t[0],-t[1],-e[2]);break}case\"relative\":{const t=E(e),i=j(e),a=s.anchorPosition,o=a?P(a.x,a.y,a.z):g;p(r,i,o),u(r,r,t),d(r,r);break}default:null!=t?d(r,t):m(r,g)}return r}function ge(e){return\"absolute-height\"!==e.mode}const be=R(),Pe=l(),Re=l(),xe=v(),ve=new F;export{fe as Graphics3DObjectSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import e from\"../../../../core/Error.js\";import{translate as t}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{IDENTITY as i,create as r}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{set as s,scale as a}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{fromValues as o,fromArray as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{L as l,i as h}from\"../../../../chunks/vec32.js\";import{clone as c,ZEROS as p,fromArray as m,create as f}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{projectBuffer as d}from\"../../../../geometry/projection/projectBuffer.js\";import{create as u,fromSubBuffer as y,intersectsClippingArea as b}from\"../../../../geometry/support/aaBoundingBox.js\";import{newDoubleArray as g,doubleArrayFrom as _}from\"../../../../geometry/support/DoubleArray.js\";import{needsElevationUpdates3D as v,evaluateElevationAlignmentAtPoint as x,SampleElevationInfo as w}from\"./elevationAlignmentUtils.js\";import{Graphics3DObject3DGraphicLayer as P}from\"./Graphics3DObject3DGraphicLayer.js\";import{pathNumRoundJoinSubdivisions as j,pathNumRoundCapExtrusionSubdivisions as S}from\"./Graphics3DPathSymbolLayerConstants.js\";import{Graphics3DSymbolLayer as D}from\"./Graphics3DSymbolLayer.js\";import{isValidSize as C}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as L}from\"./interfaces.js\";import{ConvertOptions as V,initFastSymbolUpdatesState as U,updateFastSymbolUpdatesState as A,getAttributeValue as E}from\"../support/FastSymbolUpdates.js\";import{SamplePosition as R}from\"../../support/ElevationProvider.js\";import{NormalType as z}from\"../../webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{CullFaceOptions as k}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Object3D as I}from\"../../webgl-engine/lib/Object3D.js\";import{Path as G}from\"../../webgl-engine/lib/Path.js\";import{PathBuilder as B}from\"../../webgl-engine/lib/PathBuilder.js\";import{RoundCapBuilder as O,TriangulationCapBuilder as M,NoCapBuilder as F}from\"../../webgl-engine/lib/PathCapBuilder.js\";import{SimpleExtruder as q,MiterExtruder as H}from\"../../webgl-engine/lib/PathExtruder.js\";import{UpVectorAlignment as N,PathGeometry as T,isPathGeometry as W}from\"../../webgl-engine/lib/PathGeometry.js\";import{FastUpdatePathGeometry as Z,StaticPathGeometry as J}from\"../../webgl-engine/lib/PathGeometryData.js\";import{computeMinimumRotationTangentFrame as K}from\"../../webgl-engine/lib/pathGeometryUtils.js\";import{quadProfiles as Q,circleProfiles as X}from\"../../webgl-engine/lib/PathProfile.js\";import{newPathVertex as Y}from\"../../webgl-engine/lib/PathVertex.js\";import{VertexAttribute as $}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as ee}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{PathMaterial as te}from\"../../webgl-engine/materials/PathMaterial.js\";const ie=[\"polyline\"];class re extends D{constructor(e,t,i,r){super(e,t,i,r),this._intrinsicSize=o(1,1),this._upVectorAlignment=N.Path,this._stencilWidth=.1,this.usedMemory=0,this.ensureDrapedStatus(!1)}async doLoad(){const t=null!=this.symbolLayer.width?this.symbolLayer.width:this.symbolLayer.height,i=null!=this.symbolLayer.height?this.symbolLayer.height:t;this._vvConvertOptions=new V({size:!0,color:!0,rotation:!1,opacity:!0},[1,1,1],[t,1,i],this._context.renderCoordsHelper.unitInMeters);const r=this._context.renderer?.visualVariables;this._fastUpdates=r?.length?U(this._context.renderer,this._vvConvertOptions):null;const o=this.symbolLayer.anchor||\"center\";this._upVectorAlignment=\"heading\"===this.symbolLayer.profileRotation?N.World:N.Path;const h=this.symbolLayer.profile||\"circle\";switch(h){default:case\"circle\":this._profile=X[o];break;case\"quad\":this._profile=Q[o]}switch(this.symbolLayer.join){case\"round\":this._extruder=new H(0,j);break;case\"bevel\":this._extruder=new H(0,1);break;case\"miter\":this._extruder=new H(.8*Math.PI,1);break;default:this._extruder=new q}const f=this.symbolLayer.cap||\"butt\";switch(f){case\"none\":this._startCap=new F,this._endCap=new F;break;case\"butt\":default:this._startCap=new M(this._profile,0),this._endCap=new M(this._profile,0,!0);break;case\"square\":this._startCap=new M(this._profile,-.5),this._endCap=new M(this._profile,.5,!0);break;case\"round\":{const e=\"quad\"===h;this._startCap=new O({profile:this._profile,flip:!1,breakNormals:e,subdivisions:S}),this._endCap=new O({profile:this._profile,flip:!0,breakNormals:e,subdivisions:S});break}}const d=this.symbolLayer?.material?.emissiveFactor,u=d?l(c(d)):p,y=this.symbolLayer?.material?.color,b=this._getCombinedOpacityAndColor(y),g=m(b),_=b[3],v=_<1||this.needsDrivenTransparentPass,x={diffuse:g,ambient:g,emissiveFactor:u,opacity:_,transparent:v,hasVertexColors:!1,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,cullFace:v||\"none\"===f?k.None:k.Back,offsetTransparentBackfaces:!0};if(!this._drivenProperties.size&&(s(this._intrinsicSize,t,i),!C(this._intrinsicSize[0])||!C(this._intrinsicSize[1])))throw new e(\"graphics3dpathsymbollayer:invalid-size\",\"Symbol sizes may not be negative values\");if(this._fastUpdates?.visualVariables.size||a(this._intrinsicSize,this._intrinsicSize,1/this._context.renderCoordsHelper.unitInMeters),this._fastUpdates){const e={...x,...this._fastUpdates.materialParameters,size:n(this._intrinsicSize)};this._materials[0]=new te(e,this._context)}else x.hasVertexColors=this._drivenProperties.color||this._drivenProperties.opacity,x.normalType=z.Compressed,this._materials[0]=new ee(x,this._context);this._materials[0].setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._context.stage.add(this._materials[0])}destroy(){super.destroy(),this._context.stage.remove(this._materials[0]),this._materials.length=0}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,ie,this.symbolLayer.type))return null;const i=this.setGraphicElevationContext(t),r=e.renderingInfo;return this._createAs3DShape(t,r,i,t.uid)}layerOpacityChanged(){const e=this.symbolLayer?.material?.color,t=this._getCombinedOpacity(e),i=t<1||this.needsDrivenTransparentPass;this._materials[0]?.setParameters({opacity:t,transparent:i})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,v)}slicePlaneEnabledChanged(){return this._materials[0]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return this._materials[0]?.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}applyRendererDiff(e,t){for(const i in e.diff){if(\"visualVariables\"!==i)return L.RecreateSymbol;if(!A(this._fastUpdates,t,this._vvConvertOptions))return L.RecreateSymbol;this._materials[0]?.setParameters(this._fastUpdates.materialParameters)}return L.FastUpdate}_getVertexData(e){let t=0;const i=e.paths,r=[],s=e.spatialReference,a=this._context.elevationProvider.spatialReference,o=this._context.renderCoordsHelper.spatialReference;for(const c of i)t+=c.length;const n=g(3*t);let l,h=0;for(const c of i){r.push({offset:h,numVertices:c.length});for(const t of c)n[h++]=t[0],n[h++]=t[1],n[h++]=e.hasZ?t[2]:0}return null==a||s.equals(a)||d(n,s,0,n,a,0,t)?(null==a||a.equals(o)?l=_(n):(l=g(3*t),d(n,a,0,l,o,0,t)),{pathVertexDataInfos:r,vertexDataES:n,vertexDataRS:l}):null}_createAs3DShape(e,s,a,o){this.usedMemory=0;const n=e.geometry,l=this._getVertexData(n);if(null==l)return this.logger.warn(\"PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)\"),null;if(0===l.pathVertexDataInfos.length)return 0!==n.paths.length&&n.paths.some((e=>e.length>0))||this.logger.warn(\"PathSymbol3DLayer geometry failed to be created (no paths were defined)\"),null;const c=new Array,p=n.spatialReference,m=u(),f=this._context.renderCoordsHelper,d=new R(l.vertexDataES);for(const u of l.pathVertexDataInfos){const n=u.numVertices;if(n<2)continue;const g=u.offset;if(null!=this._context.clippingExtent&&(y(l.vertexDataES,g,n,m),!b(m,this._context.clippingExtent)))continue;const _=new Array,v=g+3*n;for(let e=g;e<v;e+=3){d.offset=e;const t=x(d,this._context.elevationProvider,a,f);h(le,l.vertexDataRS[e],l.vertexDataRS[e+1],l.vertexDataRS[e+2]),f.setAltitude(le,t),l.vertexDataRS[e]=le[0],l.vertexDataRS[e+1]=le[1],l.vertexDataRS[e+2]=le[2],_.push(Y(this._upVectorAlignment))}const w=new G(_,l.vertexDataES,l.vertexDataRS,g);se(w,this._upVectorAlignment,this._context.renderCoordsHelper);const P=new B(w,this._profile,this._extruder,this._startCap,this._endCap);let j=null;if(this._fastUpdates){const t=this._fastUpdates.visualVariables,i=E(t.size?.field,e)??0,r=E(t.color?.field,e)??0,s=E(t.opacity?.field,e)??0;j=new Z(P,i,r,s)}else{const e=[this._intrinsicSize[0],this._intrinsicSize[1]];if(this._drivenProperties.size){const t=s.size;e[0]*=ae(t[0],\"symbol-value\"===t[2]?this.symbolLayer.height||0:t[2],this.symbolLayer.width||0),e[1]*=ae(t[2],\"symbol-value\"===t[0]?this.symbolLayer.width||0:t[0],this.symbolLayer.height||0)}let t;this._drivenProperties.color&&(t=s.color),this._drivenProperties.opacity&&null!=s.opacity&&(t=t?[t[0],t[1],t[2],s.opacity]:[1,1,1,s.opacity]);const i=new J(P);i.bake(e),t&&i.bakeVertexColors(t),j=i}const S=j.createGeometryData(),D=this._context.stage.renderView.getObjectAndLayerIdColor({graphicUid:o,layerUid:this._context.layer.uid}),C=new T(this._materials[0],S,j,p,this._stencilWidth,D);C.transformation=t(r(),i,P.path.origin),c.push(C),this.usedMemory+=P.usedMemory}if(0===c.length)return null;const g=new I({geometries:c,layerUid:this._context.layer.uid,graphicUid:o}),_=new P(this,g,c,null,null,((e,t,i,r,s)=>ne(e,t,r,s,this._upVectorAlignment)),a);return _.alignedSampledElevation=0,_.needsElevationUpdates=v(a.mode),_}}function se(e,t,i){const{origin:r,positions:s}=e;let a=e.offset;switch(t){default:case N.World:for(const t of e.vertices)le[0]=s[a++]+r[0],le[1]=s[a++]+r[1],le[2]=s[a++]+r[2],i.worldUpAtPosition(le,le),t.setFrameFromUpVector(le);break;case N.Path:le[0]=s[a]+r[0],le[1]=s[a+1]+r[1],le[2]=s[a+2]+r[2],i.worldUpAtPosition(le,le),K(e,le)}}function ae(e,t,i){switch(e){case\"symbol-value\":return i;case\"proportional\":return t;default:return e}}function oe(e,t,i,r){let s=0;const{origin:a,vertices:o,positions:n,positionsES:l}=e,c=e.offset+3*o.length;for(let p=e.offset;p<c;p+=3)h(le,l[p],l[p+1],l[p+2]),i(le,he),s+=he.sampledElevation,le[0]=n[p]+a[0],le[1]=n[p+1]+a[1],le[2]=n[p+2]+a[2],r.setAltitude(le,he.z),n[p]=le[0]-a[0],n[p+1]=le[1]-a[1],n[p+2]=le[2]-a[2];return e.updatePathVertexInformation(),s/o.length}function ne(e,t,i,r,s){const a=e.stageObject,o=a.geometries;let n=0;for(const l of o){if(!W(l))continue;const e=l.path,o=e.builder.path;n+=oe(o,t,i,r),s!==N.World&&se(o,s,r),e.onPathChanged(l),l.invalidateBoundingInfo(),a.geometryVertexAttributeUpdated(l,$.POSITION)}return n/o.length}const le=f(),he=new w;export{re as Graphics3DPathSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import{pt2px as t}from\"../../../../core/screenUtils.js\";import{e as i}from\"../../../../chunks/earcut.js\";import{create as r,fromBuffer as s,intersectsClippingArea as o,empty as n,expandWithAABB as a}from\"../../../../geometry/support/aaBoundingBox.js\";import{newDoubleArray as l,doubleSubArray as c}from\"../../../../geometry/support/DoubleArray.js\";import{newFloatArray as p,floatSubArray as h}from\"../../../../geometry/support/FloatArray.js\";import{SymbolUpdateType as u,elevationModeChangeUpdateType as d,needsElevationUpdates2D as m}from\"./elevationAlignmentUtils.js\";import{Graphics3DDrapedGraphicLayer as y}from\"./Graphics3DDrapedGraphicLayer.js\";import{Graphics3DObject3DGraphicLayer as _}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as g}from\"./Graphics3DSymbolLayer.js\";import{mixinColorAndOpacity as f}from\"./graphicUtils.js\";import{ApplyRendererDiffResult as b}from\"./interfaces.js\";import{parseCapType as x}from\"./lineUtils.js\";import{geometryAsPolygon as O,createIndices3D as v,createColorGeometry as D,PolygonCreationDataBase as C}from\"./polygonUtils.js\";import{initFastSymbolUpdatesState as S,updateFastSymbolUpdatesState as j,getAttributeValue as A,ConvertOptions as P}from\"../support/FastSymbolUpdates.js\";import{createMaterial as U,uvElevationAligner as E}from\"../support/patternUtils.js\";import{createMapSpaceUVCoords as G,createMapSpaceUVCoordsDraped as L}from\"../support/uvUtils.js\";import{createGeometry as F}from\"../../support/engineContent/line.js\";import{geometryToRenderInfo as w,geometryToRenderInfoDraped as R}from\"../../support/renderInfoUtils/polygon.js\";import{Object3D as I}from\"../../webgl-engine/lib/Object3D.js\";import{RenderGeometry as M}from\"../../webgl-engine/lib/RenderGeometry.js\";import{getStipplePatternForLinePattern as V}from\"../../webgl-engine/materials/lineStippleUtils.js\";import{PatternMaterial as B}from\"../../webgl-engine/materials/PatternMaterial.js\";import{RibbonLineMaterial as T}from\"../../webgl-engine/materials/RibbonLineMaterial.js\";const z=[\"polyline\",\"polygon\",\"extent\"],H=new P({size:!1,color:!0,rotation:!1,opacity:!1});class N extends g{constructor(e,t,i,r){super(e,t,i,r),this._needsUV=!1}async doLoad(){this._fastUpdates=S(this._context.renderer,H)}_createMaterials(){if(this._materials.length>0)return;const e=this.symbolLayer?.material?.color,i=this._getCombinedOpacityAndColor(e);this._materials[J.Fill]=U(this.symbolLayer,{color:i,forceTransparentMode:this.needsDrivenTransparentPass,discardInvisibleFragments:!0,polygonOffset:!1,hasVertexColors:!0,draped:this.draped,hasSlicePlane:this._context.slicePlaneEnabled,...this._fastUpdates?.materialParameters}),this._needsUV=this._materials[J.Fill]instanceof B;const r=this.symbolLayer.outline;if(K(r)){const e=V(r.pattern);this._materials[J.Outline]=new T({width:t(r.size),color:this._getOutlineColor(),hasPolygonOffset:!0,hasSlicePlane:this._context.slicePlaneEnabled,isClosed:!0,stipplePattern:e,cap:x(r.patternCap||\"butt\")})}this._context.stage.addMany(this._materials)}destroy(){super.destroy(),this._context.stage.removeMany(this._materials),this._materials.length=0}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,z,this.symbolLayer.type))return null;const i=this._getVertexOpacityAndColor(e.renderingInfo,255),r=this.setGraphicElevationContext(t);return this.ensureDrapedStatus(\"on-the-ground\"===r.mode),this._createMaterials(),this.draped?this._createAsOverlay(t,i):this._createAs3DShape(t,i,r)}applyRendererDiff(e,t){for(const i in e.diff){if(\"visualVariables\"!==i)return b.RecreateSymbol;if(!j(this._fastUpdates,t,H))return b.RecreateSymbol;this._materials[J.Fill]?.setParameters(this._fastUpdates.materialParameters)}return b.FastUpdate}layerOpacityChanged(){if(null!=this._materials[J.Fill]){const e=this._materials[J.Fill].parameters.color,t=this.symbolLayer?.material?.color,i=this._getCombinedOpacity(t);this._materials[J.Fill].setParameters({color:[e[0],e[1],e[2],i],forceTransparentMode:this.needsDrivenTransparentPass})}if(null!=this._materials[J.Outline]){const e=this._materials[J.Outline].parameters.color;this._materials[J.Outline].setParameters({color:[e[0],e[1],e[2],this._getOutlineOpacity()]})}}layerElevationInfoChanged(e,t,i){const r=this._elevationContext.mode,s=d(N.elevationModeChangeTypes,i,r);if(s!==u.UPDATE)return s;const o=m(r);return this.updateGraphics3DGraphicElevationInfo(e,t,(()=>o))}slicePlaneEnabledChanged(){if(this._materials[J.Fill]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._materials[J.Outline]){const e={hasSlicePlane:this._context.slicePlaneEnabled};this._materials[J.Outline].setParameters(e)}return!0}physicalBasedRenderingChanged(){return!0}_createAs3DShape(e,t,i){const r=O(e.geometry);if(!r)return null;const s=w(r,this._context.elevationProvider,this._context.renderCoordsHelper,i),o=new k(s,t,this._context.layer.uid,e.uid),n=o.renderData.position.length/3;if(this._needsUV&&(o.uvMapSpace=p(4*n,!0),o.boundingRect=l(9*n,!0),G(o.uvMapSpace,o.boundingRect,o.renderData.position,this._context.renderCoordsHelper)),o.objectAndLayerIdColor=this._context.stage.renderView?.getObjectAndLayerIdColor(o),this._createAs3DShapeFill(e,o),this._materials[J.Outline]&&this._createAs3DShapeOutline(o),this._logGeometryCreationWarnings(o.renderData,r.rings,\"rings\",\"FillSymbol3DLayer\"),0===o.outGeometries.length)return null;const a=new I({geometries:o.outGeometries,castShadow:!1,layerUid:this._context.layer.uid,graphicUid:e.uid}),c=new _(this,a,o.outGeometries,null,null,E,i);return c.alignedSampledElevation=o.renderData.sampledElevation,c.needsElevationUpdates=m(i.mode),c}_createAs3DShapeFill(e,t){const i=t.renderData.polygons;for(const{position:r,mapPositions:n,holeIndices:a,index:l,count:p}of i){if(null!=this._context.clippingExtent&&(s(n,W),!o(W,this._context.clippingExtent)))continue;const i=v(n,a,this._context.elevationProvider.spatialReference);if(0===i.length)continue;const u=this._fastUpdates?.visualVariables.color,d=D({material:this._materials[J.Fill],indices:i,mapPositions:n,attributeData:{position:r,color:u?null:t.color,colorFeature:u?A(u.field,e):null,uvMapSpace:this._needsUV?h(t.uvMapSpace,4*l,4*p):null,boundingRect:this._needsUV?c(t.boundingRect,9*l,9*p):null,objectAndLayerIdColor:t.objectAndLayerIdColor}});t.outGeometries.push(d)}}_createAs3DShapeOutline(e){if(null==this._materials[J.Outline])return;const t=e.renderData.outlines;for(const{mapPositions:i,position:r}of t){if(null!=this._context.clippingExtent&&(s(i,W),!o(W,this._context.clippingExtent)))continue;const t=F(this._materials[J.Outline],{overlayInfo:null,removeDuplicateStartEnd:!0,mapPositions:i,attributeData:{position:r}},e.objectAndLayerIdColor);e.outGeometries.push(t)}}_createAsOverlay(e,t){const i=O(e.geometry);if(null==i)return null;this._materials[J.Fill].renderPriority=this._renderPriority+this._renderPriorityStep/2,null!=this._materials[J.Outline]&&(this._materials[J.Outline].renderPriority=this._renderPriority);const r=R(i,this._context.overlaySR),s=new q(r,t,this._context.layer.uid,e.uid),o=s.renderData.position.length/3;return this._needsUV&&(s.uvMapSpace=p(4*o,!0),L(s.uvMapSpace,s.renderData.position,this._context.overlaySR,this._context.graphicsCoreOwner.view.state.viewingMode)),s.outBoundingBox=n(),s.objectAndLayerIdColor=this._context.stage.renderView?.getObjectAndLayerIdColor(s),this._createAsOverlayFill(e,s),this._materials[J.Outline]&&this._createAsOverlayOutline(s),this._logGeometryCreationWarnings(s.renderData,i.rings,\"rings\",\"FillSymbol3DLayer\"),0===s.outGeometries.length?null:new y(this,s.outGeometries,s.outBoundingBox,this._context.drapeSourceRenderer)}_createAsOverlayFill(e,t){const r=t.renderData.polygons;for(const{position:n,holeIndices:l,index:c,count:p}of r){const r=s(n,W);if(!o(r,this._context.clippingExtent))continue;const u=i(n,l,3);if(0===u.length)continue;a(t.outBoundingBox,r);const d=this._fastUpdates?.visualVariables.color,m=D({material:this._materials[J.Fill],indices:u,attributeData:{position:n,color:d?null:t.color,colorFeature:d?A(d.field,e):null,uvMapSpace:this._needsUV?h(t.uvMapSpace,4*c,4*p):null,objectAndLayerIdColor:t.objectAndLayerIdColor}});t.outGeometries.push(new M(m,t))}}_createAsOverlayOutline(e){if(null==this._materials[J.Outline])return;const t=e.renderData.outlines;for(let i=0;i<t.length;++i){const{position:r}=t[i];if(s(r,W),!o(W,this._context.clippingExtent))continue;a(e.outBoundingBox,W);const n=F(this._materials[J.Outline],{overlayInfo:{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper},removeDuplicateStartEnd:!0,attributeData:{position:r}},e.objectAndLayerIdColor);e.outGeometries.push(new M(n,e))}}_getOutlineOpacity(){const e=this.symbolLayer?.outline?.color;return(this.draped?1:this._getLayerOpacity())*(null!=e?e.a:0)}_getOutlineColor(){const t=this.symbolLayer?.outline?.color,i=this._getOutlineOpacity();return f(null!=t?e.toUnitRGB(t):null,i)}test(){return{...super.test(),createAsOverlay:(e,t)=>this._createAsOverlay(e,t),createAs3DShape:(e,t,i)=>this._createAs3DShape(e,t,i)}}}N.elevationModeChangeTypes={definedChanged:u.RECREATE,staysOnTheGround:u.NONE,onTheGroundChanged:u.RECREATE};const W=r();class k extends C{constructor(e,t,i,r){super(e,i,r),this.color=t}}class q extends C{constructor(e,t,i,r){super(e,i,r),this.color=t}}var J;function K(e){return null!=e?.size&&e.size>0&&null!=e.color&&(null==e.pattern||\"style\"!==e.pattern.type||\"none\"!==e.pattern.style)}!function(e){e[e.Fill=0]=\"Fill\",e[e.Outline=1]=\"Outline\"}(J||(J={}));export{N as Graphics3DPolygonFillSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport r from\"../../../../core/Logger.js\";import{Graphics3DExtrudeSymbolLayer as o}from\"./Graphics3DExtrudeSymbolLayer.js\";import{Graphics3DIconSymbolLayer as e}from\"./Graphics3DIconSymbolLayer.js\";import{Graphics3DLineSymbolLayer as t}from\"./Graphics3DLineSymbolLayer.js\";import{Graphics3DMeshFillSymbolLayer as i}from\"./Graphics3DMeshFillSymbolLayer.js\";import{Graphics3DObjectSymbolLayer as m}from\"./Graphics3DObjectSymbolLayer.js\";import{Graphics3DPathSymbolLayer as a}from\"./Graphics3DPathSymbolLayer.js\";import{Graphics3DPolygonFillSymbolLayer as s}from\"./Graphics3DPolygonFillSymbolLayer.js\";import{Graphics3DTextSymbolLayer as y}from\"./Graphics3DTextSymbolLayer.js\";import{Graphics3DWaterSymbolLayer as p}from\"./Graphics3DWaterSymbolLayer.js\";function c(o,e,t,i){const m=h[o.type]?.[e.type]||l[e.type];return m?new m(o,e,t,i):(r.getLogger(\"esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory\").error(\"GraphicsLayerFactory#make\",`unknown symbol type ${e.type}`),null)}const l={icon:e,object:m,line:t,path:a,fill:s,extrude:o,text:y,water:p};function n(r,o){l[r]=o}const h={\"mesh-3d\":{fill:i}};export{c as make,n as setSymbolClass};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Error.js\";import has from\"../../../../core/has.js\";import{releaseMaybe as t}from\"../../../../core/maybe.js\";import{isPromiseLike as r}from\"../../../../core/promiseUtils.js\";import{pt2px as n}from\"../../../../core/screenUtils.js\";import{fromValues as s,ZEROS as i,create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{freeze as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as a}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{hasCalloutSupport as c,textSymbolLayerSupportsVerticalOffset as m}from\"../../../../symbols/callouts/calloutUtils.js\";import{perObjectElevationAligner as f}from\"./ElevationAligners.js\";import{SymbolUpdateType as h,needsElevationUpdates2D as p}from\"./elevationAlignmentUtils.js\";import{ElevationContext as u}from\"./ElevationContext.js\";import{Graphics3DObject3DGraphicLayer as d}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DObjectMetadata as g}from\"./Graphics3DObjectMetadata.js\";import{Graphics3DSymbolLayer as y}from\"./Graphics3DSymbolLayer.js\";import{validateSymbolLayerSize as x}from\"./graphicUtils.js\";import{LabelParameters as v,LabelPlacement as b}from\"./LabelParameters.js\";import{verticalScreenOffsetFromAlignment as O,verticalPlacementFromAlignment as P,textRenderAlignmentFromHorizontalPlacement as j,horizontalPlacementToAnchorX as E,anchorFromPlacements as _,namedAnchorToHUDMaterialAnchorPos as w}from\"./placementUtils.js\";import{placePointOnGeometry as S,updateStageObjectGeometry as L,getLocalOriginForPoint as G,extendPointGraphicElevationContext as z,createStageObject as C}from\"./pointUtils.js\";import{getFontMetrics as U}from\"../../webgl-engine/lib/FontMetrics.js\";import{createPointGeometry as D}from\"../../webgl-engine/lib/GeometryUtil.js\";import{TextRenderParameters as R}from\"../../webgl-engine/lib/TextRenderParameters.js\";import A from\"../../webgl-engine/lib/TextTextureFactory.js\";import{HUDMaterial as T}from\"../../webgl-engine/materials/HUDMaterial.js\";const H=l(0,0,1);class W extends y{constructor(e,t,r,n){super(e,t,r,n),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const t=x(this.symbolLayer.size);if(t)throw new e(\"graphics3dtextsymbollayer:invalid-size\",t)}await this._createTextRenderParameters()}async _createTextRenderParameters(){const e=this._context.graphicsCoreOwner.view.state.rasterPixelRatio;this._textRenderParameters=await R.fromSymbol(this.symbolLayer,e)}destroy(){super.destroy()}createGraphics3DGraphic(e){const t=e.graphic,r=S(t.geometry);if(null==r)return this.logger.warn(`unsupported geometry type for text symbol: ${t.geometry.type}`),null;const n=this.symbolLayer.text;if(null==n||\"\"===n)return null;const s=c(this.symbol)&&this.symbol.hasVisibleVerticalOffset()?this.symbol.verticalOffset:null;if(null!=s&&!m(this.symbolLayer))return this.logger.errorOncePerTick(`Callouts and vertical offset on text symbols are currently only supported with 'center' horizontal alignment (not with '${this.symbolLayer.horizontalAlignment}' alignment)`),null;const{verticalAlignment:i}=this.symbolLayer,o=new b(s);O(i,o.screenOffset);const l=new v(o,this.symbolLayer.horizontalAlignment,P(i));return this._createAs3DShape(t,r,n,l)}createLabel(e,t,r,n,s){const i=e.graphic,o=S(i.geometry);if(null==o)return this.logger.warn(`unsupported geometry type for label: ${i.geometry.type}`),null;const l=t.text;return!l||/^\\s+$/.test(l)?null:this._createAs3DShape(i,o,l,t,r,n,s)}setGraphicElevationContext(e,t,r=0){return super.setGraphicElevationContext(e,t),t.addOffsetRenderUnits(r),t}layerOpacityChanged(){return this.logger.warn(\"layer opacity change not yet implemented in Graphics3DTextSymbolLayer\"),!1}layerElevationInfoChanged(e,t){return F(e,t,((e,t)=>{this.updateGraphicElevationContext(t,e)})),h.UPDATE}slicePlaneEnabledChanged(e,t){return F(e,t,(e=>{for(const t of e.stageObject.geometries)t.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})})),!0}physicalBasedRenderingChanged(){return!0}get pixelRatioChanged(){return!1}updateGraphicElevationContext(e,t){const r=t.elevationContext;this.setGraphicElevationContext(e,r,null!=t.metadata?t.metadata.elevationOffset:0),t.needsElevationUpdates=p(r.mode)||\"absolute-height\"===r.mode}updateGeometry(e,t){if(this.draped||!this._validateGeometry(t))return!1;const{elevationContext:r,stageObject:n}=e;if(r.mode!==this.getGeometryElevationMode(t))return!1;const s=S(t);if(!s)return!1;const i=L(n,this._context,s,r);if(null==i)return!1;const o=G(this._context,s);return n.geometries[0].localOrigin===o&&(e.alignedSampledElevation=i,z(e,s,this._context.elevationProvider),!0)}_defaultElevationInfoNoZ(){return M}_createAs3DShape(e,l,c,m,h=null,y=null,x=()=>m.placement.elevationOffset){const v=this.setGraphicElevationContext(e,new u,m.placement.elevationOffset),b=\"polyline\"===e.geometry?.type,O=e.uid;let P=null,E=null;if(null==y){const e=j(m.horizontalPlacement);P=new A(c,e,this._textRenderParameters);let n=null;if(null!=this._context.sharedResources.textures){E=this._context.sharedResources.textures.fromData(P.key,(()=>P.create())),E.texture.events.on(\"unloaded\",(()=>n=t(n)));const e=this._context.stage.renderView.textures.acquire(E.texture.id);if(null==e||r(e))return E.release(),null;n=e}}const _=!!has(\"enable-feature:non-occluded-hud\"),w=I(P,m),S={occlusionTest:!_,occludedFragmentFade:_,horizonCullingEnabled:_,screenOffset:m.placement.screenOffset,anchorPosition:w,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:m.placement.centerOffsetUnits,depthEnabled:!1,drawInSecondSlot:!0,isLabel:!0};if(b&&(S.shaderPolygonOffset=1e-4),y?S.textureId=y.id:E&&(S.textureId=E.texture.id),null!=m.placement.verticalOffset){const{screenLength:e,minWorldLength:t,maxWorldLength:r}=m.placement.verticalOffset;S.verticalOffset={screenLength:n(e),minWorldLength:t||0,maxWorldLength:null!=r?r:1/0}}const L={screenOffset:S.screenOffset,anchorPosition:w,centerOffsetUnits:S.centerOffsetUnits,verticalOffset:S.verticalOffset,shaderPolygonOffset:S.shaderPolygonOffset,occlusionTest:S.occlusionTest};if(this._context.screenSizePerspectiveEnabled){const{screenSizePerspectiveSettings:e,screenSizePerspectiveSettingsLabels:t}=this._context.sharedResources,r=U(this._textRenderParameters);S.screenSizePerspective=t.overrideFontHeight(r.maxHeight),S.screenSizePerspectiveAlignment=e,L.fontHeight=r.maxHeight}S.hasSlicePlane=this._context.slicePlaneEnabled;const G=this._context.spherical,R=h?JSON.stringify(L):\"\";let W=h?.get(R);null==W&&(W=new T(S,G),h?.add(R,W));const F=m.placement.translation,M=P?s(P.displayWidth,P.displayHeight):i,V=m.placement.centerOffset,$=H,k=y?a(0,0,0,0):null,N=D(W,$,F,null,null,M,V,k,null),q=C(this._context,l,N,v,O);if(null==q)return null;const B=(t,r,n,s,i,o)=>{const l=x()||m.placement.elevationOffset,a=this.setGraphicElevationContext(e,r,l);return f(t,a,n,s,i,o)},J=new d(this,q.object,[N],null==h?[W]:null,E,B,v);J.alignedSampledElevation=q.sampledElevation,J.needsElevationUpdates=p(v.mode)||\"absolute-height\"===v.mode,J.getScreenSize=(e=o())=>(e[0]=P?P.displayWidth:m.displaySize[0],e[1]=P?P.displayHeight:m.displaySize[1],e);const Y=new g(m.placement.elevationOffset,c);return J.metadata=Y,z(J,l,this._context.elevationProvider),J}}function F(e,t,r){e&&e.forEach((e=>{const n=t(e);null!=n&&r(n,e.graphic)}))}function I(e,t){if(\"baseline\"===t.verticalPlacement){const r=E[t.horizontalPlacement],n=null!=e?e.baselineAnchorY:0;return s(r,n)}const r=_(t.horizontalPlacement,t.verticalPlacement);return w[r]}const M={mode:\"relative-to-ground\",offset:0};export{W as Graphics3DTextSymbolLayer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../Color.js\";import{getMetersPerUnitForSR as t}from\"../../../../core/unitUtils.js\";import{e as r}from\"../../../../chunks/earcut.js\";import{set as o}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{fromValues as i,create as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{d as s}from\"../../../../chunks/vec42.js\";import{toRadian as a}from\"../../../../core/libs/gl-matrix-2/math/common.js\";import{create as l,fromBuffer as c,intersectsClippingArea as h,empty as m,expandWithAABB as u}from\"../../../../geometry/support/aaBoundingBox.js\";import{create as p,empty as d,expandPointInPlace as g}from\"../../../../geometry/support/aaBoundingRect.js\";import{newDoubleArray as y,doubleSubArray as f}from\"../../../../geometry/support/DoubleArray.js\";import{perVertexElevationAligner as _}from\"./ElevationAligners.js\";import{SymbolUpdateType as x,elevationModeChangeUpdateType as v,needsElevationUpdates2D as b}from\"./elevationAlignmentUtils.js\";import{Graphics3DDrapedGraphicLayer as C}from\"./Graphics3DDrapedGraphicLayer.js\";import{Graphics3DObject3DGraphicLayer as D}from\"./Graphics3DObject3DGraphicLayer.js\";import{Graphics3DSymbolLayer as j}from\"./Graphics3DSymbolLayer.js\";import{geometryAsPolygon as S,createWaterGeometry as w,PolygonCreationDataBase as G}from\"./polygonUtils.js\";import{geometryToRenderInfo as E,geometryToRenderInfoDraped as A}from\"../../support/renderInfoUtils/polygon.js\";import{Object3D as L}from\"../../webgl-engine/lib/Object3D.js\";import{RenderGeometry as O}from\"../../webgl-engine/lib/RenderGeometry.js\";import{Parameters as P,WaterMaterial as T}from\"../../webgl-engine/materials/WaterMaterial.js\";import{wavePresets as R}from\"../../webgl-engine/materials/internal/waterMaterialUtils.js\";const I=[\"polyline\",\"polygon\",\"extent\"];class B extends j{constructor(e,t,r,o){super(e,t,r,o)}async doLoad(){}destroy(){super.destroy(),this._context.stage.remove(this._materials[0]),this._materials.length=0}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,I,this.symbolLayer.type))return null;const r=this.setGraphicElevationContext(t);return this.ensureDrapedStatus(\"on-the-ground\"===r.mode),this.ensureMaterial(),this.draped?this._createAsOverlay(t):this._createAs3DShape(t,r,t.uid)}ensureMaterial(){if(this._materials[0])return;const t=new P,r=this.symbolLayer.color;null!=r&&(t.color=e.toUnitRGBA(r));const o=this._getCombinedOpacity(r,{hasIntrinsicColor:!0});t.color=[t.color[0],t.color[1],t.color[2],o],t.transparent=o<1||this.needsDrivenTransparentPass,t.waveDirection=null!=this.symbolLayer.waveDirection?U(this.symbolLayer.waveDirection):i(0,0);const n=this.symbolLayer.waveStrength+\"-\"+this.symbolLayer.waterbodySize,s=R[n];t.waveStrength=s.waveStrength,t.waveTextureRepeat=s.textureRepeat,t.waveVelocity=s.waveVelocity,t.flowStrength=s.perturbationStrength,t.hasSlicePlane=this._context.slicePlaneEnabled,t.draped=this.draped,this._materials[0]=new T(t,this._context),this._context.stage.add(this._materials[0])}layerOpacityChanged(){if(null==this._materials[0])return;const e=this._materials[0].parameters.color,t=this._getCombinedOpacity(this.symbolLayer.color,{hasIntrinsicColor:!0}),r=t<1||this.needsDrivenTransparentPass;this._materials[0].setParameters({color:[e[0],e[1],e[2],t],transparent:r})}layerElevationInfoChanged(e,t,r){const o=this._elevationContext.mode,i=v(B.elevationModeChangeTypes,r,o);if(i!==x.UPDATE)return i;const n=b(o);return this.updateGraphics3DGraphicElevationInfo(e,t,(()=>n))}slicePlaneEnabledChanged(){return this._materials[0]?.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}_createAs3DShape(e,t,r){const o=S(e.geometry);if(null==o)return null;const i=E(o,this._context.elevationProvider,this._context.renderCoordsHelper,t),n=i.position.length/3,s=y(2*n);M(s,i.mapPositions,n,this._context.elevationProvider.spatialReference);const a=new N(i,s,this._context.layer.uid,e.uid);if(a.objectAndLayerIdColor=this._context.stage.renderView?.getObjectAndLayerIdColor(a),this._create3DShapeGeometries(a),this._logGeometryCreationWarnings(a.renderData,o.rings,\"rings\",\"WaterSymbol3DLayer\"),0===a.outGeometries.length)return null;const l=new L({geometries:a.outGeometries,castShadow:!1,layerUid:this._context.layer.uid,graphicUid:r}),c=new D(this,l,a.outGeometries,null,null,_,t);return c.alignedSampledElevation=a.renderData.sampledElevation,c.needsElevationUpdates=b(t.mode),c}_create3DShapeGeometries(e){const t=e.renderData.polygons,o=e.uvCoords;for(const{count:i,index:n,position:s,mapPositions:a,holeIndices:l}of t){if(null!=this._context.clippingExtent&&(c(a,k),!h(k,this._context.clippingExtent)))continue;const t=r(a,l,3);if(0===t.length)continue;const m=f(o,2*n,2*i),u=w({material:this._materials[0],indices:t,mapPositions:a,attributeData:{position:s,uv0:m}},e.objectAndLayerIdColor);e.outGeometries.push(u)}}_createAsOverlay(e){const t=S(e.geometry);if(null==t)return null;this._materials[0].renderPriority=this._renderPriority;const r=A(t,this._context.overlaySR),o=r.position.length/3,i=y(2*o);M(i,r.position,o,this._context.overlaySR);const n=new H(r,i,this._context.layer.uid,e.uid);return n.objectAndLayerIdColor=this._context.stage.renderView?.getObjectAndLayerIdColor(n),n.outBoundingBox=m(),this._createAsOverlayWater(n),this._logGeometryCreationWarnings(n.renderData,t.rings,\"rings\",\"WaterSymbol3DLayer\"),0===n.outGeometries.length?null:new C(this,n.outGeometries,n.outBoundingBox,this._context.drapeSourceRenderer)}_createAsOverlayWater(e){const t=e.uvCoords,o=e.renderData.polygons;for(const{position:i,holeIndices:n,index:s,count:a}of o){if(c(i,k),!h(k,this._context.clippingExtent))continue;u(e.outBoundingBox,k);const o=r(i,n,3);if(0===o.length)continue;const l=f(t,2*s,2*a),m=w({material:this._materials[0],indices:o,attributeData:{position:i,uv0:l}},e.objectAndLayerIdColor);e.outGeometries.push(new O(m,e))}}test(){return{...super.test(),create3DShape:e=>this._createAs3DShape(e.graphic,e.elevationContext,e.graphicUid),ensureMaterial:()=>this.ensureMaterial()}}}function U(e){const t=n(),r=a(e);return t[0]=Math.sin(r),t[1]=Math.cos(r),t}function M(e,r,i,n){const a=t(n);d(z);for(let t=0;t<i;t++)o(V,r[3*t],r[3*t+1]),g(z,V);s(z,z,a);const l=z[0]%B.unitSizeOfTexture,c=z[1]%B.unitSizeOfTexture;W[0]=z[0]-l,W[1]=z[1]-c;for(let t=0;t<i;t++)e[2*t]=(r[3*t]*a-W[0])/B.unitSizeOfTexture,e[2*t+1]=(r[3*t+1]*a-W[1])/B.unitSizeOfTexture}B.unitSizeOfTexture=100,B.elevationModeChangeTypes={definedChanged:x.RECREATE,staysOnTheGround:x.NONE,onTheGroundChanged:x.RECREATE};const W=n(),z=p(),V=n(),k=l();class N extends G{constructor(e,t,r,o){super(e,r,o),this.uvCoords=t}}class H extends G{constructor(e,t,r,o){super(e,r,o),this.uvCoords=t}}export{B as Graphics3DWaterSymbolLayer,U as headingVectorFromAngle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as t}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{create as e}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as s}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";class i{constructor(i,r=\"center\",c=!1,a=t(),o=s(0,0,0,-1),l=\"world\",f=e(),n=0){this.verticalOffset=i,this.anchor=r,this.hasLabelVerticalOffset=c,this.screenOffset=a,this.centerOffset=o,this.centerOffsetUnits=l,this.translation=f,this.elevationOffset=n}}class r{constructor(e,s=\"center\",i=\"center\",r=null,c=t()){this.placement=e,this.horizontalPlacement=s,this.verticalPlacement=i,this.text=r,this.displaySize=c}}export{r as LabelParameters,i as LabelPlacement};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{DefaultMaterial as a}from\"../../webgl-engine/materials/DefaultMaterial.js\";class r{constructor(){this._fastTransformOriginalMaterials=new Map,this._fastTransformClonedMaterials=new Map,this._graphicReferenceCount=0}enable(r,t,e){r.enableFastTransformUpdates((r=>{if(this._graphicReferenceCount<=1){if(this._fastTransformOriginalMaterials.has(r))return r;const a=t.byMaterial(r);return this._fastTransformOriginalMaterials.set(r,a),t.delete(r),r}const s=new a(r.parameters,e);return e.stage.add(s),this._fastTransformClonedMaterials.set(s,r),s}),e.localOriginFactory)}disable(a,r,t){const e=new Set,s=new Set;a.disableFastTransformUpdates((a=>{if(!this._fastTransformClonedMaterials.has(a)){const t=a,i=this._fastTransformOriginalMaterials.get(t);return r.has(i.uid)?(e.add(t),r.byUid(i.uid).material):(s.add(t),i.material)}const i=a,n=this._fastTransformClonedMaterials.get(i);return this._fastTransformClonedMaterials.delete(i),t.stage.remove(i),n}));for(const i of e)this._fastTransformOriginalMaterials.delete(i),t.stage.remove(i);for(const i of s){const a=this._fastTransformOriginalMaterials.get(i);this._fastTransformOriginalMaterials.delete(i),r.set(a.uid,a)}}onAddGraphic(){this._graphicReferenceCount++}onRemoveGraphic(a,r,t){this._graphicReferenceCount--,this.disable(a,r,t)}forEachMaterialInfo(a){this._fastTransformOriginalMaterials.forEach(a)}forEachClonedMaterial(a){this._fastTransformClonedMaterials.forEach(a)}destroy(a){a.removeMany(Array.from(this._fastTransformClonedMaterials.keys())),a.removeMany(Array.from(this._fastTransformOriginalMaterials.values(),(({material:a})=>a))),this._fastTransformClonedMaterials.clear(),this._fastTransformOriginalMaterials.clear()}}class t{constructor(){this._byUid=new Map,this._byMaterial=new Map}get materials(){return Array.from(this._byUid.values(),(a=>a.material))}byUid(a){return this._byUid.get(a)}byMaterial(a){return this._byMaterial.get(a)}set(a,r){this._byUid.set(a,r),this._byMaterial.set(r.material,r)}delete(a){const r=this._byMaterial.get(a)?.uid;r&&(this._byUid.delete(r),this._byMaterial.delete(a))}has(a){return this._byUid.has(a)}forEachMaterialInfo(a){this._byUid.forEach(a)}clear(){this._byUid.clear(),this._byMaterial.clear()}}export{t as MaterialInfoCache,r as MeshFastUpdateProcessor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass s{constructor(){this.geometries=new Array,this.materials=new Array,this.textures=new Array}}class t{constructor(t,e,r){this.name=t,this.lodThreshold=e,this.pivotOffset=r,this.stageResources=new s,this.numberOfVertices=0}}export{t as ProcessedObjectResource,s as ProcessedObjectStageResources};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{CapType as e}from\"../../webgl-engine/shaders/RibbonLineTechniqueConfiguration.js\";function n(n){switch(n){case\"butt\":return e.BUTT;case\"square\":return e.SQUARE;case\"round\":return e.ROUND;default:return null}}function r(e){return\"diamond\"===e?\"kite\":e}export{n as parseCapType,r as parseLineMarkerStyle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{LodResources as e,LodComponentResources as n,LodLevelResources as o}from\"../../webgl-engine/lib/lodRendering/LodResources.js\";function r(e,r){const t=e.stageResources.geometries.map((o=>new n(o,e.stageResources.textures))),u=null==e.lodThreshold||0===e.lodThreshold&&r>0?s(t):e.lodThreshold;return new o(t,u,e.pivotOffset)}function t(n){return new e(n.map(((e,n)=>r(e,n))))}function s(e){const n=e.reduce(((e,n)=>e+n.numTriangles),0);return Math.sqrt(n*u/Math.PI)}const u=20;export{t as makeLodResources};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst e={disableDelayMs:2e3};export{e as meshAutoFastUpdateConstants};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{adjustStaticAGOUrl as e}from\"../../../../core/devEnvironmentUtils.js\";import{hasScaling as t}from\"../../../../core/mathUtils.js\";import{normalFromMat4 as r,fromMat4 as o}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as i}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as n}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{ONES as a}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{t as l,d as u,E as c,l as m,n as f,m as d}from\"../../../../chunks/vec32.js\";import{create as p}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as g,expandWithVec3 as x}from\"../../../../geometry/support/aaBoundingBox.js\";import{newFloatArray as b}from\"../../../../geometry/support/FloatArray.js\";import{BufferViewVec4f as h,BufferViewVec4u8 as T,BufferViewVec4u16 as y,BufferViewVec3f as w,BufferViewVec3u8 as v,BufferViewVec3u16 as R}from\"../../../../geometry/support/buffer/BufferView.js\";import{t as j,b as B,n as M,f as S}from\"../../../../chunks/vec3.js\";import{t as F,b as A}from\"../../../../chunks/vec4.js\";import{a as E}from\"../../../../chunks/vec2.js\";import{c as O}from\"../../../../chunks/vec33.js\";import{a as C}from\"../../../../chunks/vec43.js\";import{DefaultLoadingContext as L}from\"../../glTF/DefaultLoadingContext.js\";import{convertPrimitiveToTriangles as I}from\"../../glTF/internal/indexUtils.js\";import{isEncodedMeshTexture as N}from\"../../glTF/internal/resourceUtils.js\";import{getTransformMatrix as k}from\"../../glTF/internal/TextureTransformUtils.js\";import{ProcessedObjectResource as P}from\"./ProcessedObjectResource.js\";import{load as U,processLoadResult as V}from\"./wosrLoader.js\";import{NormalType as _}from\"../../webgl-engine/core/shaderLibrary/attributes/NormalAttribute.glsl.js\";import{Attribute as D}from\"../../webgl-engine/lib/Attribute.js\";import{AlphaDiscardMode as G,DepthTestFunction as q,CullFaceOptions as W}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Geometry as H}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as $}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as z}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as K}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{colorGamma as Q}from\"../../webgl-engine/materials/DefaultMaterial_COLOR_GAMMA.js\";import{esriSymbologyMRRFactors as J,advancedMRRFactors as X,useSchematicPBR as Y,schematicMRRFactors as Z}from\"../../webgl-engine/materials/pbrUtils.js\";async function ee(t,r){const o=te(e(t));if(\"wosr\"===o.fileType){const e=await(r.cache?r.cache.loadWOSR(o.url,r):U(o.url,r)),{engineResources:t,referenceBoundingBox:s}=V(e,r);return{lods:t,referenceBoundingBox:s,isEsriSymbolResource:!1,isWosr:!0}}let s;if(r.cache)s=await r.cache.loadGLTF(o.url,r,!!r.usePBR);else{const{loadGLTF:e}=await import(/* webpackChunkName: \"glTF-loader\" */ \"../../glTF/loader.js\");s=await e(new L(r.streamDataRequester),o.url,r,r.usePBR)}const i=s.model.meta?.ESRI_proxyEllipsoid,n=s.meta.isEsriSymbolResource&&null!=i&&\"EsriRealisticTreesStyle\"===s.meta.ESRI_webstyle;n&&!s.customMeta.esriTreeRendering&&(s.customMeta.esriTreeRendering=!0,ae(s,i));const a=!!r.usePBR,l=s.meta.isEsriSymbolResource?{usePBR:a,isSchematic:!1,treeRendering:n,mrrFactors:J}:{usePBR:a,isSchematic:!1,treeRendering:!1,mrrFactors:X},u={...r.materialParameters,treeRendering:n},{engineResources:c,referenceBoundingBox:m}=re(s,l,u,r,o.specifiedLodIndex);return{lods:c,referenceBoundingBox:m,isEsriSymbolResource:s.meta.isEsriSymbolResource,isWosr:!1}}function te(e){const t=e.match(/(.*\\.(gltf|glb))(\\?lod=([0-9]+))?$/);if(t)return{fileType:\"gltf\",url:t[1],specifiedLodIndex:null!=t[4]?Number(t[4]):null};return e.match(/(.*\\.(json|json\\.gz))$/)?{fileType:\"wosr\",url:e,specifiedLodIndex:null}:{fileType:\"unknown\",url:e,specifiedLodIndex:null}}function re(e,t,r,o,s){const i=e.model,n=new Array,a=new Map,l=new Map,u=i.lods.length,c=g();return i.lods.forEach(((e,m)=>{const f=!0===o.skipHighLods&&(u>1&&0===m||u>3&&1===m)||!1===o.skipHighLods&&null!=s&&m!==s;if(f&&0!==m)return;const d=new P(e.name,e.lodThreshold,[0,0,0]);e.parts.forEach((e=>{const s=f?new K({},o):oe(i,e,d,t,r,a,l,o),{geometry:n,vertexCount:u}=se(e,s??new K({},o)),p=n.boundingInfo;null!=p&&0===m&&(x(c,p.bbMin),x(c,p.bbMax)),null!=s&&(d.stageResources.geometries.push(n),d.numberOfVertices+=u)})),f||n.push(d)})),{engineResources:n,referenceBoundingBox:c}}function oe(e,t,r,o,s,i,n,l){const u=t.material+(t.attributes.normal?\"_normal\":\"\")+(t.attributes.color?\"_color\":\"\")+(t.attributes.texCoord0?\"_texCoord0\":\"\")+(t.attributes.tangent?\"_tangent\":\"\"),c=e.materials.get(t.material),m=null!=t.attributes.texCoord0,f=null!=t.attributes.normal;if(null==c)return null;const d=ne(c.alphaMode);if(!i.has(u)){if(m){const t=(t,r=!1)=>{if(null!=t&&!n.has(t)){const o=e.textures.get(t);if(null!=o){const e=o.data;n.set(t,new $(N(e)?e.data:e,{...o.parameters,preMultiplyAlpha:!N(e)&&r,encoding:N(e)&&null!=e.encoding?e.encoding:void 0}))}}};t(c.textureColor,d!==G.Opaque),t(c.textureNormal),t(c.textureOcclusion),t(c.textureEmissive),t(c.textureMetallicRoughness)}const r=c.color[0]**(1/Q),p=c.color[1]**(1/Q),g=c.color[2]**(1/Q),x=c.emissiveFactor[0]**(1/Q),b=c.emissiveFactor[1]**(1/Q),h=c.emissiveFactor[2]**(1/Q),T=null!=c.textureColor&&m?n.get(c.textureColor):null,y=Y({normalTexture:c.textureNormal,metallicRoughnessTexture:c.textureMetallicRoughness,metallicFactor:c.metallicFactor,roughnessFactor:c.roughnessFactor,emissiveTexture:c.textureEmissive,emissiveFactor:c.emissiveFactor,occlusionTexture:c.textureOcclusion}),w=null!=c.normalTextureTransform?.scale?c.normalTextureTransform?.scale:a;i.set(u,new K({...o,transparent:d===G.Blend,customDepthTest:q.Lequal,textureAlphaMode:d,textureAlphaCutoff:c.alphaCutoff,diffuse:[r,p,g],ambient:[r,p,g],opacity:c.opacity,doubleSided:c.doubleSided,doubleSidedType:\"winding-order\",cullFace:c.doubleSided?W.None:W.Back,hasVertexColors:!!t.attributes.color,hasVertexTangents:!!t.attributes.tangent,normalType:f?_.Attribute:_.ScreenDerivative,castShadows:!0,receiveShadows:c.receiveShadows,receiveAmbientOcclusion:c.receiveAmbientOcclustion,textureId:null!=T?T.id:void 0,colorMixMode:c.colorMixMode,normalTextureId:null!=c.textureNormal&&m?n.get(c.textureNormal).id:void 0,textureAlphaPremultiplied:null!=T&&!!T.parameters.preMultiplyAlpha,occlusionTextureId:null!=c.textureOcclusion&&m?n.get(c.textureOcclusion).id:void 0,emissiveTextureId:null!=c.textureEmissive&&m?n.get(c.textureEmissive).id:void 0,metallicRoughnessTextureId:null!=c.textureMetallicRoughness&&m?n.get(c.textureMetallicRoughness).id:void 0,emissiveFactor:[x,b,h],mrrFactors:y?Z:[c.metallicFactor,c.roughnessFactor,o.mrrFactors[2]],isSchematic:y,colorTextureTransformMatrix:k(c.colorTextureTransform),normalTextureTransformMatrix:k(c.normalTextureTransform),scale:[w[0],w[1]],occlusionTextureTransformMatrix:k(c.occlusionTextureTransform),emissiveTextureTransformMatrix:k(c.emissiveTextureTransform),metallicRoughnessTextureTransformMatrix:k(c.metallicRoughnessTextureTransform),...s},l))}const p=i.get(u);if(r.stageResources.materials.push(p),m){const e=e=>{null!=e&&r.stageResources.textures.push(n.get(e))};e(c.textureColor),e(c.textureNormal),e(c.textureOcclusion),e(c.textureEmissive),e(c.textureMetallicRoughness)}return p}function se(e,s){const i=e.attributes.position.count,n=I(e.indices||i,e.primitiveType),a=b(3*i),{typedBuffer:l,typedBufferStride:u}=e.attributes.position;j(a,l,e.transform,3,u);const c=[[z.POSITION,new D(a,n,3,!0)]];if(null!=e.attributes.normal){const o=b(3*i),{typedBuffer:s,typedBufferStride:a}=e.attributes.normal;r(ie,e.transform),B(o,s,ie,3,a),t(ie)&&M(o,o),c.push([z.NORMAL,new D(o,n,3,!0)])}if(null!=e.attributes.tangent){const r=b(4*i),{typedBuffer:s,typedBufferStride:a}=e.attributes.tangent;o(ie,e.transform),F(r,s,ie,4,a),t(ie)&&M(r,r,4),c.push([z.TANGENT,new D(r,n,4,!0)])}if(null!=e.attributes.texCoord0){const t=b(2*i),{typedBuffer:r,typedBufferStride:o}=e.attributes.texCoord0;E(t,r,2,o),c.push([z.UV0,new D(t,n,2,!0)])}const m=e.attributes.color;if(null!=m){const t=new Uint8Array(4*i);4===m.elementCount?m instanceof h?A(t,m,255):m instanceof T?C(t,m):m instanceof y&&A(t,m,1/256):(t.fill(255),m instanceof w?S(t,m.typedBuffer,255,4,m.typedBufferStride):e.attributes.color instanceof v?O(t,m.typedBuffer,4,e.attributes.color.typedBufferStride):e.attributes.color instanceof R&&S(t,m.typedBuffer,1/256,4,m.typedBufferStride)),c.push([z.COLOR,new D(t,n,4,!0)])}return{geometry:new H(s,c),vertexCount:i}}const ie=s();function ne(e){switch(e){case\"BLEND\":return G.Blend;case\"MASK\":return G.Mask;case\"OPAQUE\":case null:case void 0:return G.Opaque}}function ae(e,t){for(let r=0;r<e.model.lods.length;++r){const o=e.model.lods[r];for(const s of o.parts){const o=s.attributes.normal;if(null==o)return;const a=s.attributes.position,g=a.count,x=p(),b=p(),h=p(),y=new Uint8Array(4*g),v=new Float64Array(3*g),R=i(n(),s.transform);let j=0,B=0;for(let i=0;i<g;i++){a.getVec(i,b),o.getVec(i,x),l(b,b,s.transform),u(h,b,t.center),c(h,h,t.radius);const n=h[2],p=m(h),g=Math.min(.45+.55*p*p,1);c(h,h,t.radius),null!==R&&l(h,h,R),f(h,h),r+1!==e.model.lods.length&&e.model.lods.length>1&&d(h,h,x,n>-1?.2:Math.min(-4*n-3.8,1)),v[j]=h[0],v[j+1]=h[1],v[j+2]=h[2],j+=3,y[B]=255*g,y[B+1]=255*g,y[B+2]=255*g,y[B+3]=255,B+=4}s.attributes.normal=new w(v),s.attributes.color=new T(y)}}}export{ee as fetch,te as parseUrl};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{copy as t,set as e}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{fromValues as r,ZEROS as o}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{TextRenderAlignment as c,textVerticalPaddingPx as n}from\"../../webgl-engine/lib/TextRenderer.js\";const i=Object.freeze({left:0,center:.5,right:1}),s=Object.freeze({\"bottom-left\":r(0,0),bottom:r(.5,0),\"bottom-right\":r(1,0),left:r(0,.5),center:r(.5,.5),right:r(1,.5),\"top-left\":r(0,1),top:r(.5,1),\"top-right\":r(1,1)});function f(t){switch(t){case\"left\":return c.Left;case\"right\":return c.Right;default:return c.Center}}function a(t){switch(t){case\"bottom-left\":case\"left\":case\"top-left\":return\"left\";case\"bottom\":case\"center\":case\"top\":return\"center\";case\"bottom-right\":case\"right\":case\"top-right\":return\"right\"}}function l(t){switch(t){case\"bottom-left\":case\"bottom\":case\"bottom-right\":return\"bottom\";case\"left\":case\"center\":case\"right\":return\"center\";case\"top-left\":case\"top\":case\"top-right\":return\"top\"}}function m(t,e){switch(e){case\"bottom\":return\"left\"===t?\"bottom-left\":\"right\"===t?\"bottom-right\":\"bottom\";case\"center\":return t;case\"top\":return\"left\"===t?\"top-left\":\"right\"===t?\"top-right\":\"top\"}}function u(t){return\"middle\"===t?\"center\":t}function h(r,c){switch(r){case\"top\":return e(c,0,n);case\"bottom\":return e(c,0,-n);default:return t(c,o)}}export{m as anchorFromPlacements,a as horizontalPlacementFromAnchor,i as horizontalPlacementToAnchorX,s as namedAnchorToHUDMaterialAnchorPos,f as textRenderAlignmentFromHorizontalPlacement,u as verticalPlacementFromAlignment,l as verticalPlacementFromAnchor,h as verticalScreenOffsetFromAlignment};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../geometry.js\";import{e as t}from\"../../../../chunks/earcut.js\";import{Axis as e}from\"../../../../geometry/support/Axis.js\";import{getZeroIndexArray as r}from\"../../../../geometry/support/Indices.js\";import{leastSignificantAxis as i}from\"../../../../geometry/support/polygonUtils.js\";import{Attribute as o}from\"../../webgl-engine/lib/Attribute.js\";import{ContentObjectType as n}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as a}from\"../../webgl-engine/lib/Geometry.js\";import{VertexAttribute as s}from\"../../webgl-engine/lib/VertexAttribute.js\";import u from\"../../../../geometry/Extent.js\";import c from\"../../../../geometry/Polygon.js\";function p(r,o,n){const a=(o.length>0?o[0]:r.length/3)-1,s=i(r,a,n);if(s!==e.Z){r=r.slice();for(let t=0;t<r.length;t+=3)r[t+s]=r[t+2]}return t(r,o,3)}function m(t){const e=[[s.POSITION,new o(t.attributeData.position,t.indices,3,!0)]],i=r(t.indices.length);return null!=t.attributeData.colorFeature?e.push([s.COLORFEATUREATTRIBUTE,new o([t.attributeData.colorFeature],i,1,!0)]):t.attributeData.color&&e.push([s.COLOR,new o(t.attributeData.color,i,4,!0)]),t.attributeData.uvMapSpace&&e.push([s.UVMAPSPACE,new o(t.attributeData.uvMapSpace,t.indices,4,!0)]),t.attributeData.boundingRect&&e.push([s.BOUNDINGRECT,new o(t.attributeData.boundingRect,t.indices,9,!0)]),new a(t.material,e,t.mapPositions,n.Mesh,t.attributeData.objectAndLayerIdColor)}function l(t,e=null){const r=[[s.POSITION,new o(t.attributeData.position,t.indices,3,!0)],[s.UV0,new o(t.attributeData.uv0,t.indices,2,!0)]];return new a(t.material,r,t.mapPositions,n.Mesh,e)}function b(t){switch(t.type){case\"extent\":if(t instanceof u)return c.fromExtent(t);break;case\"polygon\":return t}return null}class g{constructor(t,e,r){this.renderData=t,this.layerUid=e,this.graphicUid=r,this.outGeometries=new Array}}export{g as PolygonCreationDataBase,m as createColorGeometry,p as createIndices3D,l as createWaterGeometry,b as geometryAsPolygon};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport l from\"../../../../core/Error.js\";import{fetchStyle as t,symbolUrlFromStyleItem as s}from\"../../../../symbols/support/styleUtils.js\";import{getStyleItemFromStyle as e,fetchSymbolFromStyle as n}from\"../../../../symbols/support/webStyleSymbolUtils.js\";async function r(r){if(null===r||null==r.styleName&&null==r.styleUrl)return null;const o=r.name;if(null==o)throw new l(\"symbolstyleutils:style-symbol-reference-name-missing\",\"Missing name in style symbol reference\");const u={portal:r.portal},i=await t(r,u).catch((()=>null));if(null===i)return null;const m=e(o,i.data);if(m&&!m.formatInfos?.some((l=>\"gltf_basisu\"===l.type)))return null;const a=await n(i,o,u,\"webRef\",((l,t)=>s(l,t,[\"gltf_basisu\",\"gltf\"]))).catch((()=>null));if(null===a||\"point-3d\"!==a.type)return null;const y=a.symbolLayers.items[0];return\"object\"===y.type?y.resource:null}export{r as getResourceUrlFromSymbolStyle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../request.js\";import{result as t}from\"../../../../core/asyncUtils.js\";import{estimateNestedObjectSize as r}from\"../../../../core/byteSizeEstimations.js\";import n from\"../../../../core/Error.js\";import s from\"../../../../core/Logger.js\";import{NestedMap as a}from\"../../../../core/NestedMap.js\";import{throwIfAbortError as o}from\"../../../../core/promiseUtils.js\";import{Version as i}from\"../../../../core/Version.js\";import{fromArray as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as u,expandWithVec3 as c}from\"../../../../geometry/support/aaBoundingBox.js\";import{getContinuousIndexArray as m}from\"../../../../geometry/support/Indices.js\";import{requestImage as p}from\"../../../../support/requestImageUtils.js\";import{Attribute as f}from\"../../webgl-engine/lib/Attribute.js\";import{CullFaceOptions as d,AlphaDiscardMode as g}from\"../../webgl-engine/lib/basicInterfaces.js\";import{Geometry as y}from\"../../webgl-engine/lib/Geometry.js\";import{Texture as b}from\"../../webgl-engine/lib/Texture.js\";import{VertexAttribute as w}from\"../../webgl-engine/lib/VertexAttribute.js\";import{DefaultMaterial as x}from\"../../webgl-engine/materials/DefaultMaterial.js\";import{TextureWrapMode as h}from\"../../../webgl/enums.js\";const v=()=>s.getLogger(\"esri.views.3d.layers.graphics.objectResourceUtils\");async function A(e,t){const n=await j(e,t),s=await E(n.textureDefinitions??{},t);let a=0;for(const r in s)if(s.hasOwnProperty(r)){const e=s[r];a+=e?.image?e.image.width*e.image.height*4:0}return{resource:n,textures:s,size:a+r(n)}}async function j(r,n){const s=n?.streamDataRequester;if(s)return I(r,s,n);const a=await t(e(r,n));if(!0===a.ok)return a.value.data;o(a.error),P(a.error)}async function I(e,r,n){const s=await t(r.request(e,\"json\",n));if(!0===s.ok)return s.value;o(s.error),P(s.error.details.url)}function P(e){throw new n(\"\",`Request for object resource failed: ${e}`)}function M(e){const t=e.params,r=t.topology;let n=!0;switch(t.vertexAttributes||(v().warn(\"Geometry must specify vertex attributes\"),n=!1),t.topology){case\"PerAttributeArray\":break;case\"Indexed\":case null:case void 0:{const e=t.faces;if(e){if(t.vertexAttributes)for(const r in t.vertexAttributes){const t=e[r];t?.values?(null!=t.valueType&&\"UInt32\"!==t.valueType&&(v().warn(`Unsupported indexed geometry indices type '${t.valueType}', only UInt32 is currently supported`),n=!1),null!=t.valuesPerElement&&1!==t.valuesPerElement&&(v().warn(`Unsupported indexed geometry values per element '${t.valuesPerElement}', only 1 is currently supported`),n=!1)):(v().warn(`Indexed geometry does not specify face indices for '${r}' attribute`),n=!1)}}else v().warn(\"Indexed geometries must specify faces\"),n=!1;break}default:v().warn(`Unsupported topology '${r}'`),n=!1}e.params.material||(v().warn(\"Geometry requires material\"),n=!1);const s=e.params.vertexAttributes;for(const a in s){s[a].values||(v().warn(\"Geometries with externally defined attributes are not yet supported\"),n=!1)}return n}function T(e,t){const r=new Array,n=new Array,s=new Array,o=new a,u=e.resource,c=i.parse(u.version||\"1.0\",\"wosr\");q.validate(c);const p=u.model.name,g=u.model.geometries,h=u.materialDefinitions??{},v=e.textures;let A=0;const j=new Map;for(let a=0;a<g.length;a++){const e=g[a];if(!M(e))continue;const i=k(e),u=e.params.vertexAttributes,c=[],p=t=>{if(\"PerAttributeArray\"===e.params.topology)return null;const r=e.params.faces;for(const e in r)if(e===t)return r[e].values;return null},I=u[w.POSITION],P=I.values.length/I.valuesPerElement;for(const t in u){const e=u[t],r=e.values,n=p(t)??m(P);c.push([t,new f(r,n,e.valuesPerElement,!0)])}const T=i.texture,U=v&&v[T];if(U&&!j.has(T)){const{image:e,parameters:t}=U,r=new b(e,t);n.push(r),j.set(T,r)}const E=j.get(T),q=E?E.id:void 0,R=i.material;let B=o.get(R,T);if(null==B){const e=h[R.slice(R.lastIndexOf(\"/\")+1)].params;1===e.transparency&&(e.transparency=0);const r=U&&U.alphaChannelUsage,n=e.transparency>0||\"transparency\"===r||\"maskAndTransparency\"===r,s=U?O(U.alphaChannelUsage):void 0,a={ambient:l(e.diffuse),diffuse:l(e.diffuse),opacity:1-(e.transparency||0),transparent:n,textureAlphaMode:s,textureAlphaCutoff:.33,textureId:q,initTextureTransparent:!0,doubleSided:!0,cullFace:d.None,colorMixMode:e.externalColorMixMode||\"tint\",textureAlphaPremultiplied:U?.parameters.preMultiplyAlpha??!1};t?.materialParameters&&Object.assign(a,t.materialParameters),B=new x(a,t),o.set(R,T,B)}s.push(B);const C=new y(B,c);A+=c.find((e=>e[0]===w.POSITION))?.[1]?.indices.length??0,r.push(C)}return{engineResources:[{name:p,stageResources:{textures:n,materials:s,geometries:r},pivotOffset:u.model.pivotOffset,numberOfVertices:A,lodThreshold:null}],referenceBoundingBox:U(r)}}function U(e){const t=u();return e.forEach((e=>{const r=e.boundingInfo;null!=r&&(c(t,r.bbMin),c(t,r.bbMax))})),t}async function E(e,t){const r=new Array;for(const a in e){const n=e[a],s=n.images[0].data;if(!s){v().warn(\"Externally referenced texture data is not yet supported\");continue}const o=n.encoding+\";base64,\"+s,i=\"/textureDefinitions/\"+a,l=\"rgba\"===n.channels?n.alphaChannelUsage||\"transparency\":\"none\",u={noUnpackFlip:!0,wrap:{s:h.REPEAT,t:h.REPEAT},preMultiplyAlpha:O(l)!==g.Opaque},c=t?.disableTextures?Promise.resolve(null):p(o,t);r.push(c.then((e=>({refId:i,image:e,parameters:u,alphaChannelUsage:l}))))}const n=await Promise.all(r),s={};for(const a of n)s[a.refId]=a;return s}function O(e){switch(e){case\"mask\":return g.Mask;case\"maskAndTransparency\":return g.MaskBlend;case\"none\":return g.Opaque;default:return g.Blend}}function k(e){const t=e.params;return{id:1,material:t.material,texture:t.texture,region:t.texture}}const q=new i(1,2,\"wosr\");export{E as createTextureResources,A as load,T as processLoadResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{fromValues as t}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{perVertexElevationAligner as e}from\"../graphics/ElevationAligners.js\";import{createMapSpaceUVCoords as r}from\"./uvUtils.js\";import{VertexAttribute as a}from\"../../webgl-engine/lib/VertexAttribute.js\";import{ColorMaterial as o}from\"../../webgl-engine/materials/ColorMaterial.js\";import{PatternMaterial as n}from\"../../webgl-engine/materials/PatternMaterial.js\";import{Style as i}from\"../../webgl-engine/materials/PatternStyle.js\";function s(e,r){const a=e?.pattern;return null==a?new o(r):\"none\"===a.style||\"solid\"===a.style?(\"none\"===a.style&&(r.color=t(0,0,0,0),r.forceTransparentMode=!0),new o(r)):(r.style=l(a.style),new n(r))}function l(t){switch(t){case\"horizontal\":return i.Horizontal;case\"vertical\":return i.Vertical;case\"cross\":return i.Cross;case\"forward-diagonal\":return i.ForwardDiagonal;case\"backward-diagonal\":return i.BackwardDiagonal;case\"diagonal-cross\":return i.DiagonalCross;default:return}}function c(t){return t.material instanceof n&&!t.material.parameters.draped}function u(t,e){if(c(t)){const o=t.attributes.get(a.POSITION).data,n=t.getMutableAttribute(a.UVMAPSPACE).data,i=t.getMutableAttribute(a.BOUNDINGRECT).data;r(n,i,o,e)}}function m(t,r,a,o,n){const i=e(t,r,a,o,n),s=t.stageObject.geometries;for(const e of s)u(e,n);return i}export{s as createMaterial,l as parsePatternStyle,c as requiresUVUpdates,u as updateMapSpaceUVCoords,m as uvElevationAligner};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as t}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{set as o}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as r}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as e,f as s,d as i,h as a,g as m,c as n,b as c,n as l,e as f}from\"../../../../chunks/vec32.js\";import{create as I}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{getReferenceEllipsoid as h}from\"../../../../geometry/ellipsoidUtils.js\";import{lonLatToWebMercatorComparable as p}from\"../../../../geometry/projection/projectors.js\";import{newDoubleArray as N}from\"../../../../geometry/support/DoubleArray.js\";import{create as g,fromArray as b,getNormal as u}from\"../../../../geometry/support/plane.js\";import{ViewingMode as j}from\"../../../ViewingMode.js\";function T(t,r,e,s,i=1){if(e.isGeographic&&s===j.Global){const t=N(r.length),o=r.length,s=h(e);for(let e=0;e<o;e+=3)p(r,e,t,e,s);r=t}o(y,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(let o=0;o<r.length;o+=3)y[0]=Math.min(y[0],r[o]),y[1]=Math.min(y[1],r[o+1]);const a=y[0]%i,m=y[1]%i,n=y[0]-a,c=y[1]-m;for(let o=0;o<r.length;o+=3){const e=o/3*4;t[e]=(r[o]-n)/i,t[e+1]=(r[o+1]-c)/i,t[e+2]=n/i,t[e+3]=c/i}}function M(t,r,n,c,l=1){e(F,1,0,0),e(Y,0,1,0),e(_,0,0,1),D(x,n),b(V,n)&&O(V,F,Y,_,c,x),o(y,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o(P,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let o=0;o<n.length;o+=3){e(E,n[o],n[o+1],n[o+2]);const t=s(F,E),r=s(Y,E);y[0]=Math.min(y[0],t),y[1]=Math.min(y[1],r),P[0]=Math.max(P[0],t),P[1]=Math.max(P[1],r)}const f=s(_,x);q(v,y[0],y[1],f,F,Y,_),q(A,P[0],y[1],f,F,Y,_),q(G,y[0],P[1],f,F,Y,_),i(A,A,v),a(A,A,.5),i(G,G,v),a(G,G,.5),m(v,v,A),m(v,v,G);const I=y[0]%l,h=y[1]%l,p=y[0]-I,N=y[1]-h;for(let o=0;o<n.length;o+=3){e(E,n[o],n[o+1],n[o+2]);const i=o/3,a=4*i;t[a]=(s(F,E)-p)/l,t[a+1]=(s(Y,E)-N)/l,t[a+2]=p/l,t[a+3]=N/l;const m=9*i;for(let t=0;t<3;t++)r[m+t]=v[t],r[m+t+3]=A[t],r[m+t+6]=G[t]}}const x=I(),E=I(),V=g(),F=I(),Y=I(),_=I(),y=r(),P=r(),v=I(),A=I(),G=I();function O(t,o,r,i,m,I){null!=m?(m.basisMatrixAtPosition(I,S),e(d,S[0],S[1],S[2]),e(k,S[4],S[5],S[6]),e(w,S[8],S[9],S[10])):(e(d,1,0,0),e(k,0,1,0),e(w,0,0,1));const h=u(t);s(h,w)<0&&a(h,h,-1),n(i,h);const p=s(h,k),N=s(h,d);Math.abs(p)>Math.abs(N)?(c(o,d,h,-N),l(o,o),f(r,o,h),l(r,r),a(r,r,-1)):(c(r,k,h,-p),l(r,r),f(o,r,h),l(o,o))}const S=t(),d=I(),k=I(),w=I();function D(t,o){e(U,0,0,0);for(let r=0;r<o.length-3;r+=3)U[0]+=o[r],U[1]+=o[r+1],U[2]+=o[r+2];a(t,U,1/(o.length/3-1))}const U=I();function q(t,o,r,s,i,a,m){e(t,o*i[0]+r*a[0]+s*m[0],o*i[1]+r*a[1]+s*m[1],o*i[2]+r*a[2]+s*m[2])}export{M as createMapSpaceUVCoords,T as createMapSpaceUVCoordsDraped};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{DataType as e}from\"../../../webgl/enums.js\";import{VertexElementDescriptor as r}from\"../../../webgl/VertexElementDescriptor.js\";function t(e,t=0){const n=e.stride;return Array.from(e.fields.keys()).map((s=>{const i=e.fields.get(s),u=i.constructor.ElementCount,f=o(i.constructor.ElementType),c=i.offset,m=i.optional?.glNormalized??!1;return new r(s,u,f,c,n,m,t)}))}function o(e){const r=n[e];if(r)return r;throw new Error(\"BufferType not supported in WebGL\")}const n={u8:e.UNSIGNED_BYTE,u16:e.UNSIGNED_SHORT,u32:e.UNSIGNED_INT,i8:e.BYTE,i16:e.SHORT,i32:e.INT,f32:e.FLOAT};export{t as glLayout};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{set as t,dist as e}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as r}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{ONES as o}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{getReferenceEllipsoid as n}from\"../../../../geometry/ellipsoidUtils.js\";import{lonLatToWebMercatorComparable as i}from\"../../../../geometry/projection/projectors.js\";import{newDoubleArray as a}from\"../../../../geometry/support/DoubleArray.js\";import{newFloatArray as l}from\"../../../../geometry/support/FloatArray.js\";import{getZeroIndexArray as u}from\"../../../../geometry/support/Indices.js\";import{ViewingMode as s}from\"../../../ViewingMode.js\";import{Attribute as c}from\"../../webgl-engine/lib/Attribute.js\";import{ContentObjectType as p}from\"../../webgl-engine/lib/ContentObjectType.js\";import{Geometry as f}from\"../../webgl-engine/lib/Geometry.js\";import{VertexAttribute as m}from\"../../webgl-engine/lib/VertexAttribute.js\";function b(t,e,r=null){const o=[],n=e.mapPositions;g(e,o);const i=o[0][1].data,a=o[0][1].indices.length,l=u(a);return h(e,o,l),j(e,o,l),T(e,o,l),D(e,o,l),w(e,o,l),y(e,o,l),E(e,o,i),new f(t,o,n,p.Line,r)}function g(t,e){const{attributeData:{position:r},removeDuplicateStartEnd:o}=t,n=A(r)&&o,i=r.length/3-(n?1:0),a=new Array(2*(i-1)),l=n?r.slice(0,-3):r;let u=0;for(let s=0;s<i-1;s++)a[u++]=s,a[u++]=s+1;e.push([m.POSITION,new c(l,a,3,n)])}function h(t,e,r){if(null!=t.attributeData.colorFeature)return;const n=t.attributeData.color;e.push([m.COLOR,new c(n??o,r,4)])}function T(t,e,r){t.attributeData.normal&&e.push([m.NORMAL,new c(t.attributeData.normal,r,3)])}function D(t,e,r){null!=t.attributeData.colorFeature&&e.push([m.COLORFEATUREATTRIBUTE,new c([t.attributeData.colorFeature],r,1,!0)])}function j(t,e,r){null==t.attributeData.sizeFeature&&e.push([m.SIZE,new c([t.attributeData.size??1],r,1,!0)])}function w(t,e,r){null!=t.attributeData.sizeFeature&&e.push([m.SIZEFEATUREATTRIBUTE,new c([t.attributeData.sizeFeature],r,1,!0)])}function y(t,e,r){null!=t.attributeData.opacityFeature&&e.push([m.OPACITYFEATUREATTRIBUTE,new c([t.attributeData.opacityFeature],r,1,!0)])}function E(r,o,u){if(null==r.overlayInfo||r.overlayInfo.renderCoordsHelper.viewingMode!==s.Global||!r.overlayInfo.spatialReference.isGeographic)return;const p=a(u.length),f=n(r.overlayInfo.spatialReference);for(let t=0;t<p.length;t+=3)i(u,t,p,t,f);const b=u.length/3,g=l(b+1);let h=I,T=F,D=0,j=0;t(h,p[j++],p[j++]),j++,g[0]=0;for(let n=1;n<b+1;++n)n===b&&(j=0),t(T,p[j++],p[j++]),j++,D+=e(h,T),g[n]=D,[h,T]=[T,h];o.push([m.DISTANCETOSTART,new c(g,o[0][1].indices,1,!0)])}function A(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}const I=r(),F=r();function R(t,e){if(null==t||0===t.length)return[];const r=[];return t.forEach((t=>{const o=t.length,n=a(3*o);t.forEach(((t,e)=>{n[3*e]=t[0],n[3*e+1]=t[1],n[3*e+2]=t[2]}));const i={attributeData:{position:n,normal:e},removeDuplicateStartEnd:!1};r.push(i)})),r}export{b as createGeometry,R as lineStripsToParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{projectBuffer as o}from\"../../../../geometry/projection/projectBuffer.js\";import{newDoubleArray as e,doubleSubArray as t}from\"../../../../geometry/support/DoubleArray.js\";import{CounterClockwiseMode as n,ringsToTriangulationInfo as r}from\"../../../../geometry/support/triangulationUtils.js\";import{applyPerVertexElevationAlignment as i}from\"../../layers/graphics/elevationAlignmentUtils.js\";import{drapedZ as s}from\"../../terrain/OverlayRenderer.js\";function p(o,t,s,p){const l=\"polygon\"===o.type?n.CCW_IS_HOLE:n.NONE,a=\"polygon\"===o.type?o.rings:o.paths,{position:u,outlines:f}=r(a,!!o.hasZ,l,o.spatialReference),m=e(u.length),g=i(u,o.spatialReference,0,m,0,u,0,u.length/3,t,s,p),y=null!=g;return{lines:y?c(f,u,m):[],projectionSuccess:y,sampledElevation:g}}function l(e,t){const i=\"polygon\"===e.type?n.CCW_IS_HOLE:n.NONE,p=\"polygon\"===e.type?e.rings:e.paths,{position:l,outlines:a}=r(p,!1,i),u=o(l,e.spatialReference,0,l,t,0);for(let o=2;o<l.length;o+=3)l[o]=s;return{lines:u?c(a,l):[],projectionSuccess:u}}function c(o,e,n=null){const r=new Array;for(const{index:i,count:s}of o){if(s<=1)continue;const o=3*i,p=3*s;r.push({position:t(e,3*i,3*s),mapPositions:null!=n?t(n,o,p):void 0})}return r}export{p as geometryToRenderInfo,l as geometryToRenderInfoDraped};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{projectBuffer as o}from\"../../../../geometry/projection/projectBuffer.js\";import{newDoubleArray as t,doubleSubArray as n}from\"../../../../geometry/support/DoubleArray.js\";import{ringsToTriangulationInfo as s,CounterClockwiseMode as i}from\"../../../../geometry/support/triangulationUtils.js\";import{applyPerVertexElevationAlignment as e}from\"../../layers/graphics/elevationAlignmentUtils.js\";import{drapedZ as r}from\"../../terrain/OverlayRenderer.js\";function p(o,n,r,p){const c=s(o.rings,!!o.hasZ&&\"on-the-ground\"!==p.mode,i.CCW_IS_HOLE,o.spatialReference),a=t(c.position.length),h=e(c.position,o.spatialReference,0,a,0,c.position,0,c.position.length/3,n,r,p),m=null!=h;return new g(c.position,a,u(c.polygons,c.position,a),l(c.outlines,c.position,a),m,h)}function c(t,n){const e=s(t.rings,!1,i.CCW_IS_HOLE),p=o(e.position,t.spatialReference,0,e.position,n,0);for(let o=2;o<e.position.length;o+=3)e.position[o]=r;return{position:e.position,polygons:u(e.polygons,e.position),outlines:l(e.outlines,e.position),projectionSuccess:p}}function l(o,t,s=null){return o.filter((({count:o})=>o>1)).map((({index:o,count:i})=>{const e=3*o,r=3*i;return null!=s?new h(o,i,n(t,e,r),n(s,e,r)):new a(o,i,n(t,e,r))}))}function u(o,t,s=null){const i=new Array;for(const{index:e,count:r,holeIndices:p,pathLengths:c}of o){if(r<=1)continue;const o=3*e,l=3*r,u=p.map((o=>o-e)),a=null!=s?new m(e,r,n(t,3*e,3*r),n(s,o,l),u,c):new f(e,r,n(t,3*e,3*r),u,c);i.push(a)}return i}class a{constructor(o,t,n){this.index=o,this.count=t,this.position=n}}class h extends a{constructor(o,t,n,s){super(o,t,n),this.mapPositions=s}}class m extends h{constructor(o,t,n,s,i,e){super(o,t,n,s),this.holeIndices=i,this.pathLengths=e}}class f extends a{constructor(o,t,n,s,i){super(o,t,n),this.holeIndices=s,this.pathLengths=i}}class g{constructor(o,t,n,s,i,e){this.position=o,this.mapPositions=t,this.polygons=n,this.outlines=s,this.projectionSuccess=i,this.sampledElevation=e}}export{g as PolygonRenderInfo,m as PolygonVertexData,f as PolygonVertexDataDraped,p as geometryToRenderInfo,c as geometryToRenderInfoDraped};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{IntersectorType as e}from\"../webgl-engine/lib/IntersectorInterfaces.js\";import{Graphic3DTarget as r}from\"../webgl-engine/lib/IntersectorTarget.js\";import{isValidIntersectorResult as t}from\"../webgl-engine/lib/intersectorUtils.js\";function n(r){return t(r)&&r.intersector===e.TERRAIN&&!!r.target}class i extends r{constructor(e,r,t){super(e,r),this.triangleNr=t}}function o(r){return t(r)&&r.intersector===e.OVERLAY&&!!r.target}export{i as OverlayTarget,o as isOverlayIntersectorResult,n as isTerrainIntersectorResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as e,offset as t,copy as s}from\"../../../geometry/support/aaBoundingRect.js\";import{fromValues as i}from\"../webgl-engine/lib/LocalOriginFactory.js\";class n{constructor(){this._extent=e(),this.resolution=0,this.renderLocalOrigin=i(0,0,0,\"O\"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new r}get extent(){return this._extent}setupGeometryViewsCyclical(e){this.setupGeometryView();const s=.001*e.range;if(this._extent[0]-s<=e.min){const s=this.canvasGeometries.extents[this.canvasGeometries.numViews++];t(this._extent,e.range,0,s)}if(this._extent[2]+s>=e.max){const s=this.canvasGeometries.extents[this.canvasGeometries.numViews++];t(this._extent,-e.range,0,s)}}setupGeometryView(){this.canvasGeometries.numViews=1,s(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let e=0;e<this.canvasGeometries.numViews;e++){const t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}}class r{constructor(){this.extents=[e(),e(),e()],this.numViews=0}}export{n as Overlay};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar o;!function(o){o[o.Color=0]=\"Color\",o[o.ColorNoRasterImage=1]=\"ColorNoRasterImage\",o[o.Highlight=2]=\"Highlight\",o[o.WaterNormal=3]=\"WaterNormal\",o[o.Occluded=4]=\"Occluded\",o[o.ObjectAndLayerIdColor=5]=\"ObjectAndLayerIdColor\"}(o||(o={}));export{o as OverlayContent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{releaseMaybe as e}from\"../../../core/maybe.js\";class t{constructor(e,t,h){this._fbos=e,this._format=t,this._name=h}get valid(){return null!=this._handle?.getTexture()}dispose(){this._handle=e(this._handle)}get texture(){return this._handle?.getTexture()}bind(e,t,h){this._handle&&this._handle.fbo?.width===t&&this._handle.fbo?.height===h||(this._handle?.release(),this._handle=this._fbos.acquire(t,h,this._name,this._format)),e.bindFramebuffer(this._handle?.fbo)}generateMipMap(){this._handle?.getTexture()?.descriptor?.hasMipmap&&this._handle?.getTexture()?.generateMipmap()}}export{t as OverlayFramebufferObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{OverlayContent as e}from\"./OverlayContent.js\";import{OverlayFramebufferObject as r}from\"./OverlayFramebufferObject.js\";import{ColorFormat as o}from\"../webgl/formats.js\";import{ShaderOutput as t}from\"../webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{olidEnabled as l}from\"../webgl-engine/effects/geometry/olidUtils.js\";class s{constructor(e,t,l,s,i=o.RGBA_MIPMAP){this.output=l,this.content=s,this.fbo=new r(e,i,t)}get valid(){return this.fbo.valid}}class i{constructor(r){this.targets=[new s(r,\"overlay color\",t.Color,e.Color),new s(r,\"overlay IM color\",t.Color,e.ColorNoRasterImage),new s(r,\"overlay highlight\",t.Highlight,e.Highlight,o.RG),new s(r,\"overlay water\",t.Normal,e.WaterNormal),new s(r,\"overlay occluded\",t.Color,e.Occluded)],l()&&this.targets.push(new s(r,\"overlay olid\",t.ObjectAndLayerIdColor,e.ObjectAndLayerIdColor,o.RGBA))}getTexture(e){return this.targets[e]?.fbo.texture}dispose(){for(const e of this.targets)e.fbo.dispose()}computeValidity(){return this.targets.reduce(((e,r,o)=>r.valid?e|=1<<o:e),0)}}export{i as OverlayRenderTargets,s as RenderTargetDescriptor};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import r from\"../../../core/Evented.js\";import\"../../../core/has.js\";import{someMap as t}from\"../../../core/MapUtils.js\";import{disposeMaybe as s}from\"../../../core/maybe.js\";import i from\"../../../core/PooledArray.js\";import{watch as o,syncAndInitial as n,on as a}from\"../../../core/reactiveUtils.js\";import{someSet as h}from\"../../../core/SetUtils.js\";import{property as d}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{ortho as c,fromTranslation as u}from\"../../../core/libs/gl-matrix-2/math/mat4.js\";import{i as p}from\"../../../chunks/vec32.js\";import{ones as g}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{DrapeTargetType as m,DrapeSourceType as _,DrapedRenderGroup as y}from\"../layers/interfaces.js\";import{debugFlags as f}from\"../support/debugFlags.js\";import{OverlayIndex as R}from\"./interfaces.js\";import{Overlay as T}from\"./Overlay.js\";import{OverlayContent as w}from\"./OverlayContent.js\";import{OverlayRenderTargets as b}from\"./OverlayRenderTargets.js\";import D from\"../webgl/RenderCamera.js\";import{ShaderOutput as v}from\"../webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{OverlayMode as x}from\"../webgl-engine/core/shaderLibrary/terrain/Overlay.glsl.js\";import{T as S}from\"../../../chunks/TextureOnly.glsl.js\";import{SyncRenderPlugin as C}from\"../webgl-engine/effects/RenderPlugin.js\";import{trackHighlightOptions as O,renderHighlightBuffer as E}from\"../webgl-engine/effects/highlight/Highlight.js\";import{GLMaterialRepository as P}from\"../webgl-engine/lib/GLMaterialRepository.js\";import{GridLocalOriginFactory as j}from\"../webgl-engine/lib/GridLocalOriginFactory.js\";import{RenderOccludedFlag as A}from\"../webgl-engine/lib/Material.js\";import{OITPass as W}from\"../webgl-engine/lib/OITPass.js\";import{OverlayRenderContext as M,defaultRenderOccludedMask as I}from\"../webgl-engine/lib/RenderContext.js\";import{RenderSlot as q}from\"../webgl-engine/lib/RenderSlot.js\";import{ShadowMap as N}from\"../webgl-engine/lib/ShadowMap.js\";import{SortedRenderGeometryRenderer as F}from\"../webgl-engine/lib/SortedRenderGeometryRenderer.js\";import{TextureTechnique as L}from\"../webgl-engine/lib/TextureTechnique.js\";import{TextureTechniqueConfiguration as V}from\"../webgl-engine/lib/TextureTechniqueConfiguration.js\";import{Update as G}from\"../webgl-engine/lib/Update.js\";import{UpdatePolicy as H}from\"../webgl-engine/lib/UpdatePolicy.js\";import{AmbientLight as k}from\"../webgl-engine/lighting/Lightsources.js\";import{O as U}from\"../../../chunks/OverlayCompositing.glsl.js\";import{OverlayCompositingTechnique as B}from\"../webgl-engine/shaders/OverlayCompositingTechnique.js\";import{TaskPriority as z,noBudget as Y}from\"../../support/Scheduler.js\";import{FramebufferBit as X,TextureSamplingMode as J}from\"../../webgl/enums.js\";import{Texture as K}from\"../../webgl/Texture.js\";import{TextureDescriptor as Q}from\"../../webgl/TextureDescriptor.js\";let Z=class extends C{constructor(e){super(e),this._overlays=null,this._renderTargets=null,this._overlayParameters=new U,this.hasHighlights=!1,this._hasWater=!1,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new i,this._passParameters=new S,this._materials=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.unloadedMemory=0,this.ignoresMemoryFactor=!1,this._camera=new D,this.worldToPCSRatio=1,this.events=new r,this.longitudeCyclical=null,this.produces=new Map([[q.DRAPED_MATERIAL,e=>e!==v.Highlight||this.hasHighlights],[q.DRAPED_WATER,()=>this._hasWater]]),this._hasTargetWithoutRasterImage=!1,this._hasDrapedFeatureSource=!1,this._hasDrapedRasterSource=!1}initialize(){const{view:e}=this,{_stage:r}=e,t=r.renderer.fboCache,s=r.renderView,{waterTextures:i,textures:h}=s;this._renderContext=new M(this._rctx,new N(t,e.state.viewingMode)),this.addHandles([o((()=>i.updating),(()=>this.events.emit(\"content-changed\")),n),o((()=>this.spatialReference),(e=>this._localOriginFactory=new j(e)),n),a((()=>this.view.allLayerViews),\"after-changes\",(()=>this._sortedDrapeSourceRenderersDirty=!0)),o((()=>O(this.view.highlights)),(()=>this._sortedDrapeSourceRenderersDirty=!0),n)]),this._materials=new P(h,this._techniques,(()=>{this.notifyChange(\"rendersOccludedDraped\"),this.events.emit(\"content-changed\"),this.notifyChange(\"updating\"),this.notifyChange(\"isEmpty\")}),(()=>this.events.emit(\"content-changed\")));const{_bindParameters:d,_camera:l}=this;d.slot=q.DRAPED_MATERIAL,d.mainDepth=null,l.near=1,l.far=1e4,l.relativeElevation=null,d.camera=this._camera,d.oitPass=W.NONE,d.updateLighting([new k(g())],0,0,G.Immediate),this.addHandles(this.view.resourceController.scheduler.registerTask(z.STAGE,this))}destroy(){this._renderers.forEach((e=>e.destroy())),this._renderers.clear(),this._passParameters.texture=s(this._passParameters.texture),this.disposeOverlays()}get _bindParameters(){return this._renderContext.bind}get _rctx(){return this.view._stage.renderView.renderingContext}get _techniques(){return this.view._stage.renderView.techniques}get rctx(){return this._rctx}get materials(){return this._materials}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}get pluginContext(){return this._pluginContext}initializeRenderContext(e){this._pluginContext=e,this._techniques.precompile(B)}uninitializeRenderContext(){}acquireTechniques(){return[]}render(){}get updating(){return this._sortedDrapeSourceRenderersDirty||t(this._renderers,(e=>e.updating))}get hasOverlays(){return null!=this._overlays&&null!=this._renderTargets}getMaterialRenderer(e){for(const r of this._renderers.values()){const t=r.getMaterialRenderer(e);if(t)return t}return null}get layers(){return this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers(),this._sortedRenderers.map((e=>e.drapeSource.layer)).filter((e=>!!e))}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,F)}createDrapeSourceRenderer(e,r,t){const s=this._renderers.get(e);null!=s&&s.destroy();const i=new r({...t,rendererContext:this,drapeSource:e});return this._renderers.set(e,i),this._sortedDrapeSourceRenderersDirty=!0,\"fullOpacity\"in e&&this.addHandles(o((()=>e.fullOpacity),(()=>this.events.emit(\"content-changed\"))),e),i}removeDrapeSourceRenderer(e){if(null==e)return;const r=this._renderers.get(e);null!=r&&(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this.removeHandles(e),r.destroy())}computeValidity(){return this._renderTargets?.computeValidity()??0}releaseRenderTargets(){this._renderTargets?.dispose()}get overlays(){return this._overlays??[]}ensureDrapeTargets(e){this._hasTargetWithoutRasterImage=!!this._overlays&&h(e,(e=>e.drapeTargetType===m.WithoutRasterImage))}ensureDrapeSources(e){this._overlays?(this._hasDrapedFeatureSource=h(e,(e=>e.drapeSourceType===_.Features)),this._hasDrapedRasterSource=h(e,(e=>e.drapeSourceType===_.RasterImage))):this._hasDrapedFeatureSource=this._hasDrapedRasterSource=!1}get _needsColorWithoutRasterImage(){return this._hasDrapedRasterSource&&this._hasDrapedFeatureSource&&this._hasTargetWithoutRasterImage}ensureOverlays(e,r,t=this._bindParameters.overlayStretch){null==this._overlays&&(this._renderTargets=new b(this.view._stage.renderer.fboCache),this._overlays=[new T,new T]),this.ensureDrapeTargets(e),this.ensureDrapeSources(r),this._bindParameters.overlayStretch=t}disposeOverlays(){this._overlays=null,this._renderTargets=s(this._renderTargets),this.events.emit(\"textures-disposed\")}getTexture(e){if(null!=e)return e===w.ColorNoRasterImage&&!this._needsColorWithoutRasterImage&&this._hasDrapedFeatureSource?this._renderTargets?.getTexture(w.Color):this._renderTargets?.getTexture(e)}get running(){return this.updating}runTask(e){this._processDrapeSources(e,(()=>!0))}_processDrapeSources(e,r){let s=!1;for(const[t,i]of this._renderers){if(e.done)break;(t.destroyed||r(t))&&(i.commitChanges()&&(s=!0,e.madeProgress()))}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,s=!0,this._updateSortedDrapeSourceRenderers()),s&&(null!=this._overlays&&0===this._renderers.size&&this.disposeOverlays(),this.notifyChange(\"updating\"),this.notifyChange(\"isEmpty\"),this.events.emit(\"content-changed\"),this.hasHighlights=t(this._renderers,(e=>e.hasHighlights)),this.notifyChange(\"rendersOccludedDraped\"),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(Y,(e=>e.updatePolicy===H.SYNC))}get isEmpty(){return!f.OVERLAY_DRAW_DEBUG_TEXTURE&&!t(this._renderers,(e=>!e.isEmpty))}get hasWater(){return this._hasWater}get rendersOccludedDraped(){const e=this._renderContext.renderOccludedMask;this._renderContext.renderOccludedMask=te,++this._techniques.precompiling;const r=this._sortedRenderers.some((({renderer:e})=>e.precompile(this._renderContext)));return--this._techniques.precompiling,this._renderContext.renderOccludedMask=e,r}renders(e){if(f.OVERLAY_DRAW_DEBUG_TEXTURE&&e!==w.Occluded&&e!==w.Highlight)return!0;++this._techniques.precompiling;const r=this._sortedRenderers.some((({renderer:e})=>e.precompile(this._renderContext)));return--this._techniques.precompiling,r}get mode(){return this.isEmpty?x.Disabled:this._renderTargets?.getTexture(w.WaterNormal)?x.EnabledWithWater:this._renderTargets?.getTexture(w.Color)?x.Enabled:x.Disabled}updateAnimation(e){let r=!1;return this._renderers.forEach((t=>r=t.updateAnimation(e)||r)),r}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}precompileShaders(e){if(this._renderTargets){this._bindParameters.alignPixelEnabled=e.alignPixelEnabled,this._bindParameters.highlightGroupName=null,++this._techniques.precompiling;for(const e of this._renderTargets.targets){if(e.content===w.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const r=e.output;this._renderContext.output=r,this._bindParameters.slot=r===v.Normal?q.DRAPED_WATER:q.DRAPED_MATERIAL,e.content===w.Occluded&&(this._renderContext.renderOccludedMask=te),this._sortedRenderers.forAll((({drapeSource:r,renderer:t})=>{e.content===w.ColorNoRasterImage&&r.drapeSourceType===_.RasterImage||t.precompile(this._renderContext)})),this._renderContext.renderOccludedMask=I}--this._techniques.precompiling}}drawOverlays(e){if(this._overlays&&this._renderTargets){for(const e of this._overlays)this.longitudeCyclical?e.setupGeometryViewsCyclical(this.longitudeCyclical):e.setupGeometryView();this._bindParameters.alignPixelEnabled=e.alignPixelEnabled;for(const r of this._renderTargets.targets){if(r.content===w.ColorNoRasterImage&&!this._needsColorWithoutRasterImage)continue;const t=this._drawTarget(R.INNER,r,e),s=this._drawTarget(R.OUTER,r,e);(t||s)&&r.fbo.generateMipMap()}}}_drawTarget(e,r,t){const s=this._overlays[e],i=s.canvasGeometries;if(0===i.numViews)return!1;const{contentPixelRatio:o}=t;this._screenToWorldRatio=o*s.mapUnitsPerPixel/this._bindParameters.overlayStretch;const n=r.output;if(this.isEmpty||n===v.Normal&&!this.hasWater||!s.hasSomeSizedView())return!1;const{_rctx:a,_bindParameters:h}=this;if(this._camera.pixelRatio=s.pixelRatio*o,this._renderContext.output=n,h.screenToWorldRatio=this._screenToWorldRatio,h.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,h.slot=n===v.Normal?q.DRAPED_WATER:q.DRAPED_MATERIAL,r.content===w.Occluded&&(this._renderContext.renderOccludedMask=te),h.highlightGroupName=null,!this.renders(r.content))return this._renderContext.renderOccludedMask=I,!1;const{resolution:d}=s,l=e===R.INNER?0:d;a.setViewport(l,0,d,d),this._bindTargetFBO(r),e===R.INNER&&(a.setClearColor(0,0,0,0),a.clear(X.COLOR));if(f.OVERLAY_DRAW_DEBUG_TEXTURE&&r.content!==w.Occluded&&r.content!==w.Highlight){this._techniques.precompile(L,se);const r=this._techniques.acquire(L,se);for(let t=0;t<i.numViews;t++)this._setViewParameters(i.extents[t],s),this._ensureDebugPatternResources(s.resolution,ee[e]),a.bindTechnique(r,h,this._passParameters),a.screen.draw();r.release()}if(r.output===v.Highlight){const{fboCache:t}=this.view._stage.renderer,s=this._resolution;E(a,t,{width:s,height:s},this.view.highlights,h,(()=>this._renderAllGeometry(e,r)),l,(()=>this._bindTargetFBO(r)))}else this._renderAllGeometry(e,r);return a.bindFramebuffer(null),this._renderContext.renderOccludedMask=I,!0}_renderAllGeometry(e,r){const t=this._overlays[e],s=t.canvasGeometries;this._sortedRenderers.forAll((({drapeSource:i,renderer:o})=>{if(r.content===w.ColorNoRasterImage&&i.drapeSourceType===_.RasterImage)return;const{fullOpacity:n}=i,a=null!=n&&n<1&&r.output===v.Color&&this._bindTemporaryFBO();for(let e=0;e<s.numViews;e++)this._setViewParameters(s.extents[e],t),o.render(this._renderContext);if(a){this._bindTargetFBO(r),this._overlayParameters.texture=a.getTexture(),this._overlayParameters.opacity=n,this._overlayParameters.overlayIndex=e;const t=this._techniques.acquire(B);this._rctx.bindTechnique(t,this._bindParameters,this._overlayParameters),this._rctx.screen.draw(),t.release(),a.release()}}))}_bindTargetFBO(e){const r=this._resolution,t=2*r;e.fbo.bind(this._rctx,t,r)}_bindTemporaryFBO(){const e=this._resolution,r=2*e,t=this.view._stage.renderer.fboCache,s=t.acquire(r,e,\"overlay tmp\");return t.rctx.bindFramebuffer(s.fbo),t.rctx.clear(X.COLOR),s}get _resolution(){return this._overlays?.[R.INNER].resolution??0}notifyContentChanged(){this.events.emit(\"content-changed\")}intersect(e,r,t,s){this._sortedDrapeSourceRenderersDirty&&this._updateSortedDrapeSourceRenderers();let i=0;for(const{renderer:o}of this._sortedRenderers)i=o.intersect?.(e,r,t,s,i)??i}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),0===this._renderers.size)return;const e=this.view.map.allLayers,r=e.length;this._renderers.forEach(((t,s)=>{const i=e.indexOf(s.layer),o=i>=0,n=s.renderGroup??(o?y.MapLayer:y.ViewLayer),a=r*n+(o?i:0);this._sortedRenderers.push(new $(s,t,a))})),this._sortedRenderers.sort(((e,r)=>e.index-r.index))}_setViewParameters(e,r){const t=this._camera;t.viewport=[0,0,r.resolution,r.resolution],c(t.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],t.near,t.far),u(t.viewMatrix,[-e[0],-e[1],0])}_updateHasWater(){const e=t(this._renderers,(e=>e.hasWater));e!==this._hasWater&&(this._hasWater=e,this.events.emit(\"has-water\"))}_ensureDebugPatternResources(e,r){if(p(this._passParameters.color,r[0],r[1],r[2]),this._passParameters.texture)return;const t=new Uint8Array(e*e*4);let s=0;for(let o=0;o<e;o++)for(let r=0;r<e;r++){const i=Math.floor(r/10),n=Math.floor(o/10);i<2||n<2||10*i>e-20||10*n>e-20?(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=255):(t[s++]=255,t[s++]=255,t[s++]=255,t[s++]=1&i&&1&n?1&r^1&o?0:255:1&i^1&n?0:128)}const i=new Q(e);i.samplingMode=J.NEAREST,this._passParameters.texture=new K(this._rctx,i,t)}get test(){}};e([d()],Z.prototype,\"hasHighlights\",void 0),e([d()],Z.prototype,\"_sortedDrapeSourceRenderersDirty\",void 0),e([d({constructOnly:!0})],Z.prototype,\"view\",void 0),e([d({readOnly:!0})],Z.prototype,\"_techniques\",null),e([d()],Z.prototype,\"worldToPCSRatio\",void 0),e([d()],Z.prototype,\"spatialReference\",void 0),e([d({type:Boolean,readOnly:!0})],Z.prototype,\"updating\",null),e([d()],Z.prototype,\"isEmpty\",null),e([d({readOnly:!0})],Z.prototype,\"rendersOccludedDraped\",null),Z=e([l(\"esri.views.3d.terrain.OverlayRenderer\")],Z);class ${constructor(e,r,t){this.drapeSource=e,this.renderer=r,this.index=t}}const ee=[[1,.5,.5],[.5,.5,1]],re=-2,te=A.OccludeAndTransparent,se=new V;se.hasAlpha=!0;export{Z as OverlayRenderer,re as drapedZ,te as overlayRenderOccludedFlag};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar E,A,O;!function(E){E[E.INNER=0]=\"INNER\",E[E.OUTER=1]=\"OUTER\"}(E||(E={})),function(E){E[E.REGULAR=0]=\"REGULAR\",E[E.HAS_NORTH_POLE=1]=\"HAS_NORTH_POLE\",E[E.HAS_SOUTH_POLE=2]=\"HAS_SOUTH_POLE\",E[E.HAS_BOTH_POLES=3]=\"HAS_BOTH_POLES\"}(A||(A={})),function(E){E[E.FADING=0]=\"FADING\",E[E.IMMEDIATE=1]=\"IMMEDIATE\",E[E.UNFADED=2]=\"UNFADED\"}(O||(O={}));export{E as OverlayIndex,A as PatchType,O as TextureUpdate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as s}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ShaderOutput as t}from\"../shaderLibrary/ShaderOutput.js\";import{VertexNormalPassParameters as i,VertexNormalDrawParameters as r}from\"../shaderLibrary/attributes/VertexNormal.glsl.js\";class e extends i{constructor(){super(...arguments),this.slicePlaneLocalOrigin=s(),this.origin=this.slicePlaneLocalOrigin,this.modelTransformation=null}}class a extends r{}var o;!function(s){s[s.Material=0]=\"Material\",s[s.ShadowMap=1]=\"ShadowMap\",s[s.Highlight=2]=\"Highlight\",s[s.ViewshedShadowMap=3]=\"ViewshedShadowMap\"}(o||(o={}));class h extends e{constructor(){super(...arguments),this.identifier=o.Material,this.output=t.Color,this.transparent=!1}}class l extends e{constructor(){super(...arguments),this.identifier=o.ShadowMap}}class n extends e{constructor(){super(...arguments),this.identifier=o.Highlight}}class c extends e{constructor(){super(...arguments),this.identifier=o.ViewshedShadowMap}}export{a as DrawParameters,n as HighlightPassParameters,h as MaterialPassParameters,e as PassParameters,o as RenderPassIdentifier,l as ShadowMapPassParameters,c as ViewshedShadowMapPassParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Integer2PassUniform as e}from\"../shaderModules/Integer2PassUniform.js\";import{glsl as l}from\"../shaderModules/interfaces.js\";import{Texture2DPassUniform as i}from\"../shaderModules/Texture2DPassUniform.js\";import{g as t}from\"../../../../../chunks/HighlightDownsample.glsl.js\";function o(o){const{vertex:c}=o;c.uniforms.add(new i(\"coverageTexture\",(e=>e.coverageTexture)),new e(\"highlightRenderCellCount\",(e=>[e.horizontalCellCount,e.verticalCellCount])),new e(\"highlightTextureResolution\",(e=>[e.highlightTexture.descriptor.width,e.highlightTexture.descriptor.height]))),c.constants.add(\"cellSize\",\"int\",t),o.varyings.add(\"sUV\",\"vec2\"),o.varyings.add(\"vOutlinePossible\",\"float\"),c.code.add(l`const ivec2 cellVertices[4] = ivec2[4](ivec2(0,0), ivec2(1,0), ivec2(0,1), ivec2(1,1));`),c.main.add(l`int cellIndex = gl_InstanceID;\nint cellX = cellIndex % highlightRenderCellCount[0];\nint cellY = (cellIndex - cellX) / highlightRenderCellCount[0];\nivec2 cellPos = ivec2(cellX, cellY);\nvec4 cov = texelFetch(coverageTexture, cellPos, 0);\nif (cov.r == 0.0) {\ngl_Position = vec4(0.0);\nreturn;\n}\nvOutlinePossible = cov.g;\nivec2 iPosInCell = cellVertices[gl_VertexID];\nvec2 sPos = vec2(cellPos * cellSize + iPosInCell * (cellSize));\nvec2 vPos = sPos / vec2(highlightTextureResolution);\nsUV = vPos;\ngl_Position = vec4(2.0 * vPos - vec2(1.0), 0.0, 1.0);`)}export{o as HighlightCellGridScreenSpacePass};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../shaderModules/interfaces.js\";function t(t){const{fragment:i}=t;i.code.add(e`uint readChannelBits(uint channel, int highlightLevel) {\nint llc = (highlightLevel & 3) << 1;\nreturn (channel >> llc) & 3u;\n}\nuint readChannel(vec2 texel, int highlightLevel) {\nint lic = (highlightLevel >> 2) & 1;\nreturn uint(texel[lic] * 255.0);\n}\nuint readLevelBits(vec2 texel, int highlightLevel) {\nreturn readChannelBits(readChannel(texel, highlightLevel), highlightLevel);\n}`)}export{t as HighlightReadBitmap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as e}from\"../../../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{PositionAttribute as o}from\"./PositionAttribute.glsl.js\";import{Float2PassUniform as i}from\"../../shaderModules/Float2PassUniform.js\";import{Float3PassUniform as r}from\"../../shaderModules/Float3PassUniform.js\";import{Float4sPassUniform as t}from\"../../shaderModules/Float4sPassUniform.js\";import{FloatsPassUniform as a}from\"../../shaderModules/FloatsPassUniform.js\";import{glsl as l}from\"../../shaderModules/interfaces.js\";import{VertexAttribute as v}from\"../../../lib/VertexAttribute.js\";import{vvColorNumber as s,VisualVariablePassParameters as c}from\"../../../materials/VisualVariablePassParameters.js\";const p=8;function f(e,c){const f=v.FEATUREVALUE;e.attributes.add(f,\"vec4\");const n=e.vertex;n.code.add(l`\n  bool isCapVertex() {\n    return ${f}.w == 1.0;\n  }\n  `),n.uniforms.add(new i(\"size\",(e=>e.size))),c.vvSize?(n.uniforms.add(new r(\"vvSizeMinSize\",(e=>e.vvSize.minSize)),new r(\"vvSizeMaxSize\",(e=>e.vvSize.maxSize)),new r(\"vvSizeOffset\",(e=>e.vvSize.offset)),new r(\"vvSizeFactor\",(e=>e.vvSize.factor))),n.code.add(l`\n    vec2 getSize() {\n      return size * clamp(vvSizeOffset + ${f}.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize).xz;\n    }\n    `)):n.code.add(l`vec2 getSize(){\nreturn size;\n}`),c.vvOpacity?(n.constants.add(\"vvOpacityNumber\",\"int\",p),n.uniforms.add(new a(\"vvOpacityValues\",(e=>e.vvOpacity.values),p),new a(\"vvOpacityOpacities\",(e=>e.vvOpacity.opacityValues),p)),n.code.add(l`\n    vec4 applyOpacity(vec4 color) {\n      float value = ${f}.z;\n      if (value <= vvOpacityValues[0]) {\n        return vec4( color.xyz, vvOpacityOpacities[0]);\n      }\n\n      for (int i = 1; i < vvOpacityNumber; ++i) {\n        if (vvOpacityValues[i] >= value) {\n          float f = (value - vvOpacityValues[i-1]) / (vvOpacityValues[i] - vvOpacityValues[i-1]);\n          return vec4( color.xyz, mix(vvOpacityOpacities[i-1], vvOpacityOpacities[i], f));\n        }\n      }\n\n      return vec4( color.xyz, vvOpacityOpacities[vvOpacityNumber - 1]);\n    }\n    `)):n.code.add(l`vec4 applyOpacity(vec4 color){\nreturn color;\n}`),c.vvColor?(n.constants.add(\"vvColorNumber\",\"int\",s),n.uniforms.add(new a(\"vvColorValues\",(e=>e.vvColor.values),s),new t(\"vvColorColors\",(e=>e.vvColor.colors),s)),n.code.add(l`\n    vec4 getColor() {\n      float value = ${f}.y;\n      if (value <= vvColorValues[0]) {\n        return applyOpacity(vvColorColors[0]);\n      }\n\n      for (int i = 1; i < vvColorNumber; ++i) {\n        if (vvColorValues[i] >= value) {\n          float f = (value - vvColorValues[i-1]) / (vvColorValues[i] - vvColorValues[i-1]);\n          return applyOpacity(mix(vvColorColors[i-1], vvColorColors[i], f));\n        }\n      }\n\n      return applyOpacity(vvColorColors[vvColorNumber - 1]);\n    }\n    `)):n.code.add(l`vec4 getColor(){\nreturn applyOpacity(vec4(1, 1, 1, 1));\n}`),e.include(o),e.attributes.add(v.PROFILERIGHT,\"vec4\"),e.attributes.add(v.PROFILEUP,\"vec4\"),e.attributes.add(v.PROFILEVERTEXANDNORMAL,\"vec4\"),n.code.add(l`vec3 calculateVPos() {\nvec2 size = getSize();\nvec3 origin = position;\nvec3 right = profileRight.xyz;\nvec3 up = profileUp.xyz;\nvec3 forward = cross(up, right);\nvec2 profileVertex = profileVertexAndNormal.xy * size;\nvec2 profileNormal = profileVertexAndNormal.zw;\nfloat positionOffsetAlongProfilePlaneNormal = 0.0;\nfloat normalOffsetAlongProfilePlaneNormal = 0.0;`),n.code.add(l`if(!isCapVertex()) {\nvec2 rotationRight = vec2(profileRight.w, profileUp.w);\nfloat maxDistance = length(rotationRight);`),n.code.add(l`rotationRight = maxDistance > 0.0 ? normalize(rotationRight) : vec2(0, 0);\nfloat rx = dot(profileVertex, rotationRight);\nif (abs(rx) > maxDistance) {\nvec2 rotationUp = vec2(-rotationRight.y, rotationRight.x);\nfloat ry = dot(profileVertex, rotationUp);\nprofileVertex = rotationRight * maxDistance * sign(rx) + rotationUp * ry;\n}\n}else{\npositionOffsetAlongProfilePlaneNormal = profileRight.w * size[0];\nnormalOffsetAlongProfilePlaneNormal = profileUp.w;\n}\nvec3 offset = right * profileVertex.x + up * profileVertex.y + forward * positionOffsetAlongProfilePlaneNormal;\nreturn origin + offset;\n}`),n.code.add(l`vec3 localNormal() {\nvec3 right = profileRight.xyz;\nvec3 up = profileUp.xyz;\nvec3 forward = cross(up, right);\nvec2 profileNormal = profileVertexAndNormal.zw;\nvec3 normal = right * profileNormal.x + up * profileNormal.y;\nif(isCapVertex()) {\nnormal += forward * profileUp.w;\n}\nreturn normal;\n}`)}class n extends c{constructor(){super(...arguments),this.size=e(1,1)}}export{f as PathVertexPosition,n as PathVertexPositionPassParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{AlignPixel as e}from\"./AlignPixel.glsl.js\";import{terrainDepthTest as o}from\"../shading/TerrainDepthTest.glsl.js\";import{glsl as t}from\"../../shaderModules/interfaces.js\";function r(r,i){const{vertex:p,fragment:s}=r;r.include(o,i),p.include(e),i.terrainDepthTest&&r.varyings.add(\"depth\",\"float\"),p.main.add(t`\n    vec4 posProjCenter;\n    if (dot(position, position) > 0.0) {\n      // Render single point to center of the pixel to avoid subpixel filtering to affect the marker color\n      ProjectHUDAux projectAux;\n      vec4 posProj = projectPositionHUD(projectAux);\n      posProjCenter = alignToPixelCenter(posProj, viewport.zw);\n\n      ${i.terrainDepthTest?t`depth = projectAux.posView.z;`:\"\"}\n      vec3 vpos = projectAux.posModel;\n      if (rejectBySlice(vpos)) {\n        // Project out of clip space\n        posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);\n      }\n\n    } else {\n      // Project out of clip space\n      posProjCenter = vec4(1e038, 1e038, 1e038, 1.0);\n    }\n\n    gl_Position = posProjCenter;\n    gl_PointSize = 1.0;\n  `),s.main.add(t`fragColor = vec4(1);\nif(terrainDepthTest(depth)) {\nfragColor.g = 0.5;\n}`)}export{r as HUDOcclusionPass};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glsl as t}from\"../../shaderModules/interfaces.js\";function o(o){o.fragment.code.add(t`float normals2FoamIntensity(vec3 n, float waveStrength){\nfloat normalizationFactor =  max(0.015, waveStrength);\nreturn max((n.x + n.y)*0.3303545/normalizationFactor + 0.3303545, 0.0);\n}`)}function n(o){o.fragment.code.add(t`vec3 foamIntensity2FoamColor(float foamIntensityExternal, float foamPixelIntensity, vec3 skyZenitColor, float dayMod){\nreturn foamIntensityExternal * (0.075 * skyZenitColor * pow(foamPixelIntensity, 4.) +  50.* pow(foamPixelIntensity, 23.0)) * dayMod;\n}`)}export{n as FoamColor,o as FoamIntensity};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glsl as o}from\"../../shaderModules/interfaces.js\";function e(e){e.fragment.code.add(o`const float GAMMA = 2.2;\nconst float INV_GAMMA = 0.4545454545;\nvec4 delinearizeGamma(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(INV_GAMMA)), color.w);\n}\nvec3 linearizeGamma(vec3 color) {\nreturn pow(color, vec3(GAMMA));\n}`)}export{e as Gamma};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../../shaderModules/interfaces.js\";function r(r,c){c.spherical?r.vertex.code.add(e`vec3 getLocalUp(in vec3 pos, in vec3 origin) {\nreturn normalize(pos + origin);\n}`):r.vertex.code.add(e`vec3 getLocalUp(in vec3 pos, in vec3 origin) {\nreturn vec3(0.0, 0.0, 1.0);\n}`),c.spherical?r.vertex.code.add(e`mat3 getTBNMatrix(in vec3 n) {\nvec3 t = normalize(cross(vec3(0.0, 0.0, 1.0), n));\nvec3 b = normalize(cross(n, t));\nreturn mat3(t, b, n);\n}`):r.vertex.code.add(e`mat3 getTBNMatrix(in vec3 n) {\nvec3 t = vec3(1.0, 0.0, 0.0);\nvec3 b = normalize(cross(n, t));\nreturn mat3(t, b, n);\n}`)}export{r as NormalUtils};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReadDepth as e}from\"../output/ReadDepth.glsl.js\";import{Float2PassUniform as o}from\"../../shaderModules/Float2PassUniform.js\";import{FloatPassUniform as t}from\"../../shaderModules/FloatPassUniform.js\";import{glsl as r}from\"../../shaderModules/interfaces.js\";import{Matrix4PassUniform as a}from\"../../shaderModules/Matrix4PassUniform.js\";import{Texture2DPassUniform as i}from\"../../shaderModules/Texture2DPassUniform.js\";function d(d,n){if(!n.screenSpaceReflections)return;const c=d.fragment;c.include(e),c.uniforms.add(new o(\"nearFar\",((e,o)=>o.camera.nearFar)),new i(\"depthMap\",((e,o)=>o.depth?.attachment)),new a(\"proj\",((e,o)=>o.camera.projectionMatrix)),new t(\"invResolutionHeight\",((e,o)=>1/o.camera.height)),new a(\"reprojectionMatrix\",((e,o)=>o.ssr.reprojectionMatrix))).code.add(r`\n  vec2 reprojectionCoordinate(vec3 projectionCoordinate)\n  {\n    vec4 zw = proj * vec4(0.0, 0.0, -projectionCoordinate.z, 1.0);\n    vec4 reprojectedCoord = reprojectionMatrix * vec4(zw.w * (projectionCoordinate.xy * 2.0 - 1.0), zw.z, zw.w);\n    reprojectedCoord.xy /= reprojectedCoord.w;\n    return reprojectedCoord.xy * 0.5 + 0.5;\n  }\n\n  const int maxSteps = ${n.highStepCount?\"150\":\"75\"};\n\n  vec4 applyProjectionMat(mat4 projectionMat, vec3 x)\n  {\n    vec4 projectedCoord =  projectionMat * vec4(x, 1.0);\n    projectedCoord.xy /= projectedCoord.w;\n    projectedCoord.xy = projectedCoord.xy*0.5 + 0.5;\n    return projectedCoord;\n  }\n\n  vec3 screenSpaceIntersection(vec3 dir, vec3 startPosition, vec3 viewDir, vec3 normal)\n  {\n    vec3 viewPos = startPosition;\n    vec3 viewPosEnd = startPosition;\n\n    // Project the start position to the screen\n    vec4 projectedCoordStart = applyProjectionMat(proj, viewPos);\n    vec3  Q0 = viewPos / projectedCoordStart.w; // homogeneous camera space\n    float k0 = 1.0/ projectedCoordStart.w;\n\n    // advance the position in the direction of the reflection\n    viewPos += dir;\n\n    vec4 projectedCoordVanishingPoint = applyProjectionMat(proj, dir);\n\n    // Project the advanced position to the screen\n    vec4 projectedCoordEnd = applyProjectionMat(proj, viewPos);\n    vec3  Q1 = viewPos / projectedCoordEnd.w; // homogeneous camera space\n    float k1 = 1.0/ projectedCoordEnd.w;\n\n    // calculate the reflection direction in the screen space\n    vec2 projectedCoordDir = (projectedCoordEnd.xy - projectedCoordStart.xy);\n    vec2 projectedCoordDistVanishingPoint = (projectedCoordVanishingPoint.xy - projectedCoordStart.xy);\n\n    float yMod = min(abs(projectedCoordDistVanishingPoint.y), 1.0);\n\n    float projectedCoordDirLength = length(projectedCoordDir);\n    float maxSt = float(maxSteps);\n\n    // normalize the projection direction depending on maximum steps\n    // this determines how blocky the reflection looks\n    vec2 dP = yMod * (projectedCoordDir)/(maxSt * projectedCoordDirLength);\n\n    // Normalize the homogeneous camera space coordinates\n    vec3  dQ = yMod * (Q1 - Q0)/(maxSt * projectedCoordDirLength);\n    float dk = yMod * (k1 - k0)/(maxSt * projectedCoordDirLength);\n\n    // initialize the variables for ray marching\n    vec2 P = projectedCoordStart.xy;\n    vec3 Q = Q0;\n    float k = k0;\n    float rayStartZ = -startPosition.z; // estimated ray start depth value\n    float rayEndZ = -startPosition.z;   // estimated ray end depth value\n    float prevEstimateZ = -startPosition.z;\n    float rayDiffZ = 0.0;\n    float dDepth;\n    float depth;\n    float rayDiffZOld = 0.0;\n\n    // early outs\n    if (dot(normal, dir) < 0.0 || dot(-viewDir, normal) < 0.0)\n      return vec3(P, 0.0);\n\n    for(int i = 0; i < maxSteps-1; i++)\n    {\n      depth = -linearDepthFromTexture(depthMap, P); // get linear depth from the depth buffer\n\n      // estimate depth of the marching ray\n      rayStartZ = prevEstimateZ;\n      dDepth = -rayStartZ - depth;\n      rayEndZ = (dQ.z * 0.5 + Q.z)/ ((dk * 0.5 + k));\n      rayDiffZ = rayEndZ- rayStartZ;\n      prevEstimateZ = rayEndZ;\n\n      if(-rayEndZ > nearFar[1] || -rayEndZ < nearFar[0] || P.y < 0.0  || P.y > 1.0 )\n      {\n        return vec3(P, 0.);\n      }\n\n      // If we detect a hit - return the intersection point, two conditions:\n      //  - dDepth > 0.0 - sampled point depth is in front of estimated depth\n      //  - if difference between dDepth and rayDiffZOld is not too large\n      //  - if difference between dDepth and 0.025/abs(k) is not too large\n      //  - if the sampled depth is not behind far plane or in front of near plane\n\n      if((dDepth) < 0.025/abs(k) + abs(rayDiffZ) && dDepth > 0.0 && depth > nearFar[0] && depth < nearFar[1] && abs(P.y - projectedCoordStart.y) > invResolutionHeight)\n      {\n        return vec3(P, depth);\n      }\n\n      // continue with ray marching\n      P = clamp(P + dP, vec2(0.0), vec2(0.999));\n      Q.z += dQ.z;\n      k += dk;\n      rayDiffZOld = rayDiffZ;\n    }\n    return vec3(P, 0.0);\n  }\n  `)}export{d as ScreenSpaceReflections};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{FoamColor as e}from\"./FoamRendering.glsl.js\";import{Gamma as o}from\"./Gamma.glsl.js\";import{PhysicallyBasedRenderingWater as t}from\"./PhysicallyBasedRendering.glsl.js\";import{distanceFadeStart as r,distanceFadeEnd as i}from\"./ScreenSpaceConstants.js\";import{ScreenSpaceReflections as a}from\"./ScreenSpaceReflections.glsl.js\";import{CloudsParallaxShading as n}from\"../util/CloudsParallaxShading.glsl.js\";import{FloatPassUniform as l}from\"../../shaderModules/FloatPassUniform.js\";import{glsl as d}from\"../../shaderModules/interfaces.js\";import{Matrix4PassUniform as s}from\"../../shaderModules/Matrix4PassUniform.js\";import{Texture2DPassUniform as c}from\"../../shaderModules/Texture2DPassUniform.js\";import{ToneMapping as f}from\"../../../shaders/ToneMapping.glsl.js\";function m(m,v){m.include(t,v),m.include(o),m.include(e),v.cloudReflections&&m.include(n),m.include(a,v);const u=m.fragment;u.include(f),u.constants.add(\"fresnelSky\",\"vec3\",[.02,1,15]),u.constants.add(\"fresnelMaterial\",\"vec2\",[.02,.1]),u.constants.add(\"roughness\",\"float\",.015),u.constants.add(\"foamIntensityExternal\",\"float\",1.7),u.constants.add(\"ssrIntensity\",\"float\",.65),u.constants.add(\"ssrHeightFadeStart\",\"float\",r),u.constants.add(\"ssrHeightFadeEnd\",\"float\",i),u.constants.add(\"waterDiffusion\",\"float\",.92),u.constants.add(\"waterSeaColorMod\",\"float\",.8),u.constants.add(\"correctionViewingPowerFactor\",\"float\",.4),u.constants.add(\"skyZenitColor\",\"vec3\",[.52,.68,.9]),u.constants.add(\"skyColor\",\"vec3\",[.67,.79,.9]),u.constants.add(\"cloudFresnelModifier\",\"vec2\",[1.2,.01]),u.code.add(d`PBRShadingWater shadingInfo;\nvec3 getSkyGradientColor(in float cosTheta, in vec3 horizon, in vec3 zenit) {\nfloat exponent = pow((1.0 - cosTheta), fresnelSky[2]);\nreturn mix(zenit, horizon, exponent);\n}`),u.uniforms.add(new l(\"lightingSpecularStrength\",((e,o)=>o.lighting.mainLight.specularStrength)),new l(\"lightingEnvironmentStrength\",((e,o)=>o.lighting.mainLight.environmentStrength))),u.code.add(d`vec3 getSeaColor(in vec3 n, in vec3 v, in vec3 l, vec3 color, in vec3 lightIntensity, in vec3 localUp, in float shadow, float foamIntensity, vec3 viewPosition, vec3 position) {\nfloat reflectionHit = 0.0;\nfloat reflectionHitDiffused = 0.0;\nvec3 seaWaterColor = linearizeGamma(color);\nvec3 h = normalize(l + v);\nshadingInfo.NdotV = clamp(dot(n, v), 0.001, 1.0);\nshadingInfo.VdotN = clamp(dot(v, n), 0.001, 1.0);\nshadingInfo.NdotH = clamp(dot(n, h), 0.0, 1.0);\nshadingInfo.VdotH = clamp(dot(v, h), 0.0, 1.0);\nshadingInfo.LdotH = clamp(dot(l, h), 0.0, 1.0);\nfloat upDotV = max(dot(localUp,v), 0.0);\nvec3 skyHorizon = linearizeGamma(skyColor);\nvec3 skyZenit = linearizeGamma(skyZenitColor);\nvec3 skyColor = getSkyGradientColor(upDotV, skyHorizon, skyZenit );\nfloat upDotL = max(dot(localUp,l),0.0);\nfloat daytimeMod = 0.1 + upDotL * 0.9;\nskyColor *= daytimeMod;\nfloat shadowModifier = clamp(shadow, 0.8, 1.0);\nvec3 fresnelModifier = fresnelReflection(shadingInfo.VdotN, vec3(fresnelSky[0]), fresnelSky[1]);\nvec3 reflSky = lightingEnvironmentStrength * fresnelModifier * skyColor * shadowModifier;\nvec3 reflSea = seaWaterColor * mix(skyColor, upDotL * lightIntensity * LIGHT_NORMALIZATION, 2.0 / 3.0) * shadowModifier;\nvec3 specular = vec3(0.0);\nif(upDotV > 0.0 && upDotL > 0.0) {\nvec3 specularSun = brdfSpecularWater(shadingInfo, roughness, vec3(fresnelMaterial[0]), fresnelMaterial[1]);\nvec3 incidentLight = lightIntensity * LIGHT_NORMALIZATION * shadow;\nfloat NdotL = clamp(dot(n, l), 0.0, 1.0);\nspecular = lightingSpecularStrength * NdotL * incidentLight * specularSun;\n}\nvec3 foam = vec3(0.0);\nif(upDotV > 0.0) {\nfoam = foamIntensity2FoamColor(foamIntensityExternal, foamIntensity, skyZenitColor, daytimeMod);\n}\nfloat correctionViewingFactor = pow(max(dot(v, localUp), 0.0), correctionViewingPowerFactor);\nvec3 normalCorrectedClouds = mix(localUp, n, correctionViewingFactor);\nvec3 reflectedWorld = normalize(reflect(-v, normalCorrectedClouds));`),v.cloudReflections&&u.uniforms.add(new l(\"cloudsOpacity\",((e,o)=>o.clouds.opacity))).code.add(d`vec4 cloudsColor = renderClouds(reflectedWorld, position);\ncloudsColor.a = 1.0 - cloudsColor.a;\ncloudsColor = pow(cloudsColor, vec4(GAMMA));\ncloudsColor *= clamp(fresnelModifier.y * cloudFresnelModifier[0] - cloudFresnelModifier[1], 0.0, 1.0) * cloudsOpacity;`),v.screenSpaceReflections?u.uniforms.add(new s(\"view\",((e,o)=>o.camera.viewMatrix)),new c(\"lastFrameColorTexture\",((e,o)=>o.ssr.lastFrameColor?.getTexture())),new l(\"fadeFactorSSR\",((e,o)=>o.ssr.fadeFactor))).code.add(d`vec3 viewDir = normalize(viewPosition);\nvec4 viewNormalVectorCoordinate = view * vec4(n, 0.0);\nvec3 viewNormal = normalize(viewNormalVectorCoordinate.xyz);\nvec4 viewUp = view * vec4(localUp, 0.0);\nvec3 viewNormalCorrectedSSR = mix(viewUp.xyz, viewNormal, correctionViewingFactor);\nvec3 reflected = normalize(reflect(viewDir, viewNormalCorrectedSSR));\nvec3 hitCoordinate = screenSpaceIntersection(reflected, viewPosition, viewDir, viewUp.xyz);\nvec3 reflectedColor = vec3(0.0);\nif (hitCoordinate.z > 0.0)\n{\nvec2 reprojectedCoordinate = reprojectionCoordinate(hitCoordinate);\nvec2 dCoords = smoothstep(0.3, 0.6, abs(vec2(0.5, 0.5) - hitCoordinate.xy));\nfloat heightMod = smoothstep(ssrHeightFadeEnd, ssrHeightFadeStart, -viewPosition.z);\nreflectionHit = clamp(1.0 - (1.3 * dCoords.y), 0.0, 1.0) * heightMod * fadeFactorSSR;\nreflectionHitDiffused = waterDiffusion * reflectionHit;\nreflectedColor = linearizeGamma(texture(lastFrameColorTexture, reprojectedCoordinate).xyz) *\nreflectionHitDiffused * fresnelModifier.y * ssrIntensity;\n}\nfloat seaColorMod =  mix(waterSeaColorMod, waterSeaColorMod * 0.5, reflectionHitDiffused);\nvec3 waterRenderedColor = tonemapACES((1.0 - reflectionHitDiffused) * reflSky + reflectedColor +\nreflSea * seaColorMod + specular + foam);`):u.code.add(d`vec3 waterRenderedColor = tonemapACES(reflSky + reflSea * waterSeaColorMod + specular + foam);`),v.cloudReflections?v.screenSpaceReflections?u.code.add(d`return waterRenderedColor * (1.0 - (1.0 - reflectionHit) * cloudsColor.a) + (1.0 - reflectionHit) * cloudsColor.xyz;\n}`):u.code.add(d`return waterRenderedColor * (1.0 - cloudsColor.a) + cloudsColor.xyz;\n}`):u.code.add(d`return waterRenderedColor;\n}`)}export{m as Water};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{set as e}from\"../../../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as t}from\"../../../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{s as r}from\"../../../../../../chunks/vec42.js\";import{create as a}from\"../../../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{FoamIntensity as o}from\"./FoamRendering.glsl.js\";import{ReadShadowMapPassParameters as m}from\"./ReadShadowMap.glsl.js\";import{Float2PassUniform as s}from\"../../shaderModules/Float2PassUniform.js\";import{Float4PassUniform as v}from\"../../shaderModules/Float4PassUniform.js\";import{glsl as l}from\"../../shaderModules/interfaces.js\";import{Texture2DPassUniform as i}from\"../../shaderModules/Texture2DPassUniform.js\";function u(t){t.fragment.uniforms.add(new i(\"texWaveNormal\",(e=>e.waveNormal)),new i(\"texWavePerturbation\",(e=>e.wavePerturbation)),new v(\"waveParams\",(e=>r(c,e.waveStrength,e.waveTextureRepeat,e.flowStrength,e.flowOffset))),new s(\"waveDirection\",(t=>e(n,t.waveDirection[0]*t.waveVelocity,t.waveDirection[1]*t.waveVelocity)))),t.include(o),t.fragment.code.add(l`const vec2  FLOW_JUMP = vec2(6.0/25.0, 5.0/24.0);\nvec2 textureDenormalized2D(sampler2D _tex, vec2 _uv) {\nreturn 2.0 * texture(_tex, _uv).rg - 1.0;\n}\nfloat sampleNoiseTexture(vec2 _uv) {\nreturn texture(texWavePerturbation, _uv).b;\n}\nvec3 textureDenormalized3D(sampler2D _tex, vec2 _uv) {\nreturn 2.0 * texture(_tex, _uv).rgb - 1.0;\n}\nfloat computeProgress(vec2 uv, float time) {\nreturn fract(time);\n}\nfloat computeWeight(vec2 uv, float time) {\nfloat progress = computeProgress(uv, time);\nreturn 1.0 - abs(1.0 - 2.0 * progress);\n}\nvec3 computeUVPerturbedWeigth(sampler2D texFlow, vec2 uv, float time, float phaseOffset) {\nfloat flowStrength = waveParams[2];\nfloat flowOffset = waveParams[3];\nvec2 flowVector = textureDenormalized2D(texFlow, uv) * flowStrength;\nfloat progress = computeProgress(uv, time + phaseOffset);\nfloat weight = computeWeight(uv, time + phaseOffset);\nvec2 result = uv;\nresult -= flowVector * (progress + flowOffset);\nresult += phaseOffset;\nresult += (time - progress) * FLOW_JUMP;\nreturn vec3(result, weight);\n}\nconst float TIME_NOISE_TEXTURE_REPEAT = 0.3737;\nconst float TIME_NOISE_STRENGTH = 7.77;\nvec3 getWaveLayer(sampler2D _texNormal, sampler2D _dudv, vec2 _uv, vec2 _waveDir, float time) {\nfloat waveStrength = waveParams[0];\nvec2 waveMovement = time * -_waveDir;\nfloat timeNoise = sampleNoiseTexture(_uv * TIME_NOISE_TEXTURE_REPEAT) * TIME_NOISE_STRENGTH;\nvec3 uv_A = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.0);\nvec3 uv_B = computeUVPerturbedWeigth(_dudv, _uv + waveMovement, time + timeNoise, 0.5);\nvec3 normal_A = textureDenormalized3D(_texNormal, uv_A.xy) * uv_A.z;\nvec3 normal_B = textureDenormalized3D(_texNormal, uv_B.xy) * uv_B.z;\nvec3 mixNormal = normalize(normal_A + normal_B);\nmixNormal.xy *= waveStrength;\nmixNormal.z = sqrt(1.0 - dot(mixNormal.xy, mixNormal.xy));\nreturn mixNormal;\n}\nvec4 getSurfaceNormalAndFoam(vec2 _uv, float _time) {\nfloat waveTextureRepeat = waveParams[1];\nvec3 normal = getWaveLayer(texWaveNormal, texWavePerturbation, _uv * waveTextureRepeat, waveDirection, _time);\nfloat foam  = normals2FoamIntensity(normal, waveParams[0]);\nreturn vec4(normal, foam);\n}`)}class f extends m{}const c=a(),n=t();export{u as WaterDistortion,f as WaterDistortionPassParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as e}from\"../../../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{hasArea as o,width as r,height as t}from\"../../../../../../geometry/support/aaBoundingRect.js\";import{OverlayIndex as a}from\"../../../../terrain/interfaces.js\";import{OverlayContent as l}from\"../../../../terrain/OverlayContent.js\";import{RenderPassIdentifier as i}from\"../../renderPasses/AllRenderPasses.js\";import{ShaderOutput as n}from\"../ShaderOutput.js\";import{addMainLightDirection as s,addMainLightIntensity as v}from\"../shading/MainLighting.glsl.js\";import{PBRMode as d}from\"../shading/PhysicallyBasedRenderingParameters.glsl.js\";import{Water as c}from\"../shading/Water.glsl.js\";import{Float4DrawUniform as x}from\"../../shaderModules/Float4DrawUniform.js\";import{FloatPassUniform as u}from\"../../shaderModules/FloatPassUniform.js\";import{glsl as y}from\"../../shaderModules/interfaces.js\";import{Texture2DPassUniform as m}from\"../../shaderModules/Texture2DPassUniform.js\";import{Uniform as p}from\"../../shaderModules/Uniform.js\";var f;function C(e,o){const{vertex:r,fragment:t}=e;r.uniforms.add(new x(\"overlayTexOffset\",((e,o)=>T(e,o))),new x(\"overlayTexScale\",((e,o)=>V(e,o)))),t.constants.add(\"overlayOpacity\",\"float\",1),t.uniforms.add(new m(\"ovColorTex\",((e,o)=>h(e,o)))),O(e,o)}function g(e,o){const{vertex:r,fragment:t}=e;r.uniforms.add(new I(\"overlayTexOffset\"),new I(\"overlayTexScale\")),t.uniforms.add(new u(\"overlayOpacity\",(e=>e.overlayOpacity)),new m(\"ovColorTex\",((e,o)=>o.overlay?.getTexture(e.overlayContent)))),O(e,o)}function O(e,o){const r=o.pbrMode===d.Water||o.pbrMode===d.WaterOnIntegratedMesh||o.pbrMode===d.TerrainWithWater;r&&e.include(c,o);const{vertex:t,fragment:a}=e;e.varyings.add(\"vtcOverlay\",\"vec4\"),t.code.add(y`void setOverlayVTC(in vec2 uv) {\nvtcOverlay = vec4(uv, uv) * overlayTexScale + overlayTexOffset;\n}`),a.code.add(y`bool isValid(vec2 uv, vec2 dxdy) {\nreturn (uv.x >= 0.0 + dxdy.x) && (uv.x <= 1.0 - dxdy.x) && (uv.y >= 0.0 + dxdy.y) && (uv.y <= 1.0 - dxdy.y);\n}\nvec4 getOverlayColor(sampler2D ov0Tex, vec4 texCoords) {\nvec4 color0 = texture(ov0Tex, vec2(texCoords.x * 0.5, texCoords.y));\nvec4 color1 = texture(ov0Tex, vec2(texCoords.z * 0.5 + 0.5, texCoords.w));\nbool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));\nbool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));\nreturn mix(color1 * float(isValid1), color0, float(isValid0));\n}`),a.code.add(y`vec4 getCombinedOverlayColor() {\nreturn overlayOpacity * getOverlayColor(ovColorTex, vtcOverlay);\n}`),a.code.add(y`vec4 getOverlayColorTexel(vec4 texCoords) {\nvec2 texDim =  vec2(textureSize(ovColorTex, 0));\nvec4 color0 = texelFetch(ovColorTex, ivec2(vec2(texCoords.x * 0.5, texCoords.y) * texDim), 0);\nvec4 color1 = texelFetch(ovColorTex, ivec2(vec2(texCoords.z * 0.5 + 0.5, texCoords.w) * texDim), 0);\nbool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));\nbool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));\nreturn mix(color1 * float(isValid1), color0, float(isValid0));\n}`),a.code.add(y`vec2 getAllOverlayHighlightValuesEncoded() {\nvec4 texCoords = vtcOverlay;\nvec2 uvInner = texCoords.xy;\nvec2 uvOuter = texCoords.zw;\nbool isValidInner = isValid(uvInner, fwidth(uvInner));\nbool isValidOuter = isValid(uvOuter, vec2(0.0, 0.0));\nvec2 texelCoordInner = vec2(uvInner.x * 0.5,       uvInner.y);\nvec2 texelCoordOuter = vec2(uvOuter.x * 0.5 + 0.5, uvOuter.y);\nvec2 texDim =  vec2(textureSize(ovColorTex, 0));\nvec2 texelValueInner = texelFetch(ovColorTex, ivec2(texelCoordInner * texDim), 0).rg;\nvec2 texelValueOuter = texelFetch(ovColorTex, ivec2(texelCoordOuter * texDim), 0).rg;\nreturn\nisValidInner ? texelValueInner :\nisValidOuter ? texelValueOuter :\nvec2(0.0);\n}`),r&&(s(a),v(a),a.code.add(y`vec4 getOverlayWaterColor(vec4 maskInput, vec4 colorInput, vec3 vposEyeDir,\nfloat shadow, vec3 localUp, mat3 tbn, vec3 position, vec3 positionWorld) {\nvec3 n = normalize(tbn *  (2.0 * maskInput.rgb - vec3(1.0)));\nvec3 v = vposEyeDir;\nvec3 final = getSeaColor(n, v, mainLightDirection, colorInput.rgb, mainLightIntensity, localUp, 1.0 - shadow, maskInput.w, position, positionWorld);\nreturn vec4(final, colorInput.w);\n}`))}function h(e,o){return e.identifier===i.Material&&e.output===n.Color?o.overlay?.getTexture(l.ColorNoRasterImage):e.identifier===i.Material&&e.output===n.ObjectAndLayerIdColor?o.overlay?.getTexture(l.ObjectAndLayerIdColor):e.identifier===i.Highlight?o.overlay?.getTexture(l.Highlight):null}function T(e,l){const i=l.overlay?.overlays[a.INNER]?.extent;o(i)&&(b[0]=e.toMapSpace[0]/r(i)-i[0]/r(i),b[1]=e.toMapSpace[1]/t(i)-i[1]/t(i));const n=l.overlay?.overlays[a.OUTER]?.extent;return o(n)&&(b[2]=e.toMapSpace[0]/r(n)-n[0]/r(n),b[3]=e.toMapSpace[1]/t(n)-n[1]/t(n)),b}function V(e,l){const i=l.overlay?.overlays[a.INNER]?.extent;o(i)&&(b[0]=e.toMapSpace[2]/r(i),b[1]=e.toMapSpace[3]/t(i));const n=l.overlay?.overlays[a.OUTER]?.extent;return o(n)&&(b[2]=e.toMapSpace[2]/r(n),b[3]=e.toMapSpace[3]/t(n)),b}!function(e){e[e.Disabled=0]=\"Disabled\",e[e.Enabled=1]=\"Enabled\",e[e.EnabledWithWater=2]=\"EnabledWithWater\",e[e.COUNT=3]=\"COUNT\"}(f||(f={}));const b=e();class I extends p{constructor(e){super(e,\"vec4\")}}export{C as OverlayIM,f as OverlayMode,g as OverlayTerrain,h as getIMColorTexture};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as o}from\"../../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{earth as t}from\"../../../../../../geometry/support/Ellipsoid.js\";import{CloudsTextureChannels as e}from\"../../../../environment/Clouds.js\";import{FadeState as a}from\"../../../../environment/CloudsParameters.js\";import{cloudsHeight as r}from\"../../../../environment/weather.js\";import{addMainLightDirection as i,addMainLightIntensity as c}from\"../shading/MainLighting.glsl.js\";import{BooleanPassUniform as n}from\"../../shaderModules/BooleanPassUniform.js\";import{Float3PassUniform as d}from\"../../shaderModules/Float3PassUniform.js\";import{FloatPassUniform as l}from\"../../shaderModules/FloatPassUniform.js\";import{glsl as s}from\"../../shaderModules/interfaces.js\";import{Matrix4PassUniform as u}from\"../../shaderModules/Matrix4PassUniform.js\";import{TextureCubePassUniform as m}from\"../../shaderModules/TextureCubePassUniform.js\";function h(t){const r=t.fragment;r.constants.add(\"radiusCloudsSquared\",\"float\",C).code.add(s`vec3 intersectWithCloudLayer(vec3 dir, vec3 cameraPosition, vec3 spherePos) {\nfloat B = 2.0 * dot(cameraPosition, dir);\nfloat C = dot(cameraPosition, cameraPosition) - radiusCloudsSquared;\nfloat det = B * B - 4.0 * C;\nfloat pointIntDist = max(0.0, 0.5 *(-B + sqrt(det)));\nreturn (cameraPosition + dir * pointIntDist) - spherePos;\n}`),r.uniforms.add(new l(\"radiusCurvatureCorrection\",((o,t)=>t.clouds.parallax.radiusCurvatureCorrection))).code.add(s`vec3 correctForPlanetCurvature(vec3 dir) {\ndir.z = dir.z * (1.0 - radiusCurvatureCorrection) + radiusCurvatureCorrection;\nreturn dir;\n}`),r.code.add(s`vec3 rotateDirectionToAnchorPoint(mat4 rotMat, vec3 inVec) {\nreturn (rotMat * vec4(inVec, 0.0)).xyz;\n}`),i(r),c(r);const h=o(.28,.175,.035);r.constants.add(\"RIM_COLOR\",\"vec3\",h);const v=.3,f=140,p=.2,g=10,w=.3;r.code.add(s`\n    vec3 calculateCloudColor(vec3 cameraPosition, vec3 worldSpaceRay, vec4 clouds) {\n      float upDotLight = dot(cameraPosition, mainLightDirection);\n      float dirDotLight = max(dot(worldSpaceRay, mainLightDirection), 0.0);\n      float sunsetTransition = clamp(pow(max(upDotLight, 0.0), ${s.float(v)}), 0.0, 1.0);\n\n      // Base color of the clouds that depends on lighting of the sun and sky\n      vec3 ambientLight = calculateAmbientIrradiance(cameraPosition,  0.0);\n      vec3 combinedLight = clamp((mainLightIntensity + ambientLight )/PI, vec3(0.0), vec3(1.0));\n      vec3 baseCloudColor = pow(combinedLight * pow(clouds.xyz, vec3(GAMMA)), vec3(INV_GAMMA));\n\n      // Rim light around the edge of the clouds simulating scattering of the direct lun light\n      float scatteringMod = max(clouds.a < 0.5 ? clouds.a / 0.5 : - clouds.a / 0.5 + 2.0, 0.0);\n      float rimLightIntensity = 0.5 + 0.5 * pow(max(upDotLight, 0.0), 0.35);\n      vec3 directSunScattering = RIM_COLOR * rimLightIntensity * (pow(dirDotLight, ${s.float(f)})) * scatteringMod;\n\n      // Brighten the clouds around the sun at the sunsets\n      float additionalLight = ${s.float(p)} * pow(dirDotLight, ${s.float(g)}) * (1. - pow(sunsetTransition, ${s.float(w)})) ;\n\n      return vec3(baseCloudColor * (1.0 + additionalLight) + directSunScattering);\n    }\n  `),r.uniforms.add(new n(\"readChannelsRG\",((o,t)=>t.clouds.readChannels===e.RG)),new m(\"cubeMap\",((o,t)=>t.clouds.data?.cubeMap?.colorTexture??null))).code.add(s`vec4 sampleCloud(vec3 rayDir, bool readOtherChannel) {\nvec4 s = texture(cubeMap, rayDir);\nbool readRG = readChannelsRG ^^ readOtherChannel;\ns = readRG ? vec4(vec3(s.r), s.g) : vec4(vec3(s.b), s.a);\nreturn length(s) == 0.0 ? vec4(s.rgb, 1.0) : s;\n}`),r.uniforms.add(new d(\"anchorPoint\",((o,t)=>t.clouds.parallax.anchorPoint)),new d(\"anchorPointNew\",((o,t)=>t.clouds.parallaxNew.anchorPoint)),new u(\"rotationClouds\",((o,t)=>t.clouds.parallax.transform)),new u(\"rotationCloudsNew\",((o,t)=>t.clouds.parallaxNew.transform)),new l(\"cloudsOpacity\",((o,t)=>t.clouds.opacity)),new l(\"fadeFactor\",((o,t)=>t.clouds.fadeFactor)),new n(\"crossFade\",((o,t)=>t.clouds.fadeState===a.CROSS_FADE))).code.add(s`vec4 renderClouds(vec3 worldRay, vec3 cameraPosition) {\nvec3 intersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPoint);\nvec3 worldRayRotated = rotateDirectionToAnchorPoint(rotationClouds, normalize(intersectionPoint));\nvec3 worldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);\nvec4 cloudData = sampleCloud(worldRayRotatedCorrected, crossFade);\nvec3 cameraPositionN = normalize(cameraPosition);\nvec4 cloudColor = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);\nif(crossFade) {\nintersectionPoint = intersectWithCloudLayer(worldRay, cameraPosition, anchorPointNew);\nworldRayRotated = rotateDirectionToAnchorPoint(rotationCloudsNew, normalize(intersectionPoint));\nworldRayRotatedCorrected = correctForPlanetCurvature(worldRayRotated);\ncloudData = sampleCloud(worldRayRotatedCorrected, false);\nvec4 cloudColorNew = vec4(calculateCloudColor(cameraPositionN, worldRay, cloudData), cloudData.a);\ncloudColor = mix(cloudColor, cloudColorNew, fadeFactor);\n}\nfloat totalTransmittance = length(cloudColor.rgb) == 0.0 ?\n1.0 :\nclamp(cloudColor.a * cloudsOpacity + (1.0 - cloudsOpacity), 0.0 , 1.0);\nreturn vec4(cloudColor.rgb, totalTransmittance);\n}`)}const C=(t.radius+r)**2;export{h as CloudsParallaxShading};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Uniform as e}from\"./Uniform.js\";import{BindType as r}from\"../shaderTechnique/BindType.js\";class s extends e{constructor(e,s){super(e,\"samplerCube\",r.Pass,((r,o,t)=>r.bindTexture(e,s(o,t))))}}export{s as TextureCubePassUniform};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Accessor.js\";import{ShaderOutput as r}from\"../core/shaderLibrary/ShaderOutput.js\";const t={required:[]},s={required:[r.Depth]};class n extends e{precompile(e){const r=this.acquireTechniques(e);return c(r),null!=r}consumes(){return t}get usedMemory(){return 0}get isDecoration(){return!1}get running(){return!1}modify(e){}get numGeometries(){return 0}get hasOccludees(){return!1}get hasEmissions(){return!1}forEachGeometry(e){}queryRenderOccludedState(e){return!1}}class u extends n{}class o extends n{}function c(e){Array.isArray(e)?e.forEach((e=>e?.release())):e?.release()}export{o as AsyncRenderPlugin,s as ConsumesDepth,t as ConsumesNone,u as SyncRenderPlugin,c as releaseTechniques};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import has from\"../../../../../core/has.js\";import{disposeMaybe as t,releaseMaybe as i}from\"../../../../../core/maybe.js\";import{watch as r,initial as s}from\"../../../../../core/reactiveUtils.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/RandomLCG.js\";import{subclass as l}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{set as n}from\"../../../../../core/libs/gl-matrix-2/math/vec2.js\";import{ZEROS as h}from\"../../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{InternalRenderCategory as a}from\"../../../webgl.js\";import{ColorFormat as c}from\"../../../webgl/formats.js\";import u from\"../../../webgl/RenderNode.js\";import{HighlightApplyTechnique as g}from\"./HighlightApplyTechnique.js\";import{HighlightDownsampleTechnique as p}from\"./HighlightDownsampleTechnique.js\";import{HighlightPassParameters as m}from\"./HighlightPassParameters.js\";import{HighlightToSingleTechnique as d}from\"./HighlightToSingleTechnique.js\";import{SingleHighlightApplyTechnique as f}from\"./SingleHighlightApplyTechnique.js\";import{SingleHighlightBlurTechnique as T}from\"./SingleHighlightBlurTechnique.js\";import{RenderRequestType as b}from\"../../lib/basicInterfaces.js\";import{Default3D as x}from\"../../lib/DefaultVertexAttributeLocations.js\";import{NoVertex as w}from\"../../lib/DefaultVertexBufferLayouts.js\";import{VertexArrayObject as _}from\"../../lib/VertexArrayObject.js\";import{H as v,g as C}from\"../../../../../chunks/HighlightDownsample.glsl.js\";import{S as q}from\"../../../../../chunks/SingleHighlightBlur.glsl.js\";import{maximumHighlights as H}from\"../../../../support/HighlightDefaults.js\";import{BufferObject as j}from\"../../../../webgl/BufferObject.js\";import{PixelFormat as y,TextureSamplingMode as D,FramebufferBit as P,Usage as R,TextureType as S,PrimitiveType as A,DataType as O}from\"../../../../webgl/enums.js\";import{Texture as M}from\"../../../../webgl/Texture.js\";import{TextureDescriptor as I}from\"../../../../webgl/TextureDescriptor.js\";let G=class extends u{constructor(e){super(e),this.produces=a.HIGHLIGHTS,this.consumes={required:[a.HIGHLIGHTS,\"highlights\"]},this.useMultipleHighlights=!!has(\"enable-feature:multiple-highlights\"),this._optionsTexture=null,this._downsampleDrawParameters=new v,this._passParameters=new m,this._singleHighlightBlurDrawParameters=new q,this._grid=new L,e.techniques.precompile(p),this.useMultipleHighlights?e.techniques.precompile(g):(e.techniques.precompile(d),e.techniques.precompile(T),e.techniques.precompile(f))}initialize(){this.addHandles([r((()=>F(this.view.highlights)),(()=>{this._optionsTexture=t(this._optionsTexture),this.requestRender(b.UPDATE)}),s)])}destroy(){this._passParameters&&(this._passParameters.highlightOptionsTexture=null),this._grid.coverage=i(this._grid.coverage),this._grid.vao=t(this._grid.vao),this._optionsTexture=i(this._optionsTexture)}_updateOptionsTexture(e){const t=this.renderingContext;let i=this._optionsTexture;if(null==i){const e=new I(16,2);e.internalFormat=y.RGBA,e.samplingMode=D.NEAREST,i=new M(t,e,null),this._optionsTexture=i}i.setData(e),this._passParameters.highlightOptionsTexture=i}render(e){const t=e.find((({name:e})=>e===a.HIGHLIGHTS)),{techniques:i,bindParameters:r,_passParameters:s,renderingContext:o}=this;if(!r.decorations)return t;const l=i.acquire(p);if(!l.compiled)return l.release(),this.requestRender(b.UPDATE),t;const n=e.find((({name:e})=>\"highlights\"===e)).getTexture(),h=()=>{const{highlights:e}=this.view;this._optionsTexture||this._updateOptionsTexture(E(e)),s.highlightOptionsTexture=this._optionsTexture,this._gridUpdateResources(n);const t=this._gridComputeCoverage(l,n,r);l.release();const{horizontalCellCount:i,verticalCellCount:o}=t;return s.horizontalCellCount=i,s.verticalCellCount=o,s.coverageTexture=t.coverage?.getTexture(),t},c=e=>{const t=e.verticalCellCount*e.horizontalCellCount;o.bindVAO(e.vao),o.drawElementsInstanced(A.TRIANGLES,6,O.UNSIGNED_BYTE,0,t)},{camera:u}=r,g=()=>{o.bindFramebuffer(t.fbo),o.setViewport4fv(u.fullViewport)};return this.useMultipleHighlights?this._renderMultiple(n,h,c,g):this._renderSingle(n,h,c,g),s.highlightTexture=null,s.coverageTexture=null,t}_renderMultiple(e,t,i,r){const{techniques:s,bindParameters:o,_passParameters:l,renderingContext:n}=this,h=s.acquire(g);if(!h.compiled)return h.release(),void this.requestRender(b.UPDATE);const a=t();l.highlightTexture=e,l.pixelRatio=o.camera.pixelRatio,l.maxHighlightLevel=k(this.view.highlights)-1,n.bindTechnique(h,o,l),r(),i(a),h.release()}_renderSingle(e,t,i,r){const{fboCache:s,techniques:o,bindParameters:l,_passParameters:h,renderingContext:a}=this,u=o.acquire(d),g=o.acquire(T),p=o.acquire(f);if(!p.compiled||!g.compiled||!u.compiled)return p.release(),g.release(),u.release(),void this.requestRender(b.UPDATE);const m=t(),{width:x,height:w}=e.descriptor;h.maxHighlightLevel=k(this.view.highlights)-1,h.highlightTexture=e;const{camera:_}=l,{fullWidth:v,fullHeight:C,pixelRatio:q}=_,H=Math.ceil(v/q),j=Math.ceil(C/q),{_singleHighlightBlurDrawParameters:y}=this;for(let d=0;d<=h.maxHighlightLevel;++d){h.highlightLevel=d,a.setClearColor(0,0,0,0);const e=s.acquire(x,w,\"single highlight\",c.RG);a.bindFramebuffer(e.fbo),a.setViewport(0,0,x,w),a.clear(P.COLOR),a.bindTechnique(u,l,h),i(m),y.blurInput=e.getTexture(),n(y.blurSize,1/H,0);const t=s.acquire(H,j,\"single highlight blur h\",c.RG);a.unbindTexture(t.fbo?.colorTexture),a.bindFramebuffer(t.fbo),a.setViewport(0,0,H,j),a.clear(P.COLOR),y.blurInput=e.getTexture(),n(y.blurSize,1/H,0),a.bindTechnique(g,l,h,y),i(m),e.release(),n(y.blurSize,0,1/j),h.singleHighlightBlurTexture=t.getTexture(),r(),a.bindTechnique(p,l,h,y),i(m),t.release()}u.release(),g.release(),p.release()}_gridUpdateResources(e){const t=this.renderingContext,i=this._grid,{width:r,height:s}=e.descriptor;if(i.horizontalCellCount=Math.ceil(r/C),i.verticalCellCount=Math.ceil(s/C),i.vao)return;const o=j.createIndex(t,R.STATIC_DRAW,N);i.vao=new _(t,x,new Map([[\"geometry\",w]]),new Map([[\"geometry\",j.createVertex(t,R.STATIC_DRAW)]]),o)}_gridComputeCoverage(e,t,i){const r=this.renderingContext,s=this._grid,o=t.descriptor,l=Math.ceil(o.width/C),n=Math.ceil(o.height/C);this._downsampleDrawParameters.input=t,s.coverage?.release();const h=this.fboCache.acquire(l,n,\"highlight coverage\",c.RG);return s.coverage=h,r.bindFramebuffer(h.fbo),r.bindTechnique(e,i,this._passParameters,this._downsampleDrawParameters),r.setViewport(0,0,l,n),r.screen.draw(),s}get test(){}};e([o()],G.prototype,\"produces\",void 0),e([o()],G.prototype,\"consumes\",void 0),e([o({constructOnly:!0})],G.prototype,\"techniques\",void 0),G=e([l(\"esri.views.3d.webgl-engine.effects.highlight.Highlight\")],G);class L{constructor(){this.coverage=null,this.vao=null,this.verticalCellCount=0,this.horizontalCellCount=0,this.viewportWidth=0,this.viewportHeight=0}}function E(e){const t=new Uint8Array(128),i=(e,i)=>{t[e]=i},r=(e,t)=>{const r=4*e,s=4*e+64,{color:o}=t,l=t.haloColor??o;i(r+0,o.r),i(r+1,o.g),i(r+2,o.b),i(r+3,t.fillOpacity*o.a*255),i(s+0,l.r),i(s+1,l.g),i(s+2,l.b),i(s+3,t.haloOpacity*l.a*255)};return V(e,((e,t)=>{r(t,e.options)})),t}const z=new Array(H),U=new Array(H);function V(e,t){const i=Math.min(e.length,H);let r=H;for(let o=i-1;o>=0;--o){const t=e.at(o);if(t){const e=t.name;z.includes(e,r)||(--r,z[r]=e,U[r]=o)}}const s=H-r;for(let o=0;o<s;++o){const i=U[H-s+o];t(e.at(i),o)}}let B=0;function F(e){let t=0;const i=Math.min(H,e.length);for(let r=0;r<i;++r){const i=e.at(r);if(i){const{name:e,options:r}=i;t+=e.length;const{color:s,fillOpacity:o,haloColor:l,haloOpacity:n}=r;t+=s.r+(l?.r??1)+o+n}}{const i=e.at(0);if(i){const{shadowOpacity:e,shadowDifference:r,shadowColor:s}=i.options;t+=e+r+s.r}}return B+++(t>=0?0:1)}const N=new Uint8Array([0,1,2,2,1,3]);function W(e,t,i,r,s,o,l=0,a){const{highlightGroupIndices:u}=s;u.clear();const g=[];V(r,(e=>{const{name:t}=e;u.set(t,g.length),g.push(t)}));const p=u.size,{gl:m}=e;n(s.highlightMixOrigin,l,0);let d=null;p>1&&(d=t.acquire(i.width,i.height,\"highlight mix\",c.RG),e.bindFramebuffer(d.fbo),e.clearFramebuffer(h));const f=d?.getTexture()??null;s.highlightMixTexture=f,a();for(let n=0;n<p;++n)n>0&&(e.bindTexture(f,0),m.copyTexSubImage2D(S.TEXTURE_2D,0,0,0,l,0,i.width,i.height),e.bindTexture(null,0)),e.clear(P.DEPTH),s.highlightLevel=n,s.highlightGroupName=g[n],o();d?.release()}function k(e){const t=new Set;for(let i=0;i<H;++i){const r=e.at(i)?.name;r&&t.add(r)}return t.size}export{G as Highlight,W as renderHighlightBuffer,F as trackHighlightOptions};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{H as i}from\"../../../../../chunks/HighlightApply.glsl.js\";import{makePipelineState as o,premultipliedAlphaToPremultipliedAlpha as s,defaultColorWrite as l}from\"../../../../webgl/renderState.js\";class t extends r{constructor(r,o,s){super(r,o,new e(i,(()=>import(/* webpackChunkName: \"shaders-HighlightApply.glsl\" */ \"../../shaders/HighlightApply.glsl.js\"))),s)}initializePipeline(){return o({blending:s,colorWrite:l})}}export{t as HighlightApplyTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{a as o}from\"../../../../../chunks/HighlightDownsample.glsl.js\";import{makePipelineState as s,defaultColorWrite as i}from\"../../../../webgl/renderState.js\";class l extends r{constructor(r,s,i){super(r,s,new e(o,(()=>import(/* webpackChunkName: \"shaders-HighlightDownsample.glsl\" */ \"../../shaders/HighlightDownsample.glsl.js\"))),i)}initializePipeline(){return s({colorWrite:i})}}export{l as HighlightDownsampleTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{NoParameters as t}from\"../../core/shaderModules/interfaces.js\";import{defaultOccludedFactor as e}from\"../../../../support/HighlightDefaults.js\";class i extends t{constructor(){super(...arguments),this.occludedFactor=e,this.maxHighlightLevel=1,this.verticalCellCount=0,this.horizontalCellCount=0,this.highlightLevel=0,this.pixelRatio=1}}export{i as HighlightPassParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{H as i}from\"../../../../../chunks/HighlightToSingle.glsl.js\";import{makePipelineState as o,defaultColorWrite as s}from\"../../../../webgl/renderState.js\";class l extends r{constructor(r,o,s){super(r,o,new e(i,(()=>import(/* webpackChunkName: \"shaders-HighlightToSingle.glsl\" */ \"../../shaders/HighlightToSingle.glsl.js\"))),s)}initializePipeline(){return o({colorWrite:s})}}export{l as HighlightToSingleTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{S as i}from\"../../../../../chunks/SingleHighlightApply.glsl.js\";import{makePipelineState as l,premultipliedAlphaToPremultipliedAlpha as o,defaultColorWrite as s}from\"../../../../webgl/renderState.js\";class t extends r{constructor(r,l,o){super(r,l,new e(i,(()=>import(/* webpackChunkName: \"shaders-SingleHighlightApply.glsl\" */ \"../../shaders/SingleHighlightApply.glsl.js\"))),o)}initializePipeline(){return l({blending:o,colorWrite:s})}}export{t as SingleHighlightApplyTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../../core/shaderTechnique/ShaderTechnique.js\";import{a as i}from\"../../../../../chunks/SingleHighlightBlur.glsl.js\";import{makePipelineState as l,defaultColorWrite as o}from\"../../../../webgl/renderState.js\";class s extends r{constructor(r,l,o){super(r,l,new e(i,(()=>import(/* webpackChunkName: \"shaders-SingleHighlightBlur.glsl\" */ \"../../shaders/SingleHighlightBlur.glsl.js\"))),o)}initializePipeline(){return l({colorWrite:o})}}export{s as SingleHighlightBlurTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as i}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{create as t}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{CloudsParameters as e}from\"../../environment/CloudsParameters.js\";import h from\"../../webgl/RenderCamera.js\";import{HUDRenderStyle as s}from\"../core/shaderLibrary/hud/HUDRenderStyle.js\";import{OITPass as r}from\"./OITPass.js\";import{RenderSlot as g}from\"./RenderSlot.js\";import{Update as n}from\"./Update.js\";import{SceneLighting as o}from\"../lighting/SceneLighting.js\";class a{constructor(i,t){this.width=i,this.height=t}}class l{constructor(i){this.shadowMap=i,this.slot=g.OPAQUE_MATERIAL,this.slicePlane=null,this.hasOccludees=!1,this.enableFillLights=!0,this.oitPass=r.NONE,this.alignPixelEnabled=!1,this.decorations=!0,this.overlayStretch=1,this.viewshedEnabled=!1,this._camera=new h,this._inverseViewport=t(),this._oldLighting=new o,this._newLighting=new o,this._fadedLighting=new o,this._lighting=this._newLighting,this.ssr=new c,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.highlightMixTexture=null,this.highlightGroupName=null,this.highlightGroupIndices=new Map,this.highlightLevel=0,this.highlightMixOrigin=t(),this.hudRenderStyle=s.Occluded,this.clouds=new e,this.shadowHighlightsVisible=!1}get camera(){return this._camera}set camera(i){this._camera=i,this._inverseViewport[0]=1/i.fullViewport[2],this._inverseViewport[1]=1/i.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}fadeLighting(){switch(this.clouds.fadeFactor){case 0:this._lighting=this._oldLighting;break;default:this._fadedLighting.lerpLighting(this._oldLighting,this._newLighting,this.clouds.fadeFactor),this._lighting=this._fadedLighting;break;case 1:this._lighting=this._newLighting,this._oldLighting.copyFrom(this._newLighting)}}updateLighting(i,t,e,h){this._oldLighting.copyFrom(this.lighting),this._newLighting.noonFactor=t,this._newLighting.globalFactor=e,this._newLighting.set(i),h===n.FadeWithWeather&&this.clouds.requestFade(),this.fadeLighting()}}class c{constructor(){this.fadeFactor=1,this.reprojectionMatrix=i()}}export{l as BindParameters,a as ViewportSize};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../../chunks/tslib.es6.js\";import{property as o}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as e}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{create as t}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import s from\"../../webgl/RenderCamera.js\";let i=class extends s{constructor(){super(...arguments),this._projectionMatrix=t()}get projectionMatrix(){return this._projectionMatrix}};r([o()],i.prototype,\"_projectionMatrix\",void 0),r([o({readOnly:!0})],i.prototype,\"projectionMatrix\",null),i=r([e(\"esri.views.3d.webgl-engine.lib.CascadeCamera\")],i);export{i as CascadeCamera};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/PooledArray.js\";class s{constructor(){this.adds=new e,this.removes=new e,this.updates=new e({allocator:e=>e||new r,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}get empty(){return 0===this.adds.length&&0===this.removes.length&&0===this.updates.length}}class r{}class t{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}}export{s as ChangeSet,t as MaterialChangeSet,r as RenderGeometryUpdate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{VertexAttribute as e}from\"./VertexAttribute.js\";import{DataType as r}from\"../../../webgl/enums.js\";import{VertexElementDescriptor as t}from\"../../../webgl/VertexElementDescriptor.js\";const O=[],o=[new t(e.POSITION,3,r.FLOAT,0,12)],m=[new t(e.POSITION,2,r.FLOAT,0,8)],n=[new t(e.POSITION,2,r.FLOAT,0,16),new t(e.UV0,2,r.FLOAT,8,16)];export{O as NoVertex,m as Pos2,n as Pos2Tex,o as Pos3};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getTextHelperCanvas as t}from\"./TextHelperCanvas.js\";function e(e){const{size:c}=e.definition,a=e.fontString(c);let i=n.get(a);if(!i){const u=t(o,0,0).getContext(\"2d\");e.setFontProperties(u,c);const x=u.measureText(r);i=new s(x.actualBoundingBoxAscent,x.actualBoundingBoxDescent),n.set(a,i)}return i}const n=new Map;class s{get maxHeight(){return this.maxAscent+this.maxDescent}constructor(t,e){this.maxAscent=t,this.maxDescent=e}}const o={canvas:null},r=(()=>{let t=\"\";for(let e=32;e<127;e++)t+=String.fromCharCode(e);return t})();export{e as getFontMetrics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Logger.js\";import{disposeMaybe as t}from\"../../../../core/maybe.js\";import{NestedMap as r}from\"../../../../core/NestedMap.js\";import{assert as i}from\"./Util.js\";class s{constructor(e,t,i,s){this._textures=e,this._techniques=t,this.materialChanged=i,this.requestRender=s,this._id2glMaterialRef=new r}dispose(){this._textures.destroy()}acquire(e,t,r){this._ownMaterial(e);const i=e.produces.get(t);if(!i?.(r))return null;let s=this._id2glMaterialRef.get(r,e.id);if(null==s){const t=e.createGLMaterial({material:e,techniques:this._techniques,textures:this._textures,output:r});s=new a(t),this._id2glMaterialRef.set(r,e.id,s)}return s.ref(),s.glMaterial}release(e,r){const i=this._id2glMaterialRef.get(r,e.id);null!=i&&(i.unref(),i.referenced||(t(i.glMaterial),this._id2glMaterialRef.delete(r,e.id)))}_ownMaterial(t){t.repository&&t.repository!==this&&e.getLogger(\"esri.views.3d.webgl-engine.lib.GLMaterialRepository\").error(\"Material is already owned by a different material repository\"),t.repository=this}}class a{constructor(e){this.glMaterial=e,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,i(this._refCnt>=0)}get referenced(){return this._refCnt>0}}export{s as GLMaterialRepository};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ResourceState as s}from\"./basicInterfaces.js\";class t{constructor(s,t){this._material=s,this._repository=t,this._map=new Map}dispose(){this._map.forEach(((s,t)=>{null!=s&&this._repository.release(this._material,t)}))}load(t,e,r){const i=this._material.produces.get(e);if(!i?.(r))return null;this._map.has(r)||this._map.set(r,this._repository.acquire(this._material,e,r));const a=this._map.get(r);if(null!=a){if(a.ensureResources(t)===s.LOADED)return a;this._repository.requestRender()}return null}}export{t as GLMaterials};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar E,I;!function(E){E[E.ADD=0]=\"ADD\",E[E.UPDATE=1]=\"UPDATE\",E[E.REMOVE=2]=\"REMOVE\"}(E||(E={})),function(E){E[E.NONE=0]=\"NONE\",E[E.VISIBILITY=1]=\"VISIBILITY\",E[E.GEOMETRY=2]=\"GEOMETRY\",E[E.TRANSFORMATION=4]=\"TRANSFORMATION\",E[E.HIGHLIGHT=8]=\"HIGHLIGHT\",E[E.OCCLUDEE=16]=\"OCCLUDEE\"}(I||(I={}));export{E as DirtyOperation,I as DirtyState};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../../../core/mathUtils.js\";import{q as n,n as r}from\"../../../../chunks/vec32.js\";import{create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{newFloatArray as a}from\"../../../../geometry/support/FloatArray.js\";function s(t,n,r,o,a,s=2){const e=1/(Math.abs(r)+Math.abs(o)+Math.abs(a)),c=r*e,f=o*e,h=a<=0?(c>=0?1:-1)*(1-Math.abs(f)):c,u=a<=0?(f>=0?1:-1)*(1-Math.abs(c)):f,l=n*s;t[l]=i(h),t[l+1]=i(u)}function e(t){const n=t.length/3,r=new Int16Array(2*n);let o=0;for(let a=0;a<n;++a)s(r,a,t[o++],t[o++],t[o++]);return r}function c(t,r){const a=t.length/3,e=new Int16Array(2*a);let c=0;const f=o();for(let o=0;o<a;++o)f[0]=t[c++],f[1]=t[c++],f[2]=t[c++],n(f,f,r),s(e,o,f[0],f[1],f[2]);return e}function f(t,n,o,a=2){const s=o*a,e=u(n[s]),c=u(n[s+1]),f=1-Math.abs(e)-Math.abs(c);t[2]=f,f<0?(t[0]=(e>=0?1:-1)*(1-Math.abs(c)),t[1]=(c>=0?1:-1)*(1-Math.abs(e))):(t[0]=e,t[1]=c),r(t,t)}function h(t,n=2){const r=t.length/n,s=a(3*r),e=o();let c=0;for(let o=0;o<r;++o)f(e,t,o,n),s[c++]=e[0],s[c++]=e[1],s[c++]=e[2];return s}function i(n){return t(Math.round(32767*n),-32767,32767)}function u(n){return t(n/32767,-1,1)}export{c as compressAndTransformNormals,s as compressNormal,e as compressNormals,u as decodeInt16,f as decompressNormal,h as decompressNormals,i as encodeInt16};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{estimateSize as t}from\"../../../../core/typedArrayUtil.js\";import{l as i,n as s,c as o}from\"../../../../chunks/vec32.js\";import{fromValues as e}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{newFloatArray as h}from\"../../../../geometry/support/FloatArray.js\";class r{constructor(t,i,s,o){this.vertices=t,this.positionsES=i,this.offset=o;const r=t.length,n=Math.floor(r/2),g=this.offset+3*n,v=s[g],f=s[g+1],c=s[g+2];this.origin=e(v,f,c),this.positions=h(3*r);const l=this.offset+3*r;for(let e=this.offset;e<l;e+=3)this.positions[e]=s[e]-v,this.positions[e+1]=s[e+1]-f,this.positions[e+2]=s[e+2]-c;this.updatePathVertexInformation()}get usedMemory(){return t(this.positions)}updatePathVertexInformation(){const t=this.vertices.length,e=this.vertices[0];let h=this.offset;const r=this.positions;e.vRight[0]=r[h+3]-r[h],e.vRight[1]=r[h+4]-r[h+1],e.vRight[2]=r[h+5]-r[h+2],h+=3;let n=i(e.vRight);e.vMinSiblingLength=n,s(e.vRight,e.vRight);let g=e;for(let v=1;v<t;++v){const e=this.vertices[v];if(e.vLeft=g.vRight,v<t-1){e.vRight[0]=r[h+3]-r[h],e.vRight[1]=r[h+4]-r[h+1],e.vRight[2]=r[h+5]-r[h+2];const t=i(e.vRight);e.vMinSiblingLength=Math.min(n,t),n=t,s(e.vRight,e.vRight)}else o(e.vRight,e.vLeft),e.vMinSiblingLength=n;g=e,h+=3}}}export{r as Path};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{estimateSize as t}from\"../../../../core/typedArrayUtil.js\";import{newFloatArray as e,floatSubArray as i}from\"../../../../geometry/support/FloatArray.js\";import{newIntArray as s,compactIndices as r}from\"../../../../geometry/support/Indices.js\";class h{constructor(t,r,h,o,p,n={}){this.path=t,this.profile=r,this.extruder=h,this.startCap=o,this.endCap=p,this.options=n,this._extrusionVertexCount=0;const l=this.path.vertices.length-2;this.numExtrusionProfiles=h.numProfilesPerJoin()*l+2,this.numVerticesTotal=r.vertices.length*this.numExtrusionProfiles,this.startCap.vertexBufferStart=this.numVerticesTotal;const a=this.startCap.numVertices;this.numVerticesTotal+=a,this.endCap.vertexBufferStart=this.numVerticesTotal;const u=this.endCap.numVertices;this.numVerticesTotal+=u,this.pathVertexData=s(1*this.numVerticesTotal),this.profileRightAxes=e(4*this.numVerticesTotal),this.profileUpAxes=e(4*this.numVerticesTotal),this.profileVertexAndNormals=e(4*this.numVerticesTotal),this.positions=i(t.positions,t.offset,3*t.vertices.length),this._rebuildGeometry(),this.buildTopology()}get usedMemory(){return t(this.pathVertexData,this.profileRightAxes,this.profileUpAxes,this.profileVertexAndNormals)+this.path.usedMemory+this.profile.usedMemory}emitVertex(t,e,i,s,r){const h=4*this._extrusionVertexCount;if(this.profileRightAxes[h]=e.right[0],this.profileRightAxes[h+1]=e.right[1],this.profileRightAxes[h+2]=e.right[2],this.profileUpAxes[h]=e.up[0],this.profileUpAxes[h+1]=e.up[1],this.profileUpAxes[h+2]=e.up[2],this.profileVertexAndNormals[h]=i[0],this.profileVertexAndNormals[h+1]=i[1],this.profileVertexAndNormals[h+2]=s[0],this.profileVertexAndNormals[h+3]=s[1],this.pathVertexData[this._extrusionVertexCount]=t,r){const e=this.path.vertices[t],i=e.maxStretchDistance;this.profileRightAxes[h+3]=e.rotationRight[0]*i,this.profileUpAxes[h+3]=e.rotationRight[1]*i}else this.profileRightAxes[h+3]=0,this.profileUpAxes[h+3]=0;++this._extrusionVertexCount}emitCapVertex(t,e,i,s,r,h){const o=4*this._extrusionVertexCount;this.profileRightAxes[o]=e.right[0],this.profileRightAxes[o+1]=e.right[1],this.profileRightAxes[o+2]=e.right[2],this.profileRightAxes[o+3]=r,this.profileUpAxes[o]=e.up[0],this.profileUpAxes[o+1]=e.up[1],this.profileUpAxes[o+2]=e.up[2],this.profileUpAxes[o+3]=h,this.profileVertexAndNormals[o]=i[0],this.profileVertexAndNormals[o+1]=i[1],this.profileVertexAndNormals[o+2]=s[0],this.profileVertexAndNormals[o+3]=s[1],this.pathVertexData[this._extrusionVertexCount]=t,++this._extrusionVertexCount}_rebuildGeometry(){this._extrusionVertexCount=0;const{positions:t,offset:e,vertices:s}=this.path;this.positions=i(t,e,3*s.length);let r=0;const h=(t,e,i,s,h)=>this.emitCapVertex(r,t,e,i,s,h),o=(t,e,i,s)=>this.emitVertex(r,t,e,i,s);for(this.startCap.rebuildConnectingProfileGeometry(s[r],this.profile,h),r=1;r<s.length-1;++r)this.extruder.extrude(s[r],this.profile,o);this.endCap.rebuildConnectingProfileGeometry(s[r],this.profile,h),r=0,this.startCap.rebuildCapGeometry(s[r],h),r=s.length-1,this.endCap.rebuildCapGeometry(s[r],h)}buildTopology(){const t=this.profile.vertices.length,e=this.profile.numSegments,i=this.numExtrusionProfiles-1;let s=3*(2*(e*i));this.startCap.indexBufferStart=s,this.startCap.firstProfileVertexIndex=0,s+=this.startCap.numIndices,this.endCap.indexBufferStart=s,this.endCap.firstProfileVertexIndex=t*(this.numExtrusionProfiles-1);const h=new Array,o=new Array,p=new Array,n=(t,e,i)=>{h.push(t),h.push(e),h.push(i),o.push(t),o.push(e),o.push(i),p.push(this.pathVertexData[t]),p.push(this.pathVertexData[e]),p.push(this.pathVertexData[i])};for(let r=0;r<e;++r){const e=this.profile.indices[2*r],s=this.profile.indices[2*r+1];for(let r=0;r<i;++r){const i=r*t+e,h=(r+1)*t+s,o=r*t+s;n(i,(r+1)*t+e,h),n(i,h,o)}}this.startCap.buildTopology(this.path.vertices[0],n),this.endCap.buildTopology(this.path.vertices[this.path.vertices.length-1],n),this.vertexIndices=r(h),this.normalIndices=r(o),this.pathVertexIndices=r(p)}onPathChanged(){this._rebuildGeometry()}}export{h as PathBuilder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{set as e,subtract as t,scale as s,add as i,normalize as r}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as n}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";class o{rebuildConnectingProfileGeometry(e,t,s){for(let i=0;i<t.vertices.length;++i)s(e.frame,t.vertices[i],t.normals[i],0,0)}}class l extends o{constructor(){super(),this.numVertices=0,this.numIndices=0}rebuildCapGeometry(){}buildTopology(){}}class f extends o{constructor(e,t=0,s=!1){super(),this.profile=e,this.profilePlaneOffset=t,this.flip=s}get numVertices(){return this.profile.vertices.length}get numIndices(){return 3*this.profile.numSegments}rebuildConnectingProfileGeometry(e,t,s){const i=this.profilePlaneOffset;for(let r=0;r<t.vertices.length;++r)s(e.frame,t.vertices[r],t.normals[r],i,0)}rebuildCapGeometry(t,s){const i=this.profile,r=this.flip?1:-1,n=this.profilePlaneOffset,o=m;e(o,0,0);for(let e=0;e<i.vertices.length;++e)s(t.frame,i.vertices[e],o,n,r)}buildTopology(e,t){const s=this.profile,i=this.vertexBufferStart+s.indices[0];for(let r=1;r<s.numSegments;++r){const e=s.indices[2*r],n=s.indices[2*r+1],o=this.vertexBufferStart+e,l=this.vertexBufferStart+n;this.flip?t(l,o,i):t(i,o,l)}}}class h extends o{constructor(e){super(),this.flip=!1,this.sign=0,this.breakNormals=!1,this.numSegments=3,this.profile=e.profile,this.flip=e.flip,this.sign=this.flip?1:-1,this.breakNormals=e.breakNormals,this.numSegments=e.subdivisions}get numVertices(){let e=this.profile.vertices.length*(this.numSegments-1)+this.profile.poles.length;return this.breakNormals&&(e+=this.profile.vertices.length),e}get numIndices(){let e=0;const t=this.profile;e+=2*t.numSegments*(this.numSegments-1);for(let s=0;s<t.numSegments;++s){const i=t.indices[2*s],r=t.indices[2*s+1];t.poleIndices[i]===t.poleIndices[r]?e+=1:e+=2}return 3*e}rebuildCapGeometry(n,o){const l=this.profile,f=n.frame,h=.5*this.sign,p=c,a=m;e(a,0,0);for(const e of l.poles)e.normal?o(f,e.position,e.normal,h,0):o(f,e.position,a,h,this.sign);if(this.breakNormals)for(let e=0;e<l.vertices.length;++e)o(f,l.vertices[e],l.normals[e],0,0);for(let e=0;e<this.numSegments-1;++e){const n=(1-(e+1)/this.numSegments)*Math.PI*.5,c=Math.sin(n),m=Math.cos(n);for(let e=0;e<l.vertices.length;++e){const n=l.poles[l.poleIndices[e]];t(p,l.vertices[e],n.position),s(p,p,c),n.normal?(i(p,p,n.position),o(f,p,n.normal,h*m,0)):(r(a,p),s(a,a,c),i(p,p,n.position),o(f,p,a,h*m,this.sign*m))}}}buildTopology(e,t){const s=this.profile,i=this.breakNormals?this.vertexBufferStart+s.poles.length:this.firstProfileVertexIndex,r=this.breakNormals?this.vertexBufferStart+s.poles.length+s.vertices.length:this.vertexBufferStart+s.poles.length;for(let n=0;n<s.numSegments;++n){const e=s.indices[2*n],o=s.indices[2*n+1],l=this.vertexBufferStart+s.poleIndices[e],f=this.vertexBufferStart+s.poleIndices[o];let h=i+e,c=i+o;for(let i=0;i<this.numSegments-1;++i){const n=r+i*s.vertices.length+e,l=r+i*s.vertices.length+o;this.flip?(t(n,c,h),t(c,n,l)):(t(h,c,n),t(l,n,c)),h=n,c=l}this.flip?(t(l,c,h),l!==f&&t(l,f,c)):(t(h,c,l),l!==f&&t(c,f,l))}}}const c=n(),m=n();export{l as NoCapBuilder,o as PathCapBuilder,h as RoundCapBuilder,f as TriangulationCapBuilder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromRotation as t}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as e}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{dot as r}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{t as i}from\"../../../../chunks/vec32.js\";import{create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";class n{}class c{numProfilesPerJoin(){return 1}extrude(t,e,r){for(let s=0;s<e.vertices.length;++s)r(t.frame,e.vertices[s],e.normals[s],!1)}}class a{constructor(t,e){this.cutoffAngle=t,this.numBendSubdivisions=e}numProfilesPerJoin(){return this.numBendSubdivisions+1}extrude(e,s,i){const o=h,{rotationAngle:n,rotationRight:c,frame:a}=e;if(Math.abs(n)>=this.cutoffAngle){const l=e.rotationFrameUp;for(let h=0;h<this.numBendSubdivisions+1;++h){t(u,.5*-n+h*n/this.numBendSubdivisions,l),m(o,a,u);for(let t=0;t<s.vertices.length;++t){if(r(s.vertices[t],c)*n>=0)i(o,s.vertices[t],s.normals[t],!1);else{i(a,e.applyMiterStretch(f,s.vertices[t]),s.normals[t],!0)}}}}else for(let t=0;t<this.numBendSubdivisions+1;++t)for(let o=0;o<s.vertices.length;++o){const t=r(s.vertices[o],c)*n>=0;i(a,e.applyMiterStretch(f,s.vertices[o]),s.normals[o],!t)}}}class l{constructor(){this.up=o(),this.right=o()}}function m(t,e,r){i(t.up,e.up,r),i(t.right,e.right,r)}const f=s(),u=e(),h=new l;export{l as Frame2D,a as MiterExtruder,n as PathExtruder,c as SimpleExtruder};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ContentObjectType as t}from\"./ContentObjectType.js\";import{Geometry as r}from\"./Geometry.js\";class e extends r{constructor(r,e,o,n,s,i){super(r,e,null,t.Mesh,i),this.path=o,this.geometrySR=n,this.stencilWidth=s}}var o;function n(t){return\"path\"in t}!function(t){t[t.World=0]=\"World\",t[t.Path=1]=\"Path\"}(o||(o={}));export{e as PathGeometry,o as UpVectorAlignment,n as isPathGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{set as t,length as e,normalize as r,dot as i,scale as s,add as o}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as n,e as h}from\"../../../../chunks/vec32.js\";import{create as l}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as c}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{newFloatArray as u}from\"../../../../geometry/support/FloatArray.js\";import{getZeroIndexArray as b}from\"../../../../geometry/support/Indices.js\";import{Attribute as v,Vertices as m}from\"./Attribute.js\";import{compressNormal as p}from\"./Normals.js\";import{intersectTriangles as x}from\"./RayIntersections.js\";import{VertexAttribute as A}from\"./VertexAttribute.js\";class d{constructor(t){this.builder=t}onPathChanged(t){this.builder.onPathChanged()}}class f extends d{constructor(t){super(t),this.vertexAttributeColor=c(255,255,255,255),this.size=new Array,this.vertexAttributePosition=u(3*this.builder.numVerticesTotal),this.vertexAttributeNormal=new Int16Array(2*this.builder.numVerticesTotal)}bakeVertexColors(t){this.vertexAttributeColor[0]=255*t[0],this.vertexAttributeColor[1]=255*t[1],this.vertexAttributeColor[2]=255*t[2],this.vertexAttributeColor[3]=255*(t.length>3?t[3]:1)}bake(a){this.size=a;const{numVerticesTotal:l,pathVertexData:c,path:u,positions:b,profileRightAxes:v,profileUpAxes:m,profileVertexAndNormals:x}=this.builder;for(let A=0;A<l;++A){let l=c[A];const d=0===l||l===u.vertices.length-1;l*=3;const f=V;let g=0,D=0;const N=4*A,j=n(R,v[N],v[N+1],v[N+2]),E=n(w,m[N],m[N+1],m[N+2]),y=t(P,x[N]*a[0],x[N+1]*a[1]);if(d)h(f,E,j),g=v[N+3]*a[0],D=m[N+3];else{const a=I,h=C;t(a,v[N+3],m[N+3]);const l=e(a);r(a,a);const c=i(y,a);if(Math.abs(c)>l){t(h,-a[1],a[0]);const e=i(y,h);s(a,a,l*Math.sign(c)),s(h,h,e),o(y,a,h)}n(f,0,0,0)}const T=n(O,j[0]*y[0]+E[0]*y[1],j[1]*y[0]+E[1]*y[1],j[2]*y[0]+E[2]*y[1]),L=3*A;this.vertexAttributePosition[L]=b[l]+T[0]+f[0]*g,this.vertexAttributePosition[L+1]=b[l+1]+T[1]+f[1]*g,this.vertexAttributePosition[L+2]=b[l+2]+T[2]+f[2]*g;const M=t(P,x[N+2],x[N+3]);p(this.vertexAttributeNormal,A,j[0]*M[0]+E[0]*M[1]+f[0]*D,j[1]*M[0]+E[1]*M[1]+f[1]*D,j[2]*M[0]+E[2]*M[1]+f[2]*D)}}createGeometryData(){const t=this.builder.vertexIndices.length,{normalIndices:e,vertexIndices:r}=this.builder;return[[A.POSITION,new v(this.vertexAttributePosition,r,3,!0)],[A.NORMALCOMPRESSED,new v(this.vertexAttributeNormal,e,2,!0)],[A.COLOR,new v(this.vertexAttributeColor,b(t),4)]]}onPathChanged(t){super.onPathChanged(t),this.bake(this.size)}intersect(t,e,r,i){const s=this.builder.vertexIndices,o=new m(this.vertexAttributePosition,3),a=s.length/3;x(t,e,0,a,s,o,void 0,r,((t,e,r)=>i(t,r,e,!1)))}}class g extends d{constructor(t,e,r,i){super(t),this.sizeAttributeValue=e,this.colorAttributeValue=r,this.opacityAttributeValue=i,this.vvData=null,this.baked=new f(t),this.vvData=u(4*this.builder.path.vertices.length);for(let s=0;s<this.builder.path.vertices.length;++s){this.vvData[4*s]=e,this.vvData[4*s+1]=r,this.vvData[4*s+2]=i;const t=0===s||s===this.builder.path.vertices.length-1;this.vvData[4*s+3]=t?1:0}}createGeometryData(){const{positions:t,profileRightAxes:e,profileUpAxes:r,profileVertexAndNormals:i,pathVertexIndices:s,vertexIndices:o}=this.builder;return[[A.POSITION,new v(t,s,3,!0)],[A.PROFILERIGHT,new v(e,o,4,!0)],[A.PROFILEUP,new v(r,o,4,!0)],[A.PROFILEVERTEXANDNORMAL,new v(i,o,4,!0)],[A.FEATUREVALUE,new v(this.vvData,s,4,!0)]]}onPathChanged(t){super.onPathChanged(t);const e=t.getMutableAttribute(A.POSITION);e&&(e.data=this.builder.positions)}}const P=a(),I=a(),C=a(),O=l(),V=l(),R=l(),w=l();export{g as FastUpdatePathGeometry,d as PathGeometryData,f as StaticPathGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{estimateSize as t}from\"../../../../core/typedArrayUtil.js\";import{fromValues as e,clone as s}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{pathNumCircleProfileSubdivisions as r}from\"../../layers/graphics/Graphics3DPathSymbolLayerConstants.js\";class o{constructor(){this.vertices=new Array,this.normals=new Array,this.indices=new Array,this.poles=new Array,this.poleIndices=new Array}addVertex(t,e){return this.vertices.push(s(t)),this.normals.push(s(e)),this.vertices.length-1}addPole(t,e=null){return this.poles.push({position:s(t),normal:e?s(e):null}),this.poles.length-1}addSegment(t,e=null){this.indices.push(t.v0),this.indices.push(t.v1),e&&(this.poleIndices.push(e.v0),this.poleIndices.push(e.v1))}get numSegments(){return this.indices.length/2}translate(t,e){for(const s of this.vertices)s[0]+=t,s[1]+=e;for(const s of this.poles)s.position[0]+=t,s.position[1]+=e}get usedMemory(){return this.vertices.length*t(this.vertices[0])*2+t(this.indices)}}const n={top:[0,-.5],bottom:[0,.5]};function i(t){const s=.5,i=r,d=new o,a={v0:0,v1:0};d.addPole(e(0,0));for(let r=0;r<i;++r){const t=2*r*Math.PI/i,o=Math.cos(t),n=Math.sin(t),a=e(o*s,n*s),c=e(o,n);d.addVertex(a,c)}for(let e=0;e<i-1;++e){const t={v0:e,v1:e+1};d.addSegment(t,a)}const c={v0:i-1,v1:0};if(d.addSegment(c,a),\"center\"!==t){const e=n[t];d.translate(e[0],e[1])}return d}const d={center:i(\"center\"),top:i(\"top\"),bottom:i(\"bottom\")},a={center:c(\"center\"),top:c(\"top\"),bottom:c(\"bottom\")};function c(t){const s=1,r=1,i=new o,d=e(.5*-s,.5*-r),a=e(.5*s,.5*-r),c=e(.5*s,.5*r),h=e(.5*-s,.5*r),l=e(0,-1),v=e(1,0),p=e(0,1),m=e(-1,0);if(i.addPole(e(0,.5*r),p),i.addPole(e(0,.5*r)),i.addPole(e(0,.5*-r)),i.addPole(e(0,.5*-r),l),i.addVertex(d,l),i.addVertex(a,l),i.addSegment({v0:0,v1:1},{v0:3,v1:3}),i.addVertex(a,v),i.addVertex(c,v),i.addSegment({v0:2,v1:3},{v0:2,v1:1}),i.addVertex(c,p),i.addVertex(h,p),i.addSegment({v0:4,v1:5},{v0:0,v1:0}),i.addVertex(h,m),i.addVertex(d,m),i.addSegment({v0:6,v1:7},{v0:1,v1:2}),\"center\"!==t){const e=n[t];i.translate(e[0],e[1])}return i}export{o as PathProfile,d as circleProfiles,a as quadProfiles};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{acosClamped as t,reciprocalClamped as i}from\"../../../../core/mathUtils.js\";import{set as r}from\"../../../../core/libs/gl-matrix-2/math/mat2.js\";import{create as s}from\"../../../../core/libs/gl-matrix-2/factories/mat2f64.js\";import{set as e,transformMat2 as a}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{UNIT_X as h,create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{c as n,g as m,n as g,h as f,f as c,d as u,e as l,v as p}from\"../../../../chunks/vec32.js\";import{create as v}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{Frame2D as M}from\"./PathExtruder.js\";import{UpVectorAlignment as b}from\"./PathGeometry.js\";class R{constructor(){this.vLeft=v(),this.vRight=v(),this.vMinSiblingLength=0,this.frame=new M}setFrameFromUpVector(t){n(this.frame.up,t),m(D,this.vLeft,this.vRight),g(D,D),f(I,this.frame.up,c(D,this.frame.up)),u(k,D,I),g(k,k),l(this.frame.right,k,this.frame.up)}get foldingAngle(){return Math.PI-this.rotationAngle}}class x extends R{get rotationFrameUp(){return this.frame.up}get rotationRight(){return h}get rotationAngle(){f(w,this.frame.up,c(this.frame.up,this.vLeft)),u(w,this.vLeft,w),p(w,w),g(w,w),f(y,this.frame.up,c(this.frame.up,this.vRight)),u(y,this.vRight,y),g(y,y),l(U,this.rotationFrameUp,this.vLeft);return Math.sign(c(U,this.vRight))*(Math.PI-t(c(w,y)))}get maxStretchDistance(){return Math.abs(this.vMinSiblingLength/Math.cos(.5*this.foldingAngle))}applyMiterStretch(t,r){const s=this.rotationAngle;if(Math.abs(s)<=0)return r;const a=i(Math.cos(.5*s));return e(t,(a-1+1)*r[0],r[1])}}class L extends R{get rotationFrameUp(){const t=Math.sign(c(this.frame.right,this.vRight));return l(A,this.vRight,this.vLeft),f(A,A,t),g(A,A)}get rotationRight(){const t=this.rotationFrameUp,i=c(t,this.frame.up),r=c(t,this.frame.right);return f(F,this.frame.up,-r),f(P,this.frame.right,i),m(F,F,P),g(F,F),j(S,this.frame,F),S}get rotationAngle(){const i=Math.sign(c(this.frame.right,this.vRight));return p(U,this.vLeft),-i*(Math.PI-t(c(U,this.vRight)))}get maxStretchDistance(){return Math.abs(this.vMinSiblingLength*i(Math.cos(.5*this.foldingAngle)))}applyMiterStretch(t,s){const e=this.rotationAngle;if(0===Math.abs(e))return s;const h=i(Math.cos(.5*e)),o=this.rotationRight,n=r(E,1+(h-1)*o[0]*o[0],(h-1)*o[0]*o[1],(h-1)*o[0]*o[1],1+(h-1)*o[1]*o[1]);return a(t,s,n)}}function j(t,i,r){e(t,c(r,i.right),c(r,i.up))}function d(t){switch(t){case b.World:return new x;case b.Path:return new L}}const A=v(),S=o(),F=v(),P=v(),U=v(),w=v(),y=v(),I=v(),D=v(),k=v(),E=s();export{R as PathVertex,d as newPathVertex};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Milliseconds as r}from\"../../../../core/time.js\";import e from\"../../webgl/RenderCamera.js\";import{ShaderOutput as t}from\"../core/shaderLibrary/ShaderOutput.js\";import{BindParameters as s}from\"./BindParameters.js\";import{RenderOccludedFlag as i}from\"./Material.js\";class a{constructor(r,i){this.rctx=r,this.lastFrameCamera=new e,this.output=t.Color,this.renderOccludedMask=o,this.bind=new s(i),this.bind.alignPixelEnabled=!0}}class n extends a{constructor(e,t,s){super(e,t),this.techniques=s,this.time=r(0)}}const o=i.Occlude|i.OccludeAndTransparent|i.OccludeAndTransparentStencil;export{a as OverlayRenderContext,n as RenderContext,o as defaultRenderOccludedMask};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{generateUID as t}from\"../../../../core/uid.js\";import{copy as r,multiply as i}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as e}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{t as s}from\"../../../../chunks/vec32.js\";import{N as o,c as n,a as h}from\"../../../../chunks/sphere.js\";import{maxScale as a}from\"../../support/mathUtils.js\";class g{constructor(r,i={}){this.geometry=r,this.screenToWorldRatio=1,this._transformation=e(),this._shaderTransformation=null,this._boundingSphere=null,this.id=t(),this.layerUid=i.layerUid,this.graphicUid=i.graphicUid,this.castShadow=i.castShadow??!1,i.objectShaderTransformation&&this.objectShaderTransformationChanged(i.objectShaderTransformation)}get transformation(){return this._transformation}set transformation(t){r(this._transformation,t),this._boundingSphere=null}get boundingInfo(){return this.geometry.boundingInfo}objectShaderTransformationChanged(t){null==t?this._shaderTransformation=null:(this._shaderTransformation??=e(),i(this._shaderTransformation,t,this.geometry.transformation)),this._boundingSphere=null}get boundingSphere(){return this.boundingInfo?(null==this._boundingSphere&&(this._boundingSphere??=n(),s(h(this._boundingSphere),this.boundingInfo.center,this.shaderTransformation),this._boundingSphere[3]=this.boundingInfo.radius*a(this.shaderTransformation)),this._boundingSphere):o}get material(){return this.geometry.material}get type(){return this.geometry.type}get shaderTransformation(){return this._shaderTransformation??this.transformation}get attributes(){return this.geometry.attributes}get highlight(){return this.geometry.highlights}foreachHighlightGroup(t){this.geometry.foreachHighlightGroup(t)}get hasHighlights(){return this.geometry.hasHighlights}get occludees(){return this.geometry.occludees}get visible(){return this.geometry.visible}set visible(t){this.geometry.visible=t}}class m extends g{}export{g as RenderGeometry,m as ValidatedRenderGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport has from\"../../../../core/has.js\";import{clamp as t,lerp as s,acosClamped as e}from\"../../../../core/mathUtils.js\";import{releaseMaybe as i}from\"../../../../core/maybe.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{translate as r,multiply as h,invert as o,lookAt as n}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{IDENTITY as c,create as l}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{set as d,add as m,scale as u,lerp as _,squaredDistance as f,subtract as g,dot as p,negate as x,normalize as b,copy as w}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as M}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{p as C,c as j,v as T,t as y,i as D}from\"../../../../chunks/vec32.js\";import{create as H}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{s as v,t as S}from\"../../../../chunks/vec42.js\";import{create as R}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{ViewingMode as O}from\"../../../ViewingMode.js\";import{ColorFormat as E,DepthFormat as U}from\"../../webgl/formats.js\";import{CascadeCamera as F}from\"./CascadeCamera.js\";import{applyTextureResizeModulo as L,applyTextureResizeFloorModulo as Q}from\"./textureUtils.js\";import{assert as V,logWithBase as N,verify as A,rayRay2D as B}from\"./Util.js\";import{TextureType as I,FramebufferBit as W}from\"../../../webgl/enums.js\";import{Texture as z}from\"../../../webgl/Texture.js\";var P;!function(t){t[t.Highlight=0]=\"Highlight\",t[t.ExcludeHighlight=1]=\"ExcludeHighlight\"}(P||(P={}));class q{constructor(){this.camera=new F,this.lightMat=l()}}class G{constructor(){this.maxNumCascadesHighQuality=4,this.maxNumCascadesLowQuality=4,this.textureSizeModHighQuality=1.3,this.textureSizeModLowQuality=.9,this.splitSchemeLambda=0}}class X{constructor(t,s){this._fbos=t,this._viewingMode=s,this._enabled=!1,this._snapshots=new Array,this._textureHeight=0,this._numCascades=1,this.settings=new G,this._projectionView=l(),this._projectionViewInverse=l(),this._modelViewLight=l(),this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=R(),this._cascades=[new q,new q,new q,new q],this._lastOrigin=null,this._maxTextureWidth=Math.min(has(\"esri-mobile\")?4096:16384,t.rctx.parameters.maxTextureSize)}dispose(){this.enabled=!1,this.disposeOffscreenBuffers()}get depthTexture(){return this._handle?.getTexture()}get _textureWidth(){return this._textureHeight*this._numCascades}get numCascades(){return this._numCascades}get cascadeDistances(){return v(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}disposeOffscreenBuffers(){this._handle=i(this._handle),this._discardSnapshots()}set maxCascades(s){this.settings.maxNumCascadesHighQuality=t(Math.floor(s),1,4)}get maxCascades(){return this.settings.maxNumCascadesHighQuality}set enabled(t){this._enabled=t,t||this.disposeOffscreenBuffers()}get enabled(){return this._enabled}get ready(){return this._enabled&&null!=this.depthTexture}get cascades(){for(let t=0;t<this._numCascades;++t)it[t]=this._cascades[t];return it.length=this._numCascades,it}start(t,s,e,i,a){V(this.enabled);const{near:r,far:h}=Tt(e);this._computeCascadeDistances(r,h,i),this._textureHeight=this._computeTextureHeight(t,a,i),this._setupMatrices(t,s);const{viewMatrix:o,projectionMatrix:n}=t;for(let c=0;c<this._numCascades;++c)this._constructCascade(c,n,o,s);this._lastOrigin=null,this.clear()}finish(){V(this.enabled),this._handle?.detachDepth()}getShadowMapMatrices(t){if(!this._lastOrigin||!C(t,this._lastOrigin)){this._lastOrigin=this._lastOrigin||H(),j(this._lastOrigin,t);for(let s=0;s<this._numCascades;++s){r(at,this._cascades[s].lightMat,t);for(let t=0;t<16;++t)rt[16*s+t]=at[t]}}return rt}moveSnapshot(t){V(this.enabled),this._handle?.detachDepth(),this._snapshots[t]?.release(),this._snapshots[t]=this._handle,this._handle=null,this.clear()}copySnapshot(t){const s=this._handle?.getTexture()?.descriptor;if(!this.enabled||!s)return;this._snapshots[t]?.release();const{width:e,height:i}=s,a=t===P.Highlight?\"shadow highlight snapshot\":\"shadow no highlight snapshot\";this._snapshots[t]=this._fbos.acquire(e,i,a,E.RGBA4);const r=this._fbos.rctx;this._bindFbo();const h=r.bindTexture(this._snapshots[t]?.getTexture(),z.TEXTURE_UNIT_FOR_UPDATES);r.gl.copyTexSubImage2D(I.TEXTURE_2D,0,0,0,0,0,e,i),r.bindTexture(h,z.TEXTURE_UNIT_FOR_UPDATES)}getSnapshot(t){return this.enabled?this._snapshots[t]?.getTexture():null}clear(){const t=this._fbos.rctx;this._ensureFbo(),this._bindFbo(),t.setClearColor(1,1,1,1),t.clear(W.COLOR|W.DEPTH)}_computeTextureHeight(t,s,e){const i=Math.min(window.devicePixelRatio,s)/t.pixelRatio,a=e?this.settings.textureSizeModHighQuality:this.settings.textureSizeModLowQuality,r=L(Math.floor(Math.max(t.fullWidth,t.fullHeight)*i*a)),h=Math.min(this._maxTextureWidth,this._numCascades*r);return Q(h/this._numCascades)}_ensureFbo(){this._handle?.fbo?.width===this._textureWidth&&this._handle?.fbo.height===this._textureHeight||(this._handle?.release(),this._handle=this._fbos.acquire(this._textureWidth,this._textureHeight,\"shadow map\",E.RGBA4)),this._handle?.acquireDepth(U.DEPTH16_BUFFER)}_discardSnapshot(t){this._snapshots[t]=i(this._snapshots[t])}_discardSnapshots(){for(let t=0;t<this._snapshots.length;++t)this._discardSnapshot(t);this._snapshots.length=0}_bindFbo(){this._fbos.rctx.bindFramebuffer(this._handle?.fbo)}_constructCascade(t,s,e,i){const a=this._cascades[t],o=-this._cascadeDistances[t],n=-this._cascadeDistances[t+1],c=(s[10]*o+s[14])/Math.abs(s[11]*o+s[15]),l=(s[10]*n+s[14])/Math.abs(s[11]*n+s[15]);V(c<l);for(let r=0;r<8;++r){v(J,r%4==0||r%4==3?-1:1,r%4==0||r%4==1?-1:1,r<4?c:l,1);const t=K[r];S(t,J,this._projectionViewInverse),t[0]/=t[3],t[1]/=t[3],t[2]/=t[3]}T(et,K[0]),a.camera.viewMatrix=r(k,this._modelViewLight,et);for(let r=0;r<8;++r)y(K[r],K[r],a.camera.viewMatrix);let d=K[0][2],m=K[0][2];for(let r=1;r<8;++r)d=Math.min(d,K[r][2]),m=Math.max(m,K[r][2]);d-=200,m+=200,a.camera.near=-m,a.camera.far=-d,jt(e,i,d,m,a.camera),h(a.lightMat,a.camera.projectionMatrix,a.camera.viewMatrix);const u=this._textureHeight;a.camera.viewport=[t*u,0,u,u]}_setupMatrices(t,s){h(this._projectionView,t.projectionMatrix,t.viewMatrix),o(this._projectionViewInverse,this._projectionView);const e=this._viewingMode===O.Global?t.eye:D(et,0,0,1);n(this._modelViewLight,[0,0,0],[-s[0],-s[1],-s[2]],e)}_computeCascadeDistances(t,e,i){const a=i?this.settings.maxNumCascadesHighQuality:this.settings.maxNumCascadesLowQuality;this._numCascades=Math.min(1+Math.floor(N(e/t,4)),a);const r=(e-t)/this._numCascades,h=(e/t)**(1/this._numCascades);let o=t,n=t;for(let c=0;c<this._numCascades+1;++c)this._cascadeDistances[c]=s(o,n,this.settings.splitSchemeLambda),o*=h,n+=r}get test(){}}const k=l(),J=R(),K=[];for(let yt=0;yt<8;++yt)K.push(R());const Y=M(),Z=M(),$=M(),tt=M(),st=M(),et=H(),it=[],at=l(),rt=c.concat(c,c,c,c),ht=M(),ot=M(),nt=[M(),M(),M(),M()],ct=M(),lt=M(),dt=M(),mt=M(),ut=M(),_t=M(),ft=M();function gt(t,s,e,i,a,r,h,o){d(ht,0,0);for(let d=0;d<4;++d)m(ht,ht,t[d]);u(ht,ht,.25),d(ot,0,0);for(let d=4;d<8;++d)m(ot,ot,t[d]);u(ot,ot,.25),_(nt[0],t[4],t[5],.5),_(nt[1],t[5],t[6],.5),_(nt[2],t[6],t[7],.5),_(nt[3],t[7],t[4],.5);let n=0,c=f(nt[0],ht);for(let d=1;d<4;++d){const t=f(nt[d],ht);t<c&&(c=t,n=d)}g(ct,nt[n],t[n+4]);const l=ct[0];let M,C;ct[0]=-ct[1],ct[1]=l,g(lt,ot,ht),p(lt,ct)<0&&x(ct,ct),_(ct,ct,lt,e),b(ct,ct),M=C=p(g(dt,t[0],ht),ct);for(let d=1;d<8;++d){const s=p(g(dt,t[d],ht),ct);s<M?M=s:s>C&&(C=s)}w(i,ht),u(dt,ct,M-s),m(i,i,dt);let j=-1,T=1,y=0,D=0;for(let d=0;d<8;++d){g(mt,t[d],i),b(mt,mt);const s=ct[0]*mt[1]-ct[1]*mt[0];s>0?s>j&&(j=s,y=d):s<T&&(T=s,D=d)}A(j>0,\"leftArea\"),A(T<0,\"rightArea\"),u(ut,ct,M),m(ut,ut,ht),u(_t,ct,C),m(_t,_t,ht),ft[0]=-ct[1],ft[1]=ct[0];const H=B(i,t[D],_t,m(dt,_t,ft),1,a),v=B(i,t[y],_t,dt,1,r),S=B(i,t[y],ut,m(dt,ut,ft),1,h),R=B(i,t[D],ut,dt,1,o);A(H,\"rayRay\"),A(v,\"rayRay\"),A(S,\"rayRay\"),A(R,\"rayRay\")}function pt(t,s){return 3*s+t}const xt=M();function bt(t,s){return d(xt,t[s],t[s+3]),xt}const wt=M(),Mt=a();function Ct(t,s,e,i,a){g(wt,e,i),u(wt,wt,.5),Mt[0]=wt[0],Mt[1]=wt[1],Mt[2]=0,Mt[3]=wt[1],Mt[4]=-wt[0],Mt[5]=0,Mt[6]=wt[0]*wt[0]+wt[1]*wt[1],Mt[7]=wt[0]*wt[1]-wt[1]*wt[0],Mt[8]=1,Mt[pt(0,2)]=-p(bt(Mt,0),t),Mt[pt(1,2)]=-p(bt(Mt,1),t);let r=p(bt(Mt,0),e)+Mt[pt(0,2)],h=p(bt(Mt,1),e)+Mt[pt(1,2)],o=p(bt(Mt,0),i)+Mt[pt(0,2)],n=p(bt(Mt,1),i)+Mt[pt(1,2)];r=-(r+o)/(h+n),Mt[pt(0,0)]+=Mt[pt(1,0)]*r,Mt[pt(0,1)]+=Mt[pt(1,1)]*r,Mt[pt(0,2)]+=Mt[pt(1,2)]*r,r=1/(p(bt(Mt,0),e)+Mt[pt(0,2)]),h=1/(p(bt(Mt,1),e)+Mt[pt(1,2)]),Mt[pt(0,0)]*=r,Mt[pt(0,1)]*=r,Mt[pt(0,2)]*=r,Mt[pt(1,0)]*=h,Mt[pt(1,1)]*=h,Mt[pt(1,2)]*=h,Mt[pt(2,0)]=Mt[pt(1,0)],Mt[pt(2,1)]=Mt[pt(1,1)],Mt[pt(2,2)]=Mt[pt(1,2)],Mt[pt(1,2)]+=1,r=p(bt(Mt,1),s)+Mt[pt(1,2)],h=p(bt(Mt,2),s)+Mt[pt(2,2)],o=p(bt(Mt,1),e)+Mt[pt(1,2)],n=p(bt(Mt,2),e)+Mt[pt(2,2)],r=-.5*(r/h+o/n),Mt[pt(1,0)]+=Mt[pt(2,0)]*r,Mt[pt(1,1)]+=Mt[pt(2,1)]*r,Mt[pt(1,2)]+=Mt[pt(2,2)]*r,r=p(bt(Mt,1),s)+Mt[pt(1,2)],h=p(bt(Mt,2),s)+Mt[pt(2,2)],o=-h/r,Mt[pt(1,0)]*=o,Mt[pt(1,1)]*=o,Mt[pt(1,2)]*=o,a[0]=Mt[0],a[1]=Mt[1],a[2]=0,a[3]=Mt[2],a[4]=Mt[3],a[5]=Mt[4],a[6]=0,a[7]=Mt[5],a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=Mt[6],a[13]=Mt[7],a[14]=0,a[15]=Mt[8]}function jt(t,s,i,a,r){const h=1/K[0][3],o=1/K[4][3];V(h<o);let n=h+Math.sqrt(h*o);const c=Math.sin(e(t[2]*s[0]+t[6]*s[1]+t[10]*s[2]));n/=c,gt(K,n,c,Y,Z,$,tt,st),Ct(Y,Z,tt,st,r.projectionMatrix),r.projectionMatrix[10]=2/(i-a),r.projectionMatrix[14]=-(i+a)/(i-a)}function Tt(t){let{near:s,far:e}=t;return s<2&&(s=2),e<2&&(e=2),s>=e&&(s=2,e=4),{near:s,far:e}}export{X as ShadowMap,P as SnapshotSlot};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import\"../../../../core/has.js\";import{someMap as t}from\"../../../../core/MapUtils.js\";import s from\"../../../../core/PooledArray.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{create as o}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{a}from\"../../../../chunks/sphere.js\";import{OverlayTarget as d}from\"../../terrain/Intersector.js\";import{ShaderOutput as h}from\"../core/shaderLibrary/ShaderOutput.js\";import{releaseTechniques as l}from\"../effects/RenderPlugin.js\";import{ChangeSet as c}from\"./ChangeSet.js\";import{newIntersectorResult as p}from\"./Intersector.js\";import{StoreResults as m,IntersectorType as u}from\"./IntersectorInterfaces.js\";import{RenderOccludedFlag as g}from\"./Material.js\";import{DirtyOperation as _,DirtyState as y}from\"./ModelDirtyTypes.js\";import{splitRenderGeometryChangeSetByMaterial as f}from\"./rendererUtils.js\";import{RenderSlot as R}from\"./RenderSlot.js\";import{MergedRenderer as G}from\"../materials/renderers/MergedRenderer.js\";let v=class extends r{constructor(e){super(e),this._pending=new C,this._changes=new c,this._renderers=new Map,this._sortedRenderers=new s,this._geometries=new Map,this._hasHighlights=!1,this._hasWater=!1}destroy(){this._changes.prune(),this._renderers.forEach((e=>e.destroy())),this._renderers.clear(),this._sortedRenderers.clear(),this._geometries.clear(),this._pending.clear()}get updating(){return!this._pending.empty||this._changes.updates.length>0}get rctx(){return this.rendererContext.rctx}get _materials(){return this.rendererContext.materials}get _localOriginFactory(){return this.rendererContext.localOriginFactory}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccludedDraped(){for(const e of this._renderers.values())if(0!==e.numGeometries&&!e.queryRenderOccludedState(g.Occlude))return!0;return!1}get isEmpty(){return!this.updating&&0===this._renderers.size&&0===this._geometries.size}getMaterialRenderer(e){return this._renderers.get(e)}get sortedRenderers(){return this._sortedRenderers}commitChanges(){if(!this.updating)return!1;this._processAddsRemoves();const e=f(this._changes);let r=!1;return e.forEach(((e,t)=>{let s=this._renderers.get(t);!s&&e.adds.length>0&&(s=new G({material:t}),s.initializeRenderContext(this.rendererContext.pluginContext,this._materials),this._renderers.set(t,s),r=!0),s&&(s.modify(e),0===s.numGeometries&&(this._renderers.delete(t),s.destroy(),r=!0))})),this._changes.clear(),r&&this._updateSortedMaterialRenderers(),this._hasHighlights=t(this._renderers,(e=>{const r=e.produces.get(R.DRAPED_MATERIAL);return!!r&&r(h.Highlight)})),this._hasWater=t(this._renderers,(e=>{const r=e.produces.get(R.DRAPED_WATER);return!!r&&r(h.Normal)})),this.notifyChange(\"updating\"),!0}addGeometries(e,r){if(0===e.length)return;const t=this._validateRenderGeometries(e);for(const i of t)this._geometries.set(i.id,i);const s=this._pending.empty;for(const i of t)this._pending.adds.add(i);s&&this.notifyChange(\"updating\"),r===_.UPDATE&&this._notifyGraphicGeometryChanged(e)}removeGeometries(e,r){const t=this._pending.empty,s=this._pending.adds;for(const i of e)s.has(i)?(this._pending.removed.add(i),s.delete(i)):this._pending.removed.has(i)||this._pending.removes.add(i),this._geometries.delete(i.id);t&&!this._pending.empty&&this.notifyChange(\"updating\"),r===_.UPDATE&&this._notifyGraphicGeometryChanged(e)}modifyGeometries(e,r){const t=0===this._changes.updates.length;for(const s of e){const e=this._changes.updates.pushNew();e.renderGeometry=this._validateRenderGeometry(s),e.updateType=r}switch(t&&this._changes.updates.length>0&&this.notifyChange(\"updating\"),r){case y.TRANSFORMATION:case y.GEOMETRY:return this._notifyGraphicGeometryChanged(e);case y.VISIBILITY:return this._notifyGraphicVisibilityChanged(e)}}updateAnimation(e){let r=!1;return this._sortedRenderers.forAll((t=>r=!!t.updateAnimation&&t.updateAnimation(e)||r)),r}precompile(e){return this._sortedRenderers.reduce(((r,t)=>t.precompile(e)||r),!1)}render(e){this._sortedRenderers.forAll((r=>{const t=r.acquireTechniques(e);t&&(r.render(e,t),l(t))}))}intersect(e,r,t,s,i){for(const n of this._geometries.values()){if(!s(n))continue;this._intersectRenderGeometry(n,t,r,0,e,i);const o=this.rendererContext.longitudeCyclical;o&&(n.boundingSphere[0]-n.boundingSphere[3]<o.min&&this._intersectRenderGeometry(n,t,r,o.range,e,i),n.boundingSphere[0]+n.boundingSphere[3]>o.max&&this._intersectRenderGeometry(n,t,r,-o.range,e,i)),i++}return i}_updateSortedMaterialRenderers(){this._sortedRenderers.clear();let e=0;for(const r of this._renderers.values())r.drapedPriority=e++,this._sortedRenderers.push(r);this._sortedRenderers.sort(((e,r)=>r.material?.renderPriority===e.material?.renderPriority?e.drapedPriority-r.drapedPriority:(r.material?.renderPriority||0)-(e.material?.renderPriority||0)))}_processAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes)),this._changes.updates.filterInPlace((({renderGeometry:e})=>!this._pending.has(e))),this._pending.clear()}_intersectRenderGeometry(e,r,t,s,i,n){if(!e.visible||!e.material.visible)return;let o=0;s+=e.transformation[12],o=e.transformation[13],S[0]=t[0]-s,S[1]=t[1]-o,e.screenToWorldRatio=this.rendererContext.screenToWorldRatio,e.material.intersectDraped(e,null,i,S,((t,s,o)=>{A(r,o,n,e.material.renderPriority,i,e.layerUid,e.graphicUid)}),r)}_notifyGraphicGeometryChanged(e){if(null==this.drapeSource.notifyGraphicGeometryChanged)return;let r;for(const{graphicUid:t}of e)null!=t&&t!==r&&(this.drapeSource.notifyGraphicGeometryChanged(t),r=t)}_notifyGraphicVisibilityChanged(e){if(null==this.drapeSource.notifyGraphicVisibilityChanged)return;let r;for(const{graphicUid:t}of e)null!=t&&t!==r&&(this.drapeSource.notifyGraphicVisibilityChanged(t),r=t)}_validateRenderGeometries(e){for(const r of e)this._validateRenderGeometry(r);return e}_validateRenderGeometry(e){return null==e.localOrigin&&(e.localOrigin=this._localOriginFactory.getOrigin(a(e.boundingSphere))),e}get test(){}};e([i()],v.prototype,\"drapeSource\",void 0),e([i()],v.prototype,\"updating\",null),e([i()],v.prototype,\"rctx\",null),e([i({constructOnly:!0})],v.prototype,\"rendererContext\",void 0),e([i()],v.prototype,\"_materials\",null),e([i()],v.prototype,\"_localOriginFactory\",null),e([i({readOnly:!0})],v.prototype,\"isEmpty\",null),e([i()],v.prototype,\"_renderers\",void 0),e([i()],v.prototype,\"_geometries\",void 0),v=e([n(\"esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer\")],v);class C{constructor(){this.adds=new Set,this.removes=new Set,this.removed=new Set}get empty(){return 0===this.adds.size&&0===this.removes.size&&0===this.removed.size}has(e){return this.adds.has(e)||this.removes.has(e)||this.removed.has(e)}clear(){this.adds.clear(),this.removes.clear(),this.removed.clear()}}function A(e,r,t,s,i,n,o){const a=new d(n,o,r),h=r=>{r.set(u.OVERLAY,a,e.dist,e.normal,e.transformation,t,s)};if((null==i.results.min.drapedLayerOrder||t>=i.results.min.drapedLayerOrder)&&(null==i.results.min.dist||i.results.ground.dist<=i.results.min.dist)&&h(i.results.min),i.options.store!==m.MIN&&(null==i.results.max.drapedLayerOrder||t<i.results.max.drapedLayerOrder)&&(null==i.results.max.dist||i.results.ground.dist>i.results.max.dist)&&h(i.results.max),i.options.store===m.ALL){const e=p(i.ray);h(e),i.results.all.push(e)}}const S=o();export{v as SortedRenderGeometryRenderer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction a(a,n,c){return a.canvas||(a.canvas=document.createElement(\"canvas\")),a.canvas.width=n,a.canvas.height=c,a.canvas}export{a as getTextHelperCanvas};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport o from\"../../../../Color.js\";import{isCachedFontFace as t,loadFont as e}from\"../../../../core/fontUtils.js\";import i from\"../../../../core/Logger.js\";import{pt2px as r}from\"../../../../core/screenUtils.js\";import{ZEROS as n}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";class s{constructor(o){this.definition=o,this.key=JSON.stringify(o),this.haloSize=Math.round(o.halo.size),this.textStyle=a(o.color),this.haloStyle=l(o.halo.color),this.backgroundStyle=0!==o.background.color[3]?a(o.background.color):null}fontString(o){const t=this.definition.font,e=\"sans-serif, Apple Color Emoji, Segoe UI Emoji, Segoe UI Symbol, Noto Color Emoji\";return`${t.style} ${t.weight} ${o}px ${t.family}, ${e}`}setFontProperties(o,t){o.font=this.fontString(t),o.textAlign=\"left\",o.textBaseline=\"alphabetic\"}static async fromSymbol(l,a){const f=l?.material?.color,m=o.toUnitRGBA(f)??n,g=null!=l.size?r(l.size):12,u=l.lineHeight,d=null!=l.background?o.toUnitRGBA(l.background.color):n,h={family:l.font?.family??\"sans-serif\",decoration:l.font?.decoration??\"none\",weight:l.font?.weight??\"normal\",style:l.font?.style??\"normal\"},y=l.halo,b=null!=y?.color&&y.size>0?{size:r(y.size),color:o.toUnitRGBA(y.color)}:{size:0,color:n},p=new s({color:m,size:g,background:{color:d,padding:null!=l.background?[.65*g,.5*g]:[0,0],borderRadius:null!=l.background?g*(6/16):0},lineSpacingFactor:u,font:h,halo:b,pixelRatio:a});if(l.font){let o=!1;const r=p.fontString(g);try{o=(await document.fonts.load(r)).some((o=>!t(o)))}catch(S){i.getLogger(\"esri.views.3d.webgl-engine.lib.TextRenderParameters\").warnOnce(`Failed to preload font '${r}'. Some text symbology may be rendered using the default browser font.`)}if(!o&&!c.has(l.font.family))try{await e(l.font)}catch(S){}}return p}}function l(o){return`rgb(${o.slice(0,3).map((o=>Math.floor(255*o))).toString()})`}function a(o){return`rgba(${o.slice(0,3).map((o=>Math.floor(255*o))).toString()},${o[3]})`}const c=new Set([\"Arial\",\"Times New Roman\",\"Courier New\",\"serif\",\"sans-serif\",\"monospace\",\"cursive\",\"fantasy\",\"system-ui\",\"ui-serif\",\"ui-sans-serif\",\"ui-monospace\",\"ui-rounded\",\"math\",\"emoji\",\"fangsong\"]);export{s as TextRenderParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../../../core/mathUtils.js\";import{debugFlags as e}from\"../../support/debugFlags.js\";import{getFontMetrics as i}from\"./FontMetrics.js\";import{getTextHelperCanvas as n}from\"./TextHelperCanvas.js\";const s=1;class r{constructor(t,e,i,n){this.text=t,this._alignment=e,this._parameters=i,this._maxSize=n,this._textWidths=[],this._lineWidths=[],this._renderPixelRatio=null,this._metricsCached=null,this.key=`${t}--${this._parameters.key}-${this._alignment}`,this._lines=t.replaceAll(\" \",\" \").split(/\\r?\\n/)}get displayWidth(){return Math.ceil(this._displayWidth+2*this._horizontalPadding)}get displayHeight(){let t=this._metrics.firstLineAscent;for(let e=0;e<this._lines.length-1;e++)t+=this._lineSpacing;return t+=this._metrics.lastLineDescent,Math.ceil(t+2*this._haloSize+2*this._verticalPadding)}get renderedWidth(){return this._toRoundedRenderUnit(this.displayWidth)}get renderedHeight(){return this._toRoundedRenderUnit(this.displayHeight)}get firstRenderedBaselinePosition(){return this._toRenderUnit(this._firstLineYOffset+this._metrics.firstLineAscent)}get _firstLineYOffset(){return this._verticalPadding+this._haloSize}get _metrics(){if(null==this._metricsCached){const t=n(a,l,l).getContext(\"2d\"),e=this._parameters.definition.pixelRatio,s=this._fontSize*e;this._parameters.setFontProperties(t,s);let r=2*this._haloSize;const h=this._parameters.definition.font;\"italic\"!==h.style&&\"oblique\"!==h.style&&\"bold\"!==h.weight&&\"bolder\"!==h.weight||(r+=.3*t.measureText(\"A\").width),this._textWidths.length=0,this._lineWidths.length=0;let o=0,d=0,_=0,g=0,m=0;this._lines.forEach(((i,n)=>{const s=t.measureText(i),h=s.width/e,a=h+r;this._textWidths.push(h),this._lineWidths.push(a),o=Math.max(o,a),g=Math.max(g,s.actualBoundingBoxAscent/e),m=Math.max(m,s.actualBoundingBoxDescent/e),0===n&&(d=s.actualBoundingBoxAscent/e),n===this._lines.length-1&&(_=s.actualBoundingBoxDescent/e)}));const f=i(this._parameters),u=Math.max(g,f.maxAscent),p=Math.max(m,f.maxDescent),x=d,R=\"underline\"===this._parameters.definition.font.decoration?p:_,S=o;this._metricsCached=new c(x,R,u,p,S)}return this._metricsCached}get _lineSpacing(){return(this._midLineHeight+this._linePadding)*this._parameters.definition.lineSpacingFactor}get _midLineHeight(){return this._metrics.midLineHeight}get _linePadding(){return this._midLineHeight*d}get _midLineAscent(){return this._metrics.maxLineAscent}get _renderedFontSize(){return this._toRenderUnit(this._fontSize)}get _fontSize(){return this._parameters.definition.size}get _renderedHaloSize(){return this._toRenderUnit(this._haloSize)}get _haloSize(){return this._parameters.haloSize}get _horizontalPadding(){return this._hasBackground?this._parameters.definition.background.padding[0]:0}get _verticalPadding(){return Math.max(this._hasBackground?this._parameters.definition.background.padding[1]:0,s)}get _hasBackground(){return!!this._parameters.backgroundStyle}get renderPixelRatio(){if(null==this._renderPixelRatio){const t=this._parameters.definition.pixelRatio;this._renderPixelRatio=Math.min(t,Math.min(this._maxSize[0]/this.displayWidth,this._maxSize[1]/this.displayHeight))}return this._renderPixelRatio}_getLineXOffset(t){switch(this._alignment){case o.Left:return this._horizontalPadding;case o.Center:return(this.displayWidth-this._lineWidths[t])/2;case o.Right:return this.displayWidth-this._horizontalPadding-this._lineWidths[t]}}render(t,i,n){t.save();const s=i/=this.renderPixelRatio,r=n/=this.renderPixelRatio,h=this._haloSize,o=this._firstLineYOffset+this._metrics.firstLineAscent;i+=h,n+=o;const a=this._haloSize>0;a&&this._renderHalo(t,s,r,h,o),this._parameters.setFontProperties(t,this._renderedFontSize);for(let e=0;e<this._lines.length;++e){const s=this._lines[e],r=this._getLineXOffset(e);a&&(t.globalCompositeOperation=\"destination-out\",t.fillStyle=\"rgb(0, 0, 0)\",this._fillText(t,s,i+r,n),this._renderLineDecoration(t,i+r,n,this._textWidths[e])),t.globalCompositeOperation=\"source-over\",t.fillStyle=this._parameters.textStyle,this._fillText(t,s,i+this._getLineXOffset(e),n),this._renderLineDecoration(t,i+r,n,this._textWidths[e]),n+=this._lineSpacing}if(e.TEXT_SHOW_BASELINE){t.strokeStyle=_,t.setLineDash([2,2]),t.lineWidth=1;let e=r+o;for(let i=0;i<this._lines.length;++i)this._drawLine(t,[s,e],[s+this.displayWidth,e]),e+=this._lineSpacing}if(e.TEXT_SHOW_BORDER&&(t.strokeStyle=_,t.setLineDash([]),t.lineWidth=1,this._drawBox(t,[s,r],[this.displayWidth,this.displayHeight])),this._hasBackground){const e=this._parameters.definition.background.borderRadius*this.renderPixelRatio;this._roundedRect(t,s,r,e),t.globalCompositeOperation=\"destination-over\",t.fillStyle=this._parameters.backgroundStyle,t.fill()}t.restore()}_renderLineDecoration(t,e,i,n,s=!1){if(\"none\"===this._parameters.definition.font.decoration||0===n)return;const r=1,h=Math.max(this._parameters.definition.size/16,r);switch(this._parameters.definition.font.decoration){case\"underline\":i+=2*h;break;case\"line-through\":i-=.33*this._midLineAscent}const o=s?this._haloSize:0;t.strokeStyle=s?this._parameters.haloStyle:this._parameters.textStyle,t.lineWidth=this._toRenderUnit(h+2*o),t.beginPath(),t.moveTo(this._toRenderUnit(e-o),this._toRenderUnit(i)),t.lineTo(this._toRenderUnit(e+n+o),this._toRenderUnit(i)),t.stroke()}_roundedRect(e,i,n,s){i=this._toRenderUnit(i),n=this._toRenderUnit(n);const r=this.renderedWidth,h=this.renderedHeight;0!==s?(s=t(s,0,Math.floor(h/2)),e.beginPath(),e.moveTo(i,n+s),e.arcTo(i,n,i+s,n,s),e.lineTo(i+r-s,n),e.arcTo(i+r,n,i+r,n+s,s),e.lineTo(i+r,n+h-s),e.arcTo(i+r,n+h,i+r-s,n+h,s),e.lineTo(i+s,n+h),e.arcTo(i,n+h,i,n+h-s,s),e.closePath()):e.rect(i,n,r,h)}_renderHalo(t,e,i,s,r){const h=this.renderedWidth,o=this.renderedHeight,d=n(a,Math.max(h,l),Math.max(o,l)),_=d.getContext(\"2d\");_.clearRect(0,0,h,o),this._parameters.setFontProperties(_,this._renderedFontSize),_.fillStyle=this._parameters.haloStyle,_.strokeStyle=this._parameters.haloStyle;const c=this._renderedHaloSize<3;_.lineJoin=c?\"miter\":\"round\",c?this._renderHaloEmulated(_,s,r):this._renderHaloNative(_,s,r);let g=r;for(let n=0;n<this._lines.length;++n){const t=this._getLineXOffset(n);this._renderLineDecoration(_,s+t,g,this._textWidths[n],!0),g+=this._lineSpacing}t.globalAlpha=this._parameters.definition.halo.color[3],t.drawImage(d,0,0,h,o,this._toRenderUnit(e),this._toRenderUnit(i),h,o),t.globalAlpha=1}_renderHaloEmulated(t,e,i){for(let n=0;n<this._lines.length;++n){const s=this._lines[n],r=this._getLineXOffset(n);for(const[n,o]of h)this._fillText(t,s,e+r+this._haloSize*n,i+this._haloSize*o);i+=this._lineSpacing}}_renderHaloNative(t,e,i){const n=2*this._haloSize;for(let s=0;s<this._lines.length;++s){const r=this._lines[s],h=this._getLineXOffset(s),o=5,a=.1;for(let s=0;s<o;s++){const d=1-(o-1)*a+s*a;t.lineWidth=this._toRenderUnit(d*n),this._strokeText(t,r,e+h,i)}i+=this._lineSpacing}}get _displayWidth(){return this._metrics.displayWidth}_toRenderUnit(t){return t*this.renderPixelRatio}_toRoundedRenderUnit(t){return Math.round(t*this.renderPixelRatio)}_fillText(t,e,i,n){t.fillText(e,this._toRenderUnit(i),this._toRenderUnit(n))}_strokeText(t,e,i,n){t.strokeText(e,this._toRenderUnit(i),this._toRenderUnit(n))}_drawLine(t,e,i){t.beginPath(),t.moveTo(this._toRoundedRenderUnit(e[0])+.5,this._toRoundedRenderUnit(e[1])+.5),t.lineTo(this._toRoundedRenderUnit(i[0])+.5,this._toRoundedRenderUnit(i[1])+.5),t.stroke()}_drawBox(t,e,i){const n=this._toRenderUnit(e[0]),s=this._toRenderUnit(e[1]),r=this._toRenderUnit(i[0]),h=this._toRenderUnit(i[1]),o=Math.floor(n)+.5,a=Math.ceil(n+r)-.5,d=Math.floor(s)+.5,l=Math.ceil(s+h)-.5;t.beginPath(),t.moveTo(o,d),t.lineTo(a,d),t.lineTo(a,l),t.lineTo(o,l),t.lineTo(o,d),t.stroke()}}const h=[];{const t=16;for(let e=0;e<360;e+=360/t)h.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}var o;!function(t){t[t.Left=0]=\"Left\",t[t.Center=1]=\"Center\",t[t.Right=2]=\"Right\"}(o||(o={}));const a={canvas:null},d=.2,l=512,_=\"rgb(255, 0, 255, 0.5)\";class c{get firstLineHeight(){return this.firstLineAscent+this.maxLineDescent}get midLineHeight(){return this.maxLineAscent+this.maxLineDescent}get lastLineHeight(){return this.maxLineAscent+this.lastLineDescent}constructor(t,e,i,n,s){this.firstLineAscent=t,this.lastLineDescent=e,this.maxLineAscent=i,this.maxLineDescent=n,this.displayWidth=s}}export{o as TextRenderAlignment,r as TextRenderer,s as textVerticalPaddingPx};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import s from\"../../../../core/Evented.js\";import\"../../../../core/has.js\";import{disposeMaybe as i,removeMaybe as r}from\"../../../../core/maybe.js\";import{generateUID as h}from\"../../../../core/uid.js\";import{property as n}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as a}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{a as o,s as l}from\"../../../../chunks/vec42.js\";import{ZEROS as _,create as c}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{ContentObjectType as d}from\"./ContentObjectType.js\";import{textTextureAtlas as u}from\"./testUtils.js\";import{applyTextureResizeModulo as m}from\"./textureUtils.js\";import{TaskPriority as p}from\"../../../support/Scheduler.js\";import{Yield as g}from\"../../../support/Yield.js\";import{TextureWrapMode as f,TextureSamplingMode as x}from\"../../../webgl/enums.js\";import{Texture as v}from\"../../../webgl/Texture.js\";import{TextureDescriptor as w}from\"../../../webgl/TextureDescriptor.js\";const T=4096;let k=class extends t{constructor(e){super(e),this.type=d.Texture,this.id=h(),this.events=new s,this._glTexture=null,this._atlas=new A(256,256),this._needsRepack=!1,this._canRepack=!0,this._elementsToRender=new Map,this._elements=new Map,this._uvCallbacks=new Map,this.updating=!1}initialize(){this._canvas=document.createElement(\"canvas\"),this._canvas.setAttribute(\"id\",\"textAtlasCanvas\"),this._canvas.setAttribute(\"style\",\"display:none\"),this._ctx=this._canvas.getContext(\"2d\"),this._stage=this.view._stage,this._stage.add(this),this._updateCanvasElementSize(this._atlas),this._reset()}unload(){this._glTexture=i(this._glTexture),this._frameWorker=r(this._frameWorker),this.updating=!1,this.events.emit(\"unloaded\")}get glTexture(){return this._glTexture}static get maxSize(){return j=u.stableRendering?R:0,[T-R-j,T-R-j-y]}load(e){if(this._glTexture)return this._glTexture;const t=new w;return t.wrapMode=f.CLAMP_TO_EDGE,t.samplingMode=x.LINEAR_MIPMAP_LINEAR,t.hasMipmap=!0,t.preMultiplyAlpha=!0,t.maxAnisotropy=e.parameters.maxMaxAnisotropy,this._glTexture=new v(e,t,this._canvas),this._frameWorker=this.view.resourceController.scheduler.registerTask(p.TEXT_TEXTURE_ATLAS,this),this.setDirty(),this._glTexture}dispose(){this._elements.clear(),this._elementsToRender.clear(),this._frameWorker=r(this._frameWorker),this._glTexture&&(this._stage.remove(this),this._glTexture=i(this._glTexture)),this._canvas.width=0,this._canvas.height=0,this._canvas=null,this._ctx=null}_updateCanvasElementSize(e){this._canvas.width=e.width,this._canvas.height=e.height}_resizeAtlas(e,t){const{width:s,height:i}=this._atlas;s===e&&i===t||(this._atlas.width=e,this._atlas.height=t,this._glTexture?.resize(e,t),this._glTexture?.updateData(0,0,0,s,i,this._canvas),this._updateCanvasElementSize(this._atlas),this._elements.forEach((e=>this._uvCallbacks.get(e.textRenderer.key)?.forEach((t=>t(e.uv))))),this._reset())}_reset(){this._elementsToRender.clear(),this._atlas.reset(),this._needsRepack=!0,this.setDirty()}_addAtlasElement(e,t,s,i){const r=this._atlas;if(r.width<s||r.height<i)return!1;let h=r.cursors.get(i);if(!h){if(r.height<r.nextY+i)return!1;h=[new C(r.nextY)],r.cursors.set(i,h),r.nextY+=i}let n=h.find((e=>r.width>=e.x+s));if(null==n){if(r.height<r.nextY+i)return!1;n=new C(r.nextY),r.nextY+=i,h.push(n)}return e.setNewPosition(n),this._elements.set(t,e),this._elementsToRender.set(t,e),n.x+=s,!0}_ensureCallbacks(e){const t=this._uvCallbacks.get(e);if(t)return t;const s=new Set;return this._uvCallbacks.set(e,s),s}_addCallback(e,t){this._ensureCallbacks(e).add(t)}_removeCallback(e,t){const s=this._uvCallbacks.get(e);return!(!s?.delete(t)||0!==s.size)&&(this._uvCallbacks.delete(e),!0)}_processAddition(e){const t=e.textRenderer.key;if(this._needsRepack)return void this._elements.set(t,e);const s=this._atlas,i=e.textRenderer.renderedWidth,r=e.textRenderer.renderedHeight,h=i+R,n=r+R+y;if(!this._addAtlasElement(e,t,h,n)){if(this._canRepack)this._reset();else if(s.width<h){const e=Math.min(m(Math.max(h,1.5*s.width)),T);this._resizeAtlas(e,s.height)}else{const e=s.nextY+n,t=Math.min(m(Math.max(e,1.5*s.height)),T);if(t>s.height)this._resizeAtlas(s.width,t);else if(s.width<T){const e=Math.min(m(1.5*s.width),T);this._resizeAtlas(e,s.height)}}this._elements.set(t,e)}}_renderElement(e){const t=e.commitNewPosition(),s=e.textRenderer;this._ctx.clearRect(t[0]-R,t[1]-R,s.renderedWidth+2*R,s.renderedHeight+2*R),s.render(this._ctx,t[0],t[1]),this._uvCallbacks.get(s.key)?.forEach((t=>t(e.uv)))}get running(){return this.updating}runTask(e){if(null==this._glTexture)return g;for(;this._needsRepack&&(this._canRepack||this._atlas.height<T&&this._atlas.height<T);){this._canRepack=this._needsRepack=!1;const t=this._elements;this._elements=new Map,t.forEach((e=>this._processAddition(e))),e.madeProgress()}if(this._elementsToRender.size>0){for(const[t,s]of this._elementsToRender){if(e.done)break;this._renderElement(s),this._elementsToRender.delete(t),e.madeProgress()}this._glTexture.setData(this._canvas)}this.updating=this._elementsToRender.size>0}addText(e,t){const s=e.key;this._addCallback(s,t);let i=this._elements.get(s);return i?o(i.uv,_)||t(i.uv):(i=new b(this._atlas,e),this._processAddition(i),this.setDirty()),{remove:()=>this._removeText(e,t)}}_removeText(e,t){const s=e.key;this._elements.get(s)&&this._removeCallback(s,t)&&(this._elements.delete(s),this._elementsToRender.delete(s),this._canRepack=!0)}setDirty(){this._glTexture&&(this.updating=!0)}get test(){}};e([n({constructOnly:!0})],k.prototype,\"view\",void 0),e([n({type:Boolean})],k.prototype,\"updating\",void 0),k=e([a(\"esri.views.3d.webgl-engine.lib.TextTextureAtlas\")],k);const R=2,y=2;class b{constructor(e,t){this._atlas=e,this.textRenderer=t,this._uv=c(),this._newPosition=[0,0]}get uv(){if(null==this._xOffset||null==this._yOffset)return _;const{renderedWidth:e,renderedHeight:t}=this.textRenderer;return l(this._uv,this._xOffset/this._atlas.width,(this._yOffset+t)/this._atlas.height,(this._xOffset+e)/this._atlas.width,this._yOffset/this._atlas.height)}setNewPosition(e){this._newPosition[0]=e.x,this._newPosition[1]=e.y}commitNewPosition(){return this._xOffset=this._newPosition[0],this._yOffset=this._newPosition[1],this._newPosition}get xOffset(){return this._xOffset}get yOffset(){return this._yOffset}}class A{constructor(e,t){this.width=e,this.height=t,this.cursors=new Map,this.nextY=0}reset(){this.cursors.clear(),this.nextY=j}}class C{constructor(e){this.y=e,this.x=j}}let j=0;export{k as TextTextureAtlas};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{getTextHelperCanvas as e}from\"./TextHelperCanvas.js\";import{TextRenderer as r}from\"./TextRenderer.js\";import{TextTextureAtlas as t}from\"./TextTextureAtlas.js\";import{Texture as n}from\"./Texture.js\";import{TextureWrapMode as s}from\"../../../webgl/enums.js\";class i{constructor(e,n,s){this._renderer=new r(e,n,s,t.maxSize)}get key(){return this._renderer.key}get baselineAnchorY(){return 1-this._renderer.firstRenderedBaselinePosition/this._renderer.renderedHeight}get displayWidth(){return this._renderer.displayWidth}get displayHeight(){return this._renderer.displayHeight}create(){const r=e(d,this._renderer.renderedWidth,this._renderer.renderedHeight),t=r.getContext(\"2d\");return t.save(),this._renderer.render(t,0,0),t.restore(),new n(r,{wrap:{s:s.CLAMP_TO_EDGE,t:s.CLAMP_TO_EDGE},noUnpackFlip:!1,mipmap:!0,preMultiplyAlpha:!0})}}const d={canvas:null};export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{a as e}from\"../../../../chunks/TextureOnly.glsl.js\";import{ReloadableShaderModule as r}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{makePipelineState as i,premultipliedAlphaToPremultipliedAlpha as l,defaultColorWrite as s}from\"../../../webgl/renderState.js\";class t extends o{constructor(o,i,l){super(o,i,new r(e,(()=>import(/* webpackChunkName: \"core-shaderLibrary-util-TextureOnly.glsl\" */ \"../core/shaderLibrary/util/TextureOnly.glsl.js\"))),l)}initializePipeline(e){return e.hasAlpha?i({blending:l,colorWrite:s}):i({colorWrite:s})}}export{t as TextureTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as s}from\"../../../../chunks/tslib.es6.js\";import{ShaderTechniqueConfiguration as e,parameter as o}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";class r extends e{constructor(){super(...arguments),this.hasAlpha=!1}}s([o()],r.prototype,\"hasAlpha\",void 0);export{r as TextureTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar e;!function(e){e[e.Immediate=0]=\"Immediate\",e[e.FadeWithWeather=1]=\"FadeWithWeather\"}(e||(e={}));export{e as Update};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{VertexArrayObject as e}from\"../../../webgl/VertexArrayObject.js\";class r extends e{}export{r as VertexArrayObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nfunction t(t,a,n){return 2*Math.atan(Math.sqrt(a*a+n*n)*Math.tan(.5*t)/a)}function a(t,a,n){return 2*Math.atan(Math.sqrt(a*a+n*n)*Math.tan(.5*t)/n)}function n(t,a,n){return 2*Math.atan(a*Math.tan(.5*t)/Math.sqrt(a*a+n*n))}function r(t,a,n){return 2*Math.atan(n*Math.tan(.5*t)/Math.sqrt(a*a+n*n))}export{n as fovd2fovx,r as fovd2fovy,t as fovx2fovd,a as fovy2fovd};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{BufferObject as e}from\"../../../../webgl/BufferObject.js\";import{Usage as t}from\"../../../../webgl/enums.js\";class r{constructor(r,i,s){this._elementSize=i,this._buffer=e.createVertex(r,t.STATIC_DRAW),this.resize(s)}destroy(){this._buffer.dispose()}get elementSize(){return this._elementSize}get capacity(){return this._capacity}get array(){return this._array}get buffer(){return this._buffer}get usedMemory(){return this._array.byteLength+this._buffer.usedMemory}copyRange(e,t,r,i=0){const s=new Uint8Array(this.array,e*this.elementSize,(t-e)*this.elementSize);new Uint8Array(r.array,i*this.elementSize).set(s)}transferAll(){this._buffer.setData(this._array)}transferRange(e,t){const r=e*this._elementSize,i=t*this._elementSize;this._buffer.setSubData(new Uint8Array(this._array),r,r,i)}resize(e){const t=e*this._elementSize,r=new ArrayBuffer(t);this._array&&(e>=this._capacity?new Uint8Array(r).set(new Uint8Array(this._array)):new Uint8Array(r).set(new Uint8Array(this._array).subarray(0,e*this._elementSize))),this._array=r,this._buffer.setSize(t),this._capacity=e}}export{r as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../../chunks/tslib.es6.js\";import e from\"../../../../../core/Accessor.js\";import{reallocGrowthFactor as s}from\"../../../../../core/arrayUtils.js\";import i from\"../../../../../core/Evented.js\";import{property as a}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import{subclass as r}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{fromMat4 as o,invert as h,transpose as l}from\"../../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as n}from\"../../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{multiply as c}from\"../../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as g}from\"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{i as m}from\"../../../../../chunks/vec32.js\";import{create as f}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{BufferViewMat4f64 as d,BufferViewVec3f64 as _,BufferViewMat3f as p,BufferViewVec2f as T,BufferViewVec4f64 as u,BufferViewVec4f as L,BufferViewVec4u8 as E,BufferViewUint8 as A}from\"../../../../../geometry/support/buffer/BufferView.js\";import{scaleFromMatrix as v}from\"../../../support/mathUtils.js\";import{newLayout as M}from\"../../../support/buffer/InterleavedLayout.js\";import{assert as O}from\"../Util.js\";import{VertexAttribute as I}from\"../VertexAttribute.js\";import{initialCapacity as S}from\"./RenderInstanceData.js\";var F;function C(t){let e=M().mat4f64(I.LOCALTRANSFORM).mat4f64(I.GLOBALTRANSFORM).vec4f64(I.BOUNDINGSPHERE).vec3f64(I.MODELORIGIN).mat3f(I.INSTANCEMODEL).mat3f(I.INSTANCEMODELNORMAL).vec2f(I.MODELSCALEFACTORS);return t.includes(I.FEATUREATTRIBUTE)&&(e=e.vec4f(I.FEATUREATTRIBUTE)),t.includes(I.COLOR)&&(e=e.vec4u8(I.COLOR)),t.includes(I.OBJECTANDLAYERIDCOLOR)&&(e=e.vec4u8(I.OBJECTANDLAYERIDCOLOR)),e=e.u8(I.STATE).u8(I.LODLEVEL),e}!function(t){t[t.ALLOCATED=1]=\"ALLOCATED\",t[t.DEFAULT_ACTIVE=2]=\"DEFAULT_ACTIVE\",t[t.VISIBLE=4]=\"VISIBLE\",t[t.HIGHLIGHT=8]=\"HIGHLIGHT\",t[t.HIGHLIGHT_ACTIVE=16]=\"HIGHLIGHT_ACTIVE\",t[t.REMOVE=32]=\"REMOVE\",t[t.TRANSFORM_CHANGED=64]=\"TRANSFORM_CHANGED\",t[t.ACTIVE=18]=\"ACTIVE\"}(F||(F={}));class R{constructor(t){this.localTransform=t.getField(I.LOCALTRANSFORM,d),this.globalTransform=t.getField(I.GLOBALTRANSFORM,d),this.modelOrigin=t.getField(I.MODELORIGIN,_),this.model=t.getField(I.INSTANCEMODEL,p),this.modelNormal=t.getField(I.INSTANCEMODELNORMAL,p),this.modelScaleFactors=t.getField(I.MODELSCALEFACTORS,T),this.boundingSphere=t.getField(I.BOUNDINGSPHERE,u),this.featureAttribute=t.getField(I.FEATUREATTRIBUTE,L),this.color=t.getField(I.COLOR,E),this.objectAndLayerIdColor=t.getField(I.OBJECTANDLAYERIDCOLOR,E),this.state=t.getField(I.STATE,A),this.lodLevel=t.getField(I.LODLEVEL,A)}}let b=class extends e{constructor(t,e){super(t),this.events=new i,this._capacity=0,this._size=0,this._next=0,this._highlightGroupMap=new Map,this._highlightGroupMapPrev=new Map,this._layout=C(e),this._capacity=S,this._buffer=this._layout.createBuffer(this._capacity),this._view=new R(this._buffer)}get capacity(){return this._capacity}get size(){return this._size}get view(){return this._view}addInstance(){this._size+1>this._capacity&&this._grow();const t=this._findSlot();return this._view.state.set(t,F.ALLOCATED),this._size++,this.events.emit(\"instances-changed\"),t}removeInstance(t){const e=this._view.state;O(t>=0&&t<this._capacity&&!!(e.get(t)&F.ALLOCATED),\"invalid instance handle\"),this._getStateFlag(t,F.ACTIVE)?this._setStateFlags(t,F.REMOVE):this.freeInstance(t),this.events.emit(\"instances-changed\")}freeInstance(t){const e=this._view.state;O(t>=0&&t<this._capacity&&!!(e.get(t)&F.ALLOCATED),\"invalid instance handle\"),e.set(t,0),this._size--}setLocalTransform(t,e,s=!0){this._view.localTransform.setMat(t,e),s&&this.updateModelTransform(t)}getLocalTransform(t,e){this._view.localTransform.getMat(t,e)}setGlobalTransform(t,e,s=!0){this._view.globalTransform.setMat(t,e),s&&this.updateModelTransform(t)}getGlobalTransform(t,e){this._view.globalTransform.getMat(t,e)}updateModelTransform(t){const e=this._view,s=G,i=y;e.localTransform.getMat(t,D),e.globalTransform.getMat(t,N);const a=c(N,N,D);m(s,a[12],a[13],a[14]),e.modelOrigin.setVec(t,s),o(i,a),e.model.setMat(t,i);const r=v(G,a);r.sort(),e.modelScaleFactors.set(t,0,r[1]),e.modelScaleFactors.set(t,1,r[2]),h(i,i),l(i,i),e.modelNormal.setMat(t,i),this._setStateFlags(t,F.TRANSFORM_CHANGED),this.events.emit(\"instance-transform-changed\",{index:t})}getModelTransform(t,e){const s=this._view;s.model.getMat(t,y),s.modelOrigin.getVec(t,G),e[0]=y[0],e[1]=y[1],e[2]=y[2],e[3]=0,e[4]=y[3],e[5]=y[4],e[6]=y[5],e[7]=0,e[8]=y[6],e[9]=y[7],e[10]=y[8],e[11]=0,e[12]=G[0],e[13]=G[1],e[14]=G[2],e[15]=1}applyShaderTransformation(t,e){null!=this.shaderTransformation&&this.shaderTransformation.applyTransform(this,t,e)}getCombinedModelTransform(t,e){return this.getModelTransform(t,e),null!=this.shaderTransformation&&this.shaderTransformation.applyTransform(this,t,e),e}getCombinedLocalTransform(t,e){this._view.localTransform.getMat(t,e),null!=this.shaderTransformation&&this.shaderTransformation.applyTransform(this,t,e)}getCombinedMaxScaleFactor(t){let e=this._view.modelScaleFactors.get(t,1);return null!=this.shaderTransformation&&(this.shaderTransformation.scaleFactor(G,this,t),e*=Math.max(G[0],G[1],G[2])),e}getCombinedMedianScaleFactor(t){let e=this._view.modelScaleFactors.get(t,0);return null!=this.shaderTransformation&&(this.shaderTransformation.scaleFactor(G,this,t),e*=w(G[0],G[1],G[2])),e}getModel(t,e){this._view.model.getMat(t,e)}setFeatureAttribute(t,e){this._view.featureAttribute.setVec(t,e)}getFeatureAttribute(t,e){this._view.featureAttribute.getVec(t,e)}setColor(t,e){this._view.color.setVec(t,e)}setObjectAndLayerIdColor(t,e){this._view.objectAndLayerIdColor.setVec(t,e)}setVisible(t,e){e!==this.getVisible(t)&&(this._setStateFlag(t,F.VISIBLE,e),this.events.emit(\"instance-visibility-changed\",{index:t}))}getVisible(t){return this._getStateFlag(t,F.VISIBLE)}setHighlight(t,e,s){let i=this._highlightGroupMap.get(t);e?(i||(i=new Set,this._highlightGroupMap.set(t,i)),i.add(s)&&(this._setStateFlag(t,F.HIGHLIGHT,!0),this.events.emit(\"instance-highlight-changed\"))):i?.delete(s)&&(0===i.size&&(this._highlightGroupMap.delete(t),this._setStateFlag(t,F.HIGHLIGHT,!1)),this.events.emit(\"instance-highlight-changed\"))}getHighlight(t){return this._getStateFlag(t,F.HIGHLIGHT)}foreachHighlightGroupPrev(t,e){this._highlightGroupMapPrev.get(t)?.forEach(e),this._highlightGroupMapPrev.delete(t)}foreachHighlightGroup(t,e){const s=this._highlightGroupMap.get(t);s?.forEach(e),s?this._highlightGroupMapPrev.set(t,new Set(s)):this._highlightGroupMapPrev.delete(t)}getState(t){return this._view.state.get(t)}getLodLevel(t){return this._view.lodLevel.get(t)}countFlags(t){let e=0;for(let s=0;s<this._capacity;++s){this.getState(s)&t&&++e}return e}_setStateFlags(t,e){const s=this._view.state;e=s.get(t)|e,s.set(t,e)}_clearStateFlags(t,e){const s=this._view.state;e=s.get(t)&~e,s.set(t,e)}_setStateFlag(t,e,s){s?this._setStateFlags(t,e):this._clearStateFlags(t,e)}_getStateFlag(t,e){return!!(this._view.state.get(t)&e)}_grow(){this._capacity=Math.max(S,Math.floor(this._capacity*s)),this._buffer=this._layout.createBuffer(this._capacity).copyFrom(this._buffer),this._view=new R(this._buffer)}_findSlot(){const t=this._view.state;let e=this._next;for(;t.get(e)&F.ALLOCATED;)e=e+1===this._capacity?0:e+1;return this._next=e+1===this._capacity?0:e+1,e}};function w(t,e,s){return Math.max(Math.min(t,e),Math.min(Math.max(t,e),s))}t([a({constructOnly:!0})],b.prototype,\"shaderTransformation\",void 0),t([a()],b.prototype,\"_size\",void 0),t([a({readOnly:!0})],b.prototype,\"size\",null),b=t([r(\"esri.views.3d.webgl-engine.lib.lodRendering.InstanceData\")],b);const G=f(),y=n(),D=g(),N=g();export{b as InstanceData,R as InstanceDataView,F as StateFlags};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as t}from\"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{t as e}from\"../../../../../chunks/vec32.js\";import{w as s,c as i,a as r}from\"../../../../../chunks/sphere.js\";import{maxScale as a}from\"../../../support/mathUtils.js\";import h from\"../Octree.js\";class n extends h{constructor(e,r){super((t=>s(this._instanceData.view.boundingSphere.getVec(t,this._tmpSphere))),{maximumDepth:25}),this._instanceData=e,this._boundingSphere=r,this._tmpSphere=i(),this._tmpMat4=t()}addInstance(t){const s=this._instanceData.view.boundingSphere,i=this._instanceData.getCombinedModelTransform(t,this._tmpMat4);e(r(this._tmpSphere),this._boundingSphere.center,i),this._tmpSphere[3]=this._boundingSphere.radius*a(i),s.setVec(t,this._tmpSphere),this.add([t])}removeInstance(t){this.remove([t])}}export{n as InstanceOctree};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{IntersectorType as t}from\"../IntersectorInterfaces.js\";import{Graphic3DTarget as r}from\"../IntersectorTarget.js\";import{isValidIntersectorResult as e}from\"../intersectorUtils.js\";class s extends r{constructor(t,r,e,s,i,o){super(t,r),this.layerUid=t,this.graphicUid=r,this.geometryId=e,this.triangleNr=s,this.baseBoundingSphere=i,this.numLodLevels=o}}function i(r){return e(r)&&r.intersector===t.LOD&&!!r.target}export{s as LodTarget,i as isLodIntersectorResult};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass e{constructor(e,i){this._worldSpaceRadius=e,this._minScreenSpaceRadii=i}selectLevel(e,i,t){const c=t.computeScreenPixelSizeAt(e),r=this._worldSpaceRadius*i/c;let s=0;for(let a=1;a<this._minScreenSpaceRadii.length;++a)r>=this._minScreenSpaceRadii[a]&&(s=a);return s}}export{e as LevelSelector};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glLayout as t}from\"../../../support/buffer/glUtil.js\";import{ContentObject as e}from\"../ContentObject.js\";import{Default3D as r}from\"../DefaultVertexAttributeLocations.js\";import{GLMaterials as s}from\"../GLMaterials.js\";import{newIntersectorResult as o}from\"../Intersector.js\";import{IntersectorType as n,StoreResults as i}from\"../IntersectorInterfaces.js\";import{VertexArrayObject as a}from\"../VertexArrayObject.js\";import{LodTarget as u}from\"./Intersector.js\";import{BufferObject as m}from\"../../../../webgl/BufferObject.js\";import{Usage as l}from\"../../../../webgl/enums.js\";function f(t,e,r,s=null){const o=t.createBufferWriter(),n=o.vertexBufferLayout,i=o.elementCount(e),a=n.createBuffer(i);return o.write(null,null,e,s,a,0),{material:t,vertexBufferLayout:n,buffer:a.buffer,elementCount:i,boundingInfo:r}}class d{constructor(o,n){const i=o.renderContext.rctx,u=n.geometry;let d=null;d=u instanceof e?f(u.material,u.attributes,u.boundingInfo):u;const c=d.material;this._materials=o.materials,c.setParameters({instancedDoublePrecision:!0}),this.geometry=u,this.material=c,this.glMaterials=new s(c,this._materials),this.vertexBufferLayout=d.vertexBufferLayout,this.vbo=m.createVertex(i,l.STATIC_DRAW,d.buffer),this.vao=new a(i,r,new Map([[\"geometry\",t(d.vertexBufferLayout)]]),new Map([[\"geometry\",this.vbo]])),this.vertexCount=d.elementCount}destroy(){this.glMaterials.dispose(),this.vbo.dispose(),this.vao.dispose()}get boundingInfo(){return this.geometry.boundingInfo}get triangleCount(){return this.vertexCount/3}intersect(t,r,s,a,m,l,f,d){if(!(this.geometry instanceof e))return;const c=this.geometry.id;this.material.intersect(this.geometry,t.transform.transform,t,s,a,((e,s,a,p,y)=>{if(e>=0){if(null!=r&&!r(t.rayBegin,t.rayEnd,e))return;const p=new u(l.layerUid,l.graphicUid(m),c,a,f,d);if((null==t.results.min.drapedLayerOrder||y>=t.results.min.drapedLayerOrder)&&(null==t.results.min.dist||e<t.results.min.dist)&&t.results.min.set(n.LOD,p,e,s,t.transform.transform,y),t.options.store!==i.MIN&&(null==t.results.max.drapedLayerOrder||y>=t.results.max.drapedLayerOrder)&&(null==t.results.max.dist||e>t.results.max.dist)&&t.results.max.set(n.LOD,p,e,s,t.transform.transform,y),t.options.store===i.ALL){const r=o(t.results.min.ray);r.set(n.LOD,p,e,s,t.transform.transform,y),t.results.all.push(r)}}}))}}export{d as LodComponentData,f as createLodComponentRenderGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isSome as o}from\"../../../../../core/arrayUtils.js\";import{isAborted as n,throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import{create as e}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{empty as r,expandWithVec3 as i,center as s,diameter as c}from\"../../../../../geometry/support/aaBoundingBox.js\";import{LodComponentData as u}from\"./LodComponentData.js\";class a{static async create(e,r,i){const s=await Promise.allSettled(r.components.map((o=>e.controller.schedule((()=>new u(e,o)),i)))),c=s.map((o=>\"fulfilled\"===o.status?o.value:null)).filter(o);if(n(i)||c.length!==s.length){c.forEach((o=>o.destroy())),t(i);for(const o of s)if(\"rejected\"===o.status)throw o.reason}return new a(r.minScreenSpaceRadius,c)}constructor(o,n){this.minScreenSpaceRadius=o,this.components=n}destroy(){this.components.forEach((o=>o.destroy()))}intersect(o,n,t,e,r,i,s){this.components.forEach((c=>c.intersect(o,n,t,e,r,i,this.boundingSphere,s)))}get boundingBox(){if(null==this._boundingBox){const o=r();this.components.forEach((n=>{null!=n.boundingInfo&&(i(o,n.boundingInfo.bbMin),i(o,n.boundingInfo.bbMax))})),this._boundingBox=o}return this._boundingBox}get boundingSphere(){if(null==this._boundingSphere){const o=this.boundingBox,n=e();s(o,n),this._boundingSphere={center:n,radius:.5*c(o)}}return this._boundingSphere}get triangleCount(){return this.components.reduce(((o,n)=>o+n.triangleCount),0)}}export{a as LodLevel};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{isSome as t}from\"../../../../../core/arrayUtils.js\";import r from\"../../../../../core/Error.js\";import{someMap as n}from\"../../../../../core/MapUtils.js\";import{destroyMaybe as a}from\"../../../../../core/maybe.js\";import{isAborted as s,throwIfAborted as i}from\"../../../../../core/promiseUtils.js\";import{property as o}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import{subclass as l}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{create as c}from\"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{d as h,f as d,t as u}from\"../../../../../chunks/vec32.js\";import{create as f}from\"../../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as m,fromValues as p}from\"../../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{debugFlags as _}from\"../../../support/debugFlags.js\";import{glLayout as g}from\"../../../support/buffer/glUtil.js\";import{newLayout as I}from\"../../../support/buffer/InterleavedLayout.js\";import y from\"../../../webgl/RenderCamera.js\";import{ShaderOutput as C}from\"../../core/shaderLibrary/ShaderOutput.js\";import{AsyncRenderPlugin as v}from\"../../effects/RenderPlugin.js\";import{Default3D as E}from\"../DefaultVertexAttributeLocations.js\";import{IntersectorType as R}from\"../IntersectorInterfaces.js\";import b from\"../Octree.js\";import{RenderSlot as D}from\"../RenderSlot.js\";import{assert as A}from\"../Util.js\";import{VertexAttribute as T}from\"../VertexAttribute.js\";import{InstanceData as L,StateFlags as S}from\"./InstanceData.js\";import{InstanceOctree as O}from\"./InstanceOctree.js\";import{LevelSelector as M}from\"./LevelSelector.js\";import{LodLevel as j}from\"./LodLevel.js\";import{RenderInstanceData as x}from\"./RenderInstanceData.js\";import{colorMixModes as N}from\"../../materials/internal/MaterialUtil.js\";import{encodeDoubleVec3 as w}from\"../../materials/renderers/utils.js\";import{DefaultMaterialDrawParameters as U}from\"../../shaders/DefaultMaterialTechnique.js\";import{TaskPriority as H,noBudget as F}from\"../../../../support/Scheduler.js\";import{bindVertexBufferLayout as V,unbindVertexBufferLayout as B}from\"../../../../webgl/Util.js\";const G=e=>{const t=e.baseBoundingSphere.radius,r=e.levels.map((e=>e.minScreenSpaceRadius));return new M(t,r)};let q=class extends v{constructor(e,t){super(e),this.type=R.LOD,this.isGround=!1,this._levels=[],this._defaultRenderInstanceData=new Array,this._highlightRenderInstanceDataMap=new Map,this._instanceIndex=0,this._cycleStartIndex=0,this._slicePlane=!1,this._camera=new y,this._updateCyclesWithStaticCamera=-1,this._needFullCycle=!1,this.produces=new Map([[D.OPAQUE_MATERIAL,e=>this._produces(e)],[D.TRANSPARENT_MATERIAL,e=>!!this._hasTransparentLevels()&&this._produces(e)]]),this._instanceData=new L({shaderTransformation:e.shaderTransformation},e.optionalFields),this.addHandles(t.registerTask(H.LOD_RENDERER,this))}initialize(){this._instanceBufferLayout=k(this.optionalFields),this._glInstanceBufferLayout=g(this._instanceBufferLayout,1),this.addHandles([this._instanceData.events.on(\"instances-changed\",(()=>this._requestUpdateCycle())),this._instanceData.events.on(\"instance-transform-changed\",(({index:e})=>{this._requestUpdateCycle(),this.metadata.notifyGraphicGeometryChanged(e)})),this._instanceData.events.on(\"instance-visibility-changed\",(({index:e})=>{this._requestUpdateCycle(!0),this.metadata.notifyGraphicVisibilityChanged(e)})),this._instanceData.events.on(\"instance-highlight-changed\",(()=>this._requestUpdateCycle(!0)))])}get _allRenderInstanceData(){const e=[this._defaultRenderInstanceData];for(const t of this._highlightRenderInstanceDataMap)e.push(t[1]);return e}get _enableLevelSelection(){return this.symbol.levels.length>1}get levels(){return this._levels}get baseBoundingBox(){return this._levels[this._levels.length-1].boundingBox}get baseBoundingSphere(){return this._levels[this._levels.length-1].boundingSphere}get baseMaterial(){return this._levels[this._levels.length-1].components[0].material}get slicePlaneEnabled(){return this._slicePlane}set slicePlaneEnabled(e){this._slicePlane=e}get layerUid(){return this.metadata.layerUid}get instanceData(){return this._instanceData}get hasEmissions(){return this.baseMaterial.hasEmissions}get usedMemory(){return this._allRenderInstanceData.reduce(((e,t)=>t.reduce(((e,t)=>e+t.usedMemory),e)),0)}get renderStats(){const e=this._instanceData.size,t=[];return this._levels.forEach(((e,r)=>{const n=this._allRenderInstanceData[0][r].size+this._allRenderInstanceData[1][r].size,a=e.triangleCount;t.push({renderedInstances:n,renderedTriangles:n*a,trianglesPerInstance:a})})),{totalInstances:e,renderedInstances:t.reduce(((e,t)=>e+t.renderedInstances),0),renderedTriangles:t.reduce(((e,t)=>e+t.renderedTriangles),0),levels:t}}_createRenderInstanceDataArray(e=[]){const{rctx:t}=this._context.renderContext;return this.symbol.levels.map((r=>{e.push(new x(t,this._instanceBufferLayout))})),e}async initializeRenderContext(e,r){this._context=e,this._createRenderInstanceDataArray(this._defaultRenderInstanceData);const n=await Promise.allSettled(this.symbol.levels.map((t=>j.create(e,t,r)))),a=n.map((e=>\"fulfilled\"===e.status?e.value:null)).filter(t);if(s(r)||a.length!==n.length){a.forEach((e=>e.destroy())),i(r);for(const e of n)if(\"rejected\"===e.status)throw e.reason}this._levels=a,this._levelSelector=G(this)}uninitializeRenderContext(){this._invalidateOctree(),this._levels.forEach((e=>e.destroy())),this._defaultRenderInstanceData.forEach((e=>e.destroy())),this._highlightRenderInstanceDataMap.forEach((e=>e.forEach((e=>e.destroy()))))}_hasTransparentLevels(){return this._levels.some((e=>e.components.some((e=>{const t=e.material.produces.get(D.TRANSPARENT_MATERIAL);return t?.(C.Color)}))))}hasHighlights(){return n(this._highlightRenderInstanceDataMap,(e=>e.some((e=>e.size>0))))}_produces(e){return e!==C.Highlight&&e!==C.ShadowHighlight||this.hasHighlights()}prepareRender(e){if(!_.LOD_INSTANCE_RENDERER_DISABLE_UPDATES){if(this._enableLevelSelection){const t=e.bind.contentCamera.equals(this._camera);this._camera.copyFrom(e.bind.contentCamera),t||this._requestUpdateCycle()}this._needFullCycle&&(this.runTask(F),this._needFullCycle=!1)}}acquireTechniques(e){if(!this.baseMaterial.visible||!this.baseMaterial.isVisibleForOutput(e.output))return null;const t=this._getInstanceDatas(e);if(!t)return null;const r=new Array,n=this.levels;return t.forEach((t=>n.forEach((({components:n},a)=>n.forEach((n=>r.push(this._beginComponent(e,t[a],n)))))))),r}render(e,t){const r=this._getInstanceDatas(e);if(!r||null==t)return;let n=0;e.rctx.bindVAO();const a=this.levels;r.forEach((r=>a.forEach((({components:a},s)=>a.forEach((a=>this._renderComponent(e,t[n++],r[s],a,s)))))))}_getInstanceDatas(e){const{output:t,bind:r}=e,n=t===C.Highlight,a=!n&&t!==C.ShadowHighlight,s=t!==C.ShadowExcludeHighlight;if(a)return s?this._allRenderInstanceData:[this._defaultRenderInstanceData];if(s){if(n){const{highlightGroupName:e}=r;if(!e)return null;const t=this._highlightRenderInstanceDataMap.get(e);return t?[t]:null}const e=[];for(const t of this._highlightRenderInstanceDataMap)e.push(t[1]);return e}return null}intersect(e,t,r,n){if(!this.baseMaterial.visible||null==this._octree)return;const a=f();h(a,n,r);const s=a=>{this._instanceData.getCombinedModelTransform(a,Y),e.transform.set(Y),u(J,r,e.transform.inverse),u(Q,n,e.transform.inverse);const s=this._instanceData.getState(a),i=this._instanceData.getLodLevel(a),o=this._levels.length;A(!!(s&S.ACTIVE),\"invalid instance state\"),A(i>=0&&i<o,\"invaid lod level\"),this._levels[i].intersect(e,t,J,Q,a,this.metadata,o)};this.baseMaterial.parameters.verticalOffset?this._octree.forEach(s):this._octree.forEachAlongRay(r,a,s)}notifyShaderTransformationChanged(){this._invalidateOctree(),this._requestUpdateCycle()}get _octree(){if(null==this._octreeCached){const e=this._instanceData,t=e.view?.state;if(!t)return null;this._octreeCached=new O(e,this.baseBoundingSphere);for(let r=0;r<e.capacity;++r)t.get(r)&S.ACTIVE&&this._octreeCached.addInstance(r)}return this._octreeCached}_invalidateOctree(){this._octreeCached=a(this._octreeCached)}queryDepthRange(e){if(null==this._octree)return{near:1/0,far:-1/0};const t=e.viewForward,r=this._octree.findClosest(t,b.DepthOrder.FRONT_TO_BACK,e.frustum),n=this._octree.findClosest(t,b.DepthOrder.BACK_TO_FRONT,e.frustum);if(null==r||null==n)return{near:1/0,far:-1/0};const a=e.eye,s=this._instanceData.view;s.boundingSphere.getVec(r,K),h(K,K,a);const i=d(K,t)-K[3];s.boundingSphere.getVec(n,K),h(K,K,a);const o=d(K,t)+K[3];return{near:Math.max(e.near,i),far:Math.min(e.far,o)}}_requestUpdateCycle(e=!1){this._updateCyclesWithStaticCamera=-1,this._cycleStartIndex=this._instanceIndex,e&&(this._needFullCycle=!0,this._context.requestRender())}_startUpdateCycle(){this._updateCyclesWithStaticCamera++,this._allRenderInstanceData.forEach((e=>e.forEach((e=>e.startUpdateCycle()))))}get running(){return this._instanceData.size>0&&this._updateCyclesWithStaticCamera<1}runTask(e){const{_enableLevelSelection:t,_camera:n,_levelSelector:a}=this;this._allRenderInstanceData.forEach((e=>e.forEach((e=>e.beginUpdate()))));const s=this._instanceData,i=s.view;let o=s.size;const l=s.capacity;let c=this._instanceIndex;const h=Math.ceil(l/500);for(let d=0;d<o&&!e.done;++d){c===this._cycleStartIndex&&this._startUpdateCycle();const d=i.state.get(c);let u=0;if(!(d&S.ALLOCATED)){c=c+1===l?0:c+1,o++;continue}const f=i.lodLevel.get(c);if(d&S.DEFAULT_ACTIVE&&this._defaultRenderInstanceData[f].freeTail(),d&S.HIGHLIGHT_ACTIVE&&s.foreachHighlightGroupPrev(c,(e=>{const t=this._highlightRenderInstanceDataMap.get(e);if(!t)throw new r(\"Internal error in lodRenderer\");t[f].freeTail()})),d&S.REMOVE)s.freeInstance(c);else if(d&S.VISIBLE){let e=0;t&&(i.modelOrigin.getVec(c,W),e=a.selectLevel(W,s.getCombinedMedianScaleFactor(c),n)),u=d&~(S.ACTIVE|S.TRANSFORM_CHANGED),e>=0&&(d&S.HIGHLIGHT?(s.foreachHighlightGroup(c,(t=>{let n=this._highlightRenderInstanceDataMap.get(t);if(n||(n=this._createRenderInstanceDataArray(),n.forEach((e=>e.beginUpdate())),this._highlightRenderInstanceDataMap.set(t,n)),e>=n.length)throw new r(`LodRenderer internal error - missing lodLevel ${e}`);P(n[e],i,c)})),u|=S.HIGHLIGHT_ACTIVE):(P(this._defaultRenderInstanceData[e],i,c),u|=S.DEFAULT_ACTIVE)),i.state.set(c,u),i.lodLevel.set(c,e)}else u=d&~(S.ACTIVE|S.TRANSFORM_CHANGED),i.state.set(c,u);if(null!=this._octreeCached){const e=!!(d&S.ACTIVE),t=!!(u&S.ACTIVE);!e&&t?this._octreeCached.addInstance(c):e&&!t?this._octreeCached.removeInstance(c):e&&t&&d&S.TRANSFORM_CHANGED&&(this._octreeCached.removeInstance(c),this._octreeCached.addInstance(c))}c=c+1===l?0:c+1,c%h==0&&e.madeProgress()}this._instanceIndex=c,this._allRenderInstanceData.forEach((e=>e.forEach((e=>e.endUpdate())))),this._context.requestRender()}_beginComponent(e,t,r){if(0===t.size)return null;const n=r.glMaterials.load(e.rctx,e.bind.slot,e.output);return n?.beginSlot(e.bind)}_renderComponent(e,t,r,n,a){if(!t)return;const{bind:s,rctx:i}=e;i.runAppleAmdDriverHelper();const o=i.bindTechnique(t,s,n.material.parameters,$);i.bindVAO(n.vao),t.ensureAttributeLocations(n.vao),_.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL&&e.output===C.Color&&(o.setUniform4fv(\"externalColor\",Z[Math.min(a,Z.length-1)]),o.setUniform1i(\"colorMixMode\",N.replace));const l=r.capacity,c=r.headIndex,h=r.tailIndex,d=r.firstIndex,u=this._glInstanceBufferLayout,f=(e,a)=>{V(i,E,r.buffer,u,e),i.drawArraysInstanced(t.primitiveType,0,n.vertexCount,a-e),B(i,E,r.buffer,u)};n.material.parameters.transparent&&null!=d?c>h?(A(d>=h&&d<=c,\"invalid firstIndex\"),f(d,c),f(h,d)):c<h&&(d<=c?(A(d>=0&&d<=c,\"invalid firstIndex\"),f(d,c),f(h,l),f(0,d)):(A(d>=h&&d<=l,\"invalid firstIndex\"),f(d,l),f(0,c),f(h,d))):c>h?f(h,c):c<h&&(f(0,c),f(h,l)),i.bindVAO(null)}};function P(e,t,r){const n=e.allocateHead();z(t,r,e.view,n)}function z(e,t,r,n){w(e.modelOrigin,t,r.modelOriginHi,r.modelOriginLo,n),r.model.copyFrom(n,e.model,t),r.modelNormal.copyFrom(n,e.modelNormal,t),e.color&&r.color&&r.color.copyFrom(n,e.color,t),e.objectAndLayerIdColor&&r.objectAndLayerIdColor&&r.objectAndLayerIdColor.copyFrom(n,e.objectAndLayerIdColor,t),e.featureAttribute&&r.featureAttribute&&r.featureAttribute.copyFrom(n,e.featureAttribute,t)}function k(e){let t=I().vec3f(T.INSTANCEMODELORIGINHI).vec3f(T.INSTANCEMODELORIGINLO).mat3f(T.INSTANCEMODEL).mat3f(T.INSTANCEMODELNORMAL);return null!=e&&e.includes(\"featureAttribute\")&&(t=t.vec4f(T.INSTANCEFEATUREATTRIBUTE)),null!=e&&e.includes(\"color\")&&(t=t.vec4u8(T.INSTANCECOLOR)),null!=e&&e.includes(\"objectAndLayerIdColor\")&&(t=t.vec4u8(T.INSTANCEOBJECTANDLAYERIDCOLOR)),t}e([o({constructOnly:!0})],q.prototype,\"symbol\",void 0),e([o({constructOnly:!0})],q.prototype,\"optionalFields\",void 0),e([o({constructOnly:!0})],q.prototype,\"metadata\",void 0),e([o({constructOnly:!0})],q.prototype,\"shaderTransformation\",void 0),e([o()],q.prototype,\"_instanceData\",void 0),e([o()],q.prototype,\"_cycleStartIndex\",void 0),e([o({readOnly:!0})],q.prototype,\"_enableLevelSelection\",null),e([o()],q.prototype,\"_updateCyclesWithStaticCamera\",void 0),e([o({readOnly:!0})],q.prototype,\"running\",null),q=e([l(\"esri.views.3d.webgl-engine.lib.lodRendering.LodRenderer\")],q);const W=f(),K=m(),Y=c(),J=f(),Q=f(),Z=[p(1,0,1,1),p(0,0,1,1),p(0,1,0,1),p(1,1,0,1),p(1,0,0,1)],$=new U;export{q as LodRenderer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{reallocShrinkThreshold as t,reallocGrowthFactor as i,reallocShrinkFactor as e}from\"../../../../../core/arrayUtils.js\";import{BufferViewVec3f as s,BufferViewMat3f as a,BufferViewVec4f as r,BufferViewVec4u8 as n}from\"../../../../../geometry/support/buffer/BufferView.js\";import{assert as h}from\"../Util.js\";import{VertexAttribute as d}from\"../VertexAttribute.js\";import _ from\"./BackedBufferObject.js\";class c{constructor(t){this.modelOriginHi=t.getField(d.INSTANCEMODELORIGINHI,s),this.modelOriginLo=t.getField(d.INSTANCEMODELORIGINLO,s),this.model=t.getField(d.INSTANCEMODEL,a),this.modelNormal=t.getField(d.INSTANCEMODELNORMAL,a),this.featureAttribute=t.getField(d.INSTANCEFEATUREATTRIBUTE,r),this.color=t.getField(d.INSTANCECOLOR,n),this.objectAndLayerIdColor=t.getField(d.INSTANCEOBJECTANDLAYERIDCOLOR,n)}}class f{constructor(t,i){this._rctx=t,this._instanceBufferLayout=i,this._headIndex=0,this._tailIndex=0,this._firstIndex=null,this._captureFirstIndex=!0,this._updating=!1,this._prevHeadIndex=0,this._resized=!1,this._capacity=1}destroy(){this._buffer&&this._buffer.destroy()}get buffer(){return this._buffer.buffer}get view(){return this._view}get capacity(){return this._capacity}get size(){const t=this._headIndex,i=this._tailIndex;return t>=i?t-i:t+this._capacity-i}get isEmpty(){return this._headIndex===this._tailIndex}get isFull(){return this._tailIndex===(this._headIndex+1)%this._capacity}get headIndex(){return this._headIndex}get tailIndex(){return this._tailIndex}get firstIndex(){return this._firstIndex}get usedMemory(){return this._buffer?.usedMemory??0}reset(){this._headIndex=0,this._tailIndex=0,this._firstIndex=null}startUpdateCycle(){this._captureFirstIndex=!0}beginUpdate(){h(!this._updating,\"already updating\"),this._updating=!0,this._prevHeadIndex=this._headIndex}endUpdate(){h(this._updating,\"not updating\"),this.size<t*this.capacity&&this._shrink(),this._resized?(this._buffer.transferAll(),this._resized=!1):this._transferRange(this._prevHeadIndex,this._headIndex),this._updating=!1}allocateHead(){h(this._updating,\"not updating\"),this.isFull&&this._grow();const t=this.headIndex;return this._captureFirstIndex&&(this._firstIndex=t,this._captureFirstIndex=!1),this._incrementHead(),h(this._headIndex!==this._tailIndex,\"invalid pointers\"),t}freeTail(){h(this._updating,\"not updating\"),h(this.size>0,\"invalid size\");const t=this._tailIndex===this._firstIndex;this._incrementTail(),t&&(this._firstIndex=this._tailIndex)}_grow(){const t=Math.max(u,Math.floor(this._capacity*i));this._resize(t)}_shrink(){const t=Math.max(u,Math.floor(this._capacity*e));this._resize(t)}_resize(t){if(h(this._updating,\"not updating\"),t===this._capacity)return;const i=new _(this._rctx,this._instanceBufferLayout.stride,t);if(this._buffer){this._firstIndex&&(this._firstIndex=(this._firstIndex+this._capacity-this._tailIndex)%this._capacity);const t=this.size,e=this._compactInstances(i);h(e===t,\"invalid compaction\"),this._buffer.destroy(),this._tailIndex=0,this._headIndex=e,this._prevHeadIndex=0}this._resized=!0,this._capacity=t,this._buffer=i,this._view=new c(this._instanceBufferLayout.createView(this._buffer.array))}_compactInstances(t){const i=this._headIndex,e=this._tailIndex;return e<i?(this._buffer.copyRange(e,i,t),i-e):e>i?(this._buffer.copyRange(e,this._capacity,t),i>0&&this._buffer.copyRange(0,i,t,this._capacity-e),i+(this._capacity-e)):0}_incrementHead(t=1){this._headIndex=(this._headIndex+t)%this._capacity}_incrementTail(t=1){this._tailIndex=(this._tailIndex+t)%this._capacity}_transferRange(t,i){t<i?this._buffer.transferRange(t,i):t>i&&(i>0&&this._buffer.transferRange(0,i),this._buffer.transferRange(t,this._capacity))}}const u=64;export{f as RenderInstanceData,c as RenderInstanceDataView,u as initialCapacity};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{c as t,i as e,g as r,l as s,n as o,e as i}from\"../../../../chunks/vec32.js\";import{create as m}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{create as a,fromPositionAndNormal as f,intersectRay as p}from\"../../../../geometry/support/plane.js\";import{wrap as c}from\"../../../../geometry/support/ray.js\";import{makeOrthoBasisDirUpFallback as g}from\"./GeometryUtil.js\";function l(l,v){let h=null;const u=l.vertices.length,j=.99619469809,R=m(),y=m(),x=m(),L=m(),b=m(),k=m(),q=a();let G=l.vertices[0];t(y,v),e(R,0,1,0),g(G.vRight,y,R,R,x,y,j),t(G.frame.up,y),t(G.frame.right,x);const M=l.positions;let U=l.offset;h=G;for(let m=1;m<u;++m){G=l.vertices[m],r(b,G.vLeft,G.vRight);let a=s(b);a>0?(a=1/Math.sqrt(a),b[0]=b[0]*a,b[1]=b[1]*a,b[2]=b[2]*a):(b[0]=G.vRight[0],b[1]=G.vRight[1],b[2]=G.vRight[2]),k[0]=M[U]+h.frame.up[0],k[1]=M[U+1]+h.frame.up[1],k[2]=M[U+2]+h.frame.up[2],U+=3;const v=e(n,M[U],M[U+1],M[U+2]);f(v,b,q);p(q,c(k,G.vLeft),L)?(L[0]-=M[U],L[1]-=M[U+1],L[2]-=M[U+2],o(y,L),i(x,b,y),o(x,x)):g(b,h.frame.up,h.frame.right,R,x,y,j),t(G.frame.up,y),t(G.frame.right,x),h=G}}const n=m();export{l as computeMinimumRotationTangentFrame};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{MaterialChangeSet as e}from\"./ChangeSet.js\";var r,t;function n(r){const t=new Map,n=r=>{let n=t.get(r);return n||(n=new e,t.set(r,n)),n};return r.removes.forAll((e=>{o(e)&&n(e.material).removes.push(e)})),r.adds.forAll((e=>{o(e)&&n(e.material).adds.push(e)})),r.updates.forAll((e=>{o(e.renderGeometry)&&n(e.renderGeometry.material).updates.push(e)})),t}function o(e){return e.geometry.indexCount>=1}!function(e){e[e.Default=0]=\"Default\",e[e.Screenshot=1]=\"Screenshot\",e[e.ObjectAndLayerID=2]=\"ObjectAndLayerID\"}(r||(r={})),function(e){e[e.TOP=0]=\"TOP\",e[e.RIGHT=1]=\"RIGHT\",e[e.BOTTOM=2]=\"BOTTOM\",e[e.LEFT=3]=\"LEFT\"}(t||(t={}));export{t as PaddingSide,r as RendererTarget,n as splitRenderGeometryChangeSetByMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ZEROS as t}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{newLayout as r}from\"../../support/buffer/InterleavedLayout.js\";import{isColorOrOID as e,isDepth as s,is2DGeometryOutput as i,ShaderOutput as a}from\"../core/shaderLibrary/ShaderOutput.js\";import{alphaCutoff as o}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import{olidEnabled as n}from\"../effects/geometry/olidUtils.js\";import{CullFaceOptions as h}from\"../lib/basicInterfaces.js\";import p from\"../lib/GLMaterial.js\";import{OITPolygonOffsetLimit as l}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as u}from\"../lib/RenderSlot.js\";import{VertexAttribute as c}from\"../lib/VertexAttribute.js\";import{DefaultBufferWriter as f}from\"./DefaultBufferWriter.js\";import{TriangleMaterial as m}from\"./TriangleMaterial.js\";import{VisualVariablePassParameters as _}from\"./VisualVariablePassParameters.js\";import{ColorMaterialTechnique as T}from\"../shaders/ColorMaterialTechnique.js\";import{ColorMaterialTechniqueConfiguration as g}from\"../shaders/ColorMaterialTechniqueConfiguration.js\";class O extends m{constructor(t){super(t,d),this._configuration=new g,this.supportsEdges=!0,this.produces=new Map([[u.OPAQUE_MATERIAL,t=>this._isOpaqueMaterialPass(t)],[u.OPAQUE_MATERIAL_WITHOUT_NORMALS,t=>this._isOpaqueNoSSAODepthPass(t)],[u.TRANSPARENT_MATERIAL,t=>e(t)&&this._transparent&&this.parameters.writeDepth],[u.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,t=>s(t)&&this._transparent&&this.parameters.writeDepth],[u.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,t=>e(t)&&this._transparent&&!this.parameters.writeDepth],[u.DRAPED_MATERIAL,t=>i(t)]])}getConfiguration(t,r){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._transparent,this._configuration.discardInvisibleFragments=this._transparent&&!this._isOpaquePass(t)&&this.parameters.discardInvisibleFragments,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=r.hasOccludees,this._configuration.oitPass=r.oitPass,this._configuration.enableOffset=r.camera.relativeElevation<l,this._configuration.terrainDepthTest=r.terrainDepthTest,this._configuration.cullAboveTerrain=r.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.draped=this.parameters.draped,this._configuration}get visible(){return this.parameters.color[3]>=o}get _transparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}_isOpaquePass(t){return this._isOpaqueMaterialPass(t)||this._isOpaqueNoSSAODepthPass(t)}_isOpaqueMaterialPass(t){return t===a.Highlight||e(t)&&!this._transparent}_isOpaqueNoSSAODepthPass(t){return s(t)&&this.parameters.writeDepth&&!this._transparent}createGLMaterial(t){return new A(t)}createBufferWriter(){const t=r().vec3f(c.POSITION);return n()&&t.vec4u8(c.OBJECTANDLAYERIDCOLOR),this.parameters.vvColor?t.f32(c.COLORFEATUREATTRIBUTE):t.vec4u8(c.COLOR),new f(t)}}class A extends p{beginSlot(t){return this.acquireTechnique(T,t)}}class d extends _{constructor(){super(...arguments),this.color=t,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=h.None,this.draped=!1,this.discardInvisibleFragments=!1}}export{O as ColorMaterial,d as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{newLayout as e}from\"../../support/buffer/InterleavedLayout.js\";import{VertexAttribute as O}from\"../lib/VertexAttribute.js\";const t=e().vec3f(O.POSITION),f=e().vec3f(O.POSITION).vec2f(O.UV0),r=e().vec3f(O.POSITION).vec4u8(O.COLOR),I=e().vec3f(O.POSITION).vec2f(O.UV0).vec4u8(O.OBJECTANDLAYERIDCOLOR);export{r as PositionColorLayout,t as PositionLayout,f as PositionUVLayout,I as PositionUVLayoutObjectAndLayerId};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst o=2.1;export{o as colorGamma};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{create as r}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{VertexNormalDrawParameters as e}from\"../core/shaderLibrary/attributes/VertexNormal.glsl.js\";class i extends e{constructor(e=r()){super(),this.origin=e}get slicePlaneLocalOrigin(){return this.origin}}export{i as DrawParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as e,deg2rad as t}from\"../../../../core/mathUtils.js\";import{fromMat4 as s}from\"../../../../core/libs/gl-matrix-2/math/mat3.js\";import{create as i}from\"../../../../core/libs/gl-matrix-2/factories/mat3f64.js\";import{invert as r}from\"../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as a}from\"../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{set as o,rotate as n}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{create as c,fromValues as l}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{i as f,t as h,n as p,d as m,h as u,c as d,l as g,j as S,g as O,q as T,f as b}from\"../../../../chunks/vec32.js\";import{create as v,fromValues as A}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromArray as E,create as I,freeze as _}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{isMat4 as R}from\"../../../../core/libs/gl-matrix-2/types/mat4.js\";import{create as C}from\"../../../../geometry/support/aaBoundingRect.js\";import{BufferViewVec4u8 as x}from\"../../../../geometry/support/buffer/BufferView.js\";import{evaluateModelTransformScale as P}from\"../../layers/support/FastSymbolUpdates.js\";import{debugFlags as y}from\"../../support/debugFlags.js\";import{newLayout as D}from\"../../support/buffer/InterleavedLayout.js\";import{isColorHighlightOrOID as j,ShaderOutput as F}from\"../core/shaderLibrary/ShaderOutput.js\";import{HUDVerticalPixelOffset as N}from\"../core/shaderLibrary/hud/HUD.glsl.js\";import{alphaCutoff as z}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import{olidEnabled as L}from\"../effects/geometry/olidUtils.js\";import{GLTextureMaterial as U,GLTextureMaterialBindParameters as M}from\"../lib/GLTextureMaterial.js\";import{Material as w,RenderOccludedFlag as V}from\"../lib/Material.js\";import{RenderSlot as B}from\"../lib/RenderSlot.js\";import{applyScaleFactor as q,applyPrecomputedScaleFactor as G,precomputeScaleFactor as H}from\"../lib/screenSizePerspectiveUtils.js\";import{assert as W}from\"../lib/Util.js\";import{VertexAttribute as X}from\"../lib/VertexAttribute.js\";import{ScaleInfo as Y}from\"./ScaleInfo.js\";import{writePosition as Z,writeNormal as k,writeColor as J,writeBufferFloat as K,writeBufferVec4 as Q,writeBufferVec4Zeros as $,writeObjectAndLayerIdColor as ee}from\"./internal/bufferWriterUtils.js\";import{verticalOffsetAtDistance as te}from\"./internal/MaterialUtil.js\";import{c as se}from\"../../../../chunks/HUDMaterial.glsl.js\";import{HUDMaterialTechnique as ie}from\"../shaders/HUDMaterialTechnique.js\";import{HUDMaterialTechniqueConfiguration as re}from\"../shaders/HUDMaterialTechniqueConfiguration.js\";class ae extends w{constructor(e,t){super(e,ye),this.produces=new Map([[B.HUD_MATERIAL,e=>j(e)&&!this.parameters.drawInSecondSlot],[B.LABEL_MATERIAL,e=>j(e)&&this.parameters.drawInSecondSlot],[B.OCCLUSION_PIXELS,()=>this.parameters.occlusionTest],[B.DRAPED_MATERIAL,e=>this.parameters.draped&&j(e)]]),this._visible=!0,this._configuration=new re(t)}getConfiguration(e,t){return this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVerticalOffset=!!this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=!!this.parameters.screenSizePerspective,this._configuration.screenCenterOffsetUnitsEnabled=\"screen\"===this.parameters.centerOffsetUnits,this._configuration.hasPolygonOffset=this.parameters.polygonOffset,this._configuration.draped=this.parameters.draped,this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.pixelSnappingEnabled=this.parameters.pixelSnappingEnabled,this._configuration.signedDistanceFieldEnabled=this.parameters.textureIsSignedDistanceField,this._configuration.sampleSignedDistanceFieldTexelCenter=this.parameters.sampleSignedDistanceFieldTexelCenter,this._configuration.hasRotation=this.parameters.hasRotation,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.occlusionPass=t.slot===B.OCCLUSION_PIXELS,this._configuration.occludedFragmentFade=this.parameters.occludedFragmentFade,this._configuration.horizonCullingEnabled=this.parameters.horizonCullingEnabled,this._configuration.depthTestEnabled=this.parameters.depthEnabled||t.slot===B.OCCLUSION_PIXELS,e===F.Color&&(this._configuration.debugDrawLabelBorder=!!y.LABELS_SHOW_BORDER),this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}intersect(e,t,i,a,o,n){const{options:{selectionMode:c,hud:l,excludeLabels:O},point:T,camera:b}=i,{parameters:A}=this;if(!c||!l||O&&A.isLabel||!e.visible||!T)return;const{scaleX:E,scaleY:I}=this._getScreenScale(e,b.pixelRatio);s(Te,t),e.attributes.has(X.FEATUREATTRIBUTE)&&le(Te);const _=e.attributes.get(X.POSITION),R=e.attributes.get(X.SIZE),C=e.attributes.get(X.NORMAL),x=e.attributes.get(X.ROTATION),P=e.attributes.get(X.CENTEROFFSETANDDISTANCE);W(_.size>=3);const y=se(A),D=\"screen\"===this.parameters.centerOffsetUnits;for(let s=0;s<_.data.length/_.size;s++){const e=s*_.size;f(pe,_.data[e],_.data[e+1],_.data[e+2]),h(pe,pe,t),h(pe,pe,b.viewMatrix);const a=s*P.size;if(f(Ae,P.data[a],P.data[a+1],P.data[a+2]),!D&&(pe[0]+=Ae[0],pe[1]+=Ae[1],0!==Ae[2])){const e=Ae[2];p(Ae,pe),m(pe,pe,u(Ae,Ae,e))}const o=s*C.size;if(f(me,C.data[o],C.data[o+1],C.data[o+2]),ce(me,Te,b,_e),this._applyVerticalOffsetTransformationView(pe,_e,b,he),b.applyProjection(pe,ue),ue[0]>-1){D&&(Ae[0]||Ae[1])&&(ue[0]+=Ae[0]*b.pixelRatio,0!==Ae[1]&&(ue[1]+=q(Ae[1],he.factorAlignment)*b.pixelRatio),b.unapplyProjection(ue,pe)),ue[0]+=this.parameters.screenOffset[0]*b.pixelRatio,ue[1]+=this.parameters.screenOffset[1]*b.pixelRatio,ue[0]=Math.floor(ue[0]),ue[1]=Math.floor(ue[1]);const e=s*R.size;xe[0]=R.data[e],xe[1]=R.data[e+1],G(xe,he.factor,xe);const t=Re*b.pixelRatio;let a=0;if(A.textureIsSignedDistanceField){a=Math.min(A.outlineSize,.5*xe[0])*b.pixelRatio/2}xe[0]*=E,xe[1]*=I;const o=s*x.size,c=A.rotation+x.data[o];if(fe(T,ue[0],ue[1],xe,t,a,c,A,y)){const e=i.ray;if(h(ge,pe,r(ve,b.viewMatrix)),ue[0]=T[0],ue[1]=T[1],b.unprojectFromRenderScreen(ue,pe)){const t=v();d(t,e.direction);const s=1/g(t);u(t,t,s);n(S(e.origin,pe)*s,t,-1,!0,1,ge)}}}}}intersectDraped(e,t,s,i,r,a){const o=e.attributes.get(X.POSITION),n=e.attributes.get(X.SIZE),c=e.attributes.get(X.ROTATION),l=this.parameters,f=se(l),{scaleX:h,scaleY:p}=this._getScreenScale(e,e.screenToWorldRatio),m=Ce*e.screenToWorldRatio;for(let u=0;u<o.data.length/o.size;u++){const t=u*o.size,s=o.data[t],d=o.data[t+1],g=u*n.size;xe[0]=n.data[g],xe[1]=n.data[g+1];let S=0;if(l.textureIsSignedDistanceField){S=Math.min(l.outlineSize,.5*xe[0])*e.screenToWorldRatio/2}xe[0]*=h,xe[1]*=p;const O=u*c.size,T=l.rotation+c.data[O];fe(i,s,d,xe,m,S,T,l,f)&&r(a.dist,a.normal,-1,!1)}}createBufferWriter(){return new Fe}_updateScaleInfo(e,t,s){const i=this.parameters;null!=i.screenSizePerspective?H(s,t,i.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minScaleFactor=0),null!=i.screenSizePerspectiveAlignment?H(s,t,i.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minScaleFactor=e.factor.minScaleFactor)}applyShaderOffsetsView(e,t,s,i,r,a,o){const n=ce(t,s,r,_e);return this._applyVerticalGroundOffsetView(e,n,r,o),this._applyVerticalOffsetTransformationView(o,n,r,a),this._applyPolygonOffsetView(o,n,i[3],r,o),this._applyCenterOffsetView(o,i,o),o}applyShaderOffsetsNDC(e,t,s,i,r){return this._applyCenterOffsetNDC(e,t,s,i),null!=r&&d(r,i),this._applyPolygonOffsetNDC(i,t,s,i),i}_applyPolygonOffsetView(t,s,i,r,a){const o=r.aboveGround?1:-1;let n=Math.sign(i);0===n&&(n=o);const c=o*n;if(this.parameters.shaderPolygonOffset<=0)return d(a,t);const l=e(Math.abs(s.cosAngle),.01,1),f=1-Math.sqrt(1-l*l)/l/r.viewport[2];return u(a,t,c>0?f:1/f),a}_applyVerticalGroundOffsetView(e,t,s,i){const r=g(e),a=s.aboveGround?1:-1,o=s.computeRenderPixelSizeAtDist(r)*N,n=u(pe,t.normal,a*o);return O(i,e,n),i}_applyVerticalOffsetTransformationView(e,t,s,i){const r=this.parameters;if(!r.verticalOffset?.screenLength){if(r.screenSizePerspective||r.screenSizePerspectiveAlignment){const s=g(e);this._updateScaleInfo(i,s,t.cosAngle)}else i.factor.scale=1,i.factorAlignment.scale=1;return e}const a=g(e),o=r.screenSizePerspectiveAlignment??r.screenSizePerspective,n=te(s,a,r.verticalOffset,t.cosAngle,o);return this._updateScaleInfo(i,a,t.cosAngle),u(t.normal,t.normal,n),O(e,e,t.normal)}_applyCenterOffsetView(e,t,s){const i=\"screen\"!==this.parameters.centerOffsetUnits;return s!==e&&d(s,e),i&&(s[0]+=t[0],s[1]+=t[1],t[2]&&(p(me,s),O(s,s,u(me,me,t[2])))),s}_applyCenterOffsetNDC(e,t,s,i){const r=\"screen\"!==this.parameters.centerOffsetUnits;return i!==e&&d(i,e),r||(i[0]+=t[0]/s.fullWidth*2,i[1]+=t[1]/s.fullHeight*2),i}_applyPolygonOffsetNDC(e,t,s,i){const r=this.parameters.shaderPolygonOffset;if(e!==i&&d(i,e),r){const e=s.aboveGround?1:-1,a=e*Math.sign(t[3]);i[2]-=(a||e)*r}return i}set visible(e){this._visible=e}get visible(){const{color:e,outlineSize:t,outlineColor:s}=this.parameters,i=e[3]>=z||t>=z&&s[3]>=z;return this._visible&&i}createGLMaterial(e){return new oe(e)}calculateRelativeScreenBounds(e,t,s=C()){return ne(this.parameters,e,t,s),s[2]=s[0]+e[0],s[3]=s[1]+e[1],s}_getScreenScale(e,t){const s=e.attributes.get(X.FEATUREATTRIBUTE);if(null==s)return{scaleX:t,scaleY:t};const i=E(s.data,Ie);return P(Ee,this.parameters,i),{scaleX:Ee[0]*t,scaleY:Ee[1]*t}}}class oe extends U{constructor(e){super({...e,...e.material.parameters})}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.acquireTechnique(ie,e)}}function ne(e,t,s,i){i[0]=e.anchorPosition[0]*-t[0]+e.screenOffset[0]*s,i[1]=e.anchorPosition[1]*-t[1]+e.screenOffset[1]*s}function ce(e,t,i,r){return R(t)&&(t=s(be,t)),T(r.normal,e,t),h(r.normal,r.normal,i.viewInverseTransposeMatrix),r.cosAngle=b(de,Pe),r}function le(e){const t=e[0],s=e[1],i=e[2],r=e[3],a=e[4],o=e[5],n=e[6],c=e[7],l=e[8],f=1/Math.sqrt(t*t+s*s+i*i),h=1/Math.sqrt(r*r+a*a+o*o),p=1/Math.sqrt(n*n+c*c+l*l);return e[0]=t*f,e[1]=s*f,e[2]=i*f,e[3]=r*h,e[4]=a*h,e[5]=o*h,e[6]=n*p,e[7]=c*p,e[8]=l*p,e}function fe(e,s,i,r,a,c,l,f,h){let p=s-a-r[0]*h[0],m=p+r[0]+2*a,u=i-a-r[1]*h[1],d=u+r[1]+2*a;const g=f.distanceFieldBoundingBox;return f.textureIsSignedDistanceField&&null!=g&&(p+=r[0]*g[0],u+=r[1]*g[1],m-=r[0]*(1-g[2]),d-=r[1]*(1-g[3]),p-=c,m+=c,u-=c,d+=c),o(Oe,s,i),n(Se,e,Oe,t(l)),Se[0]>p&&Se[0]<m&&Se[1]>u&&Se[1]<d}const he=new Y,pe=v(),me=v(),ue=I(),de=v(),ge=v(),Se=c(),Oe=c(),Te=i(),be=i(),ve=a(),Ae=v(),Ee=v(),Ie=I(),_e={normal:de,cosAngle:0},Re=1,Ce=2,xe=[0,0],Pe=A(0,0,1);class ye extends M{constructor(){super(...arguments),this.renderOccluded=V.Occlude,this.isDecoration=!1,this.color=_(1,1,1,1),this.polygonOffset=!1,this.anchorPosition=l(.5,.5),this.screenOffset=[0,0],this.shaderPolygonOffset=1e-5,this.textureIsSignedDistanceField=!1,this.sampleSignedDistanceFieldTexelCenter=!1,this.outlineColor=_(1,1,1,1),this.outlineSize=0,this.rotation=0,this.hasRotation=!1,this.vvSizeEnabled=!1,this.vvSize=null,this.vvColor=null,this.vvOpacity=null,this.vvSymbolAnchor=null,this.vvSymbolRotationMatrix=null,this.hasSlicePlane=!1,this.pixelSnappingEnabled=!0,this.occlusionTest=!0,this.occludedFragmentFade=!1,this.horizonCullingEnabled=!1,this.centerOffsetUnits=\"world\",this.drawInSecondSlot=!1,this.depthEnabled=!0,this.draped=!1,this.isLabel=!1}}const De=D().vec3f(X.POSITION).vec3f(X.NORMAL).vec2f(X.UV0).vec4u8(X.COLOR).vec2f(X.SIZE).f32(X.ROTATION).vec4f(X.CENTEROFFSETANDDISTANCE).vec4f(X.FEATUREATTRIBUTE),je=De.clone().vec4u8(X.OBJECTANDLAYERIDCOLOR);class Fe{constructor(){this.vertexBufferLayout=L()?je:De}elementCount(e){return 6*e.get(X.POSITION).indices.length}write(e,t,s,i,r,a){Z(s.get(X.POSITION),e,r.position,a,6),k(s.get(X.NORMAL),t,r.normal,a,6);const o=s.get(X.UV0)?.data;let n=0,c=0,l=1,f=1;o&&o.length>=4&&(n=o[0],c=o[1],l=o[2],f=o[3]),l=Math.min(1.99999,l+1),f=Math.min(1.99999,f+1);let h=s.get(X.POSITION).indices.length,p=a;const m=r.uv0;for(let S=0;S<h;++S)m.set(p,0,n),m.set(p,1,c),p++,m.set(p,0,l),m.set(p,1,c),p++,m.set(p,0,l),m.set(p,1,f),p++,m.set(p,0,l),m.set(p,1,f),p++,m.set(p,0,n),m.set(p,1,f),p++,m.set(p,0,n),m.set(p,1,c),p++;J(s.get(X.COLOR),4,r.color,a,6);const{data:u,indices:d}=s.get(X.SIZE);h=d.length;const g=r.size;p=a;for(let S=0;S<h;++S){const e=u[2*d[S]],t=u[2*d[S]+1];for(let s=0;s<6;++s)g.set(p,0,e),g.set(p,1,t),p++}if(K(s.get(X.ROTATION),r.rotation,a,6),s.get(X.CENTEROFFSETANDDISTANCE)?Q(s.get(X.CENTEROFFSETANDDISTANCE),r.centerOffsetAndDistance,a,6):$(r.centerOffsetAndDistance,a,6*h),s.get(X.FEATUREATTRIBUTE)?Q(s.get(X.FEATUREATTRIBUTE),r.featureAttribute,a,6):$(r.featureAttribute,a,6*h),null!=i){const e=s.get(X.POSITION)?.indices;if(e){const t=e.length,s=r.getField(X.OBJECTANDLAYERIDCOLOR,x);ee(i,s,t,a,6)}}}}export{ae as HUDMaterial,ye as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{i as e,H as t,t as r}from\"../../../../chunks/vec32.js\";import{create as i}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{newLayout as a}from\"../../support/buffer/InterleavedLayout.js\";import{ShaderOutput as s,isColor as o,isDepth as n,isColorHighlightOrDepth as h}from\"../core/shaderLibrary/ShaderOutput.js\";import{alphaCutoff as c}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import{GLTextureMaterial as m}from\"../lib/GLTextureMaterial.js\";import{Material as p,RenderOccludedFlag as l}from\"../lib/Material.js\";import{RenderSlot as u}from\"../lib/RenderSlot.js\";import{VertexAttribute as T}from\"../lib/VertexAttribute.js\";import{VisualVariablePassParameters as d}from\"./VisualVariablePassParameters.js\";import{vertexAttributeLocations as f,LineMarkerTechnique as A}from\"../shaders/LineMarkerTechnique.js\";import{LineMarkerTechniqueConfiguration as _,LineMarkerSpace as v,LineMarkerAnchor as E}from\"../shaders/LineMarkerTechniqueConfiguration.js\";import{CapType as O}from\"../shaders/RibbonLineTechniqueConfiguration.js\";class g extends p{constructor(e){super(e,R),this._configuration=new _,this.vertexAttributeLocations=f,this.produces=new Map([[u.OPAQUE_MATERIAL,e=>e===s.Highlight||o(e)&&this.parameters.renderOccluded===l.OccludeAndTransparentStencil],[u.OPAQUE_MATERIAL_WITHOUT_NORMALS,e=>n(e)],[u.OCCLUDER_MATERIAL,e=>h(e)&&this.parameters.renderOccluded===l.OccludeAndTransparentStencil],[u.TRANSPARENT_OCCLUDER_MATERIAL,e=>h(e)&&this.parameters.renderOccluded===l.OccludeAndTransparentStencil],[u.TRANSPARENT_MATERIAL,e=>o(e)&&this.parameters.writeDepth],[u.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>o(e)&&!this.parameters.writeDepth],[u.DRAPED_MATERIAL,e=>e===s.Color||e===s.Highlight]]),this._layout=this.createLayout()}getConfiguration(e,t){return this._configuration.output=e,this._configuration.space=t.slot===u.DRAPED_MATERIAL?v.Draped:this.parameters.worldSpace?v.World:v.Screen,this._configuration.hideOnShortSegments=this.parameters.hideOnShortSegments,this._configuration.hasCap=this.parameters.cap!==O.BUTT,this._configuration.anchor=this.parameters.anchor,this._configuration.hasTip=this.parameters.hasTip,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=t.hasOccludees,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.vvOpacity=!!this.parameters.vvOpacity,this._configuration.occluder=this.parameters.renderOccluded===l.OccludeAndTransparentStencil,this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}get visible(){return this.parameters.color[3]>=c}intersect(){}createLayout(){const e=a().vec3f(T.POSITION).vec3f(T.PREVPOSITION).vec2f(T.UV0);return this.parameters.worldSpace&&e.vec3f(T.NORMAL),this.parameters.vvSize?e.f32(T.SIZEFEATUREATTRIBUTE):e.f32(T.SIZE),this.parameters.vvColor?e.f32(T.COLORFEATUREATTRIBUTE):e.vec4f(T.COLOR),this.parameters.vvOpacity&&e.f32(T.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new I(this._layout,this.parameters)}createGLMaterial(e){return new S(e)}}class S extends m{constructor(){super(...arguments),this._markerPrimitive=null}dispose(){super.dispose(),this._markerTextures.release(this._markerPrimitive),this._markerPrimitive=null}beginSlot(e){const t=this._material.parameters.markerPrimitive;return t!==this._markerPrimitive&&(this._material.setParameters({markerTexture:this._markerTextures.swap(t,this._markerPrimitive)}),this._markerPrimitive=t),this._material.setParameters(this.textureBindParameters),this.acquireTechnique(A,e)}}class R extends d{constructor(){super(...arguments),this.width=0,this.color=[1,1,1,1],this.markerPrimitive=\"arrow\",this.placement=\"end\",this.cap=O.BUTT,this.anchor=E.Center,this.hasTip=!1,this.worldSpace=!1,this.hideOnShortSegments=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.markerTexture=null}}class I{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t}elementCount(){return\"begin-end\"===this._parameters.placement?12:6}write(i,a,s,o,n,h){const c=s.get(T.POSITION).data,m=c.length/3;let p=[1,0,0];const l=s.get(T.NORMAL);this._parameters.worldSpace&&null!=l&&(p=l.data);let u=1,d=0;this._parameters.vvSize?d=s.get(T.SIZEFEATUREATTRIBUTE).data[0]:s.has(T.SIZE)&&(u=s.get(T.SIZE).data[0]);let f=[1,1,1,1],A=0;this._parameters.vvColor?A=s.get(T.COLORFEATUREATTRIBUTE).data[0]:s.has(T.COLOR)&&(f=s.get(T.COLOR).data);let _=0;this._parameters.vvOpacity&&(_=s.get(T.OPACITYFEATUREATTRIBUTE).data[0]);const v=new Float32Array(n.buffer);let E=h*(this.vertexBufferLayout.stride/4);const O=(e,t,r,i)=>{if(v[E++]=e[0],v[E++]=e[1],v[E++]=e[2],v[E++]=t[0],v[E++]=t[1],v[E++]=t[2],v[E++]=r[0],v[E++]=r[1],this._parameters.worldSpace&&(v[E++]=p[0],v[E++]=p[1],v[E++]=p[2]),this._parameters.vvSize?v[E++]=d:v[E++]=u,this._parameters.vvColor)v[E++]=A;else{const e=Math.min(4*i,f.length-4);v[E++]=f[e],v[E++]=f[e+1],v[E++]=f[e+2],v[E++]=f[e+3]}this._parameters.vvOpacity&&(v[E++]=_)};let g;!function(e){e[e.ASCENDING=1]=\"ASCENDING\",e[e.DESCENDING=-1]=\"DESCENDING\"}(g||(g={}));const S=(a,s)=>{const o=e(P,c[3*a],c[3*a+1],c[3*a+2]),n=L;let h=a+s;do{e(n,c[3*h],c[3*h+1],c[3*h+2]),h+=s}while(t(o,n)&&h>=0&&h<m);i&&(r(o,o,i),r(n,n,i)),O(o,n,[-1,-1],a),O(o,n,[1,-1],a),O(o,n,[1,1],a),O(o,n,[-1,-1],a),O(o,n,[1,1],a),O(o,n,[-1,1],a)},R=this._parameters.placement;\"begin\"!==R&&\"begin-end\"!==R||S(0,g.ASCENDING),\"end\"!==R&&\"begin-end\"!==R||S(m-1,g.DESCENDING)}}const P=i(),L=i();export{g as LineMarkerMaterial,R as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../../../core/Logger.js\";import{clamp as r}from\"../../../../core/mathUtils.js\";import{createRenderScreenPointArray3 as t}from\"../../../../core/screenUtils.js\";import{copy as o}from\"../../../../core/libs/gl-matrix-2/math/vec2.js\";import{i as s,d as i,f as a,h as n,g as c,c as m,l,j as u}from\"../../../../chunks/vec32.js\";import{create as f}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{ONES as p}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{PlaneIndex as h}from\"../../../../geometry/support/frustum.js\";import{create as g,distance2 as d,fromPoints as j,closestLineSegmentPoint as b}from\"../../../../geometry/support/lineSegment.js\";import{create as A,fromPoints as S,signedDistance as L,getNormal as x}from\"../../../../geometry/support/plane.js\";import{isColorHighlightOrOID as y}from\"../core/shaderLibrary/ShaderOutput.js\";import{alphaCutoff as N}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import R from\"../lib/GLMaterial.js\";import{Material as v,MaterialParameters as E}from\"../lib/Material.js\";import{RenderSlot as M}from\"../lib/RenderSlot.js\";import{isTranslationMatrix as T}from\"../lib/Util.js\";import{VertexAttribute as _}from\"../lib/VertexAttribute.js\";import{DefaultBufferWriter as w}from\"./DefaultBufferWriter.js\";import{PositionColorLayout as O,PositionLayout as V}from\"./DefaultLayouts.js\";import{NativeLineTechnique as C}from\"../shaders/NativeLineTechnique.js\";import{NativeLineTechniqueConfiguration as P}from\"../shaders/NativeLineTechniqueConfiguration.js\";class U extends v{constructor(e){super(e,q),this._configuration=new P,this.produces=new Map([[M.OPAQUE_MATERIAL,e=>y(e)]])}getConfiguration(e,r){return this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.transparent=this.parameters.color[3]<1||this.parameters.width<1,this._configuration.hasOccludees=r.hasOccludees,this._configuration}get visible(){return this.parameters.color[3]>=N}intersect(r,t,f,p,g,A){if(!f.options.selectionMode||!r.visible)return;if(!T(t))return void e.getLogger(\"esri.views.3d.webgl-engine.materials.NativeLineMaterial\").error(\"intersection assumes a translation-only matrix\");const y=r.attributes.get(_.POSITION).data,N=f.camera,R=H;o(R,f.point);const v=2;s(J[0],R[0]-v,R[1]+v,0),s(J[1],R[0]+v,R[1]+v,0),s(J[2],R[0]+v,R[1]-v,0),s(J[3],R[0]-v,R[1]-v,0);for(let e=0;e<4;e++)if(!N.unprojectFromRenderScreen(J[e],K[e]))return;S(N.eye,K[0],K[1],Y),S(N.eye,K[1],K[2],$),S(N.eye,K[2],K[3],ee),S(N.eye,K[3],K[0],re);let E=Number.MAX_VALUE,M=0;for(let e=0;e<y.length-5;e+=3){if(B[0]=y[e]+t[12],B[1]=y[e+1]+t[13],B[2]=y[e+2]+t[14],D[0]=y[e+3]+t[12],D[1]=y[e+4]+t[13],D[2]=y[e+5]+t[14],L(Y,B)<0&&L(Y,D)<0||L($,B)<0&&L($,D)<0||L(ee,B)<0&&L(ee,D)<0||L(re,B)<0&&L(re,D)<0)continue;if(N.projectToRenderScreen(B,G),N.projectToRenderScreen(D,k),G[2]<0&&k[2]>0){i(W,B,D);const e=N.frustum,r=-L(e[h.NEAR],B)/a(W,x(e[h.NEAR]));n(W,W,r),c(B,B,W),N.projectToRenderScreen(B,G)}else if(G[2]>0&&k[2]<0){i(W,D,B);const e=N.frustum,r=-L(e[h.NEAR],D)/a(W,x(e[h.NEAR]));n(W,W,r),c(D,D,W),N.projectToRenderScreen(D,k)}else if(G[2]<0&&k[2]<0)continue;G[2]=0,k[2]=0;const r=d(j(G,k,Z),R);r<E&&(E=r,m(F,B),m(Q,D),M=e/3)}const w=f.rayBegin,O=f.rayEnd;if(E<v*v){let e=Number.MAX_VALUE;if(b(j(F,Q,Z),j(w,O,z),X)){i(X,X,w);const r=l(X);n(X,X,1/r),e=r/u(w,O)}A(e,X,M,!1)}}intersectDraped(e,t,o,s,i,a){if(!o.options.selectionMode)return;const n=e.attributes.get(_.POSITION).data,c=e.attributes.get(_.SIZE),m=c?c.data[0]:0,l=s[0],u=s[1],f=((m+1)/2+4)*e.screenToWorldRatio;let p=Number.MAX_VALUE,h=0;for(let g=0;g<n.length-5;g+=3){const e=n[g],t=n[g+1],o=l-e,s=u-t,i=n[g+3]-e,a=n[g+4]-t,c=r((i*o+a*s)/(i*i+a*a),0,1),m=i*c-o,f=a*c-s,d=m*m+f*f;d<p&&(p=d,h=g/3)}p<f*f&&i(a.dist,a.normal,h,!1)}createGLMaterial(e){return new I(e)}createBufferWriter(){const e=this.parameters.hasVertexColors?O:V;return new w(e)}}class I extends R{beginSlot(e){return this.acquireTechnique(C,e)}}class q extends E{constructor(){super(...arguments),this.color=p,this.hasVertexColors=!1,this.hasSlicePlane=!1,this.width=1}}const B=f(),D=f(),W=f(),X=f(),G=t(),k=t(),F=f(),Q=f(),Z=g(),z=g(),H=f(),J=[t(),t(),t(),t()],K=[f(),f(),f(),f()],Y=A(),$=A(),ee=A(),re=A();export{U as NativeLineMaterial,q as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{clamp as e}from\"../../../../core/mathUtils.js\";import{p as t}from\"../../../../chunks/vec32.js\";import{ZEROS as r}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as i}from\"../../../../geometry/support/aaBoundingBox.js\";import{newLayout as s}from\"../../support/buffer/InterleavedLayout.js\";import{isShadowRelatedOutput as a,is3DGeometryOutputMRT as o,isColorOrColorEmission as n,ShaderOutput as h}from\"../core/shaderLibrary/ShaderOutput.js\";import{EmissionSource as u}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{NormalsDoubleSidedMode as c}from\"../core/shaderLibrary/shading/Normals.glsl.js\";import{PBRMode as m}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{alphaCutoff as p}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import{olidEnabled as l}from\"../effects/geometry/olidUtils.js\";import f from\"../lib/GLMaterial.js\";import{Material as d}from\"../lib/Material.js\";import{isPathGeometry as b}from\"../lib/PathGeometry.js\";import{MeshIntersectionOptions as g,intersectAabbInvDir as v}from\"../lib/RayIntersections.js\";import{RenderSlot as S}from\"../lib/RenderSlot.js\";import{VertexAttribute as P}from\"../lib/VertexAttribute.js\";import{DefaultBufferWriter as R}from\"./DefaultBufferWriter.js\";import{vertexAttributeLocations as _,PathTechnique as j,PathPassParameters as y}from\"./PathTechnique.js\";import{PathTechniqueConfiguration as A}from\"./PathTechniqueConfiguration.js\";class L extends d{constructor(e,t){super(e,M),this._vertexBufferLayout=O(),this.vertexAttributeLocations=_,this.supportsEdges=!0,this.produces=new Map([[S.OPAQUE_MATERIAL,e=>(this.parameters.castShadows&&a(e)||o(e))&&!this.parameters.transparent],[S.TRANSPARENT_MATERIAL,e=>(this.parameters.castShadows&&a(e)||o(e))&&this.parameters.transparent]]),this._configuration=new A(t.spherical,t.doublePrecisionRequiresObfuscation)}get hasEmissions(){return!t(this.parameters.emissiveFactor,r)}getConfiguration(e,t){return this._configuration.output=e,this._configuration.vvSize=!!this.parameters.vvSize,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration.vvOpacity=!!this.parameters.vvOpacity,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasOccludees=t.hasOccludees,n(e)&&(this._configuration.doubleSidedMode=this.parameters.doubleSided&&\"normal\"===this.parameters.doubleSidedType?c.View:this.parameters.doubleSided&&\"winding-order\"===this.parameters.doubleSidedType?c.WindingOrder:c.None,this._configuration.receiveShadows=t.shadowMap.enabled,this._configuration.receiveAmbientOcclusion=null!=t.ssao),this._configuration.pbrMode=this.parameters.usePBR?m.Schematic:m.Disabled,this._configuration.emissionSource=this.parameters.usePBR?u.Value:u.None,this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}isVisibleForOutput(e){return e!==h.Shadow&&e!==h.ShadowExcludeHighlight&&e!==h.ShadowHighlight||this.parameters.castShadows}get visible(){return this.parameters.opacity>=p}intersect(t,r,s,a,o,n){const h=t;if(!b(h))return;const u=h.path,c=[this.parameters.size[0],this.parameters.size[1]];if(this.parameters.vvSize){const{offset:t,factor:r,minSize:i,maxSize:s}=this.parameters.vvSize,a=u.sizeAttributeValue;c[0]*=e(t[0]+a*r[0],i[0],s[0]),c[1]*=e(t[2]+a*r[2],i[2],s[2])}const m=new g(!1,s.options.normalRequired),p=Math.max(c[0],c[1]),l=t.boundingInfo;if(null==l)return void E(u,c,a,o,m,n);const f=i(l.bbMin[0]-p,l.bbMin[1]-p,l.bbMin[2]-p,l.bbMax[0]+p,l.bbMax[1]+p,l.bbMax[2]+p),d=[o[0]-a[0],o[1]-a[1],o[2]-a[2]],S=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]),P=[S/d[0],S/d[1],S/d[2]];v(f,a,P,s.tolerance)&&E(u,c,a,o,m,n)}createBufferWriter(){return new R(this._vertexBufferLayout)}createGLMaterial(e){return new T(e)}}function O(){const e=s().vec3f(P.POSITION).vec4f(P.PROFILERIGHT).vec4f(P.PROFILEUP).vec4f(P.PROFILEVERTEXANDNORMAL).vec4f(P.FEATUREVALUE);return l()&&e.vec4u8(P.OBJECTANDLAYERIDCOLOR),e}class T extends f{beginSlot(e){return this.acquireTechnique(j,e)}}function E(e,t,r,i,s,a){e.baked.size&&e.baked.size[0]===t[0]&&e.baked.size[1]===t[1]||e.baked.bake(t),e.baked.intersect(r,i,s,a)}class M extends y{constructor(){super(...arguments),this.doubleSided=!1,this.doubleSidedType=\"normal\",this.castShadows=!0,this.hasSlicePlane=!1,this.transparent=!1,this.usePBR=!1}}export{M as Parameters,L as PathMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{freeze as e,create as r,ZEROS as t}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{isColorOrColorEmission as s,ShaderOutput as i}from\"../core/shaderLibrary/ShaderOutput.js\";import{PathVertexPositionPassParameters as l}from\"../core/shaderLibrary/attributes/PathVertexPosition.glsl.js\";import{NormalsDoubleSidedMode as o}from\"../core/shaderLibrary/shading/Normals.glsl.js\";import{ReloadableShaderModule as n}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as a}from\"../core/shaderTechnique/ShaderTechnique.js\";import{OITPass as u}from\"../lib/OITPass.js\";import{blending as m,oitDepthTest as c,getDrawBuffers as h,OITPolygonOffset as p}from\"../lib/OrderIndependentTransparency.js\";import{stencilWriteMaskOn as d,stencilBaseAllZerosParams as f}from\"../lib/StencilUtils.js\";import{VertexAttribute as b}from\"../lib/VertexAttribute.js\";import{advancedMRRFactors as O}from\"./pbrUtils.js\";import{P as j}from\"../../../../chunks/Path.glsl.js\";import{SpecialDrawBuffers as P}from\"../../../webgl/enums.js\";import{makePipelineState as g,frontFaceCullingParams as E,defaultDepthWrite as T,defaultColorWrite as x}from\"../../../webgl/renderState.js\";class N extends l{constructor(){super(...arguments),this.ambient=e(.2,.2,.2),this.diffuse=e(.8,.8,.8),this.specular=e(0,0,0),this.opacity=1,this.origin=r(),this.modelTransformation=null,this.mrrFactors=O,this.emissiveFactor=t,this.texture=null,this.textureNormal=null,this.textureEmissive=null,this.textureOcclusion=null,this.textureMetallicRoughness=null}}class R extends a{constructor(e,r,t){super(e,r,new n(j,(()=>import(/* webpackChunkName: \"shaders-Path.glsl\" */ \"../shaders/Path.glsl.js\"))),t,L)}initializePipeline(e){const{output:r,transparent:t,hasSlicePlane:l,doubleSidedMode:n,hasOccludees:a,oitPass:b}=e,O=b===u.NONE,j=b===u.FrontFace;return g({blending:s(r)&&t?m(b):null,culling:l&&!t&&n!==o.None?E:null,depthTest:{func:c(b)},depthWrite:O||j?T:null,drawBuffers:r===i.Depth?{buffers:[P.NONE]}:h(b,r),colorWrite:x,stencilWrite:a?d:null,stencilTest:a?f:null,polygonOffset:O||j?null:p})}}const L=new Map([[b.POSITION,0],[b.PROFILERIGHT,1],[b.PROFILEUP,2],[b.PROFILEVERTEXANDNORMAL,3],[b.FEATUREVALUE,4],[b.OBJECTANDLAYERIDCOLOR,5]]);export{N as PathPassParameters,R as PathTechnique,L as vertexAttributeLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{TextureCoordinateType as t}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{EmissionSource as o}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{NormalsDoubleSidedMode as i}from\"../core/shaderLibrary/shading/Normals.glsl.js\";import{PBRMode as s}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{parameter as r}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{DefaultTechniqueConfiguration as a}from\"./DefaultTechniqueConfiguration.js\";class n extends a{constructor(e,r){super(),this.spherical=e,this.doublePrecisionRequiresObfuscation=r,this.pbrMode=s.Disabled,this.doubleSidedMode=i.None,this.emissionSource=o.None,this.receiveShadows=!1,this.receiveAmbientOcclusion=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=t.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.useCustomDTRExponentForWater=!1,this.useFillLights=!1,this.hasColorTexture=!1,this.objectAndLayerIdColorInstanced=!1,this.hasMetallicRoughnessTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1}get discardInvisibleFragments(){return this.transparent}}e([r({count:s.COUNT})],n.prototype,\"pbrMode\",void 0),e([r({count:i.COUNT})],n.prototype,\"doubleSidedMode\",void 0),e([r({count:o.COUNT})],n.prototype,\"emissionSource\",void 0),e([r()],n.prototype,\"receiveShadows\",void 0),e([r()],n.prototype,\"receiveAmbientOcclusion\",void 0),e([r()],n.prototype,\"vvSize\",void 0),e([r()],n.prototype,\"vvColor\",void 0),e([r()],n.prototype,\"vvOpacity\",void 0),e([r()],n.prototype,\"hasSlicePlane\",void 0),e([r()],n.prototype,\"transparent\",void 0),e([r()],n.prototype,\"hasOccludees\",void 0),e([r()],n.prototype,\"terrainDepthTest\",void 0),e([r()],n.prototype,\"cullAboveTerrain\",void 0);export{n as PathTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{fromValues as e}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{BufferViewMat3f as t,BufferViewVec4f as r}from\"../../../../geometry/support/buffer/BufferView.js\";import{newLayout as s}from\"../../support/buffer/InterleavedLayout.js\";import{isHighlightOrOID as i,isColor as o,isDepth as a,isColorHighlightOrOID as n}from\"../core/shaderLibrary/ShaderOutput.js\";import{alphaCutoff as f}from\"../core/shaderLibrary/util/AlphaCutoff.js\";import{olidEnabled as c}from\"../effects/geometry/olidUtils.js\";import{CullFaceOptions as l}from\"../lib/basicInterfaces.js\";import u from\"../lib/GLMaterial.js\";import{OITPolygonOffsetLimit as h}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as p}from\"../lib/RenderSlot.js\";import{assert as m}from\"../lib/Util.js\";import{VertexAttribute as d}from\"../lib/VertexAttribute.js\";import{DefaultBufferWriter as g}from\"./DefaultBufferWriter.js\";import{Style as A}from\"./PatternStyle.js\";import{TriangleMaterial as T}from\"./TriangleMaterial.js\";import{VisualVariablePassParameters as b}from\"./VisualVariablePassParameters.js\";import{writeDefaultAttributes as v,writeBufferVec4 as O}from\"./internal/bufferWriterUtils.js\";import{vertexAttributeLocationsOID as _,vertexAttributeLocations as j,PatternTechnique as C}from\"../shaders/PatternTechnique.js\";import{PatternTechniqueConfiguration as E}from\"../shaders/PatternTechniqueConfiguration.js\";class P extends T{constructor(e){super(e,I),this._configuration=new E,this.vertexAttributeLocations=c()?_:j,this.supportsEdges=!0,this.produces=new Map([[p.OPAQUE_MATERIAL,e=>i(e)],[p.TRANSPARENT_MATERIAL,e=>o(e)],[p.TRANSPARENT_MATERIAL_WITHOUT_NORMALS,e=>a(e)],[p.DRAPED_MATERIAL,e=>this.parameters.draped&&n(e)]])}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors&&!this.parameters.vvColor,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.style=this.parameters.style,this._configuration.draped=this.parameters.draped,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<h,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.vvColor=!!this.parameters.vvColor,this._configuration}get visible(){return this.parameters.color[3]>=f}createGLMaterial(e){return new R(e)}createBufferWriter(){const e=s().vec3f(d.POSITION).vec4f(d.UVMAPSPACE);return this.parameters.draped||e.mat3f(d.BOUNDINGRECT),this.parameters.vvColor?e.f32(d.COLORFEATUREATTRIBUTE):e.vec4u8(d.COLOR),c()&&e.vec4u8(d.OBJECTANDLAYERIDCOLOR),new y(e)}}class R extends u{beginSlot(e){return this.acquireTechnique(C,e)}}class y extends g{write(e,s,i,o,a,n){v(i,o,this.vertexBufferLayout,e,s,a,n);for(const f of this.vertexBufferLayout.fields.keys()){const s=i.get(f),o=s?.indices;if(s&&o)switch(f){case d.UVMAPSPACE:{m(4===s.size);const e=a.getField(f,r);e&&O(s,e,n);break}case d.BOUNDINGRECT:{m(9===s.size);const r=a.getField(f,t);r&&L(s,e,r,n);break}}}}}function L(e,t,r,s){const{data:i,indices:o}=e,a=t,n=r.typedBuffer,f=r.typedBufferStride,c=o.length;s*=f;for(let l=0;l<c;++l){const e=9*o[l],t=i[e],r=i[e+1],c=i[e+2];n[s]=a[0]*t+a[4]*r+a[8]*c+a[12],n[s+1]=a[1]*t+a[5]*r+a[9]*c+a[13],n[s+2]=a[2]*t+a[6]*r+a[10]*c+a[14];for(let o=3;o<9;++o)n[s+o]=i[e+o];s+=f}}class I extends b{constructor(){super(...arguments),this.color=e(1,1,1,1),this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=l.None,this.hasOccludees=!1,this.style=A.Cross,this.draped=!0}}export{I as Parameters,P as PatternMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nvar a;!function(a){a[a.Horizontal=0]=\"Horizontal\",a[a.Vertical=1]=\"Vertical\",a[a.Cross=2]=\"Cross\",a[a.ForwardDiagonal=3]=\"ForwardDiagonal\",a[a.BackwardDiagonal=4]=\"BackwardDiagonal\",a[a.DiagonalCross=5]=\"DiagonalCross\",a[a.COUNT=6]=\"COUNT\"}(a||(a={}));export{a as Style};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(){this.factor=new c,this.factorAlignment=new c}}class c{constructor(){this.scale=0,this.factor=0,this.minScaleFactor=0}}export{c as ScaleFactor,t as ScaleInfo};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{Material as r}from\"../lib/Material.js\";import{intersectTriangleGeometry as t}from\"../lib/RayIntersections.js\";class e extends r{intersect(r,e,i,s,o,n){return t(r,i,s,o,void 0,n)}}export{e as TriangleMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../lib/GLMaterial.js\";import{WaterTechnique as t}from\"./WaterTechnique.js\";class r extends e{ensureResources(e){return this._techniques.context.waterTextures.ensureResources(e)}beginSlot(e){const r=this._techniques.context.waterTextures.passParameters;return this._material.setParameters({wavePerturbation:r.wavePerturbation,waveNormal:r.waveNormal}),this.acquireTechnique(t,e)}}export{r as WaterGLMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{secondsFromMilliseconds as t}from\"../../../../core/time.js\";import{fromValues as e}from\"../../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{create as r}from\"../../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{fromValues as i}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{isColor as a,isHighlightOrOID as s,ShaderOutput as o}from\"../core/shaderLibrary/ShaderOutput.js\";import{olidEnabled as n}from\"../effects/geometry/olidUtils.js\";import{MaterialParameters as l}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as c}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as m}from\"../lib/RenderSlot.js\";import{DefaultBufferWriter as h}from\"./DefaultBufferWriter.js\";import{PositionUVLayoutObjectAndLayerId as f,PositionUVLayout as p}from\"./DefaultLayouts.js\";import{TriangleMaterial as u}from\"./TriangleMaterial.js\";import{WaterGLMaterial as d}from\"./WaterGLMaterial.js\";import{WaterTechniqueConfiguration as g}from\"./WaterTechniqueConfiguration.js\";class _ extends u{constructor(t,e){super(t,v),this.produces=new Map([[m.OPAQUE_MATERIAL,t=>a(t)&&!this.parameters.transparent||s(t)],[m.TRANSPARENT_MATERIAL,t=>a(t)&&this.parameters.transparent||s(t)],[m.DRAPED_MATERIAL,t=>this.parameters.draped&&t===o.Color||s(t)],[m.DRAPED_WATER,t=>t===o.Normal]]),this._configuration=new g(e.spherical,e.doublePrecisionRequiresObfuscation)}getConfiguration(t,e){return this._configuration.output=t,this._configuration.writeDepth=!0,this._configuration.receiveShadows=e.shadowMap.enabled,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.screenSpaceReflections=null!=e.ssr.lastFrameColor,this._configuration.cloudReflections=null!=e.clouds.data,this._configuration.draped=this.parameters.draped,this._configuration.oitPass=e.oitPass,this._configuration.enableOffset=e.camera.relativeElevation<c,this._configuration.terrainDepthTest=e.terrainDepthTest,this._configuration.cullAboveTerrain=e.cullAboveTerrain,this._configuration}get visible(){return!0}update(e){return this.setParameters({timeElapsed:t(e.time)*this.parameters.animationSpeed},!1),this._animationEnabled(e.camera)&&e.dt>0}_animationEnabled(t){const e=Math.min(t.relativeElevation,t.distance);return Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*e<b}createGLMaterial(t){return new d(t)}createBufferWriter(){return new h(n()?f:p)}get test(){}}class v extends l{constructor(){super(...arguments),this.waveStrength=.06,this.waveTextureRepeat=32,this.waveDirection=e(1,0),this.waveVelocity=.05,this.flowStrength=.015,this.flowOffset=-.5,this.animationSpeed=.35,this.timeElapsed=0,this.color=i(0,0,0,0),this.transparent=!0,this.hasSlicePlane=!1,this.draped=!1,this.origin=r(),this.modelTransformation=null}}const b=35e3;export{v as Parameters,_ as WaterMaterial};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as r}from\"../core/shaderLibrary/ShaderOutput.js\";import{WaterDistortionPassParameters as e}from\"../core/shaderLibrary/shading/WaterDistortion.glsl.js\";import{ReloadableShaderModule as t}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as s}from\"../core/shaderTechnique/ShaderTechnique.js\";import{OITPass as o}from\"../lib/OITPass.js\";import{blending as a,oitDepthTest as n,depthWrite as i,getDrawBuffers as l,getOITPolygonOffset as d}from\"../lib/OrderIndependentTransparency.js\";import{W as p}from\"../../../../chunks/WaterSurface.glsl.js\";import{makePipelineState as c,defaultColorWrite as u}from\"../../../webgl/renderState.js\";class m extends e{}class f extends s{constructor(r,e,s){super(r,e,new t(p,(()=>import(/* webpackChunkName: \"shaders-WaterSurface.glsl\" */ \"../shaders/WaterSurface.glsl.js\"))),s)}initializePipeline(e){const{oitPass:t,output:s,transparent:p,draped:m,enableOffset:f}=e,h=t===o.NONE,j=t===o.FrontFace;return c({blending:s!==r.Normal&&s!==r.Highlight&&s!==r.ObjectAndLayerIdColor&&p?a(t):null,depthTest:m?null:{func:n(t)},depthWrite:i(e),drawBuffers:l(t,s),colorWrite:u,polygonOffset:h||j?null:d(f)})}}export{m as WaterMaterialPassParameters,f as WaterTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{TextureCoordinateType as t}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{EmissionSource as o}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{PBRMode as r}from\"../core/shaderLibrary/shading/PhysicallyBasedRenderingParameters.glsl.js\";import{parameter as i}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{DefaultTechniqueConfiguration as s}from\"./DefaultTechniqueConfiguration.js\";class a extends s{constructor(e,i){super(),this.spherical=e,this.doublePrecisionRequiresObfuscation=i,this.receiveShadows=!1,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.screenSpaceReflections=!1,this.cloudReflections=!1,this.objectAndLayerIdColorInstanced=!1,this.draped=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=t.None,this.emissionSource=o.None,this.pbrMode=r.Water,this.occlusionPass=!1,this.useCustomDTRExponentForWater=!0,this.highStepCount=!0,this.useFillLights=!1}get discardInvisibleFragments(){return this.transparent&&this.writeDepth}}e([i()],a.prototype,\"receiveShadows\",void 0),e([i()],a.prototype,\"hasSlicePlane\",void 0),e([i()],a.prototype,\"transparent\",void 0),e([i()],a.prototype,\"enableOffset\",void 0),e([i()],a.prototype,\"writeDepth\",void 0),e([i()],a.prototype,\"screenSpaceReflections\",void 0),e([i()],a.prototype,\"cloudReflections\",void 0),e([i()],a.prototype,\"objectAndLayerIdColorInstanced\",void 0),e([i()],a.prototype,\"draped\",void 0),e([i()],a.prototype,\"terrainDepthTest\",void 0),e([i()],a.prototype,\"cullAboveTerrain\",void 0);export{a as WaterTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst e={\"calm-small\":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},\"rippled-small\":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},\"slight-small\":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},\"moderate-small\":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},\"calm-medium\":{waveStrength:.003125,perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},\"rippled-medium\":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},\"slight-medium\":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},\"moderate-medium\":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},\"calm-large\":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},\"rippled-large\":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,waveVelocity:.11},\"slight-large\":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},\"moderate-large\":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}};export{e as wavePresets};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nconst t={dash:[4,3],dot:[1,3],\"long-dash\":[8,3],\"short-dash\":[4,1],\"short-dot\":[1,1]},o={dash:t.dash,\"dash-dot\":[...t.dash,...t.dot],dot:t.dot,\"long-dash\":t[\"long-dash\"],\"long-dash-dot\":[...t[\"long-dash\"],...t.dot],\"long-dash-dot-dot\":[...t[\"long-dash\"],...t.dot,...t.dot],none:null,\"short-dash\":t[\"short-dash\"],\"short-dash-dot\":[...t[\"short-dash\"],...t[\"short-dot\"]],\"short-dash-dot-dot\":[...t[\"short-dash\"],...t[\"short-dot\"],...t[\"short-dot\"]],\"short-dot\":t[\"short-dot\"],solid:null},d=8;function s(t,o){return null==t?t:{pattern:t.slice(),pixelRatio:o}}function h(t){return{pattern:[t,t],pixelRatio:2}}function n(t){return\"style\"===t?.type?l(t.style):null}function l(t){return null!=t?s(o[t],d):null}export{h as createStipplePatternSimple,n as getStipplePatternForLinePattern,l as getStipplePatternForPatternStyle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(t=0,o=0){this.from=t,this.to=o}get numElements(){return this.to-this.from}}function o(t){const o=new Map;t.forAll((t=>o.set(t.from,t)));let e=!0;for(;e;){e=!1;for(let r=0;r<t.length;++r){const n=t.data[r],s=o.get(n.to);if(!s)return;n.to=s.to,o.delete(s.from),t.removeUnordered(s),e=!0}}}export{t as BufferRange,o as mergeAdjacentRanges};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(){this.first=0,this.count=0}}export{t as DrawCommand};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{BufferRange as e}from\"./BufferRange.js\";class i extends e{constructor(e,i,s){super(i,s),this.geometry=e}get isVisible(){return this.geometry.visible}get hasHighlights(){return this.isVisible&&this.geometry.hasHighlights}foreachHighlightGroup(e){this.isVisible&&this.geometry.foreachHighlightGroup(e)}get hasOccludees(){return null!=this.geometry.occludees}}export{i as Instance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{removeUnordered as t,filterInPlace as r}from\"../../../../../core/arrayUtils.js\";import\"../../../../../core/has.js\";import{nextHighestPowerOfTwo as i}from\"../../../../../core/mathUtils.js\";import{disposeMaybe as s}from\"../../../../../core/maybe.js\";import{NestedMap as o}from\"../../../../../core/NestedMap.js\";import a from\"../../../../../core/PooledArray.js\";import{addMany as n}from\"../../../../../core/SetUtils.js\";import{property as l}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/Logger.js\";import{subclass as u}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{copy as h,invert as f,transpose as c}from\"../../../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as m}from\"../../../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{glLayout as d}from\"../../../support/buffer/glUtil.js\";import{ShaderOutput as g}from\"../../core/shaderLibrary/ShaderOutput.js\";import{SyncRenderPlugin as p}from\"../../effects/RenderPlugin.js\";import{GLMaterials as y}from\"../../lib/GLMaterials.js\";import{DirtyState as _}from\"../../lib/ModelDirtyTypes.js\";import{RenderSlot as b}from\"../../lib/RenderSlot.js\";import{assert as w}from\"../../lib/Util.js\";import{DrawParameters as v}from\"../DrawParameters.js\";import{BufferRange as C,mergeAdjacentRanges as O}from\"./BufferRange.js\";import{Instance as A}from\"./Instance.js\";import{PerBufferData as E,hasVao as B}from\"./PerBufferData.js\";import{PerOriginData as S}from\"./PerOriginData.js\";let x=class extends p{get _hasAnyHighlight(){return this._highlightGroups.size>0}constructor(e){super(e),this._dataByOrigin=new Map,this._drawParameters=new v,this._highlightGroups=new Set,this.drapedPriority=0,this._produces=new Map,this._hasOccludees=!1}destroy(){this._glMaterials=s(this._glMaterials),this._dataByOrigin.forEach((e=>e.dispose())),this._dataByOrigin.clear(),this._vaoCache=null}initialize(){this.material.produces.forEach(((e,t)=>{this._produces.set(t,(t=>!(0===this._dataByOrigin.size||!(t!==g.Highlight&&t!==g.ShadowHighlight||this._hasAnyHighlight))&&e(t)))}))}initializeRenderContext(e,t){this._glMaterials=new y(this.material,t??e.materials),this._bufferWriter=this.material.createBufferWriter(),this._vaoCache=e.renderContext.rctx.getVaoCache(this.material.vertexAttributeLocations,d(this._bufferWriter.vertexBufferLayout))}uninitializeRenderContext(){}get produces(){return this._produces}get hasOccludees(){return this._hasOccludees}get hasEmissions(){return this.material.hasEmissions}get isDecoration(){return this.material.parameters.isDecoration}queryRenderOccludedState(e){return this.material.queryRenderOccludedState(e)}get numGeometries(){let e=0;return this._dataByOrigin.forEach((t=>e+=t.buffers.reduce(((e,t)=>e+t.instances.size),0))),e}get usedMemory(){let e=0;return this._dataByOrigin.forEach((t=>e+=t.buffers.reduce(((e,t)=>e+t.vao.usedMemory),0))),e}forEachGeometry(e){this._dataByOrigin.forEach((t=>t.buffers.forEach((t=>t.instances.forEach((({geometry:t})=>e(t)))))))}modify(e){this._updateGeometries(e.updates),this._addAndRemoveGeometries(e.adds,e.removes),this._updateDrawCommands()}_updateGeometries(e){const t=this._bufferWriter;if(null==t)return;const r=t.vertexBufferLayout.stride/4;for(const i of e){const e=i.renderGeometry,s=this._dataByOrigin.get(e.localOrigin.id),o=s?.findBuffer(e.id);if(null==o)return;const a=o.instances.get(e.id);if(i.updateType&(_.GEOMETRY|_.TRANSFORMATION)){const i=W(t.elementCount(a.geometry.geometry.attributes)*r),s=t.vertexBufferLayout.createView(i.buffer);this._writeGeometry(e,s,0),o.vao.vertexBuffers.get(\"geometry\").setSubData(i,a.from*r,0,a.numElements*r)}i.updateType&(_.HIGHLIGHT|_.OCCLUDEE|_.VISIBILITY)&&(o.drawCommandsDirty=!0)}}_computeDeltas(e,t){const r=new o;for(const i of e){const e=i.localOrigin;if(null==e)continue;let t=r.get(e.id,null);null==t&&(t=new D(e.vec3),r.set(e.id,null,t)),t.changes.push(i)}for(const i of t){const e=i.localOrigin;if(null==e)continue;const t=this._dataByOrigin.get(e.id),s=t?.findBuffer(i.id);if(null==s)continue;let o=r.get(e.id,s);null==o&&(o=new D(e.vec3),r.set(e.id,s,o)),o.changes.push(i)}return r}_addAndRemoveGeometries(e,r){if(null==this._bufferWriter||null==this._vaoCache)return;const{_bufferWriter:i,_dataByOrigin:s}=this,o=i.vertexBufferLayout.stride/4,a=this._computeDeltas(e,r);a.forEach(((e,r)=>{const n=e.get(null),l=n?.changes??[];a.delete(r,null);let u=s.get(r);if(e.forEach(((e,n)=>{if(a.delete(r,n),null==n)return void w(!1,\"No VAO for removed geometries\");if(n.instances.size===e.changes.length)return this._vaoCache.deleteVao(n.vao),t(u.buffers,n),void(0===u.buffers.length&&0===l.length&&s.delete(r));const h=n.numElements,f=n.vao.byteSize/4,c=l.reduce(((e,t)=>e+i.elementCount(t.geometry.attributes)),0),m=e.changes.reduce(((e,t)=>e+i.elementCount(t.geometry.attributes)),0),d=Math.min((h+c-m)*o,z),g=d>f;d>H&&d<f/2?(e.changes.forEach((({id:e})=>n.deleteInstance(e))),n.instances.forEach((({geometry:e})=>l.push(e))),this._vaoCache.deleteVao(n.vao),t(u.buffers,n)):g?this._applyAndRebuild(n,l,e):this._applyRemoves(n,e)})),l.length>0)for(null==u&&(u=new S(n.origin),s.set(r,u)),u.buffers.forEach((e=>this._applyAdds(e,l)));l.length>0;)u.buffers.push(this._applyAndRebuild(new E,l,null))}))}_updateDrawCommands(){this._highlightGroups.clear(),this._hasOccludees=!1,this._dataByOrigin.forEach((e=>{e.buffers.forEach((e=>{e.updateIfDrawCommandsDirty(this._bufferWriter.vertexBufferLayout.stride),e.hasHighlights&&n(this._highlightGroups,e.highlightGroups),this._hasOccludees=this._hasOccludees||e.hasOccludees}))}))}_applyAndRebuild(e,t,r){if(r)for(const m of r.changes)e.deleteInstance(m.id);const i=this._bufferWriter,s=i.vertexBufferLayout.stride,o=s/4,a=Math.floor(z/o);let n=e.numElements;for(;t.length>0;){const r=t.pop(),s=i.elementCount(r.geometry.attributes);if(n+s>a&&n>0){t.push(r);break}n+=s;const o=new A(r,0,0);w(null==e.instances.get(r.id)),e.addInstance(r.id,o)}const l=n*o,u=W(l),h=i.vertexBufferLayout.createView(u.buffer);let f=0;e.resetInstanceSummary(),e.instances.forEach(((t,r)=>{this._writeGeometry(t.geometry,h,f);const s=f;f+=i.elementCount(t.geometry.geometry.attributes),e.updateInstance(r,s,f),e.updateDrawState(t)})),this._vaoCache.deleteVao(e.vao),e.vao=this._vaoCache.newVao(V(l)),e.vao.vertexBuffers.get(\"geometry\").setSubData(u,0,0,f*o),e.holes.clear();const c=e.holes.pushNew();return c.from=f,c.to=Math.floor(e.vao.byteSize/s),e.updateDrawCommands(s),e}_applyRemoves(e,t){if(0===t.changes.length||null==this._bufferWriter)return;for(const a of t.changes){const t=a.id,r=e.instances.get(t);if(!r)continue;e.deleteInstance(t);const i=G.back();if(i){if(i.to===r.from){i.to=r.to;continue}if(i.from===r.to){i.from=r.from;continue}}const s=G.pushNew();s.from=r.from,s.to=r.to}O(G);const r=this._bufferWriter.vertexBufferLayout.stride/4,i=G.reduce(((e,t)=>Math.max(e,t.numElements)),0)*r,s=W(i);s.fill(0,0,i);const o=e.vao.vertexBuffers.get(\"geometry\");G.forAll((e=>o.setSubData(s,e.from*r,0,e.numElements*r))),e.holes.pushArray(G.data,G.length),G.forAll(((e,t)=>G.data[t]=null)),G.clear(),e.drawCommandsDirty=!0}_applyAdds(e,t){if(0===t.length||null==this._bufferWriter)return;if(!B(e))return void this._applyAndRebuild(e,t,null);const i=this._bufferWriter,s=i.vertexBufferLayout.stride/4,o=e.numElements,a=t.reduce(((e,t)=>e+i.elementCount(t.geometry.attributes)),0),n=Math.min((o+a)*s,z),l=4*n;if(e.vao.byteSize<V(z-H)&&l>e.vao.byteSize)return void this._applyAndRebuild(e,t,null);O(e.holes);const u=new Array;for(const r of t){const t=i.elementCount(r.geometry.attributes),s=R(e.holes,t);u.push(s)}const h=e.vao.vertexBuffers.get(\"geometry\");let f=0,c=0,m=0;const d=W(n),g=i.vertexBufferLayout.createView(d.buffer);t.forEach(((t,r)=>{const o=u[r];if(null==o)return;if(!(m===o)){const e=m-c;e>0&&h.setSubData(d,c*s,0,e*s),c=o,f=0}const a=i.elementCount(t.geometry.attributes);this._writeGeometry(t,g,f),f+=a,m=o+a;const n=new A(t,o,o+a);w(null==e.instances.get(t.id)),e.addInstance(t.id,n),e.drawCommandsDirty=!0}));const p=m-c;p>0&&h.setSubData(d,c*s,0,p*s),r(t,((e,t)=>null==u[t]))}_writeGeometry(e,t,r){null!=this._bufferWriter&&(h(j,e.transformation),j[12]-=e.localOrigin.vec3[0],j[13]-=e.localOrigin.vec3[1],j[14]-=e.localOrigin.vec3[2],f(M,j),c(M,M),this._bufferWriter.write(j,M,e.geometry.attributes,e.geometry.objectAndLayerIdColor,t,r))}updateAnimation(e){return this.material.update(e)}acquireTechniques(e){if(!this.material.shouldRender(e))return null;const{output:t,bind:r}=e,i=this.material.produces.get(r.slot);if(!i?.(t))return null;const{highlightGroupName:s,slot:o}=r,a=t===g.ShadowHighlight,n=t===g.Highlight,l=n||a,u=e=>l&&(0===this._highlightGroups.size||n&&!!s&&!e.has(s));if(u(this._highlightGroups))return null;const h=t===g.ShadowExcludeHighlight,f=!(l||h);for(const{buffers:c}of this._dataByOrigin.values())for(const i of c){if(u(i.highlightGroups))continue;const n=a?i.drawCommandsHighlights.size>0:l?s?i.drawCommandsHighlights.get(s):i.drawCommandsHighlights.size>0:((h&&i.needsMultipleCommands()?i.drawCommandsShadowHighlightRest:i.drawCommandsDefault)||null)?.length??!1,c=f&&i.drawCommandsOccludees||null;if(n||c?.length){const i=this._glMaterials.load(e.rctx,o,t),s=i?.beginSlot(r);if(s)return s}}return null}render(e,t){const{output:r,bind:i}=e,{slot:s,highlightGroupName:o}=i,a=r===g.Highlight;if(a&&!o)return;const n=r===g.ShadowHighlight,l=a||n,u=r===g.ShadowExcludeHighlight,h=!(l||u),f=s===b.OCCLUDER_MATERIAL||s===b.TRANSPARENT_OCCLUDER_MATERIAL?s:null,{rctx:c}=e;c.runAppleAmdDriverHelper();const m=c.bindTechnique(t,i,this.material.parameters);for(const d of this._dataByOrigin.values())for(const e of d.buffers){if(a&&(!e.hasHighlights||!e.drawCommandsHighlights.has(o)))continue;if(n&&!e.hasHighlights)continue;const r=()=>{const t=[];for(const r of e.drawCommandsHighlights.values())t.push(r);return t},s=l&&!n?e.drawCommandsHighlights.get(o)??null:null,g=n?r():l?s?[s]:N:(u&&e.needsMultipleCommands()?[e.drawCommandsShadowHighlightRest]:[e.drawCommandsDefault])||N,p=g.some((e=>e.length>0)),y=h&&e.drawCommandsOccludees||null;if(p||y?.length){if(this._drawParameters.origin=d.origin,m.bindDraw(i,this.material.parameters,this._drawParameters),t.ensureAttributeLocations(e.vao),c.bindVAO(e.vao),p)for(const e of g)c.setPipelineState(t.getPipeline(!1,f)),e.forAll((e=>c.drawArrays(t.primitiveType,e.first,e.count)));y?.length&&(c.setPipelineState(t.getPipeline(!0,f)),y.forAll((e=>c.drawArrays(t.primitiveType,e.first,e.count))))}}}get test(){}};e([l({constructOnly:!0})],x.prototype,\"material\",void 0),x=e([u(\"esri.views.3d.webgl-engine.materials.renderers.MergedRenderer\")],x);class D{constructor(e){this.origin=e,this.changes=new Array}}function R(e,t){const r=e.find((e=>e.numElements>=t));if(null==r)return null;const i=r.from;return r.from+=t,r.from>=r.to&&e.removeUnordered(r),i}const j=m(),M=m(),G=new a({allocator:e=>e||new C,deallocator:null}),H=65536,L=4*H,I=1024,T=16777216,z=T/4;let P=new Float32Array(H);function W(e){return P.length<e&&(P=new Float32Array(e)),P}function V(e){const t=4*e;return t<=I?I:t<L?i(t):Math.max(Math.min(Math.ceil(1.5*t/L)*L,T),t)}const N=[];export{x as MergedRenderer,V as sizeForVao};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport s from\"../../../../../core/PooledArray.js\";import{BufferRange as t}from\"./BufferRange.js\";import{DrawCommand as e}from\"./DrawCommand.js\";class n{constructor(){this._numElements=0,this._instances=new Map,this.holes=new s({allocator:s=>s||new t,deallocator:null}),this.hasHiddenInstances=!1,this.hasOccludees=!1,this.drawCommandsDirty=!0,this.highlightGroups=new Set,this.drawCommandsDefault=h(),this.drawCommandsHighlights=new Map,this.drawCommandsOccludees=h(),this.drawCommandsShadowHighlightRest=h()}get numElements(){return this._numElements}get instances(){return this._instances}get hasHighlights(){return this.highlightGroups.size>0}resetInstanceSummary(){this.hasHiddenInstances=!1,this.hasOccludees=!1,this.highlightGroups.clear()}updateIfDrawCommandsDirty(s){if(this.drawCommandsDirty){this.resetInstanceSummary();for(const s of this.instances.values())this.updateDrawState(s);this.updateDrawCommands(s)}}addInstance(s,t){this.deleteInstance(s),this._instances.set(s,t),this._numElements+=t.numElements}deleteInstance(s){const t=this._instances.get(s);t&&(this._numElements-=t.numElements,this._instances.delete(s))}updateInstance(s,t,e){const n=this._instances.get(s);n&&(this._numElements-=n.numElements,n.from=t,n.to=e,this._numElements+=n.numElements)}updateDrawState(s){s.isVisible?(s.foreachHighlightGroup((s=>this.highlightGroups.add(s))),s.hasOccludees&&(this.hasOccludees=!0)):this.hasHiddenInstances=!0}updateDrawCommands(s){if(this.drawCommandsDefault.clear(),this.drawCommandsHighlights.clear(),this.drawCommandsOccludees.clear(),this.drawCommandsShadowHighlightRest.clear(),this.drawCommandsDirty=!1,0===this._instances.size)return;if(!this.needsMultipleCommands()){const t=this.drawCommandsDefault.pushNew(),e=this.holes.front();return null!=this.vao&&1===this.holes.length&&e.to===Math.floor(this.vao.byteSize/s)?(t.first=0,void(t.count=e.from)):(t.first=1/0,t.count=0,this._instances.forEach((s=>{t.first=Math.min(t.first,s.from),t.count=Math.max(t.count,s.to)})),void(t.count-=t.first))}const t=Array.from(this._instances.values()).sort(((s,t)=>s.from===t.from?s.to-t.to:s.from-t.from)),{drawCommandsHighlights:e}=this;for(const n of t)n.isVisible&&(o(n.hasOccludees?this.drawCommandsOccludees:this.drawCommandsDefault,n),n.hasHighlights?n.foreachHighlightGroup((s=>{let t=e.get(s);t||(t=h(),e.set(s,t)),o(t,n)})):o(this.drawCommandsShadowHighlightRest,n))}needsMultipleCommands(){return this.hasOccludees||this.hasHighlights||this.hasHiddenInstances}}class i extends n{}function a(s){return null!=s.vao}function h(){return new s({allocator:s=>s||new e,deallocator:s=>s})}function o(s,t){const e=s.back();if(null==e){const e=s.pushNew();return e.first=t.from,void(e.count=t.numElements)}if(r(e,t)){const s=t.from-e.first+t.numElements;e.count=s}else{const e=s.pushNew();e.first=t.from,e.count=t.numElements}}function r(s,t){return s.first+s.count>=t.from}export{n as PerBufferData,i as PerVaoData,a as hasVao};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass s{constructor(s){this.origin=s,this.buffers=new Array}dispose(){this.buffers.forEach((s=>s.vao.dispose())),this.buffers.length=0}findBuffer(s){return this.buffers.find((r=>r.instances.has(s)))}}export{s as PerOriginData};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ZEROS as e}from\"../../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{ShaderOutput as r}from\"../core/shaderLibrary/ShaderOutput.js\";import{ReloadableShaderModule as t}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as s}from\"../core/shaderTechnique/ShaderTechnique.js\";import{OITPass as i}from\"../lib/OITPass.js\";import{blending as l,oitDepthTest as o,depthWrite as n,getDrawBuffers as a,getOITPolygonOffset as c}from\"../lib/OrderIndependentTransparency.js\";import{stencilWriteMaskOn as p,stencilToolMaskBaseParams as u,stencilBaseAllZerosParams as m}from\"../lib/StencilUtils.js\";import{VisualVariablePassParameters as f}from\"../materials/VisualVariablePassParameters.js\";import{C as d}from\"../../../../chunks/ColorMaterial.glsl.js\";import{SpecialDrawBuffers as h}from\"../../../webgl/enums.js\";import{makePipelineState as b,cullingParams as j,defaultColorWrite as P}from\"../../../webgl/renderState.js\";class g extends f{constructor(){super(...arguments),this.color=e}}class O extends s{constructor(e,r,s){super(e,r,new t(d,(()=>import(/* webpackChunkName: \"ColorMaterial.glsl\" */ \"./ColorMaterial.glsl.js\"))),s)}_createPipeline(e,t){const{oitPass:s,output:f,transparent:d,cullFace:g,draped:O,hasOccludees:T,polygonOffset:_,enableOffset:w}=e,x=s===i.NONE,y=s===i.FrontFace;return b({blending:f===r.Color&&d?l(s):null,culling:j(g),depthTest:O?null:{func:o(s)},depthWrite:n(e),drawBuffers:f===r.Depth?{buffers:[h.NONE]}:a(s,f),colorWrite:P,stencilWrite:T?p:null,stencilTest:T?t?u:m:null,polygonOffset:x||y?_?S:null:c(w)})}initializePipeline(e){return this._occludeePipelineState=this._createPipeline(e,!0),this._createPipeline(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const S={factor:1,units:1};export{g as ColorMaterialPassParameters,O as ColorMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{TextureCoordinateType as e}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{EmissionSource as o}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{parameter as r}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{CullFaceOptions as s}from\"../lib/basicInterfaces.js\";import{DefaultTechniqueConfiguration as i}from\"../materials/DefaultTechniqueConfiguration.js\";class a extends i{constructor(){super(...arguments),this.cullFace=s.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.discardInvisibleFragments=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.objectAndLayerIdColorInstanced=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=e.None,this.emissionSource=o.None,this.occlusionPass=!1,this.hasVvInstancing=!0,this.vvSize=!1,this.vvOpacity=!1}}t([r({count:s.COUNT})],a.prototype,\"cullFace\",void 0),t([r()],a.prototype,\"hasSlicePlane\",void 0),t([r()],a.prototype,\"hasVertexColors\",void 0),t([r()],a.prototype,\"transparent\",void 0),t([r()],a.prototype,\"discardInvisibleFragments\",void 0),t([r()],a.prototype,\"polygonOffset\",void 0),t([r()],a.prototype,\"enableOffset\",void 0),t([r()],a.prototype,\"writeDepth\",void 0),t([r()],a.prototype,\"hasOccludees\",void 0),t([r()],a.prototype,\"terrainDepthTest\",void 0),t([r()],a.prototype,\"cullAboveTerrain\",void 0),t([r()],a.prototype,\"objectAndLayerIdColorInstanced\",void 0),t([r()],a.prototype,\"vvColor\",void 0),t([r()],a.prototype,\"draped\",void 0);export{a as ColorMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{ReloadableShaderModule as r}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as o}from\"../core/shaderTechnique/ShaderTechnique.js\";import{OITPass as t}from\"../lib/OITPass.js\";import{oitBlending as s,getDrawBuffers as i}from\"../lib/OrderIndependentTransparency.js\";import{H as l}from\"../../../../chunks/HUDMaterial.glsl.js\";import{PrimitiveType as n,CompareFunction as a}from\"../../../webgl/enums.js\";import{defaultDepthWrite as p,makePipelineState as d,blendWithPremultipliedAlpha as u,defaultColorWrite as m}from\"../../../webgl/renderState.js\";class c extends o{constructor(e,o,t){super(e,o,new r(l,(()=>import(/* webpackChunkName: \"HUDMaterial.glsl\" */ \"./HUDMaterial.glsl.js\"))),t),this.primitiveType=o.occlusionPass?n.POINTS:n.TRIANGLES}initializePipeline(r){const{oitPass:o,hasPolygonOffset:l,draped:n,output:c,depthTestEnabled:f}=r,T=o===t.NONE,g=l?h:null,j=o===t.ColorAlpha,b=n||!f||j||c===e.Highlight?null:p;return d({blending:c===e.Color?T?u:s(o):null,depthTest:f&&!n?{func:a.LEQUAL}:null,depthWrite:b,drawBuffers:i(o,c),colorWrite:m,polygonOffset:g})}}const h={factor:0,units:-4};export{c as HUDMaterialTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{TextureCoordinateType as t}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{EmissionSource as o}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{parameter as i}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{DefaultTechniqueConfiguration as s}from\"../materials/DefaultTechniqueConfiguration.js\";class r extends s{constructor(e){super(),this.spherical=e,this.screenCenterOffsetUnitsEnabled=!1,this.occlusionTestEnabled=!0,this.signedDistanceFieldEnabled=!1,this.sampleSignedDistanceFieldTexelCenter=!1,this.vvSize=!1,this.vvColor=!1,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.hasRotation=!1,this.debugDrawLabelBorder=!1,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.depthTestEnabled=!0,this.pixelSnappingEnabled=!0,this.draped=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.occlusionPass=!1,this.occludedFragmentFade=!1,this.objectAndLayerIdColorInstanced=!1,this.horizonCullingEnabled=!0,this.textureCoordinateType=t.None,this.emissionSource=o.None,this.discardInvisibleFragments=!0,this.hasSliceInVertexProgram=!0,this.hasVvInstancing=!1}}e([i()],r.prototype,\"screenCenterOffsetUnitsEnabled\",void 0),e([i()],r.prototype,\"occlusionTestEnabled\",void 0),e([i()],r.prototype,\"signedDistanceFieldEnabled\",void 0),e([i()],r.prototype,\"sampleSignedDistanceFieldTexelCenter\",void 0),e([i()],r.prototype,\"vvSize\",void 0),e([i()],r.prototype,\"vvColor\",void 0),e([i()],r.prototype,\"hasVerticalOffset\",void 0),e([i()],r.prototype,\"hasScreenSizePerspective\",void 0),e([i()],r.prototype,\"hasRotation\",void 0),e([i()],r.prototype,\"debugDrawLabelBorder\",void 0),e([i()],r.prototype,\"hasSlicePlane\",void 0),e([i()],r.prototype,\"hasPolygonOffset\",void 0),e([i()],r.prototype,\"depthTestEnabled\",void 0),e([i()],r.prototype,\"pixelSnappingEnabled\",void 0),e([i()],r.prototype,\"draped\",void 0),e([i()],r.prototype,\"terrainDepthTest\",void 0),e([i()],r.prototype,\"cullAboveTerrain\",void 0),e([i()],r.prototype,\"occlusionPass\",void 0),e([i()],r.prototype,\"occludedFragmentFade\",void 0),e([i()],r.prototype,\"objectAndLayerIdColorInstanced\",void 0),e([i()],r.prototype,\"horizonCullingEnabled\",void 0);export{r as HUDMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as t}from\"../core/shaderTechnique/ShaderTechnique.js\";import{blending as r,oitDepthTest as l,depthWrite as n,getDrawBuffers as s}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as o}from\"../lib/RenderSlot.js\";import{stencilWriteMaskOn as p,stencilToolMaskBaseParams as c,stencilBaseAllZerosParams as u,depthCompareAlways as a,stencilToolTransparentOccluderParams as d,stencilWriteMaskOff as T,stencilToolMaskOccluderParams as h,depthCompareLess as m}from\"../lib/StencilUtils.js\";import{VertexAttribute as P}from\"../lib/VertexAttribute.js\";import{L as f}from\"../../../../chunks/LineMarker.glsl.js\";import{LineMarkerSpace as O}from\"./LineMarkerTechniqueConfiguration.js\";import{SpecialDrawBuffers as E}from\"../../../webgl/enums.js\";import{makePipelineState as R,defaultColorWrite as _,premultipliedAlphaToPremultipliedAlpha as S}from\"../../../webgl/renderState.js\";class A extends t{constructor(e,t,r){super(e,t,new i(f,(()=>import(/* webpackChunkName: \"LineMarker.glsl\" */ \"./LineMarker.glsl.js\"))),r,W)}_makePipelineState(i,t){const{output:o,oitPass:a,space:d,hasOccludees:T}=i;return R({blending:o===e.Color?r(a):null,depthTest:d===O.Draped?null:{func:l(a)},depthWrite:n(i),drawBuffers:o===e.Depth?{buffers:[E.NONE]}:s(a,o),colorWrite:_,stencilWrite:T?p:null,stencilTest:T?t?c:u:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(e){return e.occluder?(this._occluderPipelineTransparent=R({blending:S,depthTest:a,depthWrite:null,colorWrite:_,stencilWrite:null,stencilTest:d}),this._occluderPipelineOpaque=R({blending:S,depthTest:a,depthWrite:null,colorWrite:_,stencilWrite:T,stencilTest:h}),this._occluderPipelineMaskWrite=R({blending:null,depthTest:m,depthWrite:null,colorWrite:null,stencilWrite:p,stencilTest:c})):this._occluderPipelineTransparent=this._occluderPipelineOpaque=this._occluderPipelineMaskWrite=null,this._occludeePipelineState=this._makePipelineState(e,!0),this._makePipelineState(e,!1)}getPipeline(e,i){return e?this._occludeePipelineState:i===o.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent??super.getPipeline():i===o.OCCLUDER_MATERIAL?this._occluderPipelineOpaque??super.getPipeline():this._occluderPipelineMaskWrite??super.getPipeline()}}const W=new Map([[P.POSITION,0],[P.PREVPOSITION,1],[P.UV0,2],[P.NORMAL,3],[P.COLOR,4],[P.COLORFEATUREATTRIBUTE,4],[P.SIZE,5],[P.SIZEFEATUREATTRIBUTE,5],[P.OPACITYFEATUREATTRIBUTE,6]]);export{A as LineMarkerTechnique,W as vertexAttributeLocations};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../core/shaderTechnique/ShaderTechnique.js\";import{depthCompareLess as t,stencilWriteMaskOn as l,stencilToolMaskBaseParams as s,stencilBaseAllZerosParams as n}from\"../lib/StencilUtils.js\";import{N as o}from\"../../../../chunks/NativeLine.glsl.js\";import{PrimitiveType as u}from\"../../../webgl/enums.js\";import{makePipelineState as p,defaultColorWrite as c,defaultDepthWrite as a,premultipliedAlphaToPremultipliedAlpha as m}from\"../../../webgl/renderState.js\";class d extends r{constructor(e,r,t){super(e,r,new i(o,(()=>import(/* webpackChunkName: \"NativeLine.glsl\" */ \"./NativeLine.glsl.js\"))),t),this.primitiveType=u.LINES}initializePipeline(i){const{hasOccludees:r,output:o,transparent:u}=i,d=(e,i=null,o=null)=>p({blending:i,depthTest:t,depthWrite:o,colorWrite:c,stencilWrite:r?l:null,stencilTest:r?e?s:n:null});return o===e.Color?(this._occludeePipeline=d(!0,u?m:null,a),d(!1,u?m:null,a)):d(!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}}export{d as NativeLineTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{parameter as o}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{DefaultTechniqueConfiguration as s}from\"../materials/DefaultTechniqueConfiguration.js\";class t extends s{constructor(){super(...arguments),this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.hasOccludees=!1}}e([o()],t.prototype,\"hasSlicePlane\",void 0),e([o()],t.prototype,\"hasVertexColors\",void 0),e([o()],t.prototype,\"transparent\",void 0),e([o()],t.prototype,\"hasOccludees\",void 0);export{t as NativeLineTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ReloadableShaderModule as e}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../core/shaderTechnique/ShaderTechnique.js\";import{a as o}from\"../../../../chunks/OverlayCompositing.glsl.js\";class s extends r{constructor(r,s,a){super(r,s,new e(o,(()=>import(/* webpackChunkName: \"OverlayCompositing.glsl\" */ \"./OverlayCompositing.glsl.js\"))),a)}}export{s as OverlayCompositingTechnique};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{ReloadableShaderModule as t}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as r}from\"../core/shaderTechnique/ShaderTechnique.js\";import{olidEnabled as i}from\"../effects/geometry/olidUtils.js\";import{OITPass as s}from\"../lib/OITPass.js\";import{blending as l,oitDepthTest as n,depthWrite as o,getDrawBuffers as p,getOITPolygonOffset as a}from\"../lib/OrderIndependentTransparency.js\";import{stencilWriteMaskOn as u,stencilToolMaskBaseParams as c,stencilBaseAllZerosParams as O}from\"../lib/StencilUtils.js\";import{VertexAttribute as f}from\"../lib/VertexAttribute.js\";import{P as m}from\"../../../../chunks/Pattern.glsl.js\";import{SpecialDrawBuffers as d}from\"../../../webgl/enums.js\";import{makePipelineState as T,cullingParams as P,defaultColorWrite as h}from\"../../../webgl/renderState.js\";class E extends r{constructor(e,r,s){super(e,r,new t(m,(()=>import(/* webpackChunkName: \"Pattern.glsl\" */ \"./Pattern.glsl.js\"))),s,i()?b:R)}_setPipelineState(t,r){const{oitPass:i,output:f,cullFace:m,draped:E,hasOccludees:R,polygonOffset:b,enableOffset:j}=t,g=i===s.NONE,A=i===s.FrontFace;return T({blending:f===e.Color?l(i):null,culling:P(m),depthTest:E?null:{func:n(i)},depthWrite:o(t),drawBuffers:f===e.Depth?{buffers:[d.NONE]}:p(i,f),colorWrite:h,stencilWrite:R?u:null,stencilTest:R?r?c:O:null,polygonOffset:g||A?b?S:null:a(j)})}initializePipeline(e){return this._occludeePipelineState=this._setPipelineState(e,!0),this._setPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}const S={factor:1,units:1},R=new Map([[f.POSITION,0],[f.COLOR,3],[f.UVMAPSPACE,4],[f.COLORFEATUREATTRIBUTE,5],[f.BOUNDINGRECT,6]]),b=new Map([[f.POSITION,0],[f.COLOR,3],[f.UVMAPSPACE,4],[f.COLORFEATUREATTRIBUTE,5],[f.BOUNDINGRECT,6],[f.OBJECTANDLAYERIDCOLOR,9]]);export{E as PatternTechnique,R as vertexAttributeLocations,b as vertexAttributeLocationsOID};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../../chunks/tslib.es6.js\";import{TextureCoordinateType as e}from\"../core/shaderLibrary/attributes/TextureCoordinateAttribute.glsl.js\";import{EmissionSource as o}from\"../core/shaderLibrary/output/Emissions.glsl.js\";import{parameter as s}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{CullFaceOptions as i}from\"../lib/basicInterfaces.js\";import{DefaultTechniqueConfiguration as r}from\"../materials/DefaultTechniqueConfiguration.js\";import{Style as a}from\"../materials/PatternStyle.js\";class n extends r{constructor(){super(...arguments),this.cullFace=i.None,this.style=a.Horizontal,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasOccludees=!1,this.enableOffset=!0,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.vvColor=!1,this.draped=!1,this.textureCoordinateType=e.None,this.emissionSource=o.None,this.discardInvisibleFragments=!0,this.writeDepth=!0,this.occlusionPass=!1,this.hasVvInstancing=!1,this.vvSize=!1,this.vvOpacity=!1,this.objectAndLayerIdColorInstanced=!1}}t([s({count:i.COUNT})],n.prototype,\"cullFace\",void 0),t([s({count:a.COUNT})],n.prototype,\"style\",void 0),t([s()],n.prototype,\"hasSlicePlane\",void 0),t([s()],n.prototype,\"hasVertexColors\",void 0),t([s()],n.prototype,\"polygonOffset\",void 0),t([s()],n.prototype,\"hasOccludees\",void 0),t([s()],n.prototype,\"enableOffset\",void 0),t([s()],n.prototype,\"terrainDepthTest\",void 0),t([s()],n.prototype,\"cullAboveTerrain\",void 0),t([s()],n.prototype,\"vvColor\",void 0),t([s()],n.prototype,\"draped\",void 0);export{n as PatternTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{glsl as e}from\"../core/shaderModules/interfaces.js\";function o(o){o.code.add(e`vec3 tonemapACES(vec3 x) {\nreturn clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);\n}`)}export{o as ToneMapping};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import i from\"../../../core/Accessor.js\";import e from\"../../../core/Logger.js\";import{lerp as r}from\"../../../core/mathUtils.js\";import{createScreenPointArray as s,createRenderScreenPointArray3 as o}from\"../../../core/screenUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import{subclass as h}from\"../../../core/accessorSupport/decorators/subclass.js\";import{copy as a,multiply as p,invert as u,transpose as l,frustum as _,equals as c,lookAt as v}from\"../../../core/libs/gl-matrix-2/math/mat4.js\";import{create as w}from\"../../../core/libs/gl-matrix-2/factories/mat4f64.js\";import{copy as d,exactEquals as y}from\"../../../core/libs/gl-matrix-2/math/vec2.js\";import{fromValues as g}from\"../../../core/libs/gl-matrix-2/factories/vec2f64.js\";import{d as m,i as f,j as x,c as M,p as D,a as j,f as T,z as R,y as P,h as F,l as V,e as O,n as C,o as b}from\"../../../chunks/vec32.js\";import{create as S}from\"../../../core/libs/gl-matrix-2/factories/vec3f64.js\";import{d as I,e as E,a as L,c as H,f as A,t as G}from\"../../../chunks/vec42.js\";import{fromValues as B,create as U}from\"../../../core/libs/gl-matrix-2/factories/vec4f64.js\";import{create as k,copy as z,fromMatrix as W}from\"../../../geometry/support/frustum.js\";import{create as X}from\"../../../geometry/support/ray.js\";import{projectPointSignedLength as Y}from\"../../../geometry/support/vector.js\";import{ViewingMode as q}from\"../../ViewingMode.js\";import{fovd2fovx as N,fovx2fovd as J,fovd2fovy as K,fovy2fovd as Q}from\"../webgl-engine/lib/fov.js\";import{PaddingSide as Z}from\"../webgl-engine/lib/rendererUtils.js\";var $;let tt=$=class extends i{constructor(t){super(t),this._ray=X(),this._viewport=B(0,0,1,1),this._padding=B(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=g(1,1e3),this._viewDirty=!0,this._viewMatrix=w(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=w(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=w(),this._frustumDirty=!0,this._frustum=k(),this._fullViewport=U(),this._pixelRatio=1,this.row=0,this.column=0,this._rows=1,this._columns=1,this._center=S(),this._up=S(),this.relativeElevation=0}get pixelRatio(){return this._pixelRatio}set pixelRatio(t){this._pixelRatio=t>0?t:1}get rows(){return this._rows}set rows(t){this._rows=Math.max(1,t)}get columns(){return this._columns}set columns(t){this._columns=Math.max(1,t)}get eye(){return this._ray.origin}set eye(t){this._compareAndSetView(t,this._ray.origin)}get center(){return this._center}set center(t){this._compareAndSetView(t,this._center,\"_center\")}get ray(){return m(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(t){this._compareAndSetView(t,this._up,\"_up\")}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(t){a(this._viewMatrix,t),this.notifyChange(\"_viewMatrix\"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),f(S(),-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10])}get viewUp(){return this._ensureViewClean(),f(S(),this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9])}get viewRight(){return this._ensureViewClean(),f(S(),this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8])}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(t){this._nearFar[0]!==t&&(this._nearFar[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_nearFar\"))}get far(){return this._nearFar[1]}set far(t){this._nearFar[1]!==t&&(this._nearFar[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_nearFar\"))}get viewport(){return this._viewport}set viewport(t){this.x=t[0],this.y=t[1],this.width=t[2],this.height=t[3]}get screenViewport(){if(1===this.pixelRatio)return this._viewport;const t=I(U(),this._viewport,1/this.pixelRatio),i=this._get(\"screenViewport\");return i&&E(t,i)?i:t}get screenPadding(){if(1===this.pixelRatio)return this._padding;const t=I(U(),this._padding,1/this.pixelRatio),i=this._get(\"screenPadding\");return i&&E(t,i)?i:t}get x(){return this._viewport[0]}set x(t){t+=this._padding[Z.LEFT],this._viewport[0]!==t&&(this._viewport[0]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_viewport\"))}get y(){return this._viewport[1]}set y(t){t+=this._padding[Z.BOTTOM],this._viewport[1]!==t&&(this._viewport[1]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_viewport\"))}get width(){return this._viewport[2]}set width(t){this._viewport[2]!==t&&(this._viewport[2]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_viewport\"))}get height(){return this._viewport[3]}set height(t){this._viewport[3]!==t&&(this._viewport[3]=t,this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_viewport\"))}get fullWidth(){return this._viewport[2]+this._padding[Z.RIGHT]+this._padding[Z.LEFT]}set fullWidth(t){this.width=t-(this._padding[Z.RIGHT]+this._padding[Z.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[Z.TOP]+this._padding[Z.BOTTOM]}set fullHeight(t){this.height=t-(this._padding[Z.TOP]+this._padding[Z.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[Z.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[Z.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get _aspect(){return this.width/this.height}get padding(){return this._padding}set padding(t){L(this._padding,t)||(this._viewport[0]+=t[Z.LEFT]-this._padding[Z.LEFT],this._viewport[1]+=t[Z.BOTTOM]-this._padding[Z.BOTTOM],this._viewport[2]-=t[Z.RIGHT]+t[Z.LEFT]-(this._padding[Z.RIGHT]+this._padding[Z.LEFT]),this._viewport[3]-=t[Z.TOP]+t[Z.BOTTOM]-(this._padding[Z.TOP]+this._padding[Z.BOTTOM]),H(this._padding,t),this._viewProjectionDirty=!0,this._frustumDirty=!0,this.notifyChange(\"_padding\"),this.notifyChange(\"_viewport\"))}get viewProjectionMatrix(){return this._viewProjectionDirty&&(p(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){return this._projectionMatrixInternal}get inverseProjectionMatrix(){return u(w(),this.projectionMatrix)||this._get(\"inverseProjectionMatrix\")||w()}get fov(){return this._fov}set fov(t){this._fov=t,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return N(this._fov,this.width,this.height)}set fovX(t){this._fov=J(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return K(this._fov,this.width,this.height)}set fovY(t){this._fov=Q(t,this.width,this.height),this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return x(this.center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(u(this._viewInverseTransposeMatrix,this.viewMatrix),l(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(t){const i=2*t-1;return 2*this.near*this.far/(this.far+this.near-i*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this.pixelRatio}get aboveGround(){return null!=this.relativeElevation&&this.relativeElevation>=0}get _projectionMatrixInternal(){const t=this.width,i=this.height,e=this.near*Math.tan(this.fovY/2)*2,r=e*this._aspect,s=e/this.rows,o=r/this.columns,n=-r/2+this.column*o,h=n+o,a=-e/2+this.row*s,p=a+s,u=_(w(),n*(1+2*this._padding[Z.LEFT]/t),h*(1+2*this._padding[Z.RIGHT]/t),a*(1+2*this._padding[Z.BOTTOM]/i),p*(1+2*this._padding[Z.TOP]/i),this.near,this.far),l=this._get(\"projectionMatrix\");return l&&c(l,u)?l:u}copyFrom(t){M(this._ray.origin,t.eye),this.center=t.center,this.up=t.up,H(this._viewport,t.viewport),this.notifyChange(\"_viewport\"),H(this._padding,t.padding),this.notifyChange(\"_padding\"),d(this._nearFar,t.nearFar),this.notifyChange(\"_nearFar\"),this._fov=t.fov,this.row=t.row,this.column=t.column,this.rows=t.rows,this.columns=t.columns,this.relativeElevation=t.relativeElevation;const i=t;return this._viewDirty=i._viewDirty,this._viewDirty||(a(this._viewMatrix,t.viewMatrix),this.notifyChange(\"_viewMatrix\")),this._viewProjectionDirty=!0,this._frustumDirty=i._frustumDirty,this._frustumDirty||(z(this._frustum,t.frustum),this._frustumDirty=!1),i._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(a(this._viewInverseTransposeMatrix,t.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),H(this._fullViewport,t.fullViewport),this.pixelRatio=t.pixelRatio,this}copyViewFrom(t){this.eye=t.eye,this.center=t.center,this.up=t.up,this.fov=t.fov}clone(){return(new $).copyFrom(this)}equals(t){return D(this.eye,t.eye)&&D(this.center,t.center)&&D(this.up,t.up)&&L(this._viewport,t.viewport)&&L(this._padding,t.padding)&&y(this.nearFar,t.nearFar)&&this._fov===t.fov&&this.pixelRatio===t.pixelRatio&&this.relativeElevation===t.relativeElevation&&this.row===t.row&&this.column===t.column&&this.rows===t.rows&&this.columns===t.columns}almostEquals(t){const i=Math.max(1,1/this.pixelRatio,1/t.pixelRatio);if(Math.abs(t.fov-this._fov)>=.001||A(t.screenPadding,this.screenPadding)>=i||A(this.screenViewport,t.screenViewport)>=i||this.row!==t.row||this.column!==t.column||this.rows!==t.rows||this.columns!==t.columns)return!1;j(st,t.eye,t.center),j(ot,this.eye,this.center);const e=T(st,ot),r=R(st),s=R(ot),o=5e-4;return e*e>=(1-1e-10)*r*s&&P(t.eye,this.eye)<Math.max(r,s)*o*o}computeRenderPixelSizeAt(t){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(t))}computeRenderPixelSizeAtDist(t){return t*this.perRenderPixelRatio}computeScreenPixelSizeAt(t){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(t))}_viewDirectionDistance(t){return Math.abs(Y(this.viewForward,m(st,t,this.eye)))}computeScreenPixelSizeAtDist(t){return t*this.perScreenPixelRatio}computeDistanceFromRadius(t,i){return t/Math.tan(Math.min(this.fovX,this.fovY)/(2*(i||1)))}getScreenCenter(t=s()){return t[0]=(this.padding[Z.LEFT]+this.width/2)/this.pixelRatio,t[1]=(this.padding[Z.TOP]+this.height/2)/this.pixelRatio,t}getRenderCenter(t,i=.5,e=.5){return t[0]=this.padding[Z.LEFT]+this.width*i,t[1]=this.padding[Z.BOTTOM]+this.height*e,t[2]=.5,t}setGLViewport(t){const i=this.viewport,e=this.padding;t.setViewport(i[0]-e[3],i[1]-e[2],i[2]+e[1]+e[3],i[3]+e[0]+e[2])}applyProjection(t,i){t!==et&&M(et,t),et[3]=1,G(et,et,this.projectionMatrix);const e=Math.abs(et[3]);F(et,et,1/e);const s=this.fullViewport;i[0]=r(0,s[0]+s[2],.5+.5*et[0]),i[1]=r(0,s[1]+s[3],.5+.5*et[1]),i[2]=.5*(et[2]+1),i[3]=e}unapplyProjection(t,i){const e=this.fullViewport;et[0]=(t[0]/(e[0]+e[2])*2-1)*t[3],et[1]=(t[1]/(e[1]+e[3])*2-1)*t[3],et[2]=(2*t[2]-1)*t[3],et[3]=t[3],null!=this.inverseProjectionMatrix&&(G(et,et,this.inverseProjectionMatrix),i[0]=et[0],i[1]=et[1],i[2]=et[2])}projectToScreen(t,i){return this.projectToRenderScreen(t,nt),this.renderToScreen(nt,i),i}projectToRenderScreen(t,i){if(et[0]=t[0],et[1]=t[1],et[2]=t[2],et[3]=1,G(et,et,this.viewProjectionMatrix),0===et[3])return null;const e=et;F(e,e,1/Math.abs(et[3]));const s=this.fullViewport,o=r(0,s[0]+s[2],.5+.5*e[0]),n=r(0,s[1]+s[3],.5+.5*e[1]);return\"x\"in i?(i.x=o,i.y=n):(i[0]=o,i[1]=n,i.length>2&&(i[2]=.5*(e[2]+1))),i}unprojectFromScreen(t,i){return this.unprojectFromRenderScreen(this.screenToRender(t,nt),i)}unprojectFromRenderScreen(t,i){if(p(rt,this.projectionMatrix,this.viewMatrix),!u(rt,rt))return null;const e=this.fullViewport;return et[0]=2*(t[0]-e[0])/e[2]-1,et[1]=2*(t[1]-e[1])/e[3]-1,et[2]=2*t[2]-1,et[3]=1,G(et,et,rt),0===et[3]?null:(i[0]=et[0]/et[3],i[1]=et[1]/et[3],i[2]=et[2]/et[3],i)}constrainWindowSize(t,i,e,r){const s=t*this.pixelRatio,o=i*this.pixelRatio,n=Math.max(s-e/2,0),h=Math.max(this.fullHeight-o-r/2,0),a=-Math.min(s-e/2,0),p=-Math.min(this.fullHeight-o-r/2,0),u=e-a- -Math.min(this.fullWidth-s-e/2,0),l=r-p- -Math.min(o-r/2,0);return[Math.round(n),Math.round(h),Math.round(u),Math.round(l)]}computeUp(t){t===q.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(t,i){const e=t[0]*this.pixelRatio,r=this.fullHeight-t[1]*this.pixelRatio;return i[0]=e,i[1]=r,i}renderToScreen(t,i){const e=t[0]/this.pixelRatio,r=(this.fullHeight-t[1])/this.pixelRatio;i[0]=e,i[1]=r}_computeUpGlobal(){m(st,this.center,this.eye);const t=V(this.center);t<1?(f(this._up,0,0,1),this._markViewDirty(),this.notifyChange(\"_up\")):Math.abs(T(st,this.center))>.9999*V(st)*t||(O(this._up,st,this.center),O(this._up,this._up,st),C(this._up,this._up),this.notifyChange(\"_up\"),this._markViewDirty())}_computeUpLocal(){b(st,this.eye,this.center),Math.abs(st[2])<=.9999&&(F(st,st,st[2]),f(this._up,-st[0],-st[1],1-st[2]),C(this._up,this._up),this.notifyChange(\"_up\"),this._markViewDirty())}_compareAndSetView(t,i,r=\"\"){\"number\"==typeof t[0]&&isFinite(t[0])&&\"number\"==typeof t[1]&&isFinite(t[1])&&\"number\"==typeof t[2]&&isFinite(t[2])?D(t,i)||(M(i,t),this._markViewDirty(),r.length&&this.notifyChange(r)):e.getLogger(\"esri.views.3d.webgl-engine.lib.RenderCamera\").warn(\"RenderCamera vector contains invalid number, ignoring value\")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(W(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(v(this._viewMatrix,this.eye,this.center,this.up),this.notifyChange(\"_viewMatrix\"),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};t([n()],tt.prototype,\"_viewport\",void 0),t([n()],tt.prototype,\"_padding\",void 0),t([n()],tt.prototype,\"_fov\",void 0),t([n()],tt.prototype,\"_nearFar\",void 0),t([n()],tt.prototype,\"_viewDirty\",void 0),t([n()],tt.prototype,\"_viewMatrix\",void 0),t([n()],tt.prototype,\"_pixelRatio\",void 0),t([n()],tt.prototype,\"pixelRatio\",null),t([n()],tt.prototype,\"row\",void 0),t([n()],tt.prototype,\"column\",void 0),t([n()],tt.prototype,\"_rows\",void 0),t([n()],tt.prototype,\"rows\",null),t([n()],tt.prototype,\"_columns\",void 0),t([n()],tt.prototype,\"columns\",null),t([n()],tt.prototype,\"eye\",null),t([n()],tt.prototype,\"center\",null),t([n()],tt.prototype,\"_center\",void 0),t([n()],tt.prototype,\"up\",null),t([n()],tt.prototype,\"_up\",void 0),t([n()],tt.prototype,\"viewMatrix\",null),t([n({readOnly:!0})],tt.prototype,\"viewForward\",null),t([n({readOnly:!0})],tt.prototype,\"viewUp\",null),t([n({readOnly:!0})],tt.prototype,\"viewRight\",null),t([n({readOnly:!0})],tt.prototype,\"nearFar\",null),t([n()],tt.prototype,\"near\",null),t([n()],tt.prototype,\"far\",null),t([n()],tt.prototype,\"viewport\",null),t([n({readOnly:!0})],tt.prototype,\"screenViewport\",null),t([n({readOnly:!0})],tt.prototype,\"screenPadding\",null),t([n()],tt.prototype,\"x\",null),t([n()],tt.prototype,\"y\",null),t([n()],tt.prototype,\"width\",null),t([n()],tt.prototype,\"height\",null),t([n()],tt.prototype,\"fullWidth\",null),t([n()],tt.prototype,\"fullHeight\",null),t([n({readOnly:!0})],tt.prototype,\"_aspect\",null),t([n()],tt.prototype,\"padding\",null),t([n({readOnly:!0})],tt.prototype,\"projectionMatrix\",null),t([n({readOnly:!0})],tt.prototype,\"inverseProjectionMatrix\",null),t([n()],tt.prototype,\"fov\",null),t([n()],tt.prototype,\"fovX\",null),t([n()],tt.prototype,\"fovY\",null),t([n()],tt.prototype,\"viewInverseTransposeMatrix\",null),t([n({readOnly:!0})],tt.prototype,\"_projectionMatrixInternal\",null),t([n()],tt.prototype,\"relativeElevation\",void 0),tt=$=t([h(\"esri.views.3d.webgl.RenderCamera\")],tt);const it=tt,et=U(),rt=w(),st=S(),ot=S(),nt=o();export{it as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport{isArrayLike as t}from\"../../core/arrayUtils.js\";import\"../../core/has.js\";import e from\"../../core/Logger.js\";import{isUint8Array as i,isUint16Array as s,isUint32Array as r}from\"../../core/typedArrayUtil.js\";import{checkWebGLError as n}from\"./checkWebGLError.js\";import{BufferType as _,Usage as a,ResourceType as u,DataType as f}from\"./enums.js\";const h=()=>e.getLogger(\"esri.views.webgl.BufferObject\"),c=null;class E{static createIndex(t,e,i){return new E(t,_.ELEMENT_ARRAY_BUFFER,e,i)}static createVertex(t,e,i){return new E(t,_.ARRAY_BUFFER,e,i)}static createUniform(t,e,i){return new E(t,_.UNIFORM_BUFFER,e,i)}static createPixelPack(t,e=a.STREAM_READ,i){const s=new E(t,_.PIXEL_PACK_BUFFER,e);return i&&s.setSize(i),s}static createPixelUnpack(t,e=a.STREAM_DRAW,i){return new E(t,_.PIXEL_UNPACK_BUFFER,e,i)}static createTransformFeedback(t,e=a.STATIC_DRAW,i){const s=new E(t,_.TRANSFORM_FEEDBACK_BUFFER,e);return s.setSize(i),s}constructor(t,e,i,s){this._context=t,this.bufferType=e,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,t.instanceCounter.increment(u.BufferObject,this),this._glName=this._context.gl.createBuffer(),n(this._context.gl),s&&this.setData(s)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get usedMemory(){if(this.bufferType===_.ELEMENT_ARRAY_BUFFER){if(this._indexType===f.UNSIGNED_INT)return 4*this._size;if(this._indexType===f.UNSIGNED_SHORT)return 2*this._size}return this._size}get _isVAOAware(){return this.bufferType===_.ELEMENT_ARRAY_BUFFER||this.bufferType===_.ARRAY_BUFFER}dispose(){if(this._context?.gl){if(this._glName){this._context.gl.deleteBuffer(this._glName),this._glName=null}this._context.instanceCounter.decrement(u.BufferObject,this),this._context=null}else this._glName&&h().warn(\"Leaked WebGL buffer object\")}setSize(t,e=null){if(this.bufferType===_.ELEMENT_ARRAY_BUFFER&&null!=e)switch(this._indexType=e,e){case f.UNSIGNED_SHORT:t*=2;break;case f.UNSIGNED_INT:t*=4}this._setBufferData(t)}setData(t){if(!t)return;let e=t.byteLength;this.bufferType===_.ELEMENT_ARRAY_BUFFER&&(i(t)?this._indexType=f.UNSIGNED_BYTE:s(t)?(e/=2,this._indexType=f.UNSIGNED_SHORT):r(t)&&(e/=4,this._indexType=f.UNSIGNED_INT)),this._setBufferData(e,t)}_setBufferData(t,e=null){this._size=t;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const s=this._context.gl;null!=e?s.bufferData(this.bufferType,e,this.usage):s.bufferData(this.bufferType,t,this.usage),n(s),this._isVAOAware&&this._context.bindVAO(i)}setSubData(t,e,i,s){if(!t)return;const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const{gl:_}=this._context;_.bufferSubData(this.bufferType,e*t.BYTES_PER_ELEMENT,t,i,s-i),n(_),this._isVAOAware&&this._context.bindVAO(r)}getSubData(t,e=0,i,s){if(i<0||s<0)return;const r=o(t)?t.BYTES_PER_ELEMENT:1;if(r*((i??0)+(s??0))>t.byteLength)return;e+r*(s??0)>this.usedMemory&&h().warn(\"Potential problem getting subdata: requested data exceeds buffer size!\");const n=this._context.gl;this.bufferType===_.TRANSFORM_FEEDBACK_BUFFER?(this._context.bindBuffer(this,_.TRANSFORM_FEEDBACK_BUFFER),n.getBufferSubData(_.TRANSFORM_FEEDBACK_BUFFER,e,t,i,s),this._context.unbindBuffer(_.TRANSFORM_FEEDBACK_BUFFER)):(this._context.bindBuffer(this,_.COPY_READ_BUFFER),n.getBufferSubData(_.COPY_READ_BUFFER,e,t,i,s),this._context.unbindBuffer(_.COPY_READ_BUFFER))}async getSubDataAsync(t,e=0,i,s){await this._context.clientWaitAsync(),this.getSubData(t,e,i,s)}}function o(e){return t(e)}export{E as BufferObject,c as tracer};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Logger.js\";import{disposeMaybe as t}from\"../../core/maybe.js\";import{typedArrayStaticSize as i}from\"../../core/typedArrayUtil.js\";import{ResourceType as r}from\"./enums.js\";import{bindVertexBufferLayout as s}from\"./Util.js\";const n=()=>e.getLogger(\"esri.views.webgl.VertexArrayObject\");let o=class{constructor(e,t,i,r,s=null){this._context=e,this._locations=t,this._layout=i,this._buffers=r,this._indexBuffer=s,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Array.from(this._buffers.values()).reduce(((e,t)=>e+t.usedMemory),null!=this._indexBuffer?this._indexBuffer.usedMemory:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*i}dispose(){this._context?(this._context.getBoundVAO()===this&&this._context.bindVAO(null),this._buffers.forEach((e=>e.dispose())),this._buffers.clear(),this._indexBuffer=t(this._indexBuffer),this.disposeVAOOnly()):(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&n().warn(\"Leaked WebGL VAO\")}disposeVAOOnly(){this._glName&&(this._context.gl.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(r.VertexArrayObject,this)),this._context=null}initialize(){if(this._initialized)return;const{gl:e}=this._context,t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t,this._context.instanceCounter.increment(r.VertexArrayObject,this),this._initialized=!0}bind(){this.initialize(),this._context.gl.bindVertexArray(this.glName)}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:i}=this;e||n().error(\"Vertex buffer dictionary is empty!\");const r=this._context.gl;this._buffers.forEach(((e,i)=>{const r=t.get(i);r?s(this._context,this._locations,e,r):n().error(\"Vertex element descriptor is empty!\")})),null!=i&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,i.glName)}unbind(){this.initialize(),this._context.gl.bindVertexArray(null)}};export{o as VertexArrayObject};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.31/esri/copyright.txt for details.\n*/\nclass t{constructor(t,s,i,h,o,e=!1,r=0){this.name=t,this.count=s,this.type=i,this.offset=h,this.stride=o,this.normalized=e,this.divisor=r}}export{t as VertexElementDescriptor};\n"],"names":[],"sourceRoot":""}