"use strict";(self.webpackChunkdefra=self.webpackChunkdefra||[]).push([[744,1232,2416],{74756:function(e,t,r){r.r(t),r.d(t,{default:function(){return O}});var n=r(53804),i=r(93040),s=r(78879),o=r(61500),a=r(30905),l=r(21609),u=r(31609),c=r(75218),p=r(40633),d=r(95929),h=r(60539),f=r(90683),y=r(23502),m=(r(58941),r(65953)),g=r(81392),v=r(57165),b=r(51432),w=r(43173),_=r(11876),S=r(83525),I=(r(13798),r(22739));const M=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let T=class extends S.A{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const e=(0,I.JK)().toLowerCase();switch(e){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const t=(0,I.Z0)(e);return"pt"===t?"pt-BR":t&&M.has(t)?t:"global"}};(0,n._)([(0,y.MZ)()],T.prototype,"apiKey",void 0),(0,n._)([(0,y.MZ)()],T.prototype,"id",void 0),(0,n._)([(0,y.MZ)()],T.prototype,"language",void 0),(0,n._)([(0,y.MZ)()],T.prototype,"places",void 0),(0,n._)([(0,y.MZ)()],T.prototype,"serviceUrl",void 0),(0,n._)([(0,y.MZ)()],T.prototype,"worldview",void 0),T=(0,n._)([(0,m.$)("esri.support.BasemapStyle")],T);const x=T;var A,E=r(84624);let L=0,C=A=class extends((0,a.Te)(u.A)){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+L++,this.baseLayers=new s.A,this.referenceLayers=new s.A;const t=e=>{e.parent&&e.parent!==this&&"remove"in e.parent&&e.parent.remove(e),e.parent=this,"elevation"===e.type&&p.A.getLogger(this).error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=e=>{e.parent=null};this.addHandles([this.baseLayers.on("after-add",(e=>t(e.item))),this.referenceLayers.on("after-add",(e=>t(e.item))),this.baseLayers.on("after-remove",(e=>r(e.item))),this.referenceLayers.on("after-remove",(e=>r(e.item)))])}initialize(){this.when().catch((e=>{p.A.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const t of e)t.destroy();const t=this.referenceLayers.toArray();for(const e of t)e.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=(0,d.pR)(this.portalItem)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",(0,o.V)(e,this._get("baseLayers")))}_writeBaseLayers(e,t,r){const n=[];e?(r={...r,layerContainerType:"basemap"},this.baseLayers.forEach((e=>{const t=(0,E.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&n.push(t)})),this.referenceLayers.forEach((e=>{const t=(0,E.CJ)(e,r.webmap?r.webmap.getLayerJSONFromResourceInfo(e):null,r);null!=t&&("scene"!==e.type&&(t.isReference=!0),n.push(t))})),t.baseMapLayers=n):t.baseMapLayers=n}set referenceLayers(e){this._set("referenceLayers",(0,o.V)(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return(0,c.g)(this,(e=>{e(this.baseLayers,this.referenceLayers)}))}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map((e=>(0,l.Nb)(e)?e.clone():e)),referenceLayers:this.referenceLayers.map((e=>(0,l.Nb)(e)?e.clone():e))};return this.loaded&&(e.loadStatus="loaded"),new A({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){return e=e||{},t?.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&this.resourceInfo?.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((e=>{const t=(0,l.o8)(e);return t.url&&(0,f.BQ)(t.url)&&(t.url=`https:${t.url}`),t.templateUrl&&(0,f.BQ)(t.templateUrl)&&(t.templateUrl=`https:${t.templateUrl}`),t}))),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:r,style:n}=this;(0,h.Te)(e);const i=[];if(t){const r=t.context?t.context.url:null;if(i.push(this._loadLayersFromJSON(t.data,r,e)),t.data.id&&!t.data.title){const e=t.data.id;i.push((0,_.q)(e).then((e=>{e&&this.read({title:e},t.context)})))}}else r?i.push(this._loadFromItem(r,e)):n&&i.push(this._loadFromStylesService(n,e));await Promise.all(i)}async _loadLayersFromJSON(e,t,n){const i=this.resourceInfo?.context,s=this.portalItem?.portal||i?.portal||null,o=R[i?.origin||""]??"web-map",{populateOperationalLayers:a}=await r.e(3538).then(r.bind(r,80669)),l=[];if((0,h.Te)(n),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const r={context:{...i,origin:o,url:t,portal:s,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},n=e=>"web-scene"===o&&"ArcGISSceneServiceLayer"===e.layerType||e.isReference,u=a(this.baseLayers,e.baseMapLayers.filter((e=>!n(e))),r);l.push(u);const c=a(this.referenceLayers,e.baseMapLayers.filter(n),r);l.push(c)}await Promise.allSettled(l)}async _loadFromItem(e,t){const r=await e.load(t),n=await r.fetchData("json",t),i=(0,f.An)(e.itemUrl??"");return this._set("resourceInfo",{data:n.baseMap??{},context:{origin:N[e.type||""]??"web-map",portal:e.portal||b.A.getDefault(),url:i}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||b.A.getDefault(),url:i}),this._loadLayersFromJSON(this.resourceInfo.data,i,t)}async _loadFromStylesService(e,t){const r=`${e.serviceUrl}/${e.id}`,n=(await(0,i.A)(r,{query:{language:e.getLanguageParamValue(),places:e.places,worldview:e.worldview,token:e.apiKey},signal:t?.signal})).data,s=(0,f.An)(r);if(this._set("resourceInfo",{data:n.baseMap??{},context:{origin:"web-map",url:s}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:n.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,s,t),e.apiKey)for(const t of[...this.baseLayers,...this.referenceLayers])"apiKey"in t&&(t.apiKey=e.apiKey)}static fromId(e){const t=_.H[e];return t?t.itemId?new A({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):A.fromJSON(t,{origin:t.is3d?"web-scene":"web-map"}):null}};(0,n._)([(0,y.MZ)({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,r,n){this._writeBaseLayers(e,t,n)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:s.A}},writer(e,t,r,n){this._writeBaseLayers(e,t,n)}}}}}})],C.prototype,"baseLayers",null),(0,n._)([(0,y.MZ)({type:String,json:{origins:{"web-scene":{write:!0}}}})],C.prototype,"id",void 0),(0,n._)([(0,y.MZ)({type:w.default})],C.prototype,"portalItem",void 0),(0,n._)([(0,y.MZ)()],C.prototype,"referenceLayers",null),(0,n._)([(0,y.MZ)({readOnly:!0})],C.prototype,"resourceInfo",void 0),(0,n._)([(0,y.MZ)({type:v.A})],C.prototype,"spatialReference",void 0),(0,n._)([(0,y.MZ)({type:x})],C.prototype,"style",void 0),(0,n._)([(0,y.MZ)()],C.prototype,"thumbnailUrl",void 0),(0,n._)([(0,y.MZ)({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],C.prototype,"title",void 0),(0,n._)([(0,g.K)("title")],C.prototype,"writeTitle",null),C=A=(0,n._)([(0,m.$)("esri.Basemap")],C);const N={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},R={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},O=C},9688:function(e,t,r){r.d(t,{lY:function(){return p},mT:function(){return d}});var n,i=r(50944),s=r(92955),o=r(96285);(n||(n={})).TimeZoneNotRecognized="TimeZoneNotRecognized";const a={[n.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class l extends Error{constructor(e,t){super((0,i.HC)(a[e],t)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,l)}}function u(e,t,r){return e<t?e-t:e>r?e-r:0}function c(e,t,r){return e<t?t:e>r?r:e}class p{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,t=1,r=1,n=0,i=0,s=0,a=0,l){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)||isNaN(s)||isNaN(a))return null;const h=o.c9.local(e,t).daysInMonth;let f=o.c9.fromObject({day:c(r,1,h),year:e,month:c(t,1,12),hour:c(n,0,23),minute:c(i,0,59),second:c(s,0,59),millisecond:c(a,0,999)},{zone:d(l)});return f=f.plus({months:u(t,1,12),days:u(r,1,h),hours:u(n,0,23),minutes:u(i,0,59),seconds:u(s,0,59),milliseconds:u(a,0,999)}),new p(f)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,t){const r=d(t);return e.isUnknownTimeZone||r===s.GB.instance?p.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new p(e._date.setZone(r))}static dateJSToArcadeDate(e){return new p(o.c9.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){const r=d(t);return new p(o.c9.fromJSDate(e,{zone:r}))}static unknownEpochToArcadeDate(e){return new p(o.c9.fromMillis(e,{zone:s.GB.instance}))}static unknownDateJSToArcadeDate(e){return new p(o.c9.fromMillis(e.getTime(),{zone:s.GB.instance}))}static epochToArcadeDate(e,t="system"){const r=d(t);return new p(o.c9.fromMillis(e,{zone:r}))}static dateTimeToArcadeDate(e){return new p(e)}clone(){return new p(this._date)}changeTimeZone(e){const t=d(e);return p.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,t){const r=d(t);return e.zone===s.GB.instance||r===s.GB.instance?p.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new p(e.setZone(r))}static nowToArcadeDate(e){const t=d(e);return new p(o.c9.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new p(o.c9.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===p.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===s.GB.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new p(this._date.plus(e))}diff(e,t="milliseconds"){return this._date.diff(e._date,t)[t]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,t){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:t&&!this.isUnknownTimeZone})}toFormat(e,t){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new p(this._date.toUTC())}toLocal(){return new p(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const t=o.c9.fromISO(e,{setZone:!0});return new p(t)}}function d(e,t=!0){if(e instanceof o.bo)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"UTC";if("unknown"===e.toLowerCase())return s.GB.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const t=o.mQ.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}const r=o.oh.create(e);if(!r.isValid){if(t)throw new l(n.TimeZoneNotRecognized);return null}return r}},80749:function(e,t,r){r.d(t,{Fq:function(){return l},SQ:function(){return o},Yc:function(){return s},Yq:function(){return a},uf:function(){return i}});var n=r(91484);function i(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function s(e){if(null==e)return null;switch(e.type){case"polygon":case"multipoint":case"polyline":return e.extent;case"point":return new n.default({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case"extent":return e}return null}function o(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function a(e){if(null==e)return null;const t=e.clone();return void 0!==e.cache._geVersion&&(t.cache._geVersion=e.cache._geVersion),t}function l(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},88923:function(e,t,r){function n(e,t,r,n,s){i(e,t,r||0,n||e.length-1,s||o)}function i(e,t,r,n,o){for(;n>r;){if(n-r>600){var a=n-r+1,l=t-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);i(e,t,Math.max(r,Math.floor(t-l*c/a+p)),Math.min(n,Math.floor(t+(a-l)*c/a+p)),o)}var d=e[t],h=r,f=n;for(s(e,r,t),o(e[n],d)>0&&s(e,r,n);h<f;){for(s(e,h,f),h++,f--;o(e[h],d)<0;)h++;for(;o(e[f],d)>0;)f--}0===o(e[r],d)?s(e,r,f):s(e,++f,n),f<=t&&(r=f+1),t<=f&&(n=f-1)}}function s(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function o(e,t){return e<t?-1:e>t?1:0}r.d(t,{q:function(){return n}})},99680:function(e,t,r){r.d(t,{q:function(){return i}});var n=r(85408);class i{constructor(e,t){this._storage=new n.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,r=1){this._storage.put(this,e,t,r,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},92709:function(e,t,r){r.d(t,{T:function(){return n},d:function(){return y}});const n={Base64:0,Hex:1,String:2,Raw:3},i=8,s=(1<<i)-1;function o(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function a(e){const t=[];for(let r=0,n=e.length*i;r<n;r+=i)t[r>>5]|=(e.charCodeAt(r/i)&s)<<r%32;return t}function l(e){const t=[];for(let r=0,n=32*e.length;r<n;r+=i)t.push(String.fromCharCode(e[r>>5]>>>r%32&s));return t.join("")}function u(e,t,r,n,i,s){return o(function(e,t){return e<<t|e>>>32-t}(o(o(t,e),o(n,s)),i),r)}function c(e,t,r,n,i,s,o){return u(t&r|~t&n,e,t,i,s,o)}function p(e,t,r,n,i,s,o){return u(t&n|r&~n,e,t,i,s,o)}function d(e,t,r,n,i,s,o){return u(t^r^n,e,t,i,s,o)}function h(e,t,r,n,i,s,o){return u(r^(t|~n),e,t,i,s,o)}function f(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let r=1732584193,n=-271733879,i=-1732584194,s=271733878;for(let t=0;t<e.length;t+=16){const a=r,l=n,u=i,f=s;r=c(r,n,i,s,e[t],7,-680876936),s=c(s,r,n,i,e[t+1],12,-389564586),i=c(i,s,r,n,e[t+2],17,606105819),n=c(n,i,s,r,e[t+3],22,-1044525330),r=c(r,n,i,s,e[t+4],7,-176418897),s=c(s,r,n,i,e[t+5],12,1200080426),i=c(i,s,r,n,e[t+6],17,-1473231341),n=c(n,i,s,r,e[t+7],22,-45705983),r=c(r,n,i,s,e[t+8],7,1770035416),s=c(s,r,n,i,e[t+9],12,-1958414417),i=c(i,s,r,n,e[t+10],17,-42063),n=c(n,i,s,r,e[t+11],22,-1990404162),r=c(r,n,i,s,e[t+12],7,1804603682),s=c(s,r,n,i,e[t+13],12,-40341101),i=c(i,s,r,n,e[t+14],17,-1502002290),n=c(n,i,s,r,e[t+15],22,1236535329),r=p(r,n,i,s,e[t+1],5,-165796510),s=p(s,r,n,i,e[t+6],9,-1069501632),i=p(i,s,r,n,e[t+11],14,643717713),n=p(n,i,s,r,e[t],20,-373897302),r=p(r,n,i,s,e[t+5],5,-701558691),s=p(s,r,n,i,e[t+10],9,38016083),i=p(i,s,r,n,e[t+15],14,-660478335),n=p(n,i,s,r,e[t+4],20,-405537848),r=p(r,n,i,s,e[t+9],5,568446438),s=p(s,r,n,i,e[t+14],9,-1019803690),i=p(i,s,r,n,e[t+3],14,-187363961),n=p(n,i,s,r,e[t+8],20,1163531501),r=p(r,n,i,s,e[t+13],5,-1444681467),s=p(s,r,n,i,e[t+2],9,-51403784),i=p(i,s,r,n,e[t+7],14,1735328473),n=p(n,i,s,r,e[t+12],20,-1926607734),r=d(r,n,i,s,e[t+5],4,-378558),s=d(s,r,n,i,e[t+8],11,-2022574463),i=d(i,s,r,n,e[t+11],16,1839030562),n=d(n,i,s,r,e[t+14],23,-35309556),r=d(r,n,i,s,e[t+1],4,-1530992060),s=d(s,r,n,i,e[t+4],11,1272893353),i=d(i,s,r,n,e[t+7],16,-155497632),n=d(n,i,s,r,e[t+10],23,-1094730640),r=d(r,n,i,s,e[t+13],4,681279174),s=d(s,r,n,i,e[t],11,-358537222),i=d(i,s,r,n,e[t+3],16,-722521979),n=d(n,i,s,r,e[t+6],23,76029189),r=d(r,n,i,s,e[t+9],4,-640364487),s=d(s,r,n,i,e[t+12],11,-421815835),i=d(i,s,r,n,e[t+15],16,530742520),n=d(n,i,s,r,e[t+2],23,-995338651),r=h(r,n,i,s,e[t],6,-198630844),s=h(s,r,n,i,e[t+7],10,1126891415),i=h(i,s,r,n,e[t+14],15,-1416354905),n=h(n,i,s,r,e[t+5],21,-57434055),r=h(r,n,i,s,e[t+12],6,1700485571),s=h(s,r,n,i,e[t+3],10,-1894986606),i=h(i,s,r,n,e[t+10],15,-1051523),n=h(n,i,s,r,e[t+1],21,-2054922799),r=h(r,n,i,s,e[t+8],6,1873313359),s=h(s,r,n,i,e[t+15],10,-30611744),i=h(i,s,r,n,e[t+6],15,-1560198380),n=h(n,i,s,r,e[t+13],21,1309151649),r=h(r,n,i,s,e[t+4],6,-145523070),s=h(s,r,n,i,e[t+11],10,-1120210379),i=h(i,s,r,n,e[t+2],15,718787259),n=h(n,i,s,r,e[t+9],21,-343485551),r=o(r,a),n=o(n,l),i=o(i,u),s=o(s,f)}return[r,n,i,s]}function y(e,t=n.Hex){const r=t||n.Base64,s=f(a(e),e.length*i);switch(r){case n.Raw:return s;case n.Hex:return function(e){const t="0123456789abcdef",r=[];for(let n=0,i=4*e.length;n<i;n++)r.push(t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15));return r.join("")}(s);case n.String:return l(s);case n.Base64:return function(e){const t=[];for(let r=0,n=4*e.length;r<n;r+=3){const n=(e[r>>2]>>r%4*8&255)<<16|(e[r+1>>2]>>(r+1)%4*8&255)<<8|e[r+2>>2]>>(r+2)%4*8&255;for(let i=0;i<4;i++)8*r+6*i>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-i)&63))}return t.join("")}(s)}}},85408:function(e,t,r){r.d(t,{F:function(){return l},Ti:function(){return i}});var n=r(7187);const i=-3,s=i-1;var o,a;(a=o||(o={}))[a.ALL=0]="ALL",a[a.SOME=1]="SOME";class l{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.A,this._users=new n.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,t){const r=this._db.get(e.id+t);return r?.size??0}put(e,t,r,n,a){t=e.id+t;const l=this._db.get(t);if(l&&(this._size-=l.size,e.size-=l.size,this._db.delete(t),l.entry!==r&&this._notifyRemove(t,l.entry,l.size,o.ALL)),n>this._maxSize)return void this._notifyRemove(t,r,n,o.ALL);if(void 0===r)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${t}`),void this._notifyRemove(t,r,0,o.ALL);const c=1+Math.max(a,s)-i;this._db.set(t,new u(r,n,c)),this._size+=n,e.size+=n,this._checkSize()}updateSize(e,t,r,n){t=e.id+t;const i=this._db.get(t);if(i&&i.entry===r){for(this._size-=i.size,e.size-=i.size;n>this._maxSize;){const e=this._notifyRemove(t,r,n,o.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);n=e}i.size=n,this._size+=n,e.size+=n,this._checkSize()}}pop(e,t){t=e.id+t;const r=this._db.get(t);if(r)return this._size-=r.size,e.size-=r.size,this._db.delete(t),++this._hit,r.entry;++this._miss}get(e,t){t=e.id+t;const r=this._db.get(t);if(void 0!==r)return this._db.delete(t),r.lives=r.lifetime,this._db.set(t,r),++this._hit,r.entry;++this._miss}peek(e,t){const r=this._db.get(e.id+t);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},r=new Array;this._db.forEach(((e,n)=>{const i=e.lifetime;r[i]=(r[i]||0)+e.size,this._users.forAll((r=>{const{id:i,name:s}=r;if(n.startsWith(i)){const r=t[s]||0;t[s]=r+e.size}}))}));const n={};this._users.forAll((e=>{const r=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const i=t[r]||0;t[r]=i,n[r]=Math.round(100*e.hitRate)+"%"}else n[r]="0%"}));const s=Object.keys(t);s.sort(((e,r)=>t[r]-t[e])),s.forEach((r=>e[r]=Math.round(t[r]/2**20)+"MB / "+n[r]));for(let t=r.length-1;t>=0;--t){const n=r[t];n&&(e["Priority "+(t+i-1)]=Math.round(n/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,r)=>{r.startsWith(t)&&(this._size-=e.size,this._db.delete(r),this._notifyRemove(r,e.entry,e.size,o.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,e.size,o.ALL))),this._users.forAll((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,r,n){let i;return this._removeFuncs.some((s=>{if(e.startsWith(s[0])){const e=s[1](t,n,r);return"number"==typeof e&&(i=e),!0}return!1})),i}_checkSize(){this._users.forAll((e=>this._checkSizeLimits(e))),this._checkSizeLimits()}_checkSizeLimits(e){const t=e??this;if(t.maxSize<0||t.size<=t.maxSize)return;const r=e?.id;let n=!0;for(;n;){n=!1;for(const[i,s]of this._db)if(0===s.lifetime&&(!r||i.startsWith(r))){if(this._purgeItem(i,s,e),t.size<=.9*t.maxSize)return;n||=this._db.has(i)}}for(const[n,i]of this._db)if((!r||n.startsWith(r))&&(this._purgeItem(n,i,e),t.size<=.9*t.maxSize))return}_purgeItem(e,t,r=this._users.find((t=>e.startsWith(t.id)))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,r&&(r.size-=t.size);const n=this._notifyRemove(e,t.entry,t.size,o.SOME);null!=n&&n>0&&(this._size+=n,r&&(r.size+=n),t.lives=t.lifetime,t.size=n,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}class u{constructor(e,t,r){this.entry=e,this.size=t,this.lifetime=r,this.lives=r}}},77793:function(e,t,r){r.d(t,{P:function(){return b},L:function(){return w}});var n=r(53804),i=r(83525),s=r(90194),o=r(21609),a=r(72977);class l{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(a.AU),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const t=new l,r=this._originStores[a.Gr.DEFAULTS];r&&r.forEach(((e,r)=>{t.set(r,(0,o.o8)(e),a.Gr.DEFAULTS)}));for(let r=a.Gr.SERVICE;r<a.AU;r++){const n=this._originStores[r];n&&n.forEach(((n,i)=>{e&&e.has(i)||t.set(i,(0,o.o8)(n),r)}))}return t}get(e,t){const r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}keys(e){const t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,r=a.Gr.USER){let n=this._originStores[r];if(n||(n=new Map,this._originStores[r]=n),n.set(e,t),!this._values.has(e)||this._propertyOriginMap.get(e)<=r){const n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),n!==t}return!1}delete(e,t=a.Gr.USER){const r=this._originStores[t];if(!r)return;const n=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let r=t-1;r>=0;r--){const t=this._originStores[r];if(t&&t.has(e)){this._values.set(e,t.get(e)),this._propertyOriginMap.set(e,r);break}}}return n}has(e,t){const r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const r=this._originStores[t],n=r?.get(e),i=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,t),i!==n}originOf(e){return this._propertyOriginMap.get(e)||a.Gr.DEFAULTS}forEach(e){this._values.forEach(e)}}var u=r(97354),c=r(63693),p=r(65953);const d=e=>{let t=class extends e{constructor(...e){super(...e);const t=(0,c.oY)(this),r=t.store,n=new l;t.store=n,(0,s.k)(t,r,n)}read(e,t){(0,u.L)(this,e,t)}getAtOrigin(e,t){const r=h(this),n=(0,a.aB)(t);if("string"==typeof e)return r.get(e,n);const i={};return e.forEach((e=>{i[e]=r.get(e,n)})),i}originOf(e){return(0,a.OL)(this.originIdOf(e))}originIdOf(e){return h(this).originOf(e)}revert(e,t){const r=h(this),n=(0,a.aB)(t),i=(0,c.oY)(this);let s;s="string"==typeof e?"*"===e?r.keys(n):[e]:e,s.forEach((e=>{i.invalidate(e),r.revert(e,n),i.commit(e)}))}};return t=(0,n._)([(0,p.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function h(e){return(0,c.oY)(e).store}let f=class extends(d(i.A)){};f=(0,n._)([(0,p.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],f);var y=r(62664),m=r(99495);const g=e=>{let t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return v(this).delete(e,(0,a.aB)(t))}write(e,t){return(0,m.M)(this,e=e||{},t),e}setAtOrigin(e,t,r){(0,c.oY)(this).setAtOrigin(e,t,(0,a.aB)(r))}removeOrigin(e){const t=v(this),r=(0,a.aB)(e),n=t.keys(r);for(const e of n)t.originOf(e)===r&&t.set(e,t.get(e,r),a.Gr.USER)}updateOrigin(e,t){const r=v(this),n=(0,a.aB)(t),i=(0,y.Jt)(this,e);for(let t=n+1;t<a.AU;++t)r.delete(e,t);r.set(e,i,n)}toJSON(e){return this.write({},e)}};return t=(0,n._)([(0,p.$)("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function v(e){return(0,c.oY)(e).store}const b=e=>{let t=class extends(g(d(e))){constructor(...e){super(...e)}};return t=(0,n._)([(0,p.$)("esri.core.MultiOriginJSONSupport")],t),t};let w=class extends(b(i.A)){};w=(0,n._)([(0,p.$)("esri.core.MultiOriginJSONSupport")],w)},72952:function(e,t,r){r.d(t,{EB:function(){return h},Im:function(){return m},Mj:function(){return d},Ui:function(){return y},w2:function(){return f}});var n=r(83525),i=r(78879),s=r(63693);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(e){return e instanceof n.A}function l(e){return e instanceof i.A?Object.keys(e.items):a(e)?(0,s.oY)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof i.A?e.items[t]:e[t]}function c(e){return e?e.declaredClass:null}function p(e,t){const r=e.diff;if(r&&"function"==typeof r)return r(e,t);const n=l(e),i=l(t);if(0===n.length&&0===i.length)return;if(!n.length||!i.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const s=i.filter((e=>!n.includes(e))),d=n.filter((e=>!i.includes(e))),h=n.filter((r=>i.includes(r)&&u(e,r)!==u(t,r))).concat(s,d).sort(),f=c(e);if(f&&o.has(f)&&h.length)return{type:"complete",oldValue:e,newValue:t};let y;const m=a(e)&&a(t);for(const n of h){const i=u(e,n),s=u(t,n);let o;if((m||"function"!=typeof i&&"function"!=typeof s)&&i!==s&&(null!=i||null!=s)){if(r&&r[n]&&"function"==typeof r[n])o=r[n]?.(i,s);else if(i instanceof Date&&s instanceof Date){if(i.getTime()===s.getTime())continue;o={type:"complete",oldValue:i,newValue:s}}else o="object"==typeof i&&"object"==typeof s&&c(i)===c(s)?p(i,s):{type:"complete",oldValue:i,newValue:s};null!=o&&(null!=y?y.diff[n]=o:y={type:"partial",diff:{[n]:o}})}}return y}function d(e,t){return h(e,t)}function h(e,t){if(null==e)return!1;const r=t.split(".");let n=e;for(const e of r){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const t=n.diff[e];if(!t)return!1;n=t}}return!0}function f(e,t){if(!e)return!1;if("partial"===e.type){const r=Object.keys(e.diff);return 1===r.length&&r[0]===t}return!1}function y(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&c(e)!==c(t)?{type:"complete",oldValue:e,newValue:t}:p(e,t)}function m(e){if(null==e)return!0;switch(e.type){case"complete":return!1;case"collection":{const t=e;for(const e of t.added)if(!m(e))return!1;for(const e of t.removed)if(!m(e))return!1;for(const e of t.changed)if(!m(e))return!1;return!0}case"partial":for(const t in e.diff)if(!m(e.diff[t]))return!1;return!0}}},64786:function(e,t,r){r.d(t,{K:function(){return n}});const n=["operational-layers","basemap","ground"]},75505:function(e,t,r){r.d(t,{$:function(){return v},IB:function(){return a},Iy:function(){return R},N2:function(){return b},QP:function(){return L},RH:function(){return _},Vl:function(){return E},Ws:function(){return S},ZD:function(){return w},_L:function(){return A},bJ:function(){return T},e$:function(){return x},f6:function(){return N},pW:function(){return I},pf:function(){return C}});var n=r(52874),i=r(50659),s=r(21609),o=(r(33400),r(41546));function a(e){return"r"in e&&"g"in e&&"b"in e}function l(e){return"h"in e&&"s"in e&&"v"in e}function u(e){return"l"in e&&"a"in e&&"b"in e}function c(e){return"l"in e&&"c"in e&&"h"in e}const p=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],d=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function h(e,t){const r=[];let n,i;if(e[0].length!==t.length)throw new Error("dimensions do not match");const s=e.length,o=e[0].length;let a=0;for(n=0;n<s;n++){for(a=0,i=0;i<o;i++)a+=e[n][i]*t[i];r.push(a)}return r}function f(e){const t=[e.r/255,e.g/255,e.b/255].map((e=>e<=.04045?e/12.92:((e+.055)/1.055)**2.4)),r=h(p,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function y(e){const t=h(d,[e.x/100,e.y/100,e.z/100]).map((e=>{const t=e<=.0031308?12.92*e:1.055*e**(1/2.4)-.055;return Math.min(1,Math.max(t,0))}));return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function m(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map((e=>e>(6/29)**3?e**(1/3):1/3*(29/6)**2*e+4/29));return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function g(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map((e=>e>6/29?e**3:3*(6/29)**2*(e-4/29)));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function v(e){return a(e)?e:c(e)?function(e){return y(g(function(e){const t=e.l,r=e.c,n=e.h;return{l:t,a:r*Math.cos(n),b:r*Math.sin(n)}}(e)))}(e):u(e)?function(e){return y(g(e))}(e):function(e){return"x"in e&&"y"in e&&"z"in e}(e)?y(e):l(e)?function(e){const t=(e.h+360)%360/60,r=e.s/100,n=e.v/100*255,i=n*r,s=i*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:i,g:s,b:0};break;case 1:o={r:s,g:i,b:0};break;case 2:o={r:0,g:i,b:s};break;case 3:o={r:0,g:s,b:i};break;case 4:o={r:s,g:0,b:i};break;case 5:case 6:o={r:i,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+n-i),o.g=Math.round(o.g+n-i),o.b=Math.round(o.b+n-i),o}(e):e}function b(e){return l(e)?e:function(e){const t=e.r,r=e.g,n=e.b,i=Math.max(t,r,n),s=i-Math.min(t,r,n);let o=i,a=0===s?0:i===t?(r-n)/s%6:i===r?(n-t)/s+2:(t-r)/s+4,l=0===s?0:s/o;return a<0&&(a+=6),a*=60,l*=100,o*=100/255,{h:a,s:l,v:o}}(v(e))}function w(e){return u(e)?e:function(e){return m(f(e))}(v(e))}function _(e){return c(e)?e:function(e){return function(e){const t=e.l,r=e.a,n=e.b,i=Math.sqrt(r*r+n*n);let s=Math.atan2(n,r);return s=s>0?s:s+2*Math.PI,{l:t,c:i,h:s}}(m(f(e)))}(v(e))}function S(e,t){const{r:r,g:i,b:s}=t?.ignoreAlpha?e:function(e){let{r:t,g:r,b:i,a:s}=e;return s<1&&(t=Math.round(s*t+255*(1-s)),r=Math.round(s*r+255*(1-s)),i=Math.round(s*i+255*(1-s))),new n.A({r:t,g:r,b:i})}(e);return.2126*r+.7152*i+.0722*s}var I,M;function T(e,t=I.High){return S(e,{ignoreAlpha:!0})>t?new n.A([0,0,0,e.a]):new n.A([255,255,255,e.a])}function x(e,t){const r=w(e);r.l*=1-t;const n=v(r),i=e.clone();return i.setColor(n),i.a=e.a,i}function A(e,t){const r=e.clone();return r.a*=t,r}function E(e,t){const r=b(e);r.s*=t;const n=v(r),i=e.clone();return i.setColor(n),i.a=e.a,i}function L(e){return n.A.toUnitRGBA(e)}function C(e){return(0,o.fA)(e[0],e[1],e[2],e.length>3?e[3]:1)}function N(e,t){const r=n.A.toUnitRGBA(e);return r[3]*=t,r}function R(e,t,r={}){if(0===e.length||t<=0)return[];if(1===(e=e.map((e=>"string"==typeof e?new n.A(e):e))).length||1===t){const r=[],n=e[0];for(let e=0;e<t;e++)r.push(n.clone());return r}if(r.shuffle&&(e=(0,i.k4)((0,s.o8)(e),r.seed)),e.length>=t){const r=[],n=(e.length-1)/(t-1);for(let i=0;i<t;i++){const t=Math.round(i*n);r.push(e[t].clone())}return r}return function(e,t,r={}){const n=[],s=e.length-1,o=Math.ceil((t-e.length)/s);e:for(let i=0;i<s;i++){const s=e[i],a=e[i+1];for(let i=1;i<=o;i++){const l=i/(o+1);if(n.push(F(s,a,l,r)),n.length+e.length===t)break e}}return[...e.map((e=>e.clone())),...(0,i.k4)(n,r.seed??1)]}(e,t,r)}(M=I||(I={}))[M.Low=160]="Low",M[M.High=225]="High";const O=(e,t)=>{const r=Math.floor(10*t())-5;return Math.min(255,Math.max(0,e+r))};function F(e,t,r,s={}){const o=e.r,a=e.g,l=e.b,u=t.r,c=t.g,p=t.b,d=Math.round(o+(u-o)*r),h=Math.round(a+(c-a)*r),f=Math.round(l+(p-l)*r);if(!s.offset)return new n.A([d,h,f]);const y=(0,i.Mo)(s.seed);return new n.A([O(d,y),O(h,y),O(f,y)])}},50612:function(e,t,r){r.d(t,{E:function(){return M},w:function(){return o}});var n=r(50659),i=(r(58941),r(7187)),s=r(88923);class o{constructor(e=9,t){this._compareMinX=p,this._compareMinY=d,this._toBBox=e=>e,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),w.prune(),_.prune(),S.prune(),I.prune()}all(e){a(this._data,e)}search(e,t){let r=this._data;const n=this._toBBox;if(v(e,r))for(w.clear();r;){for(let i=0,s=r.children.length;i<s;i++){const s=r.children[i],o=r.leaf?n(s):s;v(e,o)&&(r.leaf?t(s):g(e,o)?a(s,t):w.push(s))}r=w.pop()}}collides(e){let t=this._data;const r=this._toBBox;if(!v(e,t))return!1;for(w.clear();t;){for(let n=0,i=t.children.length;n<i;n++){const i=t.children[n],s=t.leaf?r(i):i;if(v(e,s)){if(t.leaf||g(e,s))return!0;w.push(i)}}t=w.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}let t=this._build(e.slice(),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const e=this._data;this._data=t,t=e}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new x([]),this}remove(e){if(!e)return this;let t,r=this._data,i=null,s=0,o=!1;const a=this._toBBox(e);for(S.clear(),I.clear();r||S.length>0;){if(r||(r=S.pop(),i=S.data[S.length-1],s=I.pop()??0,o=!0),r.leaf&&(t=(0,n.qh)(r.children,e,r.children.length,r.indexHint),-1!==t))return r.children.splice(t,1),S.push(r),this._condense(S),this;o||r.leaf||!g(r,a)?i?(s++,r=i.children[s],o=!1):r=null:(S.push(r),I.push(s),s=0,i=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,r,n){const i=r-t+1;let s=this._maxEntries;if(i<=s){const n=new x(e.slice(t,r+1));return l(n,this._toBBox),n}n||(n=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/s**(n-1)));const o=new A([]);o.height=n;const a=Math.ceil(i/s),u=a*Math.ceil(Math.sqrt(s));b(e,t,r,u,this._compareMinX);for(let i=t;i<=r;i+=u){const t=Math.min(i+u-1,r);b(e,i,t,a,this._compareMinY);for(let r=i;r<=t;r+=a){const i=Math.min(r+a-1,t);o.children.push(this._build(e,r,i,n-1))}}return l(o,this._toBBox),o}_insert(e,t,r){const n=this._toBBox,i=r?e:n(e);S.clear();const s=function(e,t,r,n){for(;n.push(t),!0!==t.leaf&&n.length-1!==r;){let r,n=1/0,i=1/0;for(let s=0,o=t.children.length;s<o;s++){const o=t.children[s],a=h(o),l=y(e,o)-a;l<i?(i=l,n=a<n?a:n,r=o):l===i&&a<n&&(n=a,r=o)}t=r||t.children[0]}return t}(i,this._data,t,S);for(s.children.push(e),c(s,i);t>=0&&S.data[t].children.length>this._maxEntries;)this._split(S,t),t--;!function(e,t,r){for(let n=r;n>=0;n--)c(t.data[n],e)}(i,S,t)}_split(e,t){const r=e.data[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);const s=this._chooseSplitIndex(r,i,n);if(!s)return;const o=r.children.splice(s,r.children.length-s),a=r.leaf?new x(o):new A(o);a.height=r.height,l(r,this._toBBox),l(a,this._toBBox),t?e.data[t-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,t){this._data=new A([e,t]),this._data.height=e.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(e,t,r){let n,i,s;n=i=1/0;for(let o=t;o<=r-t;o++){const t=u(e,0,o,this._toBBox),a=u(e,o,r,this._toBBox),l=m(t,a),c=h(t)+h(a);l<n?(n=l,s=o,i=c<i?c:i):l===n&&c<i&&(i=c,s=o)}return s}_chooseSplitAxis(e,t,r){const n=e.leaf?this._compareMinX:p,i=e.leaf?this._compareMinY:d;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)}_allDistMargin(e,t,r,n){e.children.sort(n);const i=this._toBBox,s=u(e,0,t,i),o=u(e,r-t,r,i);let a=f(s)+f(o);for(let n=t;n<r-t;n++){const t=e.children[n];c(s,e.leaf?i(t):t),a+=f(s)}for(let n=r-t-1;n>=t;n--){const t=e.children[n];c(o,e.leaf?i(t):t),a+=f(o)}return a}_condense(e){for(let t=e.length-1;t>=0;t--){const r=e.data[t];if(0===r.children.length)if(t>0){const i=e.data[t-1],s=i.children;s.splice((0,n.qh)(s,r,s.length,i.indexHint),1)}else this.clear();else l(r,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function a(e,t){let r=e;for(_.clear();r;){if(!0===r.leaf)for(const e of r.children)t(e);else _.pushArray(r.children);r=_.pop()??null}}function l(e,t){u(e,0,e.children.length,t,e)}function u(e,t,r,n,i){i||(i=new x([])),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s,o=t;o<r;o++)s=e.children[o],c(i,e.leaf?n(s):s);return i}function c(e,t){e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY)}function p(e,t){return e.minX-t.minX}function d(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function y(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){const r=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,i-r)*Math.max(0,s-n)}function g(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function b(e,t,r,n,i){const o=[t,r];for(;o.length;){const t=o.pop(),r=o.pop();if(t-r<=n)continue;const a=r+Math.ceil((t-r)/n/2)*n;(0,s.q)(e,a,r,t,i),o.push(r,a,a,t)}}const w=new i.A,_=new i.A,S=new i.A,I=new i.A({deallocator:void 0});class M{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class T extends M{constructor(){super(...arguments),this.height=1,this.indexHint=new n.vW}}class x extends T{constructor(e){super(),this.children=e,this.leaf=!0}}class A extends T{constructor(e){super(),this.children=e,this.leaf=!1}}},75218:function(e,t,r){r.d(t,{L:function(){return a},g:function(){return o}});var n=r(77472),i=r(78879),s=r(31609);async function o(e,t){return await e.load(),a(e,t)}async function a(e,t){const r=[],o=(...e)=>{for(const t of e)null!=t&&(Array.isArray(t)?o(...t):i.A.isCollection(t)?t.forEach((e=>o(e))):s.A.isLoadable(t)&&r.push(t))};t(o);let a=null;if(await(0,n.Tj)(r,(async e=>{const t=await(0,n.Ke)(function(e){return"loadAll"in e&&"function"==typeof e.loadAll}(e)?e.loadAll():e.load());!1!==t.ok||a||(a=t)})),a)throw a.error;return e}},83324:function(e,t,r){r.d(t,{M:function(){return u},s:function(){return l}});var n=r(42042),i=r(93393),s=r(359),o=r(70891),a=r(96285);function l(e,t){const r=c[e.toLowerCase()];if(null==r)throw new i.L8(i.Z7.FunctionNotRecognized);if(t.length<r.minParams||t.length>r.maxParams)throw new i.L8(i.Z7.InvalidParameterCount,{name:e.toUpperCase()});return r.evaluate(t)}function u(e,t){const r=c[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}const c={min:{minParams:1,maxParams:1,evaluate:e=>h(e[0],"min")},max:{minParams:1,maxParams:1,evaluate:e=>h(e[0],"max")},avg:{minParams:1,maxParams:1,evaluate:e=>p(e[0])},sum:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;let t=0;for(let r=0;r<e.length;r++){const n=e[r];if(null!==n){if(!d(n))throw new i.L8(i.Z7.InvalidValueForAggregateFunction);t+=n}}return t}(e[0])},stddev:{minParams:1,maxParams:1,evaluate:e=>function(e){if(null===e)return null;const t=f(e);return null===t?null:Math.sqrt(t)}(e[0])},count:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].length},var:{minParams:1,maxParams:1,evaluate:e=>f(e[0])}};function p(e){if(null===e)return null;let t=0,r=0;for(let n=0;n<e.length;n++){const s=e[n];if(null!==s){if(!d(s))throw new i.L8(i.Z7.InvalidValueForAggregateFunction);r++,t+=s}}return 0===r?null:t/e.length}function d(e){return"number"==typeof e}function h(e,t){if(null===e)return null;let r=null,i=null;for(const l of e){let e=l;e=l instanceof n.n||l instanceof o.k?l.toNumber():l instanceof a.c9?l.toMillis():l instanceof s.g?l.toMilliseconds():l,(null===r||"max"===t&&null!==i&&null!==e&&i<=e||"min"===t&&null!==i&&null!==e&&i>=e)&&(r=l,i=e)}return r}function f(e){if(null===e)return null;if(0===(e=e.filter((e=>null!==e))).length)return null;const t=p(e);if(null===t)return null;let r=0;for(const n of e){if(!d(n))throw new i.L8(i.Z7.InvalidValueForAggregateFunction);r+=(t-n)**2}return r/(e.length-1)}},42042:function(e,t,r){r.d(t,{n:function(){return a}});var n=r(9688),i=r(22739),s=r(96285);function o(e){e=e.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$&]");let t="";const r=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const n of e.match(r)||[])switch(n){case"D":t+="d";break;case"DD":t+="dd";break;case"DDD":t+="o";break;case"d":t+="c";break;case"ddd":t+="ccc";break;case"dddd":t+="cccc";break;case"M":t+="L";break;case"MM":t+="LL";break;case"MMM":t+="LLL";break;case"MMMM":t+="LLLL";break;case"YY":t+="yy";break;case"Y":case"YYYY":t+="yyyy";break;case"Q":t+="q";break;case"X":case"x":t+=n;break;default:n.length>=2&&"["===n.slice(0,1)&&"]"===n.slice(-1)?t+=`'${n.slice(1,-1)}'`:t+=`'${n}'`}return t}class a{constructor(e,t,r){this._year=e,this._month=t,this._day=r,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof a&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new a(this._year,this._month,this._day)}toDateTime(e){return s.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,n.mT)(e)})}toDateTimeLuxon(e){return s.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,n.mT)(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null,t=!0){if(null===e||""===e)return this.toString();if(t&&(e=o(e)),!e)return"";const r=this.toDateTime("unknown");return n.lY.dateTimeToArcadeDate(r).toFormat(e,{locale:(0,i.JK)(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return n.lY.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(e,t){return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}toUTCDateTime(){return s.c9.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const t=s.c9.fromMillis(e,{zone:s.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromSeconds(e){const t=s.c9.fromSeconds(e,{zone:s.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromReader(e){if(!e)return null;const t=e.split("-");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))}static fromParts(e,t,r){const n=new a(e,t,r);return!1===n.isValid?null:n}static fromDateJS(e){return a.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return a.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const r=[];if(t)(t=o(t))&&r.push(t);else if(null===t||""===t){const t=s.c9.fromISO(e,{setZone:!0});return t.isValid?a.fromParts(t.year,t.month,t.day):null}for(const n of r){const r=s.c9.fromFormat(e,t??n);if(r.isValid)return new a(r.year,r.month,r.day)}return null}static fromNow(e="system"){const t=s.c9.fromJSDate(new Date).setZone((0,n.mT)(e));return new a(t.year,t.month,t.day)}}},359:function(e,t,r){r.d(t,{g:function(){return s}});var n=r(96285);function i(e){return Number.isNaN(e)||0===e?e:Math.trunc(e)}class s{constructor(e){this._timeStampOffset=e,this._date=null}toDateTime(){return this._date??=n.c9.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return i(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return i(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return s.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new s(n.c9.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(e){return new s(e.toISO({includeOffset:!0}))}static fromParts(e,t,r=0,n=0,i=0,o=0,a=0,l=!1,u=0,c=0){const p=`${e.toString().padStart(4,"0")}-${t.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`;let d="";o<10&&(d="0");let h=`${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${d+o.toString()}`;0!==a&&(h+="."+a.toString().padStart(3,"0"));const f=`${l?"-":"+"}${u.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`;return new s(p+"T"+h+f)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let e=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return e&&(e=e.replace(".000","")),e}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(e){const t=this.toDateTime().plus(e);return s.fromDateTime(t)}}},70891:function(e,t,r){r.d(t,{k:function(){return a}});var n=r(80749),i=r(22739),s=r(96285);function o(e){if(!e)return"";const t=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let r="";for(const n of e.match(t)||[])switch(n){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":r+=n;break;case"A":case"a":r+="a";break;default:r+=`'${n}'`}return r}class a{constructor(e,t,r,n){this._hour=e,this._minute=t,this._second=r,this._millisecond=n,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof a&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new a(this.hour,this.minute,this.second,this.millisecond)}isValid(){return(0,n.Fq)(this.hour)&&(0,n.Fq)(this.minute)&&(0,n.Fq)(this.second)&&(0,n.Fq)(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return null===e||""===e?this.toString():(e=o(e))?s.c9.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:(0,i.JK)(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,t,r,n){const i=new a(e,t,r,n);return i.isValid()?i:null}static fromReader(e){if(!e)return null;const t=e.split(":");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const t=Math.floor(e/1e3%60),r=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),i=Math.floor(e%1e3);return new a(n,r,t,i)}static fromDateJS(e){return new a(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new a(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const r=[];t?(t=o(t))&&r.push(t):null!==t&&""!==t||(r.push("HH:mm:ss"),r.push("HH:mm:ss.SSS"),r.push("hh:mm:ss a"),r.push("hh:mm:ss.SSS a"),r.push("HH:mm"),r.push("hh:mm a"),r.push("H:mm"),r.push("h:mm a"),r.push("H:mm:ss"),r.push("h:mm:ss a"),r.push("H:mm:ss.SSS"),r.push("h:mm:ss.SSS a"));for(const t of r){const r=s.c9.fromFormat(e,t);if(r.isValid)return new a(r.hour,r.minute,r.second,r.millisecond)}return null}plus(e,t){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}return null}toUTCDateTime(){return s.c9.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}}},92955:function(e,t,r){r.d(t,{GB:function(){return i},Qo:function(){return o},Y4:function(){return s}});var n=r(96285);class i{}function s(e){return e instanceof n.bo?e===i.instance:"unknown"===e?.toString().toLowerCase()}function o(e){return s(e)?i.instance:e}i.instance=new n.oh("Etc/UTC")},16177:function(e,t,r){r.r(t),r.d(t,{WhereClause:function(){return te},defaultAttributeAdapter:function(){return de}});var n=r(9688),i=r(58941),s=r(83324),o=r(42042),a=r(93393);class l{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(e){if(null!==e.precision||null!==e.secondary)throw new a.L8(a.Z7.PrimarySecondaryQualifiers)}static _parseSecondsComponent(e,t){if(t.includes(".")){const r=t.split(".");e.second=parseFloat(r[0]),e.millis=parseInt(r[1],10)}else e.second=parseFloat(t)}static createFromMilliseconds(e){const t=new l;return t.second=e/1e3,t}static createFromValueAndQualifier(e,t,r){let n=null;const i=new l;if(i.op="-"===r?"-":"+","interval-period"===t.type){l._fixDefaults(t);const r=new RegExp("^[0-9]{1,}$");if("year"===t.period||"month"===t.period)throw new a.L8(a.Z7.YearMonthIntervals);if("second"===t.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(e))throw new a.L8(a.Z7.IllegalInterval);l._parseSecondsComponent(i,e)}else{if(!r.test(e))throw new a.L8(a.Z7.IllegalInterval);i[t.period]=parseFloat(e)}}else{if(l._fixDefaults(t.start),l._fixDefaults(t.end),"year"===t.start.period||"month"===t.start.period||"year"===t.end.period||"month"===t.end.period)throw new a.L8(a.Z7.YearMonthIntervals);switch(t.start.period){case"day":switch(t.end.period){case"hour":if(n=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);i[t.start.period]=parseFloat(e.split(" ")[0]),i[t.end.period]=parseFloat(e.split(" ")[1]);break;case"minute":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);{i[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");i.hour=parseFloat(r[0]),i.minute=parseFloat(r[1])}break;case"second":if(n=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);{i[t.start.period]=parseFloat(e.split(" ")[0]);const r=e.split(" ")[1].split(":");i.hour=parseFloat(r[0]),i.minute=parseFloat(r[1]),l._parseSecondsComponent(i,r[2])}break;default:throw new a.L8(a.Z7.IllegalInterval)}break;case"hour":switch(t.end.period){case"minute":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);i.hour=parseFloat(e.split(":")[0]),i.minute=parseFloat(e.split(":")[1]);break;case"second":if(n=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);{const t=e.split(":");i.hour=parseFloat(t[0]),i.minute=parseFloat(t[1]),l._parseSecondsComponent(i,t[2])}break;default:throw new a.L8(a.Z7.IllegalInterval)}break;case"minute":if("second"!==t.end.period)throw new a.L8(a.Z7.IllegalInterval);if(n=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!n.test(e))throw new a.L8(a.Z7.IllegalInterval);{const t=e.split(":");i.minute=parseFloat(t[0]),l._parseSecondsComponent(i,t[1])}break;default:throw new a.L8(a.Z7.IllegalInterval)}}return i}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}var u=r(359),c=r(70891),p=r(92955),d=r(96285);const h=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,f=/^(\d{1,2}):(\d{1,2})$/,y=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,m=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,g=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,v=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,b=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function _(e,t){if(t instanceof d.bo)return t===p.GB.instance?d.c9.fromMillis(e.getTime(),{zone:p.GB.instance}):d.c9.fromJSDate(e,{zone:t});switch(t){case"system":case"local":case null:return d.c9.fromJSDate(e);default:return"unknown"===t?.toLowerCase()?d.c9.fromMillis(e.getTime(),{zone:p.GB.instance}):d.c9.fromJSDate(e,{zone:t})}}function S(e){return"number"==typeof e}function I(e){return"string"==typeof e||e instanceof String}function M(e){return e instanceof l}function T(e){return e instanceof Date}function x(e){return e instanceof d.c9}function A(e){return e instanceof o.n}function E(e){return e instanceof c.k}function L(e){return e instanceof u.g}function C(e){let t=h.exec(e);if(null!==t){const[,e,r,n]=t,i=c.k.fromParts(parseInt(e,10),parseInt(r,10),parseInt(n,10),0);if(null!==i)return i;throw new a.L8(a.Z7.InvalidTime)}if(t=f.exec(e),null!==t){const[,e,r]=t,n=c.k.fromParts(parseInt(e,10),parseInt(r,10),0,0);if(null!==n)return n;throw new a.L8(a.Z7.InvalidTime)}if(t=y.exec(e),null!==t){const[,e,r,n,i]=t,s=c.k.fromParts(parseInt(e,10),parseInt(r,10),parseInt(n,10),parseInt(i,10));if(null!==s)return s;throw new a.L8(a.Z7.InvalidTime)}throw new a.L8(a.Z7.InvalidTime)}function N(e,t,r=!1){let n=g.exec(e);if(null!==n){const[,e,r,i,s,o,l,u]=n,c=d.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(i,10),hour:parseInt(s,10),minute:parseInt(o,10),second:parseInt(l,10),millisecond:u?parseInt(u.replace(".",""),10):0},{zone:(0,p.Qo)(t)});if(!1===c.isValid)throw new a.L8(a.Z7.InvalidTimeStamp);return c}if(n=v.exec(e),null!==n){const[,e,t,r,i,s,o,l,c,p,d]=n,h=u.g.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(i,10),parseInt(s,10),parseInt(o,10),l?parseInt(l.replace(".",""),10):0,"-"===c,parseInt(p,10),parseInt(d,10));if(!1===h.isValid)throw new a.L8(a.Z7.InvalidTimeStamp);return h}if(n=b.exec(e),null!==n){const[,e,t,r,i,s,o,l,c]=n,p=u.g.fromParts(parseInt(e,10),parseInt(t,10),parseInt(r,10),parseInt(i,10),parseInt(s,10),0,0,"-"===o,parseInt(l,10),parseInt(c,10));if(!1===p.isValid)throw new a.L8(a.Z7.InvalidTimeStamp);return p}if(n=w.exec(e),null!==n){const[,e,r,i,s,o]=n,l=d.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(i,10),hour:parseInt(s,10),minute:parseInt(o,10),second:0},{zone:(0,p.Qo)(t)});if(!1===l.isValid)throw new a.L8(a.Z7.InvalidTimeStamp);return l}if(n=m.exec(e),null!==n){const[,e,r,i]=n,s=d.c9.fromObject({year:parseInt(e,10),month:parseInt(r,10),day:parseInt(i,10),hour:0,minute:0,second:0},{zone:(0,p.Qo)(t)});if(!1===s.isValid)throw new a.L8(a.Z7.InvalidTimeStamp);return s}throw new a.L8(a.Z7.InvalidTimeStamp)}function R(e,t){const r=m.exec(e);if(null===r)try{return N(e,t)}catch{throw new a.L8(a.Z7.InvalidDate)}const[,n,i,s]=r,l=o.n.fromParts(parseInt(n,10),parseInt(i,10),parseInt(s,10));if(null===l)throw new a.L8(a.Z7.InvalidDate);return l}var O=r(15774),F=r(50944);function k(e){return!!x(e)||!!L(e)}function D(e){return!!(x(e)||A(e)||L(e)||E(e))}function P(e){if(x(e))return e.toMillis();if(A(e))return e.toNumber();if(L(e))return e.toMilliseconds();throw new a.L8(a.Z7.InvalidDataType)}function V(e,t,r,n){if(null==e||null==t)return null;if(S(e)){if(S(t))return Z(e,t,r);if(I(t))return function(e,t,r){const n=parseFloat(t);if(!isNaN(n))return Z(e,n,r);const i=e.toString();switch(r){case"<>":return i!==t;case"=":return i===t;case">":return i>t;case"<":return i<t;case">=":return i>=t;case"<=":return i<=t}}(e,t,r);if(D(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))throw new a.L8(a.Z7.InvalidOperator)}else if(I(e)){if(S(t))return function(e,t,r){const n=parseFloat(e);if(!isNaN(n))return Z(n,t,r);const i=t.toString();switch(r){case"<>":return e!==i;case"=":return e===i;case">":return e>i;case"<":return e<i;case">=":return e>=i;case"<=":return e<=i}}(e,t,r);if(I(t))return function(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}(e,t,r);if(x(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))throw new a.L8(a.Z7.InvalidOperator);if(E(t))throw new a.L8(a.Z7.InvalidOperator);if(L(t))throw new a.L8(a.Z7.InvalidOperator)}else if(x(e)){if(k(t)){if(e instanceof d.c9&&(0,p.Y4)(e.zone)){if(t instanceof d.c9&&!1===(0,p.Y4)(t.zone))return G(e,t,r);if(t instanceof u.g)return G(e,t,r)}else if(t instanceof d.c9&&(0,p.Y4)(t.zone)){if(e instanceof d.c9&&!1===(0,p.Y4)(e.zone))return G(e,t,r);if(e instanceof u.g)return G(e,t,r)}return Z(P(e),P(t),r)}if(I(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))return function(e,t,r){const n=t.toDateTimeLuxon(e.zone);return Z((e=e.startOf("day")).toMillis(),n.toMillis(),r)}(e,t,r);if(E(t))throw new a.L8(a.Z7.InvalidOperator);if(S(t))throw new a.L8(a.Z7.InvalidOperator)}else if(A(e)){if(L(t))return function(e,t,r){const n=e.toDateTimeLuxon(t.toDateTime().zone);return t=t.startOfDay(),Z(n.toMillis(),t.toMilliseconds(),r)}(e,t,r);if(x(t))return function(e,t,r){const n=e.toDateTimeLuxon(t.zone);return t=t.startOf("day"),Z(n.toMillis(),t.toMillis(),r)}(e,t,r);if(I(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))return Z(e.toNumber(),t.toNumber(),r);if(E(t))throw new a.L8(a.Z7.InvalidOperator);if(S(t))throw new a.L8(a.Z7.InvalidOperator)}else if(E(e)){if(E(t))return Z(e.toNumber(),t.toNumber(),r);if(I(t))throw new a.L8(a.Z7.InvalidOperator);if(S(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))throw new a.L8(a.Z7.InvalidOperator);if(k(t))throw new a.L8(a.Z7.InvalidOperator)}else if(L(e)){if(k(t))return t instanceof d.c9&&(0,p.Y4)(t.zone)?G(e,t,r):Z(P(e),P(t),r);if(I(t))throw new a.L8(a.Z7.InvalidOperator);if(A(t))return function(e,t,r){const n=t.toDateTimeLuxon(e.toDateTime().zone);return Z((e=e.startOfDay()).toMilliseconds(),n.toMillis(),r)}(e,t,r);if(E(t))throw new a.L8(a.Z7.InvalidOperator);if(S(t))throw new a.L8(a.Z7.InvalidOperator)}switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function Z(e,t,r){switch(r){case"<>":return e!==t;case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}}function G(e,t,r){e instanceof u.g&&(e=e.toDateTime()),t instanceof u.g&&(t=t.toDateTime());const n=j(e),i=j(t);switch(r){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function j(e){return 321408e5*e.year+26784e5*e.month+864e5*e.day+36e5*e.hour+6e4*e.minute+1e3*e.second+e.millisecond}function z(e,t,r){const n=$[e.toLowerCase()];if(null==n)throw new a.L8(a.Z7.FunctionNotRecognized);if(t.length<n.minParams||t.length>n.maxParams)throw new a.L8(a.Z7.InvalidParameterCount,{name:e.toUpperCase()});return n.evaluate(t,r)}function U(e){return"string"==typeof e||e instanceof String}function q(e){return!(T(e)||A(e)||x(e)||E(e)||L(e))}function B(e){return A(e)||E(e)?e.toString():L(e)?e.toSQLValue():x(e)?0===e.millisecond?e.toFormat("yyyy-LL-dd HH:mm:ss"):e.toSQL({includeOffset:!1}):T(e)?B(d.c9.fromJSDate(e)):e.toString()}const $={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(T(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(x(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new a.L8(a.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}else if(A(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new a.L8(a.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}else if(E(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(L(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes}throw new a.L8(a.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:e=>{if(2===e.length){const[t,r]=e;return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){const[t,r,n]=e;return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:([e,t])=>null==e||null==t?null:t.indexOf(e)+1},trim:{minParams:2,maxParams:3,evaluate:e=>{const t=3===e.length,r=t?e[1]:" ",n=t?e[2]:e[1];if(null==r||null==n)return null;const i=`(${(0,F.Cj)(r)})`;switch(e[0]){case"BOTH":return n.replaceAll(new RegExp(`^${i}*|${i}*$`,"g"),"");case"LEADING":return n.replaceAll(new RegExp(`^${i}*`,"g"),"");case"TRAILING":return n.replaceAll(new RegExp(`${i}*$`,"g"),"")}throw new a.L8(a.Z7.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.abs(e[0])},ceiling:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.ceil(e[0])},floor:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.floor(e[0])},log:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])},log10:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.log(e[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sin(e[0])},cos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cos(e[0])},tan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tan(e[0])},asin:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.asin(e[0])},acos:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.acos(e[0])},atan:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.atan(e[0])},sign:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0]>0?1:e[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]**e[1]},mod:{minParams:2,maxParams:2,evaluate:e=>null==e[0]||null==e[1]?null:e[0]%e[1]},round:{minParams:1,maxParams:2,evaluate:e=>{const t=e[0],r=2===e.length?10**e[1]:1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length||0===e[1]?Math.trunc(e[0]):(0,O.pF)("trunc",e[0],-Number(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:e=>U(e[0])?e[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:e=>{let t="";for(let r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:e[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:e=>{for(const t of e)if(null!==t)return t;return null}},cosh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.cosh(e[0])},sinh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.sinh(e[0])},tanh:{minParams:1,maxParams:1,evaluate:e=>null==e[0]?null:Math.tanh(e[0])},nullif:{minParams:2,maxParams:2,evaluate:(e,t)=>V(e[0],e[1],"=")?null:e[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{const r=e[0],n=e[1];if(null===r)return null;switch(n.type){case"integer":{if(!q(r))throw new a.L8(a.Z7.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new a.L8(a.Z7.CannotCastValue);return e}case"smallint":{if(!q(r))throw new a.L8(a.Z7.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new a.L8(a.Z7.CannotCastValue);if(e>32767||e<-32767)throw new a.L8(a.Z7.CannotCastValue);return e}case"float":case"real":{if(!q(r))throw new a.L8(a.Z7.CannotCastValue);const e=parseFloat(r);if(isNaN(e))throw new a.L8(a.Z7.CannotCastValue);return e}case"time":return function(e){if(T(e))return c.k.fromDateJS(e);if(x(e))return c.k.fromDateTime(e);if(A(e))throw new a.L8(a.Z7.CannotCastValue);if(E(e))return e;if(L(e))return c.k.fromSqlTimeStampOffset(e);if(U(e))return C(e);throw new a.L8(a.Z7.CannotCastValue)}(r);case"date":return function(e){if(T(e))return o.n.fromDateJS(e);if(x(e))return o.n.fromParts(e.year,e.month,e.day);if(A(e))return e;if(E(e))throw new a.L8(a.Z7.CannotCastValue);if(L(e)&&null===o.n.fromParts(e.year,e.month,e.day))throw new a.L8(a.Z7.CannotCastValue);if(U(e)){const t=o.n.fromReader(e);if(null!==t&&t.isValid)return t}throw new a.L8(a.Z7.CannotCastValue)}(r);case"timestamp":return function(e,t,r){if(T(e))return _(e,t);if(x(e))return e;if(A(e))return e.toDateTimeLuxon("unknown");if(E(e))throw new a.L8(a.Z7.CannotCastValue);if(L(e))return e;if(U(e))return N(e,"unknown",r);throw new a.L8(a.Z7.CannotCastValue)}(r,t,!0===n.withtimezone);case"varchar":{const e=B(r);if(e.length>n.size)throw new a.L8(a.Z7.CannotCastValue);return e}default:throw new a.L8(a.Z7.InvalidDataType)}}}};function H(e,t,r,n){if("||"===e)return z("concat",[t,r],n);if(null===t||null===r)return null;if(S(t)){if(S(r))return J(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return l.createFromMilliseconds(e+t.valueInMilliseconds());case"-":return l.createFromMilliseconds(e-t.valueInMilliseconds());case"*":return l.createFromMilliseconds(e*t.valueInMilliseconds());case"/":return l.createFromMilliseconds(e/t.valueInMilliseconds())}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(L(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(x(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(I(r))return function(e,t,r){const n=parseFloat(t);if(isNaN(n))throw new a.L8(a.Z7.InvalidOperator);return J(e,n,r)}(t,r,e);throw new a.L8(a.Z7.InvalidOperator)}if(A(t)){if(S(r))return function(e,t,r){const n=1e3*t*24*60*60;switch(r){case"+":return e.plus("milliseconds",n);case"-":return e.plus("milliseconds",-1*n)}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon("UTC").diff(t.toDateTimeLuxon("UTC")).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon(t.toDateTime().zone).diff(t.toDateTime()).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(x(r))return function(e,t,r){if("-"===r)return e.toDateTimeLuxon(t.zone).diff(t).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(I(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();throw new a.L8(a.Z7.InvalidOperator)}if(E(t)){if(S(r))return function(e,t,r){const n=1e3*t*24*60*60;switch(r){case"+":return e.plus("milliseconds",n);case"-":return e.plus("milliseconds",-1*n)}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return e.plus("milliseconds",t.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*t.valueInMilliseconds())}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(L(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(x(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(I(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();throw new a.L8(a.Z7.InvalidOperator)}if(M(t)){if(S(r))return function(e,t,r){switch(r){case"+":return l.createFromMilliseconds(e.valueInMilliseconds()+t);case"-":return l.createFromMilliseconds(e.valueInMilliseconds()-t);case"*":return l.createFromMilliseconds(e.valueInMilliseconds()*t);case"/":return l.createFromMilliseconds(e.valueInMilliseconds()/t)}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return l.createFromMilliseconds(e.valueInMilliseconds()+t.valueInMilliseconds());case"-":return l.createFromMilliseconds(e.valueInMilliseconds()-t.valueInMilliseconds());case"*":return l.createFromMilliseconds(e.valueInMilliseconds()*t.valueInMilliseconds());case"/":return l.createFromMilliseconds(e.valueInMilliseconds()/t.valueInMilliseconds())}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(e,t,r){if("+"===r)return t.plus("milliseconds",e.valueInMilliseconds());throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(A(r))return function(e,t,r){if("+"===r)return t.plus("milliseconds",e.valueInMilliseconds());throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){if("+"===r)return t.addMilliseconds(e.valueInMilliseconds());throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(x(r))return function(e,t,r){switch(r){case"+":return t.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-t.toMillis()}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(I(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();throw new a.L8(a.Z7.InvalidOperator)}if(x(t)){if(S(r))return function(e,t,r){const n=1e3*t*24*60*60;switch(r){case"+":return e.plus({milliseconds:n});case"-":return e.minus({milliseconds:n})}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return e.plus({milliseconds:t.valueInMilliseconds()});case"-":return e.minus({milliseconds:t.valueInMilliseconds()})}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(e,t,r){if("-"===r)return e.diff(t.toDateTimeLuxon(e.zone)).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){if("-"===r)return e.diff(t.toDateTime()).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(x(r))return function(e,t,r){if("-"===r)return e.diff(t).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(I(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();throw new a.L8(a.Z7.InvalidOperator)}if(L(t)){if(S(r))return function(e,t,r){const n=1e3*t*24*60*60;switch(r){case"+":return e.addMilliseconds(n);case"-":return e.addMilliseconds(-1*n)}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(M(r))return function(e,t,r){switch(r){case"+":return e.addMilliseconds(t.valueInMilliseconds());case"-":return e.addMilliseconds(-1*t.valueInMilliseconds())}throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(L(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t.toDateTime()).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(x(r))return function(e,t,r){if("-"===r)return e.toDateTime().diff(t).as("days");throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);if(I(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();throw new a.L8(a.Z7.InvalidOperator)}if(I(t)){if(S(r))return function(e,t,r){const n=parseFloat(e);if(isNaN(n))throw new a.L8(a.Z7.InvalidOperator);return J(n,t,r)}(t,r,e);if(M(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(E(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(A(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(L(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(x(r))return function(){throw new a.L8(a.Z7.InvalidOperator)}();if(I(r))return function(e,t,r){if("+"===r)return e+t;throw new a.L8(a.Z7.InvalidOperator)}(t,r,e);throw new a.L8(a.Z7.InvalidOperator)}throw new a.L8(a.Z7.InvalidOperator)}function J(e,t,r){switch(r){case"+":return e+t;case"-":return e-t;case"*":return e*t;case"/":return e/t}throw new a.L8(a.Z7.InvalidOperator)}function W(e,t,r,n){var i=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(i,W.prototype),i.expected=t,i.found=r,i.location=n,i.name="SyntaxError",i}function Y(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}(function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r})(W,Error),W.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,n=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){n=e[r].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(i):i,o=this.location.source+":"+s.line+":"+s.column;if(n){var a=this.location.end,l=Y("",s.line.toString().length," "),u=n[i.line-1],c=(i.line===a.line?a.column:u.length+1)-i.column||1;t+="\n --\x3e "+o+"\n"+l+" |\n"+s.line+" | "+u+"\n"+l+" | "+Y("",i.column-1," ")+Y("",c,"^")}else t+="\n at "+o}return t},W.buildMessage=function(e,t){var r={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return r[e.type](e)}return"Expected "+function(e){var t,r,n=e.map(o);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."};class Q{static parse(e){return function(e,t){var r,n={},i=(t=void 0!==t?t:{}).grammarSource,s={start:rs},o=rs,a="!",l="=",u=">=",c=">",p="<=",d="<>",h="!=",f="||",y="@",m="'",g="N'",v="''",b=".",w="null",_="true",S="false",I="in",M="is",T="like",x="escape",A="not",E="and",L="or",C="between",N="from",R="for",O="substring",F="extract",k="trim",D="position",P="timestamp",V="date",Z="time",G="leading",j="trailing",z="both",U="cast",q="as",B="integer",$="int",H="smallint",J="float",Y="real",Q="varchar",K="to",X="interval",ee="year",te="timezone_hour",re="timezone_minute",ne="month",ie="day",se="hour",oe="minute",ae="second",le="case",ue="end",ce="when",pe="then",de="else",he=",",fe="(",ye=")",me="`",ge=/^[<-=]/,ve=/^[+\-]/,be=/^[*\/]/,we=/^[A-Za-z_\x80-\uFFFF]/,_e=/^[A-Za-z0-9_]/,Se=/^[A-Za-z0-9_.\x80-\uFFFF]/,Ie=/^["]/,Me=/^[^']/,Te=/^[0-9]/,xe=/^[eE]/,Ae=/^[ \t\n\r]/,Ee=/^[^`]/,Le=Yi("!",!1),Ce=Yi("=",!1),Ne=Yi(">=",!1),Re=Yi(">",!1),Oe=Yi("<=",!1),Fe=Yi("<>",!1),ke=Qi([["<","="]],!1,!1),De=Yi("!=",!1),Pe=Qi(["+","-"],!1,!1),Ve=Yi("||",!1),Ze=Qi(["*","/"],!1,!1),Ge=Qi([["A","Z"],["a","z"],"_",["",""]],!1,!1),je=Qi([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),ze=Qi([["A","Z"],["a","z"],["0","9"],"_",".",["",""]],!1,!1),Ue=Qi(['"'],!1,!1),qe=Yi("@",!1),Be=Yi("'",!1),$e=Yi("N'",!1),He=Yi("''",!1),Je=Qi(["'"],!0,!1),We=Yi(".",!1),Ye=Qi([["0","9"]],!1,!1),Qe=Qi(["e","E"],!1,!1),Ke=Yi("NULL",!0),Xe=Yi("TRUE",!0),et=Yi("FALSE",!0),tt=Yi("IN",!0),rt=Yi("IS",!0),nt=Yi("LIKE",!0),it=Yi("ESCAPE",!0),st=Yi("NOT",!0),ot=Yi("AND",!0),at=Yi("OR",!0),lt=Yi("BETWEEN",!0),ut=Yi("FROM",!0),ct=Yi("FOR",!0),pt=Yi("SUBSTRING",!0),dt=Yi("EXTRACT",!0),ht=Yi("TRIM",!0),ft=Yi("POSITION",!0),yt=Yi("TIMESTAMP",!0),mt=Yi("DATE",!0),gt=Yi("TIME",!0),vt=Yi("LEADING",!0),bt=Yi("TRAILING",!0),wt=Yi("BOTH",!0),_t=Yi("CAST",!0),St=Yi("AS",!0),It=Yi("INTEGER",!0),Mt=Yi("INT",!0),Tt=Yi("SMALLINT",!0),xt=Yi("FLOAT",!0),At=Yi("REAL",!0),Et=Yi("VARCHAR",!0),Lt=Yi("TO",!0),Ct=Yi("INTERVAL",!0),Nt=Yi("YEAR",!0),Rt=Yi("TIMEZONE_HOUR",!0),Ot=Yi("TIMEZONE_MINUTE",!0),Ft=Yi("MONTH",!0),kt=Yi("DAY",!0),Dt=Yi("HOUR",!0),Pt=Yi("MINUTE",!0),Vt=Yi("SECOND",!0),Zt=Yi("CASE",!0),Gt=Yi("END",!0),jt=Yi("WHEN",!0),zt=Yi("THEN",!0),Ut=Yi("ELSE",!0),qt=Yi(",",!1),Bt=Yi("(",!1),$t=Yi(")",!1),Ht=Qi([" ","\t","\n","\r"],!1,!1),Jt=Yi("`",!1),Wt=Qi(["`"],!0,!1),Yt=function(e){return e},Qt=function(e){return zo(Ji(),...e)},Kt=function(e,t,r){return{op:t,expr:r,location:Ji()}},Xt=function(e,t){return Uo(e,t)},er=function(e,t,r){return{op:t,expr:r,location:Ji()}},tr=function(e,t){return Uo(e,t)},rr=function(e){return function(e,t,r){return{type:"unary-expression",location:r,operator:"NOT",expr:t}}(0,e,Ji())},nr=function(e,t){return""==t||null==t||null==t?e:"arithmetic"==t.type?Uo(e,t.tail):jo(t.op,e,t.right,t.escape,Ji())},ir=function(e,t){return{op:e,expr:t,location:Ji()}},sr=function(e){return{type:"arithmetic",tail:e}},or=function(e,t){return{op:e+"NOT",right:t}},ar=function(e,t){return{op:e,right:t}},lr=function(e,t,r){return zo(Ji(),t,r)},ur=function(e,t){return{op:"NOT"+e,right:t}},cr=function(e,t,r){return zo(Ji(),t,r)},pr=function(e,t){return{op:e,right:t}},dr=function(e){return e[0]+" "+e[2]},hr=function(e){return e[0]+" "+e[2]},fr=function(e,t,r){return{op:e,right:t,escape:r.value}},yr=function(e,t){return{op:e,right:t,escape:""}},mr=function(e,t){return{op:e,right:t}},gr=function(e,t){return{op:e,right:t}},vr=function(e,t,r){return{op:t,expr:r,location:Ji()}},br=function(e,t){return Uo(e,t)},wr=function(e,t,r){return{op:t,expr:r,location:Ji()}},_r=function(e,t){return Uo(e,t)},Sr=function(e){return e.paren=!0,e},Ir=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",location:Ji(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",location:Ji(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(e)?{type:"current-time",location:Ji(),mode:"time"}:/^CURRENT_USER$/i.test(e)?{type:"current-user",location:Ji()}:{type:"column-reference",location:Ji(),table:"",column:e}},Mr=function(e){return{type:"column-reference",location:Ji(),table:"",column:e,delimited:!0}},Tr=function(e){return e},xr=function(e,t){return e+t.join("")},Ar=function(e,t){return e+t.join("")},Er=function(e){return e},Lr=function(e){return e.join("")},Cr=function(){return'"'},Nr=function(e){return{type:"parameter",location:Ji(),value:e[1]}},Rr=function(e,t){return zo(Ji(),e,t)},Or=function(e,t){return zo(Ji(),e,t)},Fr=function(e){return{type:"function",location:Ji(),name:"extract",args:e}},kr=function(e,t,r){return zo(Ji(),e,t,...r?[r]:[])},Dr=function(e,t,r){return zo(Ji(),e,t,r)},Pr=function(e){return{type:"function",location:Ji(),name:"substring",args:e}},Vr=function(e,t){return zo(Ji(),e,t)},Zr=function(e,t){return zo(Ji(),e,t)},Gr=function(e){return{type:"function",location:Ji(),name:"cast",args:e}},jr=function(){return{type:"data-type",location:Ji(),value:{type:"integer"}}},zr=function(){return{type:"data-type",location:Ji(),value:{type:"smallint"}}},Ur=function(){return{type:"data-type",location:Ji(),value:{type:"float"}}},qr=function(){return{type:"data-type",location:Ji(),value:{type:"real"}}},Br=function(){return{type:"data-type",location:Ji(),value:{type:"date"}}},$r=function(){return{type:"data-type",location:Ji(),value:{type:"timestamp"}}},Hr=function(){return{type:"data-type",location:Ji(),value:{type:"time"}}},Jr=function(e){return{type:"data-type",location:Ji(),value:{type:"varchar",size:parseInt(e)}}},Wr=function(e,t,r){return zo(Ji(),e,t,r)},Yr=function(e,t){return zo(Ji(),e,t)},Qr=function(e){return{type:"function",location:Ji(),name:"trim",args:e}},Kr=function(e){return{type:"string",location:Ji(),value:e??"BOTH"}},Xr=function(e,t){return zo(Ji(),e,t)},en=function(e,t){return zo(Ji(),e,t)},tn=function(e){return{type:"function",location:Ji(),name:"position",args:e}},rn=function(e,t){return{type:"function",location:Ji(),name:e,args:t}},nn=function(e){return{type:"string",location:Ji(),value:e}},sn=function(e){return"string"===e.type&&function(e){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)&&Wi("Timestamp literal is invalid")}(e.value),{type:"timestamp",location:Ji(),value:e.value}},on=function(e){return"string"===e.type&&function(e){!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)&&Wi("Time literal is invalid")}(e.value),{type:"time",location:Ji(),value:e.value}},an=function(e,t,r){return{type:"interval",location:Ji(),value:t,qualifier:r,op:e}},ln=function(e,t){return{type:"interval",location:Ji(),value:e,qualifier:t,op:""}},un=function(e,t){return{type:"interval-qualifier",location:Ji(),start:e,end:t}},cn=function(e,t){return{type:"interval-period",location:Ji(),period:e.value,precision:t,secondary:null}},pn=function(e){return{type:"interval-period",location:Ji(),period:e.value,precision:null,secondary:null}},dn=function(e){return{type:"interval-period",location:Ji(),period:e.value,precision:null,secondary:null}},hn=function(e,t){return{type:"interval-period",location:Ji(),period:"second",precision:e,secondary:t}},fn=function(e){return{type:"interval-period",location:Ji(),period:"second",precision:e,secondary:null}},yn=function(){return{type:"interval-period",location:Ji(),period:"second",precision:null,secondary:null}},mn=function(e,t){return{type:"interval-period",location:Ji(),period:e.value,precision:t,secondary:null}},gn=function(e){return{type:"interval-period",location:Ji(),period:e.value,precision:null,secondary:null}},vn=function(e,t){return{type:"interval-period",location:Ji(),period:"second",precision:e,secondary:t}},bn=function(e){return{type:"interval-period",location:Ji(),period:"second",precision:e,secondary:null}},wn=function(){return{type:"interval-period",location:Ji(),period:"second",precision:null,secondary:null}},_n=function(){return{type:"string",location:Ji(),value:"day"}},Sn=function(){return{type:"string",location:Ji(),value:"hour"}},In=function(){return{type:"string",location:Ji(),value:"minute"}},Mn=function(){return{type:"string",location:Ji(),value:"month"}},Tn=function(){return{type:"string",location:Ji(),value:"year"}},xn=function(e){return parseFloat(e)},An=function(e){return parseFloat(e)},En=function(e){return"string"===e.type&&function(e){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)&&Wi("Date literal is invalid")}(e.value),{type:"date",location:Ji(),value:e.value}},Ln=function(){return{type:"null",location:Ji(),value:null}},Cn=function(){return{type:"boolean",location:Ji(),value:!0}},Nn=function(){return{type:"boolean",location:Ji(),value:!1}},Rn=function(){return"'"},On=function(e){return{type:"string",location:Ji(),value:e.join("")}},Fn=function(e,t){return{type:"case-expression",location:Ji(),format:"simple",operand:e,clauses:t,else:null,elseLocation:null}},kn=function(e,t,r){return{type:"case-expression",location:Ji(),format:"simple",operand:e,clauses:t,else:r.value,elseLocation:r.location}},Dn=function(e){return{type:"case-expression",location:Ji(),format:"searched",clauses:e,else:null,elseLocation:null}},Pn=function(e,t){return{type:"case-expression",location:Ji(),format:"searched",clauses:e,else:t.value,elseLocation:t.location}},Vn=function(e,t){return{type:"when-clause",location:Ji(),operand:e,value:t}},Zn=function(e,t){return{type:"when-clause",location:Ji(),operand:e,value:t}},Gn=function(e){return{type:"else-clause",location:Ji(),value:e}},jn=function(e){return{type:"number",location:Ji(),value:e}},zn=function(e,t,r){return parseFloat(e+t+r)},Un=function(e,t){return parseFloat(e+t)},qn=function(e,t){return parseFloat(e+t)},Bn=function(e){return parseFloat(e)},$n=function(e,t){return e[0]+t},Hn=function(e){return"."+(null!=e?e:"")},Jn=function(e,t){return e+t},Wn=function(e){return e.join("")},Yn=function(e,t){return"e"+(null===t?"":t)},Qn=function(){return"IN"},Kn=function(){return"IS"},Xn=function(){return"LIKE"},ei=function(){return"ESCAPE"},ti=function(){return"NOT"},ri=function(){return"AND"},ni=function(){return"OR"},ii=function(){return"BETWEEN"},si=function(){return"FROM"},oi=function(){return"FOR"},ai=function(){return"SUBSTRING"},li=function(){return"EXTRACT"},ui=function(){return"TRIM"},ci=function(){return"POSITION"},pi=function(){return"TIMESTAMP"},di=function(){return"DATE"},hi=function(){return"TIME"},fi=function(){return"LEADING"},yi=function(){return"TRAILING"},mi=function(){return"BOTH"},gi=function(){return"CAST"},vi=function(){return"AS"},bi=function(){return"INTEGER"},wi=function(){return"INT"},_i=function(){return"SMALLINT"},Si=function(){return"FLOAT"},Ii=function(){return"REAL"},Mi=function(){return"VARCHAR"},Ti=function(){return"TO"},xi=function(){return"INTERVAL"},Ai=function(){return"YEAR"},Ei=function(){return"TIMEZONE_HOUR"},Li=function(){return"TIMEZONE_MINUTE"},Ci=function(){return"MONTH"},Ni=function(){return"DAY"},Ri=function(){return"HOUR"},Oi=function(){return"MINUTE"},Fi=function(){return"SECOND"},ki=function(){return"CASE"},Di=function(){return"END"},Pi=function(){return"WHEN"},Vi=function(){return"THEN"},Zi=function(){return"ELSE"},Gi=function(e){return e},ji=function(e){return e.join("")},zi=0|t.peg$currPos,Ui=zi,qi=[{line:1,column:1}],Bi=zi,$i=t.peg$maxFailExpected||[],Hi=0|t.peg$silentFails;if(t.startRule){if(!(t.startRule in s))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=s[t.startRule]}function Ji(){return Xi(Ui,zi)}function Wi(e,t){throw ts(e,t=void 0!==t?t:Xi(Ui,zi))}function Yi(e,t){return{type:"literal",text:e,ignoreCase:t}}function Qi(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Ki(t){var r,n=qi[t];if(n)return n;if(t>=qi.length)r=qi.length-1;else for(r=t;!qi[--r];);for(n={line:(n=qi[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return qi[t]=n,n}function Xi(e,t,r){var n=Ki(e),s=Ki(t);return{source:i,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:s.line,column:s.column}}}function es(e){zi<Bi||(zi>Bi&&(Bi=zi,$i=[]),$i.push(e))}function ts(e,t){return new W(e,null,null,t)}function rs(){var e,t;return e=zi,Vo(),(t=is())!==n?(Vo(),Ui=e,e=Yt(t)):(zi=e,e=n),e}function ns(){var e,t,r,i,s,o;if(e=zi,Do()!==n){for(Vo(),t=[],r=is();r!==n;)t.push(r),r=zi,i=zi,s=Vo(),(o=ko())!==n?i=s=[s,o,Vo()]:(zi=i,i=n),i!==n&&(i=is())===n?(zi=r,r=n):r=i;r=Vo(),(i=Po())!==n?(Ui=e,e=Qt(t)):(zi=e,e=n)}else zi=e,e=n;return e}function is(){var e,t,r,i,s,o;if(e=zi,(t=ss())!==n){for(r=[],i=zi,Vo(),(s=Qs())!==n?(Vo(),(o=ss())!==n?(Ui=i,i=Kt(t,s,o)):(zi=i,i=n)):(zi=i,i=n);i!==n;)r.push(i),i=zi,Vo(),(s=Qs())!==n?(Vo(),(o=ss())!==n?(Ui=i,i=Kt(t,s,o)):(zi=i,i=n)):(zi=i,i=n);Ui=e,e=Xt(t,r)}else zi=e,e=n;return e}function ss(){var e,t,r,i,s,o;if(e=zi,(t=os())!==n){for(r=[],i=zi,Vo(),(s=Ys())!==n?(Vo(),(o=os())!==n?(Ui=i,i=er(t,s,o)):(zi=i,i=n)):(zi=i,i=n);i!==n;)r.push(i),i=zi,Vo(),(s=Ys())!==n?(Vo(),(o=os())!==n?(Ui=i,i=er(t,s,o)):(zi=i,i=n)):(zi=i,i=n);Ui=e,e=tr(t,r)}else zi=e,e=n;return e}function os(){var t,r,i,s,o;return t=zi,(r=Ws())===n&&(r=zi,33===e.charCodeAt(zi)?(i=a,zi++):(i=n,0===Hi&&es(Le)),i!==n?(s=zi,Hi++,61===e.charCodeAt(zi)?(o=l,zi++):(o=n,0===Hi&&es(Ce)),Hi--,o===n?s=void 0:(zi=s,s=n),s!==n?r=i=[i,s]:(zi=r,r=n)):(zi=r,r=n)),r!==n?(i=Vo(),(s=os())!==n?(Ui=t,t=rr(s)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=function(){var e,t,r,i;return e=zi,(t=cs())!==n?(r=zi,Vo(),(i=function(){var e;return(e=function(){var e,t,r,i,s;if(e=zi,t=[],r=zi,Vo(),(i=as())!==n?(Vo(),(s=cs())!==n?(Ui=r,r=ir(i,s)):(zi=r,r=n)):(zi=r,r=n),r!==n)for(;r!==n;)t.push(r),r=zi,Vo(),(i=as())!==n?(Vo(),(s=cs())!==n?(Ui=r,r=ir(i,s)):(zi=r,r=n)):(zi=r,r=n);else t=n;return t!==n&&(Ui=e,t=sr(t)),t}())===n&&(e=function(){var e,t,r;return e=zi,(t=us())!==n?(Vo(),(r=ns())!==n?(Ui=e,e=mr(t,r)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=us())!==n?(Vo(),(r=Ss())!==n?(Ui=e,e=gr(t,r)):(zi=e,e=n)):(zi=e,e=n)),e}())===n&&(e=function(){var e,t,r,i,s,o,a,l;return e=zi,(t=Ws())!==n?(Vo(),(r=Ks())!==n?(i=Vo(),s=zi,(o=cs())!==n?(Vo(),(a=Ys())!==n?(Vo(),(l=cs())!==n?(Ui=s,s=lr(r,o,l)):(zi=s,s=n)):(zi=s,s=n)):(zi=s,s=n),s!==n?(Ui=e,e=ur(r,s)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Ks())!==n?(Vo(),r=zi,(i=cs())!==n?(s=Vo(),(o=Ys())!==n?(Vo(),(a=cs())!==n?(Ui=r,r=cr(t,i,a)):(zi=r,r=n)):(zi=r,r=n)):(zi=r,r=n),r!==n?(Ui=e,e=pr(t,r)):(zi=e,e=n)):(zi=e,e=n)),e}())===n&&(e=function(){var e,t,r,i;return e=zi,(t=$s())!==n?(Vo(),(r=Ws())!==n?(Vo(),(i=cs())!==n?(Ui=e,e=or(t,i)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=$s())!==n?(Vo(),(r=cs())!==n?(Ui=e,e=ar(t,r)):(zi=e,e=n)):(zi=e,e=n)),e}())===n&&(e=function(){var e,t,r,i;return e=zi,(t=ls())!==n?(Vo(),(r=Ns())!==n?(Vo(),Js()!==n?(Vo(),(i=Rs())!==n?(Ui=e,e=fr(t,r,i)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=ls())!==n?(Vo(),(r=Ns())!==n?(Ui=e,e=yr(t,r)):(zi=e,e=n)):(zi=e,e=n)),e}()),e}())!==n?r=i:(zi=r,r=n),r===n&&(r=null),Ui=e,e=nr(t,r)):(zi=e,e=n),e}()),t}function as(){var t;return e.substr(zi,2)===u?(t=u,zi+=2):(t=n,0===Hi&&es(Ne)),t===n&&(62===e.charCodeAt(zi)?(t=c,zi++):(t=n,0===Hi&&es(Re)),t===n&&(e.substr(zi,2)===p?(t=p,zi+=2):(t=n,0===Hi&&es(Oe)),t===n&&(e.substr(zi,2)===d?(t=d,zi+=2):(t=n,0===Hi&&es(Fe)),t===n&&(t=e.charAt(zi),ge.test(t)?zi++:(t=n,0===Hi&&es(ke)),t===n&&(e.substr(zi,2)===h?(t=h,zi+=2):(t=n,0===Hi&&es(De))))))),t}function ls(){var e,t,r,i,s;return e=zi,t=zi,(r=Ws())!==n?(i=Vo(),(s=Hs())!==n?t=r=[r,i,s]:(zi=t,t=n)):(zi=t,t=n),t!==n&&(Ui=e,t=dr(t)),(e=t)===n&&(e=Hs()),e}function us(){var e,t,r,i,s;return e=zi,t=zi,(r=Ws())!==n?(i=Vo(),(s=Bs())!==n?t=r=[r,i,s]:(zi=t,t=n)):(zi=t,t=n),t!==n&&(Ui=e,t=hr(t)),(e=t)===n&&(e=Bs()),e}function cs(){var e,t,r,i,s,o;if(e=zi,(t=ds())!==n){for(r=[],i=zi,Vo(),(s=ps())!==n?(Vo(),(o=ds())!==n?(Ui=i,i=vr(t,s,o)):(zi=i,i=n)):(zi=i,i=n);i!==n;)r.push(i),i=zi,Vo(),(s=ps())!==n?(Vo(),(o=ds())!==n?(Ui=i,i=vr(t,s,o)):(zi=i,i=n)):(zi=i,i=n);Ui=e,e=br(t,r)}else zi=e,e=n;return e}function ps(){var t;return t=e.charAt(zi),ve.test(t)?zi++:(t=n,0===Hi&&es(Pe)),t===n&&(e.substr(zi,2)===f?(t=f,zi+=2):(t=n,0===Hi&&es(Ve))),t}function ds(){var e,t,r,i,s,o;if(e=zi,(t=fs())!==n){for(r=[],i=zi,Vo(),(s=hs())!==n?(Vo(),(o=fs())!==n?(Ui=i,i=wr(t,s,o)):(zi=i,i=n)):(zi=i,i=n);i!==n;)r.push(i),i=zi,Vo(),(s=hs())!==n?(Vo(),(o=fs())!==n?(Ui=i,i=wr(t,s,o)):(zi=i,i=n)):(zi=i,i=n);Ui=e,e=_r(t,r)}else zi=e,e=n;return e}function hs(){var t;return t=e.charAt(zi),be.test(t)?zi++:(t=n,0===Hi&&es(Ze)),t}function fs(){var e,t;return(e=function(){var e;return(e=Rs())===n&&(e=function(){var e,t,r,i;return e=zi,(t=function(){var e,t,r,i;return e=zi,(t=Ds())!==n&&(r=Ps())!==n&&(i=Vs())!==n?(Ui=e,e=zn(t,r,i)):(zi=e,e=n),e===n&&(e=zi,(t=Ds())!==n&&(r=Ps())!==n?(Ui=e,e=Un(t,r)):(zi=e,e=n),e===n&&(e=zi,(t=Ds())!==n&&(r=Vs())!==n?(Ui=e,e=qn(t,r)):(zi=e,e=n),e===n&&(e=zi,(t=Ds())!==n&&(Ui=e,t=Bn(t)),e=t))),e}())!==n?(r=zi,Hi++,i=ms(),Hi--,i===n?r=void 0:(zi=r,r=n),r!==n?(Ui=e,e=jn(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t;return e=zi,(t=Us())!==n&&(Ui=e,t=Cn()),(e=t)===n&&(e=zi,(t=qs())!==n&&(Ui=e,t=Nn()),e=t),e}())===n&&(e=function(){var e,t;return e=zi,(t=zs())!==n&&(Ui=e,t=Ln()),t}())===n&&(e=function(){var e,t;return e=zi,oo()!==n?(Vo(),(t=Ns())!==n?(Ui=e,e=En(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t;return e=zi,so()!==n?(Vo(),(t=Ns())!==n?(Ui=e,e=sn(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=xs())===n&&(e=function(){var e,t;return e=zi,ao()!==n?(Vo(),(t=Ns())!==n?(Ui=e,e=on(t)):(zi=e,e=n)):(zi=e,e=n),e}()),e}())===n&&(e=function(){var e,t,r,i;return e=zi,ro()!==n?(Vo(),t=zi,Do()!==n?(Vo(),(r=Ts())!==n?(Vo(),Xs()!==n?(Vo(),(i=is())!==n?(Vo(),Po()!==n?(Ui=t,t=Rr(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,Do()!==n?(Vo(),(r=Ts())!==n?(Vo(),ko()!==n?(Vo(),(i=is())!==n?(Vo(),Po()!==n?(Ui=t,t=Or(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t!==n?(Ui=e,e=Fr(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t,r,i,s,o,a;return e=zi,to()!==n?(Vo(),t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),Xs()!==n?(Vo(),(i=is())!==n?(Vo(),s=zi,eo()!==n?(o=Vo(),(a=is())!==n?(Vo(),s=a):(zi=s,s=n)):(zi=s,s=n),s===n&&(s=null),Po()!==n?(Ui=t,t=kr(r,i,s)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),ko()!==n?(Vo(),(i=is())!==n?(Vo(),(s=ko())!==n?(Vo(),(o=is())!==n&&(a=Po())!==n?(Ui=t,t=Dr(r,i,o)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t!==n?(Ui=e,e=Pr(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t,r,i,s;return e=zi,no()!==n?(Vo(),t=zi,Do()!==n?(Vo(),r=Ms(),Vo(),(i=is())!==n?(Vo(),Xs()!==n?(Vo(),(s=is())!==n?(Vo(),Po()!==n?(Ui=t,t=Wr(r,i,s)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,Do()!==n?(Vo(),r=Ms(),Vo(),(i=is())!==n?(Vo(),Po()!==n?(Ui=t,t=Yr(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t!==n?(Ui=e,e=Qr(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t,r,i;return e=zi,io()!==n?(Vo(),t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),Bs()!==n?(Vo(),(i=is())!==n?(Vo(),Po()!==n?(Ui=t,t=Xr(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),ko()!==n?(Vo(),(i=is())!==n?(Vo(),Po()!==n?(Ui=t,t=en(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t!==n?(Ui=e,e=tn(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t,r,i;return e=zi,po()!==n?(Vo(),t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),ho()!==n?(Vo(),(i=Is())!==n?(Vo(),Po()!==n?(Ui=t,t=Vr(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,Do()!==n?(Vo(),(r=is())!==n?(Vo(),ko()!==n?(Vo(),(i=Is())!==n?(Vo(),Po()!==n?(Ui=t,t=Zr(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t!==n?(Ui=e,e=Gr(t)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e,t,r,i;return e=zi,t=zi,Hi++,r=ro(),Hi--,r===n?t=void 0:(zi=t,t=n),t!==n&&(r=Go())!==n?(Vo(),(i=ns())!==n?(Ui=e,e=rn(r,i)):(zi=e,e=n)):(zi=e,e=n),e}())===n&&(e=function(){var e;return(e=function(){var e,t,r,i,s;if(e=zi,Co()!==n)if(Vo(),(t=is())!==n){for(Vo(),r=[],i=zi,(s=Fs())!==n?(Vo(),i=s):(zi=i,i=n);i!==n;)r.push(i),i=zi,(s=Fs())!==n?(Vo(),i=s):(zi=i,i=n);(i=No())!==n?(Ui=e,e=Fn(t,r)):(zi=e,e=n)}else zi=e,e=n;else zi=e,e=n;if(e===n)if(e=zi,Co()!==n)if(Vo(),(t=is())!==n){for(Vo(),r=[],i=zi,(s=Fs())!==n?(Vo(),i=s):(zi=i,i=n);i!==n;)r.push(i),i=zi,(s=Fs())!==n?(Vo(),i=s):(zi=i,i=n);(i=ks())!==n?(s=Vo(),No()!==n?(Ui=e,e=kn(t,r,i)):(zi=e,e=n)):(zi=e,e=n)}else zi=e,e=n;else zi=e,e=n;return e}())===n&&(e=function(){var e,t,r,i;if(e=zi,Co()!==n){for(Vo(),t=[],r=zi,(i=Os())!==n?(Vo(),r=i):(zi=r,r=n);r!==n;)t.push(r),r=zi,(i=Os())!==n?(Vo(),r=i):(zi=r,r=n);(r=No())!==n?(Ui=e,e=Dn(t)):(zi=e,e=n)}else zi=e,e=n;if(e===n)if(e=zi,Co()!==n){for(Vo(),t=[],r=zi,(i=Os())!==n?(Vo(),r=i):(zi=r,r=n);r!==n;)t.push(r),r=zi,(i=Os())!==n?(Vo(),r=i):(zi=r,r=n);(r=ks())!==n?(i=Vo(),No()!==n?(Ui=e,e=Pn(t,r)):(zi=e,e=n)):(zi=e,e=n)}else zi=e,e=n;return e}()),e}())===n&&(e=function(){var e,t;return e=zi,(t=function(){var e,t;return e=zi,(t=function(){var e,t,r,i;if(e=zi,(t=ms())!==n){for(r=[],i=vs();i!==n;)r.push(i),i=vs();Ui=e,e=xr(t,r)}else zi=e,e=n;return e}())!==n&&(Ui=e,t=Tr(t)),t}())!==n&&(Ui=e,t=Ir(t)),(e=t)===n&&(e=zi,(t=function(){var e,t;return e=zi,_s()!==n?(t=function(){var e,t,r;for(e=zi,t=[],r=bs();r!==n;)t.push(r),r=bs();return Ui=e,Lr(t)}(),_s()!==n?(Ui=e,e=Er(t)):(zi=e,e=n)):(zi=e,e=n),e}())!==n&&(Ui=e,t=Mr(t)),e=t),e}())===n&&(e=Ss())===n&&(e=zi,Do()!==n?(Vo(),(t=is())!==n?(Vo(),Po()!==n?(Ui=e,e=Sr(t)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)),e}function ys(){var e,t,r,i;if(e=zi,(t=ms())!==n){for(r=[],i=gs();i!==n;)r.push(i),i=gs();Ui=e,e=Ar(t,r)}else zi=e,e=n;return e}function ms(){var t;return t=e.charAt(zi),we.test(t)?zi++:(t=n,0===Hi&&es(Ge)),t}function gs(){var t;return t=e.charAt(zi),_e.test(t)?zi++:(t=n,0===Hi&&es(je)),t}function vs(){var t;return t=e.charAt(zi),Se.test(t)?zi++:(t=n,0===Hi&&es(ze)),t}function bs(){var e;return(e=ws())===n&&(e=function(){var e;return e=zi,_s()!==n&&_s()!==n?(Ui=e,e=Cr()):(zi=e,e=n),e}()),e}function ws(){var t;return t=e.charAt(zi),Se.test(t)?zi++:(t=n,0===Hi&&es(ze)),t}function _s(){var t;return t=e.charAt(zi),Ie.test(t)?zi++:(t=n,0===Hi&&es(Ue)),t}function Ss(){var t,r,i,s;return t=zi,r=zi,64===e.charCodeAt(zi)?(i=y,zi++):(i=n,0===Hi&&es(qe)),i!==n&&(s=ys())!==n?r=i=[i,s]:(zi=r,r=n),r!==n&&(Ui=t,r=Nr(r)),r}function Is(){var e,t,r;return e=zi,(t=fo())===n&&(t=yo()),t!==n&&(Ui=e,t=jr()),(e=t)===n&&(e=zi,(t=mo())!==n&&(Ui=e,t=zr()),(e=t)===n&&(e=zi,(t=go())!==n&&(Ui=e,t=Ur()),(e=t)===n&&(e=zi,(t=vo())!==n&&(Ui=e,t=qr()),(e=t)===n&&(e=zi,(t=oo())!==n&&(Ui=e,t=Br()),(e=t)===n&&(e=zi,(t=so())!==n&&(Ui=e,t=$r()),(e=t)===n&&(e=zi,(t=ao())!==n&&(Ui=e,t=Hr()),(e=t)===n&&(e=zi,(t=bo())!==n?(Vo(),Do()!==n?(Vo(),(r=Zs())!==n?(Vo(),Po()!==n?(Ui=e,e=Jr(r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)))))))),e}function Ms(){var e,t;return e=zi,(t=lo())===n&&(t=uo())===n&&(t=co()),t===n&&(t=null),Ui=e,Kr(t)}function Ts(){var e,t;return e=zi,(t=So())===n&&(t=To())===n&&(t=xo())===n&&(t=Ao())===n&&(t=Eo())===n&&(t=Lo())===n&&(t=Io())===n&&(t=Mo()),t!==n&&(Ui=e,t=nn(t)),t}function xs(){var t,r,i,s;return t=zi,_o()!==n?(Vo(),r=e.charAt(zi),ve.test(r)?zi++:(r=n,0===Hi&&es(Pe)),r!==n?(Vo(),(i=Ns())!==n?(Vo(),(s=As())!==n?(Ui=t,t=an(r,i,s)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n),t===n&&(t=zi,_o()!==n?(Vo(),(r=Ns())!==n?(Vo(),(i=As())!==n?(Ui=t,t=ln(r,i)):(zi=t,t=n)):(zi=t,t=n)):(zi=t,t=n)),t}function As(){var e,t,r;return e=zi,(t=function(){var e,t,r;return e=zi,(t=Es())!==n?(Vo(),Do()!==n?(Vo(),(r=Cs())!==n?(Vo(),Po()!==n?(Ui=e,e=cn(t,r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Es())!==n&&(Ui=e,t=pn(t)),e=t),e}())!==n?(Vo(),wo()!==n?(Vo(),(r=function(){var e,t,r,i;return e=zi,(t=Es())!==n&&(Ui=e,t=dn(t)),(e=t)===n&&(e=zi,(t=Lo())!==n?(Vo(),Do()!==n?(Vo(),(r=Cs())!==n?(Vo(),ko()!==n?(Vo(),(i=Ls())!==n?(Vo(),Po()!==n?(Ui=e,e=hn(r,i)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Lo())!==n?(Vo(),Do()!==n?(Vo(),(r=Cs())!==n?(Vo(),Po()!==n?(Ui=e,e=fn(r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Lo())!==n&&(Ui=e,t=yn()),e=t))),e}())!==n?(Ui=e,e=un(t,r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=function(){var e,t,r,i;return e=zi,(t=Es())!==n?(Vo(),Do()!==n?(Vo(),(r=Ls())!==n?(Vo(),Po()!==n?(Ui=e,e=mn(t,r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Es())!==n&&(Ui=e,t=gn(t)),(e=t)===n&&(e=zi,(t=Lo())!==n?(Vo(),Do()!==n?(Vo(),(r=Cs())!==n?(Vo(),ko()!==n?(Vo(),(i=Ls())!==n?(Vo(),Po()!==n?(Ui=e,e=vn(r,i)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Lo())!==n?(Vo(),Do()!==n?(Vo(),(r=Ls())!==n?(Vo(),Po()!==n?(Ui=e,e=bn(r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e===n&&(e=zi,(t=Lo())!==n&&(Ui=e,t=wn()),e=t)))),e}()),e}function Es(){var e,t;return e=zi,(t=xo())!==n&&(Ui=e,t=_n()),(e=t)===n&&(e=zi,(t=Ao())!==n&&(Ui=e,t=Sn()),(e=t)===n&&(e=zi,(t=Eo())!==n&&(Ui=e,t=In()),(e=t)===n&&(e=zi,(t=To())!==n&&(Ui=e,t=Mn()),(e=t)===n&&(e=zi,(t=So())!==n&&(Ui=e,t=Tn()),e=t)))),e}function Ls(){var e,t;return e=zi,(t=Zs())!==n&&(Ui=e,t=xn(t)),t}function Cs(){var e,t;return e=zi,(t=Zs())!==n&&(Ui=e,t=An(t)),t}function Ns(){var e;return(e=Rs())===n&&(e=Ss()),e}function Rs(){var t,r,i,s,o;if(t=zi,39===e.charCodeAt(zi)?(r=m,zi++):(r=n,0===Hi&&es(Be)),r===n&&(e.substr(zi,2)===g?(r=g,zi+=2):(r=n,0===Hi&&es($e))),r!==n){for(i=[],s=zi,e.substr(zi,2)===v?(o=v,zi+=2):(o=n,0===Hi&&es(He)),o!==n&&(Ui=s,o=Rn()),(s=o)===n&&(s=e.charAt(zi),Me.test(s)?zi++:(s=n,0===Hi&&es(Je)));s!==n;)i.push(s),s=zi,e.substr(zi,2)===v?(o=v,zi+=2):(o=n,0===Hi&&es(He)),o!==n&&(Ui=s,o=Rn()),(s=o)===n&&(s=e.charAt(zi),Me.test(s)?zi++:(s=n,0===Hi&&es(Je)));39===e.charCodeAt(zi)?(s=m,zi++):(s=n,0===Hi&&es(Be)),s!==n?(Ui=t,t=On(i)):(zi=t,t=n)}else zi=t,t=n;return t}function Os(){var e,t,r;return e=zi,Ro()!==n?(Vo(),(t=is())!==n?(Vo(),Oo()!==n?(Vo(),(r=is())!==n?(Ui=e,e=Vn(t,r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e}function Fs(){var e,t,r;return e=zi,Ro()!==n?(Vo(),(t=is())!==n?(Vo(),Oo()!==n?(Vo(),(r=is())!==n?(Ui=e,e=Zn(t,r)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n)):(zi=e,e=n),e}function ks(){var e,t;return e=zi,Fo()!==n?(Vo(),(t=is())!==n?(Ui=e,e=Gn(t)):(zi=e,e=n)):(zi=e,e=n),e}function Ds(){var t,r,i;return(t=Zs())===n&&(t=zi,r=e.charAt(zi),ve.test(r)?zi++:(r=n,0===Hi&&es(Pe)),r!==n&&(i=Zs())!==n?(Ui=t,t=$n(r,i)):(zi=t,t=n)),t}function Ps(){var t,r,i;return t=zi,46===e.charCodeAt(zi)?(r=b,zi++):(r=n,0===Hi&&es(We)),r!==n?((i=Zs())===n&&(i=null),Ui=t,t=Hn(i)):(zi=t,t=n),t}function Vs(){var e,t,r;return e=zi,(t=js())!==n&&(r=Zs())!==n?(Ui=e,e=Jn(t,r)):(zi=e,e=n),e}function Zs(){var e,t,r;if(e=zi,t=[],(r=Gs())!==n)for(;r!==n;)t.push(r),r=Gs();else t=n;return t!==n&&(Ui=e,t=Wn(t)),t}function Gs(){var t;return t=e.charAt(zi),Te.test(t)?zi++:(t=n,0===Hi&&es(Ye)),t}function js(){var t,r,i;return t=zi,r=e.charAt(zi),xe.test(r)?zi++:(r=n,0===Hi&&es(Qe)),r!==n?(i=e.charAt(zi),ve.test(i)?zi++:(i=n,0===Hi&&es(Pe)),i===n&&(i=null),Ui=t,t=Yn(r,i)):(zi=t,t=n),t}function zs(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===w?zi+=4:(r=n,0===Hi&&es(Ke)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?t=r=[r,i]:(zi=t,t=n)):(zi=t,t=n),t}function Us(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===_?zi+=4:(r=n,0===Hi&&es(Xe)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?t=r=[r,i]:(zi=t,t=n)):(zi=t,t=n),t}function qs(){var t,r,i,s;return t=zi,(r=e.substr(zi,5)).toLowerCase()===S?zi+=5:(r=n,0===Hi&&es(et)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?t=r=[r,i]:(zi=t,t=n)):(zi=t,t=n),t}function Bs(){var t,r,i,s;return t=zi,(r=e.substr(zi,2)).toLowerCase()===I?zi+=2:(r=n,0===Hi&&es(tt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Qn()):(zi=t,t=n)):(zi=t,t=n),t}function $s(){var t,r,i,s;return t=zi,(r=e.substr(zi,2)).toLowerCase()===M?zi+=2:(r=n,0===Hi&&es(rt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Kn()):(zi=t,t=n)):(zi=t,t=n),t}function Hs(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===T?zi+=4:(r=n,0===Hi&&es(nt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Xn()):(zi=t,t=n)):(zi=t,t=n),t}function Js(){var t,r,i,s;return t=zi,(r=e.substr(zi,6)).toLowerCase()===x?zi+=6:(r=n,0===Hi&&es(it)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ei()):(zi=t,t=n)):(zi=t,t=n),t}function Ws(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===A?zi+=3:(r=n,0===Hi&&es(st)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ti()):(zi=t,t=n)):(zi=t,t=n),t}function Ys(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===E?zi+=3:(r=n,0===Hi&&es(ot)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ri()):(zi=t,t=n)):(zi=t,t=n),t}function Qs(){var t,r,i,s;return t=zi,(r=e.substr(zi,2)).toLowerCase()===L?zi+=2:(r=n,0===Hi&&es(at)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ni()):(zi=t,t=n)):(zi=t,t=n),t}function Ks(){var t,r,i,s;return t=zi,(r=e.substr(zi,7)).toLowerCase()===C?zi+=7:(r=n,0===Hi&&es(lt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ii()):(zi=t,t=n)):(zi=t,t=n),t}function Xs(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===N?zi+=4:(r=n,0===Hi&&es(ut)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=si()):(zi=t,t=n)):(zi=t,t=n),t}function eo(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===R?zi+=3:(r=n,0===Hi&&es(ct)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=oi()):(zi=t,t=n)):(zi=t,t=n),t}function to(){var t,r,i,s;return t=zi,(r=e.substr(zi,9)).toLowerCase()===O?zi+=9:(r=n,0===Hi&&es(pt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ai()):(zi=t,t=n)):(zi=t,t=n),t}function ro(){var t,r,i,s;return t=zi,(r=e.substr(zi,7)).toLowerCase()===F?zi+=7:(r=n,0===Hi&&es(dt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=li()):(zi=t,t=n)):(zi=t,t=n),t}function no(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===k?zi+=4:(r=n,0===Hi&&es(ht)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ui()):(zi=t,t=n)):(zi=t,t=n),t}function io(){var t,r,i,s;return t=zi,(r=e.substr(zi,8)).toLowerCase()===D?zi+=8:(r=n,0===Hi&&es(ft)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ci()):(zi=t,t=n)):(zi=t,t=n),t}function so(){var t,r,i,s;return t=zi,(r=e.substr(zi,9)).toLowerCase()===P?zi+=9:(r=n,0===Hi&&es(yt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=pi()):(zi=t,t=n)):(zi=t,t=n),t}function oo(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===V?zi+=4:(r=n,0===Hi&&es(mt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=di()):(zi=t,t=n)):(zi=t,t=n),t}function ao(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===Z?zi+=4:(r=n,0===Hi&&es(gt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=hi()):(zi=t,t=n)):(zi=t,t=n),t}function lo(){var t,r,i,s;return t=zi,(r=e.substr(zi,7)).toLowerCase()===G?zi+=7:(r=n,0===Hi&&es(vt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=fi()):(zi=t,t=n)):(zi=t,t=n),t}function uo(){var t,r,i,s;return t=zi,(r=e.substr(zi,8)).toLowerCase()===j?zi+=8:(r=n,0===Hi&&es(bt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=yi()):(zi=t,t=n)):(zi=t,t=n),t}function co(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===z?zi+=4:(r=n,0===Hi&&es(wt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=mi()):(zi=t,t=n)):(zi=t,t=n),t}function po(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===U?zi+=4:(r=n,0===Hi&&es(_t)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=gi()):(zi=t,t=n)):(zi=t,t=n),t}function ho(){var t,r,i,s;return t=zi,(r=e.substr(zi,2)).toLowerCase()===q?zi+=2:(r=n,0===Hi&&es(St)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=vi()):(zi=t,t=n)):(zi=t,t=n),t}function fo(){var t,r,i,s;return t=zi,(r=e.substr(zi,7)).toLowerCase()===B?zi+=7:(r=n,0===Hi&&es(It)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=bi()):(zi=t,t=n)):(zi=t,t=n),t}function yo(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===$?zi+=3:(r=n,0===Hi&&es(Mt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=wi()):(zi=t,t=n)):(zi=t,t=n),t}function mo(){var t,r,i,s;return t=zi,(r=e.substr(zi,8)).toLowerCase()===H?zi+=8:(r=n,0===Hi&&es(Tt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=_i()):(zi=t,t=n)):(zi=t,t=n),t}function go(){var t,r,i,s;return t=zi,(r=e.substr(zi,5)).toLowerCase()===J?zi+=5:(r=n,0===Hi&&es(xt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Si()):(zi=t,t=n)):(zi=t,t=n),t}function vo(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===Y?zi+=4:(r=n,0===Hi&&es(At)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ii()):(zi=t,t=n)):(zi=t,t=n),t}function bo(){var t,r,i,s;return t=zi,(r=e.substr(zi,7)).toLowerCase()===Q?zi+=7:(r=n,0===Hi&&es(Et)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Mi()):(zi=t,t=n)):(zi=t,t=n),t}function wo(){var t,r,i,s;return t=zi,(r=e.substr(zi,2)).toLowerCase()===K?zi+=2:(r=n,0===Hi&&es(Lt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ti()):(zi=t,t=n)):(zi=t,t=n),t}function _o(){var t,r,i,s;return t=zi,(r=e.substr(zi,8)).toLowerCase()===X?zi+=8:(r=n,0===Hi&&es(Ct)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=xi()):(zi=t,t=n)):(zi=t,t=n),t}function So(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===ee?zi+=4:(r=n,0===Hi&&es(Nt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ai()):(zi=t,t=n)):(zi=t,t=n),t}function Io(){var t,r,i,s;return t=zi,(r=e.substr(zi,13)).toLowerCase()===te?zi+=13:(r=n,0===Hi&&es(Rt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ei()):(zi=t,t=n)):(zi=t,t=n),t}function Mo(){var t,r,i,s;return t=zi,(r=e.substr(zi,15)).toLowerCase()===re?zi+=15:(r=n,0===Hi&&es(Ot)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Li()):(zi=t,t=n)):(zi=t,t=n),t}function To(){var t,r,i,s;return t=zi,(r=e.substr(zi,5)).toLowerCase()===ne?zi+=5:(r=n,0===Hi&&es(Ft)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ci()):(zi=t,t=n)):(zi=t,t=n),t}function xo(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===ie?zi+=3:(r=n,0===Hi&&es(kt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ni()):(zi=t,t=n)):(zi=t,t=n),t}function Ao(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===se?zi+=4:(r=n,0===Hi&&es(Dt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Ri()):(zi=t,t=n)):(zi=t,t=n),t}function Eo(){var t,r,i,s;return t=zi,(r=e.substr(zi,6)).toLowerCase()===oe?zi+=6:(r=n,0===Hi&&es(Pt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Oi()):(zi=t,t=n)):(zi=t,t=n),t}function Lo(){var t,r,i,s;return t=zi,(r=e.substr(zi,6)).toLowerCase()===ae?zi+=6:(r=n,0===Hi&&es(Vt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Fi()):(zi=t,t=n)):(zi=t,t=n),t}function Co(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===le?zi+=4:(r=n,0===Hi&&es(Zt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=ki()):(zi=t,t=n)):(zi=t,t=n),t}function No(){var t,r,i,s;return t=zi,(r=e.substr(zi,3)).toLowerCase()===ue?zi+=3:(r=n,0===Hi&&es(Gt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Di()):(zi=t,t=n)):(zi=t,t=n),t}function Ro(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===ce?zi+=4:(r=n,0===Hi&&es(jt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Pi()):(zi=t,t=n)):(zi=t,t=n),t}function Oo(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===pe?zi+=4:(r=n,0===Hi&&es(zt)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Vi()):(zi=t,t=n)):(zi=t,t=n),t}function Fo(){var t,r,i,s;return t=zi,(r=e.substr(zi,4)).toLowerCase()===de?zi+=4:(r=n,0===Hi&&es(Ut)),r!==n?(i=zi,Hi++,s=gs(),Hi--,s===n?i=void 0:(zi=i,i=n),i!==n?(Ui=t,t=Zi()):(zi=t,t=n)):(zi=t,t=n),t}function ko(){var t;return 44===e.charCodeAt(zi)?(t=he,zi++):(t=n,0===Hi&&es(qt)),t}function Do(){var t;return 40===e.charCodeAt(zi)?(t=fe,zi++):(t=n,0===Hi&&es(Bt)),t}function Po(){var t;return 41===e.charCodeAt(zi)?(t=ye,zi++):(t=n,0===Hi&&es($t)),t}function Vo(){var e,t;for(e=[],t=Zo();t!==n;)e.push(t),t=Zo();return e}function Zo(){var t;return t=e.charAt(zi),Ae.test(t)?zi++:(t=n,0===Hi&&es(Ht)),t}function Go(){var t,r,i,s;if(t=zi,(r=ys())!==n&&(Ui=t,r=Gi(r)),(t=r)===n)if(t=zi,96===e.charCodeAt(zi)?(r=me,zi++):(r=n,0===Hi&&es(Jt)),r!==n){if(i=[],s=e.charAt(zi),Ee.test(s)?zi++:(s=n,0===Hi&&es(Wt)),s!==n)for(;s!==n;)i.push(s),s=e.charAt(zi),Ee.test(s)?zi++:(s=n,0===Hi&&es(Wt));else i=n;i!==n?(96===e.charCodeAt(zi)?(s=me,zi++):(s=n,0===Hi&&es(Jt)),s!==n?(Ui=t,t=ji(i)):(zi=t,t=n)):(zi=t,t=n)}else zi=t,t=n;return t}function jo(e,t,r,n,i){const s={type:"binary-expression",location:i,operator:e,left:t,right:r};return void 0!==n&&(s.escape=n),s}function zo(e,...t){return{type:"expression-list",location:e,value:t}}function Uo(e,t){let r=e;for(const{op:e,expr:n,location:{end:i}}of t)r=jo(e,r,n,void 0,{...r.location,end:i});return r}if(r=o(),t.peg$library)return{peg$result:r,peg$currPos:zi,peg$FAILED:n,peg$maxFailExpected:$i,peg$maxFailPos:Bi};if(r!==n&&zi===e.length)return r;throw r!==n&&zi<e.length&&es({type:"end"}),function(e,t,r){return new W(W.buildMessage(e,t),e,t,r)}($i,Bi<e.length?e.charAt(Bi):null,Bi<e.length?Xi(Bi,Bi+1):Xi(Bi,Bi))}(e)}}function K(e,t){if(null!=e)switch(t(e),e.type){case"when-clause":K(e.operand,t),K(e.value,t);break;case"case-expression":for(const r of e.clauses)K(r,t);"simple"===e.format&&K(e.operand,t),null!==e.else&&K(e.else,t);break;case"expression-list":for(const r of e.value)K(r,t);break;case"unary-expression":K(e.expr,t);break;case"binary-expression":K(e.left,t),K(e.right,t);break;case"function":K(e.args,t);break;case"interval":K(e.value,t),K(e.qualifier,t);break;case"interval-qualifier":K(e.start,t),K(e.end,t)}}const X=new Set(["current_timestamp","current_date","current_time"]);class ee{static makeBool(e){return re(e)}static featureValue(e,t,r,n){return pe(e,t,r,n)}static equalsNull(e){return null===e}static applyLike(e,t,r){return ce(e,t,r)}static ensureArray(e){return ne(e)}static applyIn(e,t,r){return ae(e,t)}static currentTimestamp(e){return _(new Date,e)}static currentDate(e){return o.n.fromNow(e)}static currentTime(e){const t=_(new Date,e);return c.k.fromDateTime(t)}static makeSqlInterval(e,t,r){return l.createFromValueAndQualifier(e,t,r)}static convertInterval(e){return e instanceof l?e.valueInMilliseconds():e}static compare(e,t,r,n){return V(t,r,e)}static calculate(e,t,r,n){return H(e,t,r,n)}static evaluateTime(e){return C(e)}static evaluateTimestamp(e,t,r){return N(e,t,r)}static evaluateDate(e,t){return R(e,t)}static evaluateFunction(e,t,r){return z(e,t,r)}static lookup(e,t){const r=t[e];return void 0===r?null:r}static between(e,t,r){return null==e||null==t[0]||null==t[1]?null:V(e,t[0],">=")&&V(e,t[1],"<=")}static notbetween(e,t,r){return null==e||null==t[0]||null==t[1]?null:V(e,t[0],"<")||V(e,t[1],">")}static ternaryNot(e){return ie(e)}static ternaryAnd(e,t){return se(e,t)}static ternaryOr(e,t){return oe(e,t)}}class te{constructor(e,t,r="UTC",n=null){this.fieldsIndex=t,this.timeZone=r,this.currentUser=n,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=Q.parse(e);const{isStandardized:i,isAggregate:s,currentUserRequired:o,referencedFieldNames:a}=this._extractExpressionInfo(t);this._referencedFieldNames=a,this.isStandardized=i,this.isAggregate=s,this.currentUserRequired=o}static convertValueToStorageFormat(e,t=null){if(null===t)return T(e)?e.getTime():x(e)?e.toMillis():L(e)?e.toStorageFormat():E(e)?e.toStorageString():A(e)?e.toStorageFormat():e;switch(t){case"date":return T(e)?e.getTime():x(e)?e.toMillis():L(e)?e.toMilliseconds():A(e)?e.toNumber():e;case"date-only":return T(e)?o.n.fromDateJS(e).toString():L(e)?o.n.fromSqlTimeStampOffset(e).toString():x(e)?o.n.fromDateTime(e).toString():e;case"time-only":return T(e)?c.k.fromDateJS(e).toStorageString():x(e)?c.k.fromDateTime(e).toStorageString():L(e)?c.k.fromSqlTimeStampOffset(e).toStorageString():E(e)?e.toStorageString():e;case"timestamp-offset":if(T(e))return u.g.fromJSDate(e).toStorageFormat();if(x(e))return u.g.fromDateTime(e).toStorageFormat();if(L(e))return e.toStorageFormat()}return e}static create(e,t={}){return new te(e,t.fieldsIndex,t.timeZone??void 0,t.currentUser)}get fieldNames(){return this._referencedFieldNames}testSet(e,t=de,r=this.currentUser){return!!this._evaluateNode(this.parseTree,null,t,e,r)}calculateValue(e,t=de,r=this.currentUser){const n=this._evaluateNode(this.parseTree,e,t,null,r);return n instanceof l?n.valueInMilliseconds()/864e5:n}calculateValueCompiled(e,t=de,r=this.currentUser){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null):(0,i.A)("esri-csp-restrictions")?this.calculateValue(e,t):(this._compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null))}testFeature(e,t=de,r=this.currentUser){return!!this._evaluateNode(this.parseTree,e,t,null,r)}testFeatureCompiled(e,t=de,r=this.currentUser){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null):(0,i.A)("esri-csp-restrictions")?this.testFeature(e,t):(this._compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,K(this.parseTree,(e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||X.has(e.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const e=new Set;return K(this.parseTree,(t=>{"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}getExpressions(){const e=new Map;return K(this.parseTree,(t=>{if("function"===t.type){const r=t.name.toLowerCase(),n=t.args.value[0];if("column-reference"===n.type){const t=n.column,i=`${r}-${t}`;e.has(i)||e.set(i,{aggregateType:r,field:t})}}})),[...e.values()]}getVariables(){const e=new Set;return K(this.parseTree,(t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}_compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone","currentUser",e).bind(ee)}_extractExpressionInfo(e){const t=[],r=new Set;let n=!0,i=!1,o=!1;return K(this.parseTree,(a=>{switch(a.type){case"column-reference":{const n=e?.get(a.column);let i,s;n?i=s=n.name??"":(s=a.column,i=s.toLowerCase()),r.has(i)||(r.add(i),t.push(s)),a.column=s;break}case"current-user":o=!0;break;case"function":{const{name:e,args:t}=a,r=t.value.length;n&&(n=function(e,t){const r=$[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams}(e,r)),!1===i&&(i=(0,s.M)(e,r));break}}})),{referencedFieldNames:Array.from(t),isStandardized:n,isAggregate:i,currentUserRequired:o}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case-expression":{let t="";if("simple"===e.format){const r=this.evaluateNodeToJavaScript(e.operand);t="( ";for(let n=0;n<e.clauses.length;n++)t+=" (this.compare('=',"+r+","+this.evaluateNodeToJavaScript(e.clauses[n].operand)+") ? ("+this.evaluateNodeToJavaScript(e.clauses[n].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let r=0;r<e.clauses.length;r++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[r].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"parameter":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expression-list":{let t="[";for(const r of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(r);return t+="]",t}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary-expression":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new a.L8(a.Z7.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new a.L8(a.Z7.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";default:throw new a.L8(a.Z7.UnsupportedOperator,{operator:e.operator})}case"null":case"boolean":case"string":case"number":return JSON.stringify(e.value);case"time":return"this.evaluateTime("+JSON.stringify(e.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(e.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(e.value)+", 'unknown')";case"current-time":return"date"===e.mode?"this.currentDate(timeZone)":"time"===e.mode?"this.currentTime(timeZone)":"this.currentTimestamp(timeZone)";case"current-user":return"currentUser";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(e.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+", timeZone)"}throw new a.L8(a.Z7.UnsupportedSyntax,{node:e.type})}_evaluateNode(e,t,r,i,o){let u;switch(e.type){case"interval":{const n=this._evaluateNode(e.value,t,r,i,o);return l.createFromValueAndQualifier(n,e.qualifier,e.op)}case"case-expression":if("simple"===e.format){const n=this._evaluateNode(e.operand,t,r,i,o);for(let s=0;s<e.clauses.length;s++)if(V(n,this._evaluateNode(e.clauses[s].operand,t,r,i,o),"=",this.timeZone))return this._evaluateNode(e.clauses[s].value,t,r,i,o);if(null!==e.else)return this._evaluateNode(e.else,t,r,i,o)}else{for(let n=0;n<e.clauses.length;n++)if(re(this._evaluateNode(e.clauses[n].operand,t,r,i,o)))return this._evaluateNode(e.clauses[n].value,t,r,i,o);if(null!==e.else)return this._evaluateNode(e.else,t,r,i,o)}return null;case"parameter":return u=this.parameters[e.value.toLowerCase()],T(u)?d.c9.fromJSDate(u):u instanceof n.lY?u.toDateTime():u;case"expression-list":{const n=[];for(const s of e.value)n.push(this._evaluateNode(s,t,r,i,o));return n}case"unary-expression":return ie(this._evaluateNode(e.expr,t,r,i,o));case"binary-expression":switch(e.operator){case"AND":return se(this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o));case"OR":return oe(this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o));case"IS":if("null"!==e.right.type)throw new a.L8(a.Z7.UnsupportedIsRhs);return null===this._evaluateNode(e.left,t,r,i,o);case"ISNOT":if("null"!==e.right.type)throw new a.L8(a.Z7.UnsupportedIsRhs);return null!==this._evaluateNode(e.left,t,r,i,o);case"IN":{const n=ne(this._evaluateNode(e.right,t,r,i,o));return ae(this._evaluateNode(e.left,t,r,i,o),n,this.timeZone)}case"NOT IN":{const n=ne(this._evaluateNode(e.right,t,r,i,o));return ie(ae(this._evaluateNode(e.left,t,r,i,o),n,this.timeZone))}case"BETWEEN":{const n=this._evaluateNode(e.left,t,r,i,o),s=this._evaluateNode(e.right,t,r,i,o);return null==n||null==s[0]||null==s[1]?null:V(n,s[0],">=",this.timeZone)&&V(n,s[1],"<=",this.timeZone)}case"NOTBETWEEN":{const n=this._evaluateNode(e.left,t,r,i,o),s=this._evaluateNode(e.right,t,r,i,o);return null==n||null==s[0]||null==s[1]?null:V(n,s[0],"<",this.timeZone)||V(n,s[1],">",this.timeZone)}case"LIKE":return ce(this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o),e.escape);case"NOT LIKE":return ie(ce(this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return V(this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o),e.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return H(e.operator,this._evaluateNode(e.left,t,r,i,o),this._evaluateNode(e.right,t,r,i,o),this.timeZone)}case"null":case"boolean":case"string":case"number":return e.value;case"date":return e.parsedValue??=R(e.value,"unknown"),e.parsedValue;case"timestamp":return e.parsedValue??=N(e.value,"unknown"),e.parsedValue;case"time":return C(e.value);case"current-time":return"date"===e.mode?ee.currentDate(this.timeZone):"time"===e.mode?ee.currentTime(this.timeZone):ee.currentTimestamp(this.timeZone);case"current-user":return o??null;case"column-reference":return pe(t,e.column,this.fieldsIndex,r);case"data-type":return e.value;case"function":{if(this.isAggregate&&(0,s.M)(e.name,e.args.value.length)){const t=[];for(const n of e.args?.value||[]){const e=[];for(const t of i||[])e.push(this._evaluateNode(n,t,r,null,o));t.push(e)}return(0,s.s)(e.name,t)}const n=this._evaluateNode(e.args,t,r,i,o);return z(e.name,n,this.timeZone)}}throw new a.L8(a.Z7.UnsupportedSyntax,{node:e.type})}}function re(e){return!0===e}function ne(e){return Array.isArray(e)?e:[e]}function ie(e){return null!==e?!0!==e:null}function se(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function oe(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function ae(e,t,r){if(null==e)return null;let n=!1;for(const r of t)if(null==r)n=null;else{if(e===r){n=!0;break}if(D(e)&&D(r)&&(n=V(e,r,"="),n))break}return n}const le="-[]/{}()*+?.\\^$|";var ue;function ce(e,t,r){return null==e?null:function(e,t){const r=t;let n="",i=ue.Normal;for(let t=0;t<e.length;t++){const s=e.charAt(t);switch(i){case ue.Normal:s===r?i=ue.Escaped:le.includes(s)?n+="\\"+s:n+="%"===s?".*":"_"===s?".":s;break;case ue.Escaped:le.includes(s)?n+="\\"+s:n+=s,i=ue.Normal}}return new RegExp("^"+n+"$","m")}(t,r).test(e)}function pe(e,t,r,n){const i=n.getAttribute(e,t),s=r?.get(t);return null==i||"esriFieldTypeDate"!==s?.type&&"date"!==s?.type?null==i||"esriFieldTypeDateOnly"!==s?.type&&"date-only"!==s?.type?null==i||"esriFieldTypeTimeOnly"!==s?.type&&"time-only"!==s?.type?null==i||"esriFieldTypeTimestampOffset"!==s?.type&&"timestamp-offset"!==s?.type?i:new u.g(i):c.k.fromReader(i):o.n.fromReader(i):_(new Date(i),r?.getLuxonTimeZone(s.name)??d.mQ.utcInstance)}!function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"}(ue||(ue={}));const de={getAttribute:(e,t)=>(function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e)[t]}},93393:function(e,t,r){r.d(t,{L8:function(){return a},Z7:function(){return n}});var n,i,s=r(50944);(i=n||(n={})).InvalidFunctionParameters="InvalidFunctionParameters",i.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",i.UnsupportedSqlFunction="UnsupportedSqlFunction",i.UnsupportedOperator="UnsupportedOperator",i.UnsupportedSyntax="UnsupportedSyntax",i.UnsupportedIsRhs="UnsupportedIsRhs",i.UnsupportedIsLhs="UnsupportedIsLhs",i.InvalidDataType="InvalidDataType",i.CannotCastValue="CannotCastValue",i.FunctionNotRecognized="FunctionNotRecognized",i.InvalidTime="InvalidTime",i.InvalidParameterCount="InvalidParameterCount",i.InvalidTimeStamp="InvalidTimeStamp",i.InvalidDate="InvalidDate",i.InvalidOperator="InvalidOperator",i.IllegalInterval="IllegalInterval",i.YearMonthIntervals="YearMonthIntervals",i.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",i.MissingStatisticParameters="MissingStatisticParameters";const o={[n.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[n.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[n.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[n.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[n.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[n.UnsupportedOperator]:"Unsupported operator - {operator}",[n.UnsupportedSyntax]:"Unsupported syntax - {node}",[n.UnsupportedSqlFunction]:"Sql function not found = {function}",[n.InvalidDataType]:"Invalid sql data type",[n.InvalidDate]:"Invalid date encountered",[n.InvalidOperator]:"Invalid operator encountered",[n.InvalidTime]:"Invalid time encountered",[n.IllegalInterval]:"Illegal interval",[n.FunctionNotRecognized]:"Function not recognized",[n.InvalidTimeStamp]:"Invalid timestamp encountered",[n.InvalidParameterCount]:"Invalid parameter count for call to {name}",[n.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[n.YearMonthIntervals]:"Year-Month Intervals not supported",[n.CannotCastValue]:"Cannot cast value to the required data type"};class a extends Error{constructor(e,t){super((0,s.HC)(o[e],t)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,a)}}},66110:function(e,t,r){r.d(t,{AG:function(){return a},lk:function(){return i},vD:function(){return o},yS:function(){return s}});const n="randomUUID"in crypto;function i(){if(n)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=t=>e[t].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function s(){return`{${i().toUpperCase()}}`}function o(){return`{${i()}}`}function a(e){const t=e.toUpperCase();return"{"!==e[0]?`{${t}}`:t}},37797:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(61226),i=(r(58941),r(60539)),s=r(51846),o=r(13370),a=r(90465),l=r(50193);class u{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new s.A}destroy(){this.close()}get closed(){return!this._clients?.length}open(e,t){return new Promise(((r,n)=>{let s=!0;const o=e=>{(0,i.Te)(t.signal),s&&(s=!1,e())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let s=0;s<e.length;++s){const a=e[s];(0,i.$X)(a)?this._clientPromises[s]=a.then((e=>(this._clients[s]=new l.A(e,t,this._ongoingJobsQueue),o(r),this._clients[s])),(()=>(o(n),null))):(this._clients[s]=new l.A(a,t,this._ongoingJobsQueue),this._clientPromises[s]=Promise.resolve(this._clients[s]),o(r))}}))}broadcast(e,t,r){const n=new Array(this._clientPromises.length);for(let i=0;i<this._clientPromises.length;++i){const s=this._clientPromises[i];n[i]=s.then((n=>n?.invoke(e,t,r)))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject((0,i.NK)(`Worker closing, aborting job calling '${e.methodName}'`));for(const e of this._clientPromises)e.then((e=>e?.close()));this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,(0,o.h)(this)}invoke(e,t,r){return this.apply(e,[t],r)}apply(e,t,r){const n=(0,i.Tw)();this._ongoingJobsQueue.push({methodName:e,data:t,invokeOptions:r,resolver:n});for(let e=0;e<this._clientPromises.length;e++){const t=this._clients[e];t?t.jobAdded():this._clientPromises[e].then((e=>e?.jobAdded()))}return n.promise}createInvokeProxy(e){return(0,a.L)(this,e)}on(e,t){return Promise.all(this._clientPromises).then((()=>(0,n.vE)(this._clients.map((r=>r.on(e,t))))))}openPorts(){return new Promise((e=>{const t=new Array(this._clientPromises.length);let r=t.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then((i=>{i&&(t[n]=i.openPort()),0==--r&&e(t)}))}))}get test(){}}},90465:function(e,t,r){function n(e,t){return new Proxy({},{get:(r,n,i)=>(...r)=>{let i,s;const o=r[r.length-1];return function(e){return"object"==typeof e&&!Array.isArray(e)&&null!=e&&("signal"in e||"transferList"in e||0===Object.keys(e).length)}(o)&&(i=o.signal,s=o.transferList,r.pop()),e.apply(t?`${t}.${n.toString()}`:n.toString(),r,{transferList:s,signal:i})}})}r.d(t,{L:function(){return n}})},50193:function(e,t,r){r.d(t,{A:function(){return w}});var n=r(7156),i=r(39819),s=r(40212),o=r(61226),a=r(95929),l=r(60539),u=r(90465);const c={statsWorker:()=>r.e(1838).then(r.bind(r,27966)),geometryEngineWorker:()=>r.e(2384).then(r.bind(r,9568)),CSVSourceWorker:()=>r.e(2600).then(r.bind(r,80172)),EdgeProcessingWorker:()=>r.e(2933).then(r.bind(r,92273)),ElevationSamplerWorker:()=>r.e(5120).then(r.bind(r,55412)),FeatureServiceSnappingSourceWorker:()=>r.e(8246).then(r.bind(r,66038)),GeoJSONSourceWorker:()=>r.e(7253).then(r.bind(r,4389)),LercWorker:()=>r.e(6594).then(r.bind(r,67024)),MemorySourceWorker:()=>r.e(807).then(r.bind(r,8489)),PBFDecoderWorker:()=>r.e(8950).then(r.bind(r,19939)),FeaturePipelineWorker:()=>r.e(3806).then(r.bind(r,25423)),PointCloudWorker:()=>r.e(9722).then(r.bind(r,33764)),RasterWorker:()=>r.e(6221).then(r.bind(r,85563)),SceneLayerSnappingSourceWorker:()=>r.e(5974).then(r.bind(r,28820)),SceneLayerWorker:()=>r.e(5404).then(r.bind(r,90525)),WFSSourceWorker:()=>r.e(4900).then(r.bind(r,6412)),WorkerTileHandler:()=>r.e(3295).then(r.bind(r,27787)),Lyr3DWorker:()=>r.e(3213).then(r.bind(r,6883)),Feature3DPipelineWorker:()=>r.e(3929).then(r.bind(r,38518))};var p=r(64272),d=r(23532);const{CLOSE:h,ABORT:f,INVOKE:y,RESPONSE:m,OPEN_PORT:g,ON:v}=p.Go;class b{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===p.Go.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class w{static connect(e,t){const r=new MessageChannel;let n;n="function"==typeof e?new e:"default"in e&&"function"==typeof e.default?new e.default:e;const i=new w(r.port1,{channel:r,client:n,schedule:t});return"object"==typeof n&&"remoteClient"in n&&(n.remoteClient=i),w.clients.set(i,n),r.port2}static loadWorker(e){const t=c[e];return t?t():Promise.resolve(null)}constructor(e,t,r){this._port=e,this._jobQueue=r,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new b((e=>this._onInvokeMessage(e))),this._client=t.client,this._onMessage=this._onMessage.bind(this),this._channel=t.channel,this._schedule=t.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:h}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,t,r){return this.apply(e,[t],r)}apply(e,t,r){const n=r?.signal,s=r?.transferList;if(!this._port)return Promise.reject(new i.A(p.T,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:t}));const o=(0,p.Jc)();return new Promise(((r,i)=>{if((0,l.G4)(n))return this._processWork(),void i((0,l.NK)());const u=(0,l.u7)(n,(()=>{const e=this._outJobs.get(o);e&&(this._outJobs.delete(o),this._processWork(),(0,a.xt)(e.abortHandle),this._post({type:f,jobId:o}),i((0,l.NK)()))})),c={resolve:r,reject:i,abortHandle:u,debugInfo:e};this._outJobs.set(o,c),this._post({type:y,jobId:o,methodName:e,abortable:null!=n},t,s)}))}createInvokeProxy(e){return(0,u.L)(this,e)}on(e,t){const r=new MessageChannel;function n(e){t(e.data)}return this._port.postMessage({type:p.Go.ON,eventType:e,port:r.port2},[r.port2]),r.port1.addEventListener("message",n),r.port1.start(),(0,o.hA)((()=>{r.port1.postMessage({type:p.Go.CLOSE}),r.port1.close(),r.port1.removeEventListener("message",n)}))}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:g,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=2)return;const e=this._jobQueue?.pop();if(!e)return;const{methodName:t,data:r,invokeOptions:n,resolver:i}=e;this.apply(t,r,n).then((e=>i.resolve(e))).catch((e=>i.reject(e)))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((e=>{(0,a.xt)(e.abortHandle),e.reject((0,l.NK)(`Worker closing, aborting job calling '${e.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){null!=this._schedule?this._schedule((()=>this._processMessage(e,!0))):this._processMessage(e,!1)}_processMessage(e,t){const r=(0,p.VI)(e);if(r)switch(r.type){case m:this._onResponseMessage(r);break;case y:t?this._onInvokeMessage(r):this._invokeQueue.push(r);break;case f:this._onAbortMessage(r);break;case h:this._onCloseMessage();break;case g:this._onOpenPortMessage(r);break;case v:this._onOnMessage(r)}}_onAbortMessage(e){const t=this._inJobs,r=e.jobId,n=t.get(r);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),t.delete(r))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&w.clients.get(this)===e&&e.destroy(),w.clients.delete(this),e?.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:t,jobId:r,data:n=[],abortable:i}=e,s=i?new AbortController:null,o=this._inJobs;let a,u=this._client,c=u[t];try{if(!c&&t&&t.includes(".")){const e=t.split(".");for(let t=0;t<e.length-1;t++)u=u[e[t]],c=u[e[t+1]]}if("function"!=typeof c)throw new TypeError(`${t} is not a function`);n.push({client:this,signal:s?s.signal:null}),a=c.apply(u,n)}catch(e){return void this._post({type:m,jobId:r,error:(0,p.mF)(e)})}(0,l.$X)(a)?(o.set(r,{controller:s,promise:a}),a.then((e=>{o.has(r)&&(o.delete(r),this._post({type:m,jobId:r},e))}),(e=>{o.has(r)&&(o.delete(r),(0,l.zf)(e)||this._post({type:m,jobId:r,error:(0,p.mF)(e||{message:`Error encountered at method ${t}`})}))}))):this._post({type:m,jobId:r},a)}_onOpenPortMessage(e){new w(e.port,{client:this._client})}_onOnMessage(e){const{port:t}=e,r=this._client.on(e.eventType,(e=>{t.postMessage(e)})),n=(0,s.on)(e.port,"message",(e=>{const i=(0,p.VI)(e);i?.type===p.Go.CLOSE&&(n.remove(),r.remove(),t.close())}))}_onResponseMessage(e){const{jobId:t,error:r,data:n}=e,s=this._outJobs;if(!s.has(t))return;const o=s.get(t);s.delete(t),this._processWork(),(0,a.xt)(o.abortHandle),r?o.reject(i.A.fromJSON(JSON.parse(r))):o.resolve(n)}_post(e,t,r){return(0,p.u1)(this._port,e,t,r)}}w.kernelInfo={buildDate:d.$,fullVersion:n.ol,revision:d.u},w.clients=new Map},13370:function(e,t,r){r.d(t,{h:function(){return s},k:function(){return i}});const n=new FinalizationRegistry((e=>{e.close()}));function i(e,t){n.register(e,t,t)}function s(e){n.unregister(e)}},64272:function(e,t,r){r.d(t,{Go:function(){return o},Jc:function(){return u},T:function(){return s},VI:function(){return d},mF:function(){return c},oV:function(){return f},u1:function(){return p}});var n=r(58941),i=r(60539);const s="worker:port-closed";var o,a;(a=o||(o={}))[a.HANDSHAKE=0]="HANDSHAKE",a[a.OPEN=1]="OPEN",a[a.OPENED=2]="OPENED",a[a.RESPONSE=3]="RESPONSE",a[a.INVOKE=4]="INVOKE",a[a.ABORT=5]="ABORT",a[a.CLOSE=6]="CLOSE",a[a.OPEN_PORT=7]="OPEN_PORT",a[a.ON=8]="ON";let l=0;function u(){return l++}function c(e){return e?"string"==typeof e?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function p(e,t,r,i){if(t.type===o.OPEN_PORT)return void e.postMessage(t,[t.port]);if(t.type!==o.INVOKE&&t.type!==o.RESPONSE)return void e.postMessage(t);let s;if(function(e){return e&&"object"==typeof e&&("result"in e||"transferList"in e)}(r)?(s=h(r.transferList),t.data=r.result):(s=h(i),t.data=r),s){if((0,n.A)("ff"))for(const r of s)if("byteLength"in r&&r.byteLength>267386880){const r="Worker call with large ArrayBuffer would crash Firefox";switch(t.type){case o.INVOKE:throw r;case o.RESPONSE:return void p(e,{type:o.RESPONSE,jobId:t.jobId,error:c(r)})}}e.postMessage(t,s)}else e.postMessage(t)}function d(e){if(!e)return null;const t=e.data;return t?"string"==typeof t?JSON.parse(t):t:null}function h(e){if(!e?.length)return null;if((0,n.A)("esri-workers-arraybuffer-transfer"))return e;const t=e.filter((e=>!function(e){return e instanceof ArrayBuffer||"ArrayBuffer"===e?.constructor?.name}(e)));return t.length?t:null}async function f(e){try{return await e}catch(e){const t=e?.name===s;if(!(0,i.zf)(e)&&!t)throw e;return}}},86027:function(e,t,r){r.d(t,{n_:function(){return j},ho:function(){return U}});var n=r(39819),i=r(58941),s=r(60539),o=r(37797),a=r(13370),l=r(50193),u=r(40633),c=r(95929),p=r(93040),d=r(90683);const h={async request(e,t){const r=e.options,n=r.responseType;r.signal=t?.signal,r.responseType="native"===n||"native-request-init"===n?"native-request-init":n&&["blob","json","text"].includes(n)&&(0,d.sC)(e.url)?.after?n:"array-buffer";const i=await(0,p.A)(e.url,r),s={data:i.data,httpStatus:i.httpStatus,ssl:i.ssl};switch(i.requestOptions?.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=(new TextEncoder).encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=(new TextEncoder).encode(s.data).buffer}return{result:s,transferList:[s.data]}}};var f=r(64272),y=r(53216),m=r(25591),g=(r(64122),r(7156));const v={};var b=r(29601);class w{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((t=>{this[t]=(...r)=>e[t](...r)}))}}class _{constructor(){this._dispatcher=new w,this._workerPostMessage({type:f.Go.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){(0,b.d)((()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))}))}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,t,r){this._dispatcher.addEventListener(e,t,r)}removeEventListener(e,t,r){this._dispatcher.removeEventListener(e,t,r)}_workerPostMessage(e){(0,b.d)((()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))}))}async _workerMessageHandler(e){const t=(0,f.VI)(e);if(t&&t.type===f.Go.OPEN){const{modulePath:e,jobId:r}=t;let n=await l.A.loadWorker(e);n||(n=await import(e));const i=l.A.connect(n);this._workerPostMessage({type:f.Go.OPENED,jobId:r,data:i})}}}var S=r(22739),I=r(23532);const M=()=>u.A.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:T}=f.Go;let x,A;const E="Failed to create Worker. Fallback to execute module in main thread";async function L(e){return new Promise((t=>{function r(i){const s=(0,f.VI)(i);s&&s.type===T&&(e.removeEventListener("message",r),e.removeEventListener("error",n),t(e))}function n(t){t.preventDefault(),e.removeEventListener("message",r),e.removeEventListener("error",n),M().warn("Failed to create Worker. Fallback to execute module in main thread",t),(e=new _).addEventListener("message",r),e.addEventListener("error",n)}e.addEventListener("message",r),e.addEventListener("error",n)}))}let C=0;const{ABORT:N,INVOKE:R,OPEN:O,OPENED:F,RESPONSE:k}=f.Go;class D{static async create(e){const t=await async function(){if(!(0,i.A)("esri-workers"))return L(new _);if(!x&&!A)try{const e='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});'.split("{CONFIGURATION}").join(function(){let e;if(null!=m.default.default){const t={...m.default};delete t.default,e=JSON.parse(JSON.stringify(t))}else e=JSON.parse(JSON.stringify(m.default));e.assetsPath=(0,d.s2)(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?(0,d.s2)(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=(0,S.JK)(),e.has={"esri-csp-restrictions":(0,i.A)("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":(0,i.A)("esri-2d-update-debug"),"esri-2d-log-updating":(0,i.A)("esri-2d-log-updating"),"featurelayer-pbf":(0,i.A)("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":(0,i.A)("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":(0,i.A)("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":(0,i.A)("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":(0,i.A)("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":(0,i.A)("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":(0,i.A)("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":(0,i.A)("featurelayer-snapshot-enabled"),"esri-atomics":(0,i.A)("esri-atomics"),"esri-shared-array-buffer":(0,i.A)("esri-shared-array-buffer"),"esri-tiles-debug":(0,i.A)("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":(0,i.A)("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":(0,i.A)("feature-polyline-generalization-factor"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=(0,d.s2)(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=(0,d.s2)(e.workers.workerPath):e.workers.workerPath=(0,d.s2)((0,y.s)("esri/core/workers/RemoteClient.js")),e.workers.useDynamicImport=!1;const t=m.default.workers.loaderConfig,r=function(e){const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:{...e.has},map:{...e.map},packages:e.packages?.slice()||[],paths:{...v.paths,...e.paths}};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=v.baseUrl),t}({baseUrl:t?.baseUrl,locale:(0,S.JK)(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...t?.has},map:{...t?.map},paths:{...t?.paths},packages:t?.packages||[]}),n={buildDate:I.$,fullVersion:g.ol,revision:I.u};return JSON.stringify({esriConfig:e,loaderConfig:r,kernelInfo:n})}());x=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){A=e||{}}let e;if(x)try{e=new Worker(x,{name:"esri-worker-"+C++})}catch(t){M().warn(E,A),e=new _}else M().warn(E,A),e=new _;return L(e)}();return new D(t,e)}constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(e=>{e.preventDefault(),u.A.getLogger("esri.core.workers.WorkerOwner").error(e)}))}terminate(){this.worker.terminate()}async open(e,t={}){const{signal:r}=t,n=(0,f.Jc)();return new Promise(((t,i)=>{const o={resolve:t,reject:i,abortHandle:(0,s.NY)(r,(()=>{this._outJobs.delete(n),this._post({type:N,jobId:n})}))};this._outJobs.set(n,o),this._post({type:O,jobId:n,modulePath:e})}))}_onMessage(e){const t=(0,f.VI)(e);if(t)switch(t.type){case F:this._onOpenedMessage(t);break;case k:this._onResponseMessage(t);break;case N:this._onAbortMessage(t);break;case R:this._onInvokeMessage(t)}}_onAbortMessage(e){const t=this._inJobs,r=e.jobId,n=t.get(r);n&&(n.controller&&n.controller.abort(),t.delete(r))}_onInvokeMessage(e){const{methodName:t,jobId:r,data:n,abortable:i}=e,o=i?new AbortController:null,a=this._inJobs,l=h[t];let u;try{if("function"!=typeof l)throw new TypeError(`${t} is not a function`);u=l.call(null,n,{signal:o?o.signal:null})}catch(e){return void this._post({type:k,jobId:r,error:(0,f.mF)(e)})}(0,s.$X)(u)?(a.set(r,{controller:o,promise:u}),u.then((e=>{a.has(r)&&(a.delete(r),this._post({type:k,jobId:r},e))}),(e=>{a.has(r)&&(a.delete(r),e||(e={message:"Error encountered at method"+t}),(0,s.zf)(e)||this._post({type:k,jobId:r,error:(0,f.mF)(e||{message:`Error encountered at method ${t}`})}))}))):this._post({type:k,jobId:r},u)}_onOpenedMessage(e){const{jobId:t,data:r}=e,n=this._outJobs.get(t);n&&(this._outJobs.delete(t),(0,c.xt)(n.abortHandle),n.resolve(r))}_onResponseMessage(e){const{jobId:t,error:r,data:i}=e,s=this._outJobs.get(t);s&&(this._outJobs.delete(t),(0,c.xt)(s.abortHandle),r?s.reject(n.A.fromJSON(JSON.parse(r))):s.resolve(i))}_post(e,t,r){return(0,f.u1)(this.worker,e,t,r)}}const P=(0,i.A)("host-browser")?Math.min(navigator.hardwareConcurrency-1,(0,i.A)("workers-pool-size")??8):0;let V=(0,i.A)("esri-mobile")?Math.min(P,3):P;V||(V=(0,i.A)("safari")&&(0,i.A)("mac")?7:2);let Z=0;const G=[];function j(){$()}async function z(e,t){const r=new o.A,{registryTarget:n,...i}=t;return await r.open(e,i),n&&(0,a.k)(n,r),r}async function U(e,t={}){if("string"!=typeof e)throw new n.A("workers:undefined-module","modulePath is missing");let r=t.strategy||"distributed";if((0,i.A)("host-webworker")&&!(0,i.A)("esri-workers")&&(r="local"),"local"===r){let r=await l.A.loadWorker(e);r||(r=await import(e)),(0,s.Te)(t.signal);const n=t.client||r;return z([l.A.connect(r,t.schedule)],{...t,client:n})}if(await $(),(0,s.Te)(t.signal),"dedicated"===r){const r=Z++%V;return z([await G[r].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const r=Math.min(t.maxNumWorkers,V);if(r<V){const n=new Array(r);for(let i=0;i<r;++i){const r=Z++%V;n[i]=G[r].open(e,t)}return z(n,t)}}return z(G.map((r=>r.open(e,t))),t)}let q,B=null;async function $(){if(B)return B;q=new AbortController;const e=[];for(let t=0;t<V;t++){const r=D.create(t).then((e=>(G[t]=e,e)));e.push(r)}return B=Promise.all(e),B}},86029:function(e,t,r){r.d(t,{g:function(){return n}});const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,r){const n=new i(e.getPointX(t),e.getPointY(t),r),s=e.hasZ(t),o=e.hasM(t);return s&&(n.z=e.getPointZ(t)),o&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,r){return new s(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,r){return new o(e.exportPaths(t),r,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,r){return new a(e.exportPoints(t),r,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,r){const n=e.hasZ(t),i=e.hasM(t),s=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),r);if(n){const r=e.getZExtent(t);s.zmin=r.vmin,s.zmax=r.vmax}if(i){const r=e.getMExtent(t);s.mmin=r.vmin,s.mmax=r.vmax}return s}};class i{constructor(e,t,r){this.x=e,this.y=t,this.spatialReference=r,this.z=void 0,this.m=void 0}}class s{constructor(e,t,r,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class o{constructor(e,t,r,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class a{constructor(e,t,r,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,r&&(this.hasZ=r),n&&(this.hasM=n)}}class l{constructor(e,t,r,n,i){this.xmin=e,this.ymin=t,this.xmax=r,this.ymax=n,this.spatialReference=i,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},65298:function(e,t,r){r.d(t,{O7:function(){return x},Hr:function(){return T},el:function(){return M},mT:function(){return A},XX:function(){return w}});var n=r(25591),i=r(39819),s=r(40633),o=r(44740),a=r(91508),l=r(65417),u=r(57652),c=r(1644),p=(r(50917),r(93040)),d=r(74697),h=r(39397),f=r(90683),y=r(26765);const m=()=>s.A.getLogger("esri.geometry.support.normalizeUtils");function g(e){return"polygon"===e[0].type}function v(e){return"polyline"===e[0].type}function b(e){const t=[];let r=0,n=0;for(let i=0;i<e.length;i++){const s=e[i];let o=null;for(let e=0;e<s.length;e++)o=s[e],t.push(o),0===e?(r=o[0],n=r):(r=Math.min(r,o[0]),n=Math.max(n,o[0]));o&&t.push([(r+n)/2,0])}return t}function w(e,t){if(!(e instanceof a.A||e instanceof o.A)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m().error(e),new i.A(e)}const r=(0,l.r8)(e),n=[];for(const e of r){const r=[];n.push(r),r.push([e[0][0],e[0][1]]);for(let n=0;n<e.length-1;n++){const i=e[n][0],s=e[n][1],o=e[n+1][0],a=e[n+1][1],l=Math.sqrt((o-i)*(o-i)+(a-s)*(a-s)),u=(a-s)/l,c=(o-i)/l,p=l/t;if(p>1){for(let e=1;e<=p-1;e++){const n=e*t,o=c*n+i,a=u*n+s;r.push([o,a])}const e=(l+Math.floor(p-1)*t)/2,n=c*e+i,o=u*e+s;r.push([n,o])}r.push([o,a])}}return function(e){return"polygon"===e.type}(e)?new o.A({rings:n,spatialReference:e.spatialReference}):new a.A({paths:n,spatialReference:e.spatialReference})}function _(e,t,r){if(t){const t=w(e,1e6);e=(0,c.ci)(t,!0)}return r&&(e=(0,l.kS)(e,r)),e}function S(e,t,r){if(Array.isArray(e)){const n=e[0];if(n>t){const r=(0,l.kd)(n,t);e[0]=n+r*(-2*t)}else if(n<r){const t=(0,l.kd)(n,r);e[0]=n+t*(-2*r)}}else{const n=e.x;if(n>t){const r=(0,l.kd)(n,t);e=e.clone().offset(r*(-2*t),0)}else if(n<r){const t=(0,l.kd)(n,r);e=e.clone().offset(t*(-2*r),0)}}return e}function I(e,t){let r=-1;for(let n=0;n<t.cutIndexes.length;n++){const i=t.cutIndexes[n],s=t.geometries[n],o=(0,l.r8)(s);for(let e=0;e<o.length;e++){const t=o[e];t.some((r=>{if(r[0]<180)return!0;{let r=0;for(let e=0;e<t.length;e++){const n=t[e][0];r=n>r?n:r}r=Number(r.toFixed(9));const n=-360*(0,l.kd)(r,180);for(let r=0;r<t.length;r++){const t=s.getPoint(e,r);s.setPoint(e,r,t.clone().offset(n,0))}return!0}}))}if(i===r){if(g(e))for(const t of(0,l.r8)(s))e[i]=e[i].addRing(t);else if(v(e))for(const t of(0,l.r8)(s))e[i]=e[i].addPath(t)}else r=i,e[i]=s}return e}async function M(e,t,r){if(!Array.isArray(e))return M([e],t);t&&"string"!=typeof t&&m().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i="string"==typeof t?t:t?.url??n.default.geometryServiceUrl;let s,g,v,b,w,T,x,A,E=0;const L=[],C=[];for(const t of e)if(null!=t)if(s||(s=t.spatialReference,g=(0,u.Vp)(s),v=s.isWebMercator,T=v?102100:4326,b=l.j7[T].maxX,w=l.j7[T].minX,x=l.j7[T].plus180Line,A=l.j7[T].minus180Line),g)if("mesh"===t.type)C.push(t);else if("point"===t.type)C.push(S(t.clone(),b,w));else if("multipoint"===t.type){const e=t.clone();e.points=e.points.map((e=>S(e,b,w))),C.push(e)}else if("extent"===t.type){const e=t.clone()._normalize(!1,!1,g);C.push(e.rings?new o.A(e):e)}else if(t.extent){const e=t.extent,r=(0,l.kd)(e.xmin,w)*(2*b);let n=0===r?t.clone():(0,l.kS)(t.clone(),r);e.offset(r,0);let{xmin:i,xmax:s}=e;i=Number(i.toFixed(9)),s=Number(s.toFixed(9)),e.intersects(x)&&s!==b?(E=s>E?s:E,n=_(n,v),L.push(n),C.push("cut")):e.intersects(A)&&i!==w?(E=s*(2*b)>E?s*(2*b):E,n=_(n,v,360),L.push(n),C.push("cut")):C.push(n)}else C.push(t.clone());else C.push(t);else C.push(t);let N=(0,l.kd)(E,b),R=-90;const O=N,F=new a.A;for(;N>0;){const e=360*N-180;F.addPath([[e,R],[e,-1*R]]),R*=-1,N--}if(L.length>0&&O>0){const t=I(L,await async function(e,t,r,n){const i=(0,h.Dl)(e),s=t[0].spatialReference,o={...n,responseType:"json",query:{...i.query,f:"json",sr:(0,u.YX)(s),target:JSON.stringify({geometryType:(0,d.$B)(t[0]),geometries:t}),cutter:JSON.stringify(r)}},a=await(0,p.A)(i.path+"/cut",o),{cutIndexes:l,geometries:c=[]}=a.data;return{cutIndexes:l,geometries:c.map((e=>{const t=(0,d.rS)(e);return t.spatialReference=s,t}))}}(i,L,F,r)),n=[],s=[];for(let r=0;r<C.length;r++){const i=C[r];if("cut"!==i)s.push(i);else{const i=t.shift(),o=e[r];null!=o&&"polygon"===o.type&&o.rings&&o.rings.length>1&&i.rings.length>=o.rings.length?(n.push(i),s.push("simplify")):s.push(v?(0,c.Gh)(i):i)}}if(!n.length)return s;const o=await async function(e,t,r){const n="string"==typeof e?(0,f.An)(e):e,i=t[0].spatialReference,s=(0,d.$B)(t[0]),o={...r,query:{...n.query,f:"json",sr:(0,u.YX)(i),geometries:JSON.stringify((0,y.X)(t))}},{data:a}=await(0,p.A)(n.path+"/simplify",o);return(0,y.V)(a.geometries,s,i)}(i,n,r),a=[];for(let e=0;e<s.length;e++){const t=s[e];"simplify"!==t?a.push(t):a.push(v?(0,c.Gh)(o.shift()):o.shift())}return a}const k=[];for(let e=0;e<C.length;e++){const t=C[e];if("cut"!==t)k.push(t);else{const e=L.shift();k.push(!0===v?(0,c.Gh)(e):e)}}return k}function T(e){if(!e)return null;const t=e.extent;if(!t)return null;const r=e.spatialReference&&(0,u.Vp)(e.spatialReference);if(!r)return t;const[n,i]=r.valid,s=2*i,{width:o}=t;let a,{xmin:l,xmax:c}=t;if([l,c]=[c,l],"extent"===e.type||0===o||o<=i||o>s||l<n||c>i)return t;switch(e.type){case"polygon":if(!(e.rings.length>1))return t;a=b(e.rings);break;case"polyline":if(!(e.paths.length>1))return t;a=b(e.paths);break;case"multipoint":a=e.points}const p=t.clone();for(let e=0;e<a.length;e++){let t=a[e][0];t<0?(t+=i,c=Math.max(t,c)):(t-=i,l=Math.min(t,l))}return p.xmin=l,p.xmax=c,p.width<o?(p.xmin-=i,p.xmax-=i,p):t}function x(e,t,r){const n=(0,u.Vp)(r);if(null==n)return e;const[i,s]=n.valid,o=2*s;let a=0,l=0;t>s?a=Math.ceil(Math.abs(t-s)/o):t<i&&(a=-Math.ceil(Math.abs(t-i)/o)),e>s?l=Math.ceil(Math.abs(e-s)/o):e<i&&(l=-Math.ceil(Math.abs(e-i)/o));let c=e+(a-l)*o;const p=c-t;return p>s?c-=o:p<i&&(c+=o),c}function A(e,t){const r=(0,u.Vp)(t);if(r){const[t,n]=r.valid,i=n-t;if(e<t)for(;e<t;)e+=i;if(e>n)for(;e>n;)e-=i}return e}},65417:function(e,t,r){r.d(t,{j7:function(){return o},kS:function(){return l},kd:function(){return a},r8:function(){return u}});var n=r(91508),i=r(57165),s=r(74697);const o={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new n.A({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:i.A.WebMercator}),minus180Line:new n.A({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:i.A.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new n.A({paths:[[[180,-180],[180,180]]],spatialReference:i.A.WGS84}),minus180Line:new n.A({paths:[[[-180,-180],[-180,180]]],spatialReference:i.A.WGS84})}};function a(e,t){return Math.ceil((e-t)/(2*t))}function l(e,t){const r=u(e);for(const e of r)for(const r of e)r[0]+=t;return e}function u(e){return(0,s.Bi)(e)?e.rings:e.paths}},87280:function(e,t,r){function n(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function i(e){if(function(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}(e))return e;const{originPosition:t,scale:r,translate:n}=e,i=r[0]??1,s=r[1]??1;return{originPosition:"lowerLeft",scale:[i,"lowerLeft"===t?s:-s,r[2]??1,r[3]??1],translate:[n[0]??0,n[1]??0,n[2]??0,n[3]??0]}}function s({scale:e,translate:t},r){return r*e[0]+t[0]}function o({scale:e,translate:t},r){return r*e[1]+t[1]}function a({scale:e,translate:t},r){return(r??0)*e[2]+t[2]}function l({scale:e,translate:t},r){return r?r*e[3]+t[3]:0}function u(e,t){return e&&t?h:e&&!t?p:!e&&t?d:c}r.d(t,{$X:function(){return v},Gy:function(){return y},P5:function(){return b},Q1:function(){return i},SW:function(){return m},Tr:function(){return g},VV:function(){return n}}),r(74697);const c=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=s(e,n[0]),a=o(e,n[1]);r[0]=[i,a];const{scale:l,originPosition:u}=e,c=l[0],p="lowerLeft"===u?l[1]:-l[1];for(let e=1;e<t.length;e++){const[n,s]=t[e];i+=c*n,a+=p*s,r[e]=[i,a]}return r},p=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=s(e,n[0]),l=o(e,n[1]);r[0]=[i,l,a(e,n[2])];const{scale:u,originPosition:c}=e,p=u[0],d="lowerLeft"===c?u[1]:-u[1];for(let n=1;n<t.length;n++){const[s,o,u]=t[n];i+=p*s,l+=d*o,r[n]=[i,l,a(e,u)]}return r},d=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=s(e,n[0]),a=o(e,n[1]);r[0]=[i,a,l(e,n[2])];const{scale:u,originPosition:c}=e,p=u[0],d="lowerLeft"===c?u[1]:-u[1];for(let n=1;n<t.length;n++){const[s,o,u]=t[n];i+=p*s,a+=d*o,r[n]=[i,a,l(e,u)]}return r},h=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const n=t[0];let i=s(e,n[0]),u=o(e,n[1]);r[0]=[i,u,a(e,n[2]),l(e,n[3])];const{scale:c,originPosition:p}=e,d=c[0],h="lowerLeft"===p?c[1]:-c[1];for(let n=1;n<t.length;n++){const[s,o,c,p]=t[n];i+=d*s,u+=h*o,r[n]=[i,u,a(e,c),l(e,p)]}return r};function f(e,t,r){const n=new Array(r.length);for(let i=0;i<r.length;i++)n[i]=t(e,r[i]);return n}function y(e,t,r){const n=i(e);return t.x=function({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}(n,r.x),t.y=function({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}(n,r.y),null!=r.z&&(t.z=function({scale:e,translate:t},r){return Math.round(((r??0)-t[2])/e[2])}(n,r.z)),null!=r.m&&(t.m=function({scale:e,translate:t},r){return r?Math.round((r-t[3])/e[3]):0}(n,r.m)),t}function m(e,t,r,n=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=i(e);t.points=u(n,s)(o,r.points),t.hasZ=n,t.hasM=s}return t}function g(e,t,r,n=null!=r?.z,u=null!=r?.m){if(null==r)return t;const c=i(e);return t.x=s(c,r.x),t.y=o(c,r.y),n&&(t.z=a(c,r.z)),u&&(t.m=l(c,r.m)),t}function v(e,t,r,n=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=i(e);t.rings=f(o,u(n,s),r.rings),t.hasZ=n,t.hasM=s}return t}function b(e,t,r,n=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=i(e);t.paths=f(o,u(n,s),r.paths),t.hasZ=n,t.hasM=s}return t}},26438:function(e,t,r){r.r(t),r.d(t,{default:function(){return O}});var n,i,s=r(53804),o=(r(50917),r(78879)),a=r(39819),l=r(40633),u=r(25738),c=r(77793),p=r(60539),d=r(28181),h=r(23502),f=(r(58941),r(13798),r(65953)),y=r(72977),m=r(20833),g=r(58081),v=r(76613);(i=n||(n={})).MULTIPLIER="multiplier",i.ABSOLUTE="absoluteValue";var b=r(34485),w=r(12345),_=r(10143),S=r(54709),I=r(38057),M=r(1615),T=r(92078),x=r(18195),A=r(20985),E=r(71165),L=r(91484),C=r(45532),N=r(91508);let R=class extends((0,T.q)((0,M.dM)((0,x.j)((0,c.P)(m.A))))){constructor(e){if(super(e),this.dataPreloadedInLocalCache=!1,this.defaultLinkChartConfig=null,this._currentLinkChartConfig={layoutMode:"RADIAL_TREE"},this._graphTypeLookup=new Map,this.dataManager=null,this.knowledgeGraph=null,this.layers=new(o.A.ofType(w.A)),this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map,this.linkChartExtent=new L.default({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7}),this.memberEntityTypes=null,this.memberRelationshipTypes=null,this.operationalLayerType="LinkChartLayer",this.sublayerIdsCache=new Map,this.tables=new(o.A.ofType(w.A)),this.type="link-chart",this.chronologicalAuxiliaryGraphics=null,this._originalInclusionList=e?.inclusionModeDefinition,e?.dataPreloadedInLocalCache&&!e?.inclusionModeDefinition)throw new a.A("knowledge-graph:linkchart-layer-constructor","If creating a link chart composite layer and configured that data is already loaded in the cache, you must specify an inclusion list so the Composite Layer knows what records belong to it");this.addHandles((0,d.watch)((()=>this.layers.concat(this.tables)),((e,t)=>this._handleSublayersChange(e,t)),d.OH))}normalizeCtorArgs(e){if(!e)return{};const{url:t,title:r,dataPreloadedInLocalCache:n,defaultLinkChartConfig:i}=e;return{url:t,title:r,dataPreloadedInLocalCache:n,defaultLinkChartConfig:i}}_initializeLayerProperties(e){if(!this.title&&this.url){const e=this.url.split("/");this.title=e[e.length-2]}const t=new Set;let r=[],n=[];if(e.inclusionModeDefinition&&(!e.inclusionModeDefinition.namedTypeDefinitions||e.inclusionModeDefinition.namedTypeDefinitions.size<1))throw new a.A("knowledge-graph:composite-layer-constructor","If an explicit inclusion definition is defined, at least one namedTypeDefinition must also be defined");e.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&this._graphTypeLookup.set(e.name,e)})),e.inclusionModeDefinition?.generateAllSublayers?(r=e.knowledgeGraph.dataModel.entityTypes??[],n=e.knowledgeGraph.dataModel.relationshipTypes??[]):e.inclusionModeDefinition?.namedTypeDefinitions&&e.inclusionModeDefinition?.namedTypeDefinitions.size>0?e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((i,s)=>{const o=this._graphTypeLookup.get(s);if(!o)return l.A.getLogger(this).warn(`A named type, ${s}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(s);"relationship"===o.type?t.has(s)||(t.add(s),n.push(o)):"entity"===o.type?t.has(s)||(t.add(s),r.push(o)):(l.A.getLogger(this).warn(`A named type, ${s}, was in the inclusion list that wasn't properly modeled and will be removed`),e.inclusionModeDefinition?.namedTypeDefinitions.delete(s))})):(r=e.knowledgeGraph.dataModel.entityTypes??[],n=e.knowledgeGraph.dataModel.relationshipTypes??[]);const i=new b.P({knowledgeGraph:e.knowledgeGraph,inclusionModeDefinition:e.inclusionModeDefinition});this.knowledgeGraph=e.knowledgeGraph,this.memberEntityTypes=r,this.memberRelationshipTypes=n,this.dataManager=i}load(e){const t=async()=>{const e=[],t=[];this.loadLayerAssumingLocalCache(),await(0,_.qN)(this),this.dataManager.inclusionModeDefinition&&(this.dataManager.inclusionModeDefinition.generateAllSublayers=!1),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.forEach((e=>{e.useAllData=!1})),await this._initializeDiagram(),this.layers.forEach((r=>{t.push(r.refreshCachedQueryEngine()),e.push(new Promise((e=>{r.on("layerview-create",(()=>{e(null)}))})))})),this.tables.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t)};return this.addResolvingPromise(new Promise((r=>{(0,E.fetchKnowledgeGraph)(this.url).then((async n=>{if(this._initializeLayerProperties({knowledgeGraph:n,inclusionModeDefinition:this._originalInclusionList}),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.size||(this.dataManager.inclusionModeDefinition={generateAllSublayers:!1,namedTypeDefinitions:new Map},this.dataManager.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name,{useAllData:!0})})),this.dataManager.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.set(e.name,{useAllData:!0})}))),this.dataPreloadedInLocalCache){const e=S.A.getInstance();for(const[t,r]of this.dataManager.inclusionModeDefinition?.namedTypeDefinitions??[])for(const n of r.members?.values()??[]){const r=e.readFromStoreById(`${t}__${n.id}`);r&&(0,u.tE)(this.dataManager.sublayerCaches,t,(()=>new Map)).set(n.id,r)}await t()}else{const r="GEOGRAPHIC"===this.defaultLinkChartConfig?.layoutMode;this.addResolvingPromise(this.dataManager.refreshCacheContent(void 0,!1,r,!0).then((async()=>{(0,p.Te)(e),await t()})))}r(null)}))}))),Promise.resolve(this)}set inclusionModeDefinition(e){"loaded"!==this.loadStatus&&"failed"!==this.loadStatus?this._set("inclusionModeDefinition",e):l.A.getLogger(this).error("#inclusionModeDefinition","inclusionModeDefinition cannot be changed after the layer is loaded.")}async addRecords(e,t){let r=[];t?.cascadeAddRelationshipEndNodes&&this.dataManager.knowledgeGraph.dataModel&&(r=await(0,I.aq)(e,this.dataManager.knowledgeGraph));const n=e.concat(r).filter((e=>!this.sublayerIdsCache.get(e.typeName)?.has(e.id)));await this._handleNewRecords(n)}async removeRecords(e,{cascadeRemoveRelationships:t=!0,recalculateLayout:r=!1}={cascadeRemoveRelationships:!0,recalculateLayout:!1}){let n=[];for(const t of e)!1===this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(t.typeName)?.useAllData&&this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.get(t.typeName)?.members?.has(t.id)&&n.push(t);if(t){const e=new Set,t=[];for(const t of n)if(this.dataManager.nodeConnectionsLookup.has(t.id))for(const r of this.dataManager.nodeConnectionsLookup.get(t.id))e.add(r);for(const r of e)if(this.dataManager.memberIdTypeLookup.has(r))for(const e of this.dataManager.memberIdTypeLookup.get(r))this.dataManager.relationshipTypeNames.has(e)&&t.push({id:r,typeName:e});n=n.concat(t)}this.dataManager.removeFromLayer(n);for(const e of n)this.sublayerIdsCache.get(e.typeName)?.delete(e.id),this.dataManager.relationshipTypeNames.has(e.typeName)?this.relationshipLinkChartDiagramLookup.delete(e.id):this.entityLinkChartDiagramLookup.delete(e.id);r&&await this._calculateLayoutWithSublayerTimeInfo(this._currentLinkChartConfig.layoutMode,this._currentLinkChartConfig.layoutOptions);const i=[];return this.layers.forEach((e=>{i.push(e.refreshCachedQueryEngine())})),await Promise.all(i),this._refreshNamedTypes(),n}async expand(e,t){const r=await this.dataManager.getConnectedRecordIds(e,t),n=r.filter((e=>!this.sublayerIdsCache.get(e.typeName)?.has(e.id)));return await this._handleNewRecords(r),{records:n}}loadLayerAssumingLocalCache(){const e=[...this.memberRelationshipTypes,...this.memberEntityTypes];this.originIdOf("layers")===y.Gr.DEFAULTS?this._createSublayers(e,this.layers,(e=>!!e.geometryType)):this._updateSublayers(e,this.layers),this.originIdOf("tables")===y.Gr.DEFAULTS?this._createSublayers(e,this.tables,(e=>!e.geometryType)):this._updateSublayers(e,this.tables),this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{const r=(0,u.tE)(this.sublayerIdsCache,t,(()=>new Set));e.members?.forEach((({id:e,linkChartLocation:n})=>{if(r.add(e),n){const r=n instanceof v.A?n:(0,g.Ux)(n);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(e,r):this.entityLinkChartDiagramLookup.set(e,r)}}))}))}async calculateLinkChartLayout(e="RADIAL_TREE",t){const r=[],n=[],i=[];this.dataManager.sublayerCaches.forEach(((e,t)=>{this.dataManager.entityTypeNames.has(t)?e.forEach((e=>{r.push({typeName:t,feature:e})})):this.dataManager.relationshipTypeNames.has(t)&&e.forEach((e=>{n.push({typeName:t,feature:e})}))})),this.entityLinkChartDiagramLookup=new Map,this.relationshipLinkChartDiagramLookup=new Map;const s=new Map,o=new Map,u=new Map,c=new Map,p=new Uint8Array(r.length),d=new Float64Array(r.length),h=new Float64Array(r.length),f=new Float64Array(r.length),y=new Float64Array(r.length),m=new Uint32Array(n.length),v=new Uint32Array(n.length),b=new Float64Array(n.length),w=new Float64Array(n.length),S=[],I=new L.default({xmin:-1e-7,ymin:-1e-7,xmax:1e-7,ymax:1e-7});let M,T="FORCE_DIRECTED",x=0,E=0;const R=A.i6.apply;switch(T="GEOGRAPHIC"===e?"FORCE_DIRECTED":e,T){case"FORCE_DIRECTED":M=A.pM.apply;break;case"COMMUNITY":M=A.Tu.apply;break;case"HIERARCHICAL":M=A.$C.apply;break;case"RADIAL_TREE":M=A.vJ.apply;break;case"SMART_TREE":M=A.Xq.apply;break;default:M=A.Wg.apply}let O=!1;r.forEach((({typeName:r,feature:n})=>{if("CHRONOLOGICAL_SINGLE"!==e&&"CHRONOLOGICAL_MULTIPLE"!==e&&t?.lockedNodeLocations?.has(n.attributes[_.dr])){"GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(r)?p[x]=A.tx.IsGeographic:p[x]=A.tx.None;const i=t.lockedNodeLocations.get(n.attributes[_.dr]);d[x]=i.x,h[x]=i.y}else if("GEOGRAPHIC"===e&&this.dataManager.geographicLookup.has(r)){p[x]=A.tx.IsGeographic;let e=null;const t=n.attributes[this.dataManager.geographicLookup.get(r).name],i=this.dataManager.geographicLookup.get(r)?.geometryType;switch(i){case"esriGeometryPoint":d[x]=t?.x,h[x]=t?.y;break;case"esriGeometryPolygon":e=t?.centroid,null!=e?.x&&null!=e?.y?(d[x]=e.x,h[x]=e.y):p[x]=A.tx.IsMovable;break;case"esriGeometryPolyline":case"esriGeometryMultipoint":e=t?.extent?.center,null!=e?.x&&null!=e?.y?(d[x]=e.x,h[x]=e.y):p[x]=A.tx.IsMovable;break;default:p[x]=A.tx.IsMovable}(null==d[x]||null==h[x]||Number.isNaN(d[x])||Number.isNaN(h[x]))&&(p[x]=A.tx.IsMovable,d[x]=0,h[x]=0)}else if("CHRONOLOGICAL_SINGLE"===e||"CHRONOLOGICAL_MULTIPLE"===e){!O&&t?.lockedNodeLocations?.has(n.attributes[_.dr])&&(O=!0);const e=t?.timeInfoByTypeName?.get(r),i=e?.startField,s=i&&e?.startField?n.attributes[i]:null;f[x]=s?new Date(s).getTime():NaN;const o=e?.endField,a=o&&e?.endField?n.attributes[o]:null;y[x]=a?new Date(a).getTime():NaN,d[x]=0,h[x]=0,p[x]=A.tx.IsMovable}else p[x]=A.tx.IsMovable,d[x]=0,h[x]=0;c.set(n.attributes[_.dr],x),S[x]={feature:n,typeName:r},x++})),O&&l.A.getLogger(this).warn("Locked node locations are not supported for chronological layout at this time.  Requested node locations were ignored");let F=!1;const k=new Map;n.forEach((r=>{const n=r.feature.attributes[_.Cz],s=r.feature.attributes[_.KQ],o=c.get(n),a=c.get(s),l=t?.timeInfoByTypeName?.get(r.typeName),u=t?.timeInfoByTypeName?l?.startField:null,p=u?r.feature.attributes[u]:null,d=l?.endField,h=d?r.feature.attributes[d]:null;if(void 0!==o&&void 0!==a){let t=n+"-"+s;"CHRONOLOGICAL_SINGLE"!==e&&"CHRONOLOGICAL_MULTIPLE"!==e||(t=t+"-"+p+"-"+h);const l=k.get(t),u=l?.has(r.typeName);u||(m[E]=o,v[E]=a,"CHRONOLOGICAL_SINGLE"!==e&&"CHRONOLOGICAL_MULTIPLE"!==e||(b[E]=p?new Date(p).getTime():NaN,w[E]=h?new Date(h).getTime():NaN),void 0===l?k.set(t,new Map([[r.typeName,E]])):l.set(r.typeName,E),E++),i.push(r)}else F=!0,this.relationshipLinkChartDiagramLookup.set(n,null)})),F&&l.A.getLogger(this).warn("A relationship is a member of this layer that has either origin or destination entity nodes that are not members. The diagram geometry will be set to null");const D=this._validateLayoutSettings(e,t),P=this._convertLayoutSettingsToCalculationSettings(D);await(0,A.Hh)();let V=!1,Z=null;if("CHRONOLOGICAL_SINGLE"===e||"CHRONOLOGICAL_MULTIPLE"===e){let r;({success:V,links:Z,graphics:r}=R(p,d,h,f,y,m.subarray(0,E),v.subarray(0,E),b.subarray(0,E),w.subarray(0,E),"CHRONOLOGICAL_MULTIPLE"===e,t?.chronologicalLayoutSettings??{})),V&&(this.chronologicalAuxiliaryGraphics=r)}else({success:V,links:Z}=M(p,d,h,m.subarray(0,E),v.subarray(0,E),P.computationBudgetTime,P.idealEdgeLengthMultiplier,P.repulsionRadiusMultiplier));if(!V)throw new a.A("knowledge-graph:layout-failed","Attempting to arrange the records in the specified layout failed");for(let e=0;e<S.length;e++){if(h[e]>84.9999?h[e]=84.9999:h[e]<-84.9999&&(h[e]=-84.9999),d[e]>179.9999?d[e]=179.9999:d[e]<-179.9999&&(d[e]=-179.9999),S[e].feature.attributes[_.T1]=new C.default(d[e],h[e]),s.has(S[e].typeName)){const t=s.get(S[e].typeName);t?.set(S[e].feature.attributes[_.dr],S[e].feature)}else{const t=new Map;t.set(S[e].feature.attributes[_.dr],S[e].feature),s.set(S[e].typeName,t)}u.set(S[e].feature.attributes[_.dr],S[e].feature);const t=(0,g.Ux)(S[e].feature.attributes[_.T1]);this.entityLinkChartDiagramLookup.set(S[e].feature.attributes[_.dr],S[e].feature.attributes[_.T1]?t:null),S[e].feature.attributes[_.T1].x<I.xmin&&(I.xmin=S[e].feature.attributes[_.T1].x),S[e].feature.attributes[_.T1].x>I.xmax&&(I.xmax=S[e].feature.attributes[_.T1].x),S[e].feature.attributes[_.T1].y<I.ymin&&(I.ymin=S[e].feature.attributes[_.T1].y),S[e].feature.attributes[_.T1].y>I.ymax&&(I.ymax=S[e].feature.attributes[_.T1].y)}if(this.linkChartExtent.xmin=I.xmin,this.linkChartExtent.xmax=I.xmax,this.linkChartExtent.ymin=I.ymin,this.linkChartExtent.ymax=I.ymax,!Z)throw new a.A("knowledge-graph:layout-failed","Attempting to retrieve link geometry from diagram engine failed");const G=new Map,j=new Map,z=new Map,U=new Set;for(let r=0;r<i.length;r++){const n=[],s=i[r],a=s.feature.attributes[_.Cz],p=s.feature.attributes[_.KQ];let d=a+"-"+p;if("CHRONOLOGICAL_SINGLE"===e||"CHRONOLOGICAL_MULTIPLE"===e){const e=t?.timeInfoByTypeName?.get(s.typeName),r=t?.timeInfoByTypeName?e?.startField:null,n=r?s.feature.attributes[r]:null,i=e?.endField;d+="-"+n+"-"+(i?s.feature.attributes[i]:null)}const h=k.get(d).get(s.typeName),f=0===h?0:Z?.vertexEndIndex[h-1];if(!U.has(h)){if(U.add(h),Z.types[h]===A.J.Recursive){const e=[Z.vertices[2*f],Z.vertices[2*f+1]],t=[Z.vertices[2*(f+1)],Z.vertices[2*(f+1)+1]],r=[.5*(e[0]+t[0]),.5*(e[1]+t[1])],i=[r[0]-e[0],r[1]-e[1]],s=[r[0]+i[1],r[1]-i[0]],o=[r[0]-i[1],r[1]+i[0]];n.push(e),n.push(s),n.push(t),n.push(o),n.push(e)}else{if(Z.types[h]!==A.J.Regular){l.A.getLogger(this).warn("A relationship generated an unsupported link geometry type.  It will not be rendered");continue}for(let e=f;e<Z.vertexEndIndex[h];e++)n.push([Z.vertices[2*e],Z.vertices[2*e+1]])}if("CHRONOLOGICAL_SINGLE"!==e&&"CHRONOLOGICAL_MULTIPLE"!==e){const e=S[c.get(a)]?.feature.attributes[_.T1],t=S[c.get(p)]?.feature.attributes[_.T1];n[0][0]===e.x&&n[0][1]===e.y||(n[0]=[e.x,e.y]),n[n.length-1][0]===t.x&&n[n.length-1][1]===t.y||(n[n.length-1]=[t.x,t.y])}for(let e=1;e<n.length-1;e++)n[e][1]>85.5?n[e][1]=85.5:n[e][1]<-85.5&&(n[e][1]=-85.5),n[e][0]>179.9999?n[e][0]=179.9999:n[e][0]<-179.9999&&(n[e][0]=-179.9999);G.has(d)?G.get(d).push(n):G.set(d,[n])}const y=G.get(d);j.has(d)||(j.set(d,new Map),z.set(d,new Map));const m=j.get(d),v=z.get(d);m.has(s.typeName)||(m.set(s.typeName,y.shift()),v.set(s.typeName,0));const b=m.get(s.typeName);v.set(s.typeName,v.get(s.typeName)+1);const w=new N.A({paths:[b]});if(s.feature.attributes[_.T1]=w,o.has(s.typeName)){const e=o.get(s.typeName);e?.set(s.feature.attributes[_.dr],s.feature)}else{const e=new Map;e.set(s.feature.attributes[_.dr],s.feature),o.set(s.typeName,e)}u.set(s.feature.attributes[_.dr],s.feature);const I=(0,g.Ux)(s.feature.attributes[_.T1]);this.relationshipLinkChartDiagramLookup.set(s.feature.attributes[_.dr],s.feature.attributes[_.T1]?I:null)}for(const e of i)e.feature.attributes[_.M1]=z.get(e.feature.attributes[_.Cz]+"-"+e.feature.attributes[_.KQ])?.get(e.typeName)??null;return this._currentLinkChartConfig={layoutMode:e,layoutOptions:D},{nodes:s,links:o,idMap:u}}async applyNewLinkChartLayout(e="RADIAL_TREE",t){const r=[];await this._calculateLayoutWithSublayerTimeInfo(e,t),this.layers.forEach((e=>{r.push(e.refreshCachedQueryEngine())})),await Promise.all(r),this._refreshNamedTypes()}getCurrentNodeLocations(){const e=new Map;return this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach((t=>{t?.members?.forEach((t=>{const r=t.linkChartLocation;let n;const i=t.id;r&&(n="x"in r?{x:r.x,y:r.y}:{x:r.coords[0],y:r.coords[1]},e.set(i,new C.default({x:n.x,y:n.y})))}))})),e}async synchronizeInclusionListWithCache(){return new Promise((e=>{this.dataManager.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{if(e.useAllData=!1,e.members&&e.members.size>0){if(!this.dataManager.sublayerCaches.get(t))return;const r=new Set(Array.from(this.dataManager.sublayerCaches.get(t).keys()));Array.from(e.members.keys()).filter((e=>!r.has(e))).forEach((t=>{e.members?.delete(t)}))}})),e()}))}async refreshLinkChartCache(e){await this.dataManager.refreshCacheContent(e);const t=[];this.layers.forEach((e=>{t.push(e.refreshCachedQueryEngine())})),await Promise.all(t),this._refreshNamedTypes()}async connectBetweenEntities(e){let t=[];for(const e of this.dataManager.relationshipTypeNames){const r=this.sublayerIdsCache.get(e);r&&(t=t.concat(Array.from(r.keys())))}const r=await this.dataManager.getRelationshipsBetweenNodes(e,t);return await this._handleNewRecords(r),{records:r}}async connectFromEntities(e){let t=[];for(const e of this.dataManager.relationshipTypeNames){const r=this.sublayerIdsCache.get(e);r&&(t=t.concat(Array.from(r.keys())))}let r=[];for(const e of this.dataManager.entityTypeNames){const t=this.sublayerIdsCache.get(e);t&&(r=r.concat(Array.from(t)))}const n=await this.dataManager.getRelationshipsFromNodes(e,r,t);return await this._handleNewRecords(n),{records:n}}getCurrentLayout(){return this._currentLinkChartConfig.layoutMode}async _calculateLayoutWithSublayerTimeInfo(e="RADIAL_TREE",t){const r=new Map;this.layers.forEach((e=>{r.set(e.objectType.name,e.timeInfo)})),await this.calculateLinkChartLayout(e,{timeInfoByTypeName:r,...t})}async _handleNewRecords(e){const t=[];this.dataManager.addToLayer(e);for(const r of e)this.sublayerIdsCache.has(r.typeName)||(this.sublayerIdsCache.set(r.typeName,new Set),t.push(r.typeName)),this.sublayerIdsCache.get(r.typeName).add(r.id);for(const e of t){const t=this._graphTypeLookup.get(e);if(t){const r=this._createSublayer(t);"entity"===t.type?this.dataManager.entityTypeNames.add(e):this.dataManager.relationshipTypeNames.add(e),r.geometryType?this.layers.push(r):this.tables.push(r),this.dataManager.sublayerCaches.set(e,new Map)}}await(0,_.qN)(this,t),await this.dataManager.refreshCacheContent(e.map((e=>e.id)));const r=Object.assign({},this._currentLinkChartConfig.layoutOptions);r.lockedNodeLocations=new Map;for(const[e,t]of this.entityLinkChartDiagramLookup.entries())t&&r.lockedNodeLocations.set(e,new C.default(t.coords[0],t.coords[1]));await this.applyNewLinkChartLayout(this._currentLinkChartConfig.layoutMode,r)}_createSublayers(e,t,r){e.forEach((e=>{const n=this._createSublayer(e);r(n)&&t.push(n),this._updateSublayerCaches(e)}))}_updateSublayers(e,t){t.forEach((t=>{t.parentCompositeLayer=this;const r=e.find((e=>e.type===t.graphType&&e.name===t.graphTypeName));r&&(t.objectType=r,t.read({title:r.name},{origin:"service"}),this._updateSublayerCaches(r))}))}_updateSublayerCaches(e){const t=this.dataManager.sublayerCaches;t.has(e.name)||t.set(e.name,new Map)}async _initializeDiagram(){this.defaultLinkChartConfig?this.defaultLinkChartConfig.doNotRecalculateLayout?(this.dataManager.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e?.members?.forEach((e=>{const r=e.linkChartLocation;let n;const i=e.id;if(!r)return;n="x"in r?{x:r.x,y:r.y}:{x:r.coords[0],y:r.coords[1]};const s=(0,g.Ux)(n);this.dataManager.relationshipTypeNames.has(t)?this.relationshipLinkChartDiagramLookup.set(i,s):this.entityLinkChartDiagramLookup.set(i,s),this.linkChartExtent.xmin>n.x&&(this.linkChartExtent.xmin=n.x),this.linkChartExtent.xmax<n.x&&(this.linkChartExtent.xmax=n.x),this.linkChartExtent.ymin>n.y&&(this.linkChartExtent.ymin=n.y),this.linkChartExtent.ymax<n.y&&(this.linkChartExtent.ymax=n.y)}))})),this.memberRelationshipTypes.forEach((e=>{e.name&&this.dataManager.sublayerCaches.get(e.name)?.forEach((e=>{const t=this.relationshipLinkChartDiagramLookup.get(e.attributes[_.Cz]),r=this.relationshipLinkChartDiagramLookup.get(e.attributes[_.KQ]);if(t&&r){const n=(0,g.Ux)(new N.A({paths:[[[t.coords[0],t.coords[1]],[r.coords[0],r.coords[1]]]]}));this.relationshipLinkChartDiagramLookup.set(e.attributes[_.dr],n)}else this.relationshipLinkChartDiagramLookup.set(e.attributes[_.dr],null)}))}))):await this._calculateLayoutWithSublayerTimeInfo(this.defaultLinkChartConfig.layoutMode,{lockedNodeLocations:this.getCurrentNodeLocations(),...this.defaultLinkChartConfig.layoutOptions||{}}):await this._calculateLayoutWithSublayerTimeInfo("RADIAL_TREE",{lockedNodeLocations:this.getCurrentNodeLocations()})}_refreshNamedTypes(){for(const e of this.layers)e.emit("refresh",{dataChanged:!0});for(const e of this.tables)e.emit("refresh",{dataChanged:!0})}_validateLayoutSettings(e,t){const r=e=>"number"==typeof e&&!isNaN(e),i={organicLayoutSettings:{},chronologicalLayoutSettings:{}};if(!new Set(["FORCE_DIRECTED","COMMUNITY","GEOGRAPHIC","CHRONOLOGICAL_MULTIPLE","CHRONOLOGICAL_SINGLE"]).has(e)||!t)return i;t.organicLayoutSettings??={};const{computationBudgetTime:s,repulsionRadiusMultiplier:o,idealEdgeLength:a,idealEdgeLengthType:u}=t.organicLayoutSettings;if((e=>r(e)&&e>=1)(s)?i.organicLayoutSettings.computationBudgetTime=s:void 0!==s&&l.A.getLogger(this).warn("Invalid layout computationBudgetTime setting, will revert to default setting"),(e=>r(e)&&e>=1)(o)?i.organicLayoutSettings.repulsionRadiusMultiplier=o:void 0!==o&&l.A.getLogger(this).warn("Invalid layout repulsionRadiusMultiplier setting, will revert to default setting"),"GEOGRAPHIC"===e&&(void 0!==a||void 0!==u)&&((e=>Object.values(n).includes(e))(u)?i.organicLayoutSettings.idealEdgeLengthType=u:void 0!==u&&l.A.getLogger(this).warn('Invalid layout idealEdgeLengthType setting, will revert to "multiplier" setting'),(e=>r(e)&&e>=0)(a)?i.organicLayoutSettings.idealEdgeLength=a:void 0!==a&&l.A.getLogger(this).warn("Invalid layout idealEdgeLength setting, will revert to default setting")),("CHRONOLOGICAL_MULTIPLE"===e||"CHRONOLOGICAL_SINGLE"===e)&&t.chronologicalLayoutSettings){const e=t.chronologicalLayoutSettings;e.durationLineWidth&&e.durationLineWidth<0&&l.A.getLogger(this).warn("Invalid layout durationLineWidth setting, will revert to default setting")}return i}_convertLayoutSettingsToCalculationSettings(e){e.organicLayoutSettings??={};let t=e.organicLayoutSettings.idealEdgeLength;return e.organicLayoutSettings.idealEdgeLengthType===n.ABSOLUTE&&(void 0===t?t=-1:t*=-1),{computationBudgetTime:e.organicLayoutSettings.computationBudgetTime,repulsionRadiusMultiplier:e.organicLayoutSettings.repulsionRadiusMultiplier,idealEdgeLengthMultiplier:t}}_createSublayer(e){return new w.A({objectType:e,parentCompositeLayer:this,graphType:e.type})}_handleSublayersChange(e,t){t&&(t.forEach((e=>{e.parent=null})),this.removeHandles("sublayers-owner")),e&&(e.forEach((e=>{e.parent=this})),this.addHandles([e.on("after-add",(({item:e})=>{e.parent=this})),e.on("after-remove",(({item:e})=>{e.parent=null}))],"sublayers-owner"))}};(0,s._)([(0,h.MZ)()],R.prototype,"dataPreloadedInLocalCache",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"defaultLinkChartConfig",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"dataManager",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"inclusionModeDefinition",null),(0,s._)([(0,h.MZ)()],R.prototype,"knowledgeGraph",void 0),(0,s._)([(0,h.MZ)({type:o.A.ofType(w.A),json:{write:{ignoreOrigin:!0}}})],R.prototype,"layers",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"entityLinkChartDiagramLookup",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"relationshipLinkChartDiagramLookup",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"linkChartExtent",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"memberEntityTypes",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"memberRelationshipTypes",void 0),(0,s._)([(0,h.MZ)({type:["LinkChartLayer"]})],R.prototype,"operationalLayerType",void 0),(0,s._)([(0,h.MZ)()],R.prototype,"sublayerIdsCache",void 0),(0,s._)([(0,h.MZ)({type:o.A.ofType(w.A),json:{write:{ignoreOrigin:!0}}})],R.prototype,"tables",void 0),(0,s._)([(0,h.MZ)({json:{read:!1}})],R.prototype,"type",void 0),(0,s._)([(0,h.MZ)({json:{read:!1}})],R.prototype,"chronologicalAuxiliaryGraphics",void 0),R=(0,s._)([(0,f.$)("esri.layers.LinkChartLayer")],R);const O=R},65215:function(e,t,r){r.d(t,{N3:function(){return s},Om:function(){return i}});var n=r(76613);class i{constructor(e=null,t={},r,n){this.geometry=e,this.attributes=t,this.centroid=r,this.objectId=n,this.displayId=0,this.geohashX=0,this.geohashY=0}static fromJSON(e,t){const r=e.geometry?n.A.fromJSON(e.geometry):null,s=e.centroid?n.A.fromJSON(e.centroid):null,o=e.attributes[t];return new i(r,e.attributes,s,o)}weakClone(){const e=new i(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}clone(){const e=this.geometry?.clone(),t=new i(e,{...this.attributes},this.centroid?.clone(),this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}function s(e){return!!e.geometry?.coords?.length}},72887:function(e,t,r){r.d(t,{A:function(){return n}});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},76613:function(e,t,r){r.d(t,{A:function(){return n}});class n{constructor(e=[],t=[]){this.lengths=e??[],this.coords=t??[]}static fromJSON(e){return new n(e.lengths,e.coords)}static fromRect(e){const[t,r,i,s]=e,o=i-t,a=s-r;return new n([5],[t,r,o,0,0,a,-o,0,0,-a])}get isPoint(){return 0===this.lengths.length&&this.coords.length>=2}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let r=0;r<this.lengths.length;r++){const n=this.lengths[r];for(let r=0;r<n;r++)e(this.coords[2*(r+t)],this.coords[2*(r+t)+1]);t+=n}}deltaDecode(){const e=this.clone(),{coords:t,lengths:r}=e;let n=0;for(const e of r){for(let r=1;r<e;r++)t[2*(n+r)]+=t[2*(n+r)-2],t[2*(n+r)+1]+=t[2*(n+r)-1];n+=e}return e}clone(e){if(0===this.lengths.length)return new n([],[this.coords[0],this.coords[1]]);const t=2*(0===this.lengths.length?1:this.lengths.reduce(((e,t)=>e+t))),r=this.coords.slice(0,t);return e?(e.set(r),new n(this.lengths,e)):new n(Array.from(this.lengths),Array.from(r))}}},40302:function(e,t,r){function n(e,t){return e?t?4:3:t?3:2}function i(e,t,r,i){if(!t?.lengths.length)return null;e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0);const a=e.coords,l=[],u=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:c,coords:p}=t,d=n(r,i);let h=0;for(const e of c){const t=s(u,p,h,e,r,i);t&&l.push(t),h+=e*d}if(l.sort(((e,t)=>{let n=e[2]-t[2];return 0===n&&r&&(n=e[4]-t[4]),n})),l.length){let e=6*l[0][2];a[0]=l[0][0]/e,a[1]=l[0][1]/e,r&&(e=6*l[0][4],a[2]=0!==e?l[0][3]/e:0),(a[0]<u[0]||a[0]>u[1]||a[1]<u[2]||a[1]>u[3]||r&&(a[2]<u[4]||a[2]>u[5]))&&(a.length=0)}if(!a.length){const e=t.lengths[0]?o(p,0,c[0],r,i):null;if(!e)return null;a[0]=e[0],a[1]=e[1],r&&e.length>2&&(a[2]=e[2])}return e}function s(e,t,r,i,s,o){const a=n(s,o);let l=r,u=r+a,c=0,p=0,d=0,h=0,f=0;for(let r=0,n=i-1;r<n;r++,l+=a,u+=a){const r=t[l],n=t[l+1],i=t[l+2],o=t[u],a=t[u+1],y=t[u+2];let m=r*a-o*n;h+=m,c+=(r+o)*m,p+=(n+a)*m,s&&(m=r*y-o*i,d+=(i+y)*m,f+=m),r<e[0]&&(e[0]=r),r>e[1]&&(e[1]=r),n<e[2]&&(e[2]=n),n>e[3]&&(e[3]=n),s&&(i<e[4]&&(e[4]=i),i>e[5]&&(e[5]=i))}if(h>0&&(h*=-1),f>0&&(f*=-1),!h)return null;const y=[c,p,.5*h];return s&&(y[3]=d,y[4]=.5*f),y}function o(e,t,r,i,s){const o=n(i,s);let p=t,d=t+o,h=0,f=0,y=0,m=0;for(let t=0,n=r-1;t<n;t++,p+=o,d+=o){const t=e[p],r=e[p+1],n=e[p+2],s=e[d],o=e[d+1],g=e[d+2],v=i?l(t,r,n,s,o,g):a(t,r,s,o);if(v)if(h+=v,i){const e=c(t,r,n,s,o,g);f+=v*e[0],y+=v*e[1],m+=v*e[2]}else{const e=u(t,r,s,o);f+=v*e[0],y+=v*e[1]}}return h>0?i?[f/h,y/h,m/h]:[f/h,y/h]:r>0?i?[e[t],e[t+1],e[t+2]]:[e[t],e[t+1]]:null}function a(e,t,r,n){const i=r-e,s=n-t;return Math.sqrt(i*i+s*s)}function l(e,t,r,n,i,s){const o=n-e,a=i-t,l=s-r;return Math.sqrt(o*o+a*a+l*l)}function u(e,t,r,n){return[e+.5*(r-e),t+.5*(n-t)]}function c(e,t,r,n,i,s){return[e+.5*(n-e),t+.5*(i-t),r+.5*(s-r)]}r.d(t,{Q:function(){return i}})},75623:function(e,t,r){r.d(t,{F:function(){return a}});var n=r(58941),i=r(50612),s=r(87416);const o={minX:0,minY:0,maxX:0,maxY:0};class a{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new i.w(9,(0,n.A)("esri-csp-restrictions")?e=>({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const e=new Array(this._idByBounds.size);let t=0;this._idByBounds.forEach(((r,n)=>{e[t++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(e)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((e=>this._idByBounds.has(e)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const e=(0,s.Ie)();for(const t of this._boundsById.values())t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]));return e}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(e){const t=this._boundsById.get(e);this._boundsById.delete(e),t&&(this._idByBounds.delete(t),this._indexInvalid||this._index.remove(t))}forEachInBounds(e,t){this._loadIndex(),function(e,t,r){(function(e){o.minX=e[0],o.minY=e[1],o.maxX=e[2],o.maxY=e[3]})(t),e.search(o,r)}(this._index,e,(e=>t(this._idByBounds.get(e))))}get(e){return this._boundsById.get(e)}has(e){return this._boundsById.has(e)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(e,t){if(!this._indexInvalid){const t=this._boundsById.get(e);t&&(this._index.remove(t),this._idByBounds.delete(t))}this._boundsById.set(e,t),t&&(this._idByBounds.set(t,e),this._indexInvalid||(this._boundsToLoad.push(t),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},34794:function(e,t,r){r.d(t,{A:function(){return f}});var n=r(50659),i=r(39819),s=r(48996),o=r(40633),a=r(24761),l=r(87416),u=r(58081),c=r(75623),p=r(78956),d=r(46805);const h=(0,a.vt)();class f{constructor(e){this.geometryInfo=e,this._boundsStore=new c.F,this._featuresById=new Map,this.events=new s.A,this.featureAdapter=d.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,r,n,i]=this.fullBounds;return{xmin:t,ymin:r,xmax:n,ymax:i,spatialReference:(0,p.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(n.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const r of e){const e=this._boundsStore.get(r.objectId);e&&t((0,a.Jt)(h,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const r=this._featuresById.get(t);let n;if(r?(e.displayId=r.displayId,n=this._boundsStore.get(t),this._boundsStore.delete(t)):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);n=(0,u.jQ)(null!=n?n:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=n&&this._boundsStore.set(t,n),this._featuresById.set(t,e)}_upsert(e){const t=e?.objectId;if(null==t)return o.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const r=this._featuresById.get(t);if(!r)return this._add(e),e;const{geometry:n,attributes:s}=e;for(const e in s)r.attributes[e]=s[e];return n&&(r.geometry=n,this._boundsStore.set(t,(0,u.jQ)((0,l.vt)(),n,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),r}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._boundsStore.delete(t),this._featuresById.delete(t),e}}},75707:function(e,t,r){r.d(t,{d:function(){return ue}});var n=r(50659),i=r(39819),s=r(30905),o=r(21609),a=r(95929),l=r(60539),u=r(62938),c=r(46157),p=r(24761),d=r(87416),h=r(35068),f=r(74697),y=r(65298),m=r(57652),g=r(58081),v=r(99680),b=r(16177),w=r(55644);const _=new class{constructor(e,t){this._cache=new v.q(e),this._invalidCache=new v.q(t)}get(e,t){const r=`${t.uid}:${e}`,n=this._cache.get(r);if(n)return n;if(null!=this._invalidCache.get(r))return null;try{const n=b.WhereClause.create(e,{fieldsIndex:t});return this._cache.put(r,n),n}catch(e){return this._invalidCache.put(r,e),null}}getError(e,t){const r=`${t.uid}:${e}`;return this._invalidCache.get(r)??null}}(50,500),S="unsupported-query",I=" as ",M=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"]),T=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),x=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...M,...T]);function A(e,t,r={}){const n=L(t,e);if(!n){const r=_.getError(t,e);throw new i.A(S,"invalid SQL expression",{expression:t,error:r})}const s=r.expressionName||"expression";if(r.validateStandardized&&!n.isStandardized)throw new i.A(S,`${s} is not standard`,{expression:t});if(r.validateAggregate&&!n.isAggregate)throw new i.A(S,`${s} does not contain a valid aggregate function`,{expression:t});return n.fieldNames}function E(e,t,r,n,s){if(!r)return!0;const o="having clause",a=A(e,r,{validateAggregate:!0,expressionName:o});R(e,t,a,{expressionName:o,query:s});const l=L(r,e),u=l?.getExpressions().every((t=>{const{aggregateType:r,field:i}=t,s=e.get(i)?.name;return n.some((t=>{const{onStatisticField:n,statisticType:i}=t,o=e.get(n)?.name;return o===s&&i.toLowerCase().trim()===r}))}));if(!u)throw new i.A(S,"expressions in having clause should also exist in outStatistics",{having:r});return!0}function L(e,t){return e?_.get(e,t):null}function C(e){return/\((.*?)\)/.test(e)?e:e.split(I)[0]}function N(e){return e.split(I)[1]}function R(e,t,r,n={}){const s=new Map;if(function(e,t,r,n,i){const s=i.includes("*")?[...r,...i.filter((e=>"*"!==e))]:i;for(const i of s)if(t.get(i))O(e,t,r,n,i);else try{const s=A(t,C(i),{validateStandardized:!0});for(const i of s)O(e,t,r,n,i)}catch(t){e.set(i,{type:"expression-error",expression:i,error:t})}}(s,e,t,n.allowedFieldTypes??x,r),s.size){const e=n.expressionName??"expression";throw new i.A(S,`${e} contains invalid or missing fields`,{errors:Array.from(s.values()),query:n.query})}}function O(e,t,r,n,i){const s=t.get(i);s?r.has(s.name)?"all"!==n&&!1===n?.has(s.type)&&e.set(i,{type:"invalid-type",fieldName:s.name,fieldType:w.m.fromJSON(s.type),allowedFieldTypes:Array.from(n,(e=>w.m.fromJSON(e)))}):e.set(i,{type:"missing-field",fieldName:s.name}):e.set(i,{type:"invalid-field",fieldName:i})}var F=r(78956),k=r(74841);class D{constructor(){this._storage=new Map,this._purgeInterval=5,this._sweep=()=>{if(this._timer=void 0,!this._storage)return;const e=1e3*this._purgeInterval,t=performance.now()-e;for(const[r,n]of this._storage){if(!(n.time<t))return void(this._storage.size>0&&(this._timer=setTimeout(this._sweep,e)));this._storage.delete(r)}}}destroy(){this._storage?.clear(),this._storage=null,clearTimeout(this._timer)}get size(){return this._storage?.size??0}put(e,t){this._storage?.set(e,new V(t)),this._scheduleSweep()}get(e){if(!this._storage)return;const t=this._storage?.get(e);return t?(this._storage?.delete(e),t.time=performance.now(),this._storage?.set(e,t),t.items):void 0}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??=setTimeout(this._sweep,1e3*this._purgeInterval))}}let P=0;class V{constructor(e){this.items=e,this.time=performance.now(),this.id=P++}}var Z=r(7121),G=r(72228),j=r(38503),z=r(87280),U=r(53743),q=r(92586),B=r(66164),$=r(54547);class H{constructor(e,t,r){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=e.returnDistinctValues??!1,this.fieldsIndex=r,this.featureAdapter=t;const n=e.outFields;if(n&&!n.includes("*")){this.outFields=n;let e=0;for(const t of n){const n=C(t),i=this.fieldsIndex.get(n),s=i?null:L(n,r),o=i?i.name:N(t)||"FIELD_EXP_"+e++;this._fieldDataCache.set(t,{alias:o,clause:s})}}}countDistinctValues(e){return this.returnDistinctValues?(e.forEach((e=>this.getAttributes(e))),this._returnDistinctMap.size):e.length}getAttributes(e){const t=this._processAttributesForOutFields(e);return this._processAttributesForDistinctValues(t)}getFieldValue(e,t,r){const n=r?r.name:t;let i=null;return this._fieldDataCache.has(n)?i=this._fieldDataCache.get(n)?.clause:r||(i=L(t,this.fieldsIndex),this._fieldDataCache.set(n,{alias:n,clause:i})),r?this.featureAdapter.getAttribute(e,n):i?.calculateValue(e,this.featureAdapter)}getDataValues(e,t,r=!0){const n=t.normalizationType,i=t.normalizationTotal,s=this.fieldsIndex.get(t.field),o=(0,U.zD)(s)||(0,U.Ah)(s),a=(0,U.OH)(s);return e.map((e=>{let s=t.field&&this.getFieldValue(e,t.field,this.fieldsIndex.get(t.field));if(t.field2?(s=`${(0,B.gJ)(s)}${t.fieldDelimiter}${(0,B.gJ)(this.getFieldValue(e,t.field2,this.fieldsIndex.get(t.field2)))}`,t.field3&&(s=`${s}${t.fieldDelimiter}${(0,B.gJ)(this.getFieldValue(e,t.field3,this.fieldsIndex.get(t.field3)))}`)):"string"==typeof s&&r&&(o?s=s?new Date(s).getTime():null:a&&(s=s?(0,q.rb)(s):null)),n&&Number.isFinite(s)){const r="field"===n&&t.normalizationField?this.getFieldValue(e,t.normalizationField,this.fieldsIndex.get(t.normalizationField)):null;s=(0,B.zS)(s,n,r,i)}return s}))}async getExpressionValues(e,t,r,n,i){const{arcadeUtils:s}=await(0,$.lw)(),o=s.hasGeometryOperations(t);o&&await s.enableGeometryOperations();const a=s.createFunction(t),l=s.getViewInfo(r),u={fields:this.fieldsIndex.fields};return e.map((e=>{const t={attributes:this.featureAdapter.getAttributes(e),layer:u,geometry:o?{...(0,F.pL)(n.geometryType,n.hasZ,n.hasM,this.featureAdapter.getGeometry(e)),spatialReference:r?.spatialReference}:null},c=s.createExecContext(t,l,i);return s.executeFunction(a,c)}))}validateItem(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:L(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testFeature(e,this.featureAdapter)??!1}validateItems(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:L(t,this.fieldsIndex)}),this._fieldDataCache.get(t)?.clause?.testSet(e,this.featureAdapter)??!1}_processAttributesForOutFields(e){const t=this.outFields;if(!t?.length)return this.featureAdapter.getAttributes(e);const r={};for(const n of t){const{alias:t,clause:i}=this._fieldDataCache.get(n);r[t]=i?i.calculateValue(e,this.featureAdapter):this.featureAdapter.getAttribute(e,t)}return r}_processAttributesForDistinctValues(e){if(null==e||!this.returnDistinctValues)return e;const t=this.outFields,r=[];if(t)for(const n of t){const{alias:t}=this._fieldDataCache.get(n);r.push(e[t])}else for(const t in e)r.push(e[t]);const n=`${(t||["*"]).join(",")}=${r.join(",")}`;let i=this._returnDistinctMap.get(n)||0;return this._returnDistinctMap.set(n,++i),i>1?null:e}}var J=r(51376);class W{constructor(e,t,r){this.items=e,this.query=t,this.geometryType=r.geometryType,this.hasM=r.hasM,this.hasZ=r.hasZ,this.fieldsIndex=r.fieldsIndex,this.objectIdField=r.objectIdField,this.spatialReference=r.spatialReference,this.featureAdapter=r.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new H(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:r,outStatistics:n}=this.query,i=t?.length;if(!i)return 1;const s=new Map,o=new Map,a=new Set;for(const i of n){const{statisticType:n}=i,l="exceedslimit"!==n?i.onStatisticField:void 0;if(!o.has(l)){const r=[];for(const n of t){const t=this._getAttributeValues(e,n,s);r.push(t)}o.set(l,this._calculateUniqueValues(r,e.returnDistinctValues))}const u=o.get(l);for(const t in u){const{data:n,items:i}=u[t],s=n.join(",");r&&!e.validateItems(i,r)||a.add(s)}}return a.size}async createQueryResponse(){let e;if(e=this.query.outStatistics?this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query):this._createFeatureQueryResponse(this.query),this.query.returnQueryGeometry){const t=this.query.geometry;(0,m.fn)(this.query.outSR)&&!(0,m.aI)(t.spatialReference,this.query.outSR)?e.queryGeometry=(0,F.ag)({spatialReference:this.query.outSR,...(0,k.Cv)(t,t.spatialReference,this.query.outSR)}):e.queryGeometry=(0,F.ag)({spatialReference:this.query.outSR,...t})}return e}createSnappingResponse(e,t){const r=this.featureAdapter,n=Q(this.hasZ,this.hasM),{point:i,mode:s}=e,o="number"==typeof e.distance?e.distance:e.distance.x,a="number"==typeof e.distance?e.distance:e.distance.y,l={candidates:[]},u="esriGeometryPolygon"===this.geometryType,c=this._getPointCreator(s,this.spatialReference,t),p=new K(null,0),d=new K(null,0),h={x:0,y:0,z:0};for(const t of this.items){const s=r.getGeometry(t);if(null==s)continue;const{coords:f,lengths:y}=s;if(p.coords=f,d.coords=f,e.returnEdge){let e=0;for(let s=0;s<y.length;s++){const u=y[s];for(let s=0;s<u;s++,e+=n){const f=p;if(f.coordsIndex=e,s!==u-1){const s=d;s.coordsIndex=e+n;const u=h;Y(h,i,f,s);const p=(i.x-u.x)/o,y=(i.y-u.y)/a,m=p*p+y*y;m<=1&&l.candidates.push((0,J.P)(r.getObjectId(t),c(u),Math.sqrt(m),c(f),c(s)))}}}}if("none"!==e.vertexMode){const s=u?f.length-n:f.length;if("all"===e.vertexMode)for(let e=0;e<s;e+=n){const n=p;n.coordsIndex=e;const s=(i.x-n.x)/o,u=(i.y-n.y)/a,d=s*s+u*u;d<=1&&l.candidates.push((0,J.k)(r.getObjectId(t),c(n),Math.sqrt(d)))}else if("ends"===e.vertexMode){const e=[0];u||e.push(f.length-n);for(const n of e){const e=p;e.coordsIndex=n;const s=(i.x-e.x)/o,u=(i.y-e.y)/a,d=s*s+u*u;d<=1&&l.candidates.push((0,J.k)(r.getObjectId(t),c(e),Math.sqrt(d)))}}}}return l.candidates.sort(((e,t)=>e.distance-t.distance)),l}_getPointCreator(e,t,r){const n=null==r||(0,m.aI)(t,r)?e=>e:e=>(0,k.Cv)(e,t,r),{hasZ:i}=this;return"3d"===e?i?({x:e,y:t,z:r})=>n({x:e,y:t,z:r}):({x:e,y:t})=>n({x:e,y:t,z:0}):({x:e,y:t})=>n({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,minValue:o,maxValue:a,scale:l,timeZone:u,outStatisticTypes:c}=e,p=this.fieldsIndex.get(t),d=(0,U.vE)(p)||(0,U.zD)(p)||(0,U.Ah)(p),h=await this._getDataValues({field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,scale:l,timeZone:u}),f=(0,B.Vb)({normalizationType:i,normalizationField:n,minValue:o,maxValue:a}),y={value:.5,fieldType:p?.type},m=(0,U.yM)(p)?(0,B.z9)({values:h,supportsNullCount:f,percentileParams:y,outStatisticTypes:c}):(0,B.G_)({values:h,minValue:o,maxValue:a,useSampleStdDev:!i,supportsNullCount:f,percentileParams:y,outStatisticTypes:c});return(0,B.oZ)(m,c,d)}async createUniqueValuesResponse(e){const{field:t,valueExpression:r,domains:n,returnAllCodedValues:i,scale:s,timeZone:o}=e,a=await this._getDataValues({field:t,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:r,scale:s,timeZone:o},!1),l=(0,B.b3)(a);return(0,B.lv)(l,n,i,e.fieldDelimiter)}async createClassBreaksResponse(e){const{field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numClasses:c,scale:p,timeZone:d}=e,h=await this._getDataValues({field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,scale:p,timeZone:d}),f=(0,B.Rw)(h,{field:t,normalizationField:n,normalizationType:i,normalizationTotal:s,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numClasses:c});return(0,B.jM)(f,o)}async createHistogramResponse(e){const{field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numBins:c,scale:p,timeZone:d}=e,h=await this._getDataValues({field:t,valueExpression:r,normalizationField:n,normalizationType:i,normalizationTotal:s,scale:p,timeZone:d});return(0,B.$y)(h,{field:t,normalizationField:n,normalizationType:i,normalizationTotal:s,classificationMethod:o,standardDeviationInterval:a,minValue:l,maxValue:u,numBins:c})}_sortFeatures(e,t,r){if(e.length>1&&t?.length)for(const n of t.reverse()){const t=n.split(" "),i=t[0],s=this.fieldsIndex.get(i),o=!!t[1]&&"desc"===t[1].toLowerCase(),a=(0,B.FM)(s?.type,o);e.sort(((e,t)=>{const n=r(e,i,s),o=r(t,i,s);return a(n,o)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:r,hasM:n,hasZ:i,objectIdField:s,spatialReference:o}=this,{outFields:a,outSR:l,quantizationParameters:u,resultRecordCount:c,resultOffset:p,returnZ:d,returnM:h}=e,f=null!=c&&t.length>(p||0)+c,y=a&&(a.includes("*")?[...this.fieldsIndex.fields]:a.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:f,features:this._createFeatures(e,t),fields:y,geometryType:r,hasM:n&&h,hasZ:i&&d,objectIdFieldName:s,spatialReference:(0,F.ag)(l||o),transform:u&&(0,z.VV)(u)||null}}_createFeatures(e,t){const r=new H(e,this.featureAdapter,this.fieldsIndex),{hasM:n,hasZ:i}=this,{orderByFields:s,quantizationParameters:o,returnGeometry:a,returnCentroid:l,maxAllowableOffset:u,resultOffset:c,resultRecordCount:p,returnZ:d=!1,returnM:h=!1}=e,f=i&&d,y=n&&h;let m=[],g=0;const v=[...t];if(this._sortFeatures(v,s,((e,t,n)=>r.getFieldValue(e,t,n))),this.geometryType&&(a||l)){const e=(0,z.VV)(o)??void 0,t="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(a&&!l)for(const n of v){const i=this.featureAdapter.getGeometry(n),s={attributes:r.getAttributes(n),geometry:(0,F.pL)(this.geometryType,this.hasZ,this.hasM,i,u,e,f,y)};t&&i&&!s.geometry&&(s.centroid=(0,F.LQ)(this,this.featureAdapter.getCentroid(n,this),e)),m[g++]=s}else if(!a&&l)for(const t of v)m[g++]={attributes:r.getAttributes(t),centroid:(0,F.LQ)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of v)m[g++]={attributes:r.getAttributes(t),centroid:(0,F.LQ)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,F.pL)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),u,e,f,y)}}else for(const e of v){const t=r.getAttributes(e);t&&(m[g++]={attributes:t})}const b=c||0;if(null!=p){const e=b+p;m=m.slice(b,Math.min(m.length,e))}return m}_createExceedsLimitQueryResponse(e){let t=!1,r=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const t of e.outStatistics??[])if("exceedslimit"===t.statisticType){r=null!=t.maxPointCount?t.maxPointCount:Number.POSITIVE_INFINITY,n=null!=t.maxRecordCount?t.maxRecordCount:Number.POSITIVE_INFINITY,i=null!=t.maxVertexCount?t.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>r;else if(this.items.length>n)t=!0;else{const e=Q(this.hasZ,this.hasM),r=this.featureAdapter;t=this.items.reduce(((e,t)=>{const n=r.getGeometry(t);return e+(null!=n&&n.coords.length||0)}),0)/e>i}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},r=[],n=new Map,i=new Map,s=new Map,o=new Map,a=new H(e,this.featureAdapter,this.fieldsIndex),l=e.outStatistics,{groupByFieldsForStatistics:u,having:c,orderByFields:p,resultRecordCount:d}=e,h=u?.length,f=!!h,y=f?u[0]:null,m=f&&!this.fieldsIndex.get(y);for(const e of l??[]){const{outStatisticFieldName:l,statisticType:p}=e,d=e,g="exceedslimit"!==p?e.onStatisticField:void 0,v="percentile_disc"===p||"percentile_cont"===p,b="EnvelopeAggregate"===p||"CentroidAggregate"===p||"ConvexHullAggregate"===p,w=f&&1===h&&(g===y||m)&&"count"===p;if(f){if(!s.has(g)){const e=[];for(const t of u){const r=this._getAttributeValues(a,t,n);e.push(r)}s.set(g,this._calculateUniqueValues(e,!b&&a.returnDistinctValues))}const e=s.get(g);if(!e)continue;const t=Object.keys(e);for(const r of t){const{count:t,data:i,items:s,itemPositions:p}=e[r],h=i.join(",");if(!c||a.validateItems(s,c)){const e=o.get(h)||{attributes:{}};if(b){e.aggregateGeometries||(e.aggregateGeometries={});const{aggregateGeometries:t,outStatisticFieldName:r}=await this._getAggregateGeometry(d,s);e.aggregateGeometries[r]=t}else{let r=null;if(w)r=t;else{const e=this._getAttributeValues(a,g,n),t=p.map((t=>e[t]));r=v&&"statisticParameters"in d?this._getPercentileValue(d,t):this._getStatisticValue(d,t,null,a.returnDistinctValues)}e.attributes[l]=r}let r=0;u.forEach(((t,n)=>e.attributes[this.fieldsIndex.get(t)?t:"EXPR_"+ ++r]=i[n])),o.set(h,e)}}}else if(b){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:r}=await this._getAggregateGeometry(d,this.items);t.aggregateGeometries[r]=e}else{const e=this._getAttributeValues(a,g,n);t.attributes[l]=v&&"statisticParameters"in d?this._getPercentileValue(d,e):this._getStatisticValue(d,e,i,a.returnDistinctValues)}const _="min"!==p&&"max"!==p||!(0,U.yM)(this.fieldsIndex.get(g))&&!this._isAnyDateField(g)?null:this.fieldsIndex.get(g)?.type;r.push({name:l,alias:l,type:_||"esriFieldTypeDouble"})}const g=f?Array.from(o.values()):[t];return this._sortFeatures(g,p,((e,t)=>e.attributes[t])),d&&(g.length=Math.min(d,g.length)),{fields:r,features:g}}_isAnyDateField(e){const t=this.fieldsIndex.get(e);return(0,U.vE)(t)||(0,U.zD)(t)||(0,U.Ah)(t)||(0,U.OH)(t)}async _getAggregateGeometry(e,t){const{convexHull:n,union:i}=await r.e(4696).then(r.bind(r,28356)),{statisticType:s,outStatisticFieldName:o}=e,{featureAdapter:a,spatialReference:l,geometryType:u,hasZ:c,hasM:p}=this,d=t.map((e=>(0,F.pL)(u,c,p,a.getGeometry(e)))),h=n(l,d,!0)[0],f={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===s){const e=h?(0,j.v)(h):(0,j.HA)(i(l,d));f.aggregateGeometries={...e,spatialReference:l},f.outStatisticFieldName=o||"extent"}else if("CentroidAggregate"===s){const e=h?(0,G.l8)(h):(0,G.Z4)((0,j.HA)(i(l,d)));f.aggregateGeometries={x:e[0],y:e[1],spatialReference:l},f.outStatisticFieldName=o||"centroid"}else"ConvexHullAggregate"===s&&(f.aggregateGeometries=h,f.outStatisticFieldName=o||"convexHull");return f}_getStatisticValue(e,t,r,n){const{onStatisticField:i,statisticType:s}=e;let o=null;return o=r?.has(i)?r.get(i):(0,U.yM)(this.fieldsIndex.get(i))||this._isAnyDateField(i)?(0,B.z9)({values:t,returnDistinct:n}):(0,B.G_)({values:n?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),r&&r.set(i,o),o["var"===s?"variance":s]}_getPercentileValue(e,t){const{onStatisticField:r,statisticParameters:n,statisticType:i}=e,{value:s,orderBy:o}=n,a=this.fieldsIndex.get(r);return(0,B.qg)(t,{value:s,orderBy:o,fieldType:a?.type,isDiscrete:"percentile_disc"===i})}_getAttributeValues(e,t,r){if(r.has(t))return r.get(t);const n=this.fieldsIndex.get(t),i=this.items.map((r=>e.getFieldValue(r,t,n)));return r.set(t,i),i}_calculateUniqueValues(e,t){const r={},n=this.items,i=n.length;for(let s=0;s<i;s++){const i=n[s],o=[];for(const t of e)o.push(t[s]);const a=o.join(",");null==r[a]?r[a]={count:1,data:o,items:[i],itemPositions:[s]}:(t||r[a].count++,r[a].items.push(i),r[a].itemPositions.push(s))}return r}async _getDataValues(e,t=!0){const r=new H(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:n,scale:i,timeZone:s}=e;return n?r.getExpressionValues(this.items,n,{viewingMode:"map",scale:i,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},s):r.getDataValues(this.items,(0,o.o8)(e),t)}}function Y(e,t,r,n){const i=n.x-r.x,s=n.y-r.y,o=i*i+s*s,a=(t.x-r.x)*i+(t.y-r.y)*s,l=Math.min(1,Math.max(0,a/o));e.x=r.x+i*l,e.y=r.y+s*l}function Q(e,t){return e?t?4:3:t?3:2}class K{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}var X=r(20932),ee=r(62512);const te="unsupported-query";async function re(e,{fieldsIndex:t,geometryType:r,spatialReference:n,availableFields:s}){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption&&"xyFootprint"!==e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i.A(te,"Unsupported query options",{query:e});return ne(t,s,e),function(e,t,r){const{outStatistics:n,groupByFieldsForStatistics:s,having:o}=r,a=s?.length,l=n?.length;if(o){if(!a||!l)throw new i.A(te,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});E(e,t,o,n,r)}if(l){if(null==(u=n)||!u.every((e=>"exceedslimit"!==e.statisticType)))return;const o=n.map((e=>e.onStatisticField)).filter(Boolean);R(e,t,o,{expressionName:"onStatisticFields",query:r}),a&&R(e,t,s,{expressionName:"groupByFieldsForStatistics",query:r});for(const s of n){const{onStatisticField:n,statisticType:o}=s;if("percentile_disc"!==o&&"percentile_cont"!==o||!("statisticParameters"in s))e.get(n)&&"count"!==o&&"min"!==o&&"max"!==o&&R(e,t,[n],{expressionName:`outStatistics with '${o}' statistic type`,allowedFieldTypes:ie,query:r});else{const{statisticParameters:e}=s;if(!e)throw new i.A(te,"statisticParameters should be set for percentile type",{definition:s,query:r})}}}var u}(t,s,e),Promise.all([(0,ee.c0)(e,r,n),(0,k.Nk)(n,e.outSR)]).then((()=>e))}function ne(e,t,r){const{outFields:n,orderByFields:s,returnDistinctValues:o,outStatistics:a}=r,l=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(s&&s.length>0){const n=" asc",i=" desc",o=s.map((e=>{const t=e.toLowerCase();return t.includes(n)?t.split(n)[0]:t.includes(i)?t.split(i)[0]:e})).filter((e=>!l.includes(e)));R(e,t,o,{expressionName:"orderByFields",query:r})}if(n&&n.length>0)R(e,t,n,{expressionName:"outFields",query:r,allowedFieldTypes:"all"});else if(o)throw new i.A(te,"outFields should be specified for returnDistinctValues",{query:r});!function(e,t,r,n){if(!r)return!0;const i="where clause";R(e,t,A(e,r,{validateStandardized:!0,expressionName:i}),{expressionName:i,query:n})}(e,t,r.where,r)}const ie=new Set([...M,...T]);async function se(e,t,r,n){let s=[];if(r.valueExpression){const{arcadeUtils:e}=await(0,$.lw)();s=e.extractFieldNames(r.valueExpression)}if(r.field&&s.push(r.field),r.field2&&s.push(r.field2),r.field3&&s.push(r.field3),r.normalizationField&&s.push(r.normalizationField),!s.length&&!r.valueExpression)throw new i.A(te,"field or valueExpression is required",{params:r});R(e,t,s,{expressionName:"statistics",query:n})}var oe=r(20973),ae=r(7103),le=r(48961);class ue{constructor(e){this._cache=new D,this._changeHandle=null,this.capabilities={query:Z.F},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(()=>this.clearCache())),this.timeInfo=e.timeInfo,this.fieldsIndex=(0,s.Wj)(e.fieldsIndex)?e.fieldsIndex:ae.A.fromJSON(e.fieldsIndex),!e.availableFields||1===e.availableFields.length&&"*"===e.availableFields[0]?this.availableFields=new Set(this.fieldsIndex.fields.map((e=>e.name))):this.availableFields=new Set(e.availableFields.map((e=>this.fieldsIndex.get(e)?.name)).filter((e=>null!=e))),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,a.xt)(this._frameTask),this.clearCache(),(0,a.pR)(this._cache),this._changeHandle=(0,a.xt)(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._cache.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null,this._fullExtentPromise=null}async executeQuery(e,t){const r=(0,l.Mq)(t);try{const t=await this._executeQuery(e,{},r);return await t.createQueryResponse()}catch(t){if(t!==X.v8)throw t;return new W([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){const r=(0,l.Mq)(t);try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},r)).createQueryResponseForCount()}catch(e){if(e!==X.v8)throw e;return 0}}async executeQueryForExtent(e,t){const r=(0,l.Mq)(t),n=e.outSR;try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),i=t.size;return i?{count:i,extent:await this._getBounds(t.items,t.spatialReference,n||this.spatialReference)}:{count:0,extent:null}}catch(e){if(e===X.v8)return{count:0,extent:null};throw e}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){const r=(0,l.Mq)(t);try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},r),n=t.items,i=new Set;return await this._reschedule((()=>{for(const e of n)i.add(t.featureAdapter.getObjectId(e))}),r),i}catch(e){if(e===X.v8)return new Set;throw e}}async executeQueryForSnapping(e,t){const r=(0,l.Mq)(t),{point:n,distance:i,returnEdge:s,vertexMode:a}=e;if(!s&&"none"===a)return{candidates:[]};let u=(0,o.o8)(e.query);u=await this._schedule((()=>(0,X.T2)(u,this.definitionExpression,this.spatialReference)),r),u=await this._reschedule((()=>re(u,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),r);const c=!(0,m.aI)(n.spatialReference,this.spatialReference);c&&await(0,k.Nk)(n.spatialReference,this.spatialReference);const p="number"==typeof i?i:i.x,d="number"==typeof i?i:i.y,h={xmin:n.x-p,xmax:n.x+p,ymin:n.y-d,ymax:n.y+d,spatialReference:n.spatialReference},g=c?(0,k.Cv)(h,this.spatialReference):h;if(!g)return{candidates:[]};const v=(await(0,y.el)((0,f.rS)(n),null,{signal:r}))[0],b=(await(0,y.el)((0,f.rS)(g),null,{signal:r}))[0];if(null==v||null==b)return{candidates:[]};const w=new W(await this._reschedule((()=>this._searchFeatures(ce(b.toJSON()))),r),u,this);await this._reschedule((()=>this._executeObjectIdsQuery(w)),r),await this._reschedule((()=>this._executeTimeQuery(w)),r),await this._reschedule((()=>this._executeAttributesQuery(w)),r),await this._reschedule((()=>this._executeGeometryQueryForSnapping(w,r)),r);const _=v.toJSON(),S=c?(0,k.Cv)(_,this.spatialReference):_,I=c?Math.max(g.xmax-g.xmin,g.ymax-g.ymin)/2:i;return w.createSnappingResponse({...e,point:S,distance:I},n.spatialReference)}async executeQueryForLatestObservations(e,t){const r=(0,l.Mq)(t);if(!this.timeInfo?.trackIdField)throw new i.A("unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});try{const t=await this._executeQuery(e,{},r);return await this._reschedule((()=>this._filterLatest(t)),r),await t.createQueryResponse()}catch(t){if(t!==X.v8)throw t;return new W([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(e={},t,r){const n=(0,l.Mq)(r),{field:i,normalizationField:s,valueExpression:o}=t;return(await this._executeQueryForStatistics(e,{field:i,normalizationField:s,valueExpression:o},n)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,r){const n=(0,l.Mq)(r),{field:i,field2:s,field3:o,valueExpression:a}=t;return(await this._executeQueryForStatistics(e,{field:i,field2:s,field3:o,valueExpression:a},n)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,r){const n=(0,l.Mq)(r),{field:i,normalizationField:s,valueExpression:o}=t;return(await this._executeQueryForStatistics(e,{field:i,normalizationField:s,valueExpression:o},n)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,r){const n=(0,l.Mq)(r),{field:i,normalizationField:s,valueExpression:o}=t;return(await this._executeQueryForStatistics(e,{field:i,normalizationField:s,valueExpression:o},n)).createHistogramResponse(t)}async fetchRecomputedExtents(e){const t=(0,l.Mq)(e);this._timeExtentPromise||=(0,oe.W)(this.timeInfo,this.featureStore);const[r,n]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);return(0,l.Te)(t),{fullExtent:r,timeExtent:n}}async _getBounds(e,t,r){const n=(0,p.hZ)((0,p.vt)(),p.qv);await this.featureStore.forEachBounds(e,(e=>(0,p.RF)(n,e)));const i={xmin:n[0],ymin:n[1],xmax:n[3],ymax:n[4],spatialReference:(0,F.ag)(this.spatialReference)};this.hasZ&&isFinite(n[2])&&isFinite(n[5])&&(i.zmin=n[2],i.zmax=n[5],i.hasZ=!0);const s=(0,k.Cv)(i,t,r);if(s.spatialReference=(0,F.ag)(r),s.xmax-s.xmin==0){const e=(0,u.GA)(s.spatialReference);s.xmin-=e,s.xmax+=e}if(s.ymax-s.ymin==0){const e=(0,u.GA)(s.spatialReference);s.ymin-=e,s.ymax+=e}if(this.hasZ&&null!=s.zmin&&null!=s.zmax&&s.zmax-s.zmin==0){const e=(0,u.GA)(s.spatialReference);s.zmin-=e,s.zmax+=e}return s}_getFullExtent(){return this._fullExtentPromise||="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then((e=>this._getBounds(e,this.spatialReference,this.spatialReference))),this._fullExtentPromise}async _schedule(e,t){return null!=this._frameTask?this._frameTask.schedule(e,t):e(le.Bb)}async _reschedule(e,t){return null!=this._frameTask?this._frameTask.reschedule(e,t):e(le.Bb)}async _getAllFeaturesQueryEngineResult(e){return new W(await this._getAllFeatures(),e,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const e=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach((t=>e.push(t)))})().then((()=>e))}const e=this._allFeaturesPromise,t=await e;return e===this._allFeaturesPromise?t.slice():this._getAllFeatures()}async _executeQuery(e,t,r){e=(0,o.o8)(e),e=await this._schedule((()=>(0,X.GC)(e,this.definitionExpression,this.spatialReference)),r),e=await this._reschedule((()=>re(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),r),e={...e,...t};const n=await this._reschedule((()=>this._executeSceneFilterQuery(e,r)),r),i=await this._reschedule((()=>this._executeGeometryQuery(e,n,r)),r);return await this._reschedule((()=>this._executeAggregateIdsQuery(i)),r),await this._reschedule((()=>this._executeObjectIdsQuery(i)),r),await this._reschedule((()=>this._executeTimeQuery(i)),r),await this._reschedule((()=>this._executeAttributesQuery(i)),r),i}async _executeSceneFilterQuery(e,t){if(null==e.sceneFilter)return null;const{outSR:r,returnGeometry:n,returnCentroid:i}=e,s=this.featureStore.featureSpatialReference,o=e.sceneFilter.geometry,a=null==s||(0,m.aI)(s,o.spatialReference)?o:(0,k.Cv)(o,s);if(!a)return null;const l=n||i,u=(0,m.fn)(r)&&!(0,m.aI)(this.spatialReference,r)&&l?async e=>this._project(e,r):e=>e,c=this.featureAdapter,p=await this._reschedule((()=>this._searchFeatures(ce(a))),t);if("disjoint"===e.sceneFilter.spatialRelationship){if(!p.length)return null;const r=new Set;for(const e of p)r.add(c.getObjectId(e));const n=await this._reschedule((()=>this._getAllFeatures()),t),i=await this._reschedule((async()=>{const i=await(0,ee.xt)("esriSpatialRelDisjoint",a,this.geometryType,this.hasZ,this.hasM),s=await this._runSpatialFilter(n,(e=>!r.has(c.getObjectId(e))||i(c.getGeometry(e))),t);return new W(s,e,this)}),t);return u(i)}if(!p.length)return new W([],e,this);if(this._canExecuteSinglePass(a,e))return u(new W(p,e,this));const d=await(0,ee.xt)("esriSpatialRelContains",a,this.geometryType,this.hasZ,this.hasM),h=await this._runSpatialFilter(p,(e=>d(c.getGeometry(e))),t);return u(new W(h,e,this))}async _executeGeometryQuery(e,t,r){if(null!=t&&0===t.items.length)return t;e=null!=t?t.query:e;const{geometry:i,outSR:s,spatialRel:o,returnGeometry:a,returnCentroid:l}=e,u=this.featureStore.featureSpatialReference,c=!i||null==u||(0,m.aI)(u,i.spatialReference)?i:(0,k.Cv)(i,u),p=a||l,d=(0,m.fn)(s)&&!(0,m.aI)(this.spatialReference,s),h=null==t?this._getCacheKey(e):null,f=h?this._cache.get(h):null;if(null!=f)return new W(f,e,this);const y=async e=>(d&&p&&await this._project(e,s),h&&this._cache.put(h,e.items),e);if(!c)return y(null!=t?t:await this._getAllFeaturesQueryEngineResult(e));const g=this.featureAdapter;let v=await this._reschedule((()=>this._searchFeatures(ce(i))),r);if("esriSpatialRelDisjoint"===o){if(!v.length)return y(null!=t?t:await this._getAllFeaturesQueryEngineResult(e));const n=new Set;for(const e of v)n.add(g.getObjectId(e));const i=null!=t?t.items:await this._reschedule((()=>this._getAllFeatures()),r),s=await this._reschedule((async()=>{const t=await(0,ee.xt)(o,c,this.geometryType,this.hasZ,this.hasM),s=await this._runSpatialFilter(i,(e=>!n.has(g.getObjectId(e))||t(g.getGeometry(e))),r);return new W(s,e,this)}),r);return y(s)}if(null!=t){const e=new n.vW;v=v.filter((r=>(0,n.qh)(t.items,r,t.items.length,e)>=0))}if(!v.length){const t=new W([],e,this);return h&&this._cache.put(h,t.items),t}if(this._canExecuteSinglePass(c,e))return y(new W(v,e,this));const b=await(0,ee.xt)(o,c,this.geometryType,this.hasZ,this.hasM),w=await this._runSpatialFilter(v,(e=>b(g.getGeometry(e))),r);return y(new W(w,e,this))}async _executeGeometryQueryForSnapping(e,t){const{query:r}=e,{spatialRel:n}=r;if(!e?.items?.length||!r.geometry||!n)return;const i=await(0,ee.xt)(n,r.geometry,this.geometryType,this.hasZ,this.hasM),s=await this._runSpatialFilter(e.items,(e=>i(e.geometry)),t);e.items=s}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds?.length||null==this.aggregateAdapter)return;const t=new Set;for(const r of e.query.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach((e=>t.add(e)));const r=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(r(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds?.length)return;const t=new Set(e.query.objectIds),r=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(r(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=(0,oe.I)(this.timeInfo,e.query.timeExtent,this.featureAdapter);null!=t&&(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=L(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,r){if(!t)return e;if(null==this._frameTask)return e.filter((e=>t(e)));let n=0;const i=new Array,s=async o=>{for(;n<e.length;){const a=e[n++];t(a)&&(i.push(a),o.madeProgress()),o.done&&await this._reschedule((e=>s(e)),r)}};return this._reschedule((e=>s(e)),r).then((()=>i))}_filterLatest(e){const{trackIdField:t,startTimeField:r,endTimeField:n}=this.timeInfo,i=n||r,s=new Map,o=this.featureAdapter.getAttribute;for(const r of e.items){const e=o(r,t),n=o(r,i),a=s.get(e);(!a||n>o(a,i))&&s.set(e,r)}e.items=Array.from(s.values())}_getCacheKey(e){const{geometry:t,spatialRel:r,returnGeometry:n,returnCentroid:i,outSR:s,resultType:o,cacheHint:a}=e;if("tile"!==o&&!a)return null;const l=n||i;return(0,m.fn)(s)&&!(0,m.aI)(this.spatialReference,s)&&l?JSON.stringify([t,r,s]):JSON.stringify([t,r])}_canExecuteSinglePass(e,t){const{spatialRel:r}=t;return(0,ee.tC)(e)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r))}async _project(e,t){if(!t||(0,m.aI)(this.spatialReference,t))return e;const r=this.featureAdapter;let n;try{const e=await this._getFullExtent();n=(0,c.getTransformation)(this.spatialReference,t,e)}catch{}const i=await(0,k.lK)(e.items.map((e=>(0,F.pL)(this.geometryType,this.hasZ,this.hasM,r.getGeometry(e)))),this.spatialReference,t,n);return e.items=i.map(((t,n)=>r.cloneWithGeometry(e.items[n],(0,g.Ux)(t,this.hasZ,this.hasM)))),e}async _searchFeatures(e){const t=new Set;await Promise.all(e.map((e=>this.featureStore.forEachInBounds(e,(e=>t.add(e))))));const r=Array.from(t.values());return t.clear(),r}async _executeQueryForStatistics(e,t,r){e=(0,o.o8)(e);try{e=await this._schedule((()=>(0,X.GC)(e,this.definitionExpression,this.spatialReference)),r),e=await this._reschedule((()=>async function(e,t,{fieldsIndex:r,geometryType:n,spatialReference:s,availableFields:o}){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new i.A(te,"Unsupported query options",{query:e});return ne(r,o,e),Promise.all([se(r,o,t,e),(0,ee.c0)(e,n,s),(0,k.Nk)(s,e.outSR)]).then((()=>e))}(e,t,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),r);const n=await this._reschedule((()=>this._executeSceneFilterQuery(e,r)),r),s=await this._reschedule((()=>this._executeGeometryQuery(e,n,r)),r);return await this._reschedule((()=>this._executeAggregateIdsQuery(s)),r),await this._reschedule((()=>this._executeObjectIdsQuery(s)),r),await this._reschedule((()=>this._executeTimeQuery(s)),r),await this._reschedule((()=>this._executeAttributesQuery(s)),r),s}catch(t){if(t!==X.v8)throw t;return new W([],e,this)}}}function ce(e){if((0,ee.tC)(e)){if((0,f.ZC)(e))return[(0,d.fA)(Math.min(e.xmin,e.xmax),Math.min(e.ymin,e.ymax),Math.max(e.xmin,e.xmax),Math.max(e.ymin,e.ymax))];if((0,f.Bi)(e))return e.rings.map((e=>(0,d.fA)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[(0,h.Rg)((0,d.vt)(),e)]}},7121:function(e,t,r){r.d(t,{F:function(){return n}});const n={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!0,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!0,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},51376:function(e,t,r){function n(e,t,r){return{objectId:e,target:t,distance:r,type:"vertex"}}function i(e,t,r,n,i,s=!1){return{objectId:e,target:t,distance:r,type:"edge",start:n,end:i,draped:s}}r.d(t,{P:function(){return i},k:function(){return n}})},78956:function(e,t,r){r.d(t,{LQ:function(){return u},ag:function(){return p},pL:function(){return c}});var n=r(58081),i=r(76613);const s=new i.A,o=new i.A,a=new i.A,l={esriGeometryPoint:n.DF,esriGeometryPolyline:n.BW,esriGeometryPolygon:n.z5,esriGeometryMultipoint:n.qK};function u(e,t,r,i=e.hasZ,s=e.hasM){if(null==t)return null;const o=e.hasZ&&i,l=e.hasM&&s;if(r){const u=(0,n.Nl)(a,t,e.hasZ,e.hasM,"esriGeometryPoint",r,i,s);return(0,n.DF)(u,o,l)}return(0,n.DF)(t,o,l)}function c(e,t,r,i,u,c,p=t,d=r){const h=t&&p,f=r&&d,y=null!=i?"coords"in i?i:i.geometry:null;if(null==y)return null;if(u){let i=(0,n.kz)(o,y,t,r,e,u,p,d);return c&&(i=(0,n.Nl)(a,i,h,f,e,c)),l[e]?.(i,h,f)??null}if(c){const i=(0,n.Nl)(a,y,t,r,e,c,p,d);return l[e]?.(i,h,f)??null}return(0,n.Q4)(s,y,t,r,p,d),l[e]?.(s,h,f)??null}function p(e){return e&&d in e?JSON.parse(JSON.stringify(e,h)):e}const d="_geVersion",h=(e,t)=>e!==d?t:void 0},46805:function(e,t,r){r.d(t,{T:function(){return o}});var n=r(40302),i=r(65215),s=r(76613);const o={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new i.Om(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>(null==e.centroid&&(e.centroid=(0,n.Q)(new s.A,e.geometry,t.hasZ,t.hasM)),e.centroid)}},74841:function(e,t,r){r.d(t,{Cv:function(){return m},Nk:function(){return h},lK:function(){return v}});var n=r(50659),i=r(60539),s=r(46157),o=r(86029),a=r(57652),l=r(1644);const u=[0,0];function c(e,t){if(!t)return null;if("x"in t){const r={x:0,y:0};return[r.x,r.y]=e(t.x,t.y,u),null!=t.z&&(r.z=t.z),null!=t.m&&(r.m=t.m),r}if("xmin"in t){const r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=e(t.xmin,t.ymin,u),[r.xmax,r.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(r.zmin=t.zmin,r.zmax=t.zmax,r.hasZ=!0),t.hasM&&(r.mmin=t.mmin,r.mmax=t.mmax,r.hasM=!0),r}return"rings"in t?{rings:p(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:p(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:d(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function p(e,t){const r=[];for(const n of e)r.push(d(n,t));return r}function d(e,t){const r=[];for(const n of e){const e=t(n[0],n[1],[0,0]);r.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return r}async function h(e,t){if(!e||!t)return;const r=Array.isArray(e)?e.map((e=>null!=e.geometry?e.geometry.spatialReference:null)).filter(n.Ru):[e];await(0,s.initializeProjection)(r.map((e=>({source:e,dest:t}))))}const f=c.bind(null,l.je),y=c.bind(null,l.tD);function m(e,t,r,n){if(!e)return e;if(r||(r=t,t=e.spatialReference),!(0,a.fn)(t)||!(0,a.fn)(r)||(0,a.aI)(t,r))return e;if((0,l.y7)(t,r)){const t=(0,a.K8)(r)?f(e):y(e);return t.spatialReference=r,t}return(0,s.projectMany)(o.g,[e],t,r,null,n)[0]}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,r,n){if(!e?.length||!t||!r||(0,a.aI)(t,r))return e;const s={geometries:e,inSpatialReference:t,outSpatialReference:r,geographicTransformation:n,resolve:(0,i.Tw)()};return this._jobs.push(s),this._timer??=setTimeout(this._process,10),s.resolve.promise}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:r,outSpatialReference:n,resolve:i,geographicTransformation:u}=e;(0,l.y7)(r,n)?(0,a.K8)(n)?i(t.map(f)):i(t.map(y)):i((0,s.projectMany)(o.g,t,r,n,u,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function v(e,t,r,n){return g.push(e,t,r,n)}},20932:function(e,t,r){r.d(t,{GC:function(){return h},T2:function(){return f},VY:function(){return p},v8:function(){return d}});var n=r(73037),i=r(62938),s=r(46157),o=r(38503),a=r(74697),l=r(65298),u=r(57652),c=r(74841);const p=new n.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),d=Object.freeze({});async function h(e,t,r){const{outFields:n,orderByFields:i,groupByFieldsForStatistics:s,outStatistics:o}=e;if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(o)for(let e=0;e<o.length;e++)o[e].onStatisticField&&(o[e].onStatisticField=o[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),f(e,t,r)}async function f(e,t,n){if(!e)return null;let{where:s}=e;if(e.where=s=s?.trim(),(!s||/^1 *= *1$/.test(s)||t&&t===s)&&(e.where=null),!e.geometry)return e;let h=await async function(e){const{distance:t,units:n}=e,s=e.geometry;if(null==t||"vertexAttributes"in s)return s;const o=s.spatialReference,a=n?p.fromJSON(n):(0,i.Ij)(o),l=o&&((0,u.EA)(o)||(0,u.K8)(o))?s:await(0,c.Nk)(o,u.KK).then((()=>(0,c.Cv)(s,u.KK)));return(await async function(){return(await r.e(4696).then(r.bind(r,28356))).geodesicBuffer}())(l.spatialReference,l,t,a)}(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;h=(0,o.HA)(h),h.spatialReference=t}if(h){await(0,c.Nk)(h.spatialReference,n),h=function(e,t){const r=e.spatialReference;return y(e,t)&&(0,a.ZC)(e)?{spatialReference:r,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}(h,n);const t=(await(0,l.el)((0,a.rS)(h)))[0];if(null==t)throw d;const r="quantizationParameters"in e&&e.quantizationParameters?.tolerance||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,i=r&&y(h,n)?{densificationStep:8*r}:void 0,s=t.toJSON(),o=(0,c.Cv)(s,s.spatialReference,n,i);if(!o)throw d;o.spatialReference=n,e.geometry=o}return e}function y(e,t){if(!e)return!1;const r=e.spatialReference;return((0,a.ZC)(e)||(0,a.Bi)(e)||(0,a.Rg)(e))&&!(0,u.aI)(r,t)&&!(0,s.canProjectWithoutEngine)(r,t)}},62512:function(e,t,r){r.d(t,{tC:function(){return _},c0:function(){return w},xt:function(){return b}});var n=r(39819),i=r(61273),s=r(96127),o=r(74697),a=r(57652);function l(e,t){return e?t?4:3:t?3:2}function u(e,t,r,n,i,s){const o=l(i,s),{coords:a,lengths:u}=n;if(!u)return!1;for(let n=0,i=0;n<u.length;n++,i+=o)if(!c(e,t,r,a[i],a[i+1]))return!1;return!0}function c(e,t,r,n,i){if(!e)return!1;const s=l(t,r),{coords:o,lengths:a}=e;let u=!1,c=0;for(const e of a)u=p(u,o,s,c,e,n,i),c+=e*s;return u}function p(e,t,r,n,i,s,o){let a=e,l=n;for(let e=n,u=n+i*r;e<u;e+=r){l=e+r,l===u&&(l=n);const i=t[e],c=t[e+1],p=t[l],d=t[l+1];(c<o&&d>=o||d<o&&c>=o)&&i+(o-c)/(d-c)*(p-i)<s&&(a=!a)}return a}var d=r(58081),h=r(76613),f=r(78956),y=r(74841);const m="unsupported-query",g={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},v={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function b(e,t,n,a,l){if((0,o.Bi)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,d.Ye)(new h.A,t,!1,!1);return Promise.resolve((t=>function(e,t,r,n){return c(e,!1,!1,n.coords[0],n.coords[1])}(e,0,0,t)))}if((0,o.Bi)(t)&&"esriGeometryMultipoint"===n){const r=(0,d.Ye)(new h.A,t,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>u(r,!1,!1,e,a,l)))}if((0,o.ZC)(t)&&"esriGeometryPoint"===n&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>(0,i.qz)(t,(0,f.pL)(n,a,l,e))));if((0,o.ZC)(t)&&"esriGeometryMultipoint"===n&&"esriSpatialRelContains"===e)return Promise.resolve((e=>(0,i.rL)(t,(0,f.pL)(n,a,l,e))));if((0,o.ZC)(t)&&"esriSpatialRelIntersects"===e){const e="mesh"===(p=n)?s.xB:(0,s.xK)(p);return Promise.resolve((r=>e(t,(0,f.pL)(n,a,l,r))))}var p;return r.e(4696).then(r.bind(r,28356)).then((r=>{const i=r[g[e]].bind(null,t.spatialReference,t);return e=>i((0,f.pL)(n,a,l,e))}))}async function w(e,t,r){const{spatialRel:i,geometry:s}=e;if(s){if(!function(e){return null!=e&&!0===v.spatialRelationship[e]}(i))throw new n.A(m,"Unsupported query spatial relationship",{query:e});if((0,a.fn)(s.spatialReference)&&(0,a.fn)(r)){if(!function(e){return null!=e&&!0===v.queryGeometry[(0,o.$B)(e)]}(s))throw new n.A(m,"Unsupported query geometry type",{query:e});if(!function(e){return null!=e&&!0===v.layerGeometry[e]}(t))throw new n.A(m,"Unsupported layer geometry type",{query:e});if(e.outSR)return(0,y.Nk)(e.geometry?.spatialReference,e.outSR)}}}function _(e){if((0,o.ZC)(e))return!0;if((0,o.Bi)(e)){for(const t of e.rings){if(5!==t.length)return!1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return!1}return!0}return!1}},20973:function(e,t,r){async function n(e,t){if(!e)return null;const r=t.featureAdapter,{startTimeField:n,endTimeField:i}=e;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(n&&i)await t.forEach((e=>{const t=r.getAttribute(e,n),a=r.getAttribute(e,i);null==t||isNaN(t)||(s=Math.min(s,t)),null==a||isNaN(a)||(o=Math.max(o,a))}));else{const e=n||i;await t.forEach((t=>{const n=r.getAttribute(t,e);null==n||isNaN(n)||(s=Math.min(s,n),o=Math.max(o,n))}))}return{start:s,end:o}}function i(e,t,r){if(!t||!e)return null;const{startTimeField:n,endTimeField:i}=e;if(!n&&!i)return null;const{start:s,end:o}=t;if(null===s&&null===o)return null;if(void 0===s&&void 0===o)return()=>!1;const a=r.getAttributeAsTimestamp?.bind(r)??r.getAttribute.bind(r);return n&&i?function(e,t,r,n,i){return null!=n&&null!=i?s=>{const o=e(s,t),a=e(s,r);return(null==o||o<=i)&&(null==a||a>=n)}:null!=n?t=>{const i=e(t,r);return null==i||i>=n}:null!=i?r=>{const n=e(r,t);return null==n||n<=i}:void 0}(a,n,i,s,o):function(e,t,r,n){return null!=r&&null!=n&&r===n?n=>e(n,t)===r:null!=r&&null!=n?i=>{const s=e(i,t);return null!=s&&s>=r&&s<=n}:null!=r?n=>{const i=e(n,t);return null!=i&&i>=r}:null!=n?r=>{const i=e(r,t);return null!=i&&i<=n}:void 0}(a,n||i,s,o)}r.d(t,{I:function(){return i},W:function(){return n}})},58081:function(e,t,r){r.d(t,{B2:function(){return _},BW:function(){return D},Ch:function(){return ie},DF:function(){return I},Di:function(){return q},E2:function(){return U},IE:function(){return w},Nl:function(){return X},Q4:function(){return se},Rk:function(){return ae},Ux:function(){return $},Ye:function(){return Z},ZF:function(){return W},eU:function(){return G},eY:function(){return Q},jH:function(){return K},jQ:function(){return ne},kz:function(){return ee},oN:function(){return B},q3:function(){return Y},qK:function(){return F},qN:function(){return O},z5:function(){return V},zv:function(){return H}});var n=r(39819),i=r(40633),s=r(95929),o=r(24761),a=r(87416),l=r(74697),u=r(65215),c=r(72887),p=r(76613);function d(e,t){return e?t?4:3:t?3:2}const h=()=>i.A.getLogger("esri.layers.graphics.featureConversionUtils"),f={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryMultiPatch:3,esriGeometryEnvelope:0},y=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s},m=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2]},g=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+3]},v=(e,t,r,n,i,s)=>{e[r]=i,e[r+1]=s,e[r+2]=t[n+2],e[r+3]=t[n+3]};function b(e,t,r,n){if(e){if(r)return t&&n?v:m;if(t&&n)return g}else if(t&&n)return m;return y}function w({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function _({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function S({scale:e,translate:t},r,n){return r*e[n]+t[n]}function I(e,t,r){return e?t?r?C(e):x(e):r?E(e):M(e):null}function M(e){const t=e.coords;return{x:t[0],y:t[1]}}function T(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function x(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function E(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function L(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function C(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function N(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function R(e,t){return e&&t?N:e?A:t?L:T}function O(e,t,r=R(null!=t.z,null!=t.m)){return r(e,t)}function F(e,t,r){if(null==e)return null;const n=d(t,r),i=[];for(let t=0;t<e.coords.length;t+=n){const r=[];for(let i=0;i<n;i++)r.push(e.coords[t+i]);i.push(r)}return t?r?{points:i,hasZ:t,hasM:r}:{points:i,hasZ:t}:r?{points:i,hasM:r}:{points:i}}function k(e,t,r=d(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let i=0;for(const e of t.points)for(let t=0;t<r;t++)n[i++]=e[t];return e}function D(e,t,r){if(!e)return null;const n=d(t,r),{coords:i,lengths:s}=e,o=[];let a=0;for(const e of s){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(i[a++]);t.push(e)}o.push(t)}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function P(e,t,r=d(t.hasZ,t.hasM)){const{lengths:n,coords:i}=e;let s=0;for(const e of t.paths){for(const t of e)for(let e=0;e<r;e++)i[s++]=t[e];n.push(e.length)}return e}function V(e,t,r){if(!e)return null;const n=d(t,r),{coords:i,lengths:s}=e,o=[];let a=0;for(const e of s){const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e.push(i[a++]);t.push(e)}o.push(t)}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function Z(e,t,r=t.hasZ,n=t.hasM){return G(e,t.rings,r,n)}function G(e,t,r,n){const i=d(r,n),{lengths:s,coords:o}=e;let a=0;le(e);for(const e of t){for(const t of e)for(let e=0;e<i;e++)o[a++]=t[e];s.push(e.length)}return e}const j=[],z=[];function U(e,t,r,n,i){j[0]=e;const[s]=q(z,j,t,r,n,i);return ue(j),ue(z),s}function q(e,t,r,i,s,o){if(ue(e),!r){for(const r of t){const t=o?r.attributes[o]:void 0;e.push(new u.Om(null,r.attributes,null,t))}return e}switch(r){case"esriGeometryPoint":return function(e,t,r,n,i){const s=R(r,n);for(const{geometry:r,attributes:n}of t){const t=null!=r?s(new p.A,r):null;e.push(new u.Om(t,n,null,i?n[i]:void 0))}return e}(e,t,i,s,o);case"esriGeometryMultipoint":return function(e,t,r,n,i){const s=d(r,n);for(const{geometry:r,attributes:n}of t){const t=null!=r?k(new p.A,r,s):null;e.push(new u.Om(t,n,null,i?n[i]:void 0))}return e}(e,t,i,s,o);case"esriGeometryPolyline":return function(e,t,r,n,i){const s=d(r,n);for(const{geometry:r,attributes:n,centroid:o}of t){const t=null!=r?P(new p.A,r,s):null,a=null!=o?O(new p.A,o):null;e.push(new u.Om(t,n,a,i?n[i]:void 0))}return e}(e,t,i,s,o);case"esriGeometryPolygon":case"esriGeometryMultiPatch":return function(e,t,r,n,i){for(const{geometry:s,centroid:o,attributes:a}of t){const t=null!=s?Z(new p.A,s,r,n):null,l=i?a[i]:void 0;null!=o?e.push(new u.Om(t,a,T(new p.A,o),l)):e.push(new u.Om(t,a,null,l))}return e}(e,t,i,s,o);default:h().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`)),ue(e)}return e}function B(e,t,r,n){z[0]=e,J(j,z,t,r,n);const i=j[0];return ue(j),ue(z),i}function $(e,t,r){if(null==e)return null;const i=new p.A;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==r&&(r=e.hasM),(0,l.fT)(e)?R(null!=t?t:null!=e.z,null!=r?r:null!=e.m)(i,e):(0,l.Bi)(e)?Z(i,e,t,r):(0,l.Rg)(e)?P(i,e,d(t,r)):(0,l.U9)(e)?k(i,e,d(t,r)):void h().error("convertFromGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${e}'`))}function H(e,t,r,i){const s=e&&("coords"in e?e:e.geometry);if(null==s)return null;switch(t){case"esriGeometryPoint":{let e=M;return r&&i?e=C:r?e=x:i&&(e=E),e(s)}case"esriGeometryMultipoint":return F(s,r,i);case"esriGeometryPolyline":return D(s,r,i);case"esriGeometryPolygon":return V(s,r,i);default:return h().error("convertToGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${t}'`)),null}}function J(e,t,r,i,s){if(ue(e),null==r)return function(e,t){for(const r of t)e.push({attributes:r.attributes});return e}(e,t);switch(r){case"esriGeometryPoint":return function(e,t,r,n){let i=M;r&&n?i=C:r?i=x:n&&(i=E);for(const r of t){const{geometry:t,attributes:n}=r,s=null!=t?i(t):null;e.push({attributes:n,geometry:s})}return e}(e,t,i,s);case"esriGeometryMultipoint":return function(e,t,r,n){for(const{geometry:i,attributes:s}of t)e.push({attributes:s,geometry:null!=i?F(i,r,n):null});return e}(e,t,i,s);case"esriGeometryPolyline":return function(e,t,r,n){for(const{geometry:i,attributes:s}of t)e.push({attributes:s,geometry:null!=i?D(i,r,n):null});return e}(e,t,i,s);case"esriGeometryPolygon":return function(e,t,r,n){for(const{geometry:i,attributes:s,centroid:o}of t){const t=null!=i?V(i,r,n):null;if(null!=o){const r=M(o);e.push({attributes:s,centroid:r,geometry:t})}else e.push({attributes:s,geometry:t})}return e}(e,t,i,s);default:h().error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${r}'`))}return e}function W(e){const{objectIdFieldName:t,spatialReference:r,transform:n,fields:i,hasM:s,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:p,queryGeometryType:d}=e,h={features:J([],a,l,o,s),fields:i,geometryType:l,objectIdFieldName:t,spatialReference:r,uniqueIdField:c,queryGeometry:H(p,d,!1,!1)};return n&&(h.transform=n),u&&(h.exceededTransferLimit=u),s&&(h.hasM=s),o&&(h.hasZ=o),h}function Y(e,t){const r=new c.A,{hasM:i,hasZ:s,features:o,objectIdFieldName:a,spatialReference:l,geometryType:u,exceededTransferLimit:p,transform:d,fields:f}=e;return f&&(r.fields=f),r.geometryType=u??null,r.objectIdFieldName=a??t??null,r.spatialReference=l??null,r.objectIdFieldName?(o&&q(r.features,o,u,s,i,r.objectIdFieldName),p&&(r.exceededTransferLimit=p),i&&(r.hasM=i),s&&(r.hasZ=s),d&&(r.transform=d),r):(h().error(new n.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function Q(e){const{transform:t,features:r,hasM:n,hasZ:i}=e;if(!t)return e;for(const e of r)null!=e.geometry&&ie(e.geometry,e.geometry,n,i,t),null!=e.centroid&&ie(e.centroid,e.centroid,n,i,t);return e.transform=null,e}function K(e,t){const{geometryType:r,features:n,hasM:i,hasZ:s}=t;if(!e)return t;for(let t=0;t<n.length;t++){const o=n[t],a=o.weakClone();a.geometry=new p.A,X(a.geometry,o.geometry,i,s,r,e),o.centroid&&(a.centroid=new p.A,X(a.centroid,o.centroid,i,s,"esriGeometryPoint",e)),n[t]=a}return t.transform=e,t}function X(e,t,r,n,i,s,o=r,a=n){if(le(e),!t?.coords.length)return null;const l=f[i],{coords:u,lengths:c}=t,p=d(r,n),h=d(r&&o,n&&a),y=b(r,n,o,a);if(!c.length)return y(e.coords,u,0,0,w(s,u[0]),_(s,u[1])),le(e,p,0),e;let m,g,v,S,I=0,M=0,T=M;for(const t of c){if(t<l)continue;let r=0;M=T,v=m=w(s,u[I]),S=g=_(s,u[I+1]),y(e.coords,u,M,I,v,S),r++,I+=p,M+=h;for(let n=1;n<t;n++,I+=p)v=w(s,u[I]),S=_(s,u[I+1]),v===m&&S===g||(y(e.coords,u,M,I,v-m,S-g),M+=h,r++,m=v,g=S);r>=l&&(e.lengths.push(r),T=M)}return ue(e.coords,T),e.coords.length?e:null}function ee(e,t,r,n,i,s,o=r,a=n){if(le(e),!t?.coords.length)return null;const l=f[i],{coords:u,lengths:c}=t,p=d(r,n),h=d(r&&o,n&&a),y=b(r,n,o,a);if(!c.length)return y(e.coords,u,0,0,u[0],u[1]),le(e,p,0),e;let m=0;const g=s*s;for(const t of c){if(t<l){m+=t*p;continue}const r=e.coords.length/h,n=m,i=m+(t-1)*p;y(e.coords,u,e.coords.length,n,u[n],u[n+1]),re(e.coords,u,p,g,y,n,i),y(e.coords,u,e.coords.length,i,u[i],u[i+1]);const s=e.coords.length/h-r;s>=l?e.lengths.push(s):ue(e.coords,r*h),m+=t*p}return e.coords.length?e:null}function te(e,t,r,n){const i=e[t],s=e[t+1],o=e[r],a=e[r+1],l=e[n],u=e[n+1];let c=o,p=a,d=l-c,h=u-p;if(0!==d||0!==h){const e=((i-c)*d+(s-p)*h)/(d*d+h*h);e>1?(c=l,p=u):e>0&&(c+=d*e,p+=h*e)}return d=i-c,h=s-p,d*d+h*h}function re(e,t,r,n,i,s,o){let a,l=n,u=0;for(let e=s+r;e<o;e+=r)a=te(t,e,s,o),a>l&&(u=e,l=a);l>n&&(u-s>r&&re(e,t,r,n,i,s,u),i(e,t,e.length,u,t[u],t[u+1]),o-u>r&&re(e,t,r,n,i,u,o))}function ne(e,t,r,n){if(!t?.coords?.length)return null;const i=d(r,n);let s=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=i){const r=e[t],n=e[t+1];s=Math.min(s,r),u=Math.max(u,r),l=Math.min(l,n),c=Math.max(c,n)}}return(0,o.is)(e)?(0,o.BI)(e,s,l,u,c):(0,a.fA)(s,l,u,c,e),e}function ie(e,t,r,n,i){const{coords:o,lengths:a}=t,l=d(r,n);if(!o.length)return e!==t&&le(e),e;(0,s.Lw)(i);const{originPosition:u,scale:c,translate:p}=i,h=ce;h.originPosition=u;const f=h.scale;f[0]=c[0]??1,f[1]=-(c[1]??1),f[2]=c[2]??1,f[3]=c[3]??1;const y=h.translate;if(y[0]=p[0]??0,y[1]=p[1]??0,y[2]=p[2]??0,y[3]=p[3]??0,!a.length){for(let t=0;t<l;++t)e.coords[t]=S(h,o[t],t);return e!==t&&le(e,l,0),e}let m=0;for(let t=0;t<a.length;t++){const r=a[t];e.lengths[t]=r;for(let t=0;t<l;++t)e.coords[m+t]=S(h,o[m+t],t);let n=e.coords[m],i=e.coords[m+1];m+=l;for(let t=1;t<r;t++,m+=l){n+=o[m]*f[0],i+=o[m+1]*f[1],e.coords[m]=n,e.coords[m+1]=i;for(let t=2;t<l;++t)e.coords[m+t]=S(h,o[m+t],t)}}return e!==t&&le(e,o.length,a.length),e}function se(e,t,r,n,i,s){if(le(e),e.lengths.push(...t.lengths),r===i&&n===s)for(let r=0;r<t.coords.length;r++)e.coords.push(t.coords[r]);else{const o=d(r,n),a=b(r,n,i,s),l=t.coords;for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function oe(e,t,r,n){let i=0,s=e[n*t],o=e[n*(t+1)];for(let a=1;a<r;a++){const r=s+e[n*(t+a)],l=o+e[n*(t+a)+1],u=(r-s)*(l+o);s=r,o=l,i+=u}return.5*i}function ae(e,t){const{coords:r,lengths:n}=e;let i=0,s=0;for(let e=0;e<n.length;e++){const o=n[e];s+=oe(r,i,o,t),i+=o}return Math.abs(s)}function le(e,t=0,r=0){ue(e.lengths,r),ue(e.coords,t)}function ue(e,t=0){e.length!==t&&(e.length=t)}const ce={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},69619:function(e,t,r){r.d(t,{F0:function(){return l},Vx:function(){return p},e2:function(){return h},f:function(){return f}});var n=r(58941),i=r(21609),s=r(7121),o=r(79580),a=r(6259);function l(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?a.Cb:"esriGeometryPolyline"===e?a.yM:a.WR}}}const u=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let c=1;function p(e,t){if((0,n.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let r=`this${d(t)} = null;`;for(const t in e)r+=`this${d(t)} = ${JSON.stringify(e[t])};`;const n=new Function(`\n      return class AttributesClass$${c++} {\n        constructor() {\n          ${r};\n        }\n      }\n    `)();return()=>new n}catch(r){return()=>({[t]:null,...e})}}function d(e){return u.test(e)?`.${e}`:`["${e}"]`}function h(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function f(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:s.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:o.$,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},34485:function(e,t,r){r.d(t,{P:function(){return _}});var n=r(53804),i=(r(50917),r(83525)),s=r(39819),o=r(40633),a=r(25738),l=r(98737),u=r(23502),c=(r(58941),r(13798),r(65953)),p=r(44740),d=r(46157),h=r(57652),f=r(10143),y=r(54709),m=r(38057),g=r(71165),v=r(63288),b=r(7926),w=r(91484);let _=class extends i.A{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((r=>{r.name&&(t.set(r.name,"entity"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((r=>{r.name&&(t.set(r.name,"relationship"),this._processingCacheUpdatesLookup.set(r.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(r.name),r.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(r.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((r,n)=>{if("entity"===t.get(n))this.entityTypeNames.add(n);else{if("relationship"!==t.get(n))return o.A.getLogger(this).warn(`A named type, ${n}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(n);this.relationshipTypeNames.add(n)}const i=new Map;r.members?.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(n);const t=this.getById(e.id);t&&i.set(e.id,t)})),this.sublayerCaches.set(n,i)}))}addToLayer(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new s.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const r=this.inclusionModeDefinition.namedTypeDefinitions.get(e);r.members||(r.members=new Map),r.members.set(t,{id:t}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}else{const r=new Map;r.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:r}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}))}getById(e){return y.A.getInstance().readFromStoreById(e)}async getData(e,t,r){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let n;if(n=e||new b.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,r=this._processingCacheUpdatesLookup.get(t.objectType.name??""),i=n.outFields;i&&1===i.length&&i[0]===f.dr&&"1=1"===n.where||await Promise.all(r??[]);const s=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],o=[];return s.forEach((r=>{if(this.relationshipTypeNames.has(t.objectType.name)){r.geometry=e.relationshipLinkChartDiagramLookup.get(r.attributes[t.objectIdField]);const n=this.memberIdTypeLookup.get(r.attributes[f.Cz]),i=this.memberIdTypeLookup.get(r.attributes[f.KQ]),s=this._isEndEntitySpatial(n,r,f.Cz),o=this._isEndEntitySpatial(i,r,f.KQ);r.attributes[f.BL]=Number(s&&o)}else{r.geometry=e.entityLinkChartDiagramLookup.get(r.attributes[t.objectIdField]);const n=this.geographicLookup.get(t.objectType.name);n&&r.attributes[n.name]?r.attributes[f.BL]=1:r.attributes[f.BL]=0}r.attributes[f.T1]=r.geometry,o.push(r)})),o}return this.retrieveDataFromService(n,t,r)}async getConnectedRecordIds(e,t){const r=[];let n="";const i=[],s=new Map;if(e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(t))return;s.has(t)?s.get(t)?.push(e):s.set(t,[e])}})),t&&0!==t?.length){for(const e of t)n=n+e+"|";n=n.slice(0,-1)}const a={};let l="",u=-1;for(const[e,r]of s){u++,0!==u&&(l+=" UNION ");const i=`${e}_ids`;a[i]=r,l+=t&&0!==t?.length?`MATCH (n:${e}) WHERE id(n) IN $${i} WITH n MATCH (n)-[r:${n}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${e}) WHERE id(n) IN $${i} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`}if(!l)return r;const c=new Promise((e=>{(async()=>{const e=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new v.A({openCypherQuery:l,bindParameters:a}))).resultRowsStream.getReader();try{for(;;){const{done:t,value:n}=await e.read();if(t)break;for(let e=0;e<n.length;e++){const t=n[e];r.push({id:t[0],typeName:t[1]}),r.push({id:t[2],typeName:t[3]})}}}catch(e){if("AbortError"!==e.name)throw e;o.A.getLogger(this).info("Request aborted as expected")}})().then((()=>{e()}))}));return i.push(c),this.refreshCacheContent(),await Promise.all(i),r}async getRelationshipsBetweenNodes(e,t){const r=[],n=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new v.A({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:e,relationshipExclusionIds:t}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await n.read();if(e)break;for(let e=0;e<t.length;e++){const n=t[e];r.push({id:n[0],typeName:n[1]})}}}catch(e){if("AbortError"!==e.name)throw e;o.A.getLogger(this).info("Request aborted as expected")}return r}async getRelationshipsFromNodes(e,t,r){const n=[],i=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,new v.A({openCypherQuery:"MATCH (n)-[r]-(m) WHERE id(n) IN $targetEntityIds AND id(m) in $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{targetEntityIds:e,possibleConnectionEntityIds:t,relationshipExclusionIds:r}}))).resultRowsStream.getReader();try{for(;;){const{done:e,value:t}=await i.read();if(e)break;for(let e=0;e<t.length;e++){const r=t[e];n.push({id:r[0],typeName:r[1]})}}}catch(e){if("AbortError"!==e.name)throw e;o.A.getLogger(this).info("Request aborted as expected")}return n}async refreshCacheContent(e,t,r,n=!0){const i=y.A.getInstance(),o=[],l=new Map,u=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&u.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&u.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))l.has(t)?l.get(t)?.push(e):l.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?l.set(t,null):e.members&&e.members.forEach((e=>{l.has(t)&&null!==l.get(t)?l.get(t)?.push(e.id):l.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&l.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&l.set(e.name,null)})));for(const[e,c]of l){const l=new Promise((o=>{(async()=>{const o=new Set,l=[];let p,d="",h=!1;if(t||u.get(e)?.properties?.forEach((e=>{e.name&&o.add(e.name)})),r&&this.geographicLookup.has(e)){const t=this.geographicLookup.get(e)?.name;t&&o.add(t)}if(this.entityTypeNames.has(e))d=`MATCH (n:${e}) ${c?"WHERE id(n) IN $ids ":""}return ID(n)`,o.forEach((e=>{d+=`, n.${e}`,l.push(e)}));else{if(!this.relationshipTypeNames.has(e))throw new s.A("knowledge-graph:layer-data-manager",`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);h=!0,d=`MATCH ()-[n:${e}]->() ${c?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,o.forEach((e=>{d+=`, n.${e}`,l.push(e)}))}p=new v.A(c?{openCypherQuery:d,bindParameters:{ids:c}}:{openCypherQuery:d});const y=(await(0,g.executeQueryStreaming)(this.knowledgeGraph,p)).resultRowsStream.getReader();for(;;){const{done:t,value:r}=await y.read();if(t)break;const s=[];for(let e=0;e<r.length;e++){const t=r[e];let n=0,i=0;const o={properties:{}};for(o.id=t[n],n++,i++,h&&(o.originId=t[n],n++,i++,o.destinationId=t[n],n++,i++,(0,a.tE)(this.nodeConnectionsLookup,o.originId,(()=>new Set)).add(o.id),(0,a.tE)(this.nodeConnectionsLookup,o.destinationId,(()=>new Set)).add(o.id),(0,a.tE)(this.relationshipConnectionsLookup,o.id,(()=>[o.originId,o.destinationId])));n<t.length;n++)o.properties[l[n-i]]=t[n];s.push(o)}const o=i.writeToStore(s,f.dr,this.geographicLookup.get(e)?.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(e)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map}),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);const u=this.sublayerCaches.get(e);o.forEach((t=>{u?.set(t.attributes[f.dr],t),n&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.has(t.attributes[f.dr])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.set(t.attributes[f.dr],{id:t.attributes[f.dr]}),(0,a.tE)(this.memberIdTypeLookup,t.attributes[f.dr],(()=>new Set)).add(e))}))}})().then((()=>{o(null)}))}));o.push(l),this._processingCacheUpdatesLookup.get(e)?.push(l)}await Promise.all(o)}removeFromLayer(e){const t=new Set,r=new Set(e.map((e=>e.id)));for(const r of e)t.add(r.typeName),1===this.memberIdTypeLookup.get(r.id)?.size?this.memberIdTypeLookup.delete(r.id):this.memberIdTypeLookup.get(r.id)?.delete(r.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===r.typeName&&e.members?.has(r.id)&&e.members.delete(r.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,n)=>{r.has(n)&&this.sublayerCaches.get(e)?.delete(n)}))}))}async retrieveDataFromService(e,t,r){const n=y.A.getInstance(),i=new Set,o=[];let a,u="",c=[];const b="relationship"===t.graphType,_=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,S=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let I=!_&&S?Array.from(S).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(I=e.objectIds);else if(null!=e.objectIds&&I&&I.length>0){const t=e.objectIds;e.objectIds=I.filter((e=>t.includes(e)))}else if(null!=e.objectIds)I=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=I}if(null!=e.outFields){const r=e.outFields;r.includes("*")?t.fields.forEach((e=>{i.add(e.name)})):r.forEach((e=>{e!==f.dr&&e!==t.geometryFieldName&&i.add(e)}))}if(null!=e.geometry){const r=e.geometry;let n;const c=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,f=c?.spatialReference,y=c?.serviceCapabilities?.geometryCapabilities;let g=y?.geometryMaxBoundingRectangleSizeX,_=y?.geometryMaxBoundingRectangleSizeY;if("point"===r.type){let e=r;e.spatialReference?.isWGS84||(await(0,d.initializeProjection)(e.spatialReference,h.KK),e=(0,d.project)(e,h.KK)),n=new w.default({spatialReference:h.KK,xmin:e.x-1e-4,ymin:e.y-1e-4,xmax:e.x+1e-4,ymax:e.y+1e-4})}else r?.extent?.spatialReference&&!r.spatialReference?.isWGS84?(await(0,d.initializeProjection)(r.extent.spatialReference,h.KK),n=(0,d.project)(r.extent,h.KK)):n=r.extent;if(g&&_&&f){if(4326!==f.wkid){const e=new w.default({spatialReference:f,xmax:g,ymax:_}),t=(0,d.project)(e,h.KK);g=t.xmax,_=t.ymax}if(n.xmax-n.xmin>g)throw new s.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${g} latitude, limit exceeded`);if(n.ymax-n.ymin>_)throw new s.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${_} longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const r=await(0,l.G)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&i.add(e.name)}))}u=b?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{u+=`, n.${e}`,o.push(e)})),a=new v.A({openCypherQuery:u,bindParameters:{param_filter_geom:new p.A({rings:(0,m.DX)(n)})}})}else{let r="";if(null!=e.where&&"1=1"!==e.where){const n=await(0,l.G)(e.where,t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&i.add(e.name)}));const s=new Set(["column-reference","string","number","binary-expression"]),o=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const u=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&s.has(e.left.type)&&s.has(e.right.type)&&o.has(e.operator))return`${u(e.left)} ${e.operator} ${u(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let r=e.right.value;"%"===r.charAt(0)&&(r=r.slice(1)),"%"===r.charAt(r.length-1)&&(r=r.slice(0,-1)),t+=`'${r.toLowerCase()}')`}return t}return a=!0,""};r=u(n.parseTree),a&&(r="")}let n="";n=b?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let s=!1;I&&(s=!0,n+=" WHERE ID(n) IN $ids"),r&&(n+=s?" AND":" WHERE",n+=` ${r}`),n+=" return ID(n)",b&&(n+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{n+=`, n.${e}`,o.push(e)})),a=new v.A(I?{openCypherQuery:n,bindParameters:{ids:I}}:{openCypherQuery:n})}const M=(await(0,g.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,a,r)).resultRowsStream.getReader();for(;;){const{done:e,value:r}=await M.read();if(e)break;const i=[];for(let e=0;e<r.length;e++){const t=r[e];let n=0,s=0;const a={properties:{}};for(a.id=t[n],n++,s++,b&&(a.originId=t[n],n++,s++,a.destinationId=t[n],n++,s++);n<t.length;n++)a.properties[o[n-s]]=t[n];i.push(a)}c=c.concat(n.writeToStore(i,f.dr,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return c}_isEndEntitySpatial(e,t,r){for(const n of e??[])if(this.entityTypeNames.has(n)){const e=this.geographicLookup.get(n),i=e&&this.sublayerCaches.get(n)?.get(t.attributes[r]);if(e&&i?.attributes[e.name])return!0}return!1}};(0,n._)([(0,u.MZ)()],_.prototype,"knowledgeGraph",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"inclusionModeDefinition",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"entityTypeNames",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"relationshipTypeNames",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"geographicLookup",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"sublayerCaches",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"nodeConnectionsLookup",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"relationshipConnectionsLookup",void 0),(0,n._)([(0,u.MZ)()],_.prototype,"memberIdTypeLookup",void 0),_=(0,n._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],_)},12345:function(e,t,r){r.d(t,{A:function(){return K}});var n=r(53804),i=(r(50917),r(90473)),s=(r(74865),r(1526),r(96173),r(52308),r(78002),r(30047),r(27777),r(61065),r(6537)),o=r(31315),a=r(21609),l=r(77793),u=(r(86027),r(23502)),c=(r(58941),r(40633),r(65953)),p=r(81392),d=r(72977),h=r(46157),f=r(57165),y=r(57652),m=r(20833),g=r(34794),v=r(75707),b=r(69619);r(13798);const w=(0,r(36073).p)(),_=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,n._)([(0,u.MZ)(w.fields)],t.prototype,"fields",void 0),(0,n._)([(0,u.MZ)(w.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,n._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var S=r(10143),I=r(1615),M=r(57767),T=r(19431),x=r(25353),A=r(70652),E=r(18195),L=r(85924),C=r(7010),N=r(93966),R=r(56740),O=r(53743),F=r(73520),k=r(79212),D=r(36143),P=r(51084),V=r(7926),Z=r(18950),G=r(50193),j=r(91484),z=r(44740),U=r(91508),q=r(45532),B=r(63319);function $(e){if(!e.json)return e;e.json.write=H(e.json.write);const t=e.json.origins;if(!t)return e;let r;for(r in t){const e=t[r];e&&(e.write=H(e.write))}return e}function H(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:r,overridePolicy:n,...i}=e;return function(e,t){const r=W.call(this,e,t);return r.enabled?{...i,...r}:r}}(e)),e):!0===e?J():e}function J(){return{overridePolicy:W}}function W(e,t){const r=!!this.geometryType;let n={enabled:r};return r&&(n={...n,...Y.call(this,e,t)}),n}function Y(e,t){return{ignoreOrigin:this.originIdOf(t)>d.Gr.DEFAULTS}}let Q=class extends(_((0,T.J)((0,M.F)((0,I.dM)((0,x.f)((0,L.e)((0,E.j)((0,A.J)((0,l.P)(m.A)))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=(0,b.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=S.dr,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new G.A(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const r=V.A.fromJSON(e);return this.queryFeaturesJSON(r,t)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const r="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(R.A.fromJSON({name:t.name,type:r,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(R.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),R.A.fromJSON({name:S.M1,type:"esriFieldTypeInteger",alias:S.M1,editable:!1}),R.A.fromJSON({name:S.BL,type:"esriFieldTypeInteger",alias:S.BL,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?B.g.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return S.T1;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,r=t?this.objectType?.properties?.[t]:null;return r?.hasZ??!1}set renderer(e){(0,O.yp)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):"link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?(0,s.r)((0,b.F0)(B.g.toJSON("polyline")).renderer):(0,s.r)((0,b.F0)(B.g.toJSON("point")).renderer):(0,s.r)((0,b.F0)(B.g.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??f.A.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return(0,Z.tn)(this,e)}createQuery(){return new V.A({where:"1=1",outFields:["*"]})}getField(e){for(let t=0;t<this.fields.length;t++)if(this.fields[t].name===e)return this.fields[t];return null}getFieldDomain(e,t){return null}async queryFeatures(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e),i=P.A.fromJSON(await n.executeQuery(r.toJSON(),t?.signal));return i.features.forEach((e=>{e.sourceLayer=this})),i}async queryFeaturesJSON(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e);return await n.executeQuery(r.toJSON(),t?.signal)}async queryFeatureCount(e,t){const{resolvedQuery:r,queryEngine:n}=await this._setupQueryObjects(e);return n.executeQueryForCount(r.toJSON(),t?.signal)}async queryExtent(e={},t){const r={...e,returnGeometry:!0},{resolvedQuery:n,queryEngine:i}=await this._setupQueryObjects(r),s=await i.executeQueryForExtent(n.toJSON(),t?.signal);let o;return o=null!=s.extent?.xmin&&null!=s.extent?.xmax&&null!=s.extent?.ymin&&null!=s.extent?.ymax?new j.default(s.extent):new j.default,{count:s.count,extent:o}}async queryObjectIds(e,t){const r=V.A.from(e);let n;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)n=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);n=this.loadQueryEngine(e)}return n.executeQueryForIds(r.toJSON(),t?.signal)}loadQueryEngine(e){const t=new g.A({geometryType:B.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),r=new v.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:B.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return r.featureStore.addMany(e),r}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new V.A({where:"1=1",outFields:[S.dr]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then((()=>{(0,O.sv)(this.timeInfo,this.fieldsIndex)}))),Promise.resolve(this)}async _setupQueryObjects(e,t){const r=V.A.from(e),n=r.geometry;let i;if(n&&!n.spatialReference?.isWGS84&&(await(0,h.initializeProjection)(n.spatialReference,y.KK),r.geometry=(0,h.project)(n instanceof z.A||n instanceof U.A||n instanceof q.default?n:n.extent,y.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)i=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(r,this,t);i=this.loadQueryEngine(e)}return{resolvedQuery:r,queryEngine:i}}};(0,n._)([(0,u.MZ)($((0,a.o8)(I.sU)))],Q.prototype,"blendMode",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"capabilities",void 0),(0,n._)([(0,u.MZ)({json:{origins:{"web-scene":{write:!1}},write:J()}})],Q.prototype,"charts",void 0),(0,n._)([(0,u.MZ)({readOnly:!0})],Q.prototype,"defaultPopupTemplate",null),(0,n._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],Q.prototype,"definitionExpression",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"displayField",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(I.LF)))],Q.prototype,"effect",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"elevationInfo",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(M.Y)))],Q.prototype,"featureEffect",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(N.d)))],Q.prototype,"featureReduction",null),(0,n._)([(0,u.MZ)()],Q.prototype,"fields",null),(0,n._)([(0,u.MZ)()],Q.prototype,"geometryType",null),(0,n._)([(0,u.MZ)()],Q.prototype,"geometryFieldName",null),(0,n._)([(0,u.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Q.prototype,"graphType",void 0),(0,n._)([(0,u.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],Q.prototype,"graphTypeName",null),(0,n._)([(0,u.MZ)()],Q.prototype,"hasM",null),(0,n._)([(0,u.MZ)()],Q.prototype,"hasZ",null),(0,n._)([(0,u.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],Q.prototype,"id",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.kF)))],Q.prototype,"labelsVisible",void 0),(0,n._)([(0,u.MZ)({type:[F.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:k.w,write:J()}})],Q.prototype,"labelingInfo",void 0),(0,n._)([(0,u.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Q.prototype,"layerType",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.fV)))],Q.prototype,"legendEnabled",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.hG)))],Q.prototype,"maxScale",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.hn)))],Q.prototype,"minScale",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"objectIdField",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"objectType",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.ke)))],Q.prototype,"opacity",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(x.n)))],Q.prototype,"orderBy",void 0),(0,n._)([(0,u.MZ)({clonable:!1})],Q.prototype,"parent",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"parentCompositeLayer",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(C.M6)))],Q.prototype,"popupEnabled",void 0),(0,n._)([(0,u.MZ)({type:i.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],Q.prototype,"popupTemplate",void 0),(0,n._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy:Y}}})],Q.prototype,"refreshInterval",void 0),(0,n._)([(0,u.MZ)({types:o.H,json:{name:"layerDefinition.drawingInfo.renderer",write:J()}})],Q.prototype,"renderer",null),(0,n._)([(0,u.MZ)()],Q.prototype,"source",void 0),(0,n._)([(0,u.MZ)()],Q.prototype,"spatialReference",null),(0,n._)([(0,u.MZ)({type:D.A,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],Q.prototype,"timeInfo",null),(0,n._)([(0,u.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],Q.prototype,"title",null),(0,n._)([(0,p.K)("title")],Q.prototype,"writeTitle",null),(0,n._)([(0,u.MZ)({json:{read:!1}})],Q.prototype,"type",void 0),(0,n._)([(0,u.MZ)($((0,a.o8)(L.B)))],Q.prototype,"useViewTime",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{name:"visibility",write:J()}})],Q.prototype,"visible",void 0),Q=(0,n._)([(0,c.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],Q);const K=Q},54709:function(e,t,r){r.d(t,{A:function(){return a}}),r(50917);var n=r(58081),i=r(65215),s=r(10143),o=r(74697);class a{constructor(){this._featureLookup=new Map}static getInstance(){return a.instance||(a.instance=new a),a.instance}static resetInstance(){a.instance&&(a.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const r=this.readFromStoreById(e);r&&t.push(r)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,r){const a=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let l,u=null;if(r&&e.properties[r]&&(u=(0,n.Ux)(e.properties[r])),"originId"in e&&"destinationId"in e&&(e.properties[s.Cz]=e.originId,e.properties[s.KQ]=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const n=this._featureLookup.get(e.id),s=JSON.parse(JSON.stringify(Object.assign(n.attributes,e.properties)));r&&e.properties[r]&&(s[r]=(0,o.rS)(e.properties[r])),l=new i.Om(u?JSON.parse(JSON.stringify(u)):n?.geometry?JSON.parse(JSON.stringify(n.geometry)):null,s,null,e.properties[t])}else l=new i.Om(u?JSON.parse(JSON.stringify(u)):null,e.properties,null,e.properties[t]);this._featureLookup.set(`${e.typeName?`${e.typeName}__${e.id}`:e.id}`,l),a.push(l)})),a}}},10143:function(e,t,r){r.d(t,{BL:function(){return u},Cz:function(){return s},KQ:function(){return o},M1:function(){return l},T1:function(){return a},dr:function(){return i},qN:function(){return d}});var n=r(71165);const i="ESRI__ID",s="ESRI__OriginID",o="ESRI__DestID",a="ESRI__LayoutGeometry",l="ESRI__AggregationCount",u="LC.ESRI__IsSpatial",c={initializeLayersFromClientData:async(e,t)=>{if(t||(t=[...e.layers,...e.tables].map((e=>e.graphTypeName))),0===t?.length)return;const r=new Map;for(const n of t)r.set(n,p(e,n));const i=await(0,n.fetchClientDataAtKeys)(e.dataManager.knowledgeGraph,Array.from(r.values()));for(const t of[...e.layers,...e.tables]){const r=t.objectType.name;if(null===r)continue;const n=i.get(p(e,r));if(n){const e=JSON.parse(n);null===e||"object"!=typeof e||e.hasOwnProperty("showLabels")||(e.showLabels=!1),t.read(e,{origin:"service"})}}}},p=(e,t)=>"knowledge-graph"===e.type?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function d(e,t){return c.initializeLayersFromClientData(e,t)}},38057:function(e,t,r){r.d(t,{DX:function(){return v},_s:function(){return w},aq:function(){return b},fe:function(){return _}}),r(50917),r(59469);var n,i,s,o,a=r(93040),l=(r(10748),r(39819)),u=r(25738),c=(r(19702),r(58081),r(10143),r(54709),r(20985),r(71165)),p=r(63288);r(57165),(i=n||(n={})).ELEMENTUID="ELEMENTUID",i.TYPENAME="TYPENAME",n.ELEMENTUID,n.TYPENAME,function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(s||(s={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(o||(o={}));var d,h,f,y,m,g=r(67147);function v(e){if(!e.spatialReference.isWGS84)throw new l.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}async function b(e,t){const r=[],n=new Map,i=[];if(t.dataModel?.relationshipTypes)for(const e of t.dataModel.relationshipTypes)e.name&&n.set(e.name,[]);for(const t of e)n.has(t.typeName)&&n.get(t.typeName)?.push(t.id);for(const[e,s]of n){if(s.length<1)continue;const n=new p.A({openCypherQuery:`MATCH (n)-[r:${e}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:s}});i.push((0,c.executeQueryStreaming)(t,n).then((async e=>{const t=e.resultRowsStream.getReader();for(;;){const{done:e,value:n}=await t.read();if(e)break;for(const e of n)r.push({id:e[0],typeName:e[1]}),r.push({id:e[2],typeName:e[3]})}})))}return await Promise.all(i),r}async function w(e,t){t??=!1;const r={generateAllSublayers:t,namedTypeDefinitions:new Map};return await async function(e){const t=await(0,a.A)(e,{responseType:"array-buffer"}),r=await t.data;return async function(e){const t=new((await(0,g.I)()).MapOfObjectIdentifierSetsDecoder),r=t.decode(new Uint8Array(e)),n=new Map;if(0!==r.error_code)throw new l.A("knowledge-graph:layer-support-utils",r.error_message);const i=t.get_map_of_identifier_sets(),s=i.keys,o=s.size();for(let e=0;e<o;e++){const t=s.get(e),r=i.query_identifier_set(t),o=[];if(r.id_array_type.value===y.GLOBALID_ARRAY){const e=r.get_globalid_array(),t=e.count();for(let r=0;r<t;r++)o.push(e.get_globalid_at(r))}else if(r.id_array_type.value===y.IDENTIFIER_ARRAY){const e=r.get_identifier_array(),t=e.count();for(let r=0;r<t;r++)o.push(e.get_identifier_at(r).toString())}else if(r.id_array_type.value===y.STRING_ARRAY){const e=r.get_string_array(),t=e.count();for(let r=0;r<t;r++)o.push(e.get_string_at(r))}else{if(r.id_array_type.value!==y.OID_ARRAY)throw new l.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=r.get_oid_array(),t=e.count();for(let r=0;r<t;r++)o.push(e.get_objectid_at(r).toString())}}n.set(t,o)}return t.delete(),n}(new Uint8Array(r))}(e).then((e=>{!function(e,t){for(const[r,n]of e){const e=(0,u.tE)(t.namedTypeDefinitions,r,(()=>({useAllData:!1,members:new Map})));for(const t of n)e.members.has(t)||e.members.set(t,{id:t})}}(e,r)})),r}async function _(e){const t=await(0,g.I)(),r=new t.MapOfObjectIdentifierSets;!function(e,t,r){for(const[n,i]of r.namedTypeDefinitions){if(!i.members||i.useAllData)continue;const r=i.members.keys();let s=!1,o=!0;const a=new t.ObjectIdArray,l=new t.StringArray,u=new t.GlobalIdArray,c=new t.IdentifierArray,p=new t.ObjectIdentifierSet;for(const e of r)o&&(s=!isNaN(Number(e)),o=!1),s?a.add_objectid(Number(e)):(l.add_string(e),u.add_globalid(e)),c.add_identifier(e);p.set_oid_array(a),p.set_string_array(l),p.set_globalid_array(u),p.set_identifier_array(c),a.delete(),l.delete(),u.delete(),c.delete(),e.put_identifier_set(n,p),p.delete()}}(r,t,e);const n=new t.MapOfObjectIdentifierSetsEncoder;try{n.set_map_of_identifier_sets(r),n.encode();const e=n.get_encoding_result();if(0!==e.error.error_code)throw new l.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return n.delete(),t}finally{r.delete()}}r(10361),(m=d||(d={}))[m.featureResult=0]="featureResult",m[m.countResult=1]="countResult",m[m.idsResult=2]="idsResult",function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(h||(h={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(f||(f={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(y||(y={})),r(38164),r(91508),r(8740),r(44740),r(90972),r(45532)},57767:function(e,t,r){r.d(t,{F:function(){return l},Y:function(){return a}});var n=r(53804),i=r(23502),s=(r(58941),r(40633),r(13798),r(65953));const o={write:{allowNull:!0}},a={type:r(71843).A,json:{origins:{"web-map":o,"portal-item":o}}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return(0,n._)([(0,i.MZ)(a)],t.prototype,"featureEffect",void 0),t=(0,n._)([(0,s.$)("esri.layers.mixins.FeatureEffectLayer")],t),t}},19431:function(e,t,r){r.d(t,{J:function(){return T}});var n=r(53804),i=(r(74865),r(1526),r(96173),r(52308),r(78002),r(30047),r(27777)),s=(r(61065),r(6537),r(40633)),o=r(28181),a=r(23502),l=r(58941),u=(r(13798),r(65953)),c=r(39763),p=r(93966),d=r(53096),h=r(59423),f=(r(10748),r(39819)),y=r(92709),m=r(23212),g=r(53871),v=r(90363);l.A.add("esri-cluster-arcade-enabled",!0);const b=(0,l.A)("esri-cluster-arcade-enabled"),w=new Set(["simple-line","simple-fill","picture-fill"]);function _(e,t){let r=t.clone();if(!S(r))return r;if(t.getSymbols().some((e=>w.has(e.type)))&&(r=new i.A({symbol:new v.A})),r.authoringInfo||(r.authoringInfo=new g.A),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const t=(r.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression));t.forEach((t=>{"rotation"===t.type?t.field?t.field=M(e,t.field,"avg_angle","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"avg_angle","number"),t.valueExpression=null):t.normalizationField?(t.field=M(e,t.field,"avg_norm","number",t.normalizationField),t.normalizationField=null):t.field?t.field=M(e,t.field,"avg","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"avg","number"),t.valueExpression=null)})),r.visualVariables=t}switch(r.type){case"simple":break;case"pie-chart":for(const t of r.attributes)t.field?t.field=M(e,t.field,"sum","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"sum","number"),t.valueExpression=null);break;case"unique-value":r.field?r.field=M(e,r.field,"mode","string"):r.valueExpression&&(r.field=I(e,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=M(e,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=M(e,r.field,"avg","number"):r.valueExpression&&(r.field=I(e,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const S=e=>{const t=t=>s.A.getLogger("esri.views.2d.layers.support.clusterUtils").error(new f.A("Unsupported-renderer",t,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const r=e.normalizationType;if("field"!==r)return t(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!b){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((e=>!(!("valueExpression"in e)||!e.valueExpression))))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function I(e,t,r,n){const i=(0,y.d)(t),s="mode"===r?`cluster_type_${i}`:"sum"===r?`cluster_sum_${i}`:`cluster_avg_${i}`;return e.some((e=>e.name===s))||e.push(new c.A({name:s,isAutoGenerated:!0,onStatisticExpression:new m.A({expression:t,returnType:n}),statisticType:r})),s}function M(e,t,r,n,i){if("cluster_count"===t||e.some((e=>e.name===t)))return t;const s=function(e,t,r){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const e=r,n="field",i=t.toLowerCase()+",norm:"+n+","+e.toLowerCase();return"cluster_avg_"+(0,y.d)(i)}}}(r,t,i);return e.some((e=>e.name===s))||("avg_norm"===r?e.push(new c.A({name:s,isAutoGenerated:!0,onStatisticExpression:new m.A({expression:`$feature.${t} / $feature.${i}`,returnType:n}),statisticType:"avg"})):e.push(new c.A({name:s,isAutoGenerated:!0,onStatisticField:t,statisticType:r}))),s}const T=e=>{let t=class extends e{constructor(...e){super(...e),this.addHandles((0,o.watch)((()=>this.renderer),(()=>{if(this.featureReduction){const e=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",e)}}),o.OH))}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}set renderer(e){}_withClusterVariable(e,t,r){const n=e.clone();return"visualVariables"in n&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.some((e=>"size"===e.type))||n.visualVariables.push(new d.A({field:"cluster_count",stops:[new h.A({value:1}),new h.A({useMinValue:!0,size:t}),new h.A({useMaxValue:!0,size:r})]}))),n}_normalizeFeatureReduction(e){if("cluster"!==e?.type)return e;const t=e.clone(),r=[new c.A({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(t.fields??[]).filter((e=>!e.isAutoGenerated)),s=e.renderer&&!e.renderer.authoringInfo?.isAutoGenerated,{clusterMinSize:o,clusterMaxSize:a}=t;if(s){t.fields=[...r,...n];const e=this._withClusterVariable(t.renderer,o,a);return t.effectiveFeatureRenderer=e,t.effectiveClusterRenderer=e,t}if(e.symbol){if(t.fields=[...r,...n],t.renderer=null,!this.renderer)return t.effectiveFeatureRenderer=null,t.effectiveClusterRenderer=null,t;const s=_(r,this.renderer),l=this._withClusterVariable(s,o,a),u="visualVariables"in l&&l.visualVariables?l.visualVariables:[],c=new i.A({symbol:e.symbol,visualVariables:u});return t.fields=[...r,...n],t.effectiveFeatureRenderer=l,t.effectiveClusterRenderer=c,t}if(!this.renderer)return e;const l=_(r,this.renderer);t.fields=[...r,...n],t.renderer=l;const u=this._withClusterVariable(l,o,a);return t.effectiveFeatureRenderer=u,t.effectiveClusterRenderer=u,t}};return(0,n._)([(0,a.MZ)(p.d)],t.prototype,"featureReduction",null),t=(0,n._)([(0,u.$)("esri.layers.mixins.FeatureReductionLayer")],t),t}},92078:function(e,t,r){r.d(t,{q:function(){return w}});var n=r(53804),i=r(39819),s=r(90683),o=r(23502),a=r(67888),l=(r(13798),r(58941),r(47332)),u=r(65953),c=r(81392),p=r(64786),d=r(97354),h=r(99495);const f={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},y={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},m={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},g={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":f,"web-map/basemap":y,"web-map/tables":m,"link-chart/operational-layers":{...f,LinkChartLayer:!0},"link-chart/basemap":y,"link-chart/tables":m,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0}};var v=r(7010),b=r(52038);const w=e=>{let t=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(e,t,r){return"Group Layer"===r?.portalItem?.type?void 0:e}writeListMode(e,t,r,n){(n&&"ground"===n.layerContainerType||e&&(0,h.R)(this,r,{},n))&&(t[r]=e)}writeOperationalLayerType(e,t,r,n){e&&"tables"!==n?.layerContainerType&&(t.layerType=e)}writeTitle(e,t){t.title=e??"Layer"}readTimeExtent(e){return e?b.A.fromArray(e):null}writeTimeExtent(e,t,r,n){e&&"tables"!==n.layerContainerType&&(e.isEmpty?n?.messages&&n.messages.push(new i.A("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):t[r]=e.toArray())}read(e,t){t&&(t.layer=this),(0,d.t)(this,e,(t=>super.read(e,t)),t)}write(e,t){if(!this.persistenceEnabled&&!t?.ignorePersistenceEnabled)return null;if(t?.origin){const e=`${t.origin}/${t.layerContainerType||"operational-layers"}`,r=g[e];let n=!!r?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(n=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===e&&(n=!1),!n)return t.messages?.push(new i.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const r=super.write(e,{...t,layer:this}),n=!!t&&!!t.messages&&!!t.messages.filter((e=>e instanceof i.A&&"web-document-write:property-required"===e.name)).length;return(0,s.w8)(r?.url)?(t?.messages?.push(new i.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:r}beforeSave(){}};return(0,n._)([(0,o.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),(0,n._)([(0,l.w)("id",["id"])],t.prototype,"readId",null),(0,n._)([(0,o.MZ)(v.C1)],t.prototype,"listMode",void 0),(0,n._)([(0,c.K)("listMode")],t.prototype,"writeListMode",null),(0,n._)([(0,o.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:p.K}}}}})],t.prototype,"operationalLayerType",void 0),(0,n._)([(0,c.K)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),(0,n._)([(0,o.MZ)(v.ke)],t.prototype,"opacity",void 0),(0,n._)([(0,o.MZ)({type:Boolean,readOnly:!1})],t.prototype,"persistenceEnabled",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),(0,n._)([(0,c.K)("title"),(0,c.K)(["web-scene"],"title")],t.prototype,"writeTitle",null),(0,n._)([(0,o.MZ)({type:b.A,json:{origins:{"web-scene":{write:{layerContainerTypes:p.K}}}}})],t.prototype,"visibilityTimeExtent",void 0),(0,n._)([(0,l.w)("visibilityTimeExtent")],t.prototype,"readTimeExtent",null),(0,n._)([(0,c.K)(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[a.jz,a.Uv]]}})],t.prototype,"writeTimeExtent",null),(0,n._)([(0,o.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:p.K}}},name:"visibility",write:!0}})],t.prototype,"visible",void 0),t=(0,n._)([(0,u.$)("esri.layers.mixins.OperationalLayer")],t),t}},25353:function(e,t,r){r.d(t,{f:function(){return u},n:function(){return l}});var n=r(53804),i=r(34194),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(41165);const l={type:[a.A],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function(e,t,r){if(!e)return null;const n=e.find((e=>!!e.field));if(!n)return null;const i=new a.A;return i.read(n,r),[i]}},write:{writer:function(e,t,r,n){const s=e.find((e=>!!e.field));s&&(0,i.sM)(r,[s.toJSON()],t)}}}},u=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return(0,n._)([(0,s.MZ)(l)],t.prototype,"orderBy",void 0),t=(0,n._)([(0,o.$)("esri.layers.mixins.OrderedLayer")],t),t}},70652:function(e,t,r){r.d(t,{J:function(){return b}});var n=r(53804),i=(r(58941),r(40633)),s=r(60539),o=r(23502),a=r(77560),l=(r(13798),r(65953)),u=r(64786),c=r(78879),p=r(28181),d=r(25638);const h=new c.A,f=new WeakMap;function y(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:y(t,e%t):0}let m=0,g=0;function v(){const e=Date.now();let t=!1;for(const r of h){const n=r.deref();n?n.refreshInterval&&e-(f.get(n)??0)+5>=6e4*n.refreshInterval&&(f.set(n,e),n.refresh(e)):t=!0}if(t)for(let e=h.length-1;e>=0;e--)h.at(e).deref()||h.removeAt(e)}(0,d.fm)((()=>{const e=Date.now();let t=0;for(const r of h){const n=r.deref();n&&(t=y(Math.round(6e4*n.refreshInterval),t),n.refreshInterval?f.get(n)||f.set(n,e):f.delete(n))}if(t!==g){if(g=t,clearInterval(m),0===g)return void(m=0);m=setInterval(v,g)}}),p.OH);const b=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,s.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||function(e){(function(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e})(e)&&h.push(new WeakRef(e))}(this)}),(()=>{}))}destroy(){!function(e){const t=h.find((t=>t.deref()===e));t&&h.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,s.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{i.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){}};return(0,n._)([(0,o.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,n._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,n._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},85924:function(e,t,r){r.d(t,{B:function(){return h},e:function(){return f}});var n=r(53804),i=r(23502),s=(r(58941),r(40633),r(13798),r(47332)),o=r(65953),a=r(64786),l=r(53743),u=r(36143),c=r(35060),p=r(52038),d=r(92427);const h={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:a.K}}},f=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const r=t.timeInfo.exportOptions;if(!r)return null;const n=r.timeOffset,i=c.j.fromJSON(r.timeOffsetUnits);return n&&i?new d.A({value:n,unit:i}):null}set timeInfo(e){(0,l.sv)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,n._)([(0,i.MZ)({type:p.A,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,n._)([(0,i.MZ)({type:d.A})],t.prototype,"timeOffset",void 0),(0,n._)([(0,s.w)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,n._)([(0,i.MZ)({value:null,type:u.A,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,n._)([(0,i.MZ)(h)],t.prototype,"useViewTime",void 0),t=(0,n._)([(0,o.$)("esri.layers.mixins.TemporalLayer")],t),t}},39763:function(e,t,r){r.d(t,{A:function(){return p}});var n,i=r(53804),s=r(30905),o=r(21609),a=r(23502),l=(r(58941),r(40633),r(65953)),u=r(23212);let c=n=class extends s.oY{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new n({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,o.o8)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],c.prototype,"isAutoGenerated",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"alias",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"onStatisticField",void 0),(0,i._)([(0,a.MZ)({type:u.A,json:{write:!0}})],c.prototype,"onStatisticExpression",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"statisticType",void 0),c=n=(0,i._)([(0,l.$)("esri.layers.support.AggregateField")],c);const p=c},23212:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(53804),i=r(75743),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(65953));let l=class extends((0,i.O)(s.oY)){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"expression",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"returnType",void 0),l=(0,n._)([(0,a.$)("esri.layers.support.ExpressionInfo")],l);const u=l},71843:function(e,t,r){r.d(t,{A:function(){return m}});var n,i=r(53804),s=r(39819),o=r(30905),a=r(34194),l=r(23502),u=(r(58941),r(40633),r(13798),r(65953)),c=r(60318),p=r(23812);const d={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.excludedEffect,isRequired:null==this.excludedEffect}}}},h={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.includedEffect,isRequired:null==this.includedEffect}}}},f={name:"showExcludedLabels",default:!0};let y=n=class extends o.oY{constructor(e){super(e),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(e,t){const r=super.write(e,t);if(t?.origin){if(r.filter){const e=Object.keys(r.filter);if(e.length>1||"where"!==e[0])return t.messages?.push(new s.A("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:t.layer,effect:this})),null}if("showExcludedLabels"in r)return t.messages?.push(new s.A("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:t.layer,effect:this})),null}return r}clone(){return new n({filter:null!=this.filter?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};(0,i._)([(0,l.MZ)({type:p.A,json:{write:{allowNull:!0,writer(e,t,r,n){const i=e?.write({},n);i&&0!==Object.keys(i).length?(0,a.sM)(r,i,t):(0,a.sM)(r,null,t)}}}})],y.prototype,"filter",void 0),(0,i._)([(0,l.MZ)({json:{read:c.LF,write:{writer:c.M9,allowNull:!0},origins:{"web-map":d,"portal-item":d}}})],y.prototype,"includedEffect",void 0),(0,i._)([(0,l.MZ)({json:{read:c.LF,write:{writer:c.M9,allowNull:!0},origins:{"web-map":h,"portal-item":h}}})],y.prototype,"excludedEffect",void 0),(0,i._)([(0,l.MZ)({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":f,"portal-item":f}}})],y.prototype,"excludedLabelsVisible",void 0),y=n=(0,i._)([(0,u.$)("esri.layers.support.FeatureEffect")],y);const m=y},23812:function(e,t,r){r.d(t,{A:function(){return m}});var n,i=r(53804),s=r(50917),o=r(73037),a=r(30905),l=r(21609),u=r(23502),c=(r(58941),r(40633),r(65953)),p=r(7926),d=r(52038);const h=new o.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),f=new o.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let y=n=class extends a.oY{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:r,spatialRelationship:n,timeExtent:i,objectIds:s,units:o,distance:a}=this;return new p.A({geometry:(0,l.o8)(r),objectIds:(0,l.o8)(s),spatialRelationship:n,timeExtent:(0,l.o8)(i),where:t,units:o,distance:a,...e})}clone(){const{where:e,geometry:t,spatialRelationship:r,timeExtent:i,objectIds:s,units:o,distance:a}=this;return new n({geometry:(0,l.o8)(t),objectIds:(0,l.o8)(s),spatialRelationship:r,timeExtent:(0,l.o8)(i),where:e,units:o,distance:a})}};(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],y.prototype,"where",void 0),(0,i._)([(0,u.MZ)({types:s.yR,json:{write:!0}})],y.prototype,"geometry",void 0),(0,i._)([(0,u.MZ)({type:h.apiValues,json:{name:"spatialRel",read:{reader:h.read},write:{allowNull:!1,writer:h.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],y.prototype,"spatialRelationship",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],y.prototype,"distance",void 0),(0,i._)([(0,u.MZ)({type:[Number],json:{write:!0}})],y.prototype,"objectIds",void 0),(0,i._)([(0,u.MZ)({type:f.apiValues,json:{read:f.read,write:{writer:f.write,overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],y.prototype,"units",void 0),(0,i._)([(0,u.MZ)({type:d.A,json:{write:!0}})],y.prototype,"timeExtent",void 0),y=n=(0,i._)([(0,c.$)("esri.layers.support.FeatureFilter")],y);const m=y},84189:function(e,t,r){r.d(t,{c:function(){return a}});var n=r(53804),i=r(30905),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953));let a=class extends i.oY{constructor(){super(...arguments),this.type=null}};(0,n._)([(0,s.MZ)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.$)("esri.layers.support.FeatureReduction")],a)},82043:function(e,t,r){r.d(t,{A:function(){return u}});var n,i=r(53804),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(84189);let l=n=class extends a.c{constructor(e){super(e),this.type="selection"}clone(){return new n}};(0,i._)([(0,s.MZ)({type:["selection"]})],l.prototype,"type",void 0),l=n=(0,i._)([(0,o.$)("esri.layers.support.FeatureReductionSelection")],l);const u=l},7103:function(e,t,r){r.d(t,{A:function(){return d}});var n=r(39819),i=r(30905),s=r(40633),o=r(25738),a=r(92955),l=r(53743),u=r(21168),c=r(96285);const p=new Map;class d{static fromJSON(e){return new d(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new d(e.fields??[],m(e))}static fromLayerJSON(e){return new d(e.fields??[],m(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const r=[];for(const e of this.fields){const t=e?.name,n=f(t);if(t&&n){const i=h(t);this._fieldsMap.set(t,e),this._fieldsMap.set(i,e),this._normalizedFieldsMap.set(n,e),r.push(`${i}:${e.type}:${this._timeZoneByFieldName?.get(t)}`),(0,l.vE)(e)?(this.dateFields.push(e),this._dateFieldsSet.add(e)):(0,l.WA)(e)&&(this._numericFieldsSet.add(e),this.numericFields.push(e)),(0,l.te)(e)||(0,l.Xz)(e)||(e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable)}}r.sort(),this.uid=r.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,l.te)(e)||(0,l.Xz)(e)||e.nullable||void 0!==(0,l.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(h(e))??this._normalizedFieldsMap.get(f(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(s.A.getLogger("esri.layers.support.FieldsIndex").error(new n.A("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),u.n$):y.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?a.GB.instance:t===u.n$?c.mQ.utcInstance:(0,o.tE)(p,t,(()=>c.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,l.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>(0,i.Wj)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function h(e){return e.trim().toLowerCase()}function f(e){return(0,l.rS)(e)?.toLowerCase()??""}const y=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function m(e){const t=new Map;if(!e.fields)return t;const r=!0===e.datesInUnknownTimezone,{timeInfo:n,editFieldsInfo:i}=e,s=(n?"startField"in n?n.startField:n.startTimeField:"")??"",o=(n?"endField"in n?n.endField:n.endTimeField:"")??"",a=function(e){return"dateFieldsTimeZone"in e}(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,u.ZS)(e.dateFieldsTimeReference):null,l=i?function(e){return"timeZone"in e}(i)?i.timeZone??a:i.dateFieldsTimeReference?(0,u.ZS)(i.dateFieldsTimeReference):a??u.n$:null,c=n?function(e){return"timeZone"in e}(n)?n.timeZone??a:n.timeReference?(0,u.ZS)(n.timeReference):a:null,p=new Map([[h(i?.creationDateField??""),l],[h(i?.editDateField??""),l],[h(s),c],[h(o),c]]);for(const{name:n,type:i}of e.fields)if(y.has(i))t.set(n,u.L5);else if("date"!==i&&"esriFieldTypeDate"!==i)t.set(n,null);else if(r)t.set(n,u.L5);else{const e=p.get(h(n??""))??a;t.set(n,e)}return t}},73520:function(e,t,r){r.d(t,{A:function(){return x}});var n,i=r(53804),s=r(10748),o=(r(58941),r(73037)),a=r(30905),l=r(21609),u=r(13520),c=r(23502),p=(r(40633),r(47332)),d=r(65953),h=r(81392),f=(r(13798),r(6361));let y=n=class extends a.oY{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?(0,f.mX)(t.value):e}writeExpression(e,t,r){null!=this.value&&(e=(0,f.mX)(this.value)),null!=e&&(t[r]=e)}clone(){return new n({expression:this.expression,title:this.title,value:this.value})}};(0,i._)([(0,c.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0}}})],y.prototype,"expression",void 0),(0,i._)([(0,p.w)("expression",["expression","value"])],y.prototype,"readExpression",null),(0,i._)([(0,h.K)("expression")],y.prototype,"writeExpression",null),(0,i._)([(0,c.MZ)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],y.prototype,"title",void 0),(0,i._)([(0,c.MZ)({json:{read:!1,write:!1}})],y.prototype,"value",void 0),y=n=(0,i._)([(0,d.$)("esri.layers.support.LabelExpressionInfo")],y);const m=y;var g,v=r(11432),b=r(74661),w=r(8404);const _=new o.J({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function S(e,t,r){return{enabled:!(0,v.TU)(r?.layer)}}function I(e){return!e||"service"!==e.origin&&!("map-image"===e.layer?.type)}function M(e){return!!function(e){return"map-image"===e?.type}(e)&&!!e.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}let T=g=class extends a.oY{static evaluateWhere(e,t){const r=(e,t,r)=>{switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;const n=e.split(" ");if(3===n.length)return r(t[n[0]],n[1],n[2]);if(7===n.length){const e=r(t[n[0]],n[1],n[2]),i=n[3],s=r(t[n[4]],n[5],n[6]);switch(i){case"AND":return e&&s;case"OR":return e||s}}return!1}catch(e){}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=b.Hk,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,t){const r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}writeLabelExpression(e,t,r){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=(0,f.D3)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const t=(0,f.tH)(this.labelExpressionInfo.expression);t&&(e="["+t+"]")}null!=e&&(t[r]=e)}writeLabelExpressionInfo(e,t,r,n){if(null==e&&null!=this.labelExpression&&I(n))e=new m({expression:this.getLabelExpressionArcade()});else if(!e)return;const i=e.toJSON(n);i.expression&&(t[r]=i)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return(0,f.XJ)(this)}getLabelExpressionArcade(){return(0,f.BI)(this)}getLabelExpressionSingleField(){return(0,f.rU)(this)}hash(){return JSON.stringify(this)}clone(){return new g({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:(0,l.o8)(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:(0,l.o8)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],T.prototype,"name",void 0),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:S}}}}})],T.prototype,"allowOverrun",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:S}}}}})],T.prototype,"deconflictionStrategy",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:{overridePolicy(e,t,r){return this.labelExpressionInfo&&"service"===r?.origin&&M(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],T.prototype,"labelExpression",void 0),(0,i._)([(0,p.w)("labelExpression")],T.prototype,"readLabelExpression",null),(0,i._)([(0,h.K)("labelExpression")],T.prototype,"writeLabelExpression",null),(0,i._)([(0,c.MZ)({type:m,json:{write:{overridePolicy:(e,t,r)=>function(e){return I(e)||M(e?.layer)}(r)?{allowNull:!0}:{enabled:!1}}}})],T.prototype,"labelExpressionInfo",void 0),(0,i._)([(0,h.K)("labelExpressionInfo")],T.prototype,"writeLabelExpressionInfo",null),(0,i._)([(0,c.MZ)({type:_.apiValues,json:{type:_.jsonValues,read:_.read,write:_.write}})],T.prototype,"labelPlacement",void 0),(0,i._)([(0,c.MZ)({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],T.prototype,"labelPosition",void 0),(0,i._)([(0,c.MZ)({type:Number})],T.prototype,"maxScale",void 0),(0,i._)([(0,h.K)("maxScale")],T.prototype,"writeMaxScale",null),(0,i._)([(0,c.MZ)({type:Number})],T.prototype,"minScale",void 0),(0,i._)([(0,h.K)("minScale")],T.prototype,"writeMinScale",null),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:S}}}}})],T.prototype,"repeatLabel",void 0),(0,i._)([(0,c.MZ)({type:Number,cast:u.cr,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:S}}}}})],T.prototype,"repeatLabelDistance",void 0),(0,i._)([(0,c.MZ)({types:s.em,json:{origins:{"web-scene":{types:s.Rv,write:w.oO,default:null}},write:w.oO,default:null}})],T.prototype,"symbol",void 0),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:!0}})],T.prototype,"useCodedValues",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],T.prototype,"where",void 0),T=g=(0,i._)([(0,d.$)("esri.layers.support.LabelClass")],T);const x=T},41165:function(e,t,r){r.d(t,{A:function(){return p}});var n,i=r(53804),s=r(73037),o=r(30905),a=r(23502),l=(r(58941),r(40633),r(13798),r(65953));const u=new s.J({asc:"ascending",desc:"descending"});let c=n=class extends o.oY{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new n({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"field",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],c.prototype,"valueExpression",void 0),(0,i._)([(0,a.MZ)({type:u.apiValues,json:{type:u.jsonValues,read:u.read,write:u.write}})],c.prototype,"order",void 0),c=n=(0,i._)([(0,l.$)("esri.layers.support.OrderByInfo")],c);const p=c},47558:function(e,t,r){r.d(t,{T:function(){return o}});var n=r(60539),i=r(85445),s=r(55213);class o{constructor(){this._tasks=new Array,this._runningTasks=(0,i.v)(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(0===this.length)return s.G;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,r){return++this._runningTasks.value,new Promise(((n,i)=>this._tasks.push(new a(n,i,e,t,r)))).finally((()=>--this._runningTasks.value))}unshift(e,t,r){return++this._runningTasks.value,new Promise(((n,i)=>this._tasks.unshift(new a(n,i,e,t,r)))).finally((()=>--this._runningTasks.value))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const r=(0,n.G4)(t.signal);if(r&&!t.abortCallback)t.reject((0,n.NK)());else{const i=r?t.abortCallback?.((0,n.NK)()):t.callback(e);(0,n.$X)(i)?i.then(t.resolve,t.reject):t.resolve(i)}}catch(e){t.reject(e)}return!0}cancelAll(){const e=(0,n.NK)();for(const t of this._tasks)if(t.abortCallback){const r=t.abortCallback(e);t.resolve(r)}else t.reject(e);this._tasks.length=0}}class a{constructor(e,t,r,n=void 0,i=void 0){this.resolve=e,this.reject=t,this.callback=r,this.signal=n,this.abortCallback=i}}},36143:function(e,t,r){r.d(t,{A:function(){return y}});var n=r(53804),i=r(75743),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(47332)),l=r(65953),u=r(81392),c=r(52038),p=r(92427),d=r(21168);function h(e,t){return p.A.fromJSON({value:e,unit:t})}let f=class extends((0,i.O)(s.oY)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,t){return t.timeExtent&&Array.isArray(t.timeExtent)&&2===t.timeExtent.length?c.A.fromArray(t.timeExtent):null}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=e.toArray():t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?h(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?h(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,n._)([(0,o.MZ)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],f.prototype,"cumulative",void 0),(0,n._)([(0,o.MZ)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],f.prototype,"endField",void 0),(0,n._)([(0,o.MZ)({type:c.A,json:{write:{enabled:!0,allowNull:!0}}})],f.prototype,"fullTimeExtent",void 0),(0,n._)([(0,a.w)("fullTimeExtent",["timeExtent"])],f.prototype,"readFullTimeExtent",null),(0,n._)([(0,u.K)("fullTimeExtent")],f.prototype,"writeFullTimeExtent",null),(0,n._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],f.prototype,"hasLiveData",void 0),(0,n._)([(0,o.MZ)({type:p.A,json:{write:{enabled:!0,allowNull:!0}}})],f.prototype,"interval",void 0),(0,n._)([(0,a.w)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],f.prototype,"readInterval",null),(0,n._)([(0,u.K)("interval")],f.prototype,"writeInterval",null),(0,n._)([(0,o.MZ)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],f.prototype,"startField",void 0),(0,n._)([(0,o.MZ)((0,d.P6)("timeReference",!0))],f.prototype,"timeZone",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],f.prototype,"trackIdField",void 0),(0,n._)([(0,o.MZ)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],f.prototype,"useTime",void 0),(0,n._)([(0,o.MZ)({type:[Date],json:{read:!1}})],f.prototype,"stops",void 0),f=(0,n._)([(0,l.$)("esri.layers.support.TimeInfo")],f);const y=f},79580:function(e,t,r){r.d(t,{$:function(){return n},P:function(){return i}});const n={supportsDate:!1,supportsFixedInterval:!1,supportsAutoInterval:!1,supportsFixedBoundaries:!1,supportedStatistics:void 0},i={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryBins:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryBins:n,query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},7010:function(e,t,r){r.d(t,{C1:function(){return M},Fm:function(){return w},Ih:function(){return b},M6:function(){return p},OZ:function(){return h},PY:function(){return c},Qo:function(){return m},Yj:function(){return y},fV:function(){return f},hG:function(){return I},hn:function(){return S},id:function(){return _},kF:function(){return d},ke:function(){return v},zQ:function(){return T}});var n=r(64786),i=r(91484),s=r(57165),o=r(60534),a=r(6422),l=r(92777),u=r(59798);const c={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:n.K}}},p={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,r){t[r]=!e}}}},d={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:n.K}}},h={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:o.w}}},f={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:n.K}}},y={value:null,type:a.A,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:n.K}}};function m(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const g={write:{enabled:!0,layerContainerTypes:n.K},read:!0},v={type:Number,json:{origins:{"web-document":g,"portal-item":{write:!0}}}},b={...v,json:{...v.json,origins:{"web-document":{...g,write:{enabled:!0,layerContainerTypes:n.K,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,r)=>r&&"service"!==r.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition?.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,u.D)(t.layerDefinition.drawingInfo.transparency):void 0:(0,u.D)(t.drawingInfo.transparency)}}},w={type:i.default,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const r=i.default.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(r.spatialReference=s.A.fromJSON(t.spatialReference)),r}}}},read:!1}},_={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},S={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:n.K}}},name:"layerDefinition.minScale",write:!0}},I={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:n.K}}},name:"layerDefinition.maxScale",write:!0}},M={json:{write:{ignoreOrigin:!0,layerContainerTypes:n.K},origins:{"web-map":{read:!1,write:!1}}}},T={type:l.A,json:{name:"attributeTableInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}}},23217:function(e,t,r){r.d(t,{Xl:function(){return I},ct:function(){return x},pc:function(){return z},hx:function(){return U},C$:function(){return H},PD:function(){return W},VZ:function(){return P},mm:function(){return E},VA:function(){return $},WP:function(){return L},iX:function(){return S},Nv:function(){return j},xd:function(){return K},GA:function(){return Q},jp:function(){return D},tG:function(){return Y},lV:function(){return C},B5:function(){return O},Ye:function(){return R},sg:function(){return N},hM:function(){return F},S2:function(){return k},jD:function(){return V},Zm:function(){return Z},$4:function(){return G},Pt:function(){return X},bt:function(){return T},rn:function(){return A},ZJ:function(){return ee}});var n=r(7156),i=r(10748),s=r(77472),o=r(39819),a=r(73037),l=r(98737),u=r(66110),c=r(51575),p=r(4210),d=r(86038),h=r(7926);async function f(e,t,r){t=t.clone(),e.capabilities.query.supportsMaxRecordCountFactor&&(t.maxRecordCountFactor=y(e));const n=function(e){return y(e)*function(e){return e.capabilities.query.maxRecordCount||2e3}(e)}(e),i=e.capabilities.query.supportsPagination;t.start=0,t.num=n;let s=null;for(;;){const o=await e.source.queryFeaturesJSON(t,r);if(null==s?s=o:s.features=s.features.concat(o.features),s.exceededTransferLimit=o.exceededTransferLimit,!i||!o.exceededTransferLimit)break;t.start+=n}return s}function y(e){return e.capabilities.query.supportsMaxRecordCountFactor?h.A.MAX_MAX_RECORD_COUNT_FACTOR:1}var m=r(53743),g=r(11432),v=r(27777),b=r(61065),w=r(42783),_=r(95470);const S=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function I(e,t,r,n){const i=await B(e);if(await M(e,t,n),!i.addAttachment)throw new o.A(n,"Layer source does not support addAttachment capability");return i.addAttachment(t,r)}function M(e,t,r){const{attributes:n}=t,{objectIdField:i}=e;return e.capabilities?.data?.supportsAttachment?t?n?i&&n[i]?Promise.resolve():Promise.reject(new o.A(r,`feature is missing the identifying attribute ${i}`)):Promise.reject(new o.A(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new o.A(r,"A feature is required to add/delete/update attachments")):Promise.reject(new o.A(r,"this layer doesn't support attachments"))}async function T(e,t,r,n,i){const s=await B(e);if(await M(e,t,i),!s.updateAttachment)throw new o.A(i,"Layer source does not support updateAttachment capability");return s.updateAttachment(t,r,n)}async function x(e,t,n){const{applyEdits:i}=await r.e(8104).then(r.bind(r,30269)),s=await e.load();let o=n;return"feature"===s.type&&s.infoFor3D&&null!=t.deleteFeatures&&null!=s.globalIdField&&(o={...o,globalIdToObjectId:await Q(s,t.deleteFeatures,s.globalIdField)}),i(s,s.source,t,n)}async function A(e,t,n){const{uploadAssets:i}=await r.e(8104).then(r.bind(r,30269)),s=await e.load();return i(s,s.source,t,n)}async function E(e,t,r,n){const i=await B(e);if(await M(e,t,n),!i.deleteAttachments)throw new o.A(n,"Layer source does not support deleteAttachments capability");return i.deleteAttachments(t,r)}async function L(e,t,r){const n=(await e.load({signal:t?.signal})).source;if(!n.fetchRecomputedExtents)throw new o.A(r,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(t)}async function C(e,t,r,n){t=w.A.from(t),await e.load();const i=e.source,s=e.capabilities;if(!s?.data?.supportsAttachment)throw new o.A(n,"this layer doesn't support attachments");const{attachmentTypes:a,objectIds:l,globalIds:u,num:c,size:p,start:d,where:h}=t;if(!s?.operations?.supportsQueryAttachments&&(a?.length>0||u?.length>0||p?.length>0||c||d||h))throw new o.A(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",t);if(!(l?.length||u?.length||h))throw new o.A(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",t);if(!i.queryAttachments)throw new o.A(n,"Layer source does not support queryAttachments capability",t);return i.queryAttachments(t)}async function N(e,t,r,n){const i=await B(e);if(!i.queryObjectIds)throw new o.A(n,"Layer source does not support queryObjectIds capability");return i.queryObjectIds(h.A.from(t)??e.createQuery(),r)}async function R(e,t,r,n){const i=await B(e);if(!i.queryFeatureCount)throw new o.A(n,"Layer source does not support queryFeatureCount capability");return i.queryFeatureCount(h.A.from(t)??e.createQuery(),r)}async function O(e,t,r,n){const i=await B(e);if(!i.queryExtent)throw new o.A(n,"Layer source does not support queryExtent capability");return i.queryExtent(h.A.from(t)??e.createQuery(),r)}async function F(e,t,r,n){const i=await B(e);if(!i.queryRelatedFeatures)throw new o.A(n,"Layer source does not support queryRelatedFeatures capability");return i.queryRelatedFeatures(_.default.from(t),r)}async function k(e,t,r,n){const i=await B(e);if(!i.queryRelatedFeaturesCount)throw new o.A(n,"Layer source does not support queryRelatedFeaturesCount capability");return i.queryRelatedFeaturesCount(_.default.from(t),r)}async function D(e){const t=e.source;if(t?.refresh)try{const{dataChanged:r,updates:n}=await t.refresh();if(null!=n&&(e.sourceJSON={...e.sourceJSON,...n},e.read(n,{origin:"service",url:e.parsedUrl})),r)return!0}catch{}if(e.definitionExpression)try{return(await(0,l.G)(e.definitionExpression,e.fieldsIndex)).hasDateFunctions}catch{}return!1}function P(e){const t=new h.A,r=e.capabilities?.data,n=e.capabilities?.query;t.historicMoment=e.historicMoment,t.gdbVersion=e.gdbVersion,t.returnGeometry=!0,n&&(t.compactGeometryEnabled=n.supportsCompactGeometry,t.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),r&&(r.supportsZ&&null!=e.returnZ&&(t.returnZ=e.returnZ),r.supportsM&&null!=e.returnM&&(t.returnM=e.returnM)),t.outFields=["*"];const{timeOffset:i,timeExtent:s}=e;return t.timeExtent=null!=i&&null!=s?s.offset(-i.value,i.unit):s||null,t.multipatchOption="multipatch"===e.geometryType?"xyFootprint":null,t}function V(e){const{globalIdField:t,fields:r}=e;if(t)return t;if(r)for(const e of r)if("esriFieldTypeGlobalID"===e.type)return e.name}function Z(e){const{objectIdField:t,fields:r}=e;if(t)return t;if(r)for(const e of r)if("esriFieldTypeOID"===e.type)return e.name}function G(e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}function j(e,t){const{subtypes:r,subtypeField:n}=e;if(!t?.attributes||!r?.length||!n)return null;const i=t.attributes[n];return null==i?null:r.find((e=>e.code===i))}function z(e,t){const{fieldsIndex:r,subtypeField:n}=e,{name:i,type:s}=r.get(t)??{};if(!i)return null;if((n&&r.get(n)?.name)===i&&e.subtypes?.length){const t=e.subtypes.map((e=>new p.H({code:q(e.code,s),name:e.name})));if(t?.length)return new d.A({codedValues:t})}return null}function U(e,t){const{fieldsIndex:r}=e,{name:n,type:i}=r.get(t)??{};if(!n)return null;if(("typeIdField"in e?r.get(e.typeIdField)?.name:null)===n&&"types"in e&&e.types?.length){const t=e.types.map((e=>new p.H({code:q(e.id,i),name:e.name})));return new d.A({codedValues:t})}return null}function q(e,t){return t?(0,m.yM)({type:t})&&"number"==typeof e?`${e}`:(0,m.R3)({type:t})&&"string"==typeof e?Number.parseInt(e,10):e:e}async function B(e){return(await e.load()).source}async function $(e,t,r){const i=e.parsedUrl?.path;i&&e.authenticationTriggerEvent===t&&await async function(e,t){if(!n.id)return;if(n.id.findCredential(e))return;let r;try{const i=await(0,g.wI)(e,t);i&&(r=await n.id.checkSignInStatus(`${i}/sharing`))}catch(e){}if(r)try{const r=null!=t?t.signal:null;await n.id.getCredential(e,{signal:r})}catch(e){}}(i,r)}function H(e){return!X(e)&&(e.userHasUpdateItemPrivileges||e.editingEnabled)}const J=(0,c.C)({types:i.xK});function W(e,t){if(e.defaultSymbol)return e.types?.length?new b.A({defaultSymbol:J(e.defaultSymbol,e,t),field:e.typeIdField,uniqueValueInfos:e.types.map((e=>({id:e.id,symbol:J(e.symbol,e,t)})))}):new v.A({symbol:J(e.defaultSymbol,e,t)})}function Y(e){let t=e.sourceJSON?.cacheMaxAge;if(!t)return!1;const r=e.editingInfo?.lastEditDate?.getTime();return null==r||(t*=1e3,Date.now()-r<t)}async function Q(e,t,r){if(null==t)return null;const n=[],{objectIdField:i}=e;if(t.forEach((e=>{let t=null;if("attributes"in e){const{attributes:n}=e;t={globalId:n[r],objectId:null!=n[i]&&-1!==n[i]?n[i]:null}}else t={globalId:e.globalId,objectId:null!=e.objectId&&-1!==e.objectId?e.objectId:null};null!=t.globalId&&(null!=t.objectId&&-1!==t.objectId||n.push(t.globalId))})),0===n.length)return null;const o=e.createQuery();o.where=n.map((e=>`${r}='${e}'`)).join(" OR "),o.returnGeometry=!1,o.outFields=[i,r],o.cacheHint=!1;const a=await(0,s.DZ)(f(e,o));if(!a.ok)return null;const l=new Map,c=a.value.features;for(const e of c){const t=e.attributes[r],n=e.attributes[i];null!=t&&null!=n&&-1!==n&&l.set((0,u.AG)(t),n)}return l}function K(e,t,r){if(!t||!r||!e)return null;const n=r.getAttribute(t);return null==n?null:e.find((e=>{const{id:t}=e;return null!=t&&t.toString()===n.toString()}))??null}function X(e){return e.sourceJSON?.isMultiServicesView||function(e){return!!e.sourceJSON?.capabilities?.toLowerCase().split(",").map((e=>e.trim())).includes("map")}(e)}function ee(e,t,r){const n=t?.queryBins;if(!n)throw new o.A(r,"Layer source does not support binning");switch(e.binParameters.type){case"auto-interval":if(!n.supportsAutoInterval)throw new o.A(r,"Layer source does not support auto-interval binning");break;case"date":if(!n.supportsDate)throw new o.A(r,"Layer source does not support date binning");break;case"fixed-boundaries":if(!n.supportsFixedBoundaries)throw new o.A(r,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!n.supportsFixedInterval)throw new o.A(r,"Layer source does not support fixed-interval binning")}const i=n?.supportedStatistics;if(e.outStatistics&&i){const t=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:n}of e.outStatistics){const e=t.get(n);if(e&&!i[e])throw new o.A(r,`Layer source does not support ${n} statistic type`)}}}},93966:function(e,t,r){r.d(t,{d:function(){return F}});var n,i=r(64786),s=r(84189),o=r(53804),a=r(90473),l=(r(74865),r(1526),r(96173),r(52308),r(78002),r(30047),r(27777)),u=(r(61065),r(6537)),c=r(31315),p=r(21609),d=r(34194),h=r(13520),f=r(23502),y=r(67888),m=r(74376),g=r(47332),v=r(65953),b=r(81392),w=r(39763),_=r(7010),S=r(23217),I=r(73520);let M=n=class extends s.c{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=(0,h.cr)("12px"),this.fields=[],this.renderer=null}writeFields(e,t,r){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,d.sM)(r,n,t)}readRenderer(e,t,r){const n=t.drawingInfo?.renderer;return n?(0,u.L)(n,t,r)??void 0:(0,S.PD)(t,r)}clone(){return new n({fields:(0,p.o8)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,p.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,p.o8)(this.popupTemplate),renderer:(0,p.o8)(this.renderer),binType:(0,p.o8)(this.binType),size:this.size})}};(0,o._)([(0,m.e)({binning:"binning"})],M.prototype,"type",void 0),(0,o._)([(0,m.e)({geohash:"geohash",square:"square"}),(0,f.MZ)({type:["geohash","square"]})],M.prototype,"binType",void 0),(0,o._)([(0,f.MZ)({type:Number,json:{write:!0}})],M.prototype,"fixedBinLevel",void 0),(0,o._)([(0,f.MZ)({type:[I.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],M.prototype,"labelingInfo",void 0),(0,o._)([(0,f.MZ)(_.kF)],M.prototype,"labelsVisible",void 0),(0,o._)([(0,f.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],M.prototype,"maxScale",void 0),(0,o._)([(0,f.MZ)(_.M6)],M.prototype,"popupEnabled",void 0),(0,o._)([(0,f.MZ)({type:a.A,json:{name:"popupInfo",write:!0}})],M.prototype,"popupTemplate",void 0),(0,o._)([(0,f.MZ)({cast:e=>"auto"===e?e:(0,y.GB)((0,h.cr)(e))})],M.prototype,"size",void 0),(0,o._)([(0,f.MZ)({type:[w.A],json:{write:!0}})],M.prototype,"fields",void 0),(0,o._)([(0,b.K)("fields")],M.prototype,"writeFields",null),(0,o._)([(0,f.MZ)({types:c.H,json:{write:{target:"drawingInfo.renderer"}}})],M.prototype,"renderer",void 0),(0,o._)([(0,g.w)("renderer",["drawingInfo.renderer"])],M.prototype,"readRenderer",null),M=n=(0,o._)([(0,v.$)("esri.layers.support.FeatureReductionBinning")],M);const T=M;var x,A=r(10748),E=r(30905);function L(e){return"simple"===e.type&&!e.visualVariables?.length}let C=x=class extends E.oY{constructor(e){super(e),this.type="cluster",this.clusterRadius=(0,h.cr)("80px"),this.clusterMinSize=(0,h.cr)("12px"),this.clusterMaxSize=(0,h.cr)("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(e,t,r){const n=t.drawingInfo?.renderer;return n?.authoringInfo?.isAutoGenerated?null:n?L(n)?null:(0,u.L)(n,t,r)??void 0:(0,S.PD)(t,r)}readSymbol(e,t,r){const n=t.drawingInfo?.renderer;if(n?.authoringInfo?.isAutoGenerated)return null;if(n&&L(n)){const e=(0,u.L)(n,t,r);return e?.symbol}return null}writeSymbol(e,t,r,n){const i=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||i){const r=new l.A({symbol:e});t.drawingInfo={renderer:r.write({},n)}}}writeFields(e,t,r){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,d.sM)(r,n,t)}readFields(e,t,r){return e.filter((e=>!e.isAutoGenerated)).map((e=>w.A.fromJSON(e)))}clone(){return new x({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,p.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,p.o8)(this.fields),maxScale:this.maxScale,renderer:(0,p.o8)(this.renderer),symbol:(0,p.o8)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,p.o8)(this.popupTemplate)})}};(0,o._)([(0,f.MZ)({type:["cluster"],readOnly:!0,json:{write:!0}})],C.prototype,"type",void 0),(0,o._)([(0,f.MZ)({cast:e=>"auto"===e?e:(0,y.GB)((0,h.cr)(e)),json:{write:!0}})],C.prototype,"clusterRadius",void 0),(0,o._)([(0,f.MZ)({type:Number,cast:h.cr,json:{write:!0}})],C.prototype,"clusterMinSize",void 0),(0,o._)([(0,f.MZ)({type:Number,cast:h.cr,json:{write:!0}})],C.prototype,"clusterMaxSize",void 0),(0,o._)([(0,f.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],C.prototype,"maxScale",void 0),(0,o._)([(0,f.MZ)(_.M6)],C.prototype,"popupEnabled",void 0),(0,o._)([(0,f.MZ)({type:a.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],C.prototype,"popupTemplate",void 0),(0,o._)([(0,f.MZ)({types:c.H,json:{write:{target:"drawingInfo.renderer"}}})],C.prototype,"renderer",void 0),(0,o._)([(0,g.w)("renderer",["drawingInfo.renderer"])],C.prototype,"readRenderer",null),(0,o._)([(0,f.MZ)({types:A.q8})],C.prototype,"symbol",void 0),(0,o._)([(0,g.w)("symbol",["drawingInfo.renderer"])],C.prototype,"readSymbol",null),(0,o._)([(0,b.K)("symbol")],C.prototype,"writeSymbol",null),(0,o._)([(0,f.MZ)({type:[I.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],C.prototype,"labelingInfo",void 0),(0,o._)([(0,f.MZ)(_.kF)],C.prototype,"labelsVisible",void 0),(0,o._)([(0,f.MZ)({type:[w.A],json:{write:!0}})],C.prototype,"fields",void 0),(0,o._)([(0,b.K)("fields")],C.prototype,"writeFields",null),(0,o._)([(0,g.w)("fields")],C.prototype,"readFields",null),C=x=(0,o._)([(0,v.$)("esri.layers.support.FeatureReductionCluster")],C);const N=C;var R=r(82043);const O={key:"type",base:s.c,typeMap:{cluster:N,binning:T}},F={types:{key:"type",base:s.c,typeMap:{selection:R.A,cluster:N,binning:T}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:O},"portal-item":{types:O},"web-scene":{types:{key:"type",base:s.c,typeMap:{selection:R.A}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:i.K}}}}}},36073:function(e,t,r){r.d(t,{p:function(){return l}});var n=r(58941),i=r(40633),s=r(56740),o=r(7103),a=r(53743);function l(){return{fields:{type:[s.A],value:null,set:function(e){if(e&&(0,n.A)("big-integer-warning-enabled")){const t=e.filter((e=>"big-integer"===e.type||"oid"===e.type&&(e.length||0)>=8));if(t.length){const e=t.map((e=>`'${e.name}'`)).join(", ");i.A.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${e}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return o.A.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e?.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e){const r=this.fieldsIndex?.has(t);r||i.A.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e})}return(0,a.DB)(this.fieldsIndex,e)}}}}},6361:function(e,t,r){r.d(t,{BI:function(){return m},D3:function(){return f},XJ:function(){return y},lc:function(){return h},mX:function(){return v},rU:function(){return g},tH:function(){return I}});var n=r(50944);const i="__begin__",s="__end__",o=new RegExp(i,"ig"),a=new RegExp(s,"ig"),l=new RegExp("^"+i,"i"),u=new RegExp(s+"$","i"),c='"',p=c+" + ",d=" + "+c;function h(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function f(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function y(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=h(e.labelExpression),t.type="conventional"),t}function m(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return v(t.expression);case"arcade":return t.expression}return null}function g(e){const t=y(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e?.match(b);return t?.[1].trim()||null}(t.expression);case"arcade":return I(t.expression)}return null}function v(e){let t;return e?(t=(0,n.HC)(e,(e=>i+'$feature["'+e+'"]'+s)),t=l.test(t)?t.replace(l,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(o,p).replaceAll(a,d)):t='""',t}const b=/^\s*\{([^}]+)\}\s*$/i,w=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,_=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,S=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function I(e){if(!e)return null;let t=w.exec(e)||_.exec(e);return t?t[1]||t[3]:(t=S.exec(e),t?t[2]:null)}},79212:function(e,t,r){r.d(t,{w:function(){return l},z:function(){return c}});var n=r(39819),i=r(40633),s=r(73520);const o=()=>i.A.getLogger("esri.layers.support.labelingInfo"),a=/\[([^[\]]+)\]/gi;function l(e,t,r){return e?e.map((e=>{const n=new s.A;if(n.read(e,r),n.labelExpression){const e=t.fields||t.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(a,((t,r)=>`[${function(e,t){if(!t)return e;const r=e.toLowerCase();for(let e=0;e<t.length;e++){const n=t[e].name;if(n.toLowerCase()===r)return n}return e}(r,e)}]`))}return n})):null}const u={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function c(e,t){const r=[];for(const i of e){const e=i.labelPlacement,s=u[t];if(!i.symbol)return o().warn("No ILabelClass symbol specified."),[];if(!s)return o().error(new n.A("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),[];if(s.includes(e))r.push(i);else{const n=s[0];e&&o().warn(`Found invalid label placement type ${e} for ${t}. Defaulting to ${n}`);const a=i.clone();a.labelPlacement=n,r.push(a)}}return r}},20985:function(e,t,r){r.d(t,{$C:function(){return y},Hh:function(){return o},J:function(){return l},Tu:function(){return h},Wg:function(){return f},Xq:function(){return g},i6:function(){return v},pM:function(){return d},tx:function(){return a},vJ:function(){return m}});var n=r(53216);let i,s=null;function o(){return i||(i=r.e(7019).then(r.bind(r,13441)).then((e=>e.l)).then((({default:e})=>e({locateFile:e=>(0,n.s)(`esri/libs/linkchartlayout/${e}`)}))).then((e=>{!function(e){s=e}(e)})),i)}var a,l,u,c,p,d,h,f,y,m,g,v,b,w;function _(e){const t=Object.keys(u).filter((e=>isNaN(parseInt(e,10)))).indexOf(e.timeDirection),r=Object.keys(c).filter((e=>isNaN(parseInt(e,10)))).indexOf(e.eventsTicksVisualization);return{timeDirection:{value:t>-1?t:u.right},timeBannerUTCOffsetInMinutes:e.timeBannerUTCOffsetInMinutes,eventsTicksVisualization:{value:r>-1?r:c.startAndEnd},showDurationLineForNonZeroDurationEntityEvents:e.showDurationLineForNonZeroDurationEntityEvents,durationLineWidth:e.durationLineWidth,entityPositionAtDurationRatio:e.entityPositionAtDurationRatio,showNonZeroDurationIntervalBounds:e.showNonZeroDurationIntervalBounds,separateTimeOverlaps:e.separateTimeOverlaps,separateTimelineOverlaps:e.separateTimelineOverlaps,moveFirstBends:e.moveFirstBends,secondBendRatio:e.secondBendRatio,lineSeparationMultiplier:e.lineSeparationMultiplier,spaceSeparatedLinesEvenly:e.spaceSeparatedLinesEvenly,useBezierCurves:e.useBezierCurves,separatedLineShapeRatio:e.separatedLineShapeRatio}}function S(e,t,r,n,i,o){const a=r.length,l=i.length,u=Float64Array.BYTES_PER_ELEMENT,c=Uint32Array.BYTES_PER_ELEMENT,p=Uint8Array.BYTES_PER_ELEMENT,d=16+a*(p+2*u)+l*(2*c),h=s._malloc(d);try{const p=h+16-h%16,d=p+a*u,f=d+a*u,y=f+l*c,m=y+l*c,g=()=>[s.HEAPF64.subarray(p>>3,(p>>3)+a),s.HEAPF64.subarray(d>>3,(d>>3)+a),s.HEAPU32.subarray(f>>2,(f>>2)+l),s.HEAPU32.subarray(y>>2,(y>>2)+l),s.HEAPU8.subarray(m,m+a)],[v,b,w,_,S]=g();v.set(r),b.set(n),w.set(i),_.set(o),S.set(t);let I=e(a,m,p,d,l,f,y),M=null,T=null;if(I){const e=s.getLayoutLinksTypes(),t=s.getLayoutLinksVerticesEndIndices(),r=s.getLayoutLinksVertices(),n=s.countLayoutLinksVertices();!l||e&&t?n&&!r?I=!1:(M={types:new Uint8Array(s.HEAPU8.subarray(e,e+l)),vertexEndIndex:new Uint32Array(s.HEAPU32.subarray(t>>2,(t>>2)+l)),vertices:new Float64Array(s.HEAPF64.subarray(r>>3,(r>>3)+2*n))},T=s.getAuxiliaryGraphicElements()):I=!1}const[x,A,E,L,C]=g();return r.set(x),n.set(A),i.set(E),o.set(L),t.set(C),{success:I,links:M,graphics:T}}finally{s._free(h),s.cleanupLayout()}}(p=a||(a={}))[p.None=0]="None",p[p.IsMovable=1]="IsMovable",p[p.IsGeographic=2]="IsGeographic",p[p.IsRoot=4]="IsRoot",p[p.IsOld=8]="IsOld",function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(l||(l={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(u||(u={})),function(e){e[e.none=0]="none",e[e.startOnly=1]="startOnly",e[e.startAndEnd=2]="startAndEnd"}(c||(c={})),function(e){e.getMinIdealEdgeLength=function(){return s.getMinIdealEdgeLength()},e.apply=function(e,t,r,n,i,o=2,a=1,l=-1){return S(((e,t,r,n,i,u,c)=>s.applyForceDirectedLayout(e,t,r,n,i,u,c,o,a,l)),e,t,r,n,i)}}(d||(d={})),function(e){e.apply=function(e,t,r,n,i,o=2,a=1,l=-1){return S(((e,t,r,n,i,u,c)=>s.applyCommunityLayout(e,t,r,n,i,u,c,o,a,l)),e,t,r,n,i)}}(h||(h={})),function(e){e.apply=function(e,t,r,n,i){return S(s.applySimpleLayout,e,t,r,n,i)}}(f||(f={})),function(e){e.apply=function(e,t,r,n,i){return S(s.applyHierarchicalLayout,e,t,r,n,i)}}(y||(y={})),function(e){e.apply=function(e,t,r,n,i){return S(s.applyRadialTreeLayout,e,t,r,n,i)}}(m||(m={})),function(e){e.apply=function(e,t,r,n,i){return S(s.applySmartTreeLayout,e,t,r,n,i)}}(g||(g={})),function(e){e.apply=function(e,t,r,n,i,o,a,l,p,d,h){const f={timeDirection:u.right,timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:c.startAndEnd,showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0};return S(((e,t,r,o,a,u,c)=>{if(n.length!==e)return!1;if(i.length!==e)return!1;if(l.length!==a)return!1;if(p.length!==a)return!1;const y=Float64Array.BYTES_PER_ELEMENT,m=16,g=s._malloc(m+e*y),v=s._malloc(m+e*y),b=s._malloc(m+a*y),w=s._malloc(m+a*y),S=g+m-g%m,I=v+m-v%m,M=b+m-b%m,T=w+m-w%m;try{s.HEAPF64.subarray(S>>3,(S>>3)+e).set(n),s.HEAPF64.subarray(I>>3,(I>>3)+e).set(i),s.HEAPF64.subarray(M>>3,(M>>3)+a).set(l),s.HEAPF64.subarray(T>>3,(T>>3)+a).set(p);const y=_(Object.assign(f,h));return s.applyChronologicalLayout(e,t,r,o,S,I,a,u,c,M,T,d,y)}finally{s._free(g),s._free(v),s._free(b),s._free(w)}}),e,t,r,o,a)}}(v||(v={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(b||(b={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(w||(w={}))},35060:function(e,t,r){r.d(t,{j:function(){return n}});const n=(0,r(73037).O)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},74865:function(e,t,r){r.d(t,{A:function(){return E}});var n,i=r(53804),s=r(10748),o=r(73037),a=r(21609),l=r(40633),u=r(23502),c=r(77560),p=r(74376),d=r(47332),h=r(65953),f=r(81392),y=r(67888),m=r(53743),g=r(30047),v=r(29970),b=r(23879),w=r(85336),_=r(16986),S=r(54547);const I="percent-of-total",M="field",T=new o.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:I,esriNormalizeByField:M}),x=(0,y.dp)(b.A);let A=n=class extends((0,v.h)(g.A)){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,r){if(!Array.isArray(e))return;let n=t.minValue;return e.map((e=>{const t=new b.A;return t.read(e,r),null==t.minValue&&(t.minValue=n),null==t.maxValue&&(t.maxValue=t.minValue),n=t.maxValue,t}))}writeClassBreakInfos(e,t,r,n){const i=e.map((e=>e.write({},n)));this._areClassBreaksConsecutive()&&i.forEach((e=>delete e.classMinValue)),t[r]=i}castField(e){return null==e?e:"function"==typeof e?(l.A.getLogger(this).error(".field: field must be a string value"),null):(0,y.GX)(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,r=null!=this.normalizationTotal;return t||r?(e=t&&M||r&&I||null,t&&r&&l.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==M&&e!==I||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,r){let n=null;n="number"==typeof e?new b.A({minValue:e,maxValue:t,symbol:(0,s.dp)(r)}):x((0,a.o8)(e)),this.classBreakInfos.push(n),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const r=this.classBreakInfos.length;for(let n=0;n<r;n++){const r=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(r[0]===e&&r[1]===t){this.classBreakInfos.splice(n,1);break}}}getBreakIndex(e,t){return this.valueExpression&&null==t?.arcade&&l.A.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let r=t;this.valueExpression&&null==t?.arcade&&(r={...r,arcade:await(0,S.lw)()});const n=this.getBreakIndex(e,r);return-1!==n?this.classBreakInfos[n]:null}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void l.A.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(e,t);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let r=t;if(this.valueExpression&&null==t?.arcade){const e=await(0,S.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),r={...r,arcade:e}}const n=this.getBreakIndex(e,r);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new n({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:(0,a.o8)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:(0,a.o8)(this.visualVariables),legendOptions:(0,a.o8)(this.legendOptions),authoringInfo:(0,a.o8)(this.authoringInfo)})}async collectRequiredFields(e,t){const r=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(r)}async collectSymbolFields(e,t){const r=[...this.getSymbols().map((r=>r.collectRequiredFields(e,t))),(0,m.Dx)(e,t,this.valueExpression)];(0,m.rq)(e,t,this.field),(0,m.rq)(e,t,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(e,t){const{viewingMode:r,scale:n,spatialReference:i,arcade:s,timeZone:o}=t??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=s.arcadeUtils;if(!l){const e=u.createSyntaxTree(a);l=u.createFunction(e),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(e,u.getViewInfo({viewingMode:r,scale:n,spatialReference:i}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(e){const t=this.field,r=e.attributes,n=this.normalizationType;let i=parseFloat(r[t]);if(n){const e=this.normalizationTotal,t=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if("log"===n)i=Math.log(i)*Math.LOG10E;else if(n!==I||null==e||isNaN(e)){if(n===M&&!isNaN(t)){if(isNaN(i)||isNaN(t))return-1;i/=t}}else i=i/e*100}return this._getBreakIndexfromInfos(i)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let r=0;r<this.classBreakInfos.length;r++){const n=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(n[0]<=e&&(t?e<=n[1]:e<n[1]))return r}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let r=1;r<t;r++)if(e[r-1].maxValue!==e[r].minValue)return!1;return!0}};(0,i._)([(0,u.MZ)(w.As)],A.prototype,"backgroundFillSymbol",void 0),(0,i._)([(0,u.MZ)({type:[b.A]})],A.prototype,"classBreakInfos",void 0),(0,i._)([(0,d.w)("classBreakInfos")],A.prototype,"readClassBreakInfos",null),(0,i._)([(0,f.K)("classBreakInfos")],A.prototype,"writeClassBreakInfos",null),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"defaultLabel",void 0),(0,i._)([(0,u.MZ)(w.z4)],A.prototype,"defaultSymbol",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"field",void 0),(0,i._)([(0,c.w)("field")],A.prototype,"castField",null),(0,i._)([(0,u.MZ)({type:Boolean})],A.prototype,"isMaxInclusive",void 0),(0,i._)([(0,u.MZ)({type:_.A,json:{write:!0}})],A.prototype,"legendOptions",void 0),(0,i._)([(0,u.MZ)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],A.prototype,"minValue",null),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"normalizationField",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{write:!0}})],A.prototype,"normalizationTotal",void 0),(0,i._)([(0,u.MZ)({type:T.apiValues,value:null,json:{type:T.jsonValues,read:T.read,write:T.write}})],A.prototype,"normalizationType",null),(0,i._)([(0,p.e)({classBreaks:"class-breaks"})],A.prototype,"type",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"valueExpression",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"valueExpressionTitle",void 0),A=n=(0,i._)([(0,h.$)("esri.renderers.ClassBreaksRenderer")],A);const E=A},1526:function(e,t,r){r.d(t,{A:function(){return C}});var n=r(53804),i=r(21609),s=r(23502),o=(r(58941),r(40633)),a=r(65953),l=r(81392),u=r(53743),c=r(30047),p=r(29970),d=r(52874),h=r(93040),f=r(39819),y=r(99680),m=r(60539),g=r(58009),v=r(74697),b=r(7103),w=r(54547),_=r(38164),S=r(67895),I=r(7590);const M="esri.renderers.support.DictionaryLoader",T={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class x{constructor(e,t,r){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new y.q(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=t,this.fieldMap=r}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,t){let r;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(t));try{r=await this._dictionaryPromise}catch(e){if((0,m.zf)(e))return this._dictionaryPromise=null,null}const n=this._dictionaryVersion?.greaterEqual(4,0),i={};if(this.fieldMap)for(const t of this._symbolFields){const r=(0,I.MO)(this.fieldMap[t],this._fieldIndex);if(r){const s=e.attributes[r];i[t]=n?s:null!=s?""+e.attributes[r]:""}else i[t]=""}let s=null;try{s=r?.(i,t)}catch(e){return null}if(!s||"string"!=typeof s||"invalid"===s)return null;const o=s.split(";"),a=[],l=[];for(let t=0;t<o.length;t++){const r=o[t];if(r)if(r.includes("po:")){const t=r.slice(3).split("|");if(3===t.length){const r=t[0],n=t[1];let i=t[2];const s="countrylabel";if(r===s&&"TextString"===n){if(null!=this.fieldMap){let t=this.fieldMap[s];null==t&&(t=s,this.fieldMap[t]=t),e.attributes[t]=i}continue}if("DashTemplate"===n)i=i.split(" ").map((e=>Number(e)));else if("Color"===n){const e=new d.A(i).toRgba();i=[e[0],e[1],e[2],255*e[3]]}else i=Number(i);l.push({primitiveName:r,propertyName:n,value:i,defaultValue:null})}}else if(r.includes("|")){for(const e of r.split("|"))if(this._itemNames.has(e)){a.push(e);break}}else if(this._itemNames.has(r))a.push(r);else if(0===t){a.length=0;let t="Invalid_P";null!=e.geometry&&((0,v.Bi)(e.geometry)?t="Invalid_A":(0,v.Rg)(e.geometry)&&(t="Invalid_L")),a.push(t);break}}const u=null==e.geometry||!e.geometry.hasZ&&"point"===e.geometry.type;return this._cimPartsToCIMSymbol(e,a,l,u,t)}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void o.A.getLogger(M).error("no valid URL!");const t=(0,h.A)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=e?e.signal:null}),[{data:r}]=await Promise.all([t,(0,w.lw)()]);if(!r)throw this._dictionaryPromise=null,new f.A("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:i,expression:s,itemsNames:a}=r,l=s;let u=!1;i&&(this._dictionaryVersion=g.R.parse(i),u=this._dictionaryVersion.greaterEqual(4,0)),this._refSymbolUrlTemplate=this.url+"/"+r.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=n.symbol;const c={};if(this.config){const e=this.config;for(const t in e)c[t]=e[t]}if(n.configuration)for(const e of n.configuration)c.hasOwnProperty(e.name)||(c[e.name]=e.value);const p=[];if(e?.fields&&this.fieldMap)for(const t in this.fieldMap){const r=this.fieldMap[t],n=e.fields.filter((e=>e.name.toLowerCase()===r?.toLowerCase()));n.length>0&&p.push({...n[0],type:u?n[0].type:"esriFieldTypeString"})}p.length>0&&(this._fieldIndex=new b.A(p));const d=(0,w.xR)(l,null!=e?e.spatialReference:null,p,c).then((e=>{const t={scale:0};return(r,n)=>{if(null==e)return null;const i=e.repurposeFeature({geometry:null,attributes:r});return t.scale=null!=n?n.scale??void 0:void 0,e.evaluate({$feature:i,$view:t},e.services)}})).catch((e=>(o.A.getLogger(M).error("Creating dictionary expression failed:",e),null)));return this._dictionaryPromise=d,d}async _cimPartsToCIMSymbol(e,t,r,n,s){const o=new Array(t.length);for(let e=0;e<t.length;e++)o[e]=this._getSymbolPart(t[e],s);let a=await Promise.all(o);const l=this.fieldMap;if(l){a=(0,i.o8)(a);for(const t of a)S.$.applyDictionaryTextOverrides(t,e,l,this._fieldIndex,(0,I.bs)(t))}return new _.A({data:A(a,r,n)})}async _getSymbolPart(e,t){const r=this._symbolCache.get(e);if(r)return r;if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),i=(0,h.A)(n,{responseType:"json",query:{f:"json"},...t});this._ongoingRequests.set(e,i),i.finally((()=>this._ongoingRequests.delete(e)));try{const t=await i;return this._symbolCache.put(e,t.data),t.data}catch(e){throw e}}}function A(e,t,r){if(!e||0===e.length)return null;const n={...e[0]};if(e.length>1){n.effects=null,n.symbolLayers=[];for(const t of e){const e=t;if(null!=e.effects)for(const t of e.symbolLayers)null==t.effects?t.effects=e.effects:t.effects.unshift(...e.effects);n.symbolLayers.unshift(...e.symbolLayers)}}return r&&(n.callout=T),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:t}}var E;let L=E=class extends((0,p.h)(c.A)){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new x(this.url,this.config,this.fieldMap)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,r,n){n?.origin||super.writeVisualVariables(e,t,r,n)}clone(){return new E({config:(0,i.o8)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:(0,i.o8)(this.fieldMap),url:(0,i.o8)(this.url),visualVariables:(0,i.o8)(this.visualVariables)})}async getSymbolAsync(e,t){return this._loader.getSymbolAsync(e,t)}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await(0,u.Dx)(e,t,this.scaleExpression);for(const r in this.fieldMap){const n=this.fieldMap[r];t.has(n)&&e.add(n)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};(0,n._)([(0,s.MZ)({type:x})],L.prototype,"_loader",null),(0,n._)([(0,s.MZ)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],L.prototype,"config",void 0),(0,n._)([(0,s.MZ)({type:Object,json:{write:!0}})],L.prototype,"fieldMap",void 0),(0,n._)([(0,s.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],L.prototype,"scaleExpression",void 0),(0,n._)([(0,l.K)("scaleExpression")],L.prototype,"writeData",null),(0,n._)([(0,s.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],L.prototype,"scaleExpressionTitle",void 0),(0,n._)([(0,s.MZ)({type:String,json:{write:!0}})],L.prototype,"url",void 0),(0,n._)([(0,l.K)("visualVariables")],L.prototype,"writeVisualVariables",null),L=E=(0,n._)([(0,a.$)("esri.renderers.DictionaryRenderer")],L);const C=L},96173:function(e,t,r){r.d(t,{A:function(){return _}});var n,i=r(53804),s=r(52874),o=r(21609),a=r(23502),l=(r(58941),r(40633),r(74376)),u=r(65953),c=r(53743),p=r(30047),d=r(29970),h=r(19563),f=r(30905);r(13798);let y=n=class extends f.oY{constructor(){super(...arguments),this.unit=null}clone(){return new n({unit:this.unit})}};(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"unit",void 0),y=n=(0,i._)([(0,u.$)("esri.renderers.support.DotDensityLegendOptions")],y);const m=y;var g,v=r(8740),b=r(22198);let w=g=class extends((0,d.h)(p.A)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new s.A([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new b.A,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new v.A({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new g({attributes:(0,o.o8)(this.attributes),backgroundColor:(0,o.o8)(this.backgroundColor),dotBlendingEnabled:(0,o.o8)(this.dotBlendingEnabled),dotShape:(0,o.o8)(this.dotShape),dotSize:(0,o.o8)(this.dotSize),dotValue:(0,o.o8)(this.dotValue),legendOptions:(0,o.o8)(this.legendOptions),outline:(0,o.o8)(this.outline),referenceScale:(0,o.o8)(this.referenceScale),seed:(0,o.o8)(this.seed),visualVariables:(0,o.o8)(this.visualVariables),authoringInfo:(0,o.o8)(this.authoringInfo)})}getControllerHash(){const e=this.attributes?.map((e=>e.field||e.valueExpression||""));return`${e}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const r of this.attributes??[])r.valueExpression&&await(0,c.Dx)(e,t,r.valueExpression),r.field&&e.add(r.field)}};(0,i._)([(0,a.MZ)({type:[h.A],json:{write:!0}})],w.prototype,"attributes",void 0),(0,i._)([(0,a.MZ)({type:s.A,json:{write:!0}})],w.prototype,"backgroundColor",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],w.prototype,"dotBlendingEnabled",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!1}})],w.prototype,"dotShape",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],w.prototype,"dotSize",void 0),(0,i._)([(0,a.MZ)({type:m,json:{write:!0}})],w.prototype,"legendOptions",void 0),(0,i._)([(0,a.MZ)({type:b.A,json:{default:null,write:!0}})],w.prototype,"outline",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],w.prototype,"dotValue",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],w.prototype,"referenceScale",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],w.prototype,"seed",void 0),(0,i._)([(0,l.e)({dotDensity:"dot-density"})],w.prototype,"type",void 0),w=g=(0,i._)([(0,u.$)("esri.renderers.DotDensityRenderer")],w);const _=w},52308:function(e,t,r){r.d(t,{A:function(){return S}});var n=r(53804),i=r(52874),s=(r(10748),r(21609)),o=r(13520),a=r(23502),l=(r(58941),r(40633),r(74376)),u=r(65953),c=r(53743),p=r(30047),d=r(53871),h=r(27419),f=r(75743),y=r(30905);r(13798);let m=class extends((0,f.O)(y.oY)){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"minLabel",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"maxLabel",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"title",void 0),m=(0,n._)([(0,u.$)("esri.renderers.support.HeatmapLegendOptions")],m);var g,v=r(70181),b=r(90363);function w(e){if(null!=e){const{maxDensity:t,minDensity:r,radius:n}=e;if(null!=t||null!=r||null!=n){const{blurRadius:t,maxPixelIntensity:r,minPixelIntensity:n,...i}=e;return i}}return e}let _=g=class extends p.A{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new h.A({ratio:0,color:new i.A("rgba(255, 140, 0, 0)")}),new h.A({ratio:.75,color:new i.A("rgba(255, 140, 0, 1)")}),new h.A({ratio:.9,color:new i.A("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(e){return w(e)}get blurRadius(){return(0,v.PU)(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",(0,v.zp)(e)),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(v.ex**2*this.blurRadius**4)}read(e,t){e=w(e),super.read(e,t)}getSymbol(){return new b.A}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const r=this.field,n=this.valueExpression;r&&"string"==typeof r&&(0,c.rq)(e,t,r),n&&"string"==typeof n&&await(0,c.Dx)(e,t,n)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new g({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:(0,s.o8)(this.colorStops),field:this.field,legendOptions:(0,s.o8)(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,n._)([(0,a.MZ)({type:d.A,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],_.prototype,"authoringInfo",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],_.prototype,"blurRadius",null),(0,n._)([(0,a.MZ)({type:[h.A],json:{write:!0}})],_.prototype,"colorStops",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],_.prototype,"field",void 0),(0,n._)([(0,a.MZ)({type:m,json:{write:!0}})],_.prototype,"legendOptions",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{write:!0}})],_.prototype,"maxDensity",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],_.prototype,"maxPixelIntensity",null),(0,n._)([(0,a.MZ)({type:Number,json:{write:!0}})],_.prototype,"minDensity",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],_.prototype,"minPixelIntensity",null),(0,n._)([(0,a.MZ)({type:Number,cast:o.cr,json:{write:!0}})],_.prototype,"radius",void 0),(0,n._)([(0,a.MZ)({type:Number,range:{min:0},json:{default:0,write:!0}})],_.prototype,"referenceScale",void 0),(0,n._)([(0,l.e)({heatmap:"heatmap"})],_.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],_.prototype,"valueExpression",void 0),(0,n._)([(0,a.MZ)({type:String})],_.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],_.prototype,"_pixelIntensityToDensity",null),_=g=(0,n._)([(0,u.$)("esri.renderers.HeatmapRenderer")],_);const S=_},78002:function(e,t,r){r.d(t,{A:function(){return x}});var n=r(53804),i=r(52874),s=(r(10748),r(50659)),o=r(75743),a=r(13520),l=r(23502),u=(r(58941),r(40633),r(74376)),c=r(65953),p=r(53743),d=r(30047),h=r(29970),f=r(19563),y=r(85336),m=r(30905);r(13798);let g=class extends((0,o.O)(m.oY)){constructor(){super(...arguments),this.color=new i.A([0,0,0,0]),this.label=null,this.threshold=0}};(0,n._)([(0,l.MZ)({type:i.A,json:{write:!0}})],g.prototype,"color",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],g.prototype,"label",void 0),(0,n._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],g.prototype,"threshold",void 0),g=(0,n._)([(0,c.$)("esri.renderers.support.OthersCategory")],g);var v=r(16986),b=r(14170),w=r(53096),_=r(64494),S=r(90363),I=r(22198);const M={base:_.A,key:"type",typeMap:{size:w.A,opacity:b.A}};let T=class extends((0,h.h)((0,o.O)(d.A))){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new i.A([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new g,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){return new S.A({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(s.Ru)}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const r of this.attributes)r.valueExpression&&await(0,p.Dx)(e,t,r.valueExpression),r.field&&e.add(r.field)}};(0,n._)([(0,l.MZ)({type:[f.A],json:{write:!0}})],T.prototype,"attributes",void 0),(0,n._)([(0,l.MZ)(y.As)],T.prototype,"backgroundFillSymbol",void 0),(0,n._)([(0,l.MZ)({type:i.A,json:{write:!0}})],T.prototype,"defaultColor",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],T.prototype,"defaultLabel",void 0),(0,n._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],T.prototype,"holePercentage",void 0),(0,n._)([(0,l.MZ)({type:g,json:{write:!0}})],T.prototype,"othersCategory",void 0),(0,n._)([(0,l.MZ)({type:v.A,json:{write:!0}})],T.prototype,"legendOptions",void 0),(0,n._)([(0,l.MZ)({type:I.A,json:{default:null,write:!0}})],T.prototype,"outline",void 0),(0,n._)([(0,l.MZ)({type:Number,cast:a.cr,json:{write:!0}})],T.prototype,"size",void 0),(0,n._)([(0,u.e)({pieChart:"pie-chart"})],T.prototype,"type",void 0),(0,n._)([(0,l.MZ)({types:[M]})],T.prototype,"visualVariables",void 0),T=(0,n._)([(0,c.$)("esri.renderers.PieChartRenderer")],T);const x=T},30047:function(e,t,r){r.d(t,{A:function(){return p}});var n=r(53804),i=r(73037),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(65953)),l=r(53871);const u=new i.J({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let c=class extends s.oY{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};(0,n._)([(0,o.MZ)({type:l.A,json:{write:!0}})],c.prototype,"authoringInfo",void 0),(0,n._)([(0,o.MZ)({type:u.apiValues,readOnly:!0,json:{type:u.jsonValues,read:!1,write:{writer:u.write,ignoreOrigin:!0}}})],c.prototype,"type",void 0),c=(0,n._)([(0,a.$)("esri.renderers.Renderer")],c);const p=c},27777:function(e,t,r){r.d(t,{A:function(){return h}});var n,i=r(53804),s=r(21609),o=r(23502),a=(r(58941),r(40633),r(74376)),l=r(65953),u=r(30047),c=r(29970),p=r(85336);let d=n=class extends((0,c.h)(u.A)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map((r=>r.collectRequiredFields(e,t))))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new n({description:this.description,label:this.label,symbol:(0,s.o8)(this.symbol),visualVariables:(0,s.o8)(this.visualVariables),authoringInfo:(0,s.o8)(this.authoringInfo)})}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"description",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,i._)([(0,o.MZ)(p.Wp)],d.prototype,"symbol",void 0),(0,i._)([(0,a.e)({simple:"simple"})],d.prototype,"type",void 0),d=n=(0,i._)([(0,l.$)("esri.renderers.SimpleRenderer")],d);const h=d},61065:function(e,t,r){r.d(t,{A:function(){return $}});var n=r(53804),i=r(10748),s=r(39819),o=r(21609),a=r(40633),l=r(34194),u=r(28181),c=r(23502),p=r(77560),d=r(74376),h=r(47332),f=r(65953),y=r(81392),m=r(72952),g=r(67888),v=r(53743),b=r(51432),w=r(30047),_=r(29970),S=r(85336),I=r(16986),M=r(75743),T=r(30905);r(58941),r(13798);let x=class extends((0,M.O)(T.oY)){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};(0,n._)([(0,c.MZ)(S.Ug)],x.prototype,"value",void 0),(0,n._)([(0,c.MZ)(S.Ug)],x.prototype,"value2",void 0),(0,n._)([(0,c.MZ)(S.Ug)],x.prototype,"value3",void 0),x=(0,n._)([(0,f.$)("esri.renderers.support.UniqueValue")],x);const A=x;var E=r(50659);let L=class extends((0,M.O)(T.oY)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(null==e)return null;const t=typeof(e=Array.isArray(e)?e:[e])[0];return"string"===t||"number"===t?e.map((e=>new A({value:e}))):"object"===t?e[0]instanceof A?e:e.map((e=>new A(e))):null}};(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],L.prototype,"description",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],L.prototype,"label",void 0),(0,n._)([(0,c.MZ)(S.z4)],L.prototype,"symbol",void 0),(0,n._)([(0,c.MZ)({type:[A],json:{type:[[String]],read:{reader:e=>e?e.map((e=>new A({value:e[0],value2:e[1],value3:e[2]}))):null},write:{writer:(e,t)=>{const r=[];for(const t of e){const e=[t.value,t.value2,t.value3].filter(E.Ru).map((e=>e.toString()));r.push(e)}t.values=r}}}})],L.prototype,"values",void 0),(0,n._)([(0,p.w)("values")],L.prototype,"castValues",null),L=(0,n._)([(0,f.$)("esri.renderers.support.UniqueValueClass")],L);const C=L;let N=class extends((0,M.O)(T.oY)){constructor(e){super(e),this.heading=null,this.classes=null}};(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],N.prototype,"heading",void 0),(0,n._)([(0,c.MZ)({type:[C],json:{write:!0}})],N.prototype,"classes",void 0),N=(0,n._)([(0,f.$)("esri.renderers.support.UniqueValueGroup")],N);const R=N;var O,F=r(99278),k=r(54547),D=r(60534),P=r(58916),V=r(36e3);const Z="esri.renderers.UniqueValueRenderer",G=()=>a.A.getLogger(Z),j="uvInfos-watcher",z="uvGroups-watcher",U=(0,g.dp)(F.A);function q(e){return null!=e&&""!==e&&("string"!=typeof e||""!==e.trim()&&"<null>"!==e.toLowerCase())||(e=null),e+""}let B=O=class extends((0,_.h)(w.A)){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,t){if(!e&&!t)return;if(!e||!t)return{type:"complete",oldValue:e,newValue:t};let r=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let i=0;i<t.length;i++){const s=e.find((e=>e.value===t[i].value));s?(0,m.Ui)(s,t[i])?(n.changed.push({type:"complete",oldValue:s,newValue:t[i]}),r=!0):n.unchanged.push({oldValue:s,newValue:t[i]}):(n.added.push(t[i]),r=!0)}for(let i=0;i<e.length;i++)t.find((t=>t.value===e[i].value))||(n.removed.push(e[i]),r=!0);return r?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return null==e||"function"==typeof e?e:(0,g.GX)(e)}writeField(e,t,r,n){"string"==typeof e?t[r]=e:n?.messages?n.messages.push(new s.A("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):G().error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,r){return r.portal||b.A.getDefault()}readStyleOrigin(e,t,r){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const e=(0,D.f)(t.styleUrl,r);return Object.freeze({styleUrl:e})}}writeStyleOrigin(e,t,r,n){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=(0,D.t)(e.styleUrl,n))}set uniqueValueGroups(e){this.styleOrigin?G().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?G().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){if(this.styleOrigin)return void G().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r="object"==typeof e?U(e):new F.A({value:e,symbol:(0,i.dp)(t)}),this.uniqueValueInfos?.push(r),this._valueInfoMap[q(r.value)]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void G().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let r=0;r<t.length;r++){const n=t[r];if(String(n.value)===String(e)){delete this._valueInfoMap[q(e)],t.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let r=t;return this.valueExpression&&null==t?.arcade&&(r={...r,arcade:await(0,k.lw)()}),this._getUniqueValueInfo(e,r)}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void G().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this._getUniqueValueInfo(e,t);return r?.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let r=t;if(this.valueExpression&&null==r?.arcade){const e=await(0,k.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),r={...r,arcade:e}}const n=this._getUniqueValueInfo(e,r);return n?.symbol||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),r=this.uniqueValueInfos?.reduce(((e,t)=>e+t.getMeshHash()),"");return`${e}.${t}.${r}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const e=new O({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:(0,o.o8)(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:(0,o.o8)(this.visualVariables),legendOptions:(0,o.o8)(this.legendOptions),authoringInfo:(0,o.o8)(this.authoringInfo),backgroundFillSymbol:(0,o.o8)(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=(0,o.o8)(this.uniqueValueInfos),r=(0,o.o8)(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze((0,o.o8)(this.styleOrigin))),Object.freeze(t),Object.freeze(r)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",r),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const r=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(r)}async collectSymbolFields(e,t){const r=[...this.getSymbols().map((r=>r.collectRequiredFields(e,t))),(0,v.Dx)(e,t,this.valueExpression)];(0,v.rq)(e,t,this.field),(0,v.rq)(e,t,this.field2),(0,v.rq)(e,t,this.field3),await Promise.all(r)}populateFromStyle(){return(0,P.cF)(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e?.data&&Array.isArray(e.data.items)&&e.data.items.forEach((r=>{const n=new V.A({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:r.name});this.defaultSymbol||r.name!==e.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const i=new F.A({value:r.name,symbol:n});t.push(i),this._valueInfoMap[q(r.name)]=i})),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",",")}_updateUniqueValues(){null!=this._isInfosSource&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[q(t.value)]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(j);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const r of e)t.push((0,u.watch)((()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description})),((e,t)=>{e!==t&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(t,j)}}_watchUniqueValueGroups(){this.removeHandles(z);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const r of e){t.push((0,u.watch)((()=>({classes:r.classes})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const e of r.classes??[])t.push((0,u.watch)((()=>({symbol:e.symbol,values:e.values,label:e.label,description:e.description})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(t,z)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:r,field3:n,fieldDelimiter:i,uniqueValueGroups:s,valueExpression:o}=this;if(!t&&!o)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!t||!r);for(const t of s)for(const s of t.classes??[]){const{symbol:t,label:o,values:l,description:u}=s;for(const s of l??[]){const{value:l,value2:c,value3:p}=s,d=[l];r&&d.push(c),n&&d.push(p);const h=a?d.join(i||""):d[0]??void 0;e.push(new F.A({symbol:t,label:o,value:h,description:u}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:r,valueExpression:n,fieldDelimiter:i,uniqueValueInfos:s}=this;if(!t&&!n||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!t||!r),a=s.map((e=>{const{symbol:t,label:r,value:n,description:s}=e,[a,l,u]=o?n?.toString()?.split(i||"")||[]:[n];return new C({symbol:t,label:r,description:s,values:[new A({value:a,value2:l,value3:u})]})})),l=[new R({classes:a})];e&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:r,scale:n,spatialReference:i,arcade:s,timeZone:o}=t??{};let a=this._cache.compiledFunc;const l=s.arcadeUtils;if(!a){const e=l.createSyntaxTree(this.valueExpression);a=l.createFunction(e),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(e,l.getViewInfo({viewingMode:r,scale:n,spatialReference:i}),o));return this._valueInfoMap[q(u)]}_getUnqiueValueInfoForFields(e){const t=this.field,r=e.attributes;let n;if(this.field2){const e=this.field2,i=this.field3,s=[];t&&s.push(r[t]),e&&s.push(r[e]),i&&s.push(r[i]),n=s.join(this.fieldDelimiter||"")}else t&&(n=r[t]);return this._valueInfoMap[q(n)]}static fromPortalStyle(e,t){const r=new O(t?.properties);r._set("styleOrigin",Object.freeze({styleName:e})),r._set("portal",t?.portal||b.A.getDefault());const n=r.populateFromStyle();return n.catch((t=>{G().error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",t)})),n}static fromStyleUrl(e,t){const r=new O(t?.properties);r._set("styleOrigin",Object.freeze({styleUrl:e}));const n=r.populateFromStyle();return n.catch((t=>{G().error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",t)})),n}};(0,n._)([(0,c.MZ)({readOnly:!0})],B.prototype,"_cache",null),(0,n._)([(0,d.e)({uniqueValue:"unique-value"})],B.prototype,"type",void 0),(0,n._)([(0,c.MZ)(S.As)],B.prototype,"backgroundFillSymbol",void 0),(0,n._)([(0,c.MZ)({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],B.prototype,"field",null),(0,n._)([(0,p.w)("field")],B.prototype,"castField",null),(0,n._)([(0,y.K)("field")],B.prototype,"writeField",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],B.prototype,"field2",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],B.prototype,"field3",null),(0,n._)([(0,c.MZ)({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],B.prototype,"orderByClassesEnabled",void 0),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],B.prototype,"valueExpression",null),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],B.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,c.MZ)({type:I.A,json:{write:!0}})],B.prototype,"legendOptions",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],B.prototype,"defaultLabel",void 0),(0,n._)([(0,c.MZ)((0,l.$N)({...S.z4},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],B.prototype,"defaultSymbol",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],B.prototype,"fieldDelimiter",null),(0,n._)([(0,c.MZ)({type:b.A,readOnly:!0})],B.prototype,"portal",void 0),(0,n._)([(0,h.w)("portal",["styleName"])],B.prototype,"readPortal",null),(0,n._)([(0,c.MZ)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],B.prototype,"styleOrigin",void 0),(0,n._)([(0,h.w)("styleOrigin",["styleName","styleUrl"])],B.prototype,"readStyleOrigin",null),(0,n._)([(0,y.K)("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],B.prototype,"writeStyleOrigin",null),(0,n._)([(0,c.MZ)({type:[R],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,r)=>(t.uniqueValueGroups||function(e){const{field1:t,field2:r,field3:n,fieldDelimiter:i,uniqueValueInfos:s,valueExpression:o}=e,a=!(!t||!r);return[{classes:(s??[]).map((e=>{const{symbol:s,label:l,value:u,description:c}=e,[p,d,h]=a?u?.toString()?.split(i||"")||[]:[u],f=[];return(t||o)&&f.push(p),r&&f.push(d),n&&f.push(h),{symbol:s,label:l,values:[f],description:c}}))}]}(t)).map((e=>R.fromJSON(e,r)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],B.prototype,"uniqueValueGroups",null),(0,n._)([(0,c.MZ)({type:[F.A],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],B.prototype,"uniqueValueInfos",null),B=O=(0,n._)([(0,f.$)(Z)],B);const $=B},29970:function(e,t,r){r.d(t,{h:function(){return T}});var n=r(53804),i=r(23502),s=(r(58941),r(40633)),o=(r(13798),r(47332)),a=r(65953),l=r(81392),u=r(53743);const c=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var p=r(74843),d=r(14170),h=r(36604),f=r(53096),y=r(64494),m=r(83525),g=r(73037),v=r(89001);const b={color:p.A,size:f.A,opacity:d.A,rotation:h.A},w=new g.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),_=/^\[([^\]]+)\]$/i;let S=class extends m.A{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e?.filter((e=>!!e)),e?.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some((e=>!!e.target))&&e.sort(((e,t)=>{let r=null;return r=e.target===t.target?0:e.target?1:-1,r}));for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,r){const{rotationExpression:n,rotationType:i}=t,o=n?.match(_),a=o?.[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:i,field:a})),e)return e.map((e=>{const t=w.read(e.type),n=b[t];n||(s.A.getLogger(this).warn(`Unknown variable type: ${t}`),r?.messages&&r.messages.push(new v.A("visual-variable:unsupported",`visualVariable of type '${t}' is not supported`,{definition:e,context:r})));const i=new n;return i.read(e,r),i}))}writeVariables(e,t){const r=[];for(const n of e){const e=n.toJSON(t);e&&r.push(e)}return r}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};(0,n._)([(0,i.MZ)()],S.prototype,"visualVariables",null),S=(0,n._)([(0,a.$)("esri.renderers.visualVariables.VisualVariableFactory")],S);const I=S,M={base:y.A,key:"type",typeMap:{opacity:d.A,color:p.A,rotation:h.A,size:f.A}},T=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new I}set visualVariables(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(e,t,r){return this._vvFactory.readVariables(e,t,r)}writeVisualVariables(e,t,r,n){t[r]=this._vvFactory.writeVariables(e,n)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const e of this.visualVariables)if(e.arcadeRequired)return!0;return!1}hasVisualVariables(e,t){return e?this.getVisualVariablesForType(e,t).length>0:this.getVisualVariablesForType("size",t).length>0||this.getVisualVariablesForType("color",t).length>0||this.getVisualVariablesForType("opacity",t).length>0||this.getVisualVariablesForType("rotation",t).length>0}getVisualVariablesForType(e,t){const r=this.visualVariables;return r?r.filter((r=>r.type===e&&("string"==typeof t?r.target===t:!1!==t||!r.target))):[]}async collectVVRequiredFields(e,t){let r=[];this.visualVariables&&(r=r.concat(this.visualVariables));for(const n of r)n&&(n.field&&(0,u.rq)(e,t,n.field),n.normalizationField&&(0,u.rq)(e,t,n.normalizationField),n.valueExpression&&(x(n.valueExpression,e,t)||await(0,u.Dx)(e,t,n.valueExpression)))}};return(0,n._)([(0,i.MZ)({types:[M],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),(0,n._)([(0,o.w)("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),(0,n._)([(0,l.K)("visualVariables")],t.prototype,"writeVisualVariables",null),t=(0,n._)([(0,a.$)("esri.renderers.mixins.VisualVariablesMixin")],t),t};function x(e,t,r){const n=(i=e,i.match(c)?.[1]?.replace(/\\'/g,"'")??null);var i;return null!=n&&((0,u.rq)(t,r,n),!0)}},19563:function(e,t,r){r.d(t,{A:function(){return h}});var n,i=r(53804),s=r(52874),o=r(30905),a=r(40633),l=r(23502),u=r(77560),c=(r(13798),r(58941),r(65953)),p=r(67888);let d=n=class extends o.oY{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(a.A.getLogger(this).error(".field: field must be a string value"),null):(0,p.GX)(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new n({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,i._)([(0,l.MZ)({type:s.A,json:{type:[Number],write:!0}})],d.prototype,"color",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"field",void 0),(0,i._)([(0,u.w)("field")],d.prototype,"castField",null),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"valueExpression",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0),d=n=(0,i._)([(0,c.$)("esri.renderers.support.AttributeColorInfo")],d);const h=d},53871:function(e,t,r){r.d(t,{A:function(){return k}});var n,i=r(53804),s=r(73037),o=r(30905),a=r(21609),l=r(23502),u=r(67888),c=r(47332),p=r(65953);r(58941),r(40633),r(13798);let d=n=class extends o.oY{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new n({minValue:this.minValue,maxValue:this.maxValue})}};var h;(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"minValue",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"maxValue",void 0),d=n=(0,i._)([(0,p.$)("esri.renderers.support.AuthoringInfoClassBreakInfo")],d);let f=h=class extends o.oY{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new h({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:(0,a.o8)(this.classBreakInfos)})}};(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"field",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"normalizationField",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"label",void 0),(0,i._)([(0,l.MZ)({type:[d],json:{write:!0}})],f.prototype,"classBreakInfos",void 0),f=h=(0,i._)([(0,p.$)("esri.renderers.support.AuthoringInfoFieldInfo")],f);var y,m=r(77560);let g=y=class extends o.oY{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new y({label:this.label,value:this.value,size:this.size})}};(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],g.prototype,"label",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],g.prototype,"size",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],g.prototype,"value",void 0),g=y=(0,i._)([(0,p.$)("esri.renderers.support.AuthoringInfoSizeStop")],g);const v=g;var b;const w=new s.J({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),_=new s.J({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),S={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},I=["high-to-low","above-and-below","centered-on","extremes"],M=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size"])],T=["seconds","minutes","hours","days","months","years"];let x=b=class extends o.oY{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return"string"==typeof e||"number"==typeof e?e:null}get normalizationField(){return"reference-size"===this.theme?this._get("normalizationField"):null}set normalizationField(e){this._set("normalizationField",e)}get referenceSizeScale(){return"reference-size"===this.theme?this._get("referenceSizeScale"):null}set referenceSizeScale(e){this._set("referenceSizeScale",e)}get referenceSizeSymbolStyle(){return"reference-size"===this.theme?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(e){this._set("referenceSizeSymbolStyle",e)}castStartTime(e){return"string"==typeof e||"number"==typeof e?e:null}get sizeStops(){return"reference-size"===this.theme?this._get("sizeStops"):null}set sizeStops(e){this._set("sizeStops",e)}get style(){return"color"===this.type?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new b({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:(0,a.o8)(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};(0,i._)([(0,l.MZ)({types:S,json:{write:!0}})],x.prototype,"endTime",void 0),(0,i._)([(0,m.w)("endTime")],x.prototype,"castEndTime",null),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],x.prototype,"field",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],x.prototype,"maxSliderValue",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0}})],x.prototype,"minSliderValue",void 0),(0,i._)([(0,l.MZ)({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],x.prototype,"normalizationField",null),(0,i._)([(0,l.MZ)({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],x.prototype,"referenceSizeScale",null),(0,i._)([(0,l.MZ)({type:["circle","diamond","hexagon-flat","hexagon-pointy","square"],value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],x.prototype,"referenceSizeSymbolStyle",null),(0,i._)([(0,l.MZ)({types:S,json:{write:!0}})],x.prototype,"startTime",void 0),(0,i._)([(0,m.w)("startTime")],x.prototype,"castStartTime",null),(0,i._)([(0,l.MZ)({type:[v],json:{origins:{"web-scene":{write:!1}},write:!0}})],x.prototype,"sizeStops",null),(0,i._)([(0,l.MZ)({type:w.apiValues,value:null,json:{type:w.jsonValues,read:w.read,write:w.write}})],x.prototype,"style",null),(0,i._)([(0,l.MZ)({type:M,value:null,json:{type:M,origins:{"web-scene":{type:I,write:{writer:(e,t)=>{I.includes(e)&&(t.theme=e)}}}},write:!0}})],x.prototype,"theme",null),(0,i._)([(0,l.MZ)({type:_.apiValues,json:{type:_.jsonValues,read:_.read,write:_.write}})],x.prototype,"type",void 0),(0,i._)([(0,l.MZ)({type:T,json:{type:T,write:!0}})],x.prototype,"units",void 0),x=b=(0,i._)([(0,p.$)("esri.renderers.support.AuthoringInfoVisualVariable")],x);const A=x;var E,L=r(85982);const C=new s.J({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),N=new s.J({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),R=new s.J({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),O=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"];let F=E=class extends o.oY{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?(0,L.r)(e):void 0}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return"flow"===this.type?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new E({classificationMethod:this.classificationMethod,colorRamp:(0,a.o8)(this.colorRamp),fadeRatio:(0,a.o8)(this.fadeRatio),fields:this.fields?.slice(),field1:(0,a.o8)(this.field1),field2:(0,a.o8)(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};(0,i._)([(0,l.MZ)({type:C.apiValues,value:null,json:{type:C.jsonValues,read:C.read,write:C.write,origins:{"web-document":{default:"manual",type:C.jsonValues,read:C.read,write:C.write}}}})],F.prototype,"classificationMethod",null),(0,i._)([(0,l.MZ)({types:L.g,json:{write:!0}})],F.prototype,"colorRamp",void 0),(0,i._)([(0,c.w)("colorRamp")],F.prototype,"readColorRamp",null),(0,i._)([(0,l.MZ)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],F.prototype,"fadeRatio",void 0),(0,i._)([(0,l.MZ)({type:[String],value:null,json:{write:!0}})],F.prototype,"fields",null),(0,i._)([(0,l.MZ)({type:f,value:null,json:{write:!0}})],F.prototype,"field1",null),(0,i._)([(0,l.MZ)({type:f,value:null,json:{write:!0}})],F.prototype,"field2",null),(0,i._)([(0,l.MZ)({type:["flow-line","wave-front"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],F.prototype,"flowTheme",null),(0,i._)([(0,l.MZ)({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],F.prototype,"focus",null),(0,i._)([(0,l.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],F.prototype,"isAutoGenerated",void 0),(0,i._)([(0,l.MZ)({type:Number,value:null,json:{type:u.jz,write:!0}})],F.prototype,"numClasses",null),(0,i._)([(0,l.MZ)({type:O,json:{type:O,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],F.prototype,"lengthUnit",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],F.prototype,"maxSliderValue",void 0),(0,i._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],F.prototype,"minSliderValue",void 0),(0,i._)([(0,l.MZ)({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],F.prototype,"statistics",null),(0,i._)([(0,l.MZ)({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],F.prototype,"standardDeviationInterval",null),(0,i._)([(0,l.MZ)({type:N.apiValues,value:null,json:{type:N.jsonValues,read:N.read,write:N.write,origins:{"web-scene":{type:R.jsonValues,write:{writer:R.write,overridePolicy:e=>({enabled:"flow"!==e})}}}}})],F.prototype,"type",null),(0,i._)([(0,l.MZ)({type:[A],json:{write:!0}})],F.prototype,"visualVariables",void 0),(0,i._)([(0,l.MZ)({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],F.prototype,"univariateSymbolStyle",null),(0,i._)([(0,l.MZ)({type:["high-to-low","above-and-below","above","below"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],F.prototype,"univariateTheme",null),F=E=(0,i._)([(0,p.$)("esri.renderers.support.AuthoringInfo")],F);const k=F},23879:function(e,t,r){r.d(t,{A:function(){return c}});var n,i=r(53804),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(65953)),l=r(85336);let u=n=class extends s.oY{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new n({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?.clone()??null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,i._)([(0,o.MZ)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],u.prototype,"minValue",void 0),(0,i._)([(0,o.MZ)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],u.prototype,"maxValue",void 0),(0,i._)([(0,o.MZ)(l.Wp)],u.prototype,"symbol",void 0),u=n=(0,i._)([(0,a.$)("esri.renderers.support.ClassBreakInfo")],u);const c=u},27419:function(e,t,r){r.d(t,{A:function(){return p}});var n,i=r(53804),s=r(52874),o=r(30905),a=r(23502),l=r(67888),u=(r(13798),r(58941),r(65953));let c=n=class extends o.oY{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new n({color:this.color&&this.color.clone(),ratio:this.ratio})}};(0,i._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],default:null,write:!0}})],c.prototype,"color",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0),c=n=(0,i._)([(0,u.$)("esri.renderers.support.HeatmapColorStop")],c);const p=c},16986:function(e,t,r){r.d(t,{A:function(){return d}});var n=r(53804),i=r(75743),s=r(73037),o=r(30905),a=r(23502),l=(r(58941),r(40633),r(13798),r(74376)),u=r(65953);const c=(0,s.O)()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let p=class extends((0,i.O)(o.oY)){constructor(e){super(e),this.title=null,this.order=null}};(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"title",void 0),(0,n._)([(0,l.e)(c)],p.prototype,"order",void 0),p=(0,n._)([(0,u.$)("esri.renderers.support.RendererLegendOptions")],p);const d=p},99278:function(e,t,r){r.d(t,{A:function(){return c}});var n,i=r(53804),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(65953)),l=r(85336);let u=n=class extends s.oY{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new n({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${e}`}};(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,i._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,i._)([(0,o.MZ)(l.Wp)],u.prototype,"symbol",void 0),(0,i._)([(0,o.MZ)(l.Ug)],u.prototype,"value",void 0),u=n=(0,i._)([(0,a.$)("esri.renderers.support.UniqueValueInfo")],u);const c=u},85336:function(e,t,r){r.d(t,{As:function(){return p},Ug:function(){return d},Wp:function(){return c},z4:function(){return u}});var n=r(10748),i=r(34194),s=r(51575),o=r(8404),a=r(34563),l=r(15186);const u={types:n.xK,json:{write:{writer:o.M9},origins:{"web-scene":{types:n.On,write:{writer:o.M9},read:{reader:(0,s.C)({types:n.On})}}}}},c=(0,i.$N)({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},u),p={types:{base:a.A,key:"type",typeMap:{"simple-fill":n.Es.typeMap["simple-fill"],"picture-fill":n.Es.typeMap["picture-fill"],"polygon-3d":n.Es.typeMap["polygon-3d"],cim:n.Es.typeMap.cim}},json:{write:{writer:o.M9},origins:{"web-scene":{type:l.A,write:{writer:o.M9}}}}},d={cast:e=>null==e||"string"==typeof e||"number"==typeof e?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e?.toString()}}}}},70181:function(e,t,r){r.d(t,{O3:function(){return p},PU:function(){return u},YW:function(){return h},ex:function(){return a},hv:function(){return d},zp:function(){return l}});var n=r(15774),i=r(13520),s=r(33400),o=r(41546);const a=2.4;function l(e){return(0,i.PN)(e*a)}function u(e){return(0,i.Lz)(e)/a}function c(e,t,r,i){let{color:o,ratio:a}=t,{color:l,ratio:u}=r;if(u===a){const e=1e-6;1===u?a-=e:u+=e}const c=(0,n.qE)((i-a)/(u-a),0,1);(0,s.l)(e,o.toArray(),l.toArray(),c)}function p(e){const t=new Uint8ClampedArray(2048);if((e=e.filter((({ratio:e})=>e>=0&&e<=1)).sort(((e,t)=>e.ratio-t.ratio)).map((({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)})))).length<1)return t;let r=e[0],n=e[0],i=1;const s=(0,o.vt)();for(let o=0;o<512;o++){const a=(o+.5)/512;for(;a>n.ratio&&i<e.length;)r=n,n=e[i++];c(s,r,n,a),t.set(s,4*o)}return t}function d(e,t,r){const n=Math.sqrt(e**2+t**2)/r;return n>1?0:3/(Math.PI*r**2)*(1-n**2)**2}function h(e){return"function"==typeof e?e:e?t=>+t[e]:()=>1}},6537:function(e,t,r){r.d(t,{L:function(){return l},r:function(){return o}});var n=r(89001),i=r(51575),s=r(31315);function o(e,t){return l(e,null,t)}const a=(0,i.C)({types:s.H});function l(e,t,r){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(r?.messages&&r.messages.push(new n.A("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):a(e,t,r):null}},31315:function(e,t,r){r.d(t,{H:function(){return d},X:function(){return h}});var n=r(40633),i=r(74865),s=r(1526),o=r(96173),a=r(52308),l=r(78002),u=r(30047),c=r(27777),p=r(61065);const d={key:"type",base:u.A,typeMap:{heatmap:a.A,simple:c.A,"unique-value":p.A,"class-breaks":i.A,"dot-density":o.A,dictionary:s.A,"pie-chart":l.A},errorContext:"renderer"},h={key:"type",base:u.A,typeMap:{simple:c.A,"unique-value":p.A,"class-breaks":i.A,heatmap:a.A},errorContext:"renderer",validate:function(e){switch(e.type){case"simple":return function(e){if(e.symbol)return e;n.A.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}(e);case"unique-value":return function(e){const t=e.uniqueValueInfos,r=t?.filter((({symbol:e,label:t},r)=>(e||n.A.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${r}] ${t}) without a symbol from web scene.`),!!e)));return r?.length!==t?.length&&(e.uniqueValueInfos=r),e}(e);case"class-breaks":return function(e){const t=e.classBreakInfos,r=t?.filter((({symbol:e,label:t},r)=>(e||n.A.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${r}] ${t}) without a symbol from web scene.`),!!e)));return r?.length!==t?.length&&(e.classBreakInfos=r),e}(e);case"heatmap":return e}}}},74843:function(e,t,r){r.d(t,{A:function(){return c}});var n,i=r(53804),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(64494),l=r(71859);let u=n=class extends a.A{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new n({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,i._)([(0,s.MZ)({readOnly:!0})],u.prototype,"cache",null),(0,i._)([(0,s.MZ)({type:["color"],json:{type:["colorInfo"]}})],u.prototype,"type",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"normalizationField",void 0),(0,i._)([(0,s.MZ)({type:[l.A],json:{write:!0}})],u.prototype,"stops",null),u=n=(0,i._)([(0,o.$)("esri.renderers.visualVariables.ColorVariable")],u);const c=u},14170:function(e,t,r){r.d(t,{A:function(){return g}});var n,i=r(53804),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(64494),l=r(30905),u=r(67888),c=r(47332),p=r(81392),d=r(59798);let h=n=class extends l.oY{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return(0,d.D)(t.transparency)}writeOpacity(e,t,r){t[r]=(0,d.p)(e)}clone(){return new n({label:this.label,opacity:this.opacity,value:this.value})}};(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,i._)([(0,s.MZ)({type:Number,json:{type:u.jz,write:{target:"transparency"}}})],h.prototype,"opacity",void 0),(0,i._)([(0,c.w)("opacity",["transparency"])],h.prototype,"readOpacity",null),(0,i._)([(0,p.K)("opacity")],h.prototype,"writeOpacity",null),(0,i._)([(0,s.MZ)({type:Number,json:{write:!0}})],h.prototype,"value",void 0),h=n=(0,i._)([(0,o.$)("esri.renderers.visualVariables.support.OpacityStop")],h);const f=h;var y;let m=y=class extends a.A{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new y({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,i._)([(0,s.MZ)({readOnly:!0})],m.prototype,"cache",null),(0,i._)([(0,s.MZ)({type:["opacity"],json:{type:["transparencyInfo"]}})],m.prototype,"type",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],m.prototype,"normalizationField",void 0),(0,i._)([(0,s.MZ)({type:[f],json:{write:!0}})],m.prototype,"stops",null),m=y=(0,i._)([(0,o.$)("esri.renderers.visualVariables.OpacityVariable")],m);const g=m},36604:function(e,t,r){r.d(t,{A:function(){return u}});var n,i=r(53804),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(64494);let l=n=class extends a.A{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){return new n({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};(0,i._)([(0,s.MZ)({readOnly:!0})],l.prototype,"cache",null),(0,i._)([(0,s.MZ)({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],l.prototype,"axis",void 0),(0,i._)([(0,s.MZ)({type:["rotation"],json:{type:["rotationInfo"]}})],l.prototype,"type",void 0),(0,i._)([(0,s.MZ)({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],l.prototype,"rotationType",void 0),l=n=(0,i._)([(0,o.$)("esri.renderers.visualVariables.RotationVariable")],l);const u=l},53096:function(e,t,r){r.d(t,{A:function(){return x}});var n=r(53804),i=r(39819),s=r(73037),o=r(40633),a=r(23502),l=r(77560),u=r(47332),c=r(65953),p=r(81392),d=r(64494),h=r(13520),f=r(59423),y=(r(58941),r(13798),r(96893));let m=class extends y.A{constructor(){super(...arguments),this.customValues=null}};(0,n._)([(0,a.MZ)({type:[Number],json:{write:!0}})],m.prototype,"customValues",void 0),m=(0,n._)([(0,c.$)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],m);const g=m;var v,b=r(32974),w=r(70481);const _=new s.J({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),S=new s.J({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function I(e){if(null!=e)return"string"==typeof e||"number"==typeof e?function(e){return(0,h.cr)(e)}(e):"size"===e.type?(0,b.of)(e)?e:(delete(e={...e}).type,new T(e)):void 0}function M(e,t,r){if("object"!=typeof e)return e;const n=new T;return n.read(e,r),n}let T=v=class extends d.A{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:null!=this.valueExpression&&w.viewScaleRE.test(this.valueExpression)}}set index(e){(0,b.of)(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),(0,b.of)(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return(0,b.eh)(this)}set maxDataValue(e){e&&this.stops&&(o.A.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(o.A.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return I(e)}readMaxSize(e,t,r){return M(e,0,r)}set minDataValue(e){e&&this.stops&&(o.A.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(o.A.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return I(e)}readMinSize(e,t,r){return M(e,0,r)}get arcadeRequired(){return!!this.valueExpression||null!=this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||null!=this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(o.A.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return(0,b.KZ)(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,r,n){if("$view.scale"===e){if(n?.messages){const e=this.index,t="string"==typeof e?e:`visualVariables[${e}]`;n.messages.push(new i.A("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpression",context:n}))}}else t[r]=e}readValueUnit(e){return e?S.read(e):null}clone(){return new v({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,b.of)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,b.of)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===b._w.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===b._w.Stops){const e=this.stops;if(!e)return this;const t=e.map((e=>e.size)).reverse(),r=e.length;for(let n=0;n<r;n++)e[n].size=t[n];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((e=>e.value||0))}};(0,n._)([(0,a.MZ)({readOnly:!0})],T.prototype,"cache",null),(0,n._)([(0,a.MZ)({type:_.apiValues,json:{type:_.jsonValues,origins:{"web-map":{read:!1}},read:_.read,write:_.write}})],T.prototype,"axis",void 0),(0,n._)([(0,a.MZ)()],T.prototype,"index",null),(0,n._)([(0,a.MZ)({type:String,readOnly:!0})],T.prototype,"inputValueType",null),(0,n._)([(0,a.MZ)({type:g,json:{write:!0}})],T.prototype,"legendOptions",void 0),(0,n._)([(0,a.MZ)({type:Number,value:null,json:{write:!0}})],T.prototype,"maxDataValue",null),(0,n._)([(0,a.MZ)({type:Number,value:null,json:{write:!0}})],T.prototype,"maxSize",null),(0,n._)([(0,l.w)("maxSize")],T.prototype,"castMaxSize",null),(0,n._)([(0,u.w)("maxSize")],T.prototype,"readMaxSize",null),(0,n._)([(0,a.MZ)({type:Number,value:null,json:{write:!0}})],T.prototype,"minDataValue",null),(0,n._)([(0,a.MZ)({type:Number,value:null,json:{write:!0}})],T.prototype,"minSize",null),(0,n._)([(0,l.w)("minSize")],T.prototype,"castMinSize",null),(0,n._)([(0,u.w)("minSize")],T.prototype,"readMinSize",null),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],T.prototype,"normalizationField",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],T.prototype,"arcadeRequired",null),(0,n._)([(0,a.MZ)({type:String})],T.prototype,"scaleBy",void 0),(0,n._)([(0,a.MZ)({type:[f.A],value:null,json:{write:!0}})],T.prototype,"stops",null),(0,n._)([(0,a.MZ)({type:["outline"],json:{write:!0}})],T.prototype,"target",void 0),(0,n._)([(0,a.MZ)({type:String,readOnly:!0})],T.prototype,"transformationType",null),(0,n._)([(0,a.MZ)({type:["size"],json:{type:["sizeInfo"]}})],T.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],T.prototype,"useSymbolValue",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],T.prototype,"valueExpression",void 0),(0,n._)([(0,u.w)("valueExpression",["valueExpression","expression"])],T.prototype,"readValueExpression",null),(0,n._)([(0,p.K)("web-scene","valueExpression")],T.prototype,"writeValueExpressionWebScene",null),(0,n._)([(0,a.MZ)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],T.prototype,"valueRepresentation",void 0),(0,n._)([(0,a.MZ)({type:S.apiValues,json:{write:S.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],T.prototype,"valueUnit",void 0),(0,n._)([(0,u.w)("valueUnit")],T.prototype,"readValueUnit",null),T=v=(0,n._)([(0,c.$)("esri.renderers.visualVariables.SizeVariable")],T);const x=T},64494:function(e,t,r){r.d(t,{A:function(){return f}});var n=r(53804),i=r(73037),s=r(30905),o=r(40633),a=r(23502),l=r(77560),u=r(65953),c=r(67888),p=r(96893);const d=new i.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let h=class extends s.oY{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return null==e?e:"function"==typeof e?(o.A.getLogger(this).error(".field: field must be a string value"),null):(0,c.GX)(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};(0,n._)([(0,a.MZ)()],h.prototype,"index",void 0),(0,n._)([(0,a.MZ)({type:d.apiValues,readOnly:!0,json:{read:d.read,write:d.write}})],h.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],h.prototype,"field",void 0),(0,n._)([(0,l.w)("field")],h.prototype,"castField",null),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],h.prototype,"valueExpression",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],h.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],h.prototype,"arcadeRequired",null),(0,n._)([(0,a.MZ)({type:p.A,json:{write:!0}})],h.prototype,"legendOptions",void 0),h=(0,n._)([(0,u.$)("esri.renderers.visualVariables.VisualVariable")],h);const f=h},71859:function(e,t,r){r.d(t,{A:function(){return d}});var n,i=r(53804),s=r(52874),o=r(30905),a=r(23502),l=r(67888),u=(r(13798),r(58941),r(65953)),c=r(81392);let p=n=class extends o.oY{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,r){t[r]=e??0}clone(){return new n({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};(0,i._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],p.prototype,"color",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"label",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],p.prototype,"value",void 0),(0,i._)([(0,c.K)("value")],p.prototype,"writeValue",null),p=n=(0,i._)([(0,u.$)("esri.renderers.visualVariables.support.ColorStop")],p);const d=p},59423:function(e,t,r){r.d(t,{A:function(){return c}});var n,i=r(53804),s=r(30905),o=r(13520),a=r(23502),l=(r(58941),r(40633),r(13798),r(65953));let u=n=class extends s.oY{constructor(e){super(e),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new n({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,i._)([(0,a.MZ)({type:Number,cast:o.cr,json:{write:!0}})],u.prototype,"size",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],u.prototype,"value",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!1}})],u.prototype,"useMinValue",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!1}})],u.prototype,"useMaxValue",void 0),u=n=(0,i._)([(0,l.$)("esri.renderers.visualVariables.support.SizeStop")],u);const c=u},96893:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(53804),i=r(75743),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(65953));let l=class extends((0,i.O)(s.oY)){constructor(){super(...arguments),this.showLegend=null,this.title=null}};(0,n._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],l.prototype,"showLegend",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),l=(0,n._)([(0,a.$)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],l);const u=l},32974:function(e,t,r){var n,i;function s(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function o(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?n.Expression:e.field&&"string"==typeof e.field?n.Field:n.Unknown}function l(e,t){const r=t||a(e),s=e.valueUnit||"unknown";return r===n.Unknown?i.Constant:e.stops?i.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?i.ClampedLinear:"unknown"===s?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?i.Proportional:i.Additive:i.Identity:i.RealWorldSize}r.d(t,{KZ:function(){return l},Yf:function(){return n},_w:function(){return i},eh:function(){return a},gf:function(){return o},of:function(){return s}}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(n||(n={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(i||(i={}))},70481:function(e,t,r){r.r(t),r.d(t,{getAllSizes:function(){return T},getColor:function(){return y},getOpacity:function(){return m},getRotationAngle:function(){return g},getSize:function(){return v},getSizeForValue:function(){return _},getSizeFromNumberOrVariable:function(){return b},getSizeRangeAtScale:function(){return S},getVisualVariableValues:function(){return I},viewScaleRE:function(){return f}});var n=r(52874),i=r(59469),s=r(82547),o=r(40633),a=r(85031),l=r(32974);const u=()=>o.A.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),c=e=>u().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${e}`),p=()=>u().error("Use of arcade expressions requires an arcade context"),d=new i.default,h=Math.PI,f=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function y(e,t,r){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.ColorVariable"!==i.declaredClass)return void c("ColorVariable");const s="number"==typeof t,o=s?null:t,a=o?.attributes;let l=s?t:null;const u=i.field,{ipData:d,hasExpression:h}=i.cache;let f=i.cache.compiledFunc;if(!u&&!h){const e=i.stops;return e&&e[0]&&e[0].color}if("number"!=typeof l)if(h){if(null==r?.arcade)return void p();const e={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},t=r.arcade.arcadeUtils,n=t.getViewInfo(e),s=t.createExecContext(o,n,r.timeZone);if(!f){const e=t.createSyntaxTree(i.valueExpression);f=t.createFunction(e),i.cache.compiledFunc=f}l=t.executeFunction(f,s)}else a&&(l=a[u]);const y=i.normalizationField,m=null!=a&&null!=y?parseFloat(a[y]):void 0;if(null!=l&&(!y||s||!isNaN(m)&&0!==m)){isNaN(m)||s||(l/=m);const e=M(l,d);if(e){const t=e[0],s=e[1],o=t===s?i.stops[t].color:n.A.blendColors(i.stops[t].color,i.stops[s].color,e[2],null!=r?r.color:void 0);return new n.A(o)}}}function m(e,t,r){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.OpacityVariable"!==n.declaredClass)return void c("OpacityVariable");const i="number"==typeof t,s=i?null:t,o=s?.attributes;let a=i?t:null;const l=n.field,{ipData:u,hasExpression:d}=n.cache;let h=n.cache.compiledFunc;if(!l&&!d){const e=n.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof a)if(d){if(null==r?.arcade)return void p();const e={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},t=r.arcade.arcadeUtils,i=t.getViewInfo(e),o=t.createExecContext(s,i,r.timeZone);if(!h){const e=t.createSyntaxTree(n.valueExpression);h=t.createFunction(e),n.cache.compiledFunc=h}a=t.executeFunction(h,o)}else o&&(a=o[l]);const f=n.normalizationField,y=null!=o&&null!=f?parseFloat(o[f]):void 0;if(null!=a&&(!f||i||!isNaN(y)&&0!==y)){isNaN(y)||i||(a/=y);const e=M(a,u);if(e){const t=e[0],r=e[1];if(t===r)return n.stops[t].opacity;{const i=n.stops[t].opacity;return i+(n.stops[r].opacity-i)*e[2]}}}}function g(e,t,r){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.RotationVariable"!==n.declaredClass)return void c("RotationVariable");const i=n.axis||"heading",s="heading"===i&&"arithmetic"===n.rotationType?90:0,o="heading"===i&&"arithmetic"===n.rotationType?-1:1,a="number"==typeof t?null:t,l=a?.attributes,u=n.field,{hasExpression:d}=n.cache;let h=n.cache.compiledFunc,f=0;if(!u&&!d)return f;if(d){if(null==r?.arcade)return void p();const e={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},t=r.arcade.arcadeUtils,i=t.getViewInfo(e),s=t.createExecContext(a,i,r.timeZone);if(!h){const e=t.createSyntaxTree(n.valueExpression);h=t.createFunction(e),n.cache.compiledFunc=h}f=t.executeFunction(h,s)}else l&&(f=l[u]||0);return f="number"!=typeof f||isNaN(f)?null:s+o*f,f}function v(e,t,r){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.SizeVariable"!==n.declaredClass)return void c("SizeVariable");const i=_(function(e,t,r){const n="number"==typeof t,i=n?null:t,s=i?.attributes;let o=n?t:null;const{isScaleDriven:a}=e.cache;let u=e.cache.compiledFunc;if(a){const t=null!=r?r.scale:void 0,n=null!=r?r.view:void 0;o=null==t||"3d"===n?function(e){let t=null,r=null;const n=e.stops;return n?(t=n[0].value,r=n[n.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):t}else if(!n)switch(e.inputValueType){case l.Yf.Expression:{if(null==r?.arcade)return void p();const t={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},n=r.arcade.arcadeUtils,s=n.getViewInfo(t),a=n.createExecContext(i,s,r.timeZone);if(!u){const t=n.createSyntaxTree(e.valueExpression);u=n.createFunction(t),e.cache.compiledFunc=u}o=n.executeFunction(u,a);break}case l.Yf.Field:s&&(o=s[e.field]);break;case l.Yf.Unknown:o=null}if(!(0,l.gf)(o))return null;if(n||!e.normalizationField)return o;const c=s?parseFloat(s[e.normalizationField]):null;return(0,l.gf)(c)&&0!==c?o/c:null}(n,t,r),n,t,r,n.cache.ipData);return null==i||isNaN(i)?0:i}function b(e,t,r){return null==e?null:(0,l.of)(e)?v(e,t,r):(0,l.gf)(e)?e:null}function w(e,t,r){return(0,l.gf)(r)&&e>r?r:(0,l.gf)(t)&&e<t?t:e}function _(e,t,r,n,i){switch(t.transformationType){case l._w.Additive:return function(e,t,r,n){return e+((b(t.minSize,r,n)||t.minDataValue)??0)}(e,t,r,n);case l._w.Constant:return function(e,t,r){const n=e.stops;let i=n?.length&&n[0].size;return null==i&&(i=e.minSize),b(i,t,r)}(t,r,n);case l._w.ClampedLinear:return function(e,t,r,n){const i=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),s=b(t.minSize,r,n),o=b(t.maxSize,r,n),a=null!=n?n.shape:void 0;if(e<=t.minDataValue)return s;if(e>=t.maxDataValue)return o;if(null==s||null==o)return null;if("area"===t.scaleBy&&a){const e="circle"===a,t=e?h*(s/2)**2:s*s,r=t+i*((e?h*(o/2)**2:o*o)-t);return e?2*Math.sqrt(r/h):Math.sqrt(r)}return s+i*(o-s)}(e,t,r,n);case l._w.Proportional:return function(e,t,r,n){const i=null!=n?n.shape:void 0,s=e/t.minDataValue,o=b(t.minSize,r,n),a=b(t.maxSize,r,n);let l=null;return l="circle"===i?2*Math.sqrt(s*(o/2)**2):"square"===i||"diamond"===i||"image"===i?Math.sqrt(s*o**2):s*o,w(l,o,a)}(e,t,r,n);case l._w.Stops:return function(e,t,r,n,i){const[s,o,a]=M(e,i);if(s===o)return b(t.stops?.[s].size,r,n);{const e=b(t.stops?.[s].size,r,n);return e+(b(t.stops?.[o].size,r,n)-e)*a}}(e,t,r,n,i);case l._w.RealWorldSize:return function(e,t,r,n){const i=(n?.resolution??1)*a.j[t.valueUnit],s=b(t.minSize,r,n),o=b(t.maxSize,r,n),{valueRepresentation:l}=t;let u=null;return u="area"===l?2*Math.sqrt(e/h)/i:"radius"===l||"distance"===l?2*e/i:e/i,w(u,s,o)}(e,t,r,n);case l._w.Identity:return e;case l._w.Unknown:return null}}function S(e,t,r){const{isScaleDriven:n}=e.cache;if(!(n&&"3d"===r||t))return null;const i={scale:t,view:r};let s=b(e.minSize,d,i),o=b(e.maxSize,d,i);if(null!=s||null!=o){if(s>o){const e=o;o=s,s=e}return{minSize:s,maxSize:o}}}function I(e,t,r){if(!e.visualVariables)return;const n=[],i=[],s=[],o=[],a=[];for(const t of e.visualVariables)switch(t.type){case"color":i.push(t);break;case"opacity":s.push(t);break;case"rotation":a.push(t);break;case"size":o.push(t)}return i.forEach((e=>{const i=y(e,t,r);n.push({variable:e,value:i})})),s.forEach((e=>{const i=m(e,t,r);n.push({variable:e,value:i})})),a.forEach((e=>{const i=g(e,t,r);n.push({variable:e,value:i})})),o.forEach((e=>{const i=v(e,t,r);n.push({variable:e,value:i})})),n.filter((e=>null!=e.value))}function M(e,t){if(!t)return;let r=0,n=t.length-1;return t.some(((t,i)=>e<t?(n=i,!0):(r=i,!1))),[r,n,(e-t[r])/(t[n]-t[r])]}function T(e,t,r){const n=["proportional","proportional","proportional"];for(const i of e){const e=i.useSymbolValue?"symbol-value":v(i,t,r);switch(i.axis){case"width":n[0]=e;break;case"depth":n[1]=e;break;case"height":n[2]=e;break;case"width-and-depth":n[0]=e,n[1]=e;break;case"all":case void 0:case null:n[0]=e,n[1]=e,n[2]=e;break;default:(0,s.Xb)(i.axis)}}return n}},26765:function(e,t,r){r.d(t,{V:function(){return s},X:function(){return i}});var n=r(74697);function i(e){return{geometryType:(0,n.$B)(e[0]),geometries:e.map((e=>e.toJSON()))}}function s(e,t,r){const i=(0,n.xD)(t);return e.map((e=>{const t=i.fromJSON(e);return t.spatialReference=r,t}))}},35718:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(53804),i=(r(50917),r(23502)),s=(r(58941),r(40633),r(13798),r(65953)),o=r(43407),a=r(45532);let l=class extends o.A{constructor(e){super(e),this.layoutGeometry=null}};(0,n._)([(0,i.MZ)({type:a.default,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.Entity")],l);const u=l},43407:function(e,t,r){r.d(t,{A:function(){return l}});var n=r(53804),i=r(23502),s=(r(58941),r(40633),r(13798),r(65953)),o=r(56854);let a=class extends o.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a);const l=a},56854:function(e,t,r){r.d(t,{A:function(){return l}});var n=r(53804),i=r(30905),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953));let a=class extends i.oY{constructor(e){super(e),this.properties=null}};(0,n._)([(0,s.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.GraphObject")],a);const l=a},63288:function(e,t,r){r.d(t,{A:function(){return c}});var n=r(53804),i=r(23502),s=(r(58941),r(40633),r(13798),r(65953)),o=r(83525);let a=class extends o.A{constructor(e){super(e),this.openCypherQuery=""}};(0,n._)([(0,i.MZ)()],a.prototype,"openCypherQuery",void 0),a=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphQuery")],a);const l=a;let u=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,n._)([(0,i.MZ)()],u.prototype,"bindParameters",void 0),(0,n._)([(0,i.MZ)()],u.prototype,"bindGeometryQuantizationParameters",void 0),(0,n._)([(0,i.MZ)()],u.prototype,"outputQuantizationParameters",void 0),(0,n._)([(0,i.MZ)()],u.prototype,"outputSpatialReference",void 0),(0,n._)([(0,i.MZ)()],u.prototype,"provenanceBehavior",void 0),u=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],u);const c=u},81309:function(e,t,r){r.d(t,{A:function(){return a}});var n=r(53804),i=(r(40633),r(58941),r(13798),r(39819),r(65953)),s=r(56854);let o=class extends s.A{constructor(e){super(e)}};o=(0,n._)([(0,i.$)("esri.rest.knowledgeGraph.ObjectValue")],o);const a=o},67686:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(53804),i=r(30905),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953)),a=r(56854);let l=class extends i.oY{constructor(e){super(e),this.path=null}};(0,n._)([(0,s.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,n._)([(0,o.$)("esri.rest.knowledgeGraph.Path")],l);const u=l},89699:function(e,t,r){r.d(t,{A:function(){return u}});var n=r(53804),i=(r(50917),r(23502)),s=(r(58941),r(40633),r(13798),r(65953)),o=r(43407),a=r(91508);let l=class extends o.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,n._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,n._)([(0,i.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n._)([(0,s.$)("esri.rest.knowledgeGraph.Relationship")],l);const u=l},10361:function(e,t,r){var n,i,s,o,a,l,u;r.d(t,{Eq:function(){return n},bV:function(){return s},nP:function(){return a},r5:function(){return i},ti:function(){return l},vy:function(){return u},wr:function(){return o}}),function(e){e[e.Regular=0]="Regular",e[e.Provenance=1]="Provenance",e[e.Document=2]="Document"}(n||(n={})),function(e){e[e.esriFieldTypeSmallInteger=0]="esriFieldTypeSmallInteger",e[e.esriFieldTypeInteger=1]="esriFieldTypeInteger",e[e.esriFieldTypeSingle=2]="esriFieldTypeSingle",e[e.esriFieldTypeDouble=3]="esriFieldTypeDouble",e[e.esriFieldTypeString=4]="esriFieldTypeString",e[e.esriFieldTypeDate=5]="esriFieldTypeDate",e[e.esriFieldTypeOID=6]="esriFieldTypeOID",e[e.esriFieldTypeGeometry=7]="esriFieldTypeGeometry",e[e.esriFieldTypeBlob=8]="esriFieldTypeBlob",e[e.esriFieldTypeRaster=9]="esriFieldTypeRaster",e[e.esriFieldTypeGUID=10]="esriFieldTypeGUID",e[e.esriFieldTypeGlobalID=11]="esriFieldTypeGlobalID",e[e.esriFieldTypeXML=12]="esriFieldTypeXML",e[e.esriFieldTypeBigInteger=13]="esriFieldTypeBigInteger",e[e.esriFieldTypeDateOnly=14]="esriFieldTypeDateOnly",e[e.esriFieldTypeTimeOnly=15]="esriFieldTypeTimeOnly",e[e.esriFieldTypeTimestampOffset=16]="esriFieldTypeTimestampOffset"}(i||(i={})),function(e){e[e.esriGeometryNull=0]="esriGeometryNull",e[e.esriGeometryPoint=1]="esriGeometryPoint",e[e.esriGeometryMultipoint=2]="esriGeometryMultipoint",e[e.esriGeometryPolyline=3]="esriGeometryPolyline",e[e.esriGeometryPolygon=4]="esriGeometryPolygon",e[e.esriGeometryEnvelope=5]="esriGeometryEnvelope",e[e.esriGeometryAny=6]="esriGeometryAny",e[e.esriGeometryMultiPatch=7]="esriGeometryMultiPatch"}(s||(s={})),function(e){e[e.esriMethodHintUNSPECIFIED=0]="esriMethodHintUNSPECIFIED",e[e.esriUUIDESRI=1]="esriUUIDESRI",e[e.esriUUIDRFC4122=2]="esriUUIDRFC4122"}(o||(o={})),function(e){e[e.esriTypeUNSPECIFIED=0]="esriTypeUNSPECIFIED",e[e.esriTypeEntity=1]="esriTypeEntity",e[e.esriTypeRelationship=2]="esriTypeRelationship",e[e.esriTypeBoth=4]="esriTypeBoth"}(a||(a={})),function(e){e[e.esriGraphPropertyUNSPECIFIED=0]="esriGraphPropertyUNSPECIFIED",e[e.esriGraphPropertyRegular=1]="esriGraphPropertyRegular",e[e.esriGraphPropertyDocumentName=2]="esriGraphPropertyDocumentName",e[e.esriGraphPropertyDocumentTitle=3]="esriGraphPropertyDocumentTitle",e[e.esriGraphPropertyDocumentUrl=4]="esriGraphPropertyDocumentUrl",e[e.esriGraphPropertyDocumentText=5]="esriGraphPropertyDocumentText",e[e.esriGraphPropertyDocumentKeywords=6]="esriGraphPropertyDocumentKeywords",e[e.esriGraphPropertyDocumentContentType=7]="esriGraphPropertyDocumentContentType",e[e.esriGraphPropertyDocumentMetadata=8]="esriGraphPropertyDocumentMetadata",e[e.esriGraphPropertyDocumentFileExtension=9]="esriGraphPropertyDocumentFileExtension",e[e.esriGraphPropertyProvenanceInstanceId=10]="esriGraphPropertyProvenanceInstanceId",e[e.esriGraphPropertyProvenanceSourceType=11]="esriGraphPropertyProvenanceSourceType",e[e.esriGraphPropertyProvenanceSourceName=12]="esriGraphPropertyProvenanceSourceName",e[e.esriGraphPropertyProvenanceSource=13]="esriGraphPropertyProvenanceSource",e[e.esriGraphPropertyProvenanceComment=14]="esriGraphPropertyProvenanceComment",e[e.esriGraphPropertyProvenanceTypeName=15]="esriGraphPropertyProvenanceTypeName",e[e.esriGraphPropertyProvenancePropertyName=16]="esriGraphPropertyProvenancePropertyName"}(l||(l={})),function(e){e[e.esriIdentifierInfoTypeUNSPECIFIED=0]="esriIdentifierInfoTypeUNSPECIFIED",e[e.esriIdentifierInfoTypeDatabaseNative=1]="esriIdentifierInfoTypeDatabaseNative",e[e.esriIdentifierInfoTypeUniformProperty=2]="esriIdentifierInfoTypeUniformProperty"}(u||(u={}))},67147:function(e,t,r){r.d(t,{I:function(){return l}});var n=r(53216),i=r(58941);const s="esri/rest/knowledgeGraph/wasmInterface/";let o,a=null;async function l(){const e=a??o;if(e)return e;const t=!!(0,i.A)("wasm-simd");return o=u(t),o}async function u(e){if(e){const{default:e}=await r.e(128).then(r.bind(r,87082)).then((e=>e.a));return e({locateFile:e=>(0,n.s)(s+e)})}const{default:t}=await r.e(4254).then(r.bind(r,63478)).then((e=>e.a));return t({locateFile:e=>(0,n.s)(s+e)})}},71165:function(e,t,r){r.r(t),r.d(t,{_fetchWrapper:function(){return Qe},_getClientDataCacheCopy:function(){return Ve},clearClientDataCache:function(){return Ye},clientDataCache:function(){return Pe},executeApplyEdits:function(){return Ge},executeQuery:function(){return je},executeQueryStreaming:function(){return ze},executeSearch:function(){return Ue},executeSearchStreaming:function(){return qe},fetchAllClientDataKeys:function(){return Be},fetchClientDataAtKeys:function(){return $e},fetchKnowledgeGraph:function(){return He},kgRestServices:function(){return Ze},refreshDataModel:function(){return Je},refreshServiceDefinition:function(){return We}}),r(50917);var n=r(7156),i=r(93040),s=r(39819),o=r(40633),a=r(53804),l=r(83525),u=r(23502),c=(r(58941),r(13798),r(65953));let p=class extends l.A{constructor(e){super(e),this.headerKeys=[],this.outSpatialReference=null,this.exceededTransferLimit=!1}};(0,a._)([(0,u.MZ)()],p.prototype,"headerKeys",void 0),(0,a._)([(0,u.MZ)()],p.prototype,"outSpatialReference",void 0),(0,a._)([(0,u.MZ)()],p.prototype,"exceededTransferLimit",void 0),p=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphQueryResultHeader")],p);const d=p;let h=class extends l.A{constructor(e){super(e),this.resultRows=[],this.resultHeader=new d}};(0,a._)([(0,u.MZ)()],h.prototype,"resultRows",void 0),(0,a._)([(0,u.MZ)()],h.prototype,"resultHeader",void 0),h=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphQueryResult")],h);const f=h;let y=class extends l.A{constructor(e){super(e),this.resultRowsStream=new ReadableStream,this.resultHeader=new d}};(0,a._)([(0,u.MZ)()],y.prototype,"resultRowsStream",void 0),(0,a._)([(0,u.MZ)()],y.prototype,"resultHeader",void 0),y=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphQueryStreamingResult")],y);const m=y;var g=r(30905),v=r(57165);let b=class extends g.oY{constructor(e){super(e),this.name=null,this.unique=null,this.ascending=null,this.description=null,this.fieldNames=null}};(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],b.prototype,"name",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],b.prototype,"unique",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],b.prototype,"ascending",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],b.prototype,"description",void 0),(0,a._)([(0,u.MZ)({type:[String],json:{write:!0}})],b.prototype,"fieldNames",void 0),b=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.FieldIndex")],b);const w=b;let _=class extends g.oY{constructor(e){super(e),this.name=null,this.alias=null,this.fieldType=null,this.geometryType=null,this.hasM=null,this.hasZ=null,this.nullable=null,this.editable=null,this.required=null,this.defaultVisibility=null,this.systemMaintained=null,this.role=null,this.defaultValue=null}};(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"name",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"alias",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"fieldType",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"geometryType",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"hasM",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"hasZ",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"nullable",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"editable",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"required",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"defaultVisibility",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],_.prototype,"systemMaintained",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],_.prototype,"role",void 0),(0,a._)([(0,u.MZ)({json:{write:!0}})],_.prototype,"defaultValue",void 0),_=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphProperty")],_);const S=_;let I=class extends g.oY{constructor(e){super(e),this.name=null,this.alias=null,this.role=null,this.strict=null,this.properties=null,this.fieldIndexes=null,this.type=null}};(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"name",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"alias",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"role",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],I.prototype,"strict",void 0),(0,a._)([(0,u.MZ)({type:[S],json:{write:!0}})],I.prototype,"properties",void 0),(0,a._)([(0,u.MZ)({type:[w],json:{write:!0}})],I.prototype,"fieldIndexes",void 0),I=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphObjectType")],I);const M=I;let T=class extends M{constructor(e){super(e),this.type="entity"}};T=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.EntityType")],T);const x=T;let A=class extends M{constructor(e){super(e),this.endPoints=[],this.type="relationship"}};(0,a._)([(0,u.MZ)()],A.prototype,"endPoints",void 0),A=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.RelationshipType")],A);const E=A;let L=class extends g.oY{constructor(e){super(e),this.value=null,this.behavior=null}};(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],L.prototype,"value",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],L.prototype,"behavior",void 0),L=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.SourceTypeValueBehavior")],L);const C=L;let N=class extends g.oY{constructor(e){super(e),this.timestamp=null,this.spatialReference=null,this.strict=null,this.objectIdField=null,this.globalIdField=null,this.arcgisManaged=null,this.identifierInfo=null,this.searchIndexes=null,this.entityTypes=null,this.relationshipTypes=null,this.metaEntityTypes=null,this.provenanceSourceTypeValues=null}};(0,a._)([(0,u.MZ)({type:Date,json:{type:Number,write:{writer:(e,t)=>{t.timestamp=e?.getTime()}}}})],N.prototype,"timestamp",void 0),(0,a._)([(0,u.MZ)({type:v.A,json:{write:!0}})],N.prototype,"spatialReference",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],N.prototype,"strict",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],N.prototype,"objectIdField",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],N.prototype,"globalIdField",void 0),(0,a._)([(0,u.MZ)()],N.prototype,"arcgisManaged",void 0),(0,a._)([(0,u.MZ)()],N.prototype,"identifierInfo",void 0),(0,a._)([(0,u.MZ)()],N.prototype,"searchIndexes",void 0),(0,a._)([(0,u.MZ)({type:[x],json:{write:!0}})],N.prototype,"entityTypes",void 0),(0,a._)([(0,u.MZ)({type:[E],json:{write:!0}})],N.prototype,"relationshipTypes",void 0),(0,a._)([(0,u.MZ)({type:[x],json:{write:!0}})],N.prototype,"metaEntityTypes",void 0),(0,a._)([(0,u.MZ)({type:[C],json:{write:!0}})],N.prototype,"provenanceSourceTypeValues",void 0),N=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.DataModel")],N);const R=N;let O=class extends g.oY{constructor(e){super(e),this.capabilities=[],this.supportsSearch=!1,this.supportedQueryFormats=[],this.allowGeometryUpdates=!1,this.searchMaxRecordCount=null,this.serviceCapabilities=null,this.maxRecordCount=null,this.description="",this.copyrightText="",this.units="",this.spatialReference=null,this.currentVersion=null,this.dateFieldsTimeReference=null,this.serviceItemId="",this.supportsDocuments=!1,this.dataEditingNotSupported=!1,this.schemaEditingNotSupported=!1,this.supportsProvenance=!1}};(0,a._)([(0,u.MZ)({type:[String],json:{write:!0}})],O.prototype,"capabilities",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"supportsSearch",void 0),(0,a._)([(0,u.MZ)({type:[String],json:{write:!0}})],O.prototype,"supportedQueryFormats",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"allowGeometryUpdates",void 0),(0,a._)([(0,u.MZ)({type:Number,json:{write:!0}})],O.prototype,"searchMaxRecordCount",void 0),(0,a._)([(0,u.MZ)({type:Object,json:{write:!0}})],O.prototype,"serviceCapabilities",void 0),(0,a._)([(0,u.MZ)({type:Number,json:{write:!0}})],O.prototype,"maxRecordCount",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],O.prototype,"description",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],O.prototype,"copyrightText",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],O.prototype,"units",void 0),(0,a._)([(0,u.MZ)({type:v.A,json:{write:!0}})],O.prototype,"spatialReference",void 0),(0,a._)([(0,u.MZ)({type:Number,json:{write:!0}})],O.prototype,"currentVersion",void 0),(0,a._)([(0,u.MZ)({type:Object,json:{write:!0}})],O.prototype,"dateFieldsTimeReference",void 0),(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],O.prototype,"serviceItemId",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"supportsDocuments",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"dataEditingNotSupported",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"schemaEditingNotSupported",void 0),(0,a._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],O.prototype,"supportsProvenance",void 0),O=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.ServiceDefinition")],O);const F=O;let k=class extends g.oY{constructor(e){super(e),this.dataModel=null,this.serviceDefinition=null}};(0,a._)([(0,u.MZ)({type:String,json:{write:!0}})],k.prototype,"url",void 0),(0,a._)([(0,u.MZ)({type:R,json:{write:!0}})],k.prototype,"dataModel",void 0),(0,a._)([(0,u.MZ)({type:F,json:{write:!0}})],k.prototype,"serviceDefinition",void 0),k=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.KnowledgeGraph")],k);const D=k;function P(e,t,r){if(0!==e.error_code)throw new s.A(t,r,{errorCode:e.error_code,errorMessage:e.error_message})}function V(e,t,r,n=!1){const i=new r.ClientDataFetchRequestEncoder;i.deleteLater();for(const s of e){const e=Z(s,t,r,n);i.add_client_data_fetch_request_parameter(e)}i.encode();const s=i.get_encoding_result();return P(s.error,"knowledge-graph:fetchClientDataAtKeys-encoding-failed","Attempting to encode the fetchClientDataAtKeys failed"),structuredClone(s.get_byte_buffer())}function Z(e,t,r,n){const i=new r.ClientDataKey;i.deleteLater(),i.key_string=e;const s=new r.ClientDataFetchRequestParameter;s.deleteLater(),s.set_key(i);const o=t.get(e);return o&&!n&&(s.v_tag={v_tag:o.version}),s}var G,j,z,U=r(67147),q=r(71673),B=r(45532),$=r(44740),H=r(91508);!function(e){e[e.OBJECT=0]="OBJECT",e[e.ENTITY=1]="ENTITY",e[e.RELATIONSHIP=2]="RELATIONSHIP",e[e.PATH=3]="PATH",e[e.ARRAY=4]="ARRAY"}(G||(G={})),function(e){e[e.view=0]="view",e[e.edit=1]="edit"}(j||(j={})),function(e){e[e.exclude=0]="exclude",e[e.include=1]="include"}(z||(z={}));var J=r(46556);function W(e,t){const r=new t.ArrayValue;return r.deleteLater(),e.forEach((e=>{r.add_value(K(e,t))})),r}function Y(e,t){const r=new t.ObjectValue;r.deleteLater();for(const[n,i]of Object.entries(e))r.set_key_value(n,K(i,t));return r}function Q(e,t){if(e instanceof q.A)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.geometry_type=r.geometry_type=t.esriGeometryType.esriGeometryMultipoint,r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],i=[];i[0]=e.points.length;let s=0;return e.points.forEach((e=>{e.forEach((e=>{n[s]=e,s++}))})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);if(e instanceof B.default)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.geometry_type=t.esriGeometryType.esriGeometryPoint,r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],i=[];i[0]=1,n[0]=e.x,n[1]=e.y;let s=2;return e.hasZ&&(n[s]=e.z,s++),e.hasM&&(n[s]=e.m,s++),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);if(e instanceof H.A||e instanceof $.A)return function(e,t){const r=new t.GeometryValue;r.deleteLater(),r.has_z=e.hasZ,r.has_m=e.hasM;const n=[],i=[];let s=[];e instanceof H.A?(r.geometry_type=t.esriGeometryType.esriGeometryPolyline,s=e.paths):e instanceof $.A&&(r.geometry_type=t.esriGeometryType.esriGeometryPolygon,s=e.rings);let o=0,a=0;return s.forEach((e=>{let t=0;e.forEach((e=>{t++,e.forEach((e=>{n[a]=e,a++}))})),i[o]=t,o++})),r.coords=new Float64Array(n),r.lengths=new Uint32Array(i),r}(e,t);throw new s.A("knowledge-graph:unsupported-geometry","Only Point, Multipoint, Polyline, and Polygon geometry are supported by ArcGIS Knowledge",{geometry:e})}function K(e,t){if(null==e)return"";if("object"!=typeof e)return e;if(e instanceof Date)return e;if(e instanceof J.A)return Q(e,t);if(Array.isArray(e)){const r=new t.ArrayValue;return r.deleteLater(),e.forEach((e=>{r.add_value(K(e,t))})),r}return Y(e,t)}var X,ee,te,re,ne=r(35718),ie=r(89699);function se(e,t){if(!e.typeName)throw new s.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits");if(e instanceof ne.A){const r=new t.EntityValue;r.deleteLater(),r.type_name=e.typeName;for(const[n,i]of Object.entries(e.properties))r.set_key_value(n,oe(i,t));return e.id&&r.set_id(e.id),r}if(e instanceof ie.A){const r=new t.RelationshipValue;r.deleteLater(),r.type_name=e.typeName;for(const[n,i]of Object.entries(e.properties))r.set_key_value(n,oe(i,t));return e.id&&r.set_id(e.id),e.originId&&e.destinationId&&r.set_related_entity_ids(e.originId,e.destinationId),r}throw new s.A("knowledge-graph:applyEdits-encoding-failure","Could not determine the type of a named graph object passed to the encoder")}function oe(e,t){return null==e?null:"object"!=typeof e||e instanceof Date?e:e instanceof J.A?Q(e,t):null}!function(e){e[e.ClientDataKeyTypeUNSPECIFIED=0]="ClientDataKeyTypeUNSPECIFIED",e[e.ClientDataKeyTypeString=1]="ClientDataKeyTypeString"}(X||(X={})),function(e){e[e.ClientDataTypeUNSPECIFIED=0]="ClientDataTypeUNSPECIFIED",e[e.ClientDataTypeString=1]="ClientDataTypeString"}(ee||(ee={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.ClientData=1]="ClientData",e[e.NotModified=2]="NotModified"}(te||(te={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Error=1]="Error",e[e.ClientDataValue=2]="ClientDataValue"}(re||(re={}));let ae=class extends l.A{constructor(e){super(e),this.name=null,this.supportedCategory=null,this.analyzers=[],this.searchProperties=new Map}};(0,a._)([(0,u.MZ)()],ae.prototype,"name",void 0),(0,a._)([(0,u.MZ)()],ae.prototype,"supportedCategory",void 0),(0,a._)([(0,u.MZ)()],ae.prototype,"analyzers",void 0),(0,a._)([(0,u.MZ)()],ae.prototype,"searchProperties",void 0),ae=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.SearchIndex")],ae);const le=ae;var ue=r(10361);let ce=!1;function pe(e){return e.deleteLater(),new x(he(e))}function de(e){return e.deleteLater(),new w({name:e.name,unique:e.unique,ascending:e.ascending,description:e.description,fieldNames:ve(e.fields)})}function he(e){return{name:e.name,alias:e.alias,role:ue.Eq[e.role.value]?ue.Eq[e.role.value]:null,strict:e.strict,properties:be(e.properties),fieldIndexes:we(e.field_indexes)}}function fe(e){return e.deleteLater(),new S({alias:e.alias,name:e.name,fieldType:ue.r5[e.field_type.value]?ue.r5[e.field_type.value]:null,geometryType:ue.bV[e.geometry_type.value]?ue.bV[e.geometry_type.value]:null,hasM:e.has_m,hasZ:e.has_z,nullable:e.nullable,editable:e.editable,required:e.required,defaultVisibility:e.default_visibility,systemMaintained:e.system_maintained,role:ue.ti[e.role.value],defaultValue:e.default_value})}function ye(e){e.deleteLater();const t=he(e),r=[];for(let t=0;t<e.end_points.size();t++){const n=e.end_points.get(t);r.push({originEntityType:n.origin_entity_type,destinationEntityType:n.dest_entity_type})}return e.end_points.delete(),new E(Object.assign({endPoints:r},t))}function me(e){return new C({behavior:e.behavior,value:e.value})}function ge(e){const t=[];for(let r=0;r<e.size();r++)t.push(pe(e.get(r)));return e.delete(),t}function ve(e){const t=[];for(let r=0;r<e.size();r++)t.push(e.get(r));return e.delete(),t}function be(e){const t=[];for(let r=0;r<e.size();r++){const n=fe(e.get(r));"esriFieldTypeBigInteger"===n.fieldType&&(ce=!0),t.push(n)}return e.delete(),t}function we(e){const t=[];for(let r=0;r<e.size();r++)t.push(de(e.get(r)));return e.delete(),t}function _e(e){const t=[];for(let r=0;r<e.size();r++)t.push(ye(e.get(r)));return e.delete(),t}function Se(e){const t=[];for(let r=0;r<e.size();r++){const n=e.get(r);n.deleteLater(),t.push(me(n))}return e.delete(),t}function Ie(e){const t=[];for(let r=0;r<e.size();r++){const r=new le,n=e.get(0);r.name=n.name,r.supportedCategory=ue.nP[n.supported_category.value];const i=n.analyzers.size();for(let e=0;e<i;e++)r.analyzers.push({name:n.analyzers.get(e).name});n.analyzers.delete();for(let e=0;e<n.search_properties.keys().size();e++){const t=n.search_properties.keys().get(e),i=n.search_properties.get(t),s=[];for(let e=0;e<i.property_names.size();e++)s.push(i.property_names.get(e));r.searchProperties.set(t,{propertyNames:s})}t.push(r)}return e.delete(),t}r(56854);var Me,Te=r(81309),xe=r(67686);function Ae(e,t){const r={paths:[],hasM:!1,hasZ:!1},n=Ee(e,r),{coords:i,geometry_type:o,lengths:a}=e;if(o.value!==t)throw new s.A("KnowledgeGraph:illegal-geometry-type","Illegal Geometry type for multipath conversion");let l=0;return a.forEach((e=>{const t=[];for(let r=0;r<e;r++){const e=[];for(let t=0;t<n;t++)e[t]=i[l],l++;t.push(e)}r.paths.push(t)})),r}function Ee(e,t){let r=2;return e.has_z?(t.hasZ=e.has_z,r++):t.hasZ=!1,e.has_m?(t.hasM=e.has_m,r++):t.hasM=!1,r}!function(e){e[e.ESRI_GEOMETRY_NULL=0]="ESRI_GEOMETRY_NULL",e[e.ESRI_GEOMETRY_POINT=1]="ESRI_GEOMETRY_POINT",e[e.ESRI_GEOMETRY_MULTIPOINT=2]="ESRI_GEOMETRY_MULTIPOINT",e[e.ESRI_GEOMETRY_POLYLINE=3]="ESRI_GEOMETRY_POLYLINE",e[e.ESRI_GEOMETRY_POLYGON=4]="ESRI_GEOMETRY_POLYGON",e[e.ESRI_GEOMETRY_ENVELOPE=5]="ESRI_GEOMETRY_ENVELOPE",e[e.ESRI_GEOMETRY_ANY=6]="ESRI_GEOMETRY_ANY",e[e.ESRI_GEOMETRY_MULTI_PATCH=7]="ESRI_GEOMETRY_MULTI_PATCH"}(Me||(Me={}));const Le=()=>o.A.getLogger("esri.rest.knowledgeGraph.WasmToQueryResponseObjConstructors");function Ce(e,t,r){return((e,t,r)=>{if(null==e)return null;if("object"!=typeof e)return e;if("getDate"in e)return e;if("geometry_type"in e)switch(e.geometry_type.value){case null:return null;case Me.ESRI_GEOMETRY_POINT:return function(e,t){const r={spatialReference:t};let n=2;Ee(e,r);const i=e.coords;return r.x=i[0],r.y=i[1],e.has_z&&(r.z=i[n],n++),e.has_m&&(r.m=i[n]),new B.default(r)}(e,r);case Me.ESRI_GEOMETRY_MULTIPOINT:return function(e,t){const r={spatialReference:t},n=Ee(e,r),i=e.lengths,s=e.coords,o=i[0];r.points=[];let a=0;for(let e=0;e<o;e++){const e=[];for(let t=0;t<n;t++)e[t]=s[a],a++;r.points.push(e)}return new q.A(r)}(e,r);case Me.ESRI_GEOMETRY_POLYLINE:return function(e,t){const{paths:r,hasM:n,hasZ:i}=Ae(e,Me.ESRI_GEOMETRY_POLYLINE);return new H.A({paths:r,hasM:n,hasZ:i,spatialReference:t})}(e,r);case Me.ESRI_GEOMETRY_POLYGON:return function(e,t){const{paths:r,hasM:n,hasZ:i}=Ae(e,Me.ESRI_GEOMETRY_POLYGON);return new $.A({rings:r,hasM:n,hasZ:i,spatialReference:t})}(e,r);case Me.ESRI_GEOMETRY_ENVELOPE:case Me.ESRI_GEOMETRY_MULTI_PATCH:return Le().warnOnce("Envelope and Multipatch are not supported on knowledge entities, but one of those geometry types was detected. Result interpreted as null"),null;case Me.ESRI_GEOMETRY_NULL:case Me.ESRI_GEOMETRY_ANY:default:return Le().warnOnce("Unknown or blank geometry type returned - Result interpreted as null"),null}else{if(!("object_value_type"in e))return Le().warnOnce("A decoded value came back of a type that is not supported. Result interpreted as null"),null;switch(e.object_value_type.value){case G.OBJECT:return function(e,t,r){return new Te.A(Re(e,t,r))}(e,t,r);case G.ENTITY:return Ne(e,t,r);case G.RELATIONSHIP:return Oe(e,t,r);case G.PATH:return function(e,t,r){const n=e.entity_count(),i=e.relationship_count(),s=[];for(let o=0;o<n;o++)s.push(Ne(e.get_entity_at(o),t,r)),o<i&&s.push(Oe(e.get_relationship_at(o),t,r));return new xe.A({path:s})}(e,t,r);case G.ARRAY:return function(e,t,r){const n=[],i=e.count();for(let s=0;s<i;s++){const i=e.get_value_at(s);n.push(Ce(i,t,r))}return n}(e,t,r);default:return Le().warnOnce("Unknown graph object type detected!  Result interpreted as null"),null}}})(e,t,r)}function Ne(e,t,r){const n=e.type_name,i=Re(e,t,r),s=e.get_id();return new ne.A(Object.assign({typeName:n,id:s},i))}function Re(e,t,r){const n={},i=e.key_count();for(let s=0;s<i;s++)n[e.get_key_at(s)]=Ce(e.get_value_at(s),t,r);return{properties:n}}function Oe(e,t,r){const n=e.type_name,i=Re(e,t,r);return new ie.A(Object.assign({typeName:n,id:e.get_id(),originId:e.get_origin_entity_id(),destinationId:e.get_destination_entity_id()},i))}function Fe(e){const t=[];for(let r=0;r<e.get_header_keys().size();r++)t.push(e.get_header_keys().get(r));const r=new v.A(e.get_out_sr());return new d({headerKeys:t,outSpatialReference:r,exceededTransferLimit:e.exceeded_transfer_limit()})}let ke=class extends l.A{constructor(e){super(e),this.hasError=null,this.error=null,this.editResults=[]}};(0,a._)([(0,u.MZ)()],ke.prototype,"hasError",void 0),(0,a._)([(0,u.MZ)()],ke.prototype,"error",void 0),(0,a._)([(0,u.MZ)()],ke.prototype,"editResults",void 0),ke=(0,a._)([(0,c.$)("esri.rest.knowledgeGraph.GraphApplyEditsResult")],ke);const De=ke,Pe=new Map,Ve=()=>new Map(Pe.entries()),Ze={fetchKnowledgeGraph:async e=>{const t=new D({url:e}),r=[];return r.push(Je(t)),r.push(We(t)),await Promise.all(r),t},refreshDataModel:async e=>{e.dataModel=await nt(e)},refreshServiceDefinition:async e=>{const t=(await(0,i.A)(e.url,{query:{f:"json"}})).data;return t.capabilities=t?.capabilities?.split(","),t.supportedQueryFormats=t?.supportedQueryFormats?.split(","),e.serviceDefinition=new F(t),e.serviceDefinition},executeQueryStreaming:async(e,t,r)=>{const n=`${e.url}/graph/query`;await Ke(e);const i=await et(n,r);if(!e.serviceDefinition?.supportsProvenance&&"include"===t.provenanceBehavior)throw new s.A("knowledge-graph:provenance-not-supported","The Knowledge Graph Service definition indicated that provenance is not supported");i.data.body=await async function(e,t){const r=await(0,U.I)(),n=new r.GraphQueryRequestEncoder;if(n.deleteLater(),e.outputSpatialReference?n.output_spatial_reference={wkid:e.outputSpatialReference.wkid,latestWkid:e.outputSpatialReference.latestWkid,vcsWkid:e.outputSpatialReference.vcsWkid,latestVcsWkid:e.outputSpatialReference.latestVcsWkid,wkt:e.outputSpatialReference.wkt??""}:n.output_spatial_reference=r.SpatialReferenceUtil.WGS84(),n.open_cypher_query=e.openCypherQuery,e.bindParameters)for(const[t,i]of Object.entries(e.bindParameters))Xe(t,i,n,r);if(e.bindGeometryQuantizationParameters)!function(e,t){t.input_quantization_parameters={xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}(e.bindGeometryQuantizationParameters,n);else{if(t.dataModel||await Je(t),4326!==t.dataModel?.spatialReference?.wkid)throw new s.A("knowledge-graph:SR-quantization-mismatch","If the DataModel indicates a coordinate system other than WGS84, inputQuantizationParameters must be provided to the query encoder");n.input_quantization_parameters=r.InputQuantizationUtil.WGS84_lossless()}e.outputQuantizationParameters&&function(e,t,r){if(!e.extent)throw new s.A("knowledge-graph:illegal-output-quantization","The Output quantization provided to the encoder had an illegal value as part of its extent",e.extent);if(!e.quantizeMode)throw new s.A("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal mode setting",e.quantizeMode);if(!e.tolerance)throw new s.A("knowledge-graph:illegal-output-quantization","The Output quantization contained an illegal tolerance setting",e.quantizeMode);t.output_quantization_parameters={extent:{xmax:e.extent.xmax,ymax:e.extent.ymax,xmin:e.extent.xmin,ymin:e.extent.ymin},quantize_mode:r.esriQuantizeMode[e.quantizeMode],tolerance:e.tolerance}}(e.outputQuantizationParameters,n,r),e.provenanceBehavior&&function(e,t){t.provenance_behavior={value:z[e]}}(e.provenanceBehavior,n);try{n.encode()}catch(e){throw new s.A("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{error:e})}const i=n.get_encoding_result();if(0!==i.error.error_code)throw new s.A("knowledge-graph:query-encoding-failed","Attempting to encode the query failed",{errorCode:i.error.error_code,errorMessage:i.error.error_message});return structuredClone(i.get_byte_buffer())}(t,e);const o=await Qe(i.data.url,i.data);if(e.dataModel){const t=await rt(o,e.dataModel);return new m({resultRowsStream:t.readableStream,resultHeader:t.resultHeader})}throw new s.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")},executeApplyEdits:async(e,t,r)=>{if(e.serviceDefinition?.dataEditingNotSupported)throw new s.A("knowledge-graph:data-editing-not-supported","The Knowledge Graph Service definition indicated that data editing is not supported");const n=`${e.url}/graph/applyEdits`;await Ke(e);const i=await et(n,r);return i.data.body=await async function(e,t){if(t.dataModel||await Je(t),!t.dataModel)throw new s.A("knowledge-graph:data-model-undefined","Encoding could not proceed because a data model was not provided and it could not be determined from the service");const r=await(0,U.I)(),n=!!e.options?.cascadeDelete,i=new r.GraphApplyEditsEncoder(r.SpatialReferenceUtil.WGS84(),e.options?.inputQuantizationParameters?function(e){return{xy_resolution:e.xyResolution,x_false_origin:e.xFalseOrigin,y_false_origin:e.yFalseOrigin,z_resolution:e.zResolution,z_false_origin:e.zFalseOrigin,m_resolution:e.mResolution,m_false_origin:e.mFalseOrigin}}(e.options?.inputQuantizationParameters):r.InputQuantizationUtil.WGS84_lossless());i.deleteLater(),i.cascade_delete=n;try{let t;e.entityAdds?.forEach((e=>{t=i.add_entity(se(e,r)),P(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),e.relationshipAdds?.forEach((e=>{if(!e.originId||!e.destinationId)throw new s.A("knowledge-graph:relationship-origin-destination-missing","When adding a new relationship, you must provide both an origin and destination id on the appropriate class property");t=i.add_relationship(se(e,r)),P(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),e.entityUpdates?.forEach((e=>{if(!e.id)throw new s.A("knowledge-graph:entity-id-missing","When updating an entity or relationship, you must specify the id on the class level property");t=i.update_entity(se(e,r)),P(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - an entity failed to be added to the encoder")})),e.relationshipUpdates?.forEach((e=>{if(!e.id)throw new s.A("knowledge-graph:relationship-id-missing","When updating an entity or relationship, you must specify the id on the class level property");t=i.update_relationship(se(e,r)),P(t,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits - a relationship failed to be added to the encoder")})),e.entityDeletes?.forEach((e=>{if(!e.typeName)throw new s.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");const t=i.make_delete_helper(e.typeName,!0);t.deleteLater(),e.ids?.forEach((e=>{t.delete_by_id(e)}))})),e.relationshipDeletes?.forEach((e=>{if(!e.typeName)throw new s.A("knowledge-graph:no-type-name","You must indicate the entity/relationship named object type to apply edits - delete");const t=i.make_delete_helper(e.typeName,!1);e.ids?.forEach((e=>{t.delete_by_id(e)}))})),i.encode()}catch(e){throw new s.A("knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed",{error:e})}const o=i.get_encoding_result();return P(o.error,"knowledge-graph:applyEdits-encoding-failed","Attempting to encode the applyEdits failed"),structuredClone(o.get_byte_buffer())}(t,e),async function(e){const t=e.headers.get("content-type");if(t?.includes("application/x-protobuf")){const t=await e.arrayBuffer(),r=new((await(0,U.I)()).GraphApplyEditsDecoder);return r.deleteLater(),r.decode(new Uint8Array(t)),function(e){const t=e.has_error(),r=new De({hasError:t,error:t?{errorCode:e.error.error_code,errorMessage:e.error.error_message}:null}),n=e.get_edit_results_count();for(let t=0;t<n;t++){const n=e.get_edit_results_at(t),i=e.get_edit_results_type_name_at(t),s=[],o=[],a=[],l=n.get_add_results_count(),u=n.get_update_results_count(),c=n.get_delete_results_count();for(let e=0;e<l;e++){const t=n.get_add_result_at(e);s.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}for(let e=0;e<u;e++){const t=n.get_update_result_at(e);o.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}for(let e=0;e<c;e++){const t=n.get_delete_result_at(e);a.push({id:t.id,error:{errorCode:t.error.error_code,errorMessage:t.error.error_message}})}r.editResults.push({typeName:i,adds:s,updates:o,deletes:a})}return r}(r)}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:t,data:e.text()})}(await Qe(i.data.url,i.data))},executeQuery:async(e,t,r)=>{const n=`${e.url}/graph/query`,o=await(0,i.A)(n,{responseType:"array-buffer",query:{f:"pbf",openCypherQuery:t.openCypherQuery,...r?.query},signal:r?.signal,timeout:r?.timeout}),a=o.getHeader?.("content-type"),l=o.data;if(a?.includes("application/x-protobuf")){const t=new((await(0,U.I)()).GraphQueryDecoder);if(t.deleteLater(),e.dataModel){const r=tt(t,l,e.dataModel);return new f({resultRows:r.resultRows,resultHeader:r.resultHeader})}throw new s.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:a,data:o.data})},executeSearch:async(e,t,r)=>{const n=t.typeCategoryFilter,o=`${e.url}/graph/search`,a=await(0,i.A)(o,{responseType:"array-buffer",query:{f:"pbf",searchQuery:`"${t.searchQuery}"`,typeCategoryFilter:n,...r?.query},signal:r?.signal,timeout:r?.timeout}),l=a.getHeader?.("content-type"),u=a.data;if(l?.includes("application/x-protobuf")){const t=new((await(0,U.I)()).GraphQueryDecoder);if(t.deleteLater(),e.dataModel){const r=tt(t,u,e.dataModel);return new f({resultRows:r.resultRows,resultHeader:r.resultHeader})}throw new s.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:l,data:a.data})},executeSearchStreaming:async(e,t,r)=>{const n=`${e.url}/graph/search`;await Ke(e);const i=await et(n,r);i.data.body=await async function(e){const t=await(0,U.I)(),r=new t.GraphSearchRequestEncoder;if(r.deleteLater(),r.search_query=e.searchQuery,r.type_category_filter=t.esriNamedTypeCategory[e.typeCategoryFilter],!0===e.returnSearchContext&&(r.return_search_context=e.returnSearchContext),null!=e.start&&e.start>0&&(r.start_index=e.start),null!=e.num&&(r.max_num_results=e.num),null!=e.idsFilter&&Array.isArray(e.idsFilter)&&e.idsFilter.length>0)try{r.set_ids_filter(W(e.idsFilter,t))}catch(e){throw new s.A("knowledge-graph:ids-format-error","Attempting to set ids filter failed.  This is usually caused by an incorrectly formatted UUID string",{error:e})}e.namedTypesFilter?.forEach((e=>{r.add_named_type_filter(e)}));try{r.encode()}catch(e){throw new s.A("knowledge-graph:search-encoding-failed","Attempting to encode the search failed",{error:e})}const n=r.get_encoding_result();if(0!==n.error.error_code)throw new s.A("knowledge-graph:search-encoding-failed","Attempting to get encoding result from the query failed",{errorCode:n.error.error_code,errorMessage:n.error.error_message});return structuredClone(n.get_byte_buffer())}(t);const o=await Qe(i.data.url,i.data);if(e.dataModel){const t=await rt(o,e.dataModel);return new m({resultRowsStream:t.readableStream,resultHeader:t.resultHeader})}throw new s.A("knowledge-graph:undefined-data-model","The KnowledgeGraph supplied did not have a data model")},fetchClientDataAtKeys:async(e,t,r={ignoreCache:!1})=>{if(!t.length)return new Map;let n=Pe.get(e.url||"");n||(n=new Map,Pe.set(e.url||"",n));const i=new Map(n.entries()),o=`${e.url}/clientData/fetch`;t=Array.from(new Set(t));const a=await(0,U.I)(),l=V(t,n,a,r.ignoreCache),u=await et(o,r.requestOptions);u.data.body=l;const c=await Qe(u.data.url,u.data),p=c.headers.get("content-type");if(p?.includes("application/x-protobuf")){const e=new a.ClientDataFetchResponseDecoder;e.deleteLater();const t=await c.arrayBuffer();return e.decode(new Uint8Array(t)),e.has_error()&&P(e.error,"knowledge-graph:fetchClientDataAtKeys-decoding-error","An error occurred while decoding the client data keys response"),function(e,t,r,n=!1){const i=new Map;for(let s=0;s<e.get_results_count();s++){const o=e.get_result_at(s);if(o.get_fetch_result_case().value!==re.ClientDataValue||0!==o.error().error_code){const e=o.get_key().key_string;r.has(e)&&t.delete(e);continue}const a=o.get_value(),l=o.get_key().key_string,u=r.get(l);let c;if(a.get_data_case().value===te.NotModified&&u)c=u.value;else{if(a.get_data_case().value!==te.ClientData)continue;{c=a.get_data().client_data_string;const e=o.get_value().get_v_tag().v_tag;n||t.set(l,{key:l,version:e,value:c})}}i.set(l,c)}return i}(e,n,i,r.ignoreCache)}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response when fetching client data",{responseType:p,data:c})},fetchAllClientDataKeys:async(e,t)=>{const r=`${e.url}/clientData`,n=await(0,i.A)(r,{responseType:"array-buffer",query:{f:"pbf"},signal:t?.signal,timeout:t?.timeout}),o=n.getHeader?.("content-type"),a=n.data;if(o?.includes("application/x-protobuf")){const e=new((await(0,U.I)()).ClientDataKeysResponseDecoder);return e.deleteLater(),e.decode(new Uint8Array(a)),e.has_error()&&P(e.error,"knowledge-graph:fetchAllClientDataKeys-decoding-error","An error occurred while decoding the client data keys response"),function(e){const t=e.get_keys(),r=new Array;for(let e=0;e<t.get_keys_count();e++){const n=t.get_key_at(e);n.get_client_data_key_type().value===X.ClientDataKeyTypeString&&r.push(n.key_string)}return r}(e)}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:o,data:n.data})},clearClientDataCache:()=>Pe.clear(),_fetchWrapper:async(e,t)=>fetch(e,t)};async function Ge(e,t,r){return Ze.executeApplyEdits(e,t,r)}async function je(e,t,r){return Ze.executeQuery(e,t,r)}async function ze(e,t,r){return Ze.executeQueryStreaming(e,t,r)}async function Ue(e,t,r){return Ze.executeSearch(e,t,r)}async function qe(e,t,r){return Ze.executeSearchStreaming(e,t,r)}function Be(e,t){return Ze.fetchAllClientDataKeys(e,t)}function $e(e,t,r){return Ze.fetchClientDataAtKeys(e,t,r)}async function He(e){return Ze.fetchKnowledgeGraph(e)}async function Je(e){return Ze.refreshDataModel(e)}async function We(e){return Ze.refreshServiceDefinition(e)}function Ye(){return Ze.clearClientDataCache()}async function Qe(e,t){return Ze._fetchWrapper(e,t)}async function Ke(e){const t=n.id?.findCredential(e.url);t||(e.dataModel?await nt(e):await Je(e))}function Xe(e,t,r,n){null==t?r.set_param_key_value(e,""):"object"!=typeof t||t instanceof Date?r.set_param_key_value(e,t):t instanceof J.A?r.set_param_key_value(e,Q(t,n)):Array.isArray(t)?r.set_param_key_value(e,W(t,n)):r.set_param_key_value(e,Y(t,n))}async function et(e,t){return(0,i.A)(e,{responseType:"native-request-init",method:"post",query:{f:"pbf",...t?.query},body:"x",headers:{"Content-Type":"application/octet-stream"},signal:t?.signal,timeout:t?.timeout})}function tt(e,t,r,n){e.push_buffer(new Uint8Array(t));const i=[];let o,a,l=0;for(;e.next_row();){o&&a||(o=n??Fe(e),a=o.outSpatialReference??new v.A({wkid:4326})),l||(l=e.get_header_keys().size());const t=new Array(l);for(let n=0;n<l;n++){const i=e.get_value(n);t[n]=Ce(i,r,a)}i.push(t)}if(e.has_error())throw new s.A("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded - inner row decoding",{errorCode:e.error.error_code,errorMessage:e.error.error_message});return{resultHeader:o,resultRows:i}}async function rt(e,t){const r=e.headers.get("content-type");if(e.headers.get("content-length")&&o.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("Found `Content-Length` header when expecting a streaming HTTP response! Please investigate whether all intermediate HTTP proxies and/or load balancers are configured such that they don't forcefully buffer the entire response before returning it to the client. A valid HTTP streaming response should use Chunked Transfer Encoding and not have a Content Length defined."),r?.includes("application/x-protobuf")){const r=e.body?.getReader(),n=new((await(0,U.I)()).GraphQueryDecoder);let i,a,l;n.deleteLater();const u=new Promise(((e,t)=>{a=e,l=t}));let c=!1;return{readableStream:new ReadableStream({async start(e){try{return function u(){return r?.read().then((({done:p,value:h})=>{try{if(p){let t;if(n.has_error()?t=new s.A("knowledge-graph:stream-decoding-error","One or more result rows were not successfully decoded - query stream done",{errorCode:n.error.error_code,errorMessage:n.error.error_message}):c||a(new d),r.releaseLock(),t)throw e.error(t),l(t),t;return void e.close()}const o=tt(n,h,t,i),f=o.resultRows;return f.length>0&&e.enqueue(f),!i&&o.resultHeader&&(i=o.resultHeader,a(o.resultHeader),c=!0),u()}catch(e){throw o.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").error(e),l(e),new s.A("knowledge-graph:unexpected-server-response","Error inside streaming data return parsing",{error:e})}}))}()}catch(t){r?.releaseLock(),e.error(new s.A("knowledge-graph:stream-decoding-error","The server returned a valid response, but there was an error decoding the response stream",{error:t})),e.close()}}}),resultHeader:await u}}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:r,data:e.text()})}async function nt(e){const t=`${e.url}/dataModel/queryDataModel`,r=await(0,i.A)(t,{responseType:"array-buffer",query:{f:"pbf"}}),n=r.getHeader?.("content-type"),a=r.data;if(n?.includes("application/x-protobuf")){const e=(await(0,U.I)()).decode_data_model_from_protocol_buffer(new Uint8Array(a));if(!e)throw new s.A("knowledge-graph:data-model-decode-failure","The server responded to the data model query, but the response failed to be decoded.  This typically occurs when the Knowledge JS API (4.26 or later) is used with an unsupported backend (11.0 or earlier)");return function(e){e.deleteLater(),ce=!1;const t=new R({timestamp:e.timestamp,spatialReference:new v.A(e.spatial_reference),strict:e.strict,objectIdField:e.objectid_property,globalIdField:e.globalid_property,arcgisManaged:e.arcgis_managed,identifierInfo:{identifierMappingInfo:{identifierInfoType:ue.vy[e.identifier_info?.identifier_mapping_info?.identifier_info_type?.value],databaseNativeIdentifier:e.identifier_info?.identifier_mapping_info?.database_native_identifier,uniformPropertyIdentifier:{identifierPropertyName:e.identifier_info?.identifier_mapping_info?.uniform_property_identifier?.identifier_property_name}},identifierGenerationInfo:{uuidMethodHint:ue.wr[e.identifier_info?.identifier_generation_info?.uuid_method_hint?.value]}},searchIndexes:Ie(e.search_indexes),entityTypes:ge(e.entity_types),relationshipTypes:_e(e.relationship_types),metaEntityTypes:ge(e.meta_entity_types),provenanceSourceTypeValues:Se(e.provenance_source_type_values.value_behavior_array)});return ce&&o.A.getLogger("esri.rest.knowledgeGraph.knowledgeGraphService").warnOnce("A big integer field was detected in the retrieved data model.  The `big-integer` field type is not fully supported in web clients.  Please see https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-support-Field.html#type"),t}(e)}throw new s.A("knowledge-graph:unexpected-server-response","server returned an unexpected response",{responseType:n,data:r.data})}},30698:function(e,t,r){r.d(t,{A:function(){return h}});var n,i=r(53804),s=r(52874),o=r(21609),a=r(23502),l=r(67888),u=r(74376),c=r(65953),p=r(9035);let d=n=class extends p.A{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new n({fromColor:(0,o.o8)(this.fromColor),toColor:(0,o.o8)(this.toColor),algorithm:this.algorithm})}};(0,i._)([(0,u.e)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],d.prototype,"algorithm",void 0),(0,i._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],d.prototype,"fromColor",void 0),(0,i._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],d.prototype,"toColor",void 0),(0,i._)([(0,a.MZ)({type:["algorithmic"]})],d.prototype,"type",void 0),d=n=(0,i._)([(0,c.$)("esri.rest.support.AlgorithmicColorRamp")],d);const h=d},42783:function(e,t,r){r.d(t,{A:function(){return d}});var n,i=r(53804),s=r(30905),o=r(21609),a=r(23502),l=r(67888),u=r(65953),c=r(81392);let p=n=class extends s.oY{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new n((0,o.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,i._)([(0,a.MZ)({type:[String],json:{write:!0}})],p.prototype,"attachmentTypes",void 0),(0,i._)([(0,a.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],p.prototype,"attachmentsWhere",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],p.prototype,"cacheHint",void 0),(0,i._)([(0,a.MZ)({type:[String],json:{write:!0}})],p.prototype,"keywords",void 0),(0,i._)([(0,a.MZ)({type:[String],json:{write:!0}})],p.prototype,"globalIds",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"name",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],p.prototype,"num",void 0),(0,i._)([(0,a.MZ)({type:[Number],json:{write:!0}})],p.prototype,"objectIds",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{default:!1,write:!0}})],p.prototype,"returnMetadata",void 0),(0,i._)([(0,a.MZ)({type:[Number],json:{write:!0}})],p.prototype,"size",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],p.prototype,"start",void 0),(0,i._)([(0,c.K)("start"),(0,c.K)("num")],p.prototype,"writeStart",null),(0,i._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],p.prototype,"where",void 0),p=n=(0,i._)([(0,u.$)("esri.rest.support.AttachmentQuery")],p),p.from=(0,l.dp)(p);const d=p},74373:function(e,t,r){r.d(t,{A:function(){return d}});var n=r(53804),i=r(73037),s=r(30905),o=r(23502),a=(r(58941),r(40633),r(13798),r(74376)),l=r(65953);const u=new i.J({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),c=new i.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let p=class extends s.oY{constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};(0,n._)([(0,a.e)({classBreaksDef:"class-breaks-definition"})],p.prototype,"type",void 0),(0,n._)([(0,o.MZ)({json:{write:!0}})],p.prototype,"breakCount",void 0),(0,n._)([(0,o.MZ)({json:{write:!0}})],p.prototype,"classificationField",void 0),(0,n._)([(0,o.MZ)({type:String,json:{read:u.read,write:u.write}})],p.prototype,"classificationMethod",void 0),(0,n._)([(0,o.MZ)({json:{write:!0}})],p.prototype,"normalizationField",void 0),(0,n._)([(0,o.MZ)({json:{read:c.read,write:c.write}})],p.prototype,"normalizationType",void 0),(0,n._)([(0,o.MZ)({value:null,json:{write:!0}})],p.prototype,"standardDeviationInterval",null),(0,n._)([(0,o.MZ)({value:null,json:{write:!0}})],p.prototype,"definedInterval",null),p=(0,n._)([(0,l.$)("esri.rest.support.ClassBreaksDefinition")],p);const d=p},9035:function(e,t,r){r.d(t,{A:function(){return l}});var n=r(53804),i=r(30905),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953));let a=class extends i.oY{constructor(e){super(e),this.type=null}};(0,n._)([(0,s.MZ)({readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.$)("esri.rest.support.ColorRamp")],a);const l=a},51084:function(e,t,r){r.d(t,{A:function(){return b}});var n,i=r(53804),s=r(50917),o=r(59469),a=r(73037),l=r(30905),u=r(21609),c=r(23502),p=(r(58941),r(40633),r(47332)),d=r(65953),h=r(81392),f=r(57165),y=r(74697),m=r(56740);const g=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=n=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const r=f.A.fromJSON(t.spatialReference),n=[];for(let t=0;t<e.length;t++){const i=e[t],s=o.default.fromJSON(i),a=i.geometry?.spatialReference;null==s.geometry||a||(s.geometry.spatialReference=r);const l=i.aggregateGeometries,u=s.aggregateGeometries;if(l&&null!=u)for(const e in u){const t=u[e],n=l[e],i=n?.spatialReference;null==t||i||(t.spatialReference=r)}n.push(s)}return n}writeGeometryType(e,t,r,n){if(e)return void g.write(e,t,r,n);const{features:i}=this;if(i)for(const e of i)if(null!=e?.geometry)return void g.write(e.geometry.type,t,r,n)}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,n=(0,y.rS)(e);return n&&!r&&t.spatialReference&&(n.spatialReference=f.A.fromJSON(t.spatialReference)),n}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:r}=this;if(r)for(const e of r)if(e&&null!=e.geometry&&e.geometry.spatialReference)return void(t.spatialReference=e.geometry.spatialReference.toJSON())}clone(){return new n(this.cloneProperties())}cloneProperties(){return(0,u.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const n=t.features[r];if(n.geometry){const t=e?.[r];n.geometry=t?.toJSON()||n.geometry}}return t}quantize(e){const{scale:[t,r],translate:[n,i]}=e,s=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-n)/t)),(e=>Math.round((i-e)/r)));for(let e=0,t=s.length;e<t;e++)o?.(s[e].geometry)||(s.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:r}=this;if(!r)return this;const{translate:[n,i],scale:[s,o]}=r;let a=null,l=null;if(this.hasZ&&null!=r?.scale?.[2]){const{translate:[,,e],scale:[,,t]}=r;a=r=>r*t+e}if(this.hasM&&null!=r?.scale?.[3]){const{translate:[,,,e],scale:[,,,t]}=r;l=r=>null==r?r:r*t+e}const u=this._getHydrationFunction(e,(e=>e*s+n),(e=>i-e*o),a,l);for(const{geometry:e}of t)null!=e&&u&&u(e);return this.transform=null,this}_quantizePoints(e,t,r){let n,i;const s=[];for(let o=0,a=e.length;o<a;o++){const a=e[o];if(o>0){const e=t(a[0]),o=r(a[1]);e===n&&o===i||(s.push([e-n,o-i]),n=e,i=o)}else n=t(a[0]),i=r(a[1]),s.push([n,i])}return s.length>0?s:null}_getQuantizationFunction(e,t,r){return"point"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):"polyline"===e||"polygon"===e?e=>{const n=(0,y.Bi)(e)?e.rings:e.paths,i=[];for(let e=0,s=n.length;e<s;e++){const s=n[e],o=this._quantizePoints(s,t,r);o&&i.push(o)}return i.length>0?((0,y.Bi)(e)?e.rings=i:e.paths=i,e):null}:"multipoint"===e?e=>{const n=this._quantizePoints(e.points,t,r);return n&&n.length>0?(e.points=n,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,r,n,i){return"point"===e?e=>{e.x=t(e.x),e.y=r(e.y),n&&(e.z=n(e.z))}:"polyline"===e||"polygon"===e?e=>{const s=(0,y.Bi)(e)?e.rings:e.paths;let o,a;for(let e=0,n=s.length;e<n;e++){const n=s[e];for(let e=0,i=n.length;e<i;e++){const i=n[e];e>0?(o+=i[0],a+=i[1]):(o=i[0],a=i[1]),i[0]=t(o),i[1]=r(a)}}if(n&&i)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,r=t.length;e<r;e++){const r=t[e];r[2]=n(r[2]),r[3]=i(r[3])}}else if(n)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,r=t.length;e<r;e++){const r=t[e];r[2]=n(r[2])}}else if(i)for(let e=0,t=s.length;e<t;e++){const t=s[e];for(let e=0,r=t.length;e<r;e++){const r=t[e];r[2]=i(r[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax),n&&null!=e.zmax&&null!=e.zmin&&(e.zmax=n(e.zmax),e.zmin=n(e.zmin)),i&&null!=e.mmax&&null!=e.mmin&&(e.mmax=i(e.mmax),e.mmin=i(e.mmin))}:"multipoint"===e?e=>{const s=e.points;let o,a;for(let e=0,n=s.length;e<n;e++){const n=s[e];e>0?(o+=n[0],a+=n[1]):(o=n[0],a=n[1]),n[0]=t(o),n[1]=r(a)}if(n&&i)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=n(t[2]),t[3]=i(t[3])}else if(n)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=n(t[2])}else if(i)for(let e=0,t=s.length;e<t;e++){const t=s[e];t[2]=i(t[2])}}:null}};(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,i._)([(0,c.MZ)({type:[o.default],json:{write:!0}})],v.prototype,"features",void 0),(0,i._)([(0,p.w)("features")],v.prototype,"readFeatures",null),(0,i._)([(0,c.MZ)({type:[m.A],json:{write:!0}})],v.prototype,"fields",void 0),(0,i._)([(0,c.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,i._)([(0,h.K)("geometryType")],v.prototype,"writeGeometryType",null),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,i._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,i._)([(0,c.MZ)({types:s.yR,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,i._)([(0,p.w)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,i._)([(0,c.MZ)({type:f.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,i._)([(0,h.K)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,i._)([(0,c.MZ)({json:{write:!0}})],v.prototype,"transform",void 0),v=n=(0,i._)([(0,d.$)("esri.rest.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0;const b=v},96245:function(e,t,r){r.d(t,{A:function(){return p}});var n,i=r(53804),s=r(21609),o=r(23502),a=(r(58941),r(40633),r(65953)),l=r(30698),u=r(9035);let c=n=class extends u.A{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new n({colorRamps:(0,s.o8)(this.colorRamps)})}};(0,i._)([(0,o.MZ)({type:[l.A],json:{write:!0}})],c.prototype,"colorRamps",void 0),(0,i._)([(0,o.MZ)({type:["multipart"]})],c.prototype,"type",void 0),c=n=(0,i._)([(0,a.$)("esri.rest.support.MultipartColorRamp")],c);const p=c},95470:function(e,t,r){r.r(t),r.d(t,{default:function(){return f}});var n,i=r(53804),s=(r(50917),r(30905)),o=r(21609),a=r(23502),l=r(67888),u=r(65953),c=r(81392),p=r(66866),d=r(57165);let h=n=class extends s.oY{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(t.definitionExpression="1=1")}clone(){return new n((0,o.o8)({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,i._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],h.prototype,"cacheHint",void 0),(0,i._)([(0,a.MZ)({type:p.L,json:{write:!0}})],h.prototype,"dynamicDataSource",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],h.prototype,"gdbVersion",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],h.prototype,"geometryPrecision",void 0),(0,i._)([(0,a.MZ)({type:Date})],h.prototype,"historicMoment",void 0),(0,i._)([(0,c.K)("historicMoment")],h.prototype,"_writeHistoricMoment",null),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0}})],h.prototype,"maxAllowableOffset",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],h.prototype,"objectIds",void 0),(0,i._)([(0,a.MZ)({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0),(0,i._)([(0,a.MZ)({type:[String],json:{write:!0}})],h.prototype,"outFields",void 0),(0,i._)([(0,a.MZ)({type:d.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],h.prototype,"outSpatialReference",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],h.prototype,"relationshipId",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],h.prototype,"start",void 0),(0,i._)([(0,c.K)("start"),(0,c.K)("num")],h.prototype,"writeStart",null),(0,i._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],h.prototype,"num",void 0),(0,i._)([(0,a.MZ)({json:{write:!0}})],h.prototype,"returnGeometry",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],h.prototype,"returnM",void 0),(0,i._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],h.prototype,"returnZ",void 0),(0,i._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],h.prototype,"where",void 0),h=n=(0,i._)([(0,u.$)("esri.rest.support.RelationshipQuery")],h),h.from=(0,l.dp)(h);const f=h},85982:function(e,t,r){r.d(t,{g:function(){return o},r:function(){return a}});var n=r(30698),i=r(9035),s=r(96245);const o={key:"type",base:i.A,typeMap:{algorithmic:n.A,multipart:s.A}};function a(e){return e?.type?"algorithmic"===e.type?n.A.fromJSON(e):"multipart"===e.type?s.A.fromJSON(e):null:null}},49241:function(e,t,r){r.d(t,{t:function(){return o}});var n=r(40633);const i=()=>n.A.getLogger("esri.rest.support.generateRendererUtils");function s(e,t){return Number(e.toFixed(t))}function o(e){const{normalizationTotal:t}=e;return{classBreaks:a(e),normalizationTotal:t}}function a(e){const t=e.definition,{classificationMethod:r,normalizationType:n,definedInterval:i}=t,o=t.breakCount??1,a=[];let c=e.values;if(0===c.length)return[];c=c.sort(((e,t)=>e-t));const p=c[0],d=c[c.length-1];if("equal-interval"===r)if(c.length>=o){const e=(d-p)/o;let t=p;for(let r=1;r<o;r++){const i=s(p+r*e,6);a.push({minValue:t,maxValue:i,label:l(t,i,n)}),t=i}a.push({minValue:t,maxValue:d,label:l(t,d,n)})}else c.forEach((e=>{a.push({minValue:e,maxValue:e,label:l(e,e,n)})}));else if("natural-breaks"===r){const t=function(e){const t=[],r=[];let n=Number.MIN_VALUE,i=1,s=-1;for(let o=0;o<e.length;o++){const a=e[o];a===n?(i++,r[s]=i):null!==a&&(t.push(a),n=a,i=1,r.push(i),s++)}return{uniqueValues:t,valueFrequency:r}}(c),r=e.valueFrequency||t.valueFrequency,i=u(t.uniqueValues,r,o);let h=p;for(let e=1;e<o;e++)if(t.uniqueValues.length>e){const r=s(t.uniqueValues[i[e]],6);a.push({minValue:h,maxValue:r,label:l(h,r,n)}),h=r}a.push({minValue:h,maxValue:d,label:l(h,d,n)})}else if("quantile"===r)if(c.length>=o&&p!==d){let e=p,t=Math.ceil(c.length/o),r=0;for(let i=1;i<o;i++){let s=t+r-1;s>c.length&&(s=c.length-1),s<0&&(s=0),a.push({minValue:e,maxValue:c[s],label:l(e,c[s],n)}),e=c[s],r+=t,t=Math.ceil((c.length-r)/(o-i))}a.push({minValue:e,maxValue:d,label:l(e,d,n)})}else{let e=-1;for(let t=0;t<c.length;t++){const r=c[t];r!==e&&(e=r,a.push({minValue:e,maxValue:r,label:l(e,r,n)}),e=r)}}else if("standard-deviation"===r){const e=function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/=e.length,t}(c),t=function(e,t){let r=0;for(let n=0;n<e.length;n++){const i=e[n];r+=(i-t)*(i-t)}return r/=e.length,Math.sqrt(r)}(c,e);if(0===t)a.push({minValue:c[0],maxValue:c[0],label:l(c[0],c[0],n)});else{const r=function(e,t,r,n,i){let s=Math.max(n-e,t-n)/i/r;return s=s>=1?1:s>=.5?.5:.25,s}(p,d,o,e,t)*t;let i=0,u=p;for(let t=o;t>=1;t--){const o=s(e-(t-.5)*r,6);a.push({minValue:u,maxValue:o,label:l(u,o,n)}),u=o,i++}let c=s(e+.5*r,6);a.push({minValue:u,maxValue:c,label:l(u,c,n)}),u=c,i++;for(let t=1;t<=o;t++)c=i===2*o?d:s(e+(t+.5)*r,6),a.push({minValue:u,maxValue:c,label:l(u,c,n)}),u=c,i++}}else if("defined-interval"===r){if(!i)return a;const e=c[0],t=c[c.length-1],r=Math.ceil((t-e)/i);let o=e;for(let t=1;t<r;t++){const r=s(e+t*i,6);a.push({minValue:o,maxValue:r,label:l(o,r,n)}),o=r}a.push({minValue:o,maxValue:t,label:l(o,t,n)})}return a}function l(e,t,r){let n=null;return n=e===t?r&&"percent-of-total"===r?e+"%":e.toString():r&&"percent-of-total"===r?e+"% - "+t+"%":e+" - "+t,n}function u(e,t,r){const n=e.length,i=[];r>n&&(r=n);for(let e=0;e<r;e++)i.push(Math.round(e*n/r-1));i.push(n-1);let s=c(i,e,t,r);return function(e,t,r,n,i,s){let o=0,a=0,l=0,u=0,c=!0;for(let d=0;d<2&&c;d++){0===d&&(c=!1);for(let d=0;d<s-1;d++)for(;r[d+1]+1!==r[d+2];){r[d+1]=r[d+1]+1;const s=p(d,r,n,i);l=s.sbMean,o=s.sbSdcm;const h=p(d+1,r,n,i);if(u=h.sbMean,a=h.sbSdcm,!(o+a<t[d]+t[d+1])){r[d+1]=r[d+1]-1;break}t[d]=o,t[d+1]=a,e[d]=l,e[d+1]=u,c=!0}for(let d=s-1;d>0;d--)for(;r[d]!==r[d-1]+1;){r[d]=r[d]-1;const s=p(d-1,r,n,i);l=s.sbMean,o=s.sbSdcm;const h=p(d,r,n,i);if(u=h.sbMean,a=h.sbSdcm,!(o+a<t[d-1]+t[d])){r[d]=r[d]+1;break}t[d-1]=o,t[d]=a,e[d-1]=l,e[d]=u,c=!0}}return c}(s.mean,s.sdcm,i,e,t,r)&&(s=c(i,e,t,r)),i}function c(e,t,r,n){let i=[],s=[],o=[],a=0;const l=[],u=[];for(let i=0;i<n;i++){const n=p(i,e,t,r);l.push(n.sbMean),u.push(n.sbSdcm),a+=u[i]}let c,d=a,h=!0;for(;h||a<d;){h=!1,i=[];for(let t=0;t<n;t++)i.push(e[t]);for(let r=0;r<n;r++)for(let i=e[r]+1;i<=e[r+1];i++)if(c=t[i],r>0&&i!==e[r+1]&&Math.abs(c-l[r])>Math.abs(c-l[r-1]))e[r]=i;else if(r<n-1&&e[r]!==i-1&&Math.abs(c-l[r])>Math.abs(c-l[r+1])){e[r+1]=i-1;break}d=a,a=0,s=[],o=[];for(let i=0;i<n;i++){s.push(l[i]),o.push(u[i]);const n=p(i,e,t,r);l[i]=n.sbMean,u[i]=n.sbSdcm,a+=u[i]}}if(a>d){for(let t=0;t<n;t++)e[t]=i[t],l[t]=s[t],u[t]=o[t];a=d}return{mean:l,sdcm:u}}function p(e,t,r,n){let s=0,o=0;for(let i=t[e]+1;i<=t[e+1];i++){const e=n[i];s+=r[i]*e,o+=e}o<=0&&i().warn("Exception in Natural Breaks calculation");const a=s/o;let l=0;for(let i=t[e]+1;i<=t[e+1];i++)l+=n[i]*(r[i]-a)**2;return{sbMean:a,sbSdcm:l}}},39397:function(e,t,r){r.d(t,{Dl:function(){return o},jV:function(){return s},lF:function(){return a}}),r(25591),r(7156);var n=r(21609),i=r(90683);function s(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function o(e){return"string"==typeof e?(0,i.An)(e):(0,n.o8)(e)}function a(e,t,r){const n={};for(const i in e){if("declaredClass"===i)continue;const s=e[i];if(null!=s&&"function"!=typeof s)if(Array.isArray(s))n[i]=s.map((e=>a(e)));else if("object"==typeof s)if(s.toJSON){const e=s.toJSON(r?.[i]);n[i]=t?e:JSON.stringify(e)}else n[i]=t?s:JSON.stringify(s);else n[i]=s}return n}r(48893)},92586:function(e,t,r){r.d(t,{$r:function(){return m},Jc:function(){return b},gV:function(){return g},rb:function(){return v}}),r(50917),r(39819);var n=r(13520),i=r(45139),s=r(57165),o=r(87280),a=r(57652),l=r(53743),u=r(70181),c=r(33118),p=r(66164),d=r(54547),h=r(45532);let f=null;const y=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function m(e,t,r,n){const i=(0,a.d9)(r)?(0,a.Vp)(r):null,s=i?Math.round((i.valid[1]-i.valid[0])/t.scale[0]):null;return e.map((e=>{const r=new h.default(e.geometry);return(0,o.Gy)(t,r,r),e.geometry=i?function(e,t,r){return e.x<0?e.x+=t:e.x>r&&(e.x-=t),e}(r,s??0,n[0]):r,e}))}function g(e,t=18,r,i,s){const o=new Float64Array(i*s);t=Math.round((0,n.Lz)(t));let a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;const c=(0,u.YW)(r);for(const{geometry:r,attributes:n}of e){const{x:e,y:p}=r,d=Math.max(0,e-t),h=Math.max(0,p-t),f=Math.min(s,p+t),y=Math.min(i,e+t),m=+c(n);for(let r=h;r<f;r++)for(let n=d;n<y;n++){const s=r*i+n,c=(0,u.hv)(n-e,r-p,t)*m,d=o[s]+=c;a=Math.min(a,d),l=Math.max(l,d)}}return{min:a,max:l}}function v(e){const t=y.exec(e);if(!t)return null;const{hh:r,mm:n,ss:s,ms:o}=t.groups;return Number(r)*i.vf.hours+Number(n)*i.vf.minutes+Number(s)*i.vf.seconds+Number(o||0)}async function b(e,t,r=!0){if(!t)return[];const{field:n,field2:i,field3:o,fieldDelimiter:a,fieldInfos:u,timeZone:h}=e,y=n&&u?.find((e=>e.name.toLowerCase()===n.toLowerCase())),m=!!y&&(0,l.OH)(y),g=!!y&&(0,c.fs)(y),b=e.valueExpression,w=e.normalizationType,_=e.normalizationField,S=e.normalizationTotal,I=[],M=e.viewInfoParams;let T=null,x=null;if(b){if(!f){const{arcadeUtils:e}=await(0,d.lw)();f=e}f.hasGeometryOperations(b)&&await f.enableGeometryOperations(),T=f.createFunction(b),x=M?f.getViewInfo({viewingMode:M.viewingMode,scale:M.scale,spatialReference:new s.A(M.spatialReference)}):null}const A=e.fieldInfos,E=t[0]&&"declaredClass"in t[0]&&"esri.Graphic"===t[0].declaredClass||!A?null:{fields:A};return t.forEach((e=>{const t=e.attributes;let s;if(b){const t=E?{...e,layer:E}:e,r=f.createExecContext(t,x,h);s=f.executeFunction(T,r)}else t&&(s=t[n],i?(s=`${(0,p.gJ)(s)}${a}${(0,p.gJ)(t[i])}`,o&&(s=`${s}${a}${(0,p.gJ)(t[o])}`)):"string"==typeof s&&r&&(g?s=s?new Date(s).getTime():null:m&&(s=s?v(s):null)));if(w&&"number"==typeof s&&isFinite(s)){const e=t&&parseFloat(t[_]);s=(0,p.zS)(s,w,e,S)}I.push(s)})),I}},33118:function(e,t,r){r.d(t,{fs:function(){return o},i0:function(){return a}});var n=r(8289),i=r(53743),s=(r(54547),r(51107),r(21168));function o(e){return(0,i.vE)(e)||(0,i.zD)(e)||(0,i.Ah)(e)}function a(e,t){const{format:r,timeZoneOptions:i,fieldType:o}=t??{};let a,l;if(i&&({timeZone:a,timeZoneName:l}=(0,s.hv)(i.layerTimeZone,i.datesInUnknownTimezone,i.viewTimeZone,(0,n.J2)(r||"short-date-short-time"),o)),"string"==typeof e&&isNaN(Date.parse("time-only"===o?`1970-01-01T${e}Z`:e)))return e;switch(o){case"date-only":{const t=(0,n.J2)(r||"short-date");return"string"==typeof e?(0,n.iS)(e,{...t}):(0,n.Yq)(e,{...t,timeZone:s.n$})}case"time-only":{const t=(0,n.J2)(r||"short-time");return"string"==typeof e?(0,n.F8)(e,t):(0,n.Yq)(e,{...t,timeZone:s.n$})}case"timestamp-offset":{if(!a&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=r||i?(0,n.J2)(r||"short-date-short-time"):void 0,s=t?{...t,timeZone:a,timeZoneName:l}:void 0;return"string"==typeof e?(0,n.Ey)(e,s):(0,n.Yq)(e,s)}default:{const t=r||i?(0,n.J2)(r||"short-date-short-time"):void 0;return(0,n.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:a,timeZoneName:l}:void 0)}}}new Set(["integer","small-integer"])},66164:function(e,t,r){r.d(t,{$y:function(){return G},FM:function(){return b},G_:function(){return g},Rw:function(){return P},Vb:function(){return y},b3:function(){return O},gJ:function(){return f},jM:function(){return Z},lv:function(){return k},oZ:function(){return R},qg:function(){return v},z9:function(){return m},zS:function(){return D}});var n=r(74373),i=r(49241);const s="<Null>",o="equal-interval",a=1,l=5,u=10,c=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,p=new Set(["esriFieldTypeDate","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeOID","esriFieldTypeBigInteger"]),d=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),h=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function f(e){return null==e||"string"==typeof e&&!e?s:e}function y(e){const t=null!=e.normalizationField||null!=e.normalizationType,r=null!=e.minValue||null!=e.maxValue,n=!!e.sqlExpression&&e.supportsSQLExpression;return!t&&!r&&!n}function m(e){const{outStatisticTypes:t}=e,r=e.returnDistinct?[...new Set(e.values)]:e.values,n=r.filter((e=>null!=e)).sort(),i=n.length,s={count:i,min:n[0],max:n[i-1]};return e.supportsNullCount&&(s.nullcount=r.length-i),!e.percentileParams||t?.include?.length&&!t.include.includes("median")||t?.exclude?.length&&t.exclude.includes("median")||(s.median=v(r,e.percentileParams)),s}function g(e){const{values:t,useSampleStdDev:r,supportsNullCount:n,outStatisticTypes:i}=e;let s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=null,l=null,u=null,c=null,p=0;const d=null==e.minValue?-1/0:e.minValue,h=null==e.maxValue?1/0:e.maxValue;for(const e of t)Number.isFinite(e)?e>=d&&e<=h&&(a=null===a?e:a+e,s=Math.min(s,e),o=Math.max(o,e),p++):"string"==typeof e&&p++;if(p&&null!=a){l=a/p;let e=0;for(const r of t)Number.isFinite(r)&&r>=d&&r<=h&&(e+=(r-l)**2);c=r?p>1?e/(p-1):0:p>0?e/p:0,u=Math.sqrt(c)}else s=null,o=null;const f={avg:l,count:p,max:o,min:s,stddev:u,sum:a,variance:c};return n&&(f.nullcount=t.length-p),!e.percentileParams||i?.include?.length&&!i.include.includes("median")||i?.exclude?.length&&i.exclude.includes("median")||(f.median=v(t,e.percentileParams)),f}function v(e,t){const{fieldType:r,value:n,orderBy:i,isDiscrete:s}=t,o=b(r,"desc"===i);if(0===(e=[...e].filter((e=>null!=e)).sort(((e,t)=>o(e,t)))).length)return null;if(n<=0)return e[0];if(n>=1)return e[e.length-1];const a=(e.length-1)*n,l=Math.floor(a),u=l+1,c=a%1,p=e[l],d=e[u];return u>=e.length||s||"string"==typeof p||"string"==typeof d?p:p*(1-c)+d*c}function b(e,t){if(e){if(p.has(e))return C(t);if(d.has(e))return A(t,!1);if("esriFieldTypeTimestampOffset"===e)return function(e){return e?M:I}(t);const r=A(t,!0);if("esriFieldTypeString"===e)return r;if("esriFieldTypeGUID"===e||"esriFieldTypeGlobalID"===e)return(e,t)=>r(N(e),N(t))}const r=t?1:-1,n=C(t),i=A(t,!0),s=S(t);return(e,t)=>"number"==typeof e&&"number"==typeof t?n(e,t):"string"==typeof e&&"string"==typeof t?i(e,t):s(e,t)??r}const w=(e,t)=>null==e?null==t?0:1:null==t?-1:null,_=(e,t)=>null==e?null==t?0:-1:null==t?1:null;function S(e){return e?w:_}const I=(e,t)=>_(e,t)??(e===t?0:new Date(e).getTime()-new Date(t).getTime()),M=(e,t)=>w(e,t)??(e===t?0:new Date(t).getTime()-new Date(e).getTime()),T=(e,t)=>_(e,t)??(e===t?0:e<t?-1:1),x=(e,t)=>w(e,t)??(e===t?0:e<t?1:-1);function A(e,t){if(!t)return e?x:T;const r=S(e);return e?(e,t)=>{const n=r(e,t);return null!=n?n:(e=e.toUpperCase())>(t=t.toUpperCase())?-1:e<t?1:0}:(e,t)=>{const n=r(e,t);return null!=n?n:(e=e.toUpperCase())<(t=t.toUpperCase())?-1:e>t?1:0}}const E=(e,t)=>w(e,t)??t-e,L=(e,t)=>_(e,t)??e-t;function C(e){return e?E:L}function N(e){return e.slice(24,36)+e.slice(19,23)+e.slice(16,18)+e.slice(14,16)+e.slice(11,13)+e.slice(9,11)+e.slice(6,8)+e.slice(4,6)+e.slice(2,4)+e.slice(0,2)}function R(e,t,r){let n;for(n in e)t?.include?.length&&!t.include.includes(n)||t?.exclude?.length&&t.exclude.includes(n)?delete e[n]:h.includes(n)&&(Number.isFinite(e[n])||(e[n]=null));return r?(["avg","stddev","variance"].forEach((t=>{null!=e[t]&&(e[t]=Math.ceil(e[t]??0))})),e):e}function O(e){const t={};for(let r of e)(null==r||"string"==typeof r&&""===r.trim())&&(r=null),null==t[r]?t[r]={count:1,data:r}:t[r].count++;return{count:t}}function F(e){return"coded-value"!==e?.type?[]:e.codedValues.map((e=>e.code))}function k(e,t,r,n){const i=e.count,s=[];if(r&&t){const e=[],r=F(t[0]);for(const i of r)if(t[1]){const r=F(t[1]);for(const s of r)if(t[2]){const r=F(t[2]);for(const t of r)e.push(`${f(i)}${n}${f(s)}${n}${f(t)}`)}else e.push(`${f(i)}${n}${f(s)}`)}else e.push(i);for(const t of e)i.hasOwnProperty(t)||(i[t]={data:t,count:0})}for(const e in i){const t=i[e];s.push({value:t.data,count:t.count,label:t.label})}return{uniqueValueInfos:s}}function D(e,t,r,n){let i=null;switch(t){case"log":0!==e&&(i=Math.log(e)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(n)&&0!==n&&(i=e/n*100);break;case"field":Number.isFinite(r)&&0!==r&&(i=e/r);break;case"natural-log":e>0&&(i=Math.log(e));break;case"square-root":e>0&&(i=e**.5)}return i}function P(e,t){const r=V({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||l});return e=function(e,t,r){const n=t??-1/0,i=r??1/0;return e.filter((e=>Number.isFinite(e)&&e>=n&&e<=i))}(e,t.minValue,t.maxValue),(0,i.t)({definition:r,values:e,normalizationTotal:t.normalizationTotal})}function V(e){const{breakCount:t,field:r,normalizationField:i,normalizationType:s}=e,l=e.classificationMethod||o,u="standard-deviation"===l?e.standardDeviationInterval||a:void 0,c="defined-interval"===l?e.definedInterval:void 0;return new n.A({breakCount:t,classificationField:r,classificationMethod:l,normalizationField:"field"===s?i:void 0,normalizationType:s,standardDeviationInterval:u,definedInterval:c})}function Z(e,t){let r=e.classBreaks;const n=r.length,i=r[0]?.minValue,s=r[n-1]?.maxValue,o="standard-deviation"===t,a=c;return r=r.map((e=>{const t=e.label,r={minValue:e.minValue,maxValue:e.maxValue,label:t};if(o&&t){const e=t.match(a),n=e?.map((e=>+e.trim()))??[];2===n.length?(r.minStdDev=n[0],r.maxStdDev=n[1],n[0]<0&&n[1]>0&&(r.hasAvg=!0)):1===n.length&&(t.includes("<")?(r.minStdDev=null,r.maxStdDev=n[0]):t.includes(">")&&(r.minStdDev=n[0],r.maxStdDev=null))}return r})),{minValue:i,maxValue:s,classBreakInfos:r,normalizationTotal:e.normalizationTotal}}function G(e,t){const r=j(e,t);if(null==r.min&&null==r.max)return{bins:[],minValue:r.min,maxValue:r.max,normalizationTotal:t.normalizationTotal};const n=r.intervals,i=r.min??0,s=r.max??0,o=n.map(((e,t)=>({minValue:n[t][0],maxValue:n[t][1],count:0})));for(const t of e)if(null!=t&&t>=i&&t<=s){const e=z(n,t);e>-1&&o[e].count++}return{bins:o,minValue:i,maxValue:s,normalizationTotal:t.normalizationTotal}}function j(e,t){const{field:r,classificationMethod:n,standardDeviationInterval:i,normalizationType:s,normalizationField:o,normalizationTotal:a,minValue:l,maxValue:c}=t,p=t.numBins||u;let d=null,h=null,f=null;if(n&&"equal-interval"!==n||s){const{classBreaks:t}=P(e,{field:r,normalizationType:s,normalizationField:o,normalizationTotal:a,classificationMethod:n,standardDeviationInterval:i,minValue:l,maxValue:c,numClasses:p});d=t[0].minValue,h=t[t.length-1].maxValue,f=t.map((e=>[e.minValue,e.maxValue]))}else{if(null!=l&&null!=c)d=l,h=c;else{const t=g({values:e,minValue:l,maxValue:c,useSampleStdDev:!s,supportsNullCount:y({normalizationType:s,normalizationField:o,minValue:l,maxValue:c})});d=t.min??null,h=t.max??null}f=function(e,t,r){const n=(t-e)/r,i=[];let s,o=e;for(let e=1;e<=r;e++)s=o+n,s=Number(s.toFixed(16)),i.push([o,e===r?t:s]),o=s;return i}(d??0,h??0,p)}return{min:d,max:h,intervals:f}}function z(e,t){let r=-1;for(let n=e.length-1;n>=0;n--)if(t>=e[n][0]){r=n;break}return r}},11876:function(e,t,r){r.d(t,{H:function(){return o},q:function(){return s}});var n=r(53216),i=r(38225);async function s(e){if(!e)return;const t=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e.includes("-3d")?e.slice(0,e.indexOf("-3d")):e,r=await(0,i.ud)("esri/t9n/basemaps");return r[e]||r[t]}const o={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return(0,n.s)("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return(0,n.s)("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}}},51107:function(e,t,r){r.d(t,{VC:function(){return c},dp:function(){return d},jj:function(){return p},ns:function(){return h}});var n=r(74756),i=r(25591),s=(r(78879),r(40633)),o=r(95929),a=(r(90683),r(67888)),l=(r(25128),r(11876));const u=()=>s.A.getLogger("esri.support.basemapUtils");function c(){return{}}function p(e){for(const t in e){const r=e[t];(0,o.pR)(r),delete e[t]}}function d(e,t){let r;if("string"==typeof e){const s=e in l.H,o=!s&&e.includes("/");if(!s&&!o){if(i.default.apiKey)u().warn(`Unable to find basemap definition for: ${e}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const t=Object.entries(l.H).filter((([e,t])=>t.classic||t.is3d)).map((([e])=>`"${e}"`)).sort().join(", ");u().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${t}`)}return null}t&&(r=t[e]),r||(r=s?n.default.fromId(e):new n.default({style:{id:e}}),t&&(t[e]=r))}else r=(0,a.dp)(n.default,e);return r?.destroyed&&(u().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function h(e,t){return e.basemap?.referenceLayers?.some((e=>e.uid===t))||e.basemap?.baseLayers?.some((e=>e.uid===t))}},18950:function(e,t,r){r.d(t,{DQ:function(){return c},tn:function(){return u}});var n=r(90473),i=r(53743),s=r(57435),o=(r(58439),r(57746),r(44433),r(48212)),a=(r(40401),r(16621),r(12966),r(84847),r(33504)),l=r(49595);function u({displayField:e,editFieldsInfo:t,fields:r,objectIdField:l,title:u},c){if(!r)return null;const f=function(e,t){const r=t?.visibleFieldNames;return function({fields:e,ignoreFieldTypes:t,sortDisabled:r}){const n=e;return t&&(e=e.filter((e=>!t.includes(e.type)))),e===n&&(e=e.slice()),!0!==r&&e.sort(d),e}({fields:e.fields??[],ignoreFieldTypes:t?.ignoreFieldTypes||y,sortDisabled:t?.sortDisabled}).map((t=>new a.A({fieldName:t.name,isEditable:(0,i.R$)(t,e),label:t.alias,format:h(t),visible:p(t,{...e,visibleFieldNames:r})})))}({editFieldsInfo:t,fields:r,objectIdField:l},c);if(!f.length)return null;const m=function(e){const t=(0,i.mB)(e),{titleBase:r}=e;return t?`${r}: {${t.trim()}}`:r??""}({titleBase:u,fields:r,displayField:e}),g=[new o.A,new s.A];return new n.A({title:m,content:g,fieldInfos:f})}function c(e){const{title:t,graphic:r}=e??{},{attributes:n,sourceLayer:i}=r??{},s=i&&"displayField"in i?i.displayField:null,o=s?n?.[s]:null,a=r?.getObjectId()?.toString();return t||o||a||""}const p=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,i.Bz)(e,t);function d(e,t){return"oid"===e.type?-1:"oid"===t.type?1:f(e)?-1:f(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function h(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.A({digitSeparator:!0,places:0});case"double":return new l.A({digitSeparator:!0,places:2});case"string":return(0,i.JL)(e.name)?new l.A({digitSeparator:!0,places:0}):void 0;default:return}}function f(e){if("name"===(e.name&&e.name.toLowerCase()))return!0;const t=e.alias?.toLowerCase();return"name"===t}const y=["geometry","blob","raster","guid","xml"]},23532:function(e,t,r){r.d(t,{$:function(){return n},u:function(){return i}});const n="20241120",i="02addf7fe96c3305c24f844efa4a31df2498ca51"},67895:function(e,t,r){r.d(t,{$:function(){return c}});var n=r(52874),i=r(75505),s=r(21609),o=r(54547),a=r(7590),l=r(16088);const u=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:n,a:i}=e;return[t,r,n,255*i]};class c{static findApplicableOverrides(e,t,r){if(e&&t){if(e.primitiveName){let n=!1;for(const t of r)if(t.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const n of t)n.primitiveName===e.primitiveName&&r.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)c.findApplicableOverrides(n,t,r);if(e.symbolLayers)for(const n of e.symbolLayers)c.findApplicableOverrides(n,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)c.findApplicableOverrides(n,t,r);if(e.markerPlacement&&c.findApplicableOverrides(e.markerPlacement,t,r),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const n of e.markerGraphics)c.findApplicableOverrides(n,t,r),c.findApplicableOverrides(n.symbol,t,r)}else"CIMCharacterMarker"===e.type?c.findApplicableOverrides(e.symbol,t,r):"CIMHatchFill"===e.type?c.findApplicableOverrides(e.lineSymbol,t,r):"CIMPictureMarker"===e.type&&c.findApplicableOverrides(e.animatedSymbolProperties,t,r)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.FH)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=(0,a.rB)(e),n=e.primitiveName,i=[];for(const e of t)e.primitiveName===n&&i.push((0,a.rB)(e));return{type:"cim-effect-param",effect:r,overrides:(0,a.pk)(i)}}static async resolveSymbolOverrides(e,t,r,n,i,o,l){if(!e?.symbol)return null;let{symbol:u,primitiveOverrides:p}=e;const d=!!p;if(!d&&!n)return u;u=(0,s.o8)(u),p=(0,s.o8)(p);let h=!0;if(t||(t={attributes:{}},h=!1),d){if(h||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),l||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),p.length>0){const e={spatialReference:r,fields:(0,a.O2)(t.attributes),geometryType:i};await c.createRenderExpressions(p,e),c.evaluateOverrides(p,t,i??"esriGeometryPoint",o,l)}c.applyOverrides(u,p)}return n&&c.applyDictionaryTextOverrides(u,t,n,null),u}static async createRenderExpressions(e,t){const r=[];for(const n of e){const e=n.valueExpressionInfo;if(!e||c._expressionToRenderExpression.has(e.expression))continue;const i=(0,o.Ad)(e.expression,t.spatialReference,t.fields);r.push(i),i.then((t=>c._expressionToRenderExpression.set(e.expression,t)))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,t,r,n,s){const o={$view:{scale:s?.scale}};for(const s of e){s.value&&"object"==typeof s.value&&(0,i.IB)(s.value)&&("Color"===s.propertyName||"StrokeColor"===s.propertyName)&&(s.value=u(s.value));const e=s.valueExpressionInfo;if(!e)continue;const a=c._expressionToRenderExpression.get(e.expression);a&&(s.value=(0,l.A)(a,t,o,r,n))}}static applyDictionaryTextOverrides(e,t,r,n,i="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const s=e.symbolLayers;if(!s)return;for(const o of s)o&&"CIMVectorMarker"===o.type&&c.applyDictionaryTextOverrides(o,t,r,n,"CIMTextSymbol"===e.type?e.textCase:i)}break;case"CIMVectorMarker":{const i=e.markerGraphics;if(!i)return;for(const e of i)e&&c.applyDictionaryTextOverrides(e,t,r,n)}break;case"CIMMarkerGraphic":{const s=e.textString;if(s&&s.includes("[")){const o=(0,a.gQ)(s,r);e.textString=(0,a.FM)(t,o,n,i)}}}}static applyOverrides(e,t,r,n){if(e.primitiveName)for(const i of t)if(i.primitiveName===e.primitiveName){const t=(0,a.YF)(i.propertyName);if(n&&n.push({cim:e,nocapPropertyName:t,value:e[t]}),r){let t=!1;for(const n of r)n.primitiveName===e.primitiveName&&(t=!0);t||r.push(i)}null!=i.value&&(e[t]=i.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const i of e.effects)c.applyOverrides(i,t,r,n);if(e.symbolLayers)for(const i of e.symbolLayers)c.applyOverrides(i,t,r,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const i of e.effects)c.applyOverrides(i,t,r,n);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const i of e.markerGraphics)c.applyOverrides(i,t,r,n),c.applyOverrides(i.symbol,t,r,n)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const r of e)void 0!==r.value&&(t+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new n.A(t).toRgba();return e[3]*=255,e}return t}}c._expressionToRenderExpression=new Map},38821:function(e,t,r){r.d(t,{D:function(){return s},K:function(){return i}});var n=r(33389);const i={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},s={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:n.fu.Loop,repeatdelay:0,easing:n.Hz.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}}},33389:function(e,t,r){var n,i,s,o,a,l,u,c,p,d,h,f,y,m,g,v,b,w,_,S,I,M,T,x,A,E,L,C,N,R,O,F,k,D,P,V,Z,G,j,z,U,q,B,$,H,J,W,Y,Q,K,X,ee,te,re,ne,ie,se,oe,ae,le,ue,ce;r.d(t,{$2:function(){return a},C1:function(){return s},Hz:function(){return f},JO:function(){return i},M1:function(){return T},O$:function(){return oe},Q1:function(){return W},TZ:function(){return b},WE:function(){return N},Y:function(){return u},YI:function(){return Q},bj:function(){return c},e_:function(){return J},f0:function(){return se},fu:function(){return h},g7:function(){return p},ip:function(){return Y},mU:function(){return R},oF:function(){return I},uQ:function(){return M},uT:function(){return Z},vG:function(){return le},wd:function(){return U},xR:function(){return n},xn:function(){return w},xw:function(){return E},yS:function(){return G}}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(n||(n={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(i||(i={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(s||(s={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(o||(o={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(a||(a={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(u||(u={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(c||(c={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(p||(p={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(d||(d={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(h||(h={})),function(e){e.Linear="Linear",e.EaseIn="EaseIn",e.EaseOut="EaseOut",e.EaseInOut="EaseInOut"}(f||(f={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(y||(y={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(m||(m={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(g||(g={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(v||(v={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(b||(b={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(w||(w={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(_||(_={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(S||(S={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(I||(I={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees",e.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",e.ConcentricCircles="ConcentricCircles",e.DoubleJogArrow="DoubleJogArrow",e.LinkedChevrons="LinkedChevrons",e.SegmentThenHalfCircle="SegmentThenHalfCircle",e.LineWithStraightTicks="LineWithStraightTicks",e.DoubleCurve="DoubleCurve",e.ParallelWithTicksByWidth="ParallelWithTicksByWidth",e.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(M||(M={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(T||(T={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(x||(x={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(A||(A={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(E||(E={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(L||(L={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(C||(C={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(N||(N={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(R||(R={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(O||(O={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(F||(F={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(k||(k={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(D||(D={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(P||(P={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(V||(V={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(Z||(Z={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(G||(G={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(j||(j={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(z||(z={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(U||(U={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(q||(q={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(B||(B={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}($||($={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(H||(H={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(J||(J={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(W||(W={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(Y||(Y={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(Q||(Q={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(K||(K={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(X||(X={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(ee||(ee={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(te||(te={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(re||(re={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(ne||(ne={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ie||(ie={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(se||(se={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(oe||(oe={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(ae||(ae={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(le||(le={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(ue||(ue={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ce||(ce={}))},7590:function(e,t,r){r.d(t,{$w:function(){return g},Bu:function(){return C},DW:function(){return x},FH:function(){return G},FM:function(){return u},G9:function(){return s},GV:function(){return b},Go:function(){return c},K3:function(){return Z},Kn:function(){return M},MM:function(){return h},MO:function(){return U},Nl:function(){return N},Ny:function(){return w},O2:function(){return R},UE:function(){return O},YC:function(){return z},YF:function(){return k},ZO:function(){return P},_1:function(){return E},_H:function(){return S},_W:function(){return v},_d:function(){return T},bs:function(){return j},dI:function(){return W},e6:function(){return p},gQ:function(){return l},iA:function(){return V},jn:function(){return y},lW:function(){return d},mA:function(){return f},n5:function(){return F},pM:function(){return A},pV:function(){return I},pk:function(){return q},rB:function(){return B},s4:function(){return i},xo:function(){return L},yH:function(){return _},zb:function(){return D},zr:function(){return m}});var n=r(38821);function i(e,t,r,n){return function(e){return"function"==typeof e}(e)?e(t,r,n):e}function s(e){return[e.r,e.g,e.b,e.a]}const o=" /-,\n";function a(e){let t=e.length;for(;t--;)if(!o.includes(e.charAt(t)))return!1;return!0}function l(e,t){const r=[];let n=0,i=-1;do{if(i=e.indexOf("[",n),i>=n){if(i>n){const t=e.slice(n,i);r.push([t,null,a(t)])}if(n=i+1,i=e.indexOf("]",n),i>=n){if(i>n){const s=t[e.slice(n,i)];s&&r.push([null,s,!1])}n=i+1}}}while(-1!==i);if(n<e.length){const t=e.slice(n);r.push([t,null,a(t)])}return r}function u(e,t,r,n){let i="",s=null;for(const n of t){const[t,o,a]=n;if(t)a?s=t:(s&&(i+=s,s=null),i+=t);else{let t=o;null!=r&&(t=U(o,r));const n=e.attributes[t];n&&(s&&(i+=s,s=null),i+=n)}}return function(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}(i,n)}function c(e,t,r,n,i,s,o=!0){const a=t/i,l=r/s,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let r=0;r<s;r++)for(let p=0;p<i;p++){const d=4*(p+(o?s-r-1:r)*i);let h=0,f=0,y=0,m=0,g=0,v=0,b=0;const w=(r+.5)*l;for(let n=Math.floor(r*l);n<(r+1)*l;n++){const r=Math.abs(w-(n+.5))/c,i=(p+.5)*a,s=r*r;for(let r=Math.floor(p*a);r<(p+1)*a;r++){let o=Math.abs(i-(r+.5))/u;const a=Math.sqrt(s+o*o);a>=-1&&a<=1&&(h=2*a*a*a-3*a*a+1,h>0&&(o=4*(r+n*t),b+=h*e[o+3],y+=h,e[o+3]<255&&(h=h*e[o+3]/250),m+=h*e[o],g+=h*e[o+1],v+=h*e[o+2],f+=h))}}n[d]=m/f,n[d+1]=g/f,n[d+2]=v/f,n[d+3]=b/y}}function p(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function d(e){return e.data?.symbol??null}function h(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function f(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function y(e){return null!=e&&("CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type)}function m(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const g=(e,t=0)=>null==e||isNaN(e)?t:e,v=(e,t)=>null!=e?e:t,b=(e,t)=>e??t,w=e=>e.tintColor?p(e.tintColor):[255,255,255,1],_=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function S(){return r.e(4696).then(r.bind(r,28356))}function I(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function M(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function T(e){let t="normal",r="normal";if(e){const n=e.toLowerCase();n.includes("italic")?t="italic":n.includes("oblique")&&(t="oblique"),n.includes("bold")?r="bold":n.includes("light")&&(r="lighter")}return{style:t,weight:r}}function x(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function A(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=A(t);if(null!=e)return e}break;case"CIMTextSymbol":return A(e.symbol);case"CIMSolidFill":return e.color}return null}function E(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=E(e);if(null!=t)return t}break}case"CIMTextSymbol":return E(e.symbol);case"CIMSolidStroke":return e.color}}function L(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=L(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return L(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function C(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function N(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function R(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const O=e=>e.includes("data:image/svg+xml");function F(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function k(e){return e?e.charAt(0).toLowerCase()+e.slice(1):e}function D(e,t,r,n,i,s,o=!0){const{infos:a}=s;let l=1,u=0,c=0,p=0,d=1;for(const{absoluteAnchorPoint:e,offsetX:t,offsetY:r,rotation:n,size:i,frameHeight:s,rotateClockWise:h,scaleSymbolsProportionally:f}of a)d=e?1:l,c=H(t,r,u,d,c),p=$(t,r,u,d,p),s&&(f||o)&&(l*=i/s),u=J(n,h,u);const h=H(n,i,u,d,c),f=$(n,i,u,d,p);return{size:e*l,rotation:J(t,r,u),offsetX:h,offsetY:f}}function P(e){if(null==e)return!1;if(Array.isArray(e))return e.every((e=>P(e)));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function V(e,t){if("color"===t||"outlinecolor"===t||"backgroundcolor"===t||"borderlinecolor"===t||"tintcolor"===t)return[...n.K[t]];const r=n.D[e];if(!r)throw new Error(`InternalError: default value for type ${e}.`);return r[t]}function Z(e){return"string"==typeof e?function(e){return e.split(" ").map((e=>Number(e)))}(e):e}function G(e){return e?.dashTemplate&&(e.dashTemplate=Z(e.dashTemplate)),e}function j(e){if(null==e)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const e of t)if("CIMVectorMarker"===e.type)return j(e)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const e of t)if(e.symbol)return j(e.symbol)}}return"Normal"}function z(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=r.size??n.D.CIMVectorMarker.size;e>t&&(t=e);break}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=r.width;null!=e&&e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&m(r.markerPlacement)){const e=r.size??n.D.CIMVectorMarker.size;e>t&&(t=e)}break;case"CIMPictureFill":{const e=r.height;null!=e&&e>t&&(t=e)}}return t}}}function U(e,t){if(null!==t){const r=t.get(e);return r?r.name:e}return e}function q(e){return e.map((e=>({...e,propertyName:k(e.propertyName)})))}function B(e){const t={};for(const r in e){const n=e[r];t[k(r)]=n}return t}function $(e,t,r,n,i){const s=r*Math.PI/180;if(s){const r=Math.cos(s);return(Math.sin(s)*e+r*t)*n+i}return t*n+i}function H(e,t,r,n,i){const s=r*Math.PI/180;return s?(Math.cos(s)*e-Math.sin(s)*t)*n+i:e*n+i}function J(e,t,r){return t?r-e:r+e}function W(e,t,r){const n="Color"===r||"TintColor"===r||"ToColor"===r,i="Rotation"===r||"Angle"===r||"ToRotation"===r;let s=t[k(r)];if(null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:i&&(s*=Math.PI/180)),null==s&&(s=V(t.type,r.toLowerCase()),null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]]:i&&(s*=Math.PI/180))),null!=t.primitiveName){const o=e[t.primitiveName];if(null!=o){const e=o[r];null==e||("string"==typeof e||"number"==typeof e||Array.isArray(e)?(s=e,null!=s&&(n?s=[s[0]/255,s[1]/255,s[2]/255,s[3]/255]:i&&(s*=Math.PI/180))):(s={valueExpressionInfo:e,defaultValue:s},null!=s&&(n?s={type:"Process",op:"ArcadeColor",value:s}:i&&(s={type:"Process",op:"Divide",left:s,right:180/Math.PI}))))}}if(null==s)throw new Error(`Failed to derive a value or an expression for "${r}".`);return s}},74661:function(e,t,r){r.d(t,{A7:function(){return u},Cx:function(){return c},Hk:function(){return p},JJ:function(){return y},SF:function(){return d},UK:function(){return l},jM:function(){return h},x3:function(){return f}}),r(58941);var n=r(8740),i=r(22198),s=r(90363),o=r(90972),a=r(6259);const l=s.A.fromJSON(a.Cb),u=i.A.fromJSON(a.yM),c=n.A.fromJSON(a.WR),p=o.A.fromJSON(a.JZ);function d(e){if(null==e)return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return l;case"polyline":return u;case"polygon":case"extent":return c}return null}const h=s.A.fromJSON(a.nC),f=i.A.fromJSON(a.HW),y=n.A.fromJSON(a.b6)},40990:function(e,t,r){r.d(t,{af:function(){return w},al:function(){return b},dX:function(){return _}});var n=r(52874),i=(r(10748),r(78879)),s=(r(58941),r(13520)),o=r(22762),a=r(56150),l=r(97025),u=r(78018),c=r(15186),p=r(10052),d=r(74661),h=r(6259),f=r(77529);const y=u.A.fromSimpleMarkerSymbol(d.UK),m=a.A.fromSimpleLineSymbol(d.A7),g=c.A.fromSimpleFillSymbol(d.Cx),v=new l.A({symbolLayers:new i.A([new o.A({material:{color:h.fT},edges:new p.A({size:(0,s.PN)(1),color:new n.A(h.JR)})})])}),b=new a.A({symbolLayers:new i.A([new f.A({material:{color:new n.A([0,0,0])},size:(0,s.PN)(1)})])}),w=new c.A({symbolLayers:new i.A([new o.A({outline:{color:new n.A([0,0,0]),size:(0,s.PN)(1)}})])});function _(e){if(null==e)return null;switch(e.type){case"mesh":return v;case"point":case"multipoint":return y;case"polyline":return m;case"polygon":case"extent":return g}return null}},6259:function(e,t,r){r.d(t,{Cb:function(){return s},HW:function(){return c},JR:function(){return i},JZ:function(){return l},WR:function(){return a},b6:function(){return p},fT:function(){return n},nC:function(){return u},yM:function(){return o}});const n=[252,146,31,255],i=[153,153,153,255],s={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},a={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},l={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},u={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},p={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},8404:function(e,t,r){r.d(t,{M9:function(){return u},oO:function(){return c},rS:function(){return h}});var n=r(10748),i=r(39819),s=r(11432),o=r(97992),a=r(11299),l=r(36e3);function u(e,t,r,n){const i=d(e,{},{context:n,isLabelSymbol:!1});null!=i&&(t[r]=i)}function c(e,t,r,n){const i=d(e,{},{context:n,isLabelSymbol:!0});null!=i&&(t[r]=i)}function p(e){return e instanceof o.A||e instanceof l.A}function d(e,t,r){if(null==e)return null;const{context:n,isLabelSymbol:l}=r,u=n?.origin,c=n?.messages;if("web-scene"===u&&!p(e)){const r=(0,a.t)(e,{retainCIM:!0,hasLabelingContext:l});return null!=r.symbol?r.symbol.write(t,n):(c?.push(new i.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:n,error:r.error})),null)}return(0,s.TU)(n?.layer)&&function(e){return e instanceof o.A&&("polygon-3d"===e.type||"line-3d"===e.type)}(e)?(c?.push(new i.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported on layers of type '${n?.layer?.declaredClass}'.`,{symbol:e,context:n})),null):("web-map"===u||"portal-item"===u&&!(0,s.TU)(n?.layer))&&p(e)?(c?.push(new i.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:n})),null):e.write(t,n)}function h(e,t){return(0,n.Bu)(e,null,t)}},58916:function(e,t,r){r.d(t,{jg:function(){return g},cF:function(){return p},bo:function(){return d},yA:function(){return f},o5:function(){return h}});var n=r(93040),i=r(39819),s=r(58941),o=r(60539),a=r(90683),l=r(51432),u=r(26544);const c=new Map;function p(e,t,r){return null!=e?.styleUrl?async function(e,t){try{return{data:(await f(e,t)).data,baseUrl:(0,a.nM)(e),styleUrl:e}}catch(e){return(0,o.QP)(e),null}}(e.styleUrl,r):null!=e?.styleName?function(e,t,r){const n=null!=t.portal?t.portal:l.A.getDefault();let s;const o=`${n.url} - ${n.user?.username} - ${e}`,a=c.get(o);if(a)return a;const p=function(e,t,r){return t.load(r).then((()=>{const n=new u.A({disableExtraQuery:!0,query:`owner:${y} AND type:${m} AND typekeywords:"${e}"`});return t.queryItems(n,r)})).then((({results:t})=>{let n=null;const s=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t){const t=e.typeKeywords?.some((e=>e.toLowerCase()===s));if(t&&e.type===m&&e.owner===y){n=e;break}}if(!n)throw new i.A("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(r)}))}(e,n,r).then((e=>(s=e,e.fetchData()))).then((t=>({data:t,baseUrl:s.itemUrl??"",styleName:e})));return c.set(o,p),p}(e.styleName,t,r):Promise.reject(new i.A("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function d(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function h(e,t,r=["gltf"]){if("cimRef"===t)return encodeURI(e.cimRef);if(e.formatInfos&&!(0,s.A)("enable-feature:force-wosr"))for(const t of r){const r=e.formatInfos.find((e=>e.type===t));if(r)return r.href}return encodeURI(e.webRef)}function f(e,t){const r={responseType:"json",query:{f:"json"},...t};return(0,n.A)((0,a.S8)(e),r)}const y="esri_en",m="Style",g="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"},11299:function(e,t,r){r.d(t,{c:function(){return v},t:function(){return b}});var n=r(10748),i=r(39819),s=r(40990),o=r(36e3),a=r(78018),l=r(22198),u=r(56150),c=r(90363),p=r(24411),d=r(8740),h=r(97025),f=r(15186),y=r(90972),m=r(56922);const g="#useCIMFallbackSymbology()",v={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function b(e,t=v){if(!e)return{symbol:null};const{retainId:r=v.retainId,ignoreDrivers:b=v.ignoreDrivers,hasLabelingContext:w=v.hasLabelingContext,retainCIM:_=v.retainCIM,cimFallbackEnabled:S=v.cimFallbackEnabled}=t;let I=null;if((0,n.wk)(e)||e instanceof o.A)I=e.clone();else if("cim"===e.type){const r=e.data?.symbol?.type;switch(r){case"CIMPointSymbol":I=_?e.clone():a.A.fromCIMSymbol(e);break;case"CIMLineSymbol":S&&(I=s.al.clone(),t?.logWarning?.(g,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":S&&(I=s.af.clone(),t?.logWarning?.(g,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!I)return{error:new i.A("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${r||"unknown"}' is unsupported in 3D`,{symbol:e})}}else if(e instanceof l.A)I=u.A.fromSimpleLineSymbol(e);else if(e instanceof c.A)I=a.A.fromSimpleMarkerSymbol(e);else if(e instanceof p.A)I=a.A.fromPictureMarkerSymbol(e);else if(e instanceof d.A)I=t.geometryType&&"mesh"===t.geometryType?h.A.fromSimpleFillSymbol(e):f.A.fromSimpleFillSymbol(e);else{if(!(e instanceof y.A))return{error:new i.A("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};I=w?m.A.fromTextSymbol(e):a.A.fromTextSymbol(e)}return r&&I&&"cim"!==I.type&&(I.id=e.id),b&&(0,n.wk)(I)&&I.symbolLayers.forEach((e=>e.ignoreDrivers=!0)),{symbol:I}}},92777:function(e,t,r){r.d(t,{A:function(){return O}});var n=r(53804),i=r(30905),s=r(21609),o=r(23502),a=r(77560),l=r(47332),u=r(65953),c=r(81392);let p=class extends i.oY{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],p.prototype,"description",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],p.prototype,"label",void 0),(0,n._)([(0,o.MZ)()],p.prototype,"type",void 0),p=(0,n._)([(0,u.$)("esri.tables.elements.AttributeTableElement")],p);const d=p;var h,f=r(67888);r(58941),r(40633),r(13798);let y=h=class extends d{constructor(e){super(e),this.displayType="auto",this.type="attachment"}clone(){return new h({description:this.description,displayType:this.displayType,label:this.label})}};(0,n._)([(0,o.MZ)({type:["auto"],json:{write:!0}})],y.prototype,"displayType",void 0),(0,n._)([(0,o.MZ)({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],y.prototype,"type",void 0),y=h=(0,n._)([(0,u.$)("esri.tables.elements.AttributeTableAttachmentElement")],y);const m=y;var g;let v=g=class extends d{constructor(e){super(e),this.fieldName=null,this.type="field"}clone(){return new g({description:this.description,fieldName:this.fieldName,label:this.label})}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],v.prototype,"fieldName",void 0),(0,n._)([(0,o.MZ)({type:String,json:{read:!1,write:!0}})],v.prototype,"type",void 0),v=g=(0,n._)([(0,u.$)("esri.tables.elements.AttributeTableFieldElement")],v);const b=v;var w;let _=w=class extends d{constructor(e){super(e),this.relationshipId=null,this.type="relationship"}clone(){return new w({description:this.description,label:this.label,relationshipId:this.relationshipId})}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],_.prototype,"relationshipId",void 0),(0,n._)([(0,o.MZ)({type:["relationship"],json:{read:!1,write:!0}})],_.prototype,"type",void 0),_=w=(0,n._)([(0,u.$)("esri.tables.elements.AttributeTableRelationshipElement")],_);const S=_;function I(e){return{typesWithGroup:{base:d,key:"type",typeMap:{attachment:m,field:b,group:e,relationship:S}},typesWithoutGroup:{base:d,key:"type",typeMap:{attachment:m,field:b,relationship:S}}}}function M(e,t,r=!0){if(!e)return null;const n=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((e=>n[e.type])).map((e=>n[e.type].fromJSON(e)))}function T(e,t,r=!0){if(!e)return null;const n=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((e=>n[e.type])).map((e=>e.toJSON()))}function x(e,t,r=!0){return e?e.map((e=>(0,f.aq)(r?t.typesWithGroup:t.typesWithoutGroup,e))):null}var A;let E=A=class extends d{constructor(e){super(e),this.elements=null,this.type="group"}castElements(e){return x(e,L,!1)}readElements(e,t){return M(t.attributeTableElements,L,!1)}writeElements(e,t){t.attributeTableElements=T(e,L,!1)}clone(){return new A({description:this.description,elements:(0,s.o8)(this.elements),label:this.label})}};(0,n._)([(0,o.MZ)({json:{write:!0}})],E.prototype,"elements",void 0),(0,n._)([(0,a.w)("elements")],E.prototype,"castElements",null),(0,n._)([(0,l.w)("elements",["attributeTableElements"])],E.prototype,"readElements",null),(0,n._)([(0,c.K)("elements")],E.prototype,"writeElements",null),(0,n._)([(0,o.MZ)({type:String,json:{read:!1,write:!0}})],E.prototype,"type",void 0),E=A=(0,n._)([(0,u.$)("esri.tables.elements.AttributeTableGroupElement")],E);const L=I(E);var C;const N=I(E);let R=C=class extends i.oY{constructor(e){super(e),this.elements=null,this.orderByFields=null}castElements(e){return x(e,N)}readElements(e,t){return M(t.attributeTableElements,N)}writeElements(e,t){t.attributeTableElements=T(e,N)}clone(){return new C({elements:(0,s.o8)(this.elements),orderByFields:this.orderByFields})}};(0,n._)([(0,o.MZ)({json:{write:!0}})],R.prototype,"elements",void 0),(0,n._)([(0,a.w)("elements")],R.prototype,"castElements",null),(0,n._)([(0,l.w)("elements",["attributeTableElements"])],R.prototype,"readElements",null),(0,n._)([(0,c.K)("elements")],R.prototype,"writeElements",null),(0,n._)([(0,o.MZ)({type:[Object],json:{write:!0}})],R.prototype,"orderByFields",void 0),R=C=(0,n._)([(0,u.$)("esri.tables.AttributeTableTemplate")],R);const O=R},92427:function(e,t,r){r.d(t,{A:function(){return d}});var n=r(53804),i=r(75743),s=r(30905),o=r(45139),a=r(23502),l=(r(58941),r(40633),r(13798),r(74376)),u=r(65953),c=r(35060);let p=class extends((0,i.O)(s.oY)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,o.t)(this.value,this.unit,"milliseconds")}};(0,n._)([(0,l.e)(c.j,{nonNullable:!0})],p.prototype,"unit",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{write:!0},nonNullable:!0})],p.prototype,"value",void 0),p=(0,n._)([(0,u.$)("esri.time.TimeInterval")],p);const d=p},16088:function(e,t,r){r.d(t,{A:function(){return o}});var n=r(39819),i=r(40633),s=r(87280);function o(e,t,r,n,s){if(null==e)return null;const o=e.referencesGeometry()&&s?l(t,n,s):t,a=e.repurposeFeature(o);try{return e.evaluate({...r,$feature:a},e.services)}catch(e){return i.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const a=new Map;function l(e,t,r){const{transform:o,hasZ:l,hasM:u}=r;a.has(t)||a.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,r,n,i)=>(0,s.Tr)(r,t,e,n,i);case"esriGeometryPolygon":return(e,r,n,i)=>(0,s.$X)(r,t,e,n,i);case"esriGeometryPolyline":return(e,r,n,i)=>(0,s.P5)(r,t,e,n,i);case"esriGeometryMultipoint":return(e,r,n,i)=>(0,s.SW)(r,t,e,n,i);default:return i.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.A("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const c=a.get(t)(e.geometry,o,l,u);return{...e,geometry:c}}},81197:function(e,t,r){var n;r.d(t,{M:function(){return n}}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(n||(n={}))},48961:function(e,t,r){r.d(t,{Bb:function(){return E},W6:function(){return n},mj:function(){return v},nu:function(){return L}});var n,i,s=r(14606),o=(r(58941),r(40633)),a=r(95929),l=r(69739),u=r(7187),c=r(60539),p=r(28181),d=r(85445),h=r(38504),f=r(47558),y=r(16164),m=r(81197),g=r(55213);function v(){return new x.Scheduler}(i=n||(n={})).RESOURCE_CONTROLLER_IMMEDIATE="immediate",i.RESOURCE_CONTROLLER="schedule",i.SLIDE="slide",i.STREAM_DATA_LOADER="stream loader",i.ELEVATION_QUERY="elevation query",i.TERRAIN_SURFACE="terrain",i.SURFACE_GEOMETRY_UPDATES="surface geometry updates",i.LOD_RENDERER="LoD renderer",i.GRAPHICS_CORE="Graphics3D",i.I3S_CONTROLLER="I3S",i.POINT_CLOUD_LAYER="point cloud",i.FEATURE_TILE_FETCHER="feature fetcher",i.OVERLAY="overlay",i.STAGE="stage",i.GRAPHICS_DECONFLICTOR="graphics deconflictor",i.FILTER_VISIBILITY="Graphics3D filter visibility",i.SCALE_VISIBILITY="Graphics3D scale visibility",i.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",i.POINT_OF_INTEREST_FREQUENT="POI frequent",i.POINT_OF_INTEREST_INFREQUENT="POI infrequent",i.LABELER="labeler",i.FEATURE_QUERY_ENGINE="feature query",i.FEATURE_TILE_TREE="feature tile tree",i.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",i.ELEVATION_ALIGNMENT="elevation alignment",i.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",i.TEXT_TEXTURE_ATLAS="text texture atlas",i.TEXTURE_UNLOAD="texture unload",i.LINE_OF_SIGHT_TOOL="line of sight tool",i.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",i.ELEVATION_PROFILE="elevation profile",i.SNAPPING="snapping",i.SHADOW_ACCUMULATOR="shadow accumulator",i.CLOUDS_GENERATOR="clouds generator",i.MAPVIEW_FETCH_QUEUE="mapview fetch queue",i.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",i.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",i[i.NONE=0]="NONE",i[i.TEST_PRIO=1]="TEST_PRIO";const b=new Map([[n.RESOURCE_CONTROLLER_IMMEDIATE,0],[n.RESOURCE_CONTROLLER,4],[n.SLIDE,0],[n.STREAM_DATA_LOADER,0],[n.ELEVATION_QUERY,0],[n.TERRAIN_SURFACE,1],[n.SURFACE_GEOMETRY_UPDATES,1],[n.LOD_RENDERER,2],[n.GRAPHICS_CORE,2],[n.I3S_CONTROLLER,2],[n.POINT_CLOUD_LAYER,2],[n.FEATURE_TILE_FETCHER,2],[n.CLOUDS_GENERATOR,2],[n.OVERLAY,4],[n.STAGE,4],[n.GRAPHICS_DECONFLICTOR,4],[n.FILTER_VISIBILITY,4],[n.SCALE_VISIBILITY,4],[n.FRUSTUM_VISIBILITY,4],[n.POINT_OF_INTEREST_FREQUENT,6],[n.POINT_OF_INTEREST_INFREQUENT,30],[n.LABELER,8],[n.FEATURE_QUERY_ENGINE,8],[n.FEATURE_TILE_TREE,16],[n.FEATURE_TILE_TREE_ACTIVE,0],[n.ELEVATION_ALIGNMENT,12],[n.ELEVATION_ALIGNMENT_SCENE,14],[n.TEXT_TEXTURE_ATLAS,12],[n.TEXTURE_UNLOAD,12],[n.LINE_OF_SIGHT_TOOL,16],[n.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[n.SNAPPING,0],[n.SHADOW_ACCUMULATOR,30],[n.MAPVIEW_FETCH_QUEUE,0],[n.MAPVIEW_LAYERVIEW_UPDATE,2],[n.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,0]]);function w(e){return b.has(e)?b.get(e):"number"==typeof e?e:1}const _=(0,h.l5)(6.5),S=(0,h.l5)(1),I=(0,h.l5)(30),M=(0,h.l5)(1e3/30),T=(0,h.l5)(100);var x,A;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,d.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new l.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new r,this._state=m.M.INTERACTING,this._tasks=new u.A,this._runQueue=new u.A,this._load=0,this._idleStateCallbacks=new u.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,p.watch)((()=>y.A.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),p.Vh);for(const e of Object.keys(n))this.performanceInfo.tasks.set(n[e],new l.A(n[e]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,a.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(e,r){const n=new t(this,e,r);return this._tasks.push(n),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new l.A(e)),n}registerIdleStateCallbacks(e,t){const r={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(r),this.state===m.M.IDLE&&this._idleUpdatesStartFired&&r.idleBegin();const n=this;return{remove:()=>this._removeIdleStateCallbacks(r),set idleBegin(e){n._idleUpdatesStartFired&&(r.idleEnd(),n._state===m.M.IDLE&&e()),r.idleBegin=e},set idleEnd(e){r.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==m.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let t=_,r=e.frameDuration,n=S;switch(this.state){case m.M.IDLE:t=(0,h.l5)(0),r=(0,h.l5)(Math.max(T,e.frameDuration)),n=I;break;case m.M.INTERACTING:r=(0,h.l5)(Math.max(M,e.frameDuration));case m.M.ANIMATING:}return r=(0,h.l5)(r-e.elapsedFrameTime-t),this.state!==m.M.IDLE&&r<S&&!this._forceTask?(this._forceTask=!0,!1):(r=(0,h.l5)(Math.max(r,n)),this._budget.reset(r,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case m.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case m.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset((0,h.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return A.SCHEDULED;let t=A.IDLE;return this._tasks.forAll((r=>{r.name===e&&r.needsUpdate&&(r.schedulePriority<=1?t=A.READY:t!==A.READY&&(t=A.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((r=>{r.name===e&&(t+=r.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,r)=>{t+=e>1?` ${e}x ${r}`:` ${r}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((r=>{r.needsUpdate&&0!==r.schedulePriority&&0!==r.basePriority&&r.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,r.basePriority),1===r.schedulePriority?(r.schedulePriority=0,this._runQueue.push(r)):--r.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const t=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===g.G&&(r.blockFrame=this._frameNumber)}catch(e){o.A.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,e),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,n.I3S_CONTROLLER,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-t;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(n))this._frameTaskTimes.set(n[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).push(e))),this.performanceInfo.total.push(e)}get test(){return this._test}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,r){this._scheduler=e,this.name=t,this.blockFrame=0,this.runtime=0,this._queue=new f.T,this._handles=new s.A,this._basePriority=w(t),this.schedulePriority=this._basePriority,this._task=(0,d.v)(null!=r?r:this._queue),this._handles.add((0,p.when)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(E),this._scheduler.removeTask(this),this.schedule=L.schedule,this.reschedule=L.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=w(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,r){return this._queue.push(e,t,r)}reschedule(e,t,r){return this._queue.unshift(e,t,r)}processQueue(e){return this._queue.runTask(e)}}class r{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=m.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=r}(x||(x={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(A||(A={}));const E=(()=>{const e=new x.Budget;return e.enabled=!1,e})(),L=new class{remove(){}processQueue(){}schedule(e,t,r){try{if((0,c.G4)(t)){const e=(0,c.NK)();return r?Promise.resolve(r(e)):Promise.reject(e)}return(0,c.z7)(e(E))}catch(e){return Promise.reject(e)}}reschedule(e,t,r){return this.schedule(e,t,r)}}},55213:function(e,t,r){r.d(t,{G:function(){return n}});const n=Symbol("Yield")},16164:function(e,t,r){r.d(t,{A:function(){return l}});var n=r(53804),i=r(83525),s=r(23502),o=(r(58941),r(40633),r(13798),r(65953));let a=class extends i.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,n._)([(0,s.MZ)()],a.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,n._)([(0,s.MZ)()],a.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),a=(0,n._)([(0,o.$)("esri.views.support.debugFlags")],a);const l=new a},84624:function(e,t,r){r.d(t,{CJ:function(){return d}});var n=r(39819),i=r(21609),s=r(34194),o=r(47527),a=r(11432);const l=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),u=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function c(e,t){if(t.restrictedWebMapWriting){const r=function(e){return"basemap"===e.layerContainerType?l:"operational-layers"===e.layerContainerType?u:null}(t);return null==r||r.has(e.type)&&!(0,a.Ov)(e)}return!0}function p(e,t){"maxScale"in e&&(t.maxScale=(0,o.B)(e.maxScale)??void 0),"minScale"in e&&(t.minScale=(0,o.B)(e.minScale)??void 0)}function d(e,t,r){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return r?.messages&&r.messages.push(new n.A("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if((0,a.Ov)(e)&&!e.isTable)t=e.resourceInfo;else if(c(e,r)){const t={};return e.write(t,r)?t:null}return null!=t&&function(e,t){if(function(e,t){if(t)if((0,a.Ov)(e)){const r=(0,s.wc)("featureCollection.layers",t),n=r?.[0]?.layerDefinition;n&&p(e,n)}else"group"!==e.type&&p(e,t)}(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=(0,o.B)(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type))if((0,a.Ov)(e)){const r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}(e,t=(0,i.o8)(t)),t}}}]);
//# sourceMappingURL=LinkChartLayer.js.map